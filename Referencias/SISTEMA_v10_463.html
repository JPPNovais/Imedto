<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Sistema Hospitalar v10.463 - SYNC NOME PACIENTE</title>
    
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                        VERSÃƒO 10.462 - 30/11/2025                            â•‘
    â•‘               ğŸ”„ SINCRONIZAÃ‡ÃƒO NOME DO PACIENTE ğŸ”„                            â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ”„ SINCRONIZAÃ‡ÃƒO AUTOMÃTICA:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    â€¢ Quando "NÃ£o Identificado" Ã© atualizado no cadastro
    â€¢ Nome Ã© sincronizado automaticamente em:
      - Fila de Atendimentos (Pronto Atendimento)
      - Aba "Hoje"
      - HistÃ³rico de Atendimentos
    â€¢ Entradas e atendimentos sÃ£o atualizados no localStorage
    â€¢ Interface Ã© atualizada automaticamente se visÃ­vel
    
    ğŸ“ MÃ“DULO ANEXOS (v10.461):
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    â€¢ Anexar PDF, DOC, XLS, PPT, TXT, etc (mÃ¡x 10MB)
    â€¢ VisualizaÃ§Ã£o inline para PDF e imagens
    â€¢ Download direto para outros formatos
    
    -->
    
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                        VERSÃƒO 10.447 - 29/11/2025                            â•‘
    â•‘                    ğŸ¥ RECEPÃ‡ÃƒO MELHORADA + DASHBOARD ğŸ¥                       â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¥ RECEPÃ‡ÃƒO MELHORADA v10.447
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    MUDANÃ‡AS VISUAIS:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… Dashboard de estatÃ­sticas do dia na RecepÃ§Ã£o
    âœ… 4 botÃµes de fluxo destacados:
       - ğŸ“… Agenda (receber agendado)
       - â• Novo Paciente (cadastrar + walk-in)
       - ğŸš¨ UrgÃªncia/EmergÃªncia (triagem)
       - ğŸ‘¤ Buscar Paciente (retorno)
    
    âœ… Card de informaÃ§Ãµes do paciente selecionado:
       - Dados bÃ¡sicos (nome, CPF, nascimento)
       - HistÃ³rico de entradas (quantas vezes veio)
       - Ãšltima entrada (data, tipo, status)
       - Alerta se tem entrada ativa
    
    âœ… Meio de chegada expandido:
       - Deambulando, Cadeira de rodas, Maca, AmbulÃ¢ncia, SAMU, etc
    
    âœ… Tipo de atendimento completo:
       - consulta, retorno, urgencia, emergencia, procedimento, exame
       - cirurgia_eletiva, internacao (NOVOS!)
    
    -->
    
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.426 - 28/11/2025                           â•‘
    â•‘               ğŸ’¡ IDEIA DO FERNANDO: BUSCAR DO CADASTRO! ğŸ’¡                     â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ’¡ SOLUÃ‡ÃƒO PERFEITA DO FERNANDO! v10.426
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    PROBLEMA DAS VERSÃ•ES ANTERIORES:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    v10.417-v10.423: entrada.paciente tinha sÃ³ 3 campos âŒ
    v10.424-v10.425: entrada.paciente completo âœ… mas...
    
    E se:
    - Dados mudarem depois da entrada?
    - entrada.paciente nÃ£o for salvo direito?
    - Diferentes fluxos salvarem campos diferentes?
    
    IDEIA GENIAL DO FERNANDO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    "Por que nÃ£o buscar DIRETO DO CADASTRO?"
    
    ANTES (v10.424-425):
    Cabecalhos.pacienteSelecionado = entrada.paciente
    âŒ Depende de entrada.paciente estar completo
    âŒ Pode estar desatualizado
    âŒ Diferentes fluxos salvam de formas diferentes
    
    AGORA (v10.426):
    const pacienteCompleto = SistemaCore.dados.pacientes.find(
        p => p.id === entrada.paciente_id
    );
    Cabecalhos.pacienteSelecionado = pacienteCompleto;
    
    âœ… SEMPRE completo (vem do cadastro!)
    âœ… SEMPRE atualizado (fonte Ãºnica!)
    âœ… NÃƒO depende de entrada.paciente!
    âœ… SIMPLES e SEGURO!
    
    CÃ“DIGO MODIFICADO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    carregarModulosProntuarioNovo(modeloId) {
        // Buscar entrada
        const entradaId = parseInt(document.getElementById('atend-entrada-id').value);
        const entrada = entradas.find(e => e.id === entradaId);
        
        // v10.426: BUSCAR DO CADASTRO! (Ideia do Fernando!)
        const pacienteCompleto = SistemaCore.dados.pacientes.find(
            p => p.id === entrada.paciente_id
        );
        
        // Configurar com paciente COMPLETO do cadastro
        Cabecalhos.pacienteSelecionado = pacienteCompleto;
        console.log('âœ… Paciente do CADASTRO:', pacienteCompleto.nome);
        console.log('ğŸ“Š Dados disponÃ­veis:', Object.keys(pacienteCompleto));
        
        // Renderizar cabeÃ§alho (dados 100% completos!)
        if (modelo.cabecalho_id) {
            cabecalhoHTML = Cabecalhos.renderizarCabecalhoLayout(layout);
        }
    }
    
    POR QUE Ã‰ A MELHOR SOLUÃ‡ÃƒO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1. FONTE ÃšNICA DE VERDADE
       - Pacientes estÃ¡ em SistemaCore.dados.pacientes
       - Sempre tem dados completos
       - Sempre atualizado
    
    2. SIMPLICIDADE
       - NÃ£o precisa duplicar dados em entrada.paciente
       - entrada sÃ³ guarda o ID (paciente_id)
       - Busca quando precisa
    
    3. SEGURANÃ‡A
       - Se paciente mudar, pega dados novos
       - NÃ£o depende de diferentes fluxos salvarem igual
       - ImpossÃ­vel ter dados incompletos
    
    4. PADRÃƒO CORRETO
       - Entrada tem FK (paciente_id) âœ…
       - Busca entidade relacionada quando precisa âœ…
       - NÃ£o duplica dados desnecessariamente âœ…
    
    ESSA Ã‰ A SOLUÃ‡ÃƒO DEFINITIVA! ğŸ¯
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.425 - 28/11/2025                           â•‘
    â•‘                ğŸ”§ CORRIGIDO EM TODOS OS LUGARES! ğŸ”§                            â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ”§ CORREÃ‡ÃƒO COMPLETA! v10.425
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    v10.424: Corrigiu atenderDoAgendamento() âœ…
    v10.425: Corrigiu salvarEntrada() tambÃ©m! âœ…
    
    LUGARES CORRIGIDOS:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1. atenderDoAgendamento() (linha ~37142)
       - Quando atende da AGENDA
       ANTES: entrada.paciente = { id, nome, prontuario } âŒ
       AGORA: entrada.paciente = paciente (COMPLETO) âœ…
    
    2. salvarEntrada() (linha ~36734)  
       - Quando cria entrada na RECEPÃ‡ÃƒO
       ANTES: entrada.paciente = { id, nome, prontuario } âŒ
       AGORA: entrada.paciente = paciente (COMPLETO) âœ…
    
    RESULTADO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… Entrada via AGENDA â†’ paciente completo â†’ cabeÃ§alho funciona!
    âœ… Entrada via RECEPÃ‡ÃƒO â†’ paciente completo â†’ cabeÃ§alho funciona!
    
    AGORA DEVE FUNCIONAR EM QUALQUER FLUXO! ğŸ¯
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.424 - 28/11/2025                           â•‘
    â•‘                  ğŸ‰ FINALMENTE! PACIENTE COMPLETO! ğŸ‰                          â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ‰ A SOLUÃ‡ÃƒO REAL! v10.424
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    O PROBLEMA VERDADEIRO:
    
    ANTES (v10.423 e todas anteriores):
    entrada.paciente = {
        id: paciente.id,
        nome: paciente.nome,
        prontuario: paciente.prontuario
    }
    âŒ SÃ“ 3 CAMPOS!
    âŒ CabeÃ§alho precisa de nascimento, sexo, cpf, telefone, endereÃ§o...
    âŒ NÃƒO FUNCIONA!
    
    AGORA (v10.424):
    entrada.paciente = paciente
    âœ… PACIENTE COMPLETO!
    âœ… TODOS os campos disponÃ­veis!
    âœ… CabeÃ§alho TEM os dados que precisa!
    âœ… DEVE FUNCIONAR! ğŸ™
    
    POR QUE SANDBOX FUNCIONAVA?
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Sandbox:
    1. Busca paciente COMPLETO do banco
    2. Configura Cabecalhos.pacienteSelecionado = paciente COMPLETO
    3. Renderiza cabeÃ§alho
    4. âœ… TODOS os dados disponÃ­veis!
    
    Atendimento (ANTES v10.424):
    1. Busca paciente COMPLETO
    2. Cria entrada com SÃ“ 3 campos âŒ
    3. Configura Cabecalhos.pacienteSelecionado = entrada.paciente (sÃ³ 3 campos)
    4. Renderiza cabeÃ§alho
    5. âŒ Faltam dados! Quebra!
    
    Atendimento (AGORA v10.424):
    1. Busca paciente COMPLETO
    2. Cria entrada com paciente COMPLETO âœ…
    3. Configura Cabecalhos.pacienteSelecionado = entrada.paciente (COMPLETO!)
    4. Renderiza cabeÃ§alho
    5. âœ… TODOS os dados! FUNCIONA! ğŸ‰
    
    CÃ“DIGO MODIFICADO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    atenderDoAgendamento(agendamentoId) {
        const paciente = SistemaCore.dados.pacientes.find(...);
        
        entrada = {
            ...
            // v10.424: SIMPLES ASSIM!
            paciente: paciente,  // COMPLETO! âœ…
            ...
        };
    }
    
    ESSA Ã‰ A BOA! ğŸ¯
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.423 - 28/11/2025                           â•‘
    â•‘                      ğŸ” LOGS DETALHADOS DENTRO DA FUNÃ‡ÃƒO! ğŸ”                   â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.422 - 28/11/2025                           â•‘
    â•‘                  ğŸ’¡ EUREKA! CONFIGURA PACIENTE ANTES! ğŸ’¡                       â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ A SOLUÃ‡ÃƒO VERDADEIRA! v10.422
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    DESCOBERTA DO FERNANDO:
    No Sandbox, o PACIENTE Ã© configurado ANTES de qualquer renderizaÃ§Ã£o!
    
    FLUXO SANDBOX:
    1. Seleciona PACIENTE â†’ Cabecalhos.pacienteSelecionado = paciente
    2. Seleciona MODELO
    3. Renderiza cabeÃ§alho (paciente JÃ estÃ¡ configurado!)
    4. FUNCIONA! âœ…
    
    ANTES (v10.417-v10.421):
    âŒ Tentava configurar paciente NA HORA da renderizaÃ§Ã£o
    âŒ Fazia backup/restore
    âŒ NÃ£o funcionava!
    
    AGORA (v10.422):
    âœ… Configura Cabecalhos.pacienteSelecionado NO INÃCIO
    âœ… ANTES de renderizar cabeÃ§alho
    âœ… IGUAL ao Sandbox!
    
    CÃ“DIGO MODIFICADO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    carregarModulosProntuarioNovo(modeloId) {
        // Buscar entrada
        const entrada = entradas.find(e => e.id === entradaId);
        
        // v10.422: CONFIGURAR PACIENTE ANTES!
        Cabecalhos.pacienteSelecionado = entrada.paciente;
        console.log('âœ… Paciente configurado:', entrada.paciente.nome);
        
        // AGORA renderizar cabeÃ§alho (paciente JÃ configurado!)
        if (modelo.cabecalho_id) {
            const layout = layouts.find(...);
            cabecalhoHTML = Cabecalhos.renderizarCabecalhoLayout(layout);
        }
    }
    
    ESSA DEVE FUNCIONAR! ğŸ™
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.421 - 28/11/2025                           â•‘
    â•‘                      ğŸ” TRY/CATCH PARA PEGAR O ERRO! ğŸ”                        â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ” DEBUG v10.421
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    PROBLEMA DETECTADO:
    - FunÃ§Ã£o renderizarCabecalhoLayout() trava
    - CÃ³digo depois dela nÃ£o executa
    - Nenhum erro aparece no console
    
    SOLUÃ‡ÃƒO:
    âœ… Try/catch envolvendo a renderizaÃ§Ã£o
    âœ… Logs detalhados antes e depois
    âœ… Captura stack trace do erro
    
    AGORA VAI MOSTRAR O ERRO EXATO! ğŸ¯
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.420 - 28/11/2025                           â•‘
    â•‘                        ğŸ› CORRIGIDO O ARRAY ERRADO! ğŸ›                         â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ› BUG ENCONTRADO E CORRIGIDO!
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    O PROBLEMA:
    âŒ Sandbox usa: SistemaCore.dados.cabecalhos
    âŒ Atendimento usava: SistemaCore.dados.cabecalhos_layout
    âŒ ARRAYS DIFERENTES! Por isso nÃ£o encontrava!
    
    A CORREÃ‡ÃƒO:
    âœ… Agora TODOS usam: SistemaCore.dados.cabecalhos
    âœ… FormulÃ¡rio de atendimento
    âœ… VisualizaÃ§Ã£o de prontuÃ¡rio  
    âœ… ImpressÃ£o de ficha de triagem
    
    ONDE ESTAVA O ERRO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Sandbox (linha 20894):
    const layouts = SistemaCore.dados.cabecalhos || [];  âœ… CORRETO
    
    Atendimento (v10.419):
    const layouts = SistemaCore.dados.cabecalhos_layout || [];  âŒ ERRADO
    
    Atendimento (v10.420):
    const layouts = SistemaCore.dados.cabecalhos || [];  âœ… CORRIGIDO!
    
    CONSOLE DEBUG ADICIONADO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Quando selecionar modelo, o Console vai mostrar:
    ğŸ” [v10.420] Layouts disponÃ­veis: X
    ğŸ” [v10.420] Procurando layout ID: Y
    ğŸ” [v10.420] Entrada ID: Z
    ğŸ” [v10.420] Entrada encontrada: true/false
    ğŸ” [v10.420] Entrada tem paciente: true/false
    
    Se encontrar:
    âœ… [v10.420] Layout de cabeÃ§alho encontrado: [nome]
    ğŸ” [v10.420] Paciente configurado: [nome]
    âœ… [v10.420] CabeÃ§alho renderizado no formulÃ¡rio
    
    Se NÃƒO encontrar:
    âŒ [v10.420] Layout de cabeÃ§alho NÃƒO encontrado! ID: X
    ğŸ“‹ [v10.420] IDs disponÃ­veis: [1, 2, 3...]
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.419 - 28/11/2025                           â•‘
    â•‘                   ğŸ¯ AGORA USA A MESMA FUNÃ‡ÃƒO DO SANDBOX! ğŸ¯                   â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ”§ CORREÃ‡ÃƒO CRÃTICA v10.419
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    PROBLEMA v10.418:
    âŒ Tentei criar minha prÃ³pria funÃ§Ã£o: renderizarCabecalhoParaImpressao()
    âŒ NÃ£o funcionou - cabeÃ§alho nÃ£o aparecia
    
    SOLUÃ‡ÃƒO v10.419:
    âœ… Uso a MESMA funÃ§Ã£o que o Sandbox usa: Cabecalhos.renderizarCabecalhoLayout()
    âœ… ConfiguraÃ§Ã£o temporÃ¡ria de Cabecalhos.pacienteSelecionado
    âœ… RenderizaÃ§Ã£o IDÃŠNTICA ao Sandbox
    
    CÃ“DIGO MODIFICADO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ANTES (v10.418):
    ```javascript
    cabecalhoHTML = this.renderizarCabecalhoParaImpressao(layout, paciente, entrada);
    ```
    âŒ FunÃ§Ã£o prÃ³pria, nÃ£o funciona
    
    AGORA (v10.419):
    ```javascript
    // Configurar paciente temporariamente
    const pacienteBackup = Cabecalhos.pacienteSelecionado;
    Cabecalhos.pacienteSelecionado = entrada.paciente;
    
    // Renderizar usando MESMA funÃ§Ã£o do Sandbox
    cabecalhoHTML = Cabecalhos.renderizarCabecalhoLayout(layout);
    
    // Restaurar backup
    Cabecalhos.pacienteSelecionado = pacienteBackup;
    ```
    âœ… Usa funÃ§Ã£o oficial, deve funcionar!
    
    POR QUE ISSO FUNCIONA?
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Sandbox (linha 20846):
    container.innerHTML = this.renderizarCabecalhoLayout(layout);
    
    Atendimento (AGORA v10.419):
    container.innerHTML = Cabecalhos.renderizarCabecalhoLayout(layout);
    
    MESMA FUNÃ‡ÃƒO = MESMO RESULTADO! âœ…
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.418 - 28/11/2025                           â•‘
    â•‘                     ğŸ¨ CABEÃ‡ALHO APARECE NO FORMULÃRIO! ğŸ¨                     â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ‰ NOVIDADE v10.418
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… CABEÃ‡ALHO APARECE AO ESCOLHER MODELO
    
    Antes (v10.417):
    âŒ Escolhe modelo â†’ SÃ³ mÃ³dulos aparecem
    âŒ CabeÃ§alho sÃ³ na visualizaÃ§Ã£o final
    
    Agora (v10.418):
    âœ… Escolhe modelo â†’ CabeÃ§alho + MÃ³dulos aparecem
    âœ… VÃª cabeÃ§alho ENQUANTO preenche
    âœ… CabeÃ§alho na visualizaÃ§Ã£o final tambÃ©m
    
    FLUXO COMPLETO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Agenda â†’ [ğŸ©º Atender] ou Atendimentos â†’ â• Atendimento
      â†“
    FormulÃ¡rio abre:
      â”œâ”€ Nome do paciente
      â””â”€ [Dropdown: Escolher modelo]
      â†“
    Seleciona modelo (ex: "Consulta 01")
      â†“
    carregarModulosProntuarioNovo():
      1. Busca modelo.cabecalho_id
      2. Busca layout do cabeÃ§alho
      3. Busca dados paciente + entrada
      4. Renderiza cabeÃ§alho
      5. Renderiza mÃ³dulos
      â†“
    APARECE NA TELA:
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ ğŸ¥ [CABEÃ‡ALHO CONFIGURADO]      â”‚ â† NOVO v10.418!
      â”‚ Logo + Dados Hospital           â”‚
      â”‚ Dados do Paciente               â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚ Controle Hospitalar             â”‚
      â”‚ - DPO                           â”‚
      â”‚ - AntibiÃ³ticos                  â”‚
      â”‚ ...outros mÃ³dulos...            â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†“
    Preenche mÃ³dulos
      â†“
    [ğŸ’¾ Salvar]
      â†“
    HistÃ³rico â†’ [ğŸ‘ï¸ Ver ProntuÃ¡rio]
      â†“
    CabeÃ§alho aparece de novo! âœ…
    
    CÃ“DIGO MODIFICADO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    carregarModulosProntuarioNovo(modeloId):
      // NOVO v10.418:
      if (modelo.cabecalho_id) {
          â”œâ”€ Busca layout do cabeÃ§alho
          â”œâ”€ Busca paciente e entrada
          â”œâ”€ Calcula idade
          â””â”€ Renderiza usando renderizarCabecalhoParaImpressao()
      }
      
      // Insere:
      conteudo.innerHTML = cabecalhoHTML + modulosHTML;
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.417 - 28/11/2025                           â•‘
    â•‘                   ğŸ¨ CABEÃ‡ALHOS NO PRONTUÃRIO E TRIAGEM! ğŸ¨                    â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ‰ NOVIDADES
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1. âœ… CABEÃ‡ALHO NO PRONTUÃRIO
       â€¢ VisualizaÃ§Ã£o mostra cabeÃ§alho configurado do modelo
       â€¢ CabeÃ§alho aparece tanto na tela quanto na impressÃ£o
       â€¢ Usa layout escolhido em: GestÃ£o â†’ Documentos â†’ Modelos
    
    2. âœ… IMPRESSÃƒO DE FICHA APÃ“S TRIAGEM
       â€¢ Ao concluir triagem â†’ Pergunta se quer imprimir
       â€¢ Ficha inclui:
         - CabeÃ§alho configurado (se modelo EmergÃªncia tiver)
         - Dados do paciente
         - ClassificaÃ§Ã£o Manchester (colorida)
         - Sinais vitais
         - Queixa/HistÃ³ria
         - ObservaÃ§Ãµes
       â€¢ ImpressÃ£o direta (window.print) - nÃ£o PDF
    
    3. âœ… FUNÃ‡Ã•ES NOVAS
       â€¢ imprimirFichaTriagem(entradaId)
       â€¢ renderizarCabecalhoParaImpressao(layout, paciente, entrada)
       â€¢ calcularIdadePaciente(nascimento)
    
    FLUXO TRIAGEM â†’ IMPRESSÃƒO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Atendimentos â†’ Triagem
      â†“
    Preencher Manchester + Sinais Vitais
      â†“
    [Concluir Triagem]
      â†“
    Confirma: "Deseja imprimir ficha?"
      â†“
    SIM â†’ Abre nova janela com ficha
      â”œâ”€ CabeÃ§alho do hospital
      â”œâ”€ Dados do paciente
      â”œâ”€ Box Manchester colorido
      â”œâ”€ Sinais vitais
      â””â”€ [ğŸ–¨ï¸ Imprimir] automÃ¡tico
      â†“
    Paciente vai para fila de atendimento
    
    FLUXO PRONTUÃRIO COM CABEÃ‡ALHO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Atendimentos â†’ HistÃ³rico
      â†“
    [ğŸ‘ï¸ Ver ProntuÃ¡rio]
      â†“
    Modal abre mostrando:
      â”œâ”€ CabeÃ§alho do modelo (logo, dados hospital, dados paciente)
      â”œâ”€ Eventos clÃ­nicos
      â”œâ”€ MÃ³dulos do prontuÃ¡rio
      â””â”€ Ctrl+P â†’ Imprime TUDO (com cabeÃ§alho) âœ…
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.416 - 28/11/2025                           â•‘
    â•‘                       ğŸ”¥ LOOP INFINITO CORRIGIDO! ğŸ”¥                           â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ› BUG CRÃTICO CORRIGIDO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    PROBLEMA (v10.415):
    â€¢ Tinha 2 funÃ§Ãµes iniciarAtendimento():
      - FunÃ§Ã£o NOVA (linha 37086) âœ… correta
      - FunÃ§Ã£o ANTIGA (linha 38363) âŒ redirecionava
    
    â€¢ LOOP INFINITO:
      Clica Atender â†’ FunÃ§Ã£o antiga â†’ atenderDoAgendamento â†’ 
      FunÃ§Ã£o antiga de novo â†’ LOOP! ğŸ˜±
    
    SOLUÃ‡ÃƒO (v10.416):
    âœ… DELETOU funÃ§Ã£o antiga completamente
    âœ… Agora sÃ³ existe UMA funÃ§Ã£o iniciarAtendimento()
    âœ… Fluxo correto funcionando
    
    AGORA FUNCIONA!
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    CalendÃ¡rio â†’ [Atender]
      â†“
    atenderDoAgendamento(agendamentoId)
      â”œâ”€ Cria/busca entrada
      â”œâ”€ Muda para aba Atendimentos
      â””â”€ setTimeout 500ms
      â†“
    iniciarAtendimento(entradaId) â† SÃ“ ESTA FUNÃ‡ÃƒO!
      â”œâ”€ Carrega modelos
      â”œâ”€ Esconde listas
      â””â”€ Mostra formulÃ¡rio âœ…
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.415 - 28/11/2025                           â•‘
    â•‘                    ğŸ‰ FORMULÃRIO DE ATENDIMENTO RESTAURADO! ğŸ‰                 â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    âœ… RESTAURAÃ‡ÃƒO COMPLETA
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    PROBLEMA (v10.414):
    â€¢ Aba "Atendimento" sÃ³ mostrava lista
    â€¢ FormulÃ¡rio de escolher modelo NÃƒO FUNCIONAVA
    â€¢ MÃ³dulos nÃ£o carregavam
    
    SOLUÃ‡ÃƒO (v10.415):
    âœ… FunÃ§Ã£o carregarModulosProntuarioNovo() RESTAURADA do v10.408
    âœ… FormulÃ¡rio mostra/esconde corretamente
    âœ… Dropdown de modelos funciona
    âœ… MÃ³dulos do prontuÃ¡rio aparecem
    âœ… BotÃ£o Cancelar volta para lista
    
    FLUXO COMPLETO FUNCIONANDO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    CALENDÃRIO â†’ ATENDIMENTO:
    1. Agendamentos â†’ [ğŸ©º Atender]
    2. Cria entrada automaticamente
    3. Muda para aba Atendimentos
    4. Mostra formulÃ¡rio com dropdown
    5. Escolhe modelo â†’ mÃ³dulos aparecem âœ…
    6. Preenche â†’ Salva âœ…
    
    RECEPÃ‡ÃƒO â†’ TRIAGEM â†’ ATENDIMENTO:
    1. RecepÃ§Ã£o â†’ Registra entrada
    2. Se urgÃªncia â†’ Triagem (Manchester)
    3. Atendimentos â†’ Lista ordenada
    4. [Atender] â†’ FormulÃ¡rio abre âœ…
    5. Escolhe modelo â†’ Preenche â†’ Salva âœ…
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.414 - 28/11/2025                           â•‘
    â•‘                         ğŸ” DEBUG COMPLETO ATIVADO ğŸ”                           â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ› DEBUG APRIMORADO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    PROBLEMA (v10.413):
    - Mudava para aba Atendimentos âœ…
    - MAS ficava vazia âŒ
    - FormulÃ¡rio nÃ£o aparecia âŒ
    
    MELHORIAS (v10.414):
    1. Timeout aumentado: 100ms â†’ 500ms
    2. Logs detalhados em CADA etapa:
       ğŸ”€ Mudando para aba...
       ğŸ”€ Mudando para sub-aba...
       â³ Aguardando...
       ğŸš€ Chamando iniciarAtendimento...
       ğŸ”„ trocarAba chamado...
       âœ… listarFilaAtendimento concluÃ­do
       ğŸ” [DEBUG] iniciarAtendimento chamado...
       âœ… [DEBUG] FormulÃ¡rio exibido
    
    AGORA VAI MOSTRAR EXATAMENTE ONDE TRAVA!
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.413 - 28/11/2025                           â•‘
    â•‘                        âœ… BOTÃƒO ATENDER FUNCIONA! âœ…                           â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ› BUG FINAL CORRIGIDO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    PROBLEMA (v10.412):
    Sistema.trocarAba('atendimentos') âŒ
    â†’ TypeError: trocarAba is not a function
    
    CORREÃ‡ÃƒO (v10.413):
    Sistema.trocarTab('atendimentos') âœ…
    â†’ FunÃ§Ã£o correta!
    
    AGORA FUNCIONA:
    1. Clica [ğŸ©º Atender] no calendÃ¡rio
    2. âœ… Cria entrada
    3. âœ… Muda para aba Atendimentos
    4. âœ… Abre formulÃ¡rio
    5. âœ… Dropdown de modelos aparece
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.412 - 28/11/2025                           â•‘
    â•‘                      âœ… BOTÃƒO ATENDER CORRIGIDO âœ…                             â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ› BUGS CORRIGIDOS
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1. âŒ REMOVIDO botÃ£o duplicado "ğŸ‘¨â€âš•ï¸ Atender"
       â€¢ Estava duplicando o botÃ£o original
       â€¢ Causava confusÃ£o
    
    2. âœ… MANTIDO botÃ£o original "ğŸ©º Atender"
       â€¢ Agora chama funÃ§Ã£o correta
       â€¢ Cria entrada antes de atender
    
    3. âœ… CORRIGIDO bug "clica Zezim â†’ aparece JoÃ£o"
       â€¢ BotÃ£o estava passando ID do agendamento
       â€¢ FunÃ§Ã£o esperava ID da entrada
       â€¢ Agora cria entrada e passa ID correto
    
    4. âœ… ADICIONADO debug console.log
       â€¢ Para identificar problemas
       â€¢ Mostra qual paciente estÃ¡ sendo selecionado
       â€¢ Mostra se formulÃ¡rio estÃ¡ abrindo
    
    ğŸ”§ MUDANÃ‡AS
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    BOTÃƒO ORIGINAL (linha ~35058):
    Antes: onclick="Atendimentos.iniciarAtendimento(${ag.id})" âŒ
    Agora: onclick="Atendimentos.atenderDoAgendamento(${ag.id})" âœ…
    
    FLUXO CORRETO:
    1. Clica [ğŸ©º Atender] no agendamento
    2. Chama atenderDoAgendamento(agendamentoId)
    3. Cria entrada automaticamente
    4. Chama iniciarAtendimento(entradaId) com ID correto
    5. FormulÃ¡rio abre com paciente correto
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.411 - 28/11/2025                           â•‘
    â•‘                  âœ… BOTÃƒO ATENDER DO CALENDÃRIO â†’ ATENDIMENTO âœ…               â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ CORREÃ‡ÃƒO IMPLEMENTADA
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    PROBLEMA (v10.410):
    â€¢ Agendamentos â†’ CalendÃ¡rio â†’ [Atender]
    â€¢ Ia para Atendimentos â†’ Novo Atendimento
    â€¢ Lista vazia âŒ
    
    SOLUÃ‡ÃƒO (v10.411):
    â€¢ BotÃ£o [ğŸ‘¨â€âš•ï¸ Atender] adicionado nos agendamentos
    â€¢ Ao clicar:
      1. âœ… Cria entrada automaticamente
      2. âœ… Muda para aba Atendimentos
      3. âœ… Abre formulÃ¡rio de atendimento
      4. âœ… Paciente selecionado
      5. âœ… Pronto para escolher modelo
    
    ğŸ”§ IMPLEMENTAÃ‡ÃƒO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    NOVO BOTÃƒO:
    â€¢ Cards de agendamentos: [ğŸ‘¨â€âš•ï¸] Ã­cone verde
    â€¢ Lista completa: [ğŸ‘¨â€âš•ï¸ Atender] botÃ£o verde
    
    NOVA FUNÃ‡ÃƒO:
    Atendimentos.atenderDoAgendamento(agendamentoId)
    
    FLUXO AUTOMÃTICO:
    1. Busca agendamento
    2. Busca paciente
    3. Verifica se jÃ¡ tem entrada criada
       â”œâ”€ Tem? â†’ Usa entrada existente
       â””â”€ NÃ£o tem? â†’ Cria entrada nova
    4. Entrada criada com:
       â€¢ Dados do agendamento (data, horÃ¡rio, tipo)
       â€¢ Status: "aguardando_atendimento"
       â€¢ Link: agendamento_id
       â€¢ Sem triagem (consultas agendadas)
    5. Muda para Atendimentos â†’ Atendimento
    6. Abre formulÃ¡rio com paciente
    
    COMPATIBILIDADE:
    â€¢ âœ… Funciona com agendamentos antigos
    â€¢ âœ… NÃ£o duplica entrada se jÃ¡ existir
    â€¢ âœ… MantÃ©m dados do agendamento
    â€¢ âœ… IntegraÃ§Ã£o total com novo sistema
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.410 - 28/11/2025                           â•‘
    â•‘                  âœ… RECEPÃ‡ÃƒO + AGENDA COMPLETAS âœ…                             â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ CORREÃ‡Ã•ES CRÃTICAS
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1. âœ… BUSCA DE PACIENTE funcionando
       â€¢ Digite nome/prontuÃ¡rio â†’ aparece lista
       â€¢ Clique no resultado â†’ formulÃ¡rio abre
       â€¢ BotÃµes aparecem
    
    2. âœ… BOTÃƒO "REGISTRAR ENTRADA" visÃ­vel
       â€¢ Aparece apÃ³s selecionar paciente
       â€¢ Cria entrada corretamente
       â€¢ Redireciona para Triagem ou Atendimento
    
    3. âœ… INTEGRAÃ‡ÃƒO "+ NOVO PACIENTE"
       â€¢ Cadastra novo â†’ automaticamente seleciona
       â€¢ FormulÃ¡rio jÃ¡ aparece preenchido
       â€¢ Pronto para registrar entrada
    
    ğŸ†• NOVA FEATURE: AGENDA
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ“… BOTÃƒO AGENDA na RecepÃ§Ã£o:
    
    [ğŸ” Buscar]  [+ Novo Paciente]  [âš¡ NÃ£o Identificado]  [ğŸ“… AGENDA] â† NOVO!
    
    FUNCIONALIDADES:
    
    1. LISTA DE AGENDAMENTOS DO DIA
       â€¢ Mostra todos os agendamentos
       â€¢ Ordenado por horÃ¡rio
       â€¢ Com informaÃ§Ãµes completas
    
    2. FILTROS COMPLETOS
       â€¢ ğŸ“… Data: [Hoje] [AmanhÃ£] [Customizado]
       â€¢ ğŸ‘¨â€âš•ï¸ Profissional: [Dropdown]
       â€¢ ğŸ¥ Especialidade: [Dropdown]
       â€¢ ğŸ“Š Status: [Todos] [Agendado] [Confirmado] [Check-in feito]
    
    3. VERIFICAÃ‡ÃƒO DE CADASTRO
       â€¢ ğŸŸ¢ VERDE = Completo (100%) â†’ Check-in rÃ¡pido
       â€¢ ğŸŸ¡ AMARELO = Parcial (50-99%) â†’ Completar campos
       â€¢ ğŸ”´ VERMELHO = MÃ­nimo (<50%) â†’ Cadastro obrigatÃ³rio
    
    4. INDICADORES VISUAIS
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ ğŸŸ¢ 09:00 - JoÃ£o Silva (100%)               â”‚
       â”‚    Cadastro COMPLETO                       â”‚
       â”‚    [âœ“ Check-in RÃ¡pido]                     â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ ğŸŸ¡ 09:30 - Maria Santos (60%)              â”‚
       â”‚    Faltam: CPF, EndereÃ§o                   â”‚
       â”‚    [ğŸ“ Completar e Check-in]               â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚ ğŸ”´ 10:00 - Pedro Costa (20%)               â”‚
       â”‚    Faltam: Documento, Data nasc, EndereÃ§o  â”‚
       â”‚    [ğŸ“ Completar Cadastro]                 â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    5. CHECK-IN INTELIGENTE
       
       CADASTRO COMPLETO:
       â€¢ 1 clique â†’ formulÃ¡rio preenchido
       â€¢ Confirma e pronto!
       
       CADASTRO INCOMPLETO:
       â€¢ Mostra campos faltantes DESTACADOS
       â€¢ Preenche â†’ check-in automÃ¡tico
       â€¢ Salva cadastro + cria entrada
    
    6. CAMPOS VERIFICADOS
       âœ… ObrigatÃ³rios para cadastro completo:
       â€¢ Documento (CPF/RG/Passaporte)
       â€¢ Data de nascimento
       â€¢ EndereÃ§o completo
       â€¢ Nome da mÃ£e
       â€¢ Telefone
    
    ğŸ“Š CÃLCULO DE COMPLETUDE
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Porcentagem = (Campos preenchidos / Total de campos obrigatÃ³rios) Ã— 100
    
    Campos obrigatÃ³rios (5):
    1. Documento identificaÃ§Ã£o
    2. Data nascimento
    3. EndereÃ§o
    4. Nome da mÃ£e
    5. Telefone
    
    ClassificaÃ§Ã£o:
    â€¢ 100% = 5/5 campos = ğŸŸ¢ COMPLETO
    â€¢ 60-80% = 3-4/5 campos = ğŸŸ¡ PARCIAL
    â€¢ <60% = 0-2/5 campos = ğŸ”´ MÃNIMO
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.409 - 27/11/2025                           â•‘
    â•‘              âœ… NOVO FLUXO: RECEPÃ‡ÃƒO â†’ TRIAGEM â†’ ATENDIMENTO âœ…               â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ IMPLEMENTAÃ‡ÃƒO COMPLETA DO FLUXO HOSPITALAR
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ¥ FLUXO 1: COM TRIAGEM (UrgÃªncia/EmergÃªncia)
    
    1. RECEPÃ‡ÃƒO
       â€¢ Cadastra/seleciona paciente
       â€¢ Registra dados de entrada
       â€¢ â˜‘ï¸ Marca "Precisa Triagem"
       â€¢ Status: "aguardando_triagem"
       
    2. TRIAGEM
       â€¢ Avalia paciente
       â€¢ Queixa/HistÃ³ria breve
       â€¢ Sinais vitais
       â€¢ ClassificaÃ§Ã£o Manchester
       â€¢ Status: "aguardando_atendimento"
       
    3. ATENDIMENTO
       â€¢ Fila ordenada por Manchester (vermelho > laranja > amarelo > verde)
       â€¢ Escolhe modelo de prontuÃ¡rio
       â€¢ Atendimento completo
       â€¢ Status: "atendido"
    
    ğŸ“… FLUXO 2: SEM TRIAGEM (Consulta/Procedimento)
    
    1. RECEPÃ‡ÃƒO
       â€¢ Cadastra/seleciona paciente
       â€¢ Registra dados de entrada
       â€¢ â˜ NÃƒO marca triagem
       â€¢ Status: "aguardando_atendimento"
       
    2. ATENDIMENTO (direto)
       â€¢ Fila ordenada por horÃ¡rio agendado
       â€¢ Escolhe modelo de prontuÃ¡rio
       â€¢ Atendimento completo
       â€¢ Status: "atendido"
    
    ğŸ“Š ESTRUTURA DE DADOS
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Nova tabela: SistemaCore.dados.entradas[]
    
    {
        id: 1,
        numero_registro: "2025/11/27/000001",
        paciente_id: 123,
        paciente: { id, nome, prontuario },
        
        // Dados da recepÃ§Ã£o
        data_entrada: "2025-11-27",
        hora_entrada: "14:30",
        local_entrada: "emergencia",
        tipo: "emergencia",
        meio_chegada: "ambulancia",
        precisa_triagem: true,
        
        // Status do fluxo
        status: "aguardando_triagem" | "aguardando_atendimento" | "atendido",
        
        // Dados da triagem (se precisar)
        triagem: {
            data_triagem: "2025-11-27T14:35:00",
            queixa: "Dor torÃ¡cica intensa",
            sinais_vitais: { pa, fc, temp, spo2 },
            manchester: {
                fluxograma: "dor_toracica",
                discriminador: "Dor precordial em curso",
                cor: "#ef4444",
                prioridade: "vermelho",
                tempo_maximo: 0,
                ordem_prioridade: 1  // â† Para ordenaÃ§Ã£o
            },
            observacoes: "..."
        },
        
        // Dados do atendimento (quando atender)
        atendimento: {
            data: "2025-11-27T14:40:00",
            modelo_id: 456,
            prontuario_preenchido: {...}
        }
    }
    
    ğŸ¨ INTERFACE
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    SUB-ABAS REFORMULADAS:
    
    [ğŸ¥ RecepÃ§Ã£o] [ğŸš¨ Triagem] [â• Atendimento] [ğŸ“‹ Hoje] [ğŸ“š HistÃ³rico]
    
    ABA RECEPÃ‡ÃƒO:
    â€¢ Buscar paciente
    â€¢ Dados de entrada (data/hora/local/tipo/meio)
    â€¢ â˜‘ï¸ Checkbox "Precisa Triagem?"
    â€¢ Salvar â†’ Envia para Triagem OU Atendimento
    
    ABA TRIAGEM:
    â€¢ Lista de pacientes aguardando triagem
    â€¢ FormulÃ¡rio de triagem:
      - Queixa/HistÃ³ria
      - Sinais vitais (PA, FC, Temp, SpOâ‚‚)
      - Manchester (fluxograma + discriminador)
      - ObservaÃ§Ãµes
    â€¢ BotÃµes: [ğŸ“„ Gerar Folha] [âœ… Concluir]
    
    ABA ATENDIMENTO:
    â€¢ SEÃ‡ÃƒO 1: UrgÃªncias/EmergÃªncias
      - Ordenado por Manchester (ğŸ”´ > ğŸŸ  > ğŸŸ¡ > ğŸŸ¢)
      - Badge colorido com prioridade
      - Queixa da triagem visÃ­vel
      
    â€¢ SEÃ‡ÃƒO 2: Consultas Agendadas
      - Ordenado por horÃ¡rio
      - Tipo de atendimento visÃ­vel
    
    â€¢ FORMULÃRIO (ao clicar em paciente):
      - Info da triagem (se houver)
      - Selecionar modelo de prontuÃ¡rio
      - MÃ³dulos aparecem
      - Salvar atendimento
    
    ğŸ“ˆ ORDENAÃ‡ÃƒO MANCHESTER
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ordem_prioridade:
    1 = ğŸ”´ VERMELHO (EmergÃªncia - Imediato)
    2 = ğŸŸ  LARANJA (Muito Urgente - 10 min)
    3 = ğŸŸ¡ AMARELO (Urgente - 60 min)
    4 = ğŸŸ¢ VERDE (Pouco Urgente - 120 min)
    5 = ğŸ”µ AZUL (NÃ£o Urgente - 240 min)
    
    Dentro da mesma cor: ordenar por hora de entrada
    
    ğŸ”§ FUNÃ‡Ã•ES IMPLEMENTADAS
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    RECEPÃ‡ÃƒO:
    â€¢ iniciarRecepcao() - Preenche data/hora atual
    â€¢ verificarTipoRecepcao() - Auto-marca triagem se urgÃªncia
    â€¢ salvarEntrada() - Cria entrada e direciona fluxo
    â€¢ cancelarRecepcao() - Limpa formulÃ¡rio
    
    TRIAGEM:
    â€¢ listarAguardandoTriagem() - Lista pacientes
    â€¢ iniciarTriagem(id) - Abre formulÃ¡rio
    â€¢ carregarDiscriminadoresTriagem() - Preenche dropdown
    â€¢ exibirClassificacaoTriagem() - Mostra resultado colorido
    â€¢ concluirTriagem() - Salva e envia para fila
    â€¢ gerarFolhaTriagemPDF() - PDF da triagem
    â€¢ cancelarTriagem() - Fecha formulÃ¡rio
    
    ATENDIMENTO:
    â€¢ listarFilaAtendimento() - 2 listas ordenadas
    â€¢ iniciarAtendimento(id) - Abre formulÃ¡rio
    â€¢ carregarModulosProntuarioNovo() - Carrega mÃ³dulos
    â€¢ salvarAtendimentoCompleto() - Finaliza atendimento
    â€¢ cancelarAtendimento() - Fecha formulÃ¡rio
    
    GERAL:
    â€¢ trocarAba() - Atualizado com 5 abas
    
    âœ… COMPATIBILIDADE
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    â€¢ MantÃ©m todas as funcionalidades anteriores
    â€¢ Nova tabela "entradas" separada de "atendimentos"
    â€¢ Dados antigos preservados
    â€¢ Nenhum cÃ³digo anterior foi removido
    
    ğŸ“ PRÃ“XIMOS PASSOS (futuros)
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    â€¢ Implementar carregamento de mÃ³dulos no atendimento
    â€¢ PDF da folha de triagem
    â€¢ Migrar dados antigos para novo formato
    â€¢ EstatÃ­sticas de tempo de espera
    â€¢ Alertas de tempo Manchester excedido
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.408 - 27/11/2025                           â•‘
    â•‘              âœ… CORREÃ‡ÃƒO: EXIBIÃ‡ÃƒO DE ATENDIMENTOS DO DIA âœ…                   â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ› PROBLEMAS CORRIGIDOS
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    BUGS IDENTIFICADOS NA FUNÃ‡ÃƒO listarAtendimentosHoje():
    
    1. FILTRO INCORRETO (linha 36320):
       ANTES: atendimentos.filter(a => a.tipo_entrada === filtroTipo)
       DEPOIS: atendimentos.filter(a => a.tipo_atendimento === filtroTipo)
       
       Problema: Buscava campo "tipo_entrada" que nÃ£o existe
       Campo correto: "tipo_atendimento" (definido ao salvar)
    
    2. EXIBIÃ‡ÃƒO DO TIPO (linha 36364):
       ANTES: ${a.tipo_entrada}
       DEPOIS: ${a.tipo_atendimento}
       
       Resultado antes: "Tipo: undefined"
       Resultado depois: "Tipo: consulta" âœ…
    
    3. EXIBIÃ‡ÃƒO DO REGISTRO (linha 36366):
       ANTES: ${a.registro}
       DEPOIS: ${a.numero_registro}
       
       Resultado antes: "Registro: undefined"
       Resultado depois: "Registro: AT-20251127-001" âœ…
    
    ğŸ“Š CAMPOS DO OBJETO ATENDIMENTO:
    
    Ao salvar um atendimento (salvarAtendimento):
    {
        id: 1,
        numero_registro: "AT-20251127-001",      â† ESTE Ã© o nome correto
        paciente_id: 123,
        tipo_atendimento: "consulta",            â† ESTE Ã© o nome correto
        local_entrada: "ambulatorio",
        data_entrada: "2025-11-27",
        hora_entrada: "14:30",
        status: "aguardando",
        ...
    }
    
    Ao listar (listarAtendimentosHoje):
    ERRADO: a.tipo_entrada    â†’ undefined
    CERTO:  a.tipo_atendimento â†’ "consulta" âœ…
    
    ERRADO: a.registro         â†’ undefined
    CERTO:  a.numero_registro  â†’ "AT-20251127-001" âœ…
    
    âœ… RESULTADO FINAL:
    
    ANTES:
    11:24 aguardando
    Paciente: JoÃ£o da Silva (H000004)
    Tipo: undefined | Local: recepcao     â† BUG!
    Registro: undefined                    â† BUG!
    
    DEPOIS:
    11:24 aguardando
    Paciente: JoÃ£o da Silva (H000004)
    Tipo: consulta | Local: recepcao      âœ… CORRETO!
    Registro: AT-20251127-001             âœ… CORRETO!
    
    ğŸ¯ CAMPOS CORRIGIDOS:
    â€¢ tipo_atendimento (antes: tipo_entrada)
    â€¢ numero_registro (antes: registro)
    â€¢ Filtro por tipo funcionando corretamente
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.407 - 27/11/2025                           â•‘
    â•‘                  âœ… CORREÃ‡ÃƒO: VALIDAÃ‡ÃƒO DE CAMPOS OBRIGATÃ“RIOS âœ…              â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ› PROBLEMA CORRIGIDO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    BUG IDENTIFICADO:
    FunÃ§Ã£o salvarAtendimento() validava queixa como SEMPRE obrigatÃ³ria:
    
    ANTES (linha 35865):
    if (!pacienteId || !dataEntrada || !horaEntrada || !localEntrada || 
        !tipoAtendimento || !meioChegada || !queixaPrincipal) {
        âŒ Erro: "Preencha todos os campos obrigatÃ³rios"
    }
    
    PROBLEMA:
    â€¢ Consulta normal SEM queixa â†’ BLOQUEAVA âŒ
    â€¢ Sistema pedia queixa para todos os tipos
    â€¢ Mas queixa sÃ³ deve ser obrigatÃ³ria para urgÃªncia/emergÃªncia!
    
    âœ… SOLUÃ‡ÃƒO IMPLEMENTADA (v10.407):
    
    // ValidaÃ§Ã£o em 2 etapas:
    
    // 1. ValidaÃ§Ã£o bÃ¡sica (SEM queixa)
    if (!pacienteId || !dataEntrada || !horaEntrada || !localEntrada || 
        !tipoAtendimento || !meioChegada) {
        âŒ Erro: "Preencha todos os campos obrigatÃ³rios"
    }
    
    // 2. ValidaÃ§Ã£o condicional da queixa
    if ((tipoAtendimento === 'urgencia' || tipoAtendimento === 'emergencia') 
        && !queixaPrincipal) {
        âŒ Erro: "A Queixa Principal Ã© obrigatÃ³ria para UrgÃªncias e EmergÃªncias"
    }
    
    ğŸ¯ RESULTADO:
    â€¢ Consulta â†’ Pode salvar SEM queixa âœ…
    â€¢ UrgÃªncia/EmergÃªncia â†’ Exige queixa âœ…
    â€¢ ValidaÃ§Ã£o correta por tipo de atendimento âœ…
    
    ğŸ“Š CAMPOS OBRIGATÃ“RIOS ATUALIZADOS:
    
    SEMPRE OBRIGATÃ“RIOS:
    â€¢ Paciente selecionado
    â€¢ Data de entrada
    â€¢ Hora de entrada
    â€¢ Local de entrada
    â€¢ Tipo de atendimento
    â€¢ Meio de chegada
    
    CONDICIONALMENTE OBRIGATÃ“RIOS:
    â€¢ Queixa Principal â†’ SÃ“ para UrgÃªncia/EmergÃªncia â­
    â€¢ Manchester â†’ Depende da configuraÃ§Ã£o
    
    SEMPRE OPCIONAIS:
    â€¢ Acompanhante (todos os campos)
    â€¢ Modelo de ProntuÃ¡rio
    â€¢ MÃ³dulos do prontuÃ¡rio
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.406 - 27/11/2025                           â•‘
    â•‘                  âœ… REORGANIZAÃ‡ÃƒO DO FORMULÃRIO DE ATENDIMENTOS âœ…             â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¨ MELHORIAS NA INTERFACE
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1ï¸âƒ£ ORDEM DO FORMULÃRIO REORGANIZADA:
       ANTES:
       1. Buscar Paciente
       2. Dados da Entrada
       3. Manchester (condicional)
       4. Acompanhante (condicional)
       [depois] Modelo de ProntuÃ¡rio
       
       DEPOIS:
       1. Buscar Paciente
       2. Dados da Entrada
          â”œâ”€ Data/Hora/Local/Tipo/Meio
          â”œâ”€ Queixa (condicional)
          â”œâ”€ Dados do Acompanhante (opcional) â­ MOVIDO!
          â””â”€ Modelo de ProntuÃ¡rio â­
       3. Manchester (condicional)
       
       âœ… Acompanhante agora vem ANTES do modelo
       âœ… Acompanhante integrado em "Dados da Entrada"
       âœ… Fluxo mais lÃ³gico e limpo
    
    2ï¸âƒ£ NÃšMEROS REMOVIDOS DAS SEÃ‡Ã•ES:
       ANTES: 1ï¸âƒ£ 2ï¸âƒ£ 3ï¸âƒ£ 4ï¸âƒ£
       DEPOIS: Sem numeraÃ§Ã£o
       
       âœ… Interface mais limpa
       âœ… Foco no conteÃºdo
       âœ… Menos poluiÃ§Ã£o visual
    
    3ï¸âƒ£ CÃ“DIGO JAVASCRIPT ATUALIZADO:
       â€¢ Removidas referÃªncias a div#secao-acompanhante
       â€¢ Acompanhante agora faz parte de secao-dados-entrada
       â€¢ FunÃ§Ãµes verificarTipo() e cancelarNovoAtendimento() atualizadas
       â€¢ selecionarPaciente() simplificada
    
    ğŸ“Š ESTRUTURA FINAL DO FORMULÃRIO:
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ Buscar Paciente                     â”‚
       â”‚ â””â”€ [busca e seleÃ§Ã£o]                â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ Dados da Entrada                    â”‚
       â”‚ â”œâ”€ Data, Hora, Registro             â”‚
       â”‚ â”œâ”€ Local, Tipo, Meio               â”‚
       â”‚ â”œâ”€ Queixa (sÃ³ emergÃªncia/urgÃªncia) â”‚
       â”‚ â”œâ”€ Dados do Acompanhante (opcional)â”‚
       â”‚ â””â”€ Modelo de ProntuÃ¡rio             â”‚
       â”‚    â””â”€ MÃ³dulos aparecem aqui         â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ Manchester (sÃ³ emergÃªncia/urgÃªncia) â”‚
       â”‚ â””â”€ [classificaÃ§Ã£o de risco]         â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       
       [ğŸ’¾ Salvar] [âŒ Cancelar]
    
    ğŸ¯ BENEFÃCIOS:
       â€¢ Fluxo mais natural
       â€¢ InformaÃ§Ãµes do acompanhante coletadas junto com dados de entrada
       â€¢ Modelo de prontuÃ¡rio vem depois dos dados bÃ¡sicos
       â€¢ Interface mais limpa sem nÃºmeros
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.405 - 27/11/2025                           â•‘
    â•‘              âœ… SOLUÃ‡ÃƒO FINAL: TEMPLATES CARREGAM NA INICIALIZAÃ‡ÃƒO! âœ…         â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ PROBLEMA RESOLVIDO DE VEZ
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ› CAUSA RAIZ IDENTIFICADA:
       window.TEMPLATES_MODULOS estava definido DENTRO do mÃ©todo Sandbox.renderizarModelo()
       Isso significa que SÃ“ era criado quando alguÃ©m VISUALIZAVA um modelo no Sandbox!
       
       Quando vocÃª ia direto para Atendimentos:
       â†’ Sandbox nunca foi aberto
       â†’ renderizarModelo() nunca foi chamado
       â†’ window.TEMPLATES_MODULOS nunca foi criado
       â†’ typeof window.TEMPLATES_MODULOS === "undefined"
       â†’ Todos os mÃ³dulos falhavam!
    
    âœ… SOLUÃ‡ÃƒO IMPLEMENTADA (v10.405):
       1. Criado mÃ©todo Sandbox.carregarTemplatesGlobais()
          â†’ Define window.TEMPLATES_MODULOS independente de abrir Sandbox
       
       2. DOMContentLoaded chama Sandbox.carregarTemplatesGlobais() NO INÃCIO
          â†’ window.TEMPLATES_MODULOS criado na inicializaÃ§Ã£o do sistema
          â†’ ANTES de qualquer aba ser aberta
       
       3. Bloco original no renderizarModelo() virou fallback
          â†’ if (typeof window.TEMPLATES_MODULOS === 'undefined') { define }
          â†’ Garante compatibilidade
    
    ğŸ“Š FLUXO CORRETO AGORA:
       1. PÃ¡gina carrega
       2. DOMContentLoaded dispara
       3. Sandbox.carregarTemplatesGlobais() executa
       4. window.TEMPLATES_MODULOS criado (32 mÃ³dulos)
       5. UsuÃ¡rio pode ir direto para Atendimentos
       6. Atendimentos encontra window.TEMPLATES_MODULOS âœ…
       7. MÃ³dulos renderizam perfeitamente! âœ…
    
    ğŸ‰ RESULTADO:
       â€¢ window.TEMPLATES_MODULOS existe desde o inÃ­cio
       â€¢ Atendimentos funciona perfeitamente
       â€¢ MÃ³dulos aparecem todos
       â€¢ Sistema 100% funcional!
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.404 - 27/11/2025                           â•‘
    â•‘                  ğŸ” DEBUG ULTRA-DETALHADO DOS MÃ“DULOS ğŸ”                       â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ” DEBUG MÃXIMO ADICIONADO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ“Š LOGS PARA CADA MÃ“DULO:
       â€¢ Nome do cÃ³digo sendo buscado
       â€¢ Se window.TEMPLATES_MODULOS existe
       â€¢ Se o cÃ³digo especÃ­fico existe dentro dele
       â€¢ Lista das primeiras 10 chaves disponÃ­veis
       â€¢ Se encontrou ou nÃ£o
    
    ğŸ¯ OBJETIVO:
       Descobrir POR QUÃŠ os mÃ³dulos nÃ£o estÃ£o sendo encontrados
       mesmo que window.TEMPLATES_MODULOS exista
    
    ğŸ’¡ CONSOLE VAI MOSTRAR:
       Para cada mÃ³dulo:
       ğŸ” [v10.404] Tentando renderizar: "queixa"
       ğŸ” [v10.404] typeof window.TEMPLATES_MODULOS: object
       ğŸ” [v10.404] window.TEMPLATES_MODULOS existe? true
       ğŸ” [v10.404] window.TEMPLATES_MODULOS[queixa] existe? true/false
       â†’ Se FALSE: âŒ NÃƒO encontrado + Lista de chaves disponÃ­veis
       â†’ Se TRUE: âœ… ENCONTRADO! Renderizando
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.403 - 27/11/2025                           â•‘
    â•‘              âœ… CORREÃ‡ÃƒO FINAL: MÃ“DULOS AGORA RENDERIZAM! âœ…                   â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ PROBLEMA IDENTIFICADO E CORRIGIDO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ› ÃšLTIMO PROBLEMA:
       Modelos carregavam âœ…
       Mas mÃ³dulos nÃ£o renderizavam: âš ï¸ MÃ³dulo nÃ£o encontrado
       
       Linha 33158 (ERRADO):
       if (typeof TEMPLATES_MODULOS !== 'undefined' && TEMPLATES_MODULOS[codigo])
       
       Estava acessando TEMPLATES_MODULOS sem window.
       Como TEMPLATES_MODULOS Ã© definido como window.TEMPLATES_MODULOS,
       o cÃ³digo nÃ£o encontrava o objeto!
    
    âœ… SOLUÃ‡ÃƒO (v10.403):
       Linha 33158 (CORRETO):
       if (typeof window.TEMPLATES_MODULOS !== 'undefined' && window.TEMPLATES_MODULOS[codigo])
       
       Agora acessa corretamente window.TEMPLATES_MODULOS e encontra todos os mÃ³dulos!
    
    ğŸ“Š MÃ“DULOS DISPONÃVEIS (verificados):
       âœ… controle-hospitalar
       âœ… queixa
       âœ… hda (HistÃ³ria da DoenÃ§a Atual)
       âœ… hpp (HistÃ³ria PatolÃ³gica Pregressa)
       âœ… h-familiar
       âœ… h-social
       âœ… exame-geral
       âœ… exame-especifico
       âœ… glasgow
       âœ… braden
       âœ… abcde
       âœ… hipotese
       âœ… cid10
       âœ… evolucao
       âœ… evolucao-soap
       âœ… pos-op
       ... e mais 15 mÃ³dulos!
    
    ğŸ‰ RESULTADO FINAL:
       â€¢ Modelos carregam âœ…
       â€¢ Dropdown funciona âœ…
       â€¢ MÃ³dulos renderizam âœ…
       â€¢ Sistema 100% funcional âœ…
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.402 - 27/11/2025                           â•‘
    â•‘              âœ… CORRIGIDO: MODELOS AGORA CARREGAM! âœ…                          â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ PROBLEMA IDENTIFICADO E CORRIGIDO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ› PROBLEMA:
       Quando abria aba "Atendimentos", NADA era inicializado.
       A funÃ§Ã£o carregarModelosProntuario() SÃ“ era chamada quando 
       usuÃ¡rio clicava manualmente em "Novo Atendimento".
    
    âœ… SOLUÃ‡ÃƒO:
       Ao abrir aba "Atendimentos", sistema AUTOMATICAMENTE:
       1. Ativa sub-aba "Novo Atendimento"
       2. Chama Atendimentos.trocarAba('novo')
       3. Carrega modelos no dropdown
    
    ğŸ“Š CÃ“DIGO ALTERADO (linha 10959-10965):
       ANTES:
       if (nome === 'atendimentos') {
           console.log('Aba Atendimentos - NENHUMA inicializaÃ§Ã£o');
       }
       
       DEPOIS:
       if (nome === 'atendimentos') {
           console.log('ğŸ©º [v10.402] Inicializando aba Atendimentos...');
           setTimeout(() => {
               Atendimentos.trocarAba('novo');
               console.log('âœ… [v10.402] Sub-aba "Novo" ativada e modelos carregados');
           }, 100);
       }
    
    ğŸ‰ RESULTADO:
       Agora ao abrir Atendimentos, os 3 modelos aparecem automaticamente!
       
       Console mostra:
       ğŸ©º [v10.402] Inicializando aba Atendimentos...
       ğŸ” [DEBUG v10.401] carregarModelosProntuario() chamada
       ğŸ“Š [DEBUG] Total de modelos: 3
       âœ… [DEBUG] 3 modelos carregados com SUCESSO
       âœ… [v10.402] Sub-aba "Novo" ativada e modelos carregados
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.401 - 27/11/2025                           â•‘
    â•‘                  ğŸ” DEBUG PARA MODELOS DE ATENDIMENTO ğŸ”                       â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ” DEBUG ADICIONADO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ“‹ CONSOLE LOGS DETALHADOS:
       â€¢ carregarModelosProntuario() - indica quando funÃ§Ã£o Ã© chamada
       â€¢ Verifica se select existe
       â€¢ Mostra quantos modelos foram encontrados
       â€¢ Lista cada modelo sendo adicionado
       â€¢ Confirma sucesso final
    
    ğŸ¯ COMO USAR O DEBUG:
       1. Abra console do navegador (F12)
       2. VÃ¡ em Atendimentos â†’ Novo Atendimento
       3. Veja os logs:
          ğŸ” [DEBUG v10.401] carregarModelosProntuario() chamada
          âœ… [DEBUG] Select encontrado
          ğŸ“Š [DEBUG] Total de modelos: X
          ğŸ“‹ [DEBUG] Modelos: [array com os modelos]
          
    âš ï¸ POSSÃVEIS PROBLEMAS:
       â€¢ Se aparecer "âŒ Select NÃƒO ENCONTRADO" â†’ Problema no HTML
       â€¢ Se aparecer "ğŸ“Š Total de modelos: 0" â†’ Nenhum modelo criado
         â†’ SoluÃ§Ã£o: GestÃ£o â†’ Modelos de ProntuÃ¡rio â†’ Criar modelo
       â€¢ Se aparecer "âœ… X modelos carregados" â†’ EstÃ¡ funcionando!
    
    ğŸ’¡ MENSAGEM NO DROPDOWN:
       Se nÃ£o houver modelos, dropdown mostra:
       "âš ï¸ Nenhum modelo cadastrado (crie em GestÃ£o â†’ Modelos de ProntuÃ¡rio)"
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.400 - 27/11/2025                           â•‘
    â•‘                  âœ… CORREÃ‡Ã•ES EM ATENDIMENTOS âœ…                               â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ”§ CORREÃ‡Ã•ES IMPLEMENTADAS
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1ï¸âƒ£ MÃ“DULOS AGORA APARECEM:
       â€¢ Corrigido: TEMPLATES_MODULOS â†’ window.TEMPLATES_MODULOS
       â€¢ Ao selecionar modelo, mÃ³dulos renderizam corretamente
       â€¢ Console log mostra processo completo
    
    2ï¸âƒ£ QUEIXA PRINCIPAL CONDICIONAL:
       â€¢ Aparece APENAS para urgÃªncia/emergÃªncia (triagem)
       â€¢ Para consultas normais â†’ queixa vem dos mÃ³dulos
       â€¢ Campo Ã© obrigatÃ³rio (required) sÃ³ quando visÃ­vel
    
    ğŸ“‹ LÃ“GICA:
       â€¢ UrgÃªncia/EmergÃªncia â†’ Queixa aparece (triagem rÃ¡pida)
       â€¢ Consulta/Retorno/Outros â†’ Queixa NÃƒO aparece (vem do prontuÃ¡rio)
    
    ğŸ¯ FLUXO CORRETO:
       EmergÃªncia:
       â†’ Preencher dados entrada
       â†’ Queixa Principal (campo visÃ­vel) âœ…
       â†’ Manchester
       â†’ Selecionar modelo
       â†’ MÃ³dulos aparecem
       
       Consulta:
       â†’ Preencher dados entrada
       â†’ Queixa Principal (campo oculto) âŒ
       â†’ Selecionar modelo
       â†’ MÃ³dulos aparecem
       â†’ Queixa vem dentro do mÃ³dulo "Queixa Principal"
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.399 - 27/11/2025                           â•‘
    â•‘              âœ… FUNÃ‡ÃƒO PARA LIMPAR TODOS OS ATENDIMENTOS âœ…                    â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ—‘ï¸ LIMPEZA DE ATENDIMENTOS
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ“‹ FUNÃ‡ÃƒO ADICIONADA:
       â€¢ Atendimentos.limparTodos() - Apaga todos os atendimentos do sistema
       â€¢ Dupla confirmaÃ§Ã£o para evitar exclusÃ£o acidental
       â€¢ Atualiza automaticamente as listagens
    
    ğŸ”´ INTERFACE:
       â€¢ BotÃ£o "ğŸ—‘ï¸ Limpar Todos os Atendimentos" em zona vermelha de perigo
       â€¢ Aparece na aba "Atendimentos do Dia"
       â€¢ Design destaca o perigo da aÃ§Ã£o irreversÃ­vel
    
    âš ï¸ SEGURANÃ‡A:
       â€¢ Dupla confirmaÃ§Ã£o obrigatÃ³ria
       â€¢ Alerta sobre aÃ§Ã£o irreversÃ­vel
       â€¢ Console log para rastreamento
    
    ğŸ’¡ USO:
       Atendimentos â†’ Atendimentos do Dia â†’ ğŸ—‘ï¸ Limpar Todos
       â†’ Confirmar 2x â†’ Pronto!
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.398 - 27/11/2025                           â•‘
    â•‘              âœ… REMOÃ‡ÃƒO COMPLETA DO MODAL HORROROSO âœ…                         â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ—‘ï¸ SISTEMA RUIM DELETADO COMPLETAMENTE
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âŒ DELETADO:
       1. Modal "AtendimentoTemplate" (~79 linhas HTML)
          - Sistema horroroso com "Selecione o Template"
          - NÃ£o funcionava com os modelos do Sandbox
          - Interface confusa e redundante
       
       2. Objeto JavaScript "AtendimentoTemplate" (~667 linhas)
          - CÃ³digo paralelo que causava confusÃ£o
          - NÃ£o integrava com ModelosAtendimento
          - Sistema completamente separado e inÃºtil
       
       3. BotÃ£o "ğŸ©º Atender" que chamava o modal ruim
          - Removido da listagem de atendimentos
    
    âœ… MANTIDO (o que realmente funciona):
       â€¢ Dropdown simples em "Novo Atendimento" (v10.396)
       â€¢ Carrega modelos de SistemaCore.dados.modelos_atendimento
       â€¢ Renderiza mÃ³dulos automaticamente (v10.396)
       â€¢ Sistema limpo e direto
    
    ğŸ¯ RESULTADO:
       Agora existe APENAS UM sistema de modelos:
       â†’ GestÃ£o â†’ Modelos de ProntuÃ¡rio (criar/configurar)
       â†’ Atendimentos â†’ Novo Atendimento â†’ Dropdown (usar)
       
       Sem duplicaÃ§Ã£o, sem confusÃ£o, sem sistemas paralelos!
    
    ğŸ“Š ESTATÃSTICAS DA LIMPEZA:
       â€¢ Linhas deletadas: ~746
       â€¢ Tamanho reduzido: ~50KB
       â€¢ Complexidade: â¬‡ï¸â¬‡ï¸â¬‡ï¸
       â€¢ Clareza: â¬†ï¸â¬†ï¸â¬†ï¸
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.397 - 27/11/2025                           â•‘
    â•‘                 âœ… CORREÃ‡ÃƒO GERAÃ‡ÃƒO DE PDF - FOLHA DE ROSTO âœ…                â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ CORREÃ‡Ã•ES NO PDF DA FOLHA DE ROSTO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ› PROBLEMAS CORRIGIDOS:
       âŒ "Registro: undefined" â†’ âœ… Usa atendimento.numero_registro
       âŒ "Tipo: undefined" â†’ âœ… Usa atendimento.tipo_atendimento
       âŒ Campos com cÃ³digos â†’ âœ… Mostra texto legÃ­vel (consulta, emergÃªncia, etc)
       âŒ Dados do estabelecimento â†’ âœ… Usa SistemaCore.dados.estabelecimento
    
    âœ¨ MELHORIAS ADICIONADAS:
       â€¢ FormataÃ§Ã£o de local de entrada (RecepÃ§Ã£o, EmergÃªncia, etc)
       â€¢ FormataÃ§Ã£o de tipo de atendimento (Consulta, ğŸš¨ EmergÃªncia, etc)
       â€¢ FormataÃ§Ã£o de meio de chegada (AmbulÃ¢ncia, SAMU, etc)
       â€¢ ExibiÃ§Ã£o do modelo de prontuÃ¡rio selecionado
       â€¢ Melhor tratamento de campos nulos/undefined
    
    ğŸ“Š ESTRUTURA CORRETA DOS DADOS:
       atendimento.numero_registro     (nÃ£o "registro")
       atendimento.tipo_atendimento    (nÃ£o "tipo_entrada")
       atendimento.local_entrada       âœ“ correto
       atendimento.meio_chegada        âœ“ correto
       atendimento.queixa_principal    âœ“ correto
       atendimento.modelo_prontuario  âœ“ adicionado
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.396 - 27/11/2025                           â•‘
    â•‘           âœ… PUXAR MODELOS DE PRONTUÃRIO EM ATENDIMENTOS âœ…                    â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ OBJETIVO: INTEGRAR MODELOS DE PRONTUÃRIO NO FLUXO DE ATENDIMENTO
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… FLUXO COMPLETO IMPLEMENTADO:
       1ï¸âƒ£ GestÃ£o â†’ Modelos de ProntuÃ¡rio
          - Criar modelos personalizados
          - Selecionar mÃ³dulos desejados (checkboxes)
          - Salvar configuraÃ§Ã£o
       
       2ï¸âƒ£ Atendimentos â†’ Novo Atendimento
          - Selecionar paciente
          - Dropdown carrega modelos disponÃ­veis âœ… (jÃ¡ existia)
          - Selecionar modelo âœ… (NOVO - v10.396)
          - MÃ³dulos renderizam automaticamente âœ… (NOVO - v10.396)
          - Preencher dados do paciente
          - Salvar atendimento
    
    ğŸ”§ IMPLEMENTAÃ‡Ã•ES v10.396:
       â€¢ onchange no dropdown de modelos (linha ~5593)
       â€¢ Container dinÃ¢mico para mÃ³dulos (id="atend-modulos-container")
       â€¢ Atendimentos.carregarModulosProntuario(modeloId)
       â€¢ Atendimentos.limparModulosProntuario()
       â€¢ TEMPLATES_MODULOS tornado global (window.TEMPLATES_MODULOS)
       â€¢ Suporte a AnatomiaAtendimento se modelo incluir mapa anatÃ´mico
       â€¢ ProntuarioModular funciona automaticamente (botÃµes, pools, modais)
    
    ğŸ“Š EXEMPLO DE USO:
       Modelo "Consulta de Queimado" inclui:
       - Queixa Principal
       - HistÃ³ria da DoenÃ§a Atual  
       - HistÃ³ria PatolÃ³gica Pregressa (alergias, medicaÃ§Ãµes, cirurgias)
       - Exame FÃ­sico Geral
       - Mapa AnatÃ´mico Interativo
       - AvaliaÃ§Ã£o de Queimaduras
       - HipÃ³tese DiagnÃ³stica
       - Conduta
    
       Ao selecionar este modelo em Atendimentos:
       â†’ Todos esses mÃ³dulos aparecem automaticamente
       â†’ MÃ©dico preenche dados especÃ­ficos do paciente
       â†’ Sistema salva com estrutura completa
    
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.346 - 24/11/2025                           â•‘
    â•‘      âœ… ARQUITETURA UNIFICADA: MODELOS DE PRONTUÃRIO âœ…                        â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ GRANDE REFATORAÃ‡ÃƒO - UNIFICAÃ‡ÃƒO DE CONCEITOS (v10.346):
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ“‹ ANTES (confuso):
       â€¢ CabeÃ§alhos (layout visual)
       â€¢ Templates (mÃ³dulos de conteÃºdo) â† REDUNDANTE
       â€¢ Modelos de Atendimento (configuraÃ§Ãµes) â† REDUNDANTE
       â€¢ Sandbox (teste)
    
    ğŸ“‹ AGORA (simplificado):
       â€¢ ğŸ¨ CabeÃ§alhos (layout visual - mantido)
       â€¢ ğŸ“‹ Modelos de ProntuÃ¡rio (UNIFICADO: cabeÃ§alho + mÃ³dulos + config)
       â€¢ ğŸ§ª Sandbox (teste)
    
    ğŸ”— MODELO DE PRONTUÃRIO INCLUI TUDO:
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ ğŸ“ IdentificaÃ§Ã£o: Nome, Tipo, Especialidade     â”‚
       â”‚ ğŸ¨ CabeÃ§alho: Selecionar layout salvo           â”‚
       â”‚ ğŸ“‹ MÃ³dulos do ProntuÃ¡rio:                        â”‚
       â”‚    ğŸ—£ï¸ Anamnese (Queixa, HDA, HPP, Alergias...)  â”‚
       â”‚    Exame FÃ­sico (Geral, EspecÃ­fico, Mapa)    â”‚
       â”‚    ğŸ“ DiagnÃ³stico (HipÃ³tese, CID, Conduta...)   â”‚
       â”‚    âš•ï¸ CirÃºrgicos (Desc.Op, Planejamento...)    â”‚
       â”‚    ğŸ›ï¸ InternaÃ§Ã£o (SOAP, BalanÃ§o, Alta...)       â”‚
       â”‚ ğŸ©º Sinais Vitais e Antropometria                â”‚
       â”‚ ğŸ“Š Escalas ClÃ­nicas                             â”‚
       â”‚ â±ï¸ Timer de DuraÃ§Ã£o                             â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    ğŸ”§ CORREÃ‡Ã•ES:
       âœ… Loop EditorVisual silenciado
       âœ… Warning de template "dermatologia" removido
       âœ… ComparaÃ§Ã£o de IDs robusta no Sandbox
       âœ… Sub-aba Templates removida (redundante)
    
    ğŸ“Š BASE: v10.345 (CorreÃ§Ã£o Agenda/Reservas)
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.345 - 24/11/2025                           â•‘
    â•‘          âœ… CORREÃ‡ÃƒO: AGENDA/RESERVAS EM UNIDADES SIMPLES (1 SALA) âœ…         â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ”§ CORREÃ‡Ã•ES CRÃTICAS (v10.345):
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ› PROBLEMAS IDENTIFICADOS:
       âŒ Na aba Agenda > Mapa das Unidades: agendamentos filtrados por "hoje" por padrÃ£o
       âŒ Unidades simples (1 sala) nÃ£o mostravam agendamentos corretamente
       âŒ Filtro de data causava "Nenhum agendamento" mesmo com agendamentos futuros
       âŒ Reservas de leitos nÃ£o apareciam quando fora do calendÃ¡rio
    
    âœ… SOLUÃ‡ÃƒO IMPLEMENTADA:
       
       1ï¸âƒ£ FILTRO DE DATA OPCIONAL:
          â€¢ Removido filtro automÃ¡tico de data "hoje" na inicializaÃ§Ã£o
          â€¢ Agora mostra TODOS os agendamentos por padrÃ£o
          â€¢ UsuÃ¡rio pode filtrar por data quando desejar
          â€¢ BotÃ£o âœ• para limpar filtro de data
       
       2ï¸âƒ£ ORDENAÃ‡ÃƒO INTELIGENTE:
          â€¢ Agendamentos de hoje aparecem primeiro
          â€¢ Depois ordenados por data e hora
          â€¢ Funciona tanto para grupos quanto unidades simples
       
       3ï¸âƒ£ UNIDADES SIMPLES (1 SALA):
          â€¢ Agendamentos agora aparecem corretamente
          â€¢ Reservas de leitos visÃ­veis
          â€¢ Status de ocupaÃ§Ã£o exibido corretamente
    
    ğŸ“Š BASE: v10.344 (Isolamento Atlas)
    âœ… Todas as funcionalidades anteriores mantidas
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.342 - 20/11/2025                           â•‘
    â•‘              âœ… ISOLAMENTO TOTAL DOS ATLAS - VAZAMENTOS CORRIGIDOS âœ…          â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ”§ CORREÃ‡Ã•ES CRÃTICAS (v10.342):
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ› PROBLEMA IDENTIFICADO:
       âŒ Editor estava usando referÃªncias DIRETAS aos atlas globais
       âŒ Modificar ATLAS_LUND_BROWDER vazava para ATLAS_QUEIMADOS e vice-versa
       âŒ Salvamentos misturavam regiÃµes entre atlas diferentes
       âŒ Ã€s vezes Lund-Browder carregava regiÃµes da Regra dos 9
    
    âœ… SOLUÃ‡ÃƒO IMPLEMENTADA - ISOLAMENTO TOTAL:
       
       1ï¸âƒ£ CARREGAMENTO NO EDITOR:
          â€¢ EditorAtlas.inicializar() â†’ usa deepCopyAtlas()
          â€¢ EditorAtlas.trocarAtlas() â†’ usa deepCopyAtlas()
          â€¢ Cada atlas tem sua PRÃ“PRIA cÃ³pia independente
       
       2ï¸âƒ£ SALVAMENTO NO EDITOR:
          â€¢ EditorAtlas.salvar() â†’ usa JSON.parse(JSON.stringify())
          â€¢ Cria cÃ³pia profunda antes de atualizar atlas global
          â€¢ Elimina compartilhamento de referÃªncias
       
       3ï¸âƒ£ GARANTIAS:
          â€¢ ATLAS_ANATOMICO mantÃ©m suas 18 regiÃµes
          â€¢ ATLAS_QUEIMADOS mantÃ©m suas 13 regiÃµes (Regra dos 9)
          â€¢ ATLAS_LUND_BROWDER mantÃ©m suas regiÃµes especÃ­ficas
          â€¢ ZERO vazamento entre atlas
    
    ğŸ’¡ CONCEITO TÃ‰CNICO:
       â€¢ Antes: this.atlasAtual = ATLAS_XXX (referÃªncia compartilhada)
       â€¢ Agora: this.atlasAtual = deepCopyAtlas(ATLAS_XXX) (cÃ³pia isolada)
       â€¢ Resultado: Modificar um nÃ£o afeta outros
    
    ğŸ“Š BASE: v10.341 (Pintar 100% + SobreposiÃ§Ãµes)
    âœ… Todas as funcionalidades anteriores mantidas
    âœ… Performance preservada
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.337 - 20/11/2025                           â•‘
    â•‘                    âœ… CORREÃ‡ÃƒO: IDADE CRIANÃ‡A âœ…                               â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ”§ CORREÃ‡Ã•ES (v10.337):
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… DEFINIÃ‡ÃƒO CONSISTENTE DE CRIANÃ‡A:
       â€¢ ANTES: Usava < 18 anos em uma funÃ§Ã£o e < 13 em outra
       â€¢ AGORA: Padronizado < 13 anos em TODAS as funÃ§Ãµes
       â€¢ Alinhado com protocolos de queimados
    
    âœ… CRITÃ‰RIOS AJUSTADOS:
       â€¢ ANTES: SCQ > 5% (nÃ£o incluÃ­a 5.0% exato)
       â€¢ AGORA: SCQ â‰¥ 5% (mais seguro, inclui 5.0%)
       â€¢ Evita nÃ£o internar quem deveria ser internado
    
    ğŸ¯ TESTES VALIDADOS:
       â€¢ CrianÃ§a 8 anos, 4.9% â†’ ğŸŸ¢ Pequeno (ambulatorial)
       â€¢ CrianÃ§a 8 anos, 5.0% â†’ ğŸŸ¡ MÃ©dio (INTERNA) âœ…
       â€¢ CrianÃ§a 8 anos, 11% â†’ ğŸ”´ Grande (INTERNA) âœ…
       â€¢ Adulto 30 anos, 9% â†’ ğŸŸ¢ Pequeno (ambulatorial)
       â€¢ Adulto 30 anos, 10% â†’ ğŸŸ¡ MÃ©dio (INTERNA) âœ…
    
    ğŸ“Š BASE: v10.336 (ClassificaÃ§Ã£o Final)
    âœ… Todas as funcionalidades anteriores mantidas
    
    âœ… MANTÃ‰M (v10.322):
       â€¢ Reparo automÃ¡tico de regiÃµes
       â€¢ ValidaÃ§Ã£o de paths
       â€¢ BotÃ£o adicionar pontos
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.338 - 3Âº GRAU REFINADO: < 2% aceitÃ¡vel, >= 2% interna, Ã¡rea nobre agrava âœ… -->
    <!-- v10.269 - PERCENTUAIS LUND-BROWDER 100% CORRETOS + 2 SVGs funcionando âœ… -->
    <!-- v10.268 - INTEGRAÃ‡Ã•ES: Idade no cabeÃ§alho, Peso de Antropometria, IMC automÃ¡tico, Faixa Lund-Browder automÃ¡tica âœ… -->
    <!-- v10.267 - FERRAMENTAS NA COLUNA DIREITA + PROTOCOLOS ABAIXO DO GRID âœ… -->
    <!-- v10.260 - LUND-BROWDER COM COORDENADAS CORRIGIDAS DO JSON! ğŸ”§ -->
    <!-- v10.267 - FERRAMENTAS NA COLUNA DIREITA + PROTOCOLOS ABAIXO DO GRID âœ… -->
    <!-- v10.260 - LUND-BROWDER COM COORDENADAS CORRIGIDAS DO JSON! ğŸ”§ -->
    
    <!-- 
    ğŸ¯ ARQUITETURA IMPLEMENTADA (v10.260):
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1ï¸âƒ£ ATLAS_ANATOMICO (Mapa anatÃ´mico detalhado)
       âœ… ~124 regiÃµes anatÃ´micas
       âœ… Coordenadas originais perfeitas
       âœ… Usado para exames gerais
    
    2ï¸âƒ£ ATLAS_QUEIMADOS (Regra dos 9)
       âœ… 13 regiÃµes grandes e simples
       âœ… Percentuais fixos (cabeÃ§a 9%, tronco 18%, etc)
       âœ… Usado para queimaduras adultas
    
    3ï¸âƒ£ ATLAS_LUND_BROWDER v3.1 (Lund-Browder anatÃ´mico) âœ¨âœ¨âœ¨ CORRIGIDO!
       âœ… 32 REGIÃ•ES ANATÃ”MICAS DETALHADAS
       âœ… Coordenadas CORRETAS extraÃ­das do silhueta-completo-2.json
       âœ… PolÃ­gonos pequenos e precisos (5-20 pontos cada)
       âœ… Percentuais variam por idade (0-1, 1-4, 5-9, 10-14, 15+)
       âœ… Mapeamento preciso: cabeÃ§a, pescoÃ§o, tronco, MS (braÃ§o/antebraÃ§o/mÃ£o), MI (coxa/perna/pÃ©)
       âœ… TODOS somam exatamente 100% em cada faixa etÃ¡ria
    
    ğŸ”§ MUDANÃ‡A PRINCIPAL (v10.260):
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âŒ ANTES (v10.259): Coordenadas erradas/misturadas (pÃ© com 38 pontos incluindo perna)
    âœ… AGORA (v10.260): Coordenadas CORRETAS do JSON original (pÃ© com 6-7 pontos precisos)
    
    ğŸ“Š RESULTADO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… 3 atlas TOTALMENTE SEPARADOS e INDEPENDENTES
    âœ… ATLAS_ANATOMICO: ~124 regiÃµes (coordenadas originais)
    âœ… ATLAS_QUEIMADOS: 13 regiÃµes (Regra dos 9)
    âœ… ATLAS_LUND_BROWDER v3.1: 32 regiÃµes (coordenadas CORRETAS)
    âœ… TODOS os polÃ­gonos perfeitamente alinhados e PRECISOS
    âœ… Silhueta: y='0', height='1200' (sem alteraÃ§Ãµes)
    
    ğŸ¯ LUND-BROWDER v3.1 - 32 REGIÃ•ES CORRIGIDAS:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    - CabeÃ§a: 2 regiÃµes (ant/post, 10 pontos cada) - 19% â†’ 7% (varia com idade)
    - PescoÃ§o: 2 regiÃµes (ant/post, 5 pontos cada) - 1% cada (fixo)
    - Tronco: 3 regiÃµes (ant 15pts, post 16pts, glÃºteos 10pts)
    - GenitÃ¡lia: 1 regiÃ£o (2 pontos) - 1% (fixo)
    
    - Membros Superiores: 12 regiÃµes (1.5% cada, fixo)
      â€¢ BraÃ§o E/D (ant/post): 4 regiÃµes (5-6 pontos) = 6%
      â€¢ AntebraÃ§o E/D (ant/post): 4 regiÃµes (6-7 pontos) = 6%
      â€¢ MÃ£o E/D (ant/post): 4 regiÃµes (9-10 pontos) = 6%
    
    - Membros Inferiores: 12 regiÃµes (varia com idade)
      â€¢ Coxa E/D (ant/post): 4 regiÃµes (7-8 pontos) = 20.4% â†’ 27.6%
      â€¢ Perna E/D (ant/post): 4 regiÃµes (6-8 pontos) = 11.9% â†’ 16.1%
      â€¢ PÃ© E/D (ant/post): 4 regiÃµes (6-7 pontos) = 1.7% â†’ 2.3%
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    TOTAL: 32 regiÃµes = 100.00% (validado em todas as faixas etÃ¡rias)
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.260 - LUND-BROWDER CORRIGIDO (coordenadas do JSON) âœ… -->
    <!-- v10.262 - REGIÃ•ES EM ORDEM ANATÃ”MICA (CabeÃ§aâ†’PescoÃ§oâ†’Troncoâ†’MSâ†’MI) âœ… -->
    <!-- v10.264 - LAYOUT 2 COLUNAS: Peso/Idade horizontalizados, Silhueta em tamanho ideal âœ… -->
    <!-- v10.265 - FERRAMENTAS ABAIXO DA SILHUETA: Grid 2x2 prÃ³ximo da Ã¡rea de trabalho âœ… -->
    <!-- v10.267 - FERRAMENTAS NA COLUNA DIREITA: Puxados das anotaÃ§Ãµes do atendimento âœ… -->
    <!-- v10.267 - FERRAMENTAS NA COLUNA DIREITA + PROTOCOLOS ABAIXO DO GRID âœ… -->
    <!-- v10.259 - LUND-BROWDER COM 32 REGIÃ•ES ANATÃ”MICAS âœ… -->
    <!-- v10.258 - 3 ATLAS INDEPENDENTES (coordenadas ATLAS_ANATOMICO) âœ… -->
    <!-- v10.242 - PROTOCOLOS QUEIMADURAS -->
    <!-- v10.239 - PINTURA QUEIMADURAS âœ… -->
    <!-- v10.238 - ATLAS_QUEIMADOS (Regra dos 9) -->
    <!-- 
    1ï¸âƒ£ CANVAS OVERLAY PARA PINTURA:
       âœ… Canvas HTML5 sobreposto aos SVGs (anterior e posterior)
       âœ… Pintura interativa com mouse/touch
       âœ… DetecÃ§Ã£o de ponto em polÃ­gono (ray casting)
       âœ… ConversÃ£o de PATH para array de pontos
    
    2ï¸âƒ£ SISTEMA DE PINTURA:
       âœ… Seletor de grau (2Âº/3Âº) jÃ¡ existente
       âœ… Controle de tamanho de pincel (5-30px)
       âœ… BotÃ£o para limpar toda a pintura
       âœ… Cores diferentes por grau (laranja=2Âº, vermelho=3Âº)
    
    3ï¸âƒ£ CÃLCULO AUTOMÃTICO:
       âœ… Contagem de pixels pintados por regiÃ£o
       âœ… CÃ¡lculo de % SCQ baseado em pixels
       âœ… FÃ³rmula de Parkland atualizada
       âœ… Dados aparecem no painel lateral direito
    
    4ï¸âƒ£ INTERFACE APRIMORADA:
       âœ… Lista lateral mostra % por regiÃ£o pintada
       âœ… SCQ total e por grau
       âœ… Volume de Parkland com distribuiÃ§Ã£o 8h/16h
    
    ğŸ“Š RESULTADO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… Pintura direta na silhueta (sem dialog boxes)
    âœ… CÃ¡lculo preciso baseado em pixels pintados
    âœ… Interface intuitiva e responsiva
    âœ… Dados atualizados em tempo real no painel lateral
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.239 - PINTURA QUEIMADURAS (ATUAL) âœ… -->
    <!-- v10.238 - ATLAS_QUEIMADOS (Regra dos 9) -->
    <!-- v10.231 - IMAGENS + NOMENCLATURAS -->
    <!-- v10.230 - TEMPLATES DETALHADOS + HIERARQUIA -->
    <!-- v10.229 - TEMPLATES NARIZ/ORELHA -->
    <!-- v10.228 - LIMPEZA CAMPOS DUPLICADOS -->
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.227 - 17/11/2025                           â•‘
    â•‘                      ğŸ”„ PESCOÃ‡O: CORREÃ‡ÃƒO DA HIERARQUIA                       â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ CORREÃ‡Ã•ES IMPLEMENTADAS:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… RESTAURADO:
       â€¢ OpÃ§Ã£o "PescoÃ§o" (regiÃ£o completa) como primeira opÃ§Ã£o
    
    âœ… RENOMEADO:
       â€¢ "PescoÃ§o (anterior)" â†’ "RegiÃ£o cervical anterior"
       â€¢ Adicionado indentVisual para melhor visualizaÃ§Ã£o
    
    âœ… REMOVIDO:
       â€¢ "RegiÃ£o cervical lateral (bilateral)" com filhos D/E (redundante)
    
    ğŸ“Š ESTRUTURA FINAL:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    PescoÃ§o (ao clicar no polÃ­gono):
    
    â–¡ PescoÃ§o                                    â† OPÃ‡ÃƒO PAI (regiÃ£o completa)
    
    â–¼ RegiÃ£o cervical anterior                   â† RENOMEADO (indentado)
      â–¶ Linha mÃ©dia cervical
        â–¡ RegiÃ£o supra-hiÃ³idea
        â–¡ RegiÃ£o infra-hiÃ³idea
        â–¡ Fossa supraesternal
      â–¶ TriÃ¢ngulo anterior (bilateral)
        â–¡ TriÃ¢ngulo anterior D
        â–¡ TriÃ¢ngulo anterior E
      â–¶ RegiÃ£o esternocleidomastÃ³idea (bilateral)
        â–¡ RegiÃ£o esternocleidomastÃ³idea D
        â–¡ RegiÃ£o esternocleidomastÃ³idea E
      â–¶ Fossa supraclavicular (bilateral)
        â–¡ Fossa supraclavicular D
        â–¡ Fossa supraclavicular E
    
    â†‘ CabeÃ§a e PescoÃ§o                           â† NAVEGAÃ‡ÃƒO
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.227 - PESCOÃ‡O CORRIGIDO (ATUAL) âœ… -->
    <!-- v10.226 - REORGANIZAÃ‡ÃƒO HIERARQUIA PESCOÃ‡O (ERRO - removeu opÃ§Ã£o pai) -->
    <!-- v10.225 - ALINHAMENTO TOTAL Ã€ ESQUERDA -->
    <!-- v10.224 - BOTÃƒO ESCALAS RESTAURADO -->
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.226 - 17/11/2025                           â•‘
    â•‘                      ğŸ”„ REORGANIZAÃ‡ÃƒO HIERARQUIA PESCOÃ‡O                      â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ MUDANÃ‡AS ESTRUTURAIS:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… HIERARQUIA DO PESCOÃ‡O (ANTERIOR):
    
    1ï¸âƒ£ REMOVIDO:
       âŒ OpÃ§Ã£o "PescoÃ§o" (completo)
       âŒ OpÃ§Ã£o "RegiÃ£o cervical anterior (bilateral)" e filhos D/E (redundante)
    
    2ï¸âƒ£ RENOMEADO:
       "PescoÃ§o (anterior)" â†’ "RegiÃ£o cervical anterior"
    
    3ï¸âƒ£ MANTIDO COMO FILHOS DE "RegiÃ£o cervical anterior":
       âœ“ Linha mÃ©dia cervical (expandÃ­vel)
         â””â”€ RegiÃ£o supra-hiÃ³idea
         â””â”€ RegiÃ£o infra-hiÃ³idea
         â””â”€ Fossa supraesternal
       âœ“ TriÃ¢ngulo anterior (bilateral)
         â””â”€ D / E
       âœ“ RegiÃ£o esternocleidomastÃ³idea (bilateral)
         â””â”€ D / E
       âœ“ Fossa supraclavicular (bilateral)
         â””â”€ D / E
       âœ“ RegiÃ£o cervical lateral (bilateral)
         â””â”€ D / E
    
    ğŸ“Š ANTES vs AGORA:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    âŒ ANTES:
    â–¡ PescoÃ§o
    â–¼ PescoÃ§o (anterior)
      â–¶ Linha mÃ©dia cervical
      â–¶ TriÃ¢ngulo anterior (bilateral)
      â–¶ RegiÃ£o esternocleidomastÃ³idea (bilateral)
      â–¶ Fossa supraclavicular (bilateral)
    â–¡ RegiÃ£o cervical anterior (bilateral) [REDUNDANTE]
      â–¡ D
      â–¡ E
    â–¡ RegiÃ£o cervical lateral (bilateral)
      â–¡ D
      â–¡ E
    
    âœ… AGORA:
    â–¼ RegiÃ£o cervical anterior
      â–¶ Linha mÃ©dia cervical
      â–¶ TriÃ¢ngulo anterior (bilateral)
      â–¶ RegiÃ£o esternocleidomastÃ³idea (bilateral)
      â–¶ Fossa supraclavicular (bilateral)
      â–¶ RegiÃ£o cervical lateral (bilateral)
    
    ğŸ¯ RESULTADO:
    - Estrutura mais limpa e lÃ³gica
    - Sem redundÃ¢ncias
    - Todos os subnÃ­veis indentados corretamente
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.226 - REORGANIZAÃ‡ÃƒO HIERARQUIA PESCOÃ‡O (ATUAL) âœ… -->
    <!-- v10.225 - ALINHAMENTO TOTAL Ã€ ESQUERDA -->
    <!-- v10.224 - BOTÃƒO ESCALAS RESTAURADO -->
    <!-- v10.223 - LIMPEZA VISUAL E UX -->
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.225 - 17/11/2025                           â•‘
    â•‘                    â—€ï¸ ALINHAMENTO TOTAL Ã€ ESQUERDA                            â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ CORREÃ‡ÃƒO IMPLEMENTADA:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… ALINHAMENTO DOS RADIOS:
       â€¢ Container externo: text-align: left
       â€¢ Container dos radios: align-items: flex-start + width: 100%
       â€¢ Labels: display: flex + align-items: center + width: 100%
       â€¢ Texto do radio: Envolvido em <span> com text-align: left
       â€¢ Input radio: flex-shrink: 0 (nÃ£o encolhe)
       â€¢ Padding dos labels: 4px 0 (sem padding lateral)
    
    ğŸ“Š ANTES vs AGORA:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    âŒ ANTES (v10.224):
           â—‹ I - Normal              [centralizado]
           â—‹ II - RecessÃ£o...
    
    âœ… AGORA (v10.225):
    â—‹ I - Normal                     [alinhado Ã  esquerda]
    â—‹ II - RecessÃ£o frontotemporal leve
    â—‹ IIA - RecessÃ£o frontal anterior
    ...
    
    ğŸ”§ CÃ“DIGO CSS:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    Container: display: flex; flex-direction: column; align-items: flex-start
    Label: display: flex; align-items: center; width: 100%
    Texto: <span style="text-align: left;">
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.225 - ALINHAMENTO TOTAL Ã€ ESQUERDA (ATUAL) âœ… -->
    <!-- v10.224 - BOTÃƒO ESCALAS RESTAURADO -->
    <!-- v10.223 - LIMPEZA VISUAL E UX -->
    <!-- v10.222 - DEBUG ESCALAS CONDICIONAIS -->
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.224 - 17/11/2025                           â•‘
    â•‘                      âš™ï¸ BOTÃƒO "VER ESCALAS" RESTAURADO                        â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ CORREÃ‡ÃƒO IMPLEMENTADA:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    âœ… BOTÃƒO âš™ï¸ "VER ESCALAS":
       â€¢ Adicionado ao lado dos labels das escalas (Norwood-Hamilton e Ludwig)
       â€¢ Detecta automaticamente campos com id 'norwood-hamilton' ou 'ludwig'
       â€¢ Estilo: BotÃ£o azul pequeno com Ã­cone âš™ï¸
       â€¢ Funcionalidade: Abre modal com imagens e descriÃ§Ãµes das escalas
    
    ğŸ“Š VISUAL DO CAMPO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    Escala de Norwood-Hamilton:  [âš™ï¸ Ver escalas]
    â˜ I - Normal
    â˜ II - RecessÃ£o frontotemporal leve
    â˜ IIA - RecessÃ£o frontal anterior
    ...
    
    ğŸ”§ CÃ“DIGO:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    const isEscalaCalvicie = campo.id === 'norwood-hamilton' || campo.id === 'ludwig';
    
    Label renderizado com display: flex para alinhar texto + botÃ£o
    BotÃ£o sÃ³ aparece quando isEscalaCalvicie === true
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.224 - BOTÃƒO ESCALAS RESTAURADO (ATUAL) âœ… -->
    <!-- v10.223 - LIMPEZA VISUAL E UX -->
    <!-- v10.222 - DEBUG ESCALAS CONDICIONAIS -->
    <!-- v10.221 - CALVÃCIE COMO OPÃ‡ÃƒO SEPARADA -->
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.223 - 17/11/2025                           â•‘
    â•‘                          âœ¨ LIMPEZA VISUAL E UX                               â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ MELHORIAS IMPLEMENTADAS:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1ï¸âƒ£ ESCALAS DE CALVÃCIE:
       âœ… Radios alinhados Ã  ESQUERDA (text-align: left)
       âœ… Labels com display: block para melhor alinhamento
       âœ… Removido campo redundante "ObservaÃ§Ãµes" do template tricolÃ³gico
    
    2ï¸âƒ£ NOMES SIMPLIFICADOS:
       âœ… Criado mÃ©todo limparNomeExibicao() global
       âœ… Remove sufixos: (anterior), (posterior), (avaliaÃ§Ã£o tricolÃ³gica completa)
       âœ… Aplicado em:
          â€¢ Caminho hierÃ¡rquico no header: "CabeÃ§a e pescoÃ§o > CabeÃ§a"
          â€¢ TÃ­tulo do popup: "CABEÃ‡A E PESCOÃ‡O"
          â€¢ Nomes das opÃ§Ãµes na Ã¡rvore: "CalvÃ­cie" em vez de "CalvÃ­cie (avaliaÃ§Ã£o...)"
    
    ğŸ“Š ANTES vs AGORA:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    âŒ ANTES:
       ğŸ“ CabeÃ§a e pescoÃ§o (anterior) > CabeÃ§a (anterior)
       CABEÃ‡A E PESCOÃ‡O (ANTERIOR)
       â–¡ CalvÃ­cie (avaliaÃ§Ã£o tricolÃ³gica completa)
    
    âœ… AGORA:
       ğŸ“ CabeÃ§a e pescoÃ§o > CabeÃ§a
       CABEÃ‡A E PESCOÃ‡O
       â–¡ CalvÃ­cie
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.223 - LIMPEZA VISUAL E UX (ATUAL) âœ… -->
    <!-- v10.222 - DEBUG ESCALAS CONDICIONAIS -->
    <!-- v10.221 - CALVÃCIE COMO OPÃ‡ÃƒO SEPARADA -->
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.222 - 17/11/2025                           â•‘
    â•‘                      ğŸ”§ DEBUG: ESCALAS CONDICIONAIS                           â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ CORREÃ‡Ã•ES IMPLEMENTADAS:
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    1ï¸âƒ£ ativarCamposCondicionais():
       âŒ ANTES: Procurava apenas por `:checked`, retornava undefined quando nenhum radio estava selecionado
       âœ… AGORA: Verifica se existe radio checked, se nÃ£o existir conta quantos radios existem (debug)
                 Melhor log mostrando "valor atual vs valor esperado"
    
    2ï¸âƒ£ salvarCampo():
       âŒ ANTES: Log mostrava apenas nome da regiÃ£o
       âœ… AGORA: Log mostra "campo = valor" de forma clara
    
    3ï¸âƒ£ atualizarCamposCondicionais():
       âŒ ANTES: Parse incorreto do containerId (pegava apenas partes[1])
       âœ… AGORA: Parse correto usando slice() para IDs compostos
                 Logs detalhados de cada etapa do processo
    
    ğŸ“Š LOGS ESPERADOS AO SELECIONAR "MASCULINO":
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    ğŸ’¾ Campo "sexo-paciente" = "Masculino" salvo para: CalvÃ­cie...
    ğŸ”„ atualizarCamposCondicionais chamado: { id, campoMudado, novoValor }
      Parsed: { containerId: "sandbox-container-anatomia", index: 0 }
      Template ID: avaliacao-tricologica
    ğŸ”„ ativarCamposCondicionais: regiao-sandbox-container-anatomia-0, avaliacao-tricologica
      Campo: norwood-hamilton, CondiÃ§Ã£o: sexo-paciente=Masculino
      Valor atual: Masculino
      âœ… Mostrando norwood-hamilton
      Campo: ludwig, CondiÃ§Ã£o: sexo-paciente=Feminino
      Valor atual: Masculino
      âŒ Escondendo ludwig (valor atual: Masculino, esperado: Feminino)
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.222 - DEBUG ESCALAS CONDICIONAIS (ATUAL) âœ… -->
    <!-- v10.221 - CALVÃCIE COMO OPÃ‡ÃƒO SEPARADA -->
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘                           VERSÃƒO 10.190 - 16/11/2025                           â•‘
    â•‘            ğŸ¯ MARCO: ORELHAS VIRTUAIS E SIMPLIFICAÃ‡ÃƒO HIERÃRQUICA             â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    ğŸ¯ HIERARQUIA SIMPLIFICADA: COURO CABELUDO POSTERIOR
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    âŒ ANTES (v10.188-189): PolÃ­gonos pequenos e fragmentados
               - RegiÃ£o occipital
               - RegiÃ£o parietal (bilateral) com filhos D/E
               - RegiÃ£o retroauricular (bilateral) com filhos D/E
               - RegiÃ£o mastoidea (bilateral) com filhos D/E
    
    âœ… AGORA (v10.190): Estrutura simplificada e intuitiva
               ğŸ“ CabeÃ§a e pescoÃ§o (posterior) > CabeÃ§a (posterior)
               
               CABEÃ‡A (POSTERIOR)
               Escolha o nÃ­vel de detalhe:
               
               â–¡ Couro cabeludo
               â–¶ Orelhas (bilateral - visÃ£o posterior) [VIRTUAL]
                 â”œâ”€ â–¡ Orelha D (visÃ£o posterior)
                 â””â”€ â–¡ Orelha E (visÃ£o posterior)
               â–¡ CabeÃ§a posterior
               â†‘ CabeÃ§a e pescoÃ§o (posterior)
               â†‘ CabeÃ§a (posterior)
    
    ğŸ“ MudanÃ§as implementadas:
       âœ“ Removidos polÃ­gonos pequenos: occipital, parietal, retroauricular, mastoidea
       âœ“ Adicionadas ORELHAS VIRTUAIS com lateralidade
       âœ“ Caminho hierÃ¡rquico atualizado para "CabeÃ§a e pescoÃ§o (posterior) > CabeÃ§a (posterior)"
       âœ“ OpÃ§Ãµes com filhos iniciam COLAPSADAS (â–¶) em vez de expandidas (â–¼)
       âœ“ Adicionada opÃ§Ã£o "CabeÃ§a posterior" (polÃ­gono completo)
       âœ“ BotÃµes de navegaÃ§Ã£o corrigidos com poligonoAlvo
    
    ğŸ†• ORELHAS VIRTUAIS:
       â€¢ NÃ£o possuem polÃ­gono fÃ­sico no SVG (virtual: true)
       â€¢ Permitem documentaÃ§Ã£o de achados na regiÃ£o auricular posterior
       â€¢ Suportam lateralidade (bilateral, direita, esquerda)
       â€¢ Filhos (D/E) ficam colapsados atÃ© o usuÃ¡rio expandir
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ’¡ EXEMPLO DE USO:
       Procedimento: Exame de couro cabeludo + otoscopia externa
       
       1. Clica em "Couro cabeludo posterior" (vista posterior)
       2. Popup mostra 5 opÃ§Ãµes principais (filhos colapsados)
       3. Seleciona "Couro cabeludo" + expande "Orelhas" e marca "Bilateral"
       4. Confirma
       4. Resultado: 2 cards criados automaticamente
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    
    ğŸ“Š FEATURES MANTIDAS da v10.184:
       âœ… Vista corrigida (Anterior/Posterior respeitada)
       âœ… SeleÃ§Ã£o mÃºltipla com checkboxes
       âœ… Lateralidade individual por regiÃ£o
       âœ… Contador dinÃ¢mico de seleÃ§Ãµes
       âœ… Templates especÃ­ficos preservados
       âœ… NavegaÃ§Ã£o hierÃ¡rquica (â†‘ â†“)
    
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    -->
    
    <!-- v10.190 - ORELHAS VIRTUAIS E SIMPLIFICAÃ‡ÃƒO HIERÃRQUICA (ATUAL) âœ… -->
    <!-- v10.189 - HIERARQUIA COLAPSADA + NAVEGAÃ‡ÃƒO CORRIGIDA -->
    <!-- v10.188 - ANATOMIA COURO CABELUDO POSTERIOR CORRIGIDA -->
    <!-- v10.184 - VISTA CORRIGIDA + SELEÃ‡ÃƒO MÃšLTIPLA -->
    <!-- v10.176 - BOTÃ•ES DE NAVEGAÃ‡ÃƒO FUNCIONANDO -->
    <!-- v10.161 - Hierarquias anatÃ´micas completas (Face, PescoÃ§o, TÃ³rax, Coxas, MÃ£os) -->
    <!-- v10.160 - Hierarquia com filtros + painel lateral campos -->
    <!-- v10.133 - MÃ³dulo de Mapeamento AnatÃ´mico (removido - integraÃ§Ã£o incorreta) -->
    <!-- v10.132 - IFrame integrado aos Modelos: exame especÃ­fico via HTML externo - COMPLETO âœ… -->
    <!-- v10.131 - Sandbox integrado com Modelos de Atendimento - PASSO 1 COMPLETO -->
    <!-- v10.130 - Modelos de Atendimento customizÃ¡veis por tipo e especialidade -->
    <!-- v10.121 - Filtro de profissional corrigido: mostra TODOS os tipos -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
        }

        /* v10.86: Scrollbar estilizada para lista de pacientes */
        #listaPacientes::-webkit-scrollbar {
            width: 8px;
        }

        #listaPacientes::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        #listaPacientes::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        #listaPacientes::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* v10.89: Scrollbar estilizada para lista de profissionais */
        #listaProfissionais::-webkit-scrollbar {
            width: 8px;
        }

        #listaProfissionais::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        #listaProfissionais::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        #listaProfissionais::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* ===== ESTILOS ESPECÃFICOS PARA GERENCIADOR DE TEMPLATES v10.15.0 ===== */
        
        /* Efeitos hover para botÃ£o criar template */
        .btn-create-template:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        /* Efeitos hover para botÃ£o fechar modal */
        .btn-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* Efeitos hover para botÃµes secundÃ¡rios */
        .btn-secondary:hover {
            background: #d0d0d0;
        }
        
        /* Efeitos hover para botÃµes primÃ¡rios */
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        /* Focus nos inputs */
        #template-nome:focus,
        #template-descricao:focus,
        #search-modules:focus {
            outline: none;
            border-color: #667eea;
        }
        
        /* AnimaÃ§Ã£o do modal */
        .modal.active {
            display: flex !important;
        }
        
        /* Scrollbar personalizada para listas de mÃ³dulos */
        .modules-list::-webkit-scrollbar,
        .selected-modules-list::-webkit-scrollbar,
        .subaba-3-container::-webkit-scrollbar {
            width: 8px;
        }
        
        .modules-list::-webkit-scrollbar-track,
        .selected-modules-list::-webkit-scrollbar-track,
        .subaba-3-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .modules-list::-webkit-scrollbar-thumb,
        .selected-modules-list::-webkit-scrollbar-thumb,
        .subaba-3-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        .modules-list::-webkit-scrollbar-thumb:hover,
        .selected-modules-list::-webkit-scrollbar-thumb:hover,
        .subaba-3-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Responsividade do modal */
        @media (max-width: 1024px) {
            .modules-selection {
                grid-template-columns: 1fr !important;
            }
            
            .modal-large {
                width: 95% !important;
            }
        }
        
        /* AnimaÃ§Ã£o suave para cards */
        .template-card {
            animation: fadeInUp 0.3s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Efeito de arrastar mÃ³dulo */
        .module-handle:active {
            cursor: grabbing;
        }
        
        /* ===== FIM DOS ESTILOS DO GERENCIADOR DE TEMPLATES ===== */


        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
        }

        .header-info {
            text-align: right;
            font-size: 14px;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            gap: 8px;
            background: var(--card);
            padding: 8px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            overflow-x: auto;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab:hover {
            background: var(--bg);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* SUB-ABAS */
        .sub-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--border);
            padding-bottom: 8px;
        }

        .sub-tab {
            padding: 10px 16px;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
            color: var(--text);
        }

        .sub-tab:hover {
            background: #e0e7ff;
            border-color: var(--primary);
        }

        .sub-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .sub-tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }

        .sub-tab-content.active {
            display: block;
        }

        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow);
            margin-bottom: 24px;
        }

        .card h2 {
            margin-bottom: 16px;
            color: var(--text);
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card h3 {
            margin-bottom: 12px;
            margin-top: 20px;
            color: var(--text);
            font-size: 16px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-info {
            background: var(--info);
            color: white;
        }

        .btn-secondary {
            background: #64748b;
            color: white;
        }

        .btn-secondary:hover {
            background: #475569;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(100, 116, 139, 0.4);
        }

        .btn-icon {
            padding: 8px 12px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }

        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }

        /* AGENDA - MODELO ORIGINAL */
        .agendamento-item {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            border-left: 4px solid;
        }

        .agendamento-item:hover {
            border-color: var(--primary);
            background: #f0f7ff;
        }

        .agendamento-item.atendendo {
            border-color: var(--warning);
            background: #fffbeb;
        }

        .agendamento-info {
            flex: 1;
        }

        .agendamento-info strong {
            display: block;
            margin-bottom: 4px;
            color: var(--text);
            font-size: 16px;
        }

        .agendamento-info small {
            color: var(--text-light);
            font-size: 13px;
            display: block;
            margin-top: 4px;
        }

        .agendamento-actions {
            display: flex;
            gap: 8px;
        }

        .idade-display {
            font-size: 13px;
            color: var(--text-light);
            font-weight: normal;
        }

        .badge-tipo {
            font-size: 11px;
            padding: 3px 8px;
        }

        /* SISTEMA DE COLETA DE DADOS */
        .coleta-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 24px;
        }

        .campo-coleta {
            background: var(--bg);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .campo-coleta-nome {
            font-weight: 600;
        }

        .campo-coleta-tipo {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
        }

        .dados-coletados-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        .dados-coletados-table th,
        .dados-coletados-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .dados-coletados-table th {
            background: var(--bg);
            font-weight: 600;
        }

        .dados-coletados-table tr:hover {
            background: var(--bg);
        }

        /* PRONTUÃRIO ELETRÃ”NICO */
        .prontuario-header {
            background: linear-gradient(135deg, var(--success), var(--info));
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 24px;
        }

        .prontuario-paciente-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .prontuario-paciente-info div {
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 8px;
        }

        .prontuario-section {
            background: var(--card);
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .prontuario-section h3 {
            margin: 0 0 16px 0;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* HISTÃ“RICO */
        .timeline {
            position: relative;
            padding-left: 40px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 24px;
        }

        .timeline-marker {
            position: absolute;
            left: -33px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--primary);
            border: 3px solid white;
            box-shadow: 0 0 0 2px var(--border);
        }

        .timeline-content {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .timeline-date {
            color: var(--text-light);
            font-size: 14px;
        }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            margin: 20px;
        }

        .modal-content.large {
            max-width: 1200px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-header h3 {
            font-size: 20px;
            margin: 0;
        }

        .btn-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
        }

        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-success {
            background: var(--success);
            color: white;
        }

        .badge-danger {
            background: var(--danger);
            color: white;
        }

        .badge-warning {
            background: var(--warning);
            color: white;
        }

        .badge-info {
            background: var(--info);
            color: white;
        }

        .badge-secondary {
            background: #6b7280;
            color: white;
        }

        .badge-primary {
            background: var(--primary);
            color: white;
        }

        .notificacao {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            background: var(--success);
            color: white;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            z-index: 2000;
            animation: slideIn 0.3s;
            transition: top 0.3s ease;
            max-width: 350px;
        }

        .notificacao.error {
            background: var(--danger);
        }
        
        .notificacao.warning {
            background: #f59e0b;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(400px); opacity: 0; }
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        /* SISTEMA DE NOTIFICAÃ‡Ã•ES */
        .notificacao-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #ef4444;
            color: white;
            border-radius: 12px;
            padding: 2px 8px;
            font-size: 11px;
            font-weight: 700;
            min-width: 20px;
            text-align: center;
        }

        .notificacao-item {
            background: white;
            border-left: 4px solid;
            border-radius: 8px;
            padding: 12px 16px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: all 0.2s;
        }

        .notificacao-item:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-1px);
        }

        .notificacao-item.urgente {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .notificacao-item.atencao {
            border-color: #f59e0b;
            background: #fffbeb;
        }

        .notificacao-item.info {
            border-color: #3b82f6;
            background: #eff6ff;
        }

        .notificacao-icone {
            font-size: 24px;
            line-height: 1;
        }

        .notificacao-conteudo {
            flex: 1;
        }

        .notificacao-titulo {
            font-weight: 600;
            color: var(--text);
            margin-bottom: 4px;
        }

        .notificacao-descricao {
            font-size: 13px;
            color: var(--text-light);
        }

        .notificacao-tempo {
            font-size: 11px;
            color: var(--text-light);
            white-space: nowrap;
        }

        /* BARRA DE PROGRESSO */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0,0,0,0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            border-radius: 4px;
            transition: width 0.3s;
        }

        /* MINI STAT CARD */
        .mini-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }

        .mini-stat:last-child {
            border-bottom: none;
        }

        .mini-stat-label {
            font-size: 14px;
            color: var(--text-light);
        }

        .mini-stat-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--text);
        }

        .item-list {
            display: grid;
            gap: 8px;
        }

        .item-card {
            background: var(--bg);
            padding: 12px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .item-card:hover {
            background: var(--border);
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .coleta-container {
                grid-template-columns: 1fr;
            }
            
            .agenda-grid {
                font-size: 10px;
            }
        }

        /* ============================================================
           ESTILOS DA TELA DE LOGIN
           ============================================================ */
        
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .login-overlay.hidden {
            display: none;
        }

        .login-card {
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 400px;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .login-header h1 {
            color: var(--text);
            font-size: 24px;
            margin-bottom: 8px;
        }

        .login-header p {
            color: var(--text-light);
            font-size: 14px;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .perfil-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 8px;
        }

        .perfil-option {
            padding: 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }

        .perfil-option:hover {
            border-color: var(--primary);
            background: var(--bg);
        }

        .perfil-option.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .perfil-option .perfil-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .perfil-option .perfil-title {
            font-weight: 600;
            font-size: 14px;
        }

        .user-info-display {
            background: var(--bg);
            padding: 12px 16px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
        }

        .user-details {
            flex: 1;
        }

        .user-details .user-name {
            font-weight: 600;
            color: var(--text);
            font-size: 14px;
        }

        .user-details .user-role {
            font-size: 12px;
            color: var(--text-light);
        }

        .btn-logout {
            background: var(--danger);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }

        /* ============================================================
           ESTILOS PARA REPARTIÃ‡Ã•ES COM STATUS
           ============================================================ */
        
        .reparticoes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(420px, 1fr)); /* v9.4.2: 420px - cards mais largos */
            gap: 16px;
            margin-top: 20px;
        }
        
        /* v9.2: Responsividade para telas menores */
        @media (max-width: 768px) {
            .reparticoes-grid {
                grid-template-columns: 1fr; /* Uma coluna em mobile */
            }
        }
        
        @media (min-width: 769px) and (max-width: 1400px) {
            .reparticoes-grid {
                grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); /* v9.4.2: cards um pouco maiores em telas mÃ©dias */
            }
        }

        .reparticao-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow);
            border-left: 4px solid;
            transition: all 0.3s;
            position: relative;
            min-height: 240px;
            display: flex;
            flex-direction: column;
        }

        .reparticao-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .reparticao-card.livre {
            border-left-color: #10b981;
            background: linear-gradient(to right, #ecfdf5 0%, #ffffff 100%);
        }

        .reparticao-card.ocupado {
            border-left-color: #ef4444;
            background: linear-gradient(to right, #fef2f2 0%, #ffffff 100%);
        }

        .reparticao-card.parcial {
            border-left-color: #f59e0b;
            background: linear-gradient(to right, #fffbeb 0%, #ffffff 100%);
        }

        .reparticao-card.reservado {
            border-left-color: #ffc107;
            background: linear-gradient(to right, #fffbeb 0%, #ffffff 100%);
        }

        .reparticao-card.desativado {
            border-left-color: #6b7280;
            background: linear-gradient(to right, #f9fafb 0%, #ffffff 100%);
        }

        .reparticao-card.em_cirurgia {
            border-left-color: #dc2626;
            background: linear-gradient(to right, #fef2f2 0%, #ffffff 100%);
        }

        .reparticao-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .reparticao-nome {
            font-size: 19px;
            font-weight: 700;
            color: var(--text);
            margin: 0;
            flex: 1;
            min-width: 200px;
        }

        .reparticao-status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .reparticao-status.livre {
            background: #10b981;  /* Verde mais forte */
            color: #ffffff;       /* Texto branco para contraste */
        }

        .reparticao-status.ocupado {
            background: #fee2e2;
            color: #991b1b;
        }

        .reparticao-status.parcial {
            background: #f9fafb;
            color: #92400e;
        }

        .reparticao-status.reservado {
            background: #f9fafb;
            color: #92400e;
        }

        .reparticao-status.desativado {
            background: #e5e7eb;
            color: #374151;
        }

        .reparticao-status.em_cirurgia {
            background: #fee2e2;
            color: #991b1b;
        }

        .reparticao-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin: 12px 0;
            font-size: 14px;
            color: var(--text-light);
        }

        .reparticao-info-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .reparticao-info-item strong {
            color: var(--text);
            min-width: 80px;
        }

        .reparticao-paciente {
            background: var(--bg);
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }

        .reparticao-paciente-nome {
            font-weight: 600;
            color: var(--text);
            margin-bottom: 4px;
        }

        .reparticao-paciente-info {
            font-size: 12px;
            color: var(--text-light);
        }

        .reparticao-actions {
            display: flex;
            gap: 8px;
            margin-top: auto;
            padding-top: 16px;
            flex-wrap: wrap;
        }
        
        /* v9.2: FORÃ‡AR espaÃ§amento entre botÃµes */
        .reparticao-actions > * {
            margin-right: 8px !important;
            margin-bottom: 4px !important;
        }
        
        .reparticao-actions > *:last-child {
            margin-right: 0 !important;
        }

        .filtros-reparticao {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .tipo-uso-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .tipo-uso-badge.agendavel {
            background: #dbeafe;
            color: #1e40af;
        }

        .tipo-uso-badge.ocupavel {
            background: #fce7f3;
            color: #9f1239;
        }


        /* ============================================================
           [v6.8.0] Estilos para Tipos de RepartiÃ§Ãµes
           ============================================================ */
        
        .campos-tipo {
            margin-top: 16px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .campos-tipo strong {
            color: var(--text);
            font-size: 15px;
        }

        .reparticao-card {
            transition: all 0.3s ease;
        }

        .reparticao-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* ============================================================
           ESTILOS PARA FORMULÃRIOS EM ABAS
           ============================================================ */
        
        .form-tabs {
            display: flex;
            gap: 4px;
            border-bottom: 2px solid var(--border);
            margin-bottom: 20px;
        }

        .form-tab {
            padding: 12px 20px;
            border: none;
            background: transparent;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
        }

        .form-tab:hover {
            color: var(--text);
            background: var(--bg);
        }

        .form-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        /* v10.118: Estilo customizado para scroll da lista de profissionais */
        #agenda-subfiltros-profissionais-lista {
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--bg);
        }

        #agenda-subfiltros-profissionais-lista::-webkit-scrollbar {
            width: 8px;
        }

        #agenda-subfiltros-profissionais-lista::-webkit-scrollbar-track {
            background: var(--bg);
            border-radius: 4px;
        }

        #agenda-subfiltros-profissionais-lista::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        #agenda-subfiltros-profissionais-lista::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* v10.119: Estilo customizado para scroll da lista de exames (consistÃªncia) */
        #agenda-subfiltros-exames-lista {
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--bg);
        }

        #agenda-subfiltros-exames-lista::-webkit-scrollbar {
            width: 8px;
        }

        #agenda-subfiltros-exames-lista::-webkit-scrollbar-track {
            background: var(--bg);
            border-radius: 4px;
        }

        #agenda-subfiltros-exames-lista::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        #agenda-subfiltros-exames-lista::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        .form-tab-content {
            display: none;
        }

        .form-tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        .form-section {
            background: var(--bg);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .form-section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border);
        }

        .sexo-selector {
            display: flex;
            gap: 12px;
        }

        .sexo-option {
            flex: 1;
            padding: 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }

        .sexo-option:hover {
            border-color: var(--primary);
            background: var(--bg);
        }

        .sexo-option.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
        }

        .sexo-option.masculino.selected {
            border-color: #3b82f6;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.1));
        }

        .sexo-option.feminino.selected {
            border-color: #ec4899;
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.1), rgba(219, 39, 119, 0.1));
        }

        .sexo-option.intersexo.selected {
            border-color: #9333ea;
            background: linear-gradient(135deg, rgba(147, 51, 234, 0.1), rgba(126, 34, 206, 0.1));
        }

        .sexo-option.nao-informado.selected {
            border-color: #64748b;
            background: linear-gradient(135deg, rgba(100, 116, 139, 0.1), rgba(71, 85, 105, 0.1));
        }

        .sexo-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .sexo-label {
            font-weight: 600;
            font-size: 14px;
        }

        .idade-display {
            display: inline-block;
            padding: 4px 12px;
            background: var(--info);
            color: white;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 8px;
        }

        .categoria-etaria {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 4px;
        }

        .field-with-search {
            display: flex;
            gap: 8px;
        }

        .field-with-search input {
            flex: 1;
        }

        .field-with-search button {
            flex-shrink: 0;
        }

        .info-box {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 12px;
            border-radius: 4px;
            font-size: 13px;
            color: #1e40af;
            margin-bottom: 16px;
        }

        .required-indicator {
            color: var(--danger);
            font-weight: bold;
            margin-left: 4px;
        }

        /* ============================================================
           CALENDÃRIO VISUAL
           ============================================================ */
        .calendario-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 24px;
        }

        .calendario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 16px;
            background: var(--bg);
            border-radius: 8px;
        }

        .calendario-header h3 {
            margin: 0;
            font-size: 20px;
            color: var(--text);
        }

        .calendario-nav {
            display: flex;
            gap: 8px;
        }

        .btn-calendario-nav {
            padding: 8px 16px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-calendario-nav:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .calendario-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            background: var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .calendario-dia-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: 700;
            font-size: 12px;
        }

        .calendario-dia {
            background: white;
            padding: 8px;
            min-height: 100px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }

        .calendario-dia:hover {
            background: var(--bg);
            transform: scale(1.02);
        }

        .calendario-dia.hoje {
            background: #eff6ff;
            border: 1px solid #e0e0e0;
        }

        .calendario-dia.selecionado {
            /* v10.55.3: Azul claro estilo ğŸ¬ */
            background: linear-gradient(135deg, #60d5f7 0%, #40c4e6 100%);
            border: 2px solid #2bb8d9;
            box-shadow: 0 4px 12px rgba(96, 213, 247, 0.4);
        }
        
        .calendario-dia.selecionado .calendario-dia-numero {
            color: white;
            font-weight: 800;
        }

        .calendario-dia.outro-mes {
            background: #f8f9fa;
            opacity: 0.5;
        }

        .calendario-dia-numero {
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 4px;
            color: var(--text);
        }

        .agendamento-mini {
            font-size: 10px;
            padding: 2px 4px;
            margin: 2px 0;
            border-radius: 3px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            background: var(--primary);
            color: white;
        }

        .contador-agendamentos {
            position: absolute;
            top: 4px;
            right: 4px;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 700;
        }

        /* ============================================================
           LAYOUT 2 COLUNAS DA AGENDA
           ============================================================ */
        .agenda-layout {
            display: grid;
            grid-template-columns: 500px 1fr; /* v9.2.3: Voltou para 500px - calendÃ¡rio precisa desse espaÃ§o */
            gap: 24px;
            align-items: start;
        }
        
        /* v9.2: Em telas menores, vira coluna Ãºnica */
        @media (max-width: 1200px) {
            .agenda-layout {
                grid-template-columns: 1fr;
            }
            
            .agenda-calendario-col {
                position: relative !important;
                top: 0 !important;
            }
        }

        .agenda-calendario-col {
            position: sticky;
            top: 20px;
        }

        .agenda-lista-col {
            min-height: 600px;
        }

        /* CARDS DE AGENDAMENTO MELHORADOS */
        .agendamento-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border-left: 4px solid #3b82f6;
            transition: all 0.3s;
            position: relative;
        }

        .agendamento-card:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
            transform: translateY(-2px);
        }

        .agendamento-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .agendamento-titulo {
            font-size: 18px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 4px;
        }

        .agendamento-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .agendamento-badge.agendado {
            background: #e3f2fd;
            color: #1976d2;
        }

        .agendamento-badge.realizado {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .agendamento-badge.cancelado {
            background: #f9fafb;
            color: #c62828;
        }

        .agendamento-info {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 12px 16px;
            margin-bottom: 12px;
        }

        .agendamento-info-item {
            display: contents;
        }

        .agendamento-info-label {
            font-size: 12px;
            color: var(--text-light);
            font-weight: 600;
        }

        .agendamento-info-valor {
            font-size: 13px;
            color: var(--text);
        }

        .agendamento-acoes {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }
        
        /* v9.2: FORÃ‡AR espaÃ§amento entre botÃµes */
        .agendamento-acoes > * {
            margin-right: 8px !important;
            margin-bottom: 4px !important;
        }
        
        .agendamento-acoes > *:last-child {
            margin-right: 0 !important;
        }

        .lista-agendamentos-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding: 16px;
            background: var(--bg);
            border-radius: 8px;
        }

        .lista-agendamentos-header h3 {
            margin: 0;
            font-size: 18px;
            color: var(--text);
        }

        .lista-agendamentos-contador {
            background: var(--primary);
            color: white;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 600;
        }

        @media (max-width: 1200px) {
            .agenda-layout {
                grid-template-columns: 1fr;
            }
            
            .agenda-calendario-col {
                position: relative;
                top: 0;
            }
        }

        /* ============================================================
           HIERARQUIA DE REPARTIÃ‡Ã•ES
           ============================================================ */
        .reparticoes-tree {
            margin-top: 20px;
        }

        .pavilhao-grupo {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #3b82f6;
            box-shadow: var(--shadow);
        }

        .pavilhao-header {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .andar-grupo {
            margin-left: 20px;
            margin-bottom: 16px;
            padding: 16px;
            background: var(--bg);
            border-radius: 8px;
        }

        .andar-header {
            font-size: 16px;
            font-weight: 600;
            color: var(--secondary);
            margin-bottom: 12px;
        }

        .setor-grupo {
            margin-left: 20px;
            margin-bottom: 12px;
        }

        .setor-header {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 8px;
        }

        .reparticao-item {
            margin-left: 20px;
            padding: 12px;
            background: white;
            border-radius: 6px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .reparticao-item:hover {
            box-shadow: var(--shadow);
            transform: translateX(4px);
        }

        .reparticao-item-info {
            flex: 1;
        }

        .reparticao-item-nome {
            font-weight: 600;
            color: var(--text);
        }

        .reparticao-item-detalhes {
            font-size: 13px;
            color: var(--text-light);
            margin-top: 4px;
        }

        .reparticao-item-status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 12px;
        }

        .reparticao-item-status.livre {
            background: #d1fae5;
            color: #065f46;
        }

        .reparticao-item-status.ocupado {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Chips de Especialidades */
        .especialidade-chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: var(--primary);
            color: white;
            border-radius: 16px;
            font-size: 0.9em;
        }

        .especialidade-chip.principal {
            background: var(--success);
        }

        .especialidade-chip button {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1.1em;
            padding: 0;
            line-height: 1;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .especialidade-chip button:hover {
            opacity: 1;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px;
            border: 1px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-label:hover {
            background: var(--bg);
            border-color: var(--primary);
        }

        .checkbox-label input[type="checkbox"] {
            cursor: pointer;
        }
        
        /* ============================================================
           v9.2: CSS FORÃ‡ADO PARA ESPAÃ‡AMENTO ADEQUADO
           ============================================================ */
        
        /* ForÃ§ar espaÃ§amento mÃ­nimo entre spans inline */
        span + span {
            margin-left: 8px;
        }
        
        /* BotÃµes lado a lado sempre tÃªm espaÃ§o */
        .btn + .btn {
            margin-left: 8px;
        }
        
        /* Garantir que divs com display flex tenham gap funcional */
        div[style*="display: flex"] {
            gap: 10px !important;
        }
        
        /* EspaÃ§amento entre Ã­cones emoji e texto */
        span:has(+ strong),
        span:has(+ span) {
            margin-right: 4px;
        }
        
        /* v9.2.1: NOVO - Impedir quebra de linha nas duraÃ§Ãµes */
        div[style*="display: flex"][style*="gap:"] {
            flex-wrap: nowrap !important;
            align-items: center !important;
        }
        
        /* Impedir quebra dentro dos spans de duraÃ§Ã£o */
        div[style*="display: flex"] > span {
            white-space: nowrap !important;
        }
        
        /* Container de duraÃ§Ãµes mais compacto */
        .agendamento-info-item div[style*="background: #f9fafb"] {
            overflow-x: auto !important;
            -webkit-overflow-scrolling: touch;
        }
        
        /* ============================================================
           v10.10.1: ESTILOS PARA SUB-TABS
           ============================================================ */
        
        /* Container das sub-abas */
        .sub-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 0;
        }
        
        /* BotÃµes das sub-abas - AUMENTADOS */
        .sub-tab-btn {
            padding: 14px 28px;  /* Aumentado de 12px 24px */
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;  /* Aumentado de 2px */
            color: var(--text-light);
            font-size: 16px;  /* Aumentado de 14px */
            font-weight: 600;  /* Aumentado de 500 */
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            position: relative;
            bottom: -2px;
        }
        
        .sub-tab-btn:hover {
            color: var(--primary);
            background: rgba(59, 130, 246, 0.05);
        }
        
        .sub-tab-btn.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            font-weight: 700;  /* Mais bold quando ativo */
        }
        
        /* ConteÃºdo das sub-abas */
        .sub-tab-content {
            display: none;
        }
        
        .sub-tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* ============================================================
           v10.12.2: SCROLL HORIZONTAL EM TODOS OS POOLS
           ============================================================ */
        
        /* Containers de pools/badges/chips/tags - adicionar scroll horizontal */
        .pool-container,
        .badges-container,
        .chips-container,
        .tags-container,
        div[id*="pool"],
        div[id*="lista-especialidades"],
        div[id*="lista-convenios"],
        div[id*="lista-antibioticos"],
        div[id*="lista-procedimentos"],
        div[style*="flex-wrap: wrap"]:has(.badge),
        div[style*="flex-wrap: wrap"]:has(.especialidade-chip),
        div[style*="display: flex"]:has(> span[style*="padding"]):has(> span[style*="border-radius"]) {
            overflow-x: auto !important;
            overflow-y: visible !important;
            white-space: nowrap !important;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: rgba(0,0,0,0.2) transparent;
        }
        
        /* Scrollbar customizada para Webkit (Chrome, Safari) */
        .pool-container::-webkit-scrollbar,
        div[id*="pool"]::-webkit-scrollbar,
        div[style*="flex-wrap: wrap"]:has(.badge)::-webkit-scrollbar {
            height: 6px;
        }
        
        .pool-container::-webkit-scrollbar-track,
        div[id*="pool"]::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.05);
            border-radius: 3px;
        }
        
        .pool-container::-webkit-scrollbar-thumb,
        div[id*="pool"]::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.2);
            border-radius: 3px;
        }
        
        .pool-container::-webkit-scrollbar-thumb:hover,
        div[id*="pool"]::-webkit-scrollbar-thumb:hover {
            background: rgba(0,0,0,0.3);
        }
        
        /* Garantir que badges/chips nÃ£o quebrem linha */
        .badge,
        .especialidade-chip,
        .chip,
        .tag,
        span[style*="padding"][style*="border-radius"] {
            flex-shrink: 0 !important;
            white-space: nowrap !important;
        }
        
        /* Tags de Expectativas */
        .tag-expectativa {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }
        .tag-expectativa button {
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            cursor: pointer;
        }
        .tag-expectativa button:hover {
            background: rgba(255,255,255,0.5);
        }
        
        /* Cards de Alergias e DoenÃ§as */
        .item-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 4px solid #667eea;
        }
        .item-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        .btn-remover-item {
            padding: 6px 12px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }
        .btn-remover-item:hover {
            background: #d32f2f;
        }

        /* ========================================
           v10.57: ESCONDER LINKS "GERENCIAR POOL"
           ======================================== */
        
        /* Esconde os painÃ©is de gerenciamento */
        #estab-pool-nomes,
        #estab-pool-andares,
        #estab-pool-pavilhoes,
        #estab-pool-setores,
        #estab-pool-especialidades,
        #prof-pool-categorias,
        #prof-pool-cargos,
        #pac-pool-convenios {
            display: none !important;
        }
        
        /* Esconde os botÃµes que abrem os painÃ©is */
        button[onclick*="estab-pool-nomes"],
        button[onclick*="estab-pool-andares"],
        button[onclick*="estab-pool-pavilhoes"],
        button[onclick*="estab-pool-setores"],
        button[onclick*="estab-pool-especialidades"],
        button[onclick*="prof-pool-categorias"],
        button[onclick*="prof-pool-cargos"],
        button[onclick*="pac-pool-convenios"] {
            display: none !important;
        }
        
        /* v10.84: Modal de prÃ©-cadastro deve aparecer POR CIMA de outros modais */
        #modalPreCadastro {
            z-index: 1100 !important;
        }

        /* v10.92: BUSCA COM DROPDOWN NAS ABAS */
        .busca-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            max-height: 500px;
            overflow: hidden;
            z-index: 100;
        }

        .busca-dropdown-header {
            padding: 16px 20px;
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
        }

        .busca-dropdown-resultados {
            max-height: 350px;
            overflow-y: auto;
        }

        .busca-resultado-item {
            padding: 16px 20px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            transition: background 0.15s;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .busca-resultado-item:hover {
            background: #f9fafb;
        }

        .busca-resultado-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .busca-resultado-info {
            flex: 1;
            min-width: 0;
        }

        .busca-resultado-nome {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 4px;
        }

        .busca-resultado-detalhes {
            font-size: 13px;
            color: #6b7280;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .busca-resultado-badge {
            display: inline-flex;
            align-items: center;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-idade {
            background: #dbeafe;
            color: #1e40af;
        }

        .busca-dropdown-footer {
            padding: 12px 20px;
            background: #f9fafb;
            border-top: 1px solid #e5e7eb;
        }

        .busca-dropdown-footer button {
            width: 100%;
            padding: 12px;
            background: white;
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            color: #6b7280;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .busca-dropdown-footer button:hover {
            background: #f9fafb;
            border-color: #3b82f6;
            color: #3b82f6;
        }

        /* Scrollbar do dropdown */
        .busca-dropdown-resultados::-webkit-scrollbar {
            width: 8px;
        }

        .busca-dropdown-resultados::-webkit-scrollbar-track {
            background: #f3f4f6;
        }

        .busca-dropdown-resultados::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 4px;
        }

        .busca-dropdown-resultados::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .header {
                flex-wrap: wrap;
            }
        }
        
        /* ========== ELEMENTOS DE PRONTUÃRIO ========== */
        .secao-prontuario {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 24px;
            border: 1px solid #e0e0e0;
            border-left: 4px solid #3b82f6;
        }
        
        .secao-titulo {
            font-size: 15px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--primary);
        }
        
        .secao-subtitulo {
            font-size: 12px;
            color: #666;
            margin-bottom: 16px;
        }
        
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           CSS DO PRONTUÃRIO MODULAR - v10.354
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        
        /* FORMULÃRIOS DO PRONTUÃRIO */
        .prontuario-form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 18px;
            margin-bottom: 20px;
        }
        
        .prontuario-form-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .prontuario-form-group.full {
            grid-column: 1 / -1;
        }
        
        .prontuario-form-group label {
            font-size: 13px;
            font-weight: 600;
            color: #444;
        }
        
        .prontuario-form-group input,
        .prontuario-form-group select,
        .prontuario-form-group textarea {
            padding: 10px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.2s;
        }
        
        .prontuario-form-group input:focus,
        .prontuario-form-group select:focus,
        .prontuario-form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        /* DIVISOR DE SEÃ‡ÃƒO */
        .prontuario-divisor {
            margin: 20px 0 15px 0;
            padding: 12px 15px;
            background: #f8f9fa;
            border-left: 4px solid #3b82f6;
            border-radius: 6px;
        }
        
        .prontuario-divisor h3 {
            font-size: 15px;
            color: #333;
            margin: 0;
        }
        
        .prontuario-divisor p {
            font-size: 12px;
            color: #666;
            margin: 5px 0 0 0;
        }
        
        /* CAMPOS CONDICIONAIS */
        .prontuario-campo-condicional {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #3b82f6;
        }
        
        .prontuario-campo-condicional.visivel {
            display: block;
        }
        
        /* CARDS DE ITEMS (Alergias, DoenÃ§as, etc) */
        .prontuario-item-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 4px solid #667eea;
            position: relative;
        }
        
        .prontuario-item-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .prontuario-item-card-header strong {
            color: #667eea;
            font-size: 15px;
        }
        
        .prontuario-item-card .prontuario-form-grid {
            margin: 0;
        }
        
        .prontuario-btn-remover {
            padding: 6px 12px;
            background: #f44336;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }
        
        .prontuario-btn-remover:hover {
            background: #d32f2f;
        }
        
        /* TAGS */
        .prontuario-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }
        
        .prontuario-tag button {
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .prontuario-tag button:hover {
            background: rgba(255,255,255,0.5);
        }
        
        /* BOTÃ•ES DO PRONTUÃRIO */
        .prontuario-btn-adicionar {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            transition: background 0.2s;
        }
        
        .prontuario-btn-adicionar:hover {
            background: #5a6fd6;
        }
        
        .prontuario-btn-gerenciar {
            padding: 10px 20px;
            background: #ff9800;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
        }
        
        .prontuario-btn-gerenciar:hover {
            background: #f57c00;
        }
        
        .prontuario-btn-criar {
            padding: 8px 14px;
            background: #4caf50;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 12px;
            white-space: nowrap;
        }
        
        .prontuario-btn-criar:hover {
            background: #43a047;
        }
    </style>
    
    <!-- Bibliotecas para GeraÃ§Ã£o de PDFs e CÃ³digos -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
    <!-- TELA DE LOGIN -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-card">
            <div class="login-header">
                <h1>ğŸ¥ Sistema Hospitalar</h1>
                <p>FaÃ§a login para acessar o sistema</p>
            </div>
            
            <form class="login-form" onsubmit="Auth.login(event)" autocomplete="off">
                <!-- SELETOR DE PERFIL -->
                <div class="perfil-selector">
                    <div class="perfil-option selected" onclick="Auth.selecionarPerfil('admin')">
                        <div class="perfil-icon">ğŸ‘‘</div>
                        <div class="perfil-title">Administrador</div>
                    </div>
                    <div class="perfil-option" onclick="Auth.selecionarPerfil('profissional')">
                        <div class="perfil-icon">ğŸ‘¨â€âš•ï¸</div>
                        <div class="perfil-title">Profissional</div>
                    </div>
                </div>
                
                <input type="hidden" id="loginPerfil" value="admin">
                
                <!-- NOME DE USUÃRIO -->
                <div class="form-group">
                    <label>Nome de UsuÃ¡rio</label>
                    <input type="text" class="form-control" id="loginUsuario" required placeholder="Digite seu nome de usuÃ¡rio" autocomplete="off">
                </div>
                
                <!-- SENHA -->
                <div class="form-group">
                    <label>Senha</label>
                    <input type="password" class="form-control" id="loginSenha" required placeholder="Digite sua senha" autocomplete="new-password">
                </div>
                
                <!-- BOTÃƒO ENTRAR -->
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    Entrar no Sistema
                </button>
                
                <!-- DICA -->
                <div style="text-align: center; margin-top: 16px; padding: 12px; background: var(--bg); border-radius: 8px;">
                    <small style="color: var(--text-light);">
                        <strong>Primeiro acesso:</strong><br>
                        Admin: admin / admin<br>
                        Profissional: qualquer nome / senha
                    </small>
                </div>
            </form>
        </div>
    </div>

    <div class="container" id="mainContainer" style="display: none;">
        <!-- HEADER -->
        <div class="header">
            <div>
                <h1>ğŸ¥ Sistema Hospitalar Integrado v6.3</h1>
                <p id="nomeEstabelecimento">Sistema de GestÃ£o MÃ©dica</p>
            </div>
            
            <div class="header-info">
                <div class="user-info-display">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-details">
                        <div class="user-name" id="userName">UsuÃ¡rio</div>
                        <div class="user-role" id="userRole">Carregando...</div>
                    </div>
                    <button class="btn-logout" onclick="Auth.logout()">Sair</button>
                </div>
                <div id="dataAtual" style="margin-top: 8px; text-align: right;"></div>
            </div>
        </div>

        <!-- TABS -->
        <div class="tabs">
            <button class="tab active" onclick="Sistema.trocarTab('dashboard')">ğŸ“Š Dashboard</button>
            <button class="tab" onclick="Sistema.trocarTab('gestao')">âš™ï¸ ConfiguraÃ§Ãµes</button>
            <button class="tab" onclick="Sistema.trocarTab('cadastros')">ğŸ“ Cadastros</button>
            <button class="tab" onclick="Sistema.trocarTab('agenda')">ğŸ“… Agenda</button>
            <button class="tab" onclick="Sistema.trocarTab('atendimentos')">ğŸ©º Atendimentos</button>
            <button class="tab" onclick="Sistema.trocarTab('dados')">ğŸ“‹ Dados</button>
            <button class="tab" onclick="Sistema.trocarTab('relatorios')">ğŸ“Š RelatÃ³rios</button>
            <button class="tab" onclick="Sistema.trocarTab('acoes')">âš¡ AÃ§Ãµes</button>
        </div>

        <!-- DASHBOARD -->
        <div id="tab-dashboard" class="tab-content active">
            <!-- PAINEL DE NOTIFICAÃ‡Ã•ES -->
            <div id="painel-notificacoes" style="margin-bottom: 24px;"></div>

            <!-- ESTATÃSTICAS PRINCIPAIS -->
            <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
                <div class="stat-card" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white;">
                    <div class="stat-value" id="stat-pacientes">0</div>
                    <div class="stat-label">Pacientes Cadastrados</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white;">
                    <div class="stat-value" id="stat-profissionais">0</div>
                    <div class="stat-label">Profissionais Ativos</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white;">
                    <div class="stat-value" id="stat-agendamentos">0</div>
                    <div class="stat-label">Agendamentos Hoje</div>
                </div>
                <div class="stat-card" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white;">
                    <div class="stat-value" id="stat-atendimentos">0</div>
                    <div class="stat-label">Atendimentos Realizados</div>
                </div>
            </div>

            <!-- OCUPAÃ‡ÃƒO E CAPACIDADE -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; margin-bottom: 24px;">
                <div class="card">
                    <h3 style="margin: 0 0 16px 0; font-size: 16px; color: var(--text);">ğŸ›ï¸ Leitos de InternaÃ§Ã£o</h3>
                    <div id="stat-internacao-detalhes"></div>
                </div>
                <div class="card">
                    <h3 style="margin: 0 0 16px 0; font-size: 16px; color: var(--text);">ğŸš¨ EmergÃªncia</h3>
                    <div id="stat-emergencia-detalhes"></div>
                </div>
                <div class="card">
                    <h3 style="margin: 0 0 16px 0; font-size: 16px; color: var(--text);">âš•ï¸ Bloco CirÃºrgico</h3>
                    <div id="stat-cirurgia-detalhes"></div>
                </div>
            </div>

            <!-- PRÃ“XIMOS EVENTOS -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px;">
                <div class="card">
                    <h2 style="margin: 0 0 16px 0;">ğŸ“… PrÃ³ximos Agendamentos</h2>
                    <div id="proximos-agendamentos"></div>
                </div>
                <div class="card">
                    <h2 style="margin: 0 0 16px 0;">âš•ï¸ Cirurgias Agendadas</h2>
                    <div id="proximas-cirurgias"></div>
                </div>
            </div>

            <!-- PACIENTES INTERNADOS -->
            <div class="card">
                <h2 style="margin: 0 0 16px 0;">ğŸ¥ Pacientes Internados</h2>
                <div id="pacientes-internados"></div>
            </div>
        </div>

        <!-- ESTABELECIMENTO -->
        <!-- v10.448: CADASTROS (Estabelecimento + Profissionais + Pacientes) -->
        <div id="tab-cadastros" class="tab-content">
            <div class="card">
                <h2>ğŸ“ Cadastros</h2>
                
                <!-- SUB-ABAS DE CADASTROS -->
                <div class="sub-tabs" style="display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button class="sub-tab-btn active" onclick="Cadastros.trocarAba('estabelecimento')">ğŸ¥ Estabelecimento</button>
                    <button class="sub-tab-btn" onclick="Cadastros.trocarAba('profissionais')">ğŸ‘¨â€âš•ï¸ Profissionais</button>
                    <button class="sub-tab-btn" onclick="Cadastros.trocarAba('pacientes')">ğŸ‘¥ Pacientes</button>
                </div>
                
                <!-- SUB-ABA: ESTABELECIMENTO -->
                <div id="cadastros-estabelecimento" class="sub-tab-content active">
                    <h3>ğŸ¥ GestÃ£o do Estabelecimento</h3>
                    
                    <!-- ABAS DO ESTABELECIMENTO -->
                    <div class="sub-tabs" style="display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap;">
                        <button class="sub-tab active" onclick="Estabelecimento.trocarAba('identificacao')">ğŸ“‹ IdentificaÃ§Ã£o</button>
                        <button class="sub-tab" onclick="Estabelecimento.trocarAba('caracterizacao')">ğŸ¥ CaracterizaÃ§Ã£o</button>
                        <button class="sub-tab" onclick="Estabelecimento.trocarAba('endereco')">ğŸ“ EndereÃ§o</button>
                        <button class="sub-tab" onclick="Estabelecimento.trocarAba('contato')">ğŸ“ Contato</button>
                        <button class="sub-tab" onclick="Estabelecimento.trocarAba('tecnico')">ğŸ‘¨â€âš•ï¸ TÃ©cnico & Legal</button>
                    </div>

                <!-- ABA IDENTIFICAÃ‡ÃƒO -->
                <div id="estab-aba-identificacao" class="sub-tab-content active">
                    <h3 style="margin-bottom: 16px;">ğŸ“‹ IdentificaÃ§Ã£o</h3>
                    
                    <div class="form-group">
                        <label>Tipo de Pessoa <span class="required-indicator">*</span></label>
                        <select class="form-control" id="estab-tipo-pessoa" onchange="Estabelecimento.toggleTipoPessoa()">
                            <option value="juridica">Pessoa JurÃ­dica (Hospital, ClÃ­nica, Empresa)</option>
                            <option value="fisica">Pessoa FÃ­sica (Profissional AutÃ´nomo)</option>
                        </select>
                    </div>

                    <!-- CAMPOS PESSOA JURÃDICA -->
                    <div id="campos-pj">
                        <div class="form-group">
                            <label>RazÃ£o Social <span class="required-indicator">*</span></label>
                            <input type="text" class="form-control" id="estab-razao-social" placeholder="Nome oficial da empresa">
                        </div>
                        
                        <div class="form-group">
                            <label>Nome Fantasia</label>
                            <input type="text" class="form-control" id="estab-nome-fantasia" placeholder="Nome comercial (opcional)">
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label>CNPJ <span class="required-indicator">*</span></label>
                                <input type="text" class="form-control" id="estab-cnpj" placeholder="00.000.000/0000-00" maxlength="18">
                            </div>
                            <div class="form-group">
                                <label>InscriÃ§Ã£o Estadual</label>
                                <input type="text" class="form-control" id="estab-ie" placeholder="InscriÃ§Ã£o Estadual">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>InscriÃ§Ã£o Municipal</label>
                            <input type="text" class="form-control" id="estab-im" placeholder="InscriÃ§Ã£o Municipal (se aplicÃ¡vel)">
                        </div>
                    </div>

                    <!-- CAMPOS PESSOA FÃSICA -->
                    <div id="campos-pf" style="display: none;">
                        <div class="form-group">
                            <label>Nome Completo <span class="required-indicator">*</span></label>
                            <input type="text" class="form-control" id="estab-nome-completo" placeholder="Nome completo do profissional">
                        </div>
                        
                        <div class="form-group">
                            <label>Nome Profissional / ConsultÃ³rio</label>
                            <input type="text" class="form-control" id="estab-nome-profissional" placeholder="Ex: Dr. JoÃ£o Silva, ConsultÃ³rio SaÃºde Plus">
                        </div>
                        
                        <div class="grid-2">
                            <div class="form-group">
                                <label>CPF <span class="required-indicator">*</span></label>
                                <input type="text" class="form-control" id="estab-cpf" placeholder="000.000.000-00" maxlength="14">
                            </div>
                            <div class="form-group">
                                <label>RG</label>
                                <input type="text" class="form-control" id="estab-rg" placeholder="Documento de identidade">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ABA CARACTERIZAÃ‡ÃƒO -->
                <div id="estab-aba-caracterizacao" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ¥ CaracterizaÃ§Ã£o</h3>
                    
                    <div class="form-group">
                        <label>Tipo de Estabelecimento <span class="required-indicator">*</span></label>
                        <select class="form-control" id="estab-tipo">
                            <option value="">Selecione...</option>
                            <option value="consultorio">ConsultÃ³rio (apenas consultas)</option>
                            <option value="clinica">ClÃ­nica (consultas + exames + procedimentos)</option>
                            <option value="hospital_dia">Hospital Dia (internaÃ§Ãµes atÃ© 24h)</option>
                            <option value="hospital">Hospital (internaÃ§Ãµes prolongadas + cirurgias)</option>
                            <option value="pronto_atendimento">Pronto Atendimento / UPA</option>
                            <option value="laboratorio">LaboratÃ³rio de AnÃ¡lises</option>
                            <option value="diagnostico">Centro de DiagnÃ³stico por Imagem</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Modalidades de Atendimento <span class="required-indicator">*</span></label>
                        <div style="display: grid; gap: 12px; padding: 12px; background: var(--bg); border-radius: 8px; border: 1px solid var(--border);">
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="checkbox" id="estab-modal-particular" style="margin-right: 10px; width: 18px; height: 18px;">
                                <span>ğŸ’° Particular (pagamento direto)</span>
                            </label>
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="checkbox" id="estab-modal-convenio" style="margin-right: 10px; width: 18px; height: 18px;">
                                <span>ğŸ¥ ConvÃªnio (planos de saÃºde)</span>
                            </label>
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="checkbox" id="estab-modal-sus" style="margin-right: 10px; width: 18px; height: 18px;">
                                <span>ğŸ›ï¸ SUS (Sistema Ãšnico de SaÃºde)</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>CNES (Cadastro Nacional de Estabelecimentos de SaÃºde)</label>
                        <input type="text" class="form-control" id="estab-cnes" placeholder="Ex: 0000000" maxlength="7">
                        <small style="color: var(--text-light); display: block; margin-top: 4px;">
                            Campo opcional - Todos os estabelecimentos de saÃºde podem ter CNES
                        </small>
                    </div>

                    <!-- SISTEMA INTELIGENTE DE ESPECIALIDADES (v10.45) -->
                    <div class="form-group">
                        <label style="font-weight: 600; margin-bottom: 12px; display: block;">ğŸ©º Especialidades / ServiÃ§os Oferecidos</label>
                        
                        <!-- ADICIONAR DO POOL -->
                        <div style="display: flex; gap: 8px; margin-bottom: 16px;">
                            <select id="estab-especialidade-pool" class="form-control" style="flex: 2;">
                                <option value="">Selecione do pool...</option>
                                <!-- SerÃ¡ preenchido via JS -->
                            </select>
                            <button type="button" class="btn btn-primary" onclick="Estabelecimento.adicionarEspecialidadeDoPool()" style="flex: 1; white-space: nowrap;">
                                â• Adicionar
                            </button>
                        </div>

                        <!-- LISTA DE ESPECIALIDADES DO ESTABELECIMENTO -->
                        <div id="estab-especialidades-lista" style="margin-bottom: 16px; padding: 12px; background: var(--bg); border-radius: 6px; min-height: 60px;">
                            <small style="color: var(--text-light); font-size: 11px; display: block; text-align: center; padding: 20px;">
                                Nenhuma especialidade adicionada ainda
                            </small>
                        </div>

                        <!-- v10.52: AVISO - CENTRALIZAÃ‡ÃƒO DE POOLS -->
                        <div style="border-top: 1px solid var(--border); padding-top: 12px; margin-top: 12px;">
                            <div class="alert alert-info" style="margin: 0; padding: 12px; background: #dbeafe; border-left: 4px solid #3b82f6;">
                                <div style="display: flex; gap: 8px; align-items: start;">
                                    <span style="font-size: 18px;">ğŸ’¡</span>
                                    <div style="font-size: 13px;">
                                        <strong>SeleÃ§Ã£o do Pool do Sistema</strong><br>
                                        <span style="color: #1e40af;">
                                            As especialidades disponÃ­veis vÃªm do Pool do Sistema.<br>
                                            Para adicionar uma nova especialidade, vÃ¡ em:<br>
                                            <strong>GestÃ£o â†’ Pools â†’ Especialidades MÃ©dicas</strong>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ABA ENDEREÃ‡O -->
                <div id="estab-aba-endereco" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ“ EndereÃ§o</h3>
                    
                    <div class="grid-2">
                        <div class="form-group">
                            <label>CEP</label>
                            <input type="text" class="form-control" id="estab-cep" placeholder="00000-000" maxlength="9" onblur="Estabelecimento.buscarCEP()">
                        </div>
                        <div class="form-group">
                            <label>UF</label>
                            <select class="form-control" id="estab-uf">
                                <option value="">Selecione...</option>
                                <option value="AC">AC</option>
                                <option value="AL">AL</option>
                                <option value="AP">AP</option>
                                <option value="AM">AM</option>
                                <option value="BA">BA</option>
                                <option value="CE">CE</option>
                                <option value="DF">DF</option>
                                <option value="ES">ES</option>
                                <option value="GO">GO</option>
                                <option value="MA">MA</option>
                                <option value="MT">MT</option>
                                <option value="MS">MS</option>
                                <option value="MG">MG</option>
                                <option value="PA">PA</option>
                                <option value="PB">PB</option>
                                <option value="PR">PR</option>
                                <option value="PE">PE</option>
                                <option value="PI">PI</option>
                                <option value="RJ">RJ</option>
                                <option value="RN">RN</option>
                                <option value="RS">RS</option>
                                <option value="RO">RO</option>
                                <option value="RR">RR</option>
                                <option value="SC">SC</option>
                                <option value="SP">SP</option>
                                <option value="SE">SE</option>
                                <option value="TO">TO</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Logradouro</label>
                        <input type="text" class="form-control" id="estab-logradouro" placeholder="Rua, Avenida, Travessa...">
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>NÃºmero</label>
                            <input type="text" class="form-control" id="estab-numero" placeholder="NÂº">
                        </div>
                        <div class="form-group">
                            <label>Complemento</label>
                            <input type="text" class="form-control" id="estab-complemento" placeholder="Sala, Andar, Bloco...">
                        </div>
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>Bairro</label>
                            <input type="text" class="form-control" id="estab-bairro">
                        </div>
                        <div class="form-group">
                            <label>Cidade</label>
                            <input type="text" class="form-control" id="estab-cidade">
                        </div>
                    </div>
                </div>

                <!-- ABA CONTATO -->
                <div id="estab-aba-contato" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ“ Contato</h3>
                    
                    <div class="grid-2">
                        <div class="form-group">
                            <label>Telefone Principal</label>
                            <input type="text" class="form-control" id="estab-telefone" placeholder="(00) 0000-0000">
                        </div>
                        <div class="form-group">
                            <label>Celular / WhatsApp</label>
                            <input type="text" class="form-control" id="estab-celular" placeholder="(00) 00000-0000">
                        </div>
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>Email Principal</label>
                            <input type="email" class="form-control" id="estab-email" placeholder="contato@exemplo.com">
                        </div>
                        <div class="form-group">
                            <label>Website</label>
                            <input type="url" class="form-control" id="estab-website" placeholder="https://www.exemplo.com">
                        </div>
                    </div>
                </div>

                <!-- ABA TÃ‰CNICO & LEGAL -->
                <div id="estab-aba-tecnico" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ‘¨â€âš•ï¸ ResponsÃ¡vel TÃ©cnico & InformaÃ§Ãµes Legais</h3>
                    
                    <div class="form-group">
                        <label>Nome do ResponsÃ¡vel TÃ©cnico <span id="rt-obrigatorio" class="required-indicator" style="display: none;">*</span></label>
                        <input type="text" class="form-control" id="estab-resp-tecnico" placeholder="Nome completo do responsÃ¡vel tÃ©cnico">
                        <small style="color: var(--text-light); display: block; margin-top: 4px;">
                            ObrigatÃ³rio para hospitais e clÃ­nicas com procedimentos invasivos
                        </small>
                    </div>

                    <div class="grid-2">
                        <div class="form-group">
                            <label>CRM / Registro Profissional</label>
                            <input type="text" class="form-control" id="estab-crm" placeholder="Ex: 12345">
                        </div>
                        <div class="form-group">
                            <label>UF do Registro</label>
                            <select class="form-control" id="estab-crm-uf">
                                <option value="">Selecione...</option>
                                <option value="AC">AC</option>
                                <option value="AL">AL</option>
                                <option value="AP">AP</option>
                                <option value="AM">AM</option>
                                <option value="BA">BA</option>
                                <option value="CE">CE</option>
                                <option value="DF">DF</option>
                                <option value="ES">ES</option>
                                <option value="GO">GO</option>
                                <option value="MA">MA</option>
                                <option value="MT">MT</option>
                                <option value="MS">MS</option>
                                <option value="MG">MG</option>
                                <option value="PA">PA</option>
                                <option value="PB">PB</option>
                                <option value="PR">PR</option>
                                <option value="PE">PE</option>
                                <option value="PI">PI</option>
                                <option value="RJ">RJ</option>
                                <option value="RN">RN</option>
                                <option value="RS">RS</option>
                                <option value="RO">RO</option>
                                <option value="RR">RR</option>
                                <option value="SC">SC</option>
                                <option value="SP">SP</option>
                                <option value="SE">SE</option>
                                <option value="TO">TO</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Especialidade do ResponsÃ¡vel TÃ©cnico</label>
                        <input type="text" class="form-control" id="estab-especialidade-rt" placeholder="Ex: Cardiologia, ClÃ­nica Geral...">
                    </div>

                    <div class="form-group">
                        <label>ObservaÃ§Ãµes Gerais</label>
                        <textarea class="form-control" id="estab-observacoes" rows="4" placeholder="InformaÃ§Ãµes adicionais, horÃ¡rios especiais, convÃªnios aceitos, etc."></textarea>
                    </div>
                </div>

                <!-- ABA UNIDADES (antigas RepartiÃ§Ãµes) -->

                <!-- BOTÃƒO SALVAR -->
                <div style="margin-top: 24px; padding-top: 20px; border-top: 2px solid var(--border);">
                    <button class="btn btn-primary" onclick="Estabelecimento.salvar()" style="min-width: 200px;">
                        ğŸ’¾ Salvar Todas as InformaÃ§Ãµes
                    </button>
                </div>
                </div>
                <!-- FIM SUB-ABA ESTABELECIMENTO -->

                <!-- SUB-ABA: PROFISSIONAIS -->
                <div id="cadastros-profissionais" class="sub-tab-content">
                    <h3>ğŸ‘¨â€âš•ï¸ GestÃ£o de Profissionais</h3>
                    <button class="btn btn-primary" onclick="Profissionais.abrirModal()">â• Novo Profissional</button>
                    
                    <!-- v10.92: Barra de busca com dropdown -->
                    <div style="margin: 16px 0; position: relative;">
                        <input type="text" 
                               class="form-control" 
                               id="busca-profissionais"
                               placeholder="ğŸ” Buscar profissional por nome..."
                               oninput="BuscaProfissionais.buscar()"
                               onfocus="BuscaProfissionais.mostrar()"
                               autocomplete="off"
                               style="font-size: 14px; padding: 10px;">
                        
                        <!-- DROPDOWN DE RESULTADOS -->
                        <div id="dropdown-busca-profissionais" class="busca-dropdown" style="display: none;">
                            <div class="busca-dropdown-header">
                                <strong>PROFISSIONAIS ENCONTRADOS</strong>
                            </div>
                            <div id="resultados-busca-profissionais" class="busca-dropdown-resultados">
                                <!-- Resultados aparecem aqui -->
                            </div>
                            <div class="busca-dropdown-footer">
                                <button onclick="Profissionais.abrirModal()">
                                    â• Cadastrar novo profissional
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- v10.89: Container com scroll fixo -->
                    <div id="listaProfissionais" style="max-height: 600px; overflow-y: auto; padding-right: 8px;"></div>
                </div>
                <!-- FIM SUB-ABA PROFISSIONAIS -->

                <!-- ESCALAS - MOVIDA PARA GESTÃƒO (comentada) -->

                <!-- SUB-ABA: PACIENTES -->
                <div id="cadastros-pacientes" class="sub-tab-content">
                    <h3>ğŸ‘¥ GestÃ£o de Pacientes</h3>
                    <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                        <button class="btn btn-primary" onclick="Pacientes.abrirModal()">â• Novo Paciente</button>
                    </div>
                    
                    <!-- v10.92: Barra de busca com dropdown -->
                    <div style="margin-bottom: 16px; position: relative;">
                        <input type="text" 
                               class="form-control" 
                               id="busca-pacientes"
                               placeholder="ğŸ” Buscar paciente por nome..."
                               oninput="BuscaPacientes.buscar()"
                               onfocus="BuscaPacientes.mostrar()"
                               autocomplete="off"
                               style="font-size: 14px; padding: 10px;">
                        
                        <!-- DROPDOWN DE RESULTADOS -->
                    <div id="dropdown-busca-pacientes" class="busca-dropdown" style="display: none;">
                        <div class="busca-dropdown-header">
                            <strong>PACIENTES ENCONTRADOS</strong>
                        </div>
                        <div id="resultados-busca-pacientes" class="busca-dropdown-resultados">
                            <!-- Resultados aparecem aqui -->
                        </div>
                        <div class="busca-dropdown-footer">
                            <button onclick="Pacientes.abrirModal()">
                                â• Cadastrar novo paciente
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- v10.86: Container com scroll fixo -->
                <div id="listaPacientes" style="max-height: 600px; overflow-y: auto; padding-right: 8px;"></div>
                </div>
                <!-- FIM SUB-ABA PACIENTES -->
                
            </div>
        </div>
        <!-- FIM TAB-CADASTROS -->

        <!-- AGENDA -->
        <div id="tab-agenda" class="tab-content">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="margin: 0;">ğŸ“… Agenda & OperaÃ§Ãµes</h2>
                    <button class="btn btn-primary" onclick="Agenda.abrirModal()">+ Novo Agendamento</button>
                </div>

                <!-- ABAS DE VISUALIZAÃ‡ÃƒO -->
                <div class="form-tabs" style="margin-bottom: 20px;">
                    <button class="form-tab active" onclick="Agenda.trocarVisualizacao('cards')">ğŸ¥ Unidades</button>
                    <button class="form-tab" onclick="Agenda.trocarVisualizacao('calendario')">ğŸ“… CalendÃ¡rio</button>
                    <button class="form-tab" onclick="Agenda.trocarVisualizacao('lista')">ğŸ“‹ Lista Completa</button>
                </div>

                <!-- VISUALIZAÃ‡ÃƒO CARDS (Igual Unidades) -->
                <div id="agenda-vis-cards" class="agenda-visualizacao active">
                    <div class="info-box" style="margin-bottom: 16px;">
                        â„¹ï¸ <strong>VisÃ£o Operacional:</strong> Gerencie agendamentos e internaÃ§Ãµes diretamente nos cards das unidades. 
                        Clique nos botÃµes para agendar consultas ou internar pacientes.
                    </div>

                    <!-- FILTROS IDÃŠNTICOS AO MAPA DE GESTÃƒO -->
                    <div class="filtros-reparticao" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 20px;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Filtrar por Data <small style="color: var(--text-light);">(vazio = todos)</small></label>
                            <div style="display: flex; gap: 4px;">
                                <input type="date" class="form-control" id="agenda-filtro-data" onchange="Agenda.renderizarCards()" style="flex: 1;">
                                <button type="button" class="btn btn-secondary btn-icon" onclick="document.getElementById('agenda-filtro-data').value=''; Agenda.renderizarCards();" title="Limpar filtro de data" style="padding: 8px 12px;">
                                    âœ•
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Tipo de RepartiÃ§Ã£o</label>
                            <select class="form-control" id="agenda-filtro-categoria" onchange="Agenda.renderizarCards()">
                                <option value="">Todas</option>
                                <option value="consultorio">ğŸ©º ConsultÃ³rio</option>
                                <option value="procedimento">ğŸ¥ Procedimento</option>
                                <option value="internacao">ğŸ›ï¸ InternaÃ§Ã£o</option>
                                <option value="bloco_cirurgico">âš•ï¸ Bloco CirÃºrgico</option>
                                <option value="exames">ğŸ”¬ Exames</option>
                            </select>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Buscar</label>
                            <input type="text" class="form-control" id="agenda-filtro-busca" placeholder="ğŸ” Nome, pavilhÃ£o, andar..." onkeyup="Agenda.renderizarCards()">
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Profissional</label>
                            <select class="form-control" id="agenda-filtro-profissional" onchange="Agenda.renderizarCards()">
                                <option value="">ğŸ‘¥ Todos os profissionais</option>
                                <!-- Preenchido dinamicamente -->
                            </select>
                        </div>
                    </div>
                    
                    <!-- BOTÃƒO MOSTRAR OCULTAS -->
                    <div id="agenda-btn-mostrar-ocultas" style="display: none; margin-bottom: 16px;">
                        <button class="btn btn-secondary" onclick="Agenda.mostrarOcultas()" style="width: 100%;">
                            ğŸ‘ï¸ Mostrar <span id="agenda-contador-ocultas">0</span> unidade(s) oculta(s)
                        </button>
                    </div>

                    <!-- CARDS DAS UNIDADES - RENDERIZADO IDÃŠNTICO -->
                    <div id="agendaCardsContainer" style="max-height: 70vh; overflow-y: auto;"></div>
                </div>

                <!-- v8.0.15: FILTROS POR TIPO MOVIDOS PARA FORA DO CALENDÃRIO -->
                <!-- v10.117: Adicionada aba Profissionais + sub-abas para Exames e Profissionais -->
                <div class="form-tabs" style="margin-bottom: 16px; display: none;" id="agenda-filtros-tipo">
                    <button class="form-tab active" onclick="Agenda.filtrarPorTipo('todos')" id="aba-tipo-todos">
                        ğŸ“Š Todos
                    </button>
                    <button class="form-tab" onclick="Agenda.filtrarPorTipo('consultorio')" id="aba-tipo-consultorio">
                        ğŸ“… Consultas
                    </button>
                    <button class="form-tab" onclick="Agenda.filtrarPorTipo('procedimento')" id="aba-tipo-procedimento">
                        ğŸ”§ Procedimentos
                    </button>
                    <button class="form-tab" onclick="Agenda.filtrarPorTipo('internacao')" id="aba-tipo-internacao">
                        ğŸ›ï¸ InternaÃ§Ãµes
                    </button>
                    <button class="form-tab" onclick="Agenda.filtrarPorTipo('bloco_cirurgico')" id="aba-tipo-bloco_cirurgico">
                        âš•ï¸ Cirurgias
                    </button>
                    <button class="form-tab" onclick="Agenda.toggleSubfiltroExames()" id="aba-tipo-exames">
                        ğŸ”¬ Exames
                    </button>
                    <button class="form-tab" onclick="Agenda.toggleSubfiltroProfissionais()" id="aba-tipo-profissionais">
                        ğŸ‘¨â€âš•ï¸ Profissionais
                    </button>
                </div>

                <!-- v10.117: Sub-abas de Exames -->
                <!-- v10.119: "Todos" fixo + lista com scroll (consistÃªncia com Profissionais) -->
                <div style="margin-bottom: 16px; display: none;" id="agenda-subfiltros-exames">
                    <!-- BotÃ£o "Todos" - FIXO (sempre visÃ­vel) -->
                    <div class="form-tabs" style="margin-bottom: 8px;">
                        <button class="form-tab active" onclick="Agenda.filtrarPorTipoExame('todos')" id="aba-exame-todos">
                            ğŸ“‹ Todos os Exames
                        </button>
                    </div>
                    
                    <!-- Lista de tipos - COM SCROLL (preparado para expansÃ£o futura) -->
                    <div class="form-tabs" id="agenda-subfiltros-exames-lista" 
                         style="max-height: 150px; overflow-y: auto; overflow-x: hidden; flex-wrap: wrap; align-content: flex-start;">
                        <button class="form-tab" onclick="Agenda.filtrarPorTipoExame('laboratorio')" id="aba-exame-laboratorio">
                            ğŸ”¬ Laboratorial
                        </button>
                        <button class="form-tab" onclick="Agenda.filtrarPorTipoExame('imagem')" id="aba-exame-imagem">
                            ğŸ©» Imagem
                        </button>
                    </div>
                </div>

                <!-- v10.117: Sub-abas de Profissionais -->
                <!-- v10.118: "Todos" fixo + lista com scroll ordenada alfabeticamente -->
                <div style="margin-bottom: 16px; display: none;" id="agenda-subfiltros-profissionais">
                    <!-- BotÃ£o "Todos" - FIXO (sempre visÃ­vel) -->
                    <div class="form-tabs" style="margin-bottom: 8px;">
                        <button class="form-tab active" onclick="Agenda.filtrarPorProfissional(0)" id="aba-prof-todos">
                            ğŸ‘¥ Todos os profissionais
                        </button>
                    </div>
                    
                    <!-- Lista de profissionais - COM SCROLL -->
                    <div class="form-tabs" id="agenda-subfiltros-profissionais-lista" 
                         style="max-height: 300px; overflow-y: auto; overflow-x: hidden; flex-wrap: wrap; align-content: flex-start;">
                        <!-- Profissionais inseridos dinamicamente em ordem alfabÃ©tica -->
                    </div>
                </div>

                <!-- VISUALIZAÃ‡ÃƒO CALENDÃRIO (Original) -->
                <div id="agenda-vis-calendario" class="agenda-visualizacao" style="display: none;">
                    <div class="agenda-layout">
                        <!-- COLUNA 1: CALENDÃRIO -->
                        <div class="agenda-calendario-col">
                            <div class="calendario-container" style="margin-bottom: 0;">
                                <div class="calendario-header">
                                    <div class="calendario-nav">
                                        <button class="btn-calendario-nav" onclick="Calendario.mesAnterior()">â† Anterior</button>
                                        <button class="btn-calendario-nav" onclick="Calendario.hoje()">Hoje</button>
                                    </div>
                                    <h3 id="calendario-titulo">Novembro 2025</h3>
                                    <div class="calendario-nav">
                                        <button class="btn-calendario-nav" onclick="Calendario.proximoMes()">PrÃ³ximo â†’</button>
                                    </div>
                                </div>
                                
                                <div id="calendario-grid" class="calendario-grid">
                                    <!-- Grid serÃ¡ gerado via JavaScript -->
                                </div>
                                
                                <!-- v8.0.5: LEGENDA DE INTEGRAÃ‡ÃƒO AGENDA + MAPA -->
                                <!-- v10.109: Atualizada - removida EmergÃªncia (nÃ£o Ã© agendada), adicionado Leitos Reservados -->
                                <div style="margin-top: 16px; padding: 12px; background: #f8fafc; border-radius: 8px; border: 1px solid #e5e7eb;">
                                    <div style="font-size: 12px; font-weight: 600; color: var(--text-dark); margin-bottom: 8px;">
                                        ğŸ“Š Legenda - VisualizaÃ§Ã£o Integrada:
                                    </div>
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; font-size: 11px;">
                                        <div style="display: flex; align-items: center; gap: 6px;">
                                            <div style="width: 12px; height: 12px; background: #3b82f6; border-radius: 2px;"></div>
                                            <span>ğŸ“… Consulta</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 6px;">
                                            <div style="width: 12px; height: 12px; background: #10b981; border-radius: 2px;"></div>
                                            <span>ğŸ”§ Procedimento</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 6px;">
                                            <div style="width: 12px; height: 12px; background: #ec4899; border-radius: 2px;"></div>
                                            <span>ğŸ”¬ Exame</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 6px;">
                                            <div style="width: 12px; height: 12px; background: #8b5cf6; border-radius: 2px;"></div>
                                            <span>âš•ï¸ Cirurgia</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 6px;">
                                            <div style="width: 12px; height: 12px; background: #f59e0b; border-radius: 2px;"></div>
                                            <span>ğŸ›ï¸ InternaÃ§Ã£o</span>
                                        </div>
                                        <div style="display: flex; align-items: center; gap: 6px;">
                                            <div style="width: 12px; height: 12px; background: #fbbf24; border-radius: 2px;"></div>
                                            <span>ğŸŸ¡ Reservado</span>
                                        </div>
                                    </div>
                                    <div style="margin-top: 8px; font-size: 10px; color: var(--text-light); font-style: italic;">
                                        ğŸ’¡ Agenda e Mapa das Unidades integrados - uma visÃ£o completa da ocupaÃ§Ã£o
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- COLUNA 2: LISTA DE AGENDAMENTOS -->
                        <div class="agenda-lista-col">
                            <!-- CABEÃ‡ALHO COM FILTROS -->
                            <div class="lista-agendamentos-header">
                                <div>
                                    <h3 id="data-selecionada-titulo">Agendamentos - Hoje</h3>
                                    <p style="margin: 4px 0 0 0; font-size: 13px; color: var(--text-light);">
                                        Clique em um dia no calendÃ¡rio para ver os agendamentos
                                    </p>
                                </div>
                                <span class="lista-agendamentos-contador" id="contador-agendamentos">0 agendamentos</span>
                            </div>

                            <!-- v10.117: FILTROS REMOVIDOS do CalendÃ¡rio -->
                            <!-- Os filtros detalhados foram movidos apenas para "Lista Completa" -->
                            <!-- No CalendÃ¡rio, usamos apenas as abas visuais (Todos, Consultas, Exames, etc) -->

                            <!-- LISTA DE AGENDAMENTOS -->
                            <div id="listaAgenda">
                                <!-- Cards serÃ£o gerados via JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VISUALIZAÃ‡ÃƒO LISTA COMPLETA (Nova) -->
                <div id="agenda-vis-lista" class="agenda-visualizacao" style="display: none;">
                    <div class="info-box" style="margin-bottom: 16px;">
                        ğŸ“‹ <strong>Lista Completa:</strong> Todos os agendamentos e internaÃ§Ãµes em formato de lista simples.
                    </div>

                    <!-- FILTROS -->
                    <div class="form-grid" style="margin-bottom: 20px;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Data Inicial</label>
                            <input type="date" class="form-control" id="agenda-lista-data-inicio" onchange="Agenda.renderizarListaCompleta()">
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Data Final</label>
                            <input type="date" class="form-control" id="agenda-lista-data-fim" onchange="Agenda.renderizarListaCompleta()">
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Profissional</label>
                            <select id="agenda-lista-profissional" class="form-control" onchange="Agenda.renderizarListaCompleta()">
                                <option value="">Todos</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Status</label>
                            <select id="agenda-lista-status" class="form-control" onchange="Agenda.renderizarListaCompleta()">
                                <option value="">Todos</option>
                                <option value="agendado">Agendado</option>
                                <option value="realizado">Realizado</option>
                                <option value="cancelado">Cancelado</option>
                            </select>
                        </div>
                    </div>

                    <div id="agendaListaCompleta"></div>
                </div>
            </div>
        </div>

        <!-- GESTÃƒO -->
        <div id="tab-gestao" class="tab-content">
            <div class="card">
                <h2>âš™ï¸ ConfiguraÃ§Ãµes</h2>
                
                <!-- SUB-ABAS DE GESTÃƒO -->
                <div class="sub-tabs" style="display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button class="sub-tab active" onclick="Gestao.trocarAba('mapa')">ğŸ—ºï¸ Mapa das Unidades</button>
                    <button class="sub-tab" onclick="Gestao.trocarAba('pools')">ğŸŠ Pools</button>
                    <button class="sub-tab" onclick="Gestao.trocarAba('configuracoes')">ğŸ¥ CustomizaÃ§Ã£o Documental</button>
                    <button class="sub-tab" onclick="Gestao.trocarAba('protocolos')">ğŸ“‹ Protocolos de Atendimento</button>
                    <button class="sub-tab" onclick="Gestao.trocarAba('escalas')">ğŸ“‹ Escalas de Profissionais</button>
                    <button class="sub-tab" onclick="Gestao.trocarAba('financeiro')">ğŸ’° Financeiro Geral</button>
                    <button class="sub-tab" onclick="Gestao.trocarAba('estoque')">ğŸ“¦ Estoque Geral</button>
                    <button class="sub-tab" onclick="Gestao.trocarAba('permissoes')">ğŸ” PermissÃµes de Sistema</button>
                    <button class="sub-tab" onclick="Gestao.trocarAba('editor-atlas')">ğŸ¨ Editor de Atlas</button>
                </div>

                <!-- ABA MAPA DAS UNIDADES -->
                <div id="gestao-aba-mapa" class="sub-tab-content active">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0;">ğŸ¢ GestÃ£o de Unidades</h3>
                        <button class="btn btn-primary" onclick="Reparticoes.abrirModal()">â• Nova Unidade</button>
                    </div>

                    <!-- FILTROS -->
                    <div class="filtros-reparticao" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 20px;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Tipo de RepartiÃ§Ã£o</label>
                            <select class="form-control" id="filtro-categoria" onchange="Reparticoes.listar()">
                                <option value="">Todas</option>
                                <option value="consultorio">ğŸ©º ConsultÃ³rio</option>
                                <option value="procedimento">ğŸ¥ Procedimento</option>
                                <option value="emergencia">ğŸš¨ EmergÃªncia</option>
                                <option value="internacao">ğŸ›ï¸ InternaÃ§Ã£o</option>
                                <option value="bloco_cirurgico">âš•ï¸ Bloco CirÃºrgico</option>
                                <option value="exames">ğŸ”¬ Exames</option>
                            </select>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Buscar</label>
                            <input type="text" class="form-control" id="filtro-busca-rep" placeholder="ğŸ” Nome, pavilhÃ£o, andar..." onkeyup="Reparticoes.listar()">
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 0;">
                            <label>Status</label>
                            <select class="form-control" id="filtro-status-reparticao" onchange="Reparticoes.listar()">
                                <option value="">Todos</option>
                                <option value="livre">ğŸŸ¢ Livre</option>
                                <option value="ocupado">ğŸ”´ Ocupado</option>
                                <option value="reservado">ğŸŸ¡ Reservado</option>
                                <option value="bloqueado">â›” Bloqueado</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- BOTÃƒO MOSTRAR OCULTAS -->
                    <div id="btn-mostrar-ocultas-container" style="display: none; margin-bottom: 16px;">
                        <button class="btn btn-secondary" onclick="Reparticoes.mostrarOcultas()" style="width: 100%;">
                            ğŸ‘ï¸ Mostrar <span id="contador-ocultas">0</span> unidade(s) oculta(s)
                        </button>
                    </div>

                    <div id="listaReparticoes" style="max-height: 80vh; overflow-y: auto;"></div>
                </div>

                <!-- ABA POOLS -->
                <div id="gestao-aba-pools" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ·ï¸ GestÃ£o de Pools de PadronizaÃ§Ã£o</h3>
                    
                    <div class="alert alert-info" style="margin-bottom: 20px;">
                        <span style="font-size: 20px;">ğŸ’¡</span>
                        <div>
                            <strong>Pools de PadronizaÃ§Ã£o</strong><br>
                            <small>Gerencie valores padrÃ£o para PavilhÃµes, Andares, Setores e mais. Esses valores aparecerÃ£o em dropdowns ao criar unidades.</small>
                        </div>
                    </div>

                    <div id="listaPools"></div>
                </div>

                <!-- ABA ESCALAS -->
                <div id="gestao-aba-escalas" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ“‹ GestÃ£o de Escalas</h3>
                    <p style="color: var(--text-light); margin-bottom: 16px;">
                        Defina escalas fixas e plantÃµes para os profissionais. As escalas determinam quando cada profissional estÃ¡ disponÃ­vel em cada repartiÃ§Ã£o.
                    </p>
                    
                    <div style="display: flex; gap: 12px; margin-bottom: 20px;">
                        <button class="btn btn-primary" onclick="Escalas.abrirModal()">â• Nova Escala</button>
                        <button class="btn btn-secondary" onclick="Escalas.listar()">ğŸ”„ Atualizar</button>
                    </div>

                    <!-- Filtros -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 20px;">
                        <select id="filtro-escala-profissional" onchange="Escalas.aplicarFiltros()" class="input">
                            <option value="">Todos os profissionais</option>
                        </select>
                        <select id="filtro-escala-especialidade" onchange="Escalas.aplicarFiltros()" class="input">
                            <option value="">Todas as especialidades</option>
                        </select>
                        <select id="filtro-escala-reparticao" onchange="Escalas.aplicarFiltros()" class="input">
                            <option value="">Todas as repartiÃ§Ãµes</option>
                        </select>
                        <select id="filtro-escala-tipo" onchange="Escalas.aplicarFiltros()" class="input">
                            <option value="">Todos os tipos</option>
                            <option value="fixa">Fixa</option>
                            <option value="plantao">PlantÃ£o</option>
                            <option value="eventual">Eventual</option>
                        </select>
                    </div>

                    <div id="listaEscalas" style="margin-top: 16px;"></div>
                </div>

                <!-- ABA FINANCEIRO -->
                <div id="gestao-aba-financeiro" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ’° Financeiro</h3>
                    <div class="alert alert-info">
                        <span style="font-size: 20px;">ğŸš§</span>
                        <div>
                            <strong>Em desenvolvimento</strong><br>
                            <small>MÃ³dulo financeiro do estabelecimento serÃ¡ implementado em breve.</small>
                        </div>
                    </div>
                </div>

                <!-- ABA ESTOQUE -->
                <div id="gestao-aba-estoque" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ“¦ Estoque Central</h3>
                    <div class="alert alert-info">
                        <span style="font-size: 20px;">ğŸš§</span>
                        <div>
                            <strong>Em desenvolvimento</strong><br>
                            <small>GestÃ£o de estoque central serÃ¡ implementada em breve.</small>
                        </div>
                    </div>
                </div>

                <!-- ABA TEMPLATES -->
                <!-- ABA CONFIGURAÃ‡Ã•ES DO HOSPITAL -->
                <!-- ABA CUSTOMIZAÃ‡ÃƒO DOCUMENTAL - v10.11.1 -->
                <div id="gestao-aba-configuracoes" class="sub-tab-content">
                    <div style="background: var(--primary); color: white; padding: 16px 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h3 style="margin: 0;">ğŸ¨ CustomizaÃ§Ã£o Documental</h3>
                        <p style="margin: 8px 0 0 0; font-size: 14px; opacity: 0.95;">
                            Configure visualmente seus documentos: cabeÃ§alho, dados clÃ­nicos e templates
                        </p>
                    </div>

                    <!-- SUBABAS -->
                    <div style="display: flex; gap: 8px; margin-bottom: 24px; border-bottom: 2px solid var(--border); padding-bottom: 0;">
                        <button class="sub-tab active" onclick="CustomDocSubabas.trocar('cabecalhos')" id="subaba-cabecalhos" style="padding: 12px 20px; background: none; border: none; border-bottom: 3px solid var(--primary); font-weight: 600; cursor: pointer; color: var(--primary);">
                            ğŸ¨ CabeÃ§alhos
                        </button>
                        <!-- ELEMENTOS: Depreciado v10.357 - MÃ³dulos agora estÃ£o integrados em ModulosOrdenavel -->
                        <button class="sub-tab" onclick="CustomDocSubabas.trocar('templates')" id="subaba-templates" style="display: none; padding: 12px 20px; background: none; border: none; border-bottom: 3px solid transparent; font-weight: 600; cursor: pointer; color: var(--text-light);">
                            ğŸ§© Elementos
                        </button>
                        <button class="sub-tab" onclick="CustomDocSubabas.trocar('modelos')" id="subaba-modelos" style="padding: 12px 20px; background: none; border: none; border-bottom: 3px solid transparent; font-weight: 600; cursor: pointer; color: var(--text-light);">
                            ğŸ“‹ Modelos de ProntuÃ¡rio
                        </button>
                        <button class="sub-tab" onclick="CustomDocSubabas.trocar('sandbox')" id="subaba-sandbox" style="padding: 12px 20px; background: none; border: none; border-bottom: 3px solid transparent; font-weight: 600; cursor: pointer; color: var(--text-light);">
                            ğŸ§ª Sandbox
                        </button>
                    </div>

                    <!-- CONTEÃšDO SUBABA: CABEÃ‡ALHO VISUAL -->
                    <div id="customdoc-subaba-cabecalhos" class="customdoc-subaba-content">

                        <!-- ALERT EXPLICATIVO -->
                        <div class="alert alert-info" style="margin-bottom: 20px; background: #dbeafe; border: 2px solid #3b82f6;">
                            <span style="font-size: 20px;">ğŸ¨</span>
                            <div>
                                <strong>Biblioteca de CabeÃ§alhos</strong><br>
                                <small>Crie layouts de cabeÃ§alho reutilizÃ¡veis. Cada layout pode ser usado em mÃºltiplos modelos de prontuÃ¡rio.</small>
                            </div>
                        </div>

                        <!-- LAYOUT: Lista + Editor + Preview -->
                        <div style="display: grid; grid-template-columns: 220px 1fr 1fr; gap: 16px;">
                            
                            <!-- ===== COLUNA 1: LISTA DE LAYOUTS ===== -->
                            <div style="background: white; padding: 16px; border-radius: 8px; border: 1px solid var(--border); max-height: 85vh; overflow-y: auto;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                    <h5 style="margin: 0; font-size: 13px;">ğŸ“š Layouts</h5>
                                    <button class="btn btn-primary" onclick="Cabecalhos.novoLayout()" style="padding: 4px 10px; font-size: 11px;">
                                        â•
                                    </button>
                                </div>
                                
                                <div id="cabecalhos-lista" style="display: flex; flex-direction: column; gap: 8px;">
                                    <!-- Lista serÃ¡ preenchida via JS -->
                                </div>
                            </div>

                            <!-- ===== COLUNA 2: EDITOR ===== -->
                            <div style="background: white; padding: 16px; border-radius: 8px; border: 1px solid var(--border); max-height: 85vh; overflow-y: auto;">
                                
                                <div id="cabecalhos-editor-vazio" style="text-align: center; padding: 40px 20px; color: var(--text-light);">
                                    <div style="font-size: 40px; margin-bottom: 12px;">ğŸ¨</div>
                                    <p style="font-size: 13px;">Selecione um layout<br>ou crie um novo</p>
                                </div>

                                <div id="cabecalhos-editor-form" style="display: none;">
                                    
                                    <!-- NOME DO LAYOUT -->
                                    <div style="margin-bottom: 24px; padding-bottom: 20px; border-bottom: 2px solid var(--border);">
                                        <div class="form-group">
                                            <label class="form-label" style="font-weight: 600;">ğŸ“ Nome do Layout:</label>
                                            <input type="text" id="cab-nome" class="form-control" placeholder="Ex: CabeÃ§alho PadrÃ£o EmergÃªncia">
                                        </div>
                                    </div>

                                    <!-- TIPO BASE -->
                                    <div style="margin-bottom: 24px; padding-bottom: 20px; border-bottom: 2px solid var(--border);">
                                        <h5 style="margin-bottom: 12px; color: var(--primary); font-size: 14px;">ğŸ“ Tipo Base</h5>
                                        <select id="cab-tipo-base" class="form-control" onchange="Cabecalhos.trocarTipoBase()">
                                            <option value="minimalista">Minimalista (1 linha)</option>
                                            <option value="compacto">Compacto (2 linhas)</option>
                                            <option value="padrao" selected>PadrÃ£o (3 linhas)</option>
                                            <option value="completo">Completo (tabela)</option>
                                            <option value="folha-rosto">Folha de Rosto (administrativo)</option>
                                        </select>
                                        <small style="color: var(--text-light); display: block; margin-top: 6px; font-size: 11px;">
                                            O tipo base define a estrutura. VocÃª pode personalizar os elementos depois.
                                        </small>
                                    </div>

                                    <!-- LOGO -->
                                    <div style="margin-bottom: 24px; padding-bottom: 20px; border-bottom: 2px solid var(--border);">
                                        <h5 style="margin-bottom: 12px; color: var(--primary); font-size: 14px;">ğŸ–¼ï¸ Logo</h5>
                                        
                                        <label style="display: flex; align-items: center; margin-bottom: 12px; cursor: pointer;">
                                            <input type="checkbox" id="cab-logo-ativo" onchange="Cabecalhos.toggleSecao('logo'); Cabecalhos.atualizarPreview()" style="margin-right: 8px; width: 16px; height: 16px;" checked>
                                            <span style="font-size: 13px; font-weight: 500;">Mostrar Logo</span>
                                        </label>

                                        <div id="cab-logo-opcoes">
                                            <div class="form-group" style="margin-bottom: 10px;">
                                                <label class="form-label" style="font-size: 12px;">URL da Logo:</label>
                                                <input type="text" id="cab-logo-url" class="form-control" placeholder="https://..." onchange="Cabecalhos.atualizarPreview()" style="font-size: 12px;">
                                                <small style="color: var(--text-light); font-size: 10px;">Deixe vazio para usar logo padrÃ£o do estabelecimento</small>
                                            </div>

                                            <div class="form-group" style="margin-bottom: 10px;">
                                                <label class="form-label" style="font-size: 12px;">Tamanho:</label>
                                                <select id="cab-logo-tamanho" class="form-control" onchange="Cabecalhos.atualizarPreview()" style="font-size: 12px;">
                                                    <option value="pequeno">Pequeno (50px)</option>
                                                    <option value="medio" selected>MÃ©dio (80px)</option>
                                                    <option value="grande">Grande (120px)</option>
                                                </select>
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label" style="font-size: 12px;">PosiÃ§Ã£o:</label>
                                                <select id="cab-logo-posicao" class="form-control" onchange="Cabecalhos.atualizarPreview()" style="font-size: 12px;">
                                                    <option value="esquerda" selected>Esquerda</option>
                                                    <option value="centro">Centro</option>
                                                    <option value="direita">Direita</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- QR CODE E CÃ“DIGO DE BARRAS - v10.385 -->
                                    <div style="margin-bottom: 24px; padding-bottom: 20px; border-bottom: 2px solid var(--border);">
                                        <h5 style="margin-bottom: 12px; color: var(--primary); font-size: 14px;">ğŸ“Š QR Code e CÃ³digo de Barras</h5>
                                        
                                        <label style="display: flex; align-items: center; margin-bottom: 12px; cursor: pointer;">
                                            <input type="checkbox" id="cab-qrcode-ativo" onchange="Cabecalhos.toggleSecao('qrcode'); Cabecalhos.atualizarPreview()" style="margin-right: 8px; width: 16px; height: 16px;">
                                            <span style="font-size: 13px; font-weight: 500;">Mostrar QR Code</span>
                                        </label>

                                        <div id="cab-qrcode-opcoes" style="display: none; margin-bottom: 16px;">
                                            <div class="form-group" style="margin-bottom: 10px;">
                                                <label class="form-label" style="font-size: 12px;">ConteÃºdo do QR Code:</label>
                                                <select id="cab-qrcode-conteudo" class="form-control" onchange="Cabecalhos.atualizarPreview()" style="font-size: 12px;">
                                                    <option value="prontuario">NÂº ProntuÃ¡rio</option>
                                                    <option value="atendimento">NÂº Atendimento</option>
                                                    <option value="url">URL do Atendimento</option>
                                                    <option value="paciente_id">ID do Paciente</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" style="font-size: 12px;">PosiÃ§Ã£o:</label>
                                                <select id="cab-qrcode-posicao" class="form-control" onchange="Cabecalhos.atualizarPreview()" style="font-size: 12px;">
                                                    <option value="topo-direita" selected>Topo - Direita</option>
                                                    <option value="topo-esquerda">Topo - Esquerda</option>
                                                </select>
                                            </div>
                                        </div>

                                        <label style="display: flex; align-items: center; margin-bottom: 12px; cursor: pointer;">
                                            <input type="checkbox" id="cab-barcode-ativo" onchange="Cabecalhos.toggleSecao('barcode'); Cabecalhos.atualizarPreview()" style="margin-right: 8px; width: 16px; height: 16px;">
                                            <span style="font-size: 13px; font-weight: 500;">Mostrar CÃ³digo de Barras</span>
                                        </label>

                                        <div id="cab-barcode-opcoes" style="display: none;">
                                            <div class="form-group" style="margin-bottom: 10px;">
                                                <label class="form-label" style="font-size: 12px;">ConteÃºdo do CÃ³digo de Barras:</label>
                                                <select id="cab-barcode-conteudo" class="form-control" onchange="Cabecalhos.atualizarPreview()" style="font-size: 12px;">
                                                    <option value="prontuario">NÂº ProntuÃ¡rio</option>
                                                    <option value="atendimento">NÂº Atendimento</option>
                                                    <option value="paciente_id">ID do Paciente</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" style="font-size: 12px;">PosiÃ§Ã£o:</label>
                                                <select id="cab-barcode-posicao" class="form-control" onchange="Cabecalhos.atualizarPreview()" style="font-size: 12px;">
                                                    <option value="topo-direita" selected>Topo - Direita</option>
                                                    <option value="topo-esquerda">Topo - Esquerda</option>
                                                    <option value="abaixo-dados">Abaixo dos Dados</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- CAMPOS DO ESTABELECIMENTO -->
                                    <div style="margin-bottom: 24px; padding-bottom: 20px; border-bottom: 2px solid var(--border);">
                                        <h5 style="margin-bottom: 12px; color: var(--primary); font-size: 14px;">ğŸ¥ Dados do Estabelecimento</h5>
                                        
                                        <div style="display: flex; flex-direction: column; gap: 6px; max-height: 220px; overflow-y: auto; padding: 8px; background: var(--bg); border-radius: 4px;">
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="nome" onchange="Cabecalhos.atualizarPreview()" checked style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Nome Fantasia</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="razao_social" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>RazÃ£o Social</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="cnpj" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>CNPJ</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="cnes" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>CNES</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="endereco" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>EndereÃ§o Completo</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="telefone" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Telefone</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="email" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>E-mail</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="responsavel_tecnico" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>ResponsÃ¡vel TÃ©cnico</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="crm_responsavel" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>CRM do ResponsÃ¡vel</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="especialidades" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Especialidades</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-estab" value="tipo_estabelecimento" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Tipo de Estabelecimento</span>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- CAMPOS DO PACIENTE -->
                                    <div style="margin-bottom: 24px; padding-bottom: 20px; border-bottom: 2px solid var(--border);">
                                        <h5 style="margin-bottom: 12px; color: var(--primary); font-size: 14px;">ğŸ‘¤ Dados do Paciente</h5>
                                        
                                        <div style="display: flex; flex-direction: column; gap: 6px; max-height: 280px; overflow-y: auto; padding: 8px; background: var(--bg); border-radius: 4px;">
                                            <div style="font-size: 10px; font-weight: 600; color: var(--primary); margin-bottom: 4px; padding: 4px; background: rgba(59, 130, 246, 0.1); border-radius: 4px;">ğŸ“‹ IDENTIFICAÃ‡ÃƒO</div>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="nome" onchange="Cabecalhos.atualizarPreview()" checked style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Nome Completo</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="nome_social" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Nome Social</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="prontuario" onchange="Cabecalhos.atualizarPreview()" checked style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>NÂº ProntuÃ¡rio</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="atendimento" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>NÂº Atendimento</span>
                                            </label>
                                            
                                            <div style="font-size: 10px; font-weight: 600; color: var(--primary); margin: 8px 0 4px 0; padding: 4px; background: rgba(59, 130, 246, 0.1); border-radius: 4px;">ğŸ“… DADOS PESSOAIS</div>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="nascimento" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Data de Nascimento</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="idade" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Idade</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="sexo" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Sexo</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="estado_civil" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Estado Civil</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="cor_raca" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Cor/RaÃ§a</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="naturalidade" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Naturalidade</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="nacionalidade" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Nacionalidade</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="profissao" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>ProfissÃ£o</span>
                                            </label>
                                            
                                            <div style="font-size: 10px; font-weight: 600; color: #ef4444; margin: 8px 0 4px 0; padding: 4px; background: rgba(239, 68, 68, 0.1); border-radius: 4px;">âš ï¸ INFORMAÃ‡Ã•ES CLÃNICAS</div>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="alergias" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span style="color: #ef4444; font-weight: 500;">ğŸš¨ Alergias (da avaliaÃ§Ã£o clÃ­nica - HPP)</span>
                                            </label>
                                            
                                            <div style="font-size: 10px; font-weight: 600; color: var(--primary); margin: 8px 0 4px 0; padding: 4px; background: rgba(59, 130, 246, 0.1); border-radius: 4px;">ğŸ“„ DOCUMENTOS</div>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="cpf" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>CPF</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="rg" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>RG</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="cns" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>CNS (CartÃ£o SUS)</span>
                                            </label>
                                            
                                            <div style="font-size: 10px; font-weight: 600; color: var(--primary); margin: 8px 0 4px 0; padding: 4px; background: rgba(59, 130, 246, 0.1); border-radius: 4px;">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ FILIAÃ‡ÃƒO</div>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="nome_mae" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Nome da MÃ£e</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="nome_pai" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Nome do Pai</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="responsavel" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>ResponsÃ¡vel Legal</span>
                                            </label>
                                            
                                            <div style="font-size: 10px; font-weight: 600; color: var(--primary); margin: 8px 0 4px 0; padding: 4px; background: rgba(59, 130, 246, 0.1); border-radius: 4px;">ğŸ“ CONTATO</div>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="endereco" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>EndereÃ§o</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="telefone" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Telefone</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="email" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>E-mail</span>
                                            </label>
                                            
                                            <div style="font-size: 10px; font-weight: 600; color: var(--primary); margin: 8px 0 4px 0; padding: 4px; background: rgba(59, 130, 246, 0.1); border-radius: 4px;">ğŸ¥ ATENDIMENTO</div>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="numero_registro" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>NÂº Registro (Entrada)</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="data" onchange="Cabecalhos.atualizarPreview()" checked style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Data do Atendimento</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="hora" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Hora do Atendimento</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="local_admissao" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Local da AdmissÃ£o</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="motivo_atendimento" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Motivo do Atendimento</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="convenio" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>ConvÃªnio</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="leito" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Leito/Quarto</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="setor" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Setor/Unidade</span>
                                            </label>
                                            
                                            <div style="font-size: 10px; font-weight: 600; color: var(--primary); margin: 8px 0 4px 0; padding: 4px; background: rgba(59, 130, 246, 0.1); border-radius: 4px;">ğŸ‘¥ ACOMPANHANTE</div>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="nome_acompanhante" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Nome do Acompanhante</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="telefone_acompanhante" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>Telefone do Acompanhante</span>
                                            </label>
                                            <label style="display: flex; align-items: center; cursor: pointer; font-size: 12px;">
                                                <input type="checkbox" class="cab-campo-paciente" value="medico_responsavel" onchange="Cabecalhos.atualizarPreview()" style="margin-right: 6px; width: 14px; height: 14px;">
                                                <span>MÃ©dico ResponsÃ¡vel</span>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- BOTÃ•ES -->
                                    <div style="display: flex; gap: 12px;">
                                        <button class="btn btn-secondary" onclick="Cabecalhos.cancelar()" style="flex: 1;">
                                            âŒ Cancelar
                                        </button>
                                        <button class="btn btn-success" onclick="Cabecalhos.salvar()" style="flex: 2; font-weight: bold;">
                                            ğŸ’¾ Salvar Layout
                                        </button>
                                    </div>

                                </div>
                            </div>

                            <!-- ===== COLUNA 3: PREVIEW AO VIVO ===== -->
                            <div style="background: white; padding: 16px; border-radius: 8px; border: 1px solid #e0e0e0; max-height: 85vh; overflow-y: auto;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 2px solid var(--border);">
                                    <h5 style="margin: 0; font-size: 13px; color: var(--primary);">ğŸ‘ï¸ Preview ao Vivo</h5>
                                    <small style="color: var(--text-light); font-size: 10px;">Atualiza automaticamente</small>
                                </div>
                                
                                <div id="cabecalhos-preview-vazio" style="text-align: center; padding: 40px 20px; color: var(--text-light);">
                                    <div style="font-size: 40px; margin-bottom: 12px;">ğŸ‘€</div>
                                    <p style="font-size: 13px;">O preview aparecerÃ¡ aqui<br>quando editar um layout</p>
                                </div>
                                
                                <div id="cabecalhos-preview-container" style="display: none;">
                                    <!-- CabeÃ§alho renderizado -->
                                    <div style="background: #f3f4f6; padding: 12px; border-radius: 8px;">
                                        <div id="cabecalhos-preview-cabecalho" style="background: white; border: 1px solid #ddd; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                            <!-- SerÃ¡ preenchido via JS -->
                                        </div>
                                    </div>
                                    
                                    <!-- Legenda -->
                                    <div style="margin-top: 12px; padding: 10px; background: #f9fafb; border-radius: 6px; border: 1px solid #fcd34d;">
                                        <small style="color: #92400e; font-size: 10px;">
                                            <strong>Legenda:</strong> Os campos em <span style="background: #e5e7eb; padding: 1px 4px; border-radius: 2px;">cinza</span> mostram onde cada informaÃ§Ã£o aparecerÃ¡ no documento final.
                                        </small>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!-- FIM SUBABA: CABEÃ‡ALHOS -->

                    <!-- âŒ SUBABA "DADOS CLÃNICOS" REMOVIDA NA v10.43 - Era redundante com paciente teste -->

                    <!-- ========== SUBABA: MODELOS DE ATENDIMENTO (v10.130) ========== -->
                    <div id="customdoc-subaba-modelos" class="customdoc-subaba-content" style="display: none;">
                        
                        <!-- ALERT EXPLICATIVO -->
                        <div class="alert alert-info" style="margin-bottom: 20px; background: #dbeafe; border: 2px solid #3b82f6;">
                            <span style="font-size: 20px;">ğŸ“‹</span>
                            <div>
                                <strong>Modelos de ProntuÃ¡rio</strong><br>
                                <small>Configure a estrutura completa do prontuÃ¡rio: cabeÃ§alho visual, mÃ³dulos de conteÃºdo (anamnese, exame fÃ­sico, diagnÃ³stico), sinais vitais, escalas clÃ­nicas e mais. Cada modelo pode ser usado para diferentes tipos de atendimento e especialidades.</small>
                            </div>
                        </div>

                        <!-- BOTÃƒO CRIAR MODELO -->
                        <div style="margin-bottom: 24px;">
                            <button class="btn btn-primary" onclick="ModelosAtendimento.abrirModal()" style="padding: 12px 24px; font-weight: 600;">
                                â• Novo Modelo de ProntuÃ¡rio
                            </button>
                        </div>

                        <!-- LISTA DE MODELOS POR TIPO -->
                        <div id="lista-modelos-atendimento">
                            <!-- SerÃ¡ preenchido via JavaScript -->
                        </div>

                    </div>
                    <!-- FIM SUBABA: MODELOS DE ATENDIMENTO -->


                    <!-- ========== SUBABA 2: GERENCIADOR DE TEMPLATES ========== -->

                    <!-- ========== SUBABA 3: GERENCIADOR DE TEMPLATES ========== -->
                    <div id="customdoc-subaba-templates" class="customdoc-subaba-content" style="display: none;">
                        
                        <!-- ALERT EXPLICATIVO -->
                        <div class="alert alert-info" style="margin-bottom: 20px; background: #f9fafb; border: 2px solid #f59e0b;">
                            <span style="font-size: 20px;">ğŸ§©</span>
                            <div>
                                <strong>Elementos do Atendimento</strong><br>
                                <small>Crie templates de seÃ§Ãµes reutilizÃ¡veis. Defina os campos de cada elemento e depois combine-os nos Modelos de ProntuÃ¡rio.</small>
                            </div>
                        </div>

                        <!-- LAYOUT: Lista + Editor + Preview -->
                        <div style="display: grid; grid-template-columns: 220px 1fr 1fr; gap: 16px;">
                            
                            <!-- ===== COLUNA 1: LISTA DE ELEMENTOS ===== -->
                            <div style="background: white; padding: 16px; border-radius: 8px; border: 1px solid var(--border); max-height: 85vh; overflow-y: auto;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                    <h5 style="margin: 0; font-size: 13px;">ğŸ§© Elementos</h5>
                                    <button class="btn btn-primary" onclick="Elementos.novo()" style="padding: 4px 10px; font-size: 11px;">
                                        â•
                                    </button>
                                </div>
                                
                                <div id="elementos-lista" style="display: flex; flex-direction: column; gap: 8px;">
                                    <!-- Lista serÃ¡ preenchida via JS -->
                                </div>
                            </div>

                            <!-- ===== COLUNA 2: EDITOR ===== -->
                            <div style="background: white; padding: 16px; border-radius: 8px; border: 1px solid var(--border); max-height: 85vh; overflow-y: auto;">
                                
                                <div id="elementos-editor-vazio" style="text-align: center; padding: 40px 20px; color: var(--text-light);">
                                    <div style="font-size: 40px; margin-bottom: 12px;">ğŸ§©</div>
                                    <p style="font-size: 13px;">Selecione um elemento<br>ou crie um novo</p>
                                </div>

                                <div id="elementos-editor-form" style="display: none;">
                                    
                                    <!-- NOME DO ELEMENTO -->
                                    <div style="margin-bottom: 20px; padding-bottom: 16px; border-bottom: 2px solid var(--border);">
                                        <div class="form-group">
                                            <label class="form-label" style="font-weight: 600; font-size: 12px;">ğŸ“ Nome do Elemento:</label>
                                            <input type="text" id="elem-nome" class="form-control" placeholder="Ex: Anamnese Completa" style="font-size: 13px;" oninput="Elementos.renderizarPreview()">
                                        </div>
                                    </div>

                                    <!-- TIPO DO ELEMENTO -->
                                    <div style="margin-bottom: 20px; padding-bottom: 16px; border-bottom: 2px solid var(--border);">
                                        <h5 style="margin-bottom: 10px; color: var(--primary); font-size: 13px;">ğŸ·ï¸ Tipo</h5>
                                        <select id="elem-tipo" class="form-control" style="font-size: 12px;" onchange="Elementos.renderizarPreview()">
                                            <option value="anamnese">ğŸ—£ï¸ Anamnese</option>
                                            <option value="sinais-vitais">â¤ï¸ Sinais Vitais</option>
                                            <option value="antropometria">ğŸ“ Antropometria</option>
                                            <option value="exame-fisico-geral">Exame FÃ­sico Geral</option>
                                            <option value="exame-fisico-especifico">ğŸ‘¤ Exame FÃ­sico EspecÃ­fico</option>
                                            <option value="escalas">ğŸ“Š Escalas ClÃ­nicas</option>
                                            <option value="diagnostico">HipÃ³tese DiagnÃ³stica</option>
                                            <option value="conduta">Conduta</option>
                                            <option value="outro">âœ¨ Outro</option>
                                        </select>
                                    </div>

                                    <!-- LISTA DE CAMPOS -->
                                    <div style="margin-bottom: 20px;">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                            <h5 style="margin: 0; color: var(--primary); font-size: 13px;">ğŸ“‹ Campos</h5>
                                            <button class="btn btn-secondary" onclick="Elementos.adicionarCampo()" style="padding: 4px 10px; font-size: 11px;">
                                                â• Adicionar Campo
                                            </button>
                                        </div>
                                        
                                        <div id="elem-campos-lista" style="display: flex; flex-direction: column; gap: 12px;">
                                            <!-- Campos serÃ£o adicionados aqui -->
                                        </div>
                                    </div>

                                    <!-- BOTÃ•ES -->
                                    <div style="display: flex; gap: 12px;">
                                        <button class="btn btn-secondary" onclick="Elementos.cancelar()" style="flex: 1; font-size: 12px;">
                                            âŒ Cancelar
                                        </button>
                                        <button class="btn btn-success" onclick="Elementos.salvar()" style="flex: 2; font-weight: bold; font-size: 12px;">
                                            ğŸ’¾ Salvar Elemento
                                        </button>
                                    </div>

                                </div>
                            </div>

                            <!-- ===== COLUNA 3: PREVIEW ===== -->
                            <div style="background: white; padding: 16px; border-radius: 8px; border: 1px solid #e0e0e0; max-height: 85vh; overflow-y: auto;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 2px solid var(--border);">
                                    <h5 style="margin: 0; font-size: 13px; color: var(--primary);">ğŸ‘ï¸ Preview</h5>
                                    <small style="color: var(--text-light); font-size: 10px;">Como ficarÃ¡ no prontuÃ¡rio</small>
                                </div>
                                
                                <div id="elementos-preview-vazio" style="text-align: center; padding: 40px 20px; color: var(--text-light);">
                                    <div style="font-size: 40px; margin-bottom: 12px;">ğŸ‘€</div>
                                    <p style="font-size: 13px;">O preview aparecerÃ¡ aqui<br>quando editar um elemento</p>
                                </div>
                                
                                <div id="elementos-preview-container" style="display: none;">
                                    <div id="elementos-preview-conteudo" style="background: #f8fafc; padding: 16px; border-radius: 8px; border: 1px solid #e5e7eb;">
                                        <!-- Preview serÃ¡ renderizado aqui -->
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>
                    <!-- FIM SUBABA: GERENCIADOR DE TEMPLATES -->

                    <!-- ========== SUBABA: EDITOR DE FOTOS ========== -->
                    <!-- ========== SUBABA 4: TIPOS DE DOCUMENTO ========== -->
                    <!-- ========== SUBABA 3: PRONTUÃRIO SANDBOX ========== -->
                    <div id="customdoc-subaba-sandbox" class="customdoc-subaba-content" style="display: none;">
                        
                        <!-- ALERT EXPLICATIVO -->
                        <div class="alert alert-info" style="margin-bottom: 20px; background: #f9fafb; border: 1px solid #ddd;">
                            <span style="font-size: 20px;">ğŸ§ª</span>
                            <div>
                                <strong>Ambiente de Teste do ProntuÃ¡rio</strong><br>
                                <small>Teste todas as funcionalidades do prontuÃ¡rio com dados fictÃ­cios. Nada aqui afeta os dados reais. Use para validar pools, templates, espaÃ§amento e formataÃ§Ã£o antes de usar com pacientes reais.</small>
                            </div>
                        </div>

                        <!-- SELETOR DE PACIENTE -->
                        <div style="background: white; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                                <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; color: white;">
                                    ğŸ§ª
                                </div>
                                <div style="flex: 1;">
                                    <h3 style="margin: 0 0 4px 0; color: var(--primary);">Selecione um Paciente</h3>
                                    <p style="margin: 0; color: var(--text-light); font-size: 14px;">Escolha um paciente cadastrado para testar o modelo</p>
                                </div>
                            </div>
                            
                            <!-- BUSCA DE PACIENTE -->
                            <div style="margin-bottom: 16px;">
                                <div style="position: relative;">
                                    <input type="text" id="sandbox-busca-paciente" class="form-control" 
                                           placeholder="ğŸ” Digite nome, CPF ou prontuÃ¡rio..." 
                                           oninput="Sandbox.buscarPaciente(this.value)"
                                           style="font-size: 14px; padding-right: 40px;">
                                    <button onclick="Sandbox.limparPaciente()" 
                                            style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 16px; color: #999;"
                                            title="Limpar seleÃ§Ã£o">âœ•</button>
                                </div>
                                <div id="sandbox-lista-pacientes" style="display: none; position: absolute; z-index: 100; background: white; border: 1px solid var(--border); border-radius: 6px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); max-height: 250px; overflow-y: auto; width: calc(100% - 40px);"></div>
                            </div>
                            
                            <!-- DADOS DO PACIENTE SELECIONADO -->
                            <div id="sandbox-dados-paciente" style="display: none; padding: 16px; background: var(--bg); border-radius: 6px;">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                                    <div>
                                        <strong style="font-size: 11px; color: var(--text-light); display: block;">ğŸ‘¤ Nome:</strong>
                                        <span style="font-size: 13px;" id="sandbox-pac-nome">-</span>
                                    </div>
                                    <div>
                                        <strong style="font-size: 11px; color: var(--text-light); display: block;">ğŸ“„ CPF:</strong>
                                        <span style="font-size: 13px;" id="sandbox-pac-cpf">-</span>
                                    </div>
                                    <div>
                                        <strong style="font-size: 11px; color: var(--text-light); display: block;">ğŸ“‹ ProntuÃ¡rio:</strong>
                                        <span style="font-size: 13px;" id="sandbox-pac-prontuario">-</span>
                                    </div>
                                    <div>
                                        <strong style="font-size: 11px; color: var(--text-light); display: block;">ğŸ‚ Nascimento:</strong>
                                        <span style="font-size: 13px;" id="sandbox-pac-nascimento">-</span>
                                    </div>
                                    <div>
                                        <strong style="font-size: 11px; color: var(--text-light); display: block;">âš§ï¸ Sexo:</strong>
                                        <span style="font-size: 13px;" id="sandbox-pac-sexo">-</span>
                                    </div>
                                    <div>
                                        <strong style="font-size: 11px; color: var(--text-light); display: block;">ğŸ’³ ConvÃªnio:</strong>
                                        <span style="font-size: 13px;" id="sandbox-pac-convenio">-</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- MENSAGEM QUANDO NENHUM PACIENTE SELECIONADO -->
                            <div id="sandbox-sem-paciente" style="padding: 20px; text-align: center; color: var(--text-light); background: var(--bg); border-radius: 6px;">
                                <div style="font-size: 32px; margin-bottom: 8px;">ğŸ‘†</div>
                                <p style="margin: 0;">Digite acima para buscar um paciente</p>
                            </div>
                        </div>

                        <!-- SELETOR DE MODELO -->
                        <div style="background: white; padding: 20px; border-radius: 8px; border: 1px solid var(--border); margin-bottom: 20px;">
                            <label style="font-weight: 600; margin-bottom: 12px; display: block; color: var(--primary);">
                                ğŸ“‹ Escolha o Modelo de ProntuÃ¡rio:
                            </label>
                            <select id="sandbox-tipo-doc" class="form-control" onchange="Sandbox.trocarTipo()" style="font-size: 14px; max-width: 500px;">
                                <option value="">-- Selecione --</option>
                                <!-- Modelos de ProntuÃ¡rio serÃ£o inseridos via JS -->
                            </select>
                            <small style="display: block; margin-top: 8px; color: var(--text-light);">
                                O cabeÃ§alho configurado no modelo serÃ¡ exibido automaticamente
                            </small>
                        </div>

                        <!-- ÃREA DE PREVIEW -->
                        <div id="sandbox-preview-area" style="display: none;">
                            
                            <!-- PREVIEW DO DOCUMENTO -->
                            <div style="background: white; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 20px;">

                                <!-- CABEÃ‡ALHO DINÃ‚MICO -->
                                <div id="sandbox-cabecalho" style="border: 1px solid #e0e0e0; margin-bottom: 24px; border-radius: 8px; background: #f8fafc; overflow: hidden;">
                                    <!-- SerÃ¡ preenchido via JS baseado no layout selecionado -->
                                    <div style="padding: 40px; text-align: center; color: var(--text-light);">
                                        <div style="font-size: 48px; margin-bottom: 12px;">ğŸ¨</div>
                                        <p>Selecione um layout ou modelo acima</p>
                                    </div>
                                </div>

                                <!-- TÃTULO DO DOCUMENTO -->
                                <div style="text-align: center; margin-bottom: 20px; padding: 12px; background: #f1f5f9; border-radius: 8px; border: 2px solid #cbd5e1;">
                                    <h3 id="sandbox-doc-titulo" style="margin: 0; color: #334155; font-size: 18px; letter-spacing: 1px;">DOCUMENTO</h3>
                                </div>

                                <!-- CONTEÃšDO DO DOCUMENTO -->
                                <div id="sandbox-conteudo">
                                    <!-- ConteÃºdo serÃ¡ inserido aqui via JS -->
                                </div>

                                <!-- BOTÃ•ES DE AÃ‡ÃƒO -->
                                <div style="margin-top: 24px; padding-top: 20px; border-top: 2px solid var(--border); display: flex; gap: 12px; justify-content: space-between;">
                                    <button class="btn btn-primary" onclick="Sandbox.verAtendimentosSalvos()" style="padding: 12px 24px;">
                                        ğŸ“‹ Ver Atendimentos Salvos
                                    </button>
                                    <div style="display: flex; gap: 12px;">
                                        <button class="btn btn-secondary" onclick="Sandbox.limpar()" style="padding: 12px 24px;">
                                            ğŸ—‘ï¸ Limpar Campos
                                        </button>
                                        <button id="btn-salvar-atendimento" class="btn btn-success" onclick="Sandbox.salvarAtendimento()" style="padding: 12px 24px; font-weight: bold;">
                                            ğŸ’¾ Salvar Atendimento
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- LISTA DE ATENDIMENTOS SALVOS -->
                        <div id="sandbox-lista-atendimentos" style="display: none;">
                            <div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                                <h3 style="margin: 0; color: var(--primary);">ğŸ“‹ Atendimentos Salvos</h3>
                                <button class="btn btn-secondary" onclick="Sandbox.voltarParaFormulario()">
                                    â† Voltar para FormulÃ¡rio
                                </button>
                            </div>
                            
                            <div id="sandbox-atendimentos-container">
                                <!-- Atendimentos serÃ£o listados aqui -->
                            </div>
                        </div>

                        <!-- MENSAGEM QUANDO NADA SELECIONADO -->
                        <div id="sandbox-mensagem-inicial" style="background: white; padding: 40px; border-radius: 8px; border: 1px dashed #ddd; text-align: center;">
                            <div style="font-size: 64px; margin-bottom: 16px;">ğŸ“‹</div>
                            <h3 style="color: var(--text-light); margin-bottom: 12px;">Selecione um documento acima</h3>
                            <p style="color: var(--text-light); max-width: 600px; margin: 0 auto;">
                                Escolha entre <strong>Folha de Rosto</strong> ou um dos <strong>Templates</strong> que vocÃª criou para ver como ficarÃ¡ na prÃ¡tica com o paciente teste.
                            </p>
                        </div>

                    </div>
                    <!-- FIM SUBABA: PRONTUÃRIO SANDBOX -->


                </div>

                <!-- ABA PROTOCOLOS INSTITUCIONAIS -->
                <div id="gestao-aba-protocolos" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ“‹ Protocolos Institucionais</h3>
                    
                    <div class="alert alert-info" style="margin-bottom: 20px;">
                        <span style="font-size: 20px;">â„¹ï¸</span>
                        <div>
                            <strong>Protocolos ClÃ­nicos do Hospital</strong><br>
                            <small>Gerencie os protocolos assistenciais utilizados no hospital. Estes protocolos padronizam e melhoram a qualidade do atendimento.</small>
                        </div>
                    </div>
                    
                    <!-- PROTOCOLO DE MANCHESTER (JÃ IMPLEMENTADO) -->
                    <div style="margin-bottom: 32px; padding: 20px; background: var(--bg); border-radius: 8px; border: 2px solid #ef4444;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                            <h4 style="margin: 0; color: #ef4444;">ğŸš¨ Protocolo de Manchester</h4>
                            <span style="padding: 6px 12px; background: #10b981; color: white; border-radius: 6px; font-size: 12px; font-weight: bold;">âœ… IMPLEMENTADO</span>
                        </div>
                        
                        <p style="color: var(--text-light); margin-bottom: 16px; font-size: 14px;">
                            Sistema de classificaÃ§Ã£o de risco para emergÃªncias. Classifica pacientes em 5 nÃ­veis de prioridade (Vermelho, Laranja, Amarelo, Verde, Azul).
                        </p>
                        
                        <!-- LEGENDA DAS CORES -->
                        <div style="margin-bottom: 20px;">
                            <h5 style="margin-bottom: 12px;">ğŸ¨ NÃ­veis de Prioridade</h5>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 8px;">
                                <div style="padding: 10px; background: #ef4444; color: white; border-radius: 6px; text-align: center; font-size: 12px; font-weight: bold;">
                                    ğŸ”´ VERMELHO<br>
                                    <small style="font-weight: normal;">0 min</small>
                                </div>
                                <div style="padding: 10px; background: #f97316; color: white; border-radius: 6px; text-align: center; font-size: 12px; font-weight: bold;">
                                    ğŸŸ  LARANJA<br>
                                    <small style="font-weight: normal;">10 min</small>
                                </div>
                                <div style="padding: 10px; background: #eab308; color: white; border-radius: 6px; text-align: center; font-size: 12px; font-weight: bold;">
                                    ğŸŸ¡ AMARELO<br>
                                    <small style="font-weight: normal;">60 min</small>
                                </div>
                                <div style="padding: 10px; background: #22c55e; color: white; border-radius: 6px; text-align: center; font-size: 12px; font-weight: bold;">
                                    ğŸŸ¢ VERDE<br>
                                    <small style="font-weight: normal;">120 min</small>
                                </div>
                                <div style="padding: 10px; background: #3b82f6; color: white; border-radius: 6px; text-align: center; font-size: 12px; font-weight: bold;">
                                    ğŸ”µ AZUL<br>
                                    <small style="font-weight: normal;">240 min</small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- FLUXOGRAMAS -->
                        <div style="margin-bottom: 16px;">
                            <h5 style="margin-bottom: 12px;">ğŸ“‹ Fluxogramas DisponÃ­veis (Top 10)</h5>
                            <div id="lista-fluxogramas-manchester"></div>
                        </div>
                        
                        <!-- SIMULADOR -->
                        <div style="padding: 16px; background: white; border-radius: 6px; border: 1px solid var(--border);">
                            <h5 style="margin-bottom: 12px; color: var(--primary);">ğŸ¯ Simulador de ClassificaÃ§Ã£o</h5>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                <div class="form-group" style="margin-bottom: 0;">
                                    <label class="form-label">Fluxograma</label>
                                    <select class="form-control" id="simulador-fluxograma" onchange="Manchester.carregarDiscriminadores()">
                                        <option value="">-- Escolha --</option>
                                    </select>
                                </div>
                                
                                <div class="form-group" style="margin-bottom: 0;">
                                    <label class="form-label">Discriminador</label>
                                    <select class="form-control" id="simulador-discriminador" onchange="Manchester.exibirClassificacao()">
                                        <option value="">-- Escolha --</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div id="resultado-classificacao" style="display: none; margin-top: 16px; padding: 16px; border-radius: 6px; text-align: center;">
                                <div style="font-size: 40px; margin-bottom: 8px;" id="resultado-emoji"></div>
                                <h4 style="margin-bottom: 4px;" id="resultado-nivel"></h4>
                                <p style="font-size: 16px; margin-bottom: 4px;" id="resultado-tempo"></p>
                                <p style="color: var(--text-light); font-size: 14px;" id="resultado-descricao"></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- OUTROS PROTOCOLOS (FUTURO) -->
                    <div style="padding: 20px; background: var(--bg); border-radius: 8px; border: 1px dashed #ddd;">
                        <h4 style="margin-bottom: 16px; color: var(--text-light);">ğŸ“‹ Outros Protocolos</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 12px;">
                            <div style="padding: 16px; background: white; border-radius: 6px; border: 1px solid var(--border); opacity: 0.6;">
                                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ§ </div>
                                <div style="font-weight: bold;">Protocolo AVC</div>
                                <small style="color: var(--text-light);">FAST test, tempo porta-agulha</small>
                            </div>
                            <div style="padding: 16px; background: white; border-radius: 6px; border: 1px solid var(--border); opacity: 0.6;">
                                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ¦ </div>
                                <div style="font-weight: bold;">Protocolo Sepse</div>
                                <small style="color: var(--text-light);">CritÃ©rios SOFA, bundles 1h e 3h</small>
                            </div>
                            <div style="padding: 16px; background: white; border-radius: 6px; border: 1px solid var(--border); opacity: 0.6;">
                                <div style="font-size: 24px; margin-bottom: 8px;">â¤ï¸</div>
                                <div style="font-weight: bold;">Protocolo IAM</div>
                                <small style="color: var(--text-light);">Infarto agudo do miocÃ¡rdio</small>
                            </div>
                            <div style="padding: 16px; background: white; border-radius: 6px; border: 1px solid var(--border); opacity: 0.6;">
                                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ«</div>
                                <div style="font-weight: bold;">Protocolo TEP</div>
                                <small style="color: var(--text-light);">Tromboembolismo pulmonar</small>
                            </div>
                            <div style="padding: 16px; background: white; border-radius: 6px; border: 1px solid var(--border); opacity: 0.6;">
                                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ©º</div>
                                <div style="font-weight: bold;">Protocolo Trauma</div>
                                <small style="color: var(--text-light);">ATLS, avaliaÃ§Ã£o primÃ¡ria e secundÃ¡ria</small>
                            </div>
                            <div style="padding: 16px; background: white; border-radius: 6px; border: 1px solid var(--border); opacity: 0.6;">
                                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ’Š</div>
                                <div style="font-weight: bold;">Protocolos de MedicaÃ§Ã£o</div>
                                <small style="color: var(--text-light);">Doses pediÃ¡tricas, diluiÃ§Ã£o</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ABA MAPA DAS UNIDADES (mantÃ©m como estÃ¡) -->
                <div id="gestao-aba-permissoes" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ” PermissÃµes e ConfiguraÃ§Ãµes</h3>
                    
                    <!-- SISTEMA DE PERMISSÃ•ES -->
                    <div style="margin-bottom: 32px; padding: 20px; background: var(--bg); border-radius: 8px; border: 1px solid #e0e0e0;">
                        <h4 style="margin-bottom: 16px; color: var(--primary);">ğŸ” PermissÃµes de Acesso ao ProntuÃ¡rio</h4>
                        <p style="color: var(--text-light); margin-bottom: 16px; font-size: 14px;">
                            Selecione quais categorias profissionais podem acessar e editar prontuÃ¡rios mÃ©dicos:
                        </p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 12px;">
                            <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                                <input type="checkbox" id="perm-medico" value="medico" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                                <span>ğŸ‘¨â€âš•ï¸ MÃ©dico(a)</span>
                            </label>
                            
                            <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                                <input type="checkbox" id="perm-enfermeiro" value="enfermeiro" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                                <span>ğŸ‘©â€âš•ï¸ Enfermeiro(a)</span>
                            </label>
                            
                            <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                                <input type="checkbox" id="perm-assistente_social" value="assistente_social" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                                <span>ğŸ¤ Assistente Social</span>
                            </label>
                            
                            <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                                <input type="checkbox" id="perm-fisioterapeuta" value="fisioterapeuta" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                                <span>ğŸƒ Fisioterapeuta</span>
                            </label>
                            
                            <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                                <input type="checkbox" id="perm-psicologo" value="psicologo" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                                <span>ğŸ§  PsicÃ³logo(a)</span>
                            </label>
                            
                            <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                                <input type="checkbox" id="perm-nutricionista" value="nutricionista" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                                <span>ğŸ¥— Nutricionista</span>
                            </label>
                            
                            <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                                <input type="checkbox" id="perm-farmaceutico" value="farmaceutico" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                                <span>ğŸ’Š FarmacÃªutico(a)</span>
                            </label>
                            
                            <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                                <input type="checkbox" id="perm-administrativo" value="administrativo" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                                <span>ğŸ“‹ Administrativo</span>
                            </label>
                            
                            <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                                <input type="checkbox" id="perm-recepcionista" value="recepcionista" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                                <span>ğŸ§ Recepcionista</span>
                            </label>
                        </div>
                        
                        <div style="margin-top: 16px; padding: 12px; background: #f9fafb; border-radius: 6px; border: 1px solid #fbbf24;">
                            <p style="font-size: 13px; color: #92400e; margin: 0;">
                                âš ï¸ <strong>Importante:</strong> Administradores sempre tÃªm acesso completo, independente desta configuraÃ§Ã£o.
                            </p>
                        </div>
                    </div>

                    <!-- GERENCIAR DADOS -->
                    <div style="margin-bottom: 32px;">
                        <h4 style="margin-bottom: 16px;">ğŸ“¦ Gerenciar Dados</h4>
                        <div style="display: grid; gap: 16px;">
                            <button class="btn btn-success" onclick="Sistema.exportarDados()">
                                ğŸ“¥ Exportar Todos os Dados (JSON)
                            </button>
                            <button class="btn btn-warning" onclick="Sistema.importarDados()">
                                ğŸ“¤ Importar Dados (JSON)
                            </button>
                            <button class="btn btn-danger" onclick="Sistema.resetarDadosTeste()">
                                ğŸ”„ Resetar Dados de Teste
                            </button>
                            <button class="btn btn-danger" onclick="Sistema.limparDados()" style="background: #7f1d1d; border-color: #7f1d1d;">
                                âš ï¸ RESETAR TUDO (Volta ao Zero Total)
                            </button>
                        </div>
                        <div style="margin-top: 12px; padding: 12px; background: #fee2e2; border-radius: 6px; border: 1px solid #ef4444;">
                            <p style="font-size: 13px; color: #991b1b; margin: 0;">
                                âš ï¸ <strong>AtenÃ§Ã£o:</strong><br>
                                â€¢ <strong>"Resetar Dados de Teste"</strong> - MantÃ©m o Estabelecimento configurado. Limpa: repartiÃ§Ãµes, profissionais, pacientes, agendamentos, atendimentos, prontuÃ¡rios e SAME.<br><br>
                                â€¢ <strong>"Limpar TODOS os Dados"</strong> - Apaga ABSOLUTAMENTE TUDO, incluindo Estabelecimento e configuraÃ§Ãµes. O sistema volta ao estado inicial.
                            </p>
                        </div>
                    </div>

                    <!-- FERRAMENTAS DE MANUTENÃ‡ÃƒO -->
                    <div style="margin-bottom: 32px;">
                        <h4 style="margin-bottom: 16px;">ğŸ”§ Ferramentas de ManutenÃ§Ã£o</h4>
                        <p style="color: var(--text-light); margin-bottom: 16px;">
                            Diagnosticar e corrigir problemas no sistema
                        </p>
                        
                        <!-- LEITOS FANTASMAS -->
                        <div style="margin-bottom: 24px;">
                            <h5 style="margin-bottom: 12px;">ğŸ›ï¸ Leitos Fantasmas</h5>
                            <div style="display: grid; gap: 12px;">
                                <button class="btn btn-warning" onclick="Sistema.diagnosticarLeitos()">
                                    ğŸ” Diagnosticar Leitos Fantasmas
                                </button>
                                <button class="btn btn-danger" onclick="Sistema.limparLeitosFantasmas()">
                                    ğŸ§¹ Limpar Leitos Fantasmas
                                </button>
                            </div>
                            <div id="diagnostico-resultado" style="margin-top: 16px; padding: 16px; background: #f8fafc; border-radius: 8px; display: none;"></div>
                            <div style="margin-top: 12px; padding: 12px; background: #dbeafe; border-radius: 6px; border: 1px solid #3b82f6;">
                                <p style="font-size: 13px; color: #1e40af; margin: 0;">
                                    â„¹ï¸ <strong>O que sÃ£o Leitos Fantasmas?</strong><br>
                                    Leitos que ficam marcados como "ocupados" mas nÃ£o tÃªm paciente associado.
                                </p>
                            </div>
                        </div>
                        
                        <!-- PROFISSIONAIS COM REPARTIÃ‡Ã•ES FANTASMAS -->
                        <div style="margin-bottom: 24px;">
                            <h5 style="margin-bottom: 12px;">ğŸ‘¤ Profissionais com RepartiÃ§Ãµes Fantasmas</h5>
                            <div style="display: grid; gap: 12px;">
                                <button class="btn btn-warning" onclick="Sistema.diagnosticarProfissionais()">
                                    ğŸ” Diagnosticar Profissionais
                                </button>
                                <button class="btn btn-danger" onclick="Sistema.limparReparticoesFantasmas()">
                                    ğŸ§¹ Limpar RepartiÃ§Ãµes Fantasmas
                                </button>
                            </div>
                            <div id="diagnostico-profissionais-resultado" style="margin-top: 16px; padding: 16px; background: #f8fafc; border-radius: 8px; display: none;"></div>
                            <div style="margin-top: 12px; padding: 12px; background: #f9fafb; border-radius: 6px; border: 1px solid #f59e0b;">
                                <p style="font-size: 13px; color: #92400e; margin: 0;">
                                    â„¹ï¸ <strong>O que sÃ£o?</strong> Profissionais com vÃ­nculos a repartiÃ§Ãµes deletadas.
                                </p>
                            </div>
                        </div>
                        
                        <!-- SINCRONIZAR ESPECIALIDADES -->
                        <div style="margin-bottom: 24px;">
                            <h5 style="margin-bottom: 12px;">ğŸ”„ Sincronizar Especialidades</h5>
                            <div style="display: grid; gap: 12px;">
                                <button class="btn btn-success" onclick="Sistema.sincronizarEspecialidadesLeitos()">
                                    ğŸ”„ Sincronizar Especialidades Grupos â†’ Leitos
                                </button>
                            </div>
                            <div id="diagnostico-sincronizacao-resultado" style="margin-top: 16px; padding: 16px; background: #f8fafc; border-radius: 8px; display: none;"></div>
                            <div style="margin-top: 12px; padding: 12px; background: #f9fafb; border-radius: 6px; border: 1px solid #22c55e;">
                                <p style="font-size: 13px; color: #166534; margin: 0;">
                                    â„¹ï¸ Copia configuraÃ§Ãµes de especialidades do grupo para todos os leitos individuais.
                                </p>
                            </div>
                        </div>
                        
                        <!-- ğŸ”´ FASE 1 - LIMPAR DUPLICATAS -->
                        <div style="margin-bottom: 24px;">
                            <h5 style="margin-bottom: 12px;">ğŸ—‘ï¸ Limpar Duplicatas</h5>
                            <div style="display: grid; gap: 12px;">
                                <button class="btn btn-danger" onclick="Sistema.limparDuplicatas()">
                                    ğŸ§¹ Remover Pacientes e Profissionais Duplicados
                                </button>
                            </div>
                            <div style="margin-top: 12px; padding: 12px; background: #fee2e2; border-radius: 6px; border: 1px solid #ef4444;">
                                <p style="font-size: 13px; color: #991b1b; margin: 0;">
                                    âš ï¸ <strong>O que faz?</strong> Remove pacientes com CPF duplicado e profissionais com CRM/COREN duplicado.<br>
                                    <strong>Regra:</strong> MantÃ©m sempre o registro mais recente (maior ID).
                                </p>
                            </div>
                        </div>
                        
                        <!-- v10.463: LIMPEZA DE PACIENTES -->
                        <div style="margin-bottom: 24px;">
                            <h5 style="margin-bottom: 12px;">ğŸ‘¥ Limpeza de Pacientes</h5>
                            <div style="display: grid; gap: 12px;">
                                <button class="btn btn-info" onclick="Sistema.diagnosticarPacientes()">
                                    ğŸ” Diagnosticar Pacientes
                                </button>
                                <button class="btn btn-warning" onclick="Sistema.corrigirProntuarios()">
                                    ğŸ”§ Corrigir ProntuÃ¡rios PRE- â†’ Definitivo
                                </button>
                                <button class="btn btn-danger" onclick="Sistema.limparNaoIdentificados()">
                                    ğŸ—‘ï¸ Remover "NÃ£o Identificados" sem atendimento
                                </button>
                                <button class="btn btn-danger" onclick="Sistema.limparPreCadastrosAntigos()">
                                    ğŸ—‘ï¸ Remover PrÃ©-Cadastros sem agendamento
                                </button>
                            </div>
                            <div style="margin-top: 12px; padding: 12px; background: #fef9c3; border-radius: 6px; border: 1px solid #eab308;">
                                <p style="font-size: 13px; color: #854d0e; margin: 0;">
                                    â„¹ï¸ <strong>Dicas:</strong><br>
                                    â€¢ <strong>"Diagnosticar"</strong> - Mostra estatÃ­sticas dos pacientes<br>
                                    â€¢ <strong>"Corrigir ProntuÃ¡rios"</strong> - Converte PRE- para prontuÃ¡rio definitivo se cadastro completo<br>
                                    â€¢ <strong>"NÃ£o Identificados"</strong> - Remove pacientes NI sem histÃ³rico<br>
                                    â€¢ <strong>"PrÃ©-Cadastros"</strong> - Remove PRE- sem agendamento ativo
                                </p>
                            </div>
                        </div>
                        
                        <!-- v10.463: FILA DE ATENDIMENTOS -->
                        <div style="margin-bottom: 24px;">
                            <h5 style="margin-bottom: 12px;">ğŸ©º Fila de Atendimentos</h5>
                            <div style="display: grid; gap: 12px;">
                                <button class="btn btn-info" onclick="Atendimentos.diagnosticar()">
                                    ğŸ” Diagnosticar Atendimentos
                                </button>
                                <button class="btn btn-warning" onclick="Atendimentos.removerDuplicatas()">
                                    ğŸ§¹ Remover Duplicatas da Fila
                                </button>
                                <button class="btn btn-danger" onclick="Atendimentos.resetarTudo()">
                                    ğŸ—‘ï¸ Reset Fila/Entradas
                                </button>
                            </div>
                            <div style="margin-top: 12px; padding: 12px; background: #fef2f2; border-radius: 6px; border: 1px solid #ef4444;">
                                <p style="font-size: 13px; color: #991b1b; margin: 0;">
                                    âš ï¸ <strong>AtenÃ§Ã£o:</strong><br>
                                    â€¢ <strong>"Diagnosticar"</strong> - Mostra estatÃ­sticas da fila, entradas e atendimentos<br>
                                    â€¢ <strong>"Remover Duplicatas"</strong> - Remove entradas duplicadas (mesmo agendamento)<br>
                                    â€¢ <strong>"Reset Fila"</strong> - Limpa TODAS as entradas e reseta status dos agendamentos
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- INFORMAÃ‡Ã•ES DO SISTEMA -->
                    <div style="margin-top: 24px; padding: 16px; background: var(--bg); border-radius: 8px;">
                        <h4>â„¹ï¸ InformaÃ§Ãµes do Sistema</h4>
                        <p style="margin-top: 8px;"><strong>VersÃ£o:</strong> 10.455 - RefatoraÃ§Ã£o Atendimentos</p>
                        <p><strong>Data:</strong> 30/11/2025</p>
                        <p><strong>Desenvolvido para:</strong> Estabelecimentos de SaÃºde (Sistema GenÃ©rico)</p>
                    </div>
                </div>

                <!-- ABA EDITOR DE ATLAS -->
                <div id="gestao-aba-editor-atlas" class="sub-tab-content">
                    <h3 style="margin-bottom: 16px;">ğŸ¨ Editor de Atlas AnatÃ´mico</h3>
                    
                    <div class="alert alert-info" style="margin-bottom: 20px;">
                        <span style="font-size: 20px;">â„¹ï¸</span>
                        <div>
                            <strong>Ferramenta de Ajustes Finos</strong><br>
                            <small>Ajuste manualmente as coordenadas dos polÃ­gonos dos Atlas para perfeito alinhamento com a silhueta.</small>
                        </div>
                    </div>

                    <!-- SELETOR DE ATLAS -->
                    <div style="margin-bottom: 20px; padding: 16px; background: white; border-radius: 8px; border: 1px solid var(--border);">
                        <label class="form-label">Selecione o Atlas:</label>
                        <select id="editor-atlas-tipo" class="form-control" onchange="EditorAtlas.trocarAtlas()">
                            <option value="anatomico">ğŸ“– Atlas AnatÃ´mico (124 regiÃµes)</option>
                            <option value="queimados">ğŸ”¥ Queimaduras - Regra dos 9 (13 regiÃµes)</option>
                            <option value="lundBrowder">ğŸ”¥ Queimaduras - Lund-Browder (32 regiÃµes)</option>
                        </select>
                    </div>

                    <!-- SELETOR DE REGIÃƒO -->
                    <div style="margin-bottom: 20px; padding: 16px; background: white; border-radius: 8px; border: 1px solid var(--border);">
                        <label class="form-label">Selecione a RegiÃ£o para Editar:</label>
                        <select id="editor-atlas-regiao" class="form-control" onchange="EditorAtlas.carregarRegiao()">
                            <option value="">-- Escolha uma regiÃ£o --</option>
                        </select>
                    </div>

                    <!-- EDITOR VISUAL -->
                    <div style="display: grid; grid-template-columns: 1fr auto; gap: 20px;">
                        
                        <!-- CANVAS DE EDIÃ‡ÃƒO -->
                        <div style="background: white; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0;">
                            <div style="text-align: center; margin-bottom: 12px;">
                                <h5 style="margin: 0; color: var(--primary);">Canvas de EdiÃ§Ã£o</h5>
                                <small style="color: var(--text-light);">Arraste os pontos para ajustar</small>
                            </div>
                            
                            <!-- CONTROLES DE ZOOM -->
                            <div style="display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: #f3f4f6; border-radius: 6px;">
                                <button class="btn btn-secondary" onclick="EditorAtlas.zoom(-0.2)" style="padding: 8px 16px; font-size: 18px; font-weight: bold;">
                                    â–
                                </button>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="font-size: 12px; color: #666; font-weight: 600;">ğŸ” Zoom:</span>
                                    <input type="range" id="editor-atlas-zoom-slider" min="1" max="5" step="0.1" value="1" 
                                           oninput="EditorAtlas.setZoom(parseFloat(this.value))"
                                           style="width: 150px;">
                                    <span id="editor-atlas-zoom-valor" style="font-size: 13px; font-weight: bold; color: var(--primary); min-width: 45px;">100%</span>
                                </div>
                                <button class="btn btn-secondary" onclick="EditorAtlas.zoom(0.2)" style="padding: 8px 16px; font-size: 18px; font-weight: bold;">
                                    â•
                                </button>
                                <button class="btn btn-secondary" onclick="EditorAtlas.resetZoom()" style="padding: 8px 16px; font-size: 12px;">
                                    ğŸ”„ Reset
                                </button>
                                <div style="margin-left: 12px; padding: 6px 10px; background: #dbeafe; border-radius: 4px; font-size: 11px; color: #1e40af;">
                                    ğŸ’¡ Arraste para mover
                                </div>
                            </div>
                            
                            <div id="editor-atlas-container" style="position: relative; width: 100%; max-width: 700px; margin: 0 auto; border: 1px solid #ccc; background: #f9fafb; overflow: hidden; cursor: grab;">
                                <svg id="editor-atlas-svg" viewBox="0 290 700 620" style="width: 100%; display: block;">
                                    <!-- SILHUETA DE FUNDO -->
                                    <image href="#" id="editor-atlas-silhueta" width="700" height="1200" opacity="0.3" />
                                    
                                    <!-- POLÃGONO ATUAL (serÃ¡ inserido via JS) -->
                                    <g id="editor-atlas-poligono-group"></g>
                                    
                                    <!-- PONTOS EDITÃVEIS (serÃ£o inseridos via JS) -->
                                    <g id="editor-atlas-pontos-group"></g>
                                </svg>
                                
                                <!-- ğŸ¨ CANVAS DE PINTURA PARA TESTAR ALINHAMENTO -->
                                <canvas id="editor-atlas-canvas" 
                                        width="700" height="620"
                                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; cursor: crosshair; display: none; z-index: 1;">
                                </canvas>
                            </div>
                            
                            <!-- ğŸ¨ CONTROLES DE PINTURA -->
                            <div id="editor-atlas-paint-controls" style="margin-top: 16px; padding: 12px; background: white; border-radius: 8px; border: 1px solid var(--border); display: none;">
                                <div style="display: flex; gap: 12px; align-items: center; justify-content: center; flex-wrap: wrap;">
                                    <label style="display: flex; align-items: center; gap: 6px;">
                                        <span style="font-size: 13px; font-weight: 500;">Grau:</span>
                                        <select id="editor-atlas-grau" class="form-control" style="width: 100px;">
                                            <option value="2">2Âº Grau</option>
                                            <option value="3">3Âº Grau</option>
                                        </select>
                                    </label>
                                    
                                    <label style="display: flex; align-items: center; gap: 6px;">
                                        <span style="font-size: 13px; font-weight: 500;">Pincel:</span>
                                        <input type="range" id="editor-atlas-brush" min="5" max="30" value="10" style="width: 100px;">
                                        <span id="editor-atlas-brush-value" style="font-size: 12px; min-width: 30px;">10px</span>
                                    </label>
                                    
                                    <button class="btn btn-secondary" onclick="EditorAtlas.toggleCanvas()" style="padding: 6px 12px;">
                                        <span id="editor-atlas-canvas-toggle-text">ğŸ¨ Esconder Canvas</span>
                                    </button>
                                    
                                    <button class="btn btn-secondary" onclick="EditorAtlas.limparCanvas()" style="padding: 6px 12px;">
                                        ğŸ—‘ï¸ Limpar Pintura
                                    </button>
                                </div>
                            </div>

                            <div style="margin-top: 16px; display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                                <button class="btn btn-secondary" onclick="EditorAtlas.toggleCanvas()">
                                    ğŸ¨ Testar Pintura
                                </button>
                                <button class="btn btn-primary" onclick="EditorAtlas.adicionarPontoIntermediario()">
                                    â• Adicionar Ponto
                                </button>
                                <button class="btn btn-secondary" onclick="EditorAtlas.resetar()">
                                    ğŸ”„ Resetar RegiÃ£o
                                </button>
                                <button class="btn btn-warning" onclick="EditorAtlas.repararTodasRegioes()" style="width: 100%;">
                                    ğŸ”§ Reparar RegiÃµes (Restaurar %)
                                </button>
                                <button class="btn btn-success" onclick="EditorAtlas.salvar()">
                                    ğŸ’¾ Salvar AlteraÃ§Ãµes
                                </button>
                            </div>
                        </div>

                        <!-- PAINEL DE COORDENADAS -->
                        <div style="width: 300px; background: white; padding: 16px; border-radius: 8px; border: 1px solid var(--border);">
                            <h5 style="margin-bottom: 12px; color: var(--primary);">ğŸ“Š Coordenadas</h5>
                            
                            <div id="editor-atlas-coords" style="max-height: 600px; overflow-y: auto;">
                                <p style="color: var(--text-light); font-size: 13px; text-align: center; padding: 40px 20px;">
                                    Selecione uma regiÃ£o para ver as coordenadas
                                </p>
                            </div>

                            <div style="margin-top: 16px; padding: 12px; background: #f9fafb; border-radius: 6px; border: 1px solid #fbbf24;">
                                <p style="font-size: 12px; color: #92400e; margin: 0;">
                                    ğŸ’¡ <strong>Dica:</strong> Arraste os cÃ­rculos vermelhos para ajustar os pontos do polÃ­gono.
                                </p>
                            </div>
                        </div>

                    </div>

                    <!-- INSTRUÃ‡Ã•ES -->
                    <div style="margin-top: 24px; padding: 16px; background: var(--bg); border-radius: 8px;">
                        <h4 style="margin-bottom: 12px;">ğŸ“ Como Usar</h4>
                        <ol style="margin: 0; padding-left: 20px; line-height: 1.8;">
                            <li>Selecione uma regiÃ£o anatÃ´mica no menu acima</li>
                            <li>Visualize o polÃ­gono atual sobre a silhueta</li>
                            <li>Arraste os pontos vermelhos para ajustar o alinhamento</li>
                            <li><strong>â• NOVO:</strong> Use "Adicionar Ponto" para inserir pontos intermediÃ¡rios entre todos os pontos existentes</li>
                            <li><strong>ğŸ¨ NOVO:</strong> Clique em "Testar Pintura" para ativar o canvas e testar o alinhamento</li>
                            <li>Pinte dentro da regiÃ£o para verificar se os polÃ­gonos estÃ£o alinhados corretamente</li>
                            <li>As coordenadas sÃ£o atualizadas em tempo real no painel lateral</li>
                            <li>Clique em "Salvar AlteraÃ§Ãµes" para aplicar os ajustes</li>
                            <li>Use "Resetar RegiÃ£o" para desfazer alteraÃ§Ãµes nÃ£o salvas</li>
                        </ol>
                        <div style="margin-top: 12px; padding: 12px; background: #dbeafe; border-radius: 6px; border: 1px solid #3b82f6;">
                            <p style="font-size: 12px; color: #1e40af; margin: 0;">
                                ğŸ’¡ <strong>Dica:</strong> O botÃ£o "Adicionar Ponto" dobra o nÃºmero de pontos, inserindo um ponto no meio de cada segmento. Use mÃºltiplas vezes para criar polÃ­gonos ainda mais detalhados!
                            </p>
                        </div>
                    </div>
                    
                    <!-- GERENCIAMENTO DOS ATLAS -->
                    <div style="margin-top: 24px; padding: 16px; background: var(--bg); border-radius: 8px; border: 2px solid #f59e0b;">
                        <h4 style="margin-bottom: 12px; color: #f59e0b;">âš™ï¸ Gerenciamento dos Atlas</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <button class="btn btn-warning" onclick="EditorAtlas.exportarAtlas()">
                                ğŸ“¥ Fazer Backup dos Atlas
                            </button>
                            <button class="btn btn-danger" onclick="EditorAtlas.restaurarPadrao()">
                                ğŸ”„ Restaurar VersÃµes PadrÃ£o
                            </button>
                        </div>
                        <div style="margin-top: 12px; padding: 12px; background: white; border-radius: 6px; font-size: 12px; color: #666;">
                            <strong>ğŸ’¾ Backup:</strong> Salva um arquivo JSON com todas as suas alteraÃ§Ãµes<br>
                            <strong>ğŸ”„ Restaurar:</strong> Remove alteraÃ§Ãµes e volta Ã s coordenadas originais
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ATENDIMENTOS -->
        <div id="tab-atendimentos" class="tab-content">
            <div class="card">
                <h2>ğŸ©º Atendimentos</h2>
                <p style="color: var(--text-light); margin-bottom: 16px;">
                    Registro de entrada de pacientes, classificaÃ§Ã£o de risco e gestÃ£o de atendimentos.
                </p>
                
                <!-- SUB-ABAS -->
                <div class="sub-tabs">
                    <button class="sub-tab-btn active" onclick="Atendimentos.trocarAba('recepcao')">
                        ğŸ¥ RecepÃ§Ã£o
                    </button>
                    <button class="sub-tab-btn" onclick="Atendimentos.trocarAba('triagem')">
                        ğŸš¨ Triagem
                    </button>
                    <button class="sub-tab-btn" onclick="Atendimentos.trocarAba('novo')">
                        â• Atendimento
                    </button>
                    <button class="sub-tab-btn" onclick="Atendimentos.trocarAba('hoje')">
                        ğŸ“‹ Hoje
                    </button>
                    <button class="sub-tab-btn" onclick="Atendimentos.trocarAba('historico')">
                        ğŸ“š HistÃ³rico
                    </button>
                </div>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- v10.450: SUB-ABAS REESCRITAS - FLUXO CENTRADO NO PACIENTE                  -->
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                
                <!-- SUB-ABA: RECEPÃ‡ÃƒO -->
                <div id="atend-recepcao" class="sub-tab-content active">
                    <div class="form-section">
                        <h3 style="margin-bottom: 16px; display: flex; align-items: center; gap: 10px;">
                            ğŸ¥ Registro de Entrada
                            <span style="font-size: 13px; font-weight: normal; color: #6b7280;">
                                Selecione o paciente primeiro
                            </span>
                        </h3>
                        
                        <!-- EMERGÃŠNCIA: NÃƒO IDENTIFICADO (primeiro!) -->
                        <div style="background: #fef2f2; padding: 16px; border-radius: 8px; border: 2px solid #dc2626; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span style="font-size: 32px;">ğŸš¨</span>
                                <div style="flex: 1;">
                                    <div style="font-weight: 700; color: #991b1b; font-size: 15px;">EmergÃªncia sem IdentificaÃ§Ã£o?</div>
                                    <div style="font-size: 12px; color: #7f1d1d;">Use quando paciente chega inconsciente ou sem documentos</div>
                                </div>
                                <button class="btn" onclick="Atendimentos.criarNaoIdentificado()" 
                                    style="background: #dc2626; color: white; padding: 12px 20px; font-weight: 600; white-space: nowrap;">
                                    âš ï¸ Criar NÃ£o Identificado
                                </button>
                            </div>
                        </div>
                        
                        <!-- PASSO 1: BUSCAR OU CADASTRAR PACIENTE -->
                        <div style="background: #f0f9ff; padding: 16px; border-radius: 8px; border-left: 4px solid #3b82f6; margin-bottom: 20px;">
                            <label style="font-weight: 600; display: block; margin-bottom: 8px;">
                                1ï¸âƒ£ Buscar Paciente <span style="color: #ef4444;">*</span>
                            </label>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <div style="flex: 1; position: relative;">
                                    <input type="text" id="rec-busca-paciente" class="form-control" 
                                           placeholder="Digite nome, CPF ou prontuÃ¡rio..." 
                                           oninput="Atendimentos.buscarPacienteRecepcao()"
                                           onfocus="Atendimentos.mostrarDropdownInicial()"
                                           autocomplete="off"
                                           style="font-size: 16px; padding: 12px;">
                                    <div id="rec-dropdown-pacientes" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #e5e7eb; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 100; max-height: 400px; overflow-y: auto;">
                                    </div>
                                </div>
                                <button class="btn btn-success" onclick="Atendimentos.novoPacienteRecepcao()" style="white-space: nowrap;">
                                    â• Cadastrar Novo
                                </button>
                            </div>
                            <input type="hidden" id="rec-paciente-id">
                        </div>
                        
                        <!-- PACIENTE SELECIONADO -->
                        <div id="rec-paciente-selecionado" style="display: none; background: #f0fdf4; padding: 16px; border-radius: 8px; border: 2px solid #10b981; margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-size: 18px; font-weight: 700; color: #166534;" id="rec-paciente-nome">Nome do Paciente</div>
                                    <div style="font-size: 13px; color: #15803d;" id="rec-paciente-info">ProntuÃ¡rio: 000001 | CPF: 000.000.000-00</div>
                                </div>
                                <button class="btn btn-secondary" onclick="Atendimentos.limparPacienteRecepcao()" style="padding: 6px 12px;">
                                    âœ• Trocar
                                </button>
                            </div>
                        </div>
                        
                        <!-- PASSO 2: TIPO DE ENTRADA (sÃ³ aparece apÃ³s selecionar paciente) -->
                        <div id="rec-dados-entrada" style="display: none;">
                            
                            <!-- v10.463: CARD DE AGENDAMENTO (aparece se tem agendamento hoje) -->
                            <div id="rec-agendamento-detectado" style="display: none; background: #dbeafe; padding: 16px; border-radius: 8px; border: 2px solid #3b82f6; margin-bottom: 20px;">
                                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                    <span style="font-size: 28px;">ğŸ“…</span>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 700; color: #1e40af; font-size: 16px;">AGENDAMENTO ENCONTRADO</div>
                                        <div id="rec-agendamento-info" style="font-size: 14px; color: #1e3a8a;"></div>
                                    </div>
                                </div>
                                <input type="hidden" id="rec-agendamento-id">
                                
                                <!-- v10.463: OpÃ§Ãµes de alterar sala e profissional -->
                                <div style="margin-bottom: 16px; padding: 12px; background: white; border-radius: 8px; display: grid; gap: 12px;">
                                    <!-- Profissional -->
                                    <div>
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <label style="font-weight: 600; color: #374151; white-space: nowrap; min-width: 100px;">ğŸ‘¨â€âš•ï¸ Profissional:</label>
                                            <select id="rec-agendamento-profissional" class="form-control" style="flex: 1;">
                                                <option value="">-- Manter do agendamento --</option>
                                            </select>
                                        </div>
                                        <small id="rec-profissional-original" style="display: block; margin-top: 6px; color: #6b7280; font-size: 12px; margin-left: 112px;"></small>
                                    </div>
                                    
                                    <!-- Sala/Local -->
                                    <div>
                                        <div style="display: flex; align-items: center; gap: 12px;">
                                            <label style="font-weight: 600; color: #374151; white-space: nowrap; min-width: 100px;">ğŸ“ Local:</label>
                                            <select id="rec-agendamento-sala" class="form-control" style="flex: 1;">
                                                <option value="">-- Manter do agendamento --</option>
                                            </select>
                                        </div>
                                        <small id="rec-sala-original" style="display: block; margin-top: 6px; color: #6b7280; font-size: 12px; margin-left: 112px;"></small>
                                    </div>
                                </div>
                                
                                <div style="display: flex; gap: 12px;">
                                    <button class="btn" onclick="Atendimentos.confirmarChegadaAgendamento()" 
                                        style="flex: 1; background: #16a34a; color: white; padding: 12px; font-weight: 600;">
                                        âœ… Confirmar Chegada
                                    </button>
                                    <button class="btn" onclick="Atendimentos.ignorarAgendamento()" 
                                        style="flex: 1; background: #6b7280; color: white; padding: 12px;">
                                        â¡ï¸ Ignorar e Continuar
                                    </button>
                                </div>
                            </div>
                            
                            <!-- v10.463: OPÃ‡Ã•ES PARA PACIENTE SEM AGENDAMENTO -->
                            <div id="rec-sem-agendamento" style="display: none;">
                                <div style="background: #fefce8; padding: 16px; border-radius: 8px; border-left: 4px solid #eab308; margin-bottom: 20px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 12px;">
                                        2ï¸âƒ£ Tipo de Entrada
                                    </label>
                                    <p style="font-size: 14px; color: #78350f; margin-bottom: 16px;">
                                        Este paciente nÃ£o tem agendamento para hoje. Selecione o tipo de entrada:
                                    </p>
                                    
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                        <!-- Demanda EspontÃ¢nea -->
                                        <div id="rec-opt-demanda" onclick="Atendimentos.selecionarTipoEntrada('demanda_espontanea')"
                                             style="padding: 20px; background: white; border: 2px solid #e5e7eb; border-radius: 12px; cursor: pointer; text-align: center; transition: all 0.2s;">
                                            <div style="font-size: 32px; margin-bottom: 8px;">ğŸ¥</div>
                                            <div style="font-weight: 700; color: #374151; font-size: 15px;">Demanda EspontÃ¢nea</div>
                                            <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">Atendimento comum, ordem de chegada</div>
                                        </div>
                                        
                                        <!-- Pronto Atendimento -->
                                        <div id="rec-opt-pa" onclick="Atendimentos.selecionarTipoEntrada('pronto_atendimento')"
                                             style="padding: 20px; background: white; border: 2px solid #e5e7eb; border-radius: 12px; cursor: pointer; text-align: center; transition: all 0.2s;">
                                            <div style="font-size: 32px; margin-bottom: 8px;">ğŸš¨</div>
                                            <div style="font-weight: 700; color: #374151; font-size: 15px;">Pronto Atendimento</div>
                                            <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">UrgÃªncia/EmergÃªncia - Triagem obrigatÃ³ria</div>
                                        </div>
                                    </div>
                                    
                                    <input type="hidden" id="rec-tipo-entrada" value="">
                                </div>
                                
                                <!-- v10.463: CAMPOS ADICIONAIS (aparecem apÃ³s selecionar tipo) -->
                                <div id="rec-campos-adicionais" style="display: none; background: #f9fafb; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                                        <div class="form-group" style="margin: 0;">
                                            <label>Data</label>
                                            <input type="date" id="rec-data-entrada" class="form-control">
                                        </div>
                                        <div class="form-group" style="margin: 0;">
                                            <label>Hora</label>
                                            <input type="time" id="rec-hora-entrada" class="form-control">
                                        </div>
                                        <div class="form-group" style="margin: 0;">
                                            <label>Tipo de Atendimento</label>
                                            <select id="rec-tipo-atendimento" class="form-control">
                                                <option value="Consulta">Consulta</option>
                                                <option value="Retorno">Retorno</option>
                                                <option value="Exame">Exame</option>
                                                <option value="Procedimento">Procedimento</option>
                                                <option value="Cirurgia">Cirurgia</option>
                                                <option value="InternaÃ§Ã£o">InternaÃ§Ã£o</option>
                                            </select>
                                        </div>
                                        <div class="form-group" style="margin: 0;">
                                            <label>ğŸ‘¨â€âš•ï¸ Profissional</label>
                                            <select id="rec-profissional-entrada" class="form-control">
                                                <option value="">-- NÃ£o definido --</option>
                                            </select>
                                        </div>
                                        <div class="form-group" style="margin: 0;">
                                            <label>ğŸ“ Local/Sala</label>
                                            <select id="rec-sala-entrada" class="form-control">
                                                <option value="">-- NÃ£o definido --</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <!-- Aviso de Triagem (sÃ³ para PA) -->
                                    <div id="rec-aviso-triagem" style="display: none; margin-top: 16px; padding: 12px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px;">
                                        <div style="display: flex; align-items: center; gap: 8px; color: #991b1b;">
                                            <span style="font-size: 18px;">âš ï¸</span>
                                            <span style="font-weight: 600;">Pronto Atendimento requer Triagem Manchester</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- BOTÃ•ES -->
                                <div id="rec-botoes-entrada" style="display: none; display: flex; gap: 12px; justify-content: flex-end;">
                                    <button class="btn btn-secondary" onclick="Atendimentos.limparPacienteRecepcao()">
                                        âŒ Cancelar
                                    </button>
                                    <button class="btn btn-success" onclick="Atendimentos.salvarEntradaNova()" style="padding: 12px 24px; font-weight: 600;">
                                        ğŸ’¾ Registrar Entrada
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SUB-ABA: TRIAGEM -->
                <div id="atend-triagem" class="sub-tab-content">
                    <div class="form-section">
                        <h3>ğŸš¨ Triagem</h3>
                        <p style="color: #6b7280; margin-bottom: 16px;">Pacientes aguardando triagem e classificaÃ§Ã£o de risco</p>
                        <div id="lista-triagem">
                            <p style="text-align: center; color: var(--text-light); padding: 40px;">Nenhum paciente aguardando triagem</p>
                        </div>
                    </div>
                </div>
                
                <!-- SUB-ABA: ATENDIMENTO (Nova + Hoje combinadas) -->
                <div id="atend-novo" class="sub-tab-content">
                    <div class="form-section">
                        <h3 style="margin-bottom: 16px;">â• Fila de Atendimento</h3>
                        <p style="color: #6b7280; margin-bottom: 20px;">
                            Pacientes aguardando atendimento. Clique para iniciar.
                        </p>
                        
                        <!-- FILA DE ATENDIMENTO -->
                        <div id="fila-atendimento">
                            <p style="text-align: center; color: var(--text-light); padding: 40px;">
                                Nenhum paciente na fila
                            </p>
                        </div>
                        
                        <!-- FORMULÃRIO DE ATENDIMENTO (aparece ao clicar em um paciente) -->
                        <div id="form-atendimento" style="display: none; margin-top: 24px; padding: 20px; background: #f0f9ff; border-radius: 8px; border: 2px solid #3b82f6;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 2px solid #3b82f6;">
                                <h4 style="margin: 0; color: #1e40af;">
                                    ğŸ©º Atendimento: <span id="form-atend-paciente-nome"></span>
                                </h4>
                                <button class="btn btn-secondary" onclick="Atendimentos.fecharFormAtendimento()">âœ• Fechar</button>
                            </div>
                            
                            <input type="hidden" id="atend-entrada-id">
                            
                            <!-- SeleÃ§Ã£o de Modelo -->
                            <div class="form-group">
                                <label>ğŸ“‹ Modelo de ProntuÃ¡rio <span style="color: #ef4444;">*</span></label>
                                <select id="atend-modelo-prontuario-novo" class="form-control" onchange="Atendimentos.carregarModulosProntuarioNovo(this.value)">
                                    <option value="">-- Selecione um modelo --</option>
                                </select>
                            </div>
                            
                            <!-- Nome do modelo (hidden, usado pela funÃ§Ã£o) -->
                            <div id="atend-modelo-nome-exibido-novo" style="display: none;"></div>
                            
                            <!-- Container dos MÃ³dulos -->
                            <div id="atend-modulos-container-novo" style="display: none; margin-top: 20px;">
                                <div id="atend-modulos-conteudo-novo"></div>
                            </div>
                            
                            <!-- BotÃ£o Salvar -->
                            <div style="margin-top: 20px; display: flex; gap: 12px; justify-content: flex-end;">
                                <button class="btn btn-secondary" onclick="Atendimentos.fecharFormAtendimento()">
                                    âŒ Cancelar
                                </button>
                                <button class="btn btn-success" onclick="Atendimentos.salvarAtendimento()" style="padding: 12px 24px; font-weight: 600;">
                                    âœ… Finalizar Atendimento
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- SUB-ABA: HOJE -->
                <div id="atend-hoje" class="sub-tab-content">
                    <div class="form-section">
                        <h3 style="margin-bottom: 16px;">ğŸ“‹ Atendimentos de Hoje</h3>
                        
                        <!-- Filtros simples -->
                        <div style="display: flex; gap: 12px; margin-bottom: 16px; flex-wrap: wrap;">
                            <select id="filtro-hoje-status" class="form-control" style="max-width: 200px;" onchange="Atendimentos.listarHoje()">
                                <option value="">Todos os Status</option>
                                <option value="aguardando_triagem">ğŸš¨ Aguard. Triagem</option>
                                <option value="aguardando_atendimento">â³ Aguard. Atendimento</option>
                                <option value="em_atendimento">ğŸ©º Em Atendimento</option>
                                <option value="atendido">âœ… Atendido</option>
                            </select>
                            <button class="btn btn-secondary" onclick="Atendimentos.listarHoje()">ğŸ”„ Atualizar</button>
                        </div>
                        
                        <!-- Lista -->
                        <div id="lista-hoje">
                            <p style="text-align: center; color: var(--text-light); padding: 40px;">Nenhum atendimento hoje</p>
                        </div>
                    </div>
                </div>
                
                <!-- SUB-ABA: HISTÃ“RICO -->
                <div id="atend-historico" class="sub-tab-content">
                    <div class="form-section">
                        <h3 style="margin-bottom: 16px;">ğŸ“š HistÃ³rico do Paciente</h3>
                        <p style="color: #6b7280; margin-bottom: 20px;">
                            Busque um paciente para ver todos os seus atendimentos
                        </p>
                        
                        <!-- Busca de Paciente -->
                        <div style="background: #f8fafc; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                            <label style="font-weight: 600; display: block; margin-bottom: 8px;">ğŸ” Buscar Paciente</label>
                            <div style="position: relative;">
                                <input type="text" id="hist-busca" class="form-control" 
                                       placeholder="Digite nome, CPF ou prontuÃ¡rio..."
                                       oninput="Atendimentos.buscarPacienteHistorico()"
                                       style="font-size: 16px; padding: 12px;">
                                <div id="hist-dropdown" style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #e5e7eb; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 100; max-height: 300px; overflow-y: auto;">
                                </div>
                            </div>
                            <input type="hidden" id="hist-paciente-id">
                        </div>
                        
                        <!-- Paciente Selecionado -->
                        <div id="hist-paciente-info" style="display: none; background: #eff6ff; padding: 16px; border-radius: 8px; margin-bottom: 20px; border: 2px solid #3b82f6;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-size: 18px; font-weight: 700; color: #1e40af;" id="hist-paciente-nome"></div>
                                    <div style="font-size: 13px; color: #3b82f6;" id="hist-paciente-dados"></div>
                                </div>
                                <div style="display: flex; gap: 8px;">
                                    <span id="hist-total-atendimentos" style="background: #3b82f6; color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px;">0 atendimentos</span>
                                    <button class="btn btn-secondary" onclick="Atendimentos.limparHistorico()" style="padding: 4px 12px;">âœ•</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Lista de Atendimentos -->
                        <div id="hist-lista">
                            <!-- SerÃ¡ preenchido por listarHistoricoGeral() -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PRONTUÃRIOS -->
        <div id="tab-prontuarios" class="tab-content">
            <div class="card">
                <h2>ğŸ“ GestÃ£o de ProntuÃ¡rios</h2>
                <p style="color: var(--text-light); margin-bottom: 20px;">
                    Consulta, revisÃ£o e auditoria de prontuÃ¡rios eletrÃ´nicos. Busque por paciente, profissional ou perÃ­odo.
                </p>

                <!-- ESTATÃSTICAS -->
                <div class="stats-grid" style="margin-bottom: 24px;">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-total-prontuarios">0</div>
                        <div class="stat-label">Total de ProntuÃ¡rios</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-prontuarios-mes">0</div>
                        <div class="stat-label">Este MÃªs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-prontuarios-semana">0</div>
                        <div class="stat-label">Esta Semana</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-prontuarios-hoje">0</div>
                        <div class="stat-label">Hoje</div>
                    </div>
                </div>

                <!-- FILTROS -->
                <div class="form-grid" style="margin-bottom: 20px;">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label class="form-label">Buscar Paciente</label>
                        <input type="text" id="filtro-busca-prontuario" class="form-control" placeholder="Digite o nome do paciente..." oninput="Prontuarios.listar()">
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label class="form-label">Profissional</label>
                        <select id="filtro-profissional-prontuario" class="form-control" onchange="Prontuarios.listar()">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label class="form-label">Data Inicial</label>
                        <input type="date" id="filtro-data-inicial-prontuario" class="form-control" onchange="Prontuarios.listar()">
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label class="form-label">Data Final</label>
                        <input type="date" id="filtro-data-final-prontuario" class="form-control" onchange="Prontuarios.listar()">
                    </div>
                </div>

                <!-- LISTA DE PRONTUÃRIOS -->
                <div id="listaProntuarios"></div>
            </div>
        </div>

        <!-- HISTÃ“RICO -->
        <!-- SAME (ServiÃ§o de Arquivo MÃ©dico e EstatÃ­stica) -->
        <div id="tab-same" class="tab-content">
            <div class="card">
                <h2>ğŸ—„ï¸ SAME - ServiÃ§o de Arquivo MÃ©dico e EstatÃ­stica</h2>
                <p style="color: var(--text-light); margin-bottom: 20px;">
                    HistÃ³rico de pacientes com alta hospitalar. Quando um paciente recebe alta de uma internaÃ§Ã£o, 
                    seu registro Ã© arquivado automaticamente no SAME para fins estatÃ­sticos e histÃ³ricos.
                </p>
                
                <div style="background: #f9fafb; padding: 16px; border-radius: 8px; border: 1px solid #3b82f6; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 8px 0; color: #1e40af;">ğŸ“Š EstatÃ­sticas SAME</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-top: 12px;">
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <div style="font-size: 24px; font-weight: bold; color: #3b82f6;" id="same-total">0</div>
                            <div style="font-size: 13px; color: #64748b;">Total de Altas</div>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <div style="font-size: 24px; font-weight: bold; color: #10b981;" id="same-altas-mes">0</div>
                            <div style="font-size: 13px; color: #64748b;">Altas este MÃªs</div>
                        </div>
                        <div style="background: white; padding: 12px; border-radius: 6px;">
                            <div style="font-size: 24px; font-weight: bold; color: #8b5cf6;" id="same-tempo-medio">0</div>
                            <div style="font-size: 13px; color: #64748b;">Dias MÃ©dios de InternaÃ§Ã£o</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Filtrar por PerÃ­odo</label>
                    <div class="grid-2">
                        <input type="date" class="form-control" id="same-data-inicio" onchange="SAME.listar()">
                        <input type="date" class="form-control" id="same-data-fim" onchange="SAME.listar()">
                    </div>
                </div>

                <div class="form-group">
                    <label>Filtrar por Tipo de Alta</label>
                    <select class="form-control" id="same-tipo-alta" onchange="SAME.listar()">
                        <option value="">Todos os tipos</option>
                        <option value="clinica">Alta ClÃ­nica (Cura)</option>
                        <option value="a_pedido">Alta a Pedido</option>
                        <option value="transferencia">TransferÃªncia</option>
                        <option value="evasao">EvasÃ£o</option>
                        <option value="obito">Ã“bito</option>
                    </select>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h3 style="margin: 0;">ğŸ“‹ Registros de Alta</h3>
                    <button class="btn btn-success" onclick="SAME.exportarCSV()">ğŸ“¥ Exportar CSV</button>
                </div>

                <div id="listaSAME"></div>
            </div>
        </div>

        <!-- COLETA DE DADOS -->
        <div id="tab-dados" class="tab-content">
            <div class="card">
                <h2>ğŸ“‹ Sistema de Dados</h2>
                <p style="color: var(--text-light); margin-bottom: 16px;">
                    Configure campos personalizados para coletar informaÃ§Ãµes. Pode ser usado de forma independente ou integrado ao prontuÃ¡rio.
                </p>

                <div class="coleta-container">
                    <!-- CAMPOS CONFIGURADOS -->
                    <div>
                        <h3 style="margin-bottom: 12px;">Campos Configurados</h3>
                        <button class="btn btn-primary" onclick="ColetaDados.abrirModalCampo()" style="margin-bottom: 16px;">
                            â• Novo Campo
                        </button>
                        <div id="listaCamposColeta"></div>
                    </div>

                    <!-- FORMULÃRIO DE COLETA -->
                    <div>
                        <h3 style="margin-bottom: 12px;">FormulÃ¡rio de Coleta</h3>
                        <div id="formularioColeta" style="background: var(--bg); padding: 16px; border-radius: 8px;">
                            <p style="color: var(--text-light);">Configure os campos ao lado para comeÃ§ar a coletar dados.</p>
                        </div>
                        <button class="btn btn-success" onclick="ColetaDados.salvarDados()" style="margin-top: 16px; width: 100%;" id="btnSalvarColeta" disabled>
                            ğŸ’¾ Salvar Dados
                        </button>
                    </div>
                </div>

                <!-- DADOS COLETADOS -->
                <div style="margin-top: 32px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3>Dados Coletados</h3>
                        <button class="btn btn-success" onclick="ColetaDados.exportarCSV()">ğŸ“¥ Exportar CSV</button>
                    </div>
                    <div id="listaDadosColetados"></div>
                </div>
            </div>
        </div>

        <!-- RELATÃ“RIOS -->
        <div id="tab-relatorios" class="tab-content">
            <div class="card">
                <h2>ğŸ“Š RelatÃ³rios</h2>
                <p style="color: var(--text-light); margin-bottom: 16px;">
                    Gere relatÃ³rios e anÃ¡lises sobre atendimentos, agendamentos, profissionais e outros dados do sistema.
                </p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; margin-top: 24px;">
                    <div class="card" style="cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
                        <h3>ğŸ“… RelatÃ³rio de Agendamentos</h3>
                        <p style="color: var(--text-light); font-size: 14px;">Visualize agendamentos por perÃ­odo, profissional ou unidade</p>
                        <button class="btn btn-primary" style="margin-top: 12px;" disabled>Em desenvolvimento</button>
                    </div>
                    
                    <div class="card" style="cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
                        <h3>ğŸ©º RelatÃ³rio de Atendimentos</h3>
                        <p style="color: var(--text-light); font-size: 14px;">AnÃ¡lise de atendimentos realizados e estatÃ­sticas</p>
                        <button class="btn btn-primary" style="margin-top: 12px;" disabled>Em desenvolvimento</button>
                    </div>
                    
                    <div class="card" style="cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
                        <h3>ğŸ‘¨â€âš•ï¸ RelatÃ³rio de Profissionais</h3>
                        <p style="color: var(--text-light); font-size: 14px;">EstatÃ­sticas de produtividade e disponibilidade</p>
                        <button class="btn btn-primary" style="margin-top: 12px;" disabled>Em desenvolvimento</button>
                    </div>
                    
                    <div class="card" style="cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
                        <h3>ğŸ‘¥ RelatÃ³rio de Pacientes</h3>
                        <p style="color: var(--text-light); font-size: 14px;">Dados demogrÃ¡ficos e histÃ³rico de atendimentos</p>
                        <button class="btn btn-primary" style="margin-top: 12px;" disabled>Em desenvolvimento</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- AÃ‡Ã•ES -->
        <div id="tab-acoes" class="tab-content">
            <div class="card">
                <h2>âš¡ AÃ§Ãµes RÃ¡pidas</h2>
                <p style="color: var(--text-light); margin-bottom: 16px;">
                    Acesso rÃ¡pido Ã s principais funcionalidades do sistema.
                </p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-top: 24px;">
                    <button class="btn btn-primary" onclick="Sistema.trocarTab('agenda'); Agenda.abrirModal();" style="padding: 20px; font-size: 16px;">
                        ğŸ“… Novo Agendamento
                    </button>
                    
                    <button class="btn btn-primary" onclick="Sistema.trocarTab('pacientes'); Pacientes.abrirModal();" style="padding: 20px; font-size: 16px;">
                        ğŸ‘¥ Cadastrar Paciente
                    </button>
                    
                    <button class="btn btn-primary" onclick="Sistema.trocarTab('profissionais'); Profissionais.abrirModal();" style="padding: 20px; font-size: 16px;">
                        ğŸ‘¨â€âš•ï¸ Cadastrar Profissional
                    </button>
                    
                    <button class="btn btn-primary" onclick="Sistema.trocarTab('gestao'); Gestao.trocarAba('mapa'); Reparticoes.abrirModal();" style="padding: 20px; font-size: 16px;">
                        ğŸ¢ Nova Unidade
                    </button>
                    
                    <button class="btn btn-primary" onclick="Sistema.trocarTab('gestao'); Gestao.trocarAba('escalas'); Escalas.abrirModal();" style="padding: 20px; font-size: 16px;">
                        ğŸ“‹ Nova Escala
                    </button>
                    
                    <button class="btn btn-secondary" onclick="Sistema.trocarTab('atendimentos');" style="padding: 20px; font-size: 16px;">
                        ğŸ©º Ver Atendimentos
                    </button>
                </div>
            </div>
        </div>

        <!-- POOLS (v7.9.1 - ATIVADO) -->
        <div id="tab-pools" class="tab-content">
            <div class="card">
                <h2>ğŸ—ï¸ Pools de PadronizaÃ§Ã£o</h2>
                
                <div style="background: #dbeafe; padding: 16px; border-radius: 8px; border-left: 4px solid #3b82f6; margin-bottom: 24px;">
                    <p style="margin: 0; color: #1e40af;">
                        <strong>â„¹ï¸ O que sÃ£o Pools?</strong><br>
                        Pools sÃ£o listas de valores padronizados que vocÃª pode usar em vÃ¡rias partes do sistema (unidades, profissionais, pacientes, etc).
                        Quando vocÃª edita um item aqui, ele Ã© atualizado automaticamente em todos os lugares onde Ã© usado.
                    </p>
                </div>

                <div style="background: #f9fafb; padding: 16px; border-radius: 8px; border-left: 4px solid #fbbf24; margin-bottom: 24px;">
                    <p style="margin: 0; color: #92400e;">
                        <strong>ğŸ’¡ Como usar:</strong><br>
                        â€¢ â• <strong>Adicionar:</strong> Digite o novo item e clique "Adicionar"<br>
                        â€¢ âœï¸ <strong>Editar:</strong> Clique no lÃ¡pis, digite novo valor, confirme (atualiza todas as referÃªncias)<br>
                        â€¢ âŒ <strong>Deletar:</strong> Clique no Ã— (sÃ³ funciona se o item nÃ£o estiver em uso)<br>
                        â€¢ ğŸ”¢ <strong>Contador:</strong> Mostra quantos registros usam aquele item
                    </p>
                </div>

                <div id="listaPools"></div>
                        <strong>NOVIDADE v7.3 - Pools Completos!</strong><br>
                        <small>
                            âœï¸ <strong>Editar items</strong> - Clique no âœï¸ para renomear<br>
                            ğŸ”’ <strong>ProteÃ§Ã£o contra exclusÃ£o</strong> - NÃ£o remove se estiver em uso<br>
                            ğŸ”„ <strong>AtualizaÃ§Ã£o automÃ¡tica</strong> - Renomeia em todos os lugares<br>
                            ğŸ“Š <strong>Contador de uso</strong> - Veja quantas vezes cada item Ã© usado
                        </small>
                    </div>
                </div>

                <div id="listaPools"></div>
            </div>
        </div>

        <!-- CONFIGURAÃ‡Ã•ES -->
        <div id="tab-configuracoes" class="tab-content">
            <div class="card">
                <h2>âš™ï¸ ConfiguraÃ§Ãµes do Sistema</h2>
                
                <!-- SISTEMA DE PERMISSÃ•ES -->
                <div style="margin-bottom: 32px; padding: 20px; background: var(--bg); border-radius: 8px; border: 1px solid #e0e0e0;">
                    <h3 style="margin-bottom: 16px; color: var(--primary);">ğŸ” PermissÃµes de Acesso ao ProntuÃ¡rio</h3>
                    <p style="color: var(--text-light); margin-bottom: 16px; font-size: 14px;">
                        Selecione quais categorias profissionais podem acessar e editar prontuÃ¡rios mÃ©dicos:
                    </p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 12px;">
                        <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                            <input type="checkbox" id="perm-medico" value="medico" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span>ğŸ‘¨â€âš•ï¸ MÃ©dico(a)</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                            <input type="checkbox" id="perm-enfermeiro" value="enfermeiro" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span>ğŸ‘©â€âš•ï¸ Enfermeiro(a)</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                            <input type="checkbox" id="perm-assistente_social" value="assistente_social" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span>ğŸ¤ Assistente Social</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                            <input type="checkbox" id="perm-fisioterapeuta" value="fisioterapeuta" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span>ğŸƒ Fisioterapeuta</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                            <input type="checkbox" id="perm-psicologo" value="psicologo" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span>ğŸ§  PsicÃ³logo(a)</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                            <input type="checkbox" id="perm-nutricionista" value="nutricionista" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span>ğŸ¥— Nutricionista</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                            <input type="checkbox" id="perm-farmaceutico" value="farmaceutico" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span>ğŸ’Š FarmacÃªutico(a)</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                            <input type="checkbox" id="perm-administrativo" value="administrativo" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span>ğŸ“‹ Administrativo</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; padding: 12px; background: white; border-radius: 6px; cursor: pointer; border: 1px solid var(--border);">
                            <input type="checkbox" id="perm-recepcionista" value="recepcionista" onchange="Permissoes.salvar()" style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span>ğŸ§ Recepcionista</span>
                        </label>
                    </div>
                    
                    <div style="margin-top: 16px; padding: 12px; background: #f9fafb; border-radius: 6px; border: 1px solid #fbbf24;">
                        <p style="font-size: 13px; color: #92400e; margin: 0;">
                            âš ï¸ <strong>Importante:</strong> Administradores sempre tÃªm acesso completo, independente desta configuraÃ§Ã£o.
                        </p>
                    </div>
                </div>
                
                <div style="margin-bottom: 32px;">
                    <h3 style="margin-bottom: 16px;">ğŸ“¦ Gerenciar Dados</h3>
                    <div style="display: grid; gap: 16px;">
                        <button class="btn btn-success" onclick="Sistema.exportarDados()">
                            ğŸ“¥ Exportar Todos os Dados (JSON)
                        </button>
                        <button class="btn btn-warning" onclick="Sistema.importarDados()">
                            ğŸ“¤ Importar Dados (JSON)
                        </button>
                        <button class="btn btn-danger" onclick="Sistema.resetarDadosTeste()">
                            ğŸ”„ Resetar Dados de Teste
                        </button>
                        <button class="btn btn-danger" onclick="Sistema.limparDados()" style="background: #7f1d1d; border-color: #7f1d1d;">
                            âš ï¸ RESETAR TUDO (Volta ao Zero Total)
                        </button>
                    </div>
                    <div style="margin-top: 12px; padding: 12px; background: #fee2e2; border-radius: 6px; border: 1px solid #ef4444;">
                        <p style="font-size: 13px; color: #991b1b; margin: 0;">
                            âš ï¸ <strong>AtenÃ§Ã£o:</strong><br>
                            â€¢ <strong>"Resetar Dados de Teste"</strong> - MantÃ©m o Estabelecimento configurado. Limpa: repartiÃ§Ãµes, profissionais, pacientes, agendamentos, atendimentos, prontuÃ¡rios e SAME. Ideal para comeÃ§ar testes limpos.<br><br>
                            â€¢ <strong>"Limpar TODOS os Dados"</strong> - Apaga ABSOLUTAMENTE TUDO, incluindo Estabelecimento e configuraÃ§Ãµes. O sistema volta ao estado inicial como se nunca tivesse sido usado. Use APENAS se quiser recomeÃ§ar do ZERO TOTAL!
                        </p>
                    </div>
                </div>

                <!-- FERRAMENTAS DE MANUTENÃ‡ÃƒO v7.9 -->
                <div style="margin-bottom: 32px;">
                    <h3 style="margin-bottom: 16px;">ğŸ”§ Ferramentas de ManutenÃ§Ã£o</h3>
                    <p style="color: var(--text-light); margin-bottom: 16px;">
                        Diagnosticar e corrigir problemas no sistema
                    </p>
                    
                    <!-- LEITOS FANTASMAS -->
                    <div style="margin-bottom: 24px;">
                        <h4 style="margin-bottom: 12px;">ğŸ›ï¸ Leitos Fantasmas</h4>
                        <div style="display: grid; gap: 12px;">
                            <button class="btn btn-warning" onclick="Sistema.diagnosticarLeitos()">
                                ğŸ” Diagnosticar Leitos Fantasmas
                            </button>
                            <button class="btn btn-danger" onclick="Sistema.limparLeitosFantasmas()">
                                ğŸ§¹ Limpar Leitos Fantasmas
                            </button>
                        </div>
                        <div id="diagnostico-resultado" style="margin-top: 16px; padding: 16px; background: #f8fafc; border-radius: 8px; display: none;"></div>
                        <div style="margin-top: 12px; padding: 12px; background: #dbeafe; border-radius: 6px; border: 1px solid #3b82f6;">
                            <p style="font-size: 13px; color: #1e40af; margin: 0;">
                                â„¹ï¸ <strong>O que sÃ£o Leitos Fantasmas?</strong><br>
                                Leitos que ficam marcados como "ocupados" mas nÃ£o tÃªm paciente associado, impedindo exclusÃ£o ou nova internaÃ§Ã£o.
                            </p>
                        </div>
                    </div>
                    
                    <!-- v7.10: REPARTIÃ‡Ã•ES FANTASMAS EM PROFISSIONAIS -->
                    <div style="margin-bottom: 24px;">
                        <h4 style="margin-bottom: 12px;">ğŸ‘¤ Profissionais com RepartiÃ§Ãµes Fantasmas</h4>
                        <div style="display: grid; gap: 12px;">
                            <button class="btn btn-warning" onclick="Sistema.diagnosticarProfissionais()">
                                ğŸ” Diagnosticar Profissionais
                            </button>
                            <button class="btn btn-danger" onclick="Sistema.limparReparticoesFantasmas()">
                                ğŸ§¹ Limpar RepartiÃ§Ãµes Fantasmas
                            </button>
                        </div>
                        <div id="diagnostico-profissionais-resultado" style="margin-top: 16px; padding: 16px; background: #f8fafc; border-radius: 8px; display: none;"></div>
                        <div style="margin-top: 12px; padding: 12px; background: #f9fafb; border-radius: 6px; border: 1px solid #f59e0b;">
                            <p style="font-size: 13px; color: #92400e; margin: 0;">
                                â„¹ï¸ <strong>O que sÃ£o RepartiÃ§Ãµes Fantasmas?</strong><br>
                                Profissionais com vÃ­nculos a repartiÃ§Ãµes que foram deletadas, causando erros ao tentar internar pacientes.<br><br>
                                <strong>Como usar:</strong><br>
                                1. Clique em "ğŸ” Diagnosticar" para ver profissionais com problema<br>
                                2. Se encontrar problemas, clique em "ğŸ§¹ Limpar" para corrigir automaticamente
                            </p>
                        </div>
                    </div>
                    
                    <!-- v7.10.2: SINCRONIZAR ESPECIALIDADES GRUPO â†’ LEITOS -->
                    <div style="margin-bottom: 24px;">
                        <h4 style="margin-bottom: 12px;">ğŸ”„ Sincronizar Especialidades</h4>
                        <div style="display: grid; gap: 12px;">
                            <button class="btn btn-success" onclick="Sistema.sincronizarEspecialidadesLeitos()">
                                ğŸ”„ Sincronizar Especialidades Grupos â†’ Leitos
                            </button>
                        </div>
                        <div id="diagnostico-sincronizacao-resultado" style="margin-top: 16px; padding: 16px; background: #f8fafc; border-radius: 8px; display: none;"></div>
                        <div style="margin-top: 12px; padding: 12px; background: #f9fafb; border-radius: 6px; border: 1px solid #22c55e;">
                            <p style="font-size: 13px; color: #166534; margin: 0;">
                                â„¹ï¸ <strong>Para Que Serve?</strong><br>
                                Copia as configuraÃ§Ãµes de especialidades do grupo (Enfermaria UTQ) para todos os seus leitos individuais (Leito 1, 2, 3...), garantindo que as validaÃ§Ãµes funcionem corretamente.<br><br>
                                <strong>Quando usar:</strong><br>
                                â€¢ ApÃ³s criar novas enfermarias<br>
                                â€¢ Se os leitos nÃ£o estÃ£o aceitando internaÃ§Ãµes<br>
                                â€¢ Quando alterar especialidades de uma enfermaria existente<br><br>
                                <strong>O que faz:</strong><br>
                                Se vocÃª marcou "Aceita todas especialidades" na Enfermaria UTQ, todos os Leitos 1-6 receberÃ£o essa mesma configuraÃ§Ã£o automaticamente!
                            </p>
                        </div>
                    </div>
                    
                    <!-- v10.463: ATENDIMENTOS - DiagnÃ³stico e Reset -->
                    <div style="margin-bottom: 24px;">
                        <h4 style="margin-bottom: 12px;">ğŸ©º Fila de Atendimentos</h4>
                        <div style="display: grid; gap: 12px;">
                            <button class="btn btn-info" onclick="Atendimentos.diagnosticar()">
                                ğŸ” Diagnosticar Atendimentos
                            </button>
                            <button class="btn btn-warning" onclick="Atendimentos.removerDuplicatas()">
                                ğŸ§¹ Remover Duplicatas
                            </button>
                            <button class="btn btn-danger" onclick="Atendimentos.resetarTudo()">
                                ğŸ—‘ï¸ Reset Fila/Entradas
                            </button>
                        </div>
                        <div style="margin-top: 12px; padding: 12px; background: #fef2f2; border-radius: 6px; border: 1px solid #ef4444;">
                            <p style="font-size: 13px; color: #991b1b; margin: 0;">
                                âš ï¸ <strong>AtenÃ§Ã£o:</strong><br>
                                â€¢ <strong>"Diagnosticar"</strong> - Mostra estatÃ­sticas da fila, entradas e atendimentos<br>
                                â€¢ <strong>"Remover Duplicatas"</strong> - Remove entradas duplicadas (mesmo agendamento)<br>
                                â€¢ <strong>"Reset Fila"</strong> - Limpa TODAS as entradas e reseta status dos agendamentos
                            </p>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 24px; padding: 16px; background: var(--bg); border-radius: 8px;">
                    <h3>â„¹ï¸ InformaÃ§Ãµes do Sistema</h3>
                    <p style="margin-top: 8px;"><strong>VersÃ£o:</strong> 7.9.1 - CORREÃ‡Ã•ES + MANUTENÃ‡ÃƒO</p>
                    <p><strong>Data:</strong> 03/11/2025</p>
                    <p><strong>Desenvolvido para:</strong> Hospital JoÃ£o XXIII - FHEMIG</p>
                    <p style="margin-top: 12px; color: var(--text-light);">
                        <strong>Novidades v7.9.1:</strong><br>
                        â€¢ ğŸ”§ Ferramenta de diagnÃ³stico de leitos fantasmas<br>
                        â€¢ ğŸ§¹ Limpeza automÃ¡tica de leitos presos<br>
                        â€¢ ğŸ“Š RelatÃ³rio completo de problemas<br>
                        â€¢ âœ… SoluÃ§Ã£o definitiva para leitos "travados"
                    </p>
                    <p style="margin-top: 12px; color: var(--text-light);">
                        <strong>Novidades v7.9:</strong><br>
                        â€¢ âœ… Filtro de categoria corrigido na Agenda<br>
                        â€¢ ğŸ“ PluralizaÃ§Ã£o automÃ¡tica implementada<br>
                        â€¢ ğŸ¥ OcupaÃ§Ã£o de emergÃªncia funcional<br>
                        â€¢ ğŸ” Logs de debug no console
                    </p>
                    <p style="margin-top: 12px; color: var(--text-light);">
                        <strong>Fluxo completo:</strong><br>
                        â€¢ Operacional: Agenda â†’ Atendimentos (criar prontuÃ¡rio)<br>
                        â€¢ GestÃ£o: ProntuÃ¡rios (consultar/revisar/auditar)<br>
                        â€¢ AnÃ¡lise: HistÃ³rico (visÃ£o cronolÃ³gica por paciente)<br>
                        â€¢ Arquivo: SAME (pacientes com alta hospitalar)
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL MODELO DE ATENDIMENTO v10.355 - Padronizado -->
    <div id="modalModelo" class="modal">
        <div class="modal-content large" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h3 id="tituloModalModelo">Novo Modelo de ProntuÃ¡rio</h3>
                <button class="btn-close" onclick="ModelosAtendimento.fecharModal()">Ã—</button>
            </div>
            <input type="hidden" id="edit-modelo-id">
            
            <div class="modal-body" style="padding: 25px;">
                
                <!-- DADOS BÃSICOS -->
                <div style="border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 15px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                        <span style="color: #667eea;">ğŸ“‹</span>
                        <span style="font-size: 15px; font-weight: 500; color: #667eea;">Dados BÃ¡sicos</span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">Nome do Modelo</label>
                            <input type="text" id="modelo-nome" placeholder="Ex: Consulta Cardiologia" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                        </div>
                        <div>
                            <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">Tipo de Atendimento</label>
                            <select id="modelo-tipo" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                                <option value="">Selecione...</option>
                                <option value="consulta">Consulta</option>
                                <option value="emergencia">EmergÃªncia</option>
                                <option value="cirurgia">Cirurgia</option>
                                <option value="internacao">InternaÃ§Ã£o</option>
                                <option value="exame">Exame</option>
                                <option value="procedimento">Procedimento</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">Especialidade</label>
                            <select id="modelo-especialidade" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                                <option value="">Geral (todas)</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">Status</label>
                            <select id="modelo-ativo" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                                <option value="true">Ativo</option>
                                <option value="false">Inativo</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- CABEÃ‡ALHO -->
                <div style="border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 15px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                        <span style="color: #667eea;">ğŸ“„</span>
                        <span style="font-size: 15px; font-weight: 500; color: #667eea;">Layout de CabeÃ§alho</span>
                    </div>
                    
                    <div>
                        <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">CabeÃ§alho para ImpressÃ£o/PDF</label>
                        <select id="modelo-cabecalho" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                            <option value="">PadrÃ£o do Sistema</option>
                        </select>
                    </div>
                </div>

                <!-- MÃ“DULOS DO PRONTUÃRIO -->
                <div style="border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 15px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                        <span style="color: #667eea;">ğŸ“</span>
                        <span style="font-size: 15px; font-weight: 500; color: #667eea;">MÃ³dulos do ProntuÃ¡rio</span>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">MÃ³dulos Selecionados</label>
                        <div id="lista-modulos-selecionados" style="min-height: 50px; border: 1px solid #ddd; border-radius: 4px; padding: 10px;">
                            <p id="msg-sem-modulos" style="color: #999; text-align: center; padding: 15px; margin: 0; font-size: 13px;">Nenhum mÃ³dulo selecionado</p>
                        </div>
                    </div>
                    
                    <div>
                        <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">Adicionar MÃ³dulo</label>
                        <select id="select-categoria-modulo" onchange="ModulosOrdenavel.filtrarModulos()" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; margin-bottom: 10px;">
                            <option value="">Todas as Categorias</option>
                            <option value="anamnese">ğŸ“– Anamnese</option>
                            <option value="exame_fisico">âš•ï¸ Exame FÃ­sico</option>
                            <option value="escalas">ğŸ“Š Escalas ClÃ­nicas</option>
                            <option value="diagnostico">ğŸ” DiagnÃ³stico e Conduta</option>
                            <option value="cirurgico">âš•ï¸ CirÃºrgico</option>
                            <option value="internacao">ğŸ›ï¸ EvoluÃ§Ã£o e InternaÃ§Ã£o</option>
                            <option value="documentacao_visual">ğŸ“· DocumentaÃ§Ã£o Visual</option>
                        </select>
                        <div id="lista-modulos-disponiveis" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; max-height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 10px;"></div>
                    </div>
                </div>

                <!-- CONFIGURAÃ‡Ã•ES -->
                <div style="border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 15px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                        <span style="color: #667eea;">âš™ï¸</span>
                        <span style="font-size: 15px; font-weight: 500; color: #667eea;">ConfiguraÃ§Ãµes</span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div>
                            <label style="display: flex; align-items: center; gap: 8px; font-size: 13px; color: #555; cursor: pointer;">
                                <input type="checkbox" id="modelo-timer" style="width: 16px; height: 16px;">
                                Mostrar timer de duraÃ§Ã£o
                            </label>
                        </div>
                        <div>
                            <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">Exame FÃ­sico EspecÃ­fico</label>
                            <select id="modelo-exame-tipo" onchange="ModelosAtendimento.trocarTipoExame()" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                                <option value="">Apenas texto livre</option>
                                <option value="iframe">IFrame Externo</option>
                                <option value="corpo">Mapa AnatÃ´mico</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- CONFIG IFRAME -->
                    <div id="config-iframe" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">URL do Arquivo HTML</label>
                                <input type="text" id="modelo-iframe-url" placeholder="Ex: exame_especifico.html" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                            </div>
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">Altura (px)</label>
                                <input type="number" id="modelo-iframe-altura" value="800" min="400" max="2000" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                            </div>
                        </div>
                    </div>

                    <!-- CONFIG CORPO -->
                    <div id="config-corpo" style="display: none; margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">VisualizaÃ§Ã£o PadrÃ£o</label>
                                <select id="modelo-corpo-visualizacao" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                                    <option value="frente">Vista Frontal</option>
                                    <option value="costas">Vista Posterior</option>
                                    <option value="lateral">Vista Lateral</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; margin-bottom: 6px;">Template de RegiÃµes</label>
                                <select id="modelo-corpo-template" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                                    <option value="">Sem template</option>
                                    <option value="atlas_completo">Atlas AnatÃ´mico MACRO</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: flex; align-items: center; gap: 8px; font-size: 13px; color: #555; cursor: pointer;">
                                    <input type="checkbox" id="modelo-corpo-permitir-edicao" checked style="width: 16px; height: 16px;">
                                    Permitir criar novas regiÃµes
                                </label>
                            </div>
                            <div>
                                <label style="display: flex; align-items: center; gap: 8px; font-size: 13px; color: #555; cursor: pointer;">
                                    <input type="checkbox" id="modelo-corpo-obrigatorio" style="width: 16px; height: 16px;">
                                    Exame anatÃ´mico obrigatÃ³rio
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- CONFIG OUTROS -->
                    <div id="config-outros" style="display: none; margin-top: 15px; padding: 15px; text-align: center; color: #666; font-size: 13px;">
                        Em desenvolvimento
                    </div>
                </div>

            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="ModelosAtendimento.fecharModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="ModelosAtendimento.salvar()">Salvar Modelo</button>
            </div>
        </div>
    </div>

    <!-- MODAL REPARTIÃ‡ÃƒO -->
    <div id="modalReparticao" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3 id="tituloModalReparticao">Nova RepartiÃ§Ã£o v10.76 âœ…</h3>
                <button class="btn-close" onclick="Reparticoes.fecharModal()">Ã—</button>
            </div>
            <input type="hidden" id="edit-reparticao-id">
            
            <!-- TIPO DE REPARTIÃ‡ÃƒO (NOVO v6.8.0) -->
            <div class="form-group">
                <label>Tipo de RepartiÃ§Ã£o <span class="required-indicator">*</span></label>
                <select class="form-control" id="rep-tipo-reparticao" onchange="Reparticoes.trocarTipoReparticao()" style="font-size: 16px;">
                    <option value="">Selecione o tipo...</option>
                    <option value="procedimento">AmbulatÃ³rio(s) ğŸ¥</option>
                    <option value="bloco_cirurgico">Bloco CirÃºrgico (Centro CirÃºrgico) âš•ï¸</option>
                    <option value="consultorio">ConsultÃ³rio(s) ğŸ©º</option>
                    <option value="exames_imagem">Exames de Imagem ğŸ©»</option>
                    <option value="exames_laboratorio">Exames de LaboratÃ³rio ğŸ”¬</option>
                    <option value="internacao">InternaÃ§Ã£o (Leitos) ğŸ›ï¸</option>
                    <option value="emergencia">Pronto-Socorro (EmergÃªncia) ğŸš¨</option>
                </select>
            </div>

            <!-- INFORMAÃ‡Ã•ES BÃSICAS (TODOS OS TIPOS) -->
            <div class="form-group">
                <label>Nome da RepartiÃ§Ã£o <span class="required-indicator">*</span></label>
                <input type="text" 
                       class="form-control" 
                       id="rep-nome" 
                       list="nomes-sugeridos-list"
                       placeholder="Digite ou selecione..."
                       autocomplete="off">
                <datalist id="nomes-sugeridos-list">
                    <!-- SerÃ¡ populado via JavaScript -->
                </datalist>
                <small style="display: block; margin-top: 4px; color: var(--text-light);">
                    ğŸ’¡ Digite livremente ou escolha da lista de sugestÃµes
                </small>
            </div>

            <!-- LOCALIZAÃ‡ÃƒO (TODOS OS TIPOS) - v7.9.1: ORDEM CORRIGIDA -->
            <div class="form-group">
                <label>Andar <span style="color: var(--text-light); font-weight: normal;">(opcional)</span></label>
                <input type="text" 
                       class="form-control" 
                       id="rep-andar"
                       list="andares-list"
                       placeholder="Digite ou selecione..."
                       autocomplete="off">
                <datalist id="andares-list">
                    <!-- SerÃ¡ populado via JavaScript -->
                </datalist>
            </div>
            <div class="form-group">
                <label>PavilhÃ£o/Ala/Bloco <span style="color: var(--text-light); font-weight: normal;">(opcional)</span></label>
                <input type="text" 
                       class="form-control" 
                       id="rep-pavilhao"
                       list="pavilhoes-list"
                       placeholder="Digite ou selecione..."
                       autocomplete="off">
                <datalist id="pavilhoes-list">
                    <!-- SerÃ¡ populado via JavaScript -->
                </datalist>
            </div>
            <div class="form-group">
                <label>Enfermaria/Setor <span style="color: var(--text-light); font-weight: normal;">(opcional)</span></label>
                <input type="text" 
                       class="form-control" 
                       id="rep-setor"
                       list="setores-list"
                       placeholder="Digite ou selecione..."
                       autocomplete="off">
                <datalist id="setores-list">
                    <!-- SerÃ¡ populado via JavaScript -->
                </datalist>
            </div>

            <!-- v6.8.2: CAPACIDADE (aparece conforme tipo) -->
            <div id="campo-capacidade" style="display: none; margin-top: 16px;">
                <div style="background: #f9fafb; padding: 12px; border-radius: 8px; margin-bottom: 12px;">
                    <strong>ğŸ“Š Capacidade e Sub-repartiÃ§Ãµes</strong>
                </div>
                <div class="form-group">
                    <label id="label-capacidade">Quantidade</label>
                    <input type="number" class="form-control" id="rep-capacidade" min="1" max="100" value="1">
                    <small id="hint-capacidade" style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ Sistema criarÃ¡ automaticamente as sub-repartiÃ§Ãµes numeradas
                    </small>
                </div>
                <div class="form-group">
                    <label>PadrÃ£o de Nome</label>
                    <input type="text" class="form-control" id="rep-padrao-nome" placeholder="Ex: Leito, Sala, ConsultÃ³rio">
                    <small style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ Exemplo: "Leito" gerarÃ¡ "Leito 1", "Leito 2", "Leito 3"...
                    </small>
                </div>
                
                <!-- ğŸ”´ FASE 2 - OPÃ‡ÃƒO A: ConfiguraÃ§Ã£o avanÃ§ada de numeraÃ§Ã£o -->
                <div class="form-group">
                    <label>Prefixo <span style="color: var(--text-light); font-weight: normal;">(opcional)</span></label>
                    <input type="text" class="form-control" id="rep-prefixo" placeholder="Ex: 801-">
                    <small style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ Adiciona prefixo aos nÃºmeros. Ex: "801-" gerarÃ¡ "Leito 801-1", "Leito 801-2"...
                    </small>
                </div>
                
                <div class="form-group">
                    <label>NumeraÃ§Ã£o comeÃ§a em</label>
                    <input type="number" class="form-control" id="rep-numeracao-inicial" min="1" max="999" value="1" placeholder="1">
                    <small style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ PadrÃ£o Ã© 1. Use outro nÃºmero se necessÃ¡rio (ex: comeÃ§ar do 5)
                    </small>
                </div>
                
                <div class="form-group">
                    <label>NÃºmero(s) da(s) unidade(s) isolada(s) <span style="color: var(--text-light); font-weight: normal;">(opcional)</span></label>
                    <input type="text" class="form-control" id="rep-leitos-isolados" placeholder="Ex: 8 ou 8,9 ou 8-10">
                    <small style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ Digite os <strong>NÃšMEROS</strong> das unidades com isolamento<br>
                        â€¢ "8" = sÃ³ o nÃºmero 8<br>
                        â€¢ "8,9" = nÃºmeros 8 e 9<br>
                        â€¢ "8-10" = nÃºmeros de 8 a 10<br>
                        â€¢ "2,5,8-10" = 2, 5, 8, 9 e 10
                    </small>
                </div>
                
                <!-- ğŸ”´ TIPOS DE ISOLAMENTO (aplicÃ¡vel a TODAS unidades com capacidade) -->
                <div style="background: #f9fafb; padding: 16px; border-radius: 8px; margin-top: 12px; border: 2px solid #f59e0b;">
                    <div style="margin-bottom: 12px;">
                        <strong style="font-size: 15px; color: #92400e;">ğŸ”’ Tipos de Isolamento DisponÃ­veis</strong>
                        <p style="margin: 8px 0 0 0; font-size: 13px; color: #78350f;">
                            Marque os tipos de isolamento/precauÃ§Ãµes disponÃ­veis nas unidades isoladas
                        </p>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px; cursor: pointer;">
                            <input type="checkbox" id="int-precaucao-contato" style="width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">ğŸ¦  PrecauÃ§Ã£o de CONTATO</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px; cursor: pointer;">
                            <input type="checkbox" id="int-precaucao-aerossol" style="width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">ğŸ’¨ PrecauÃ§Ã£o AEROSSOL</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="int-precaucao-goticulas" style="width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">ğŸ’§ PrecauÃ§Ã£o GOTÃCULAS</span>
                        </label>
                    </div>
                    
                    <small style="display: block; margin-top: 12px; color: #92400e; font-weight: 500;">
                        â„¹ï¸ Exemplo: 10 unidades, isolados: "8,9" â†’ as unidades 8 e 9 terÃ£o as precauÃ§Ãµes marcadas
                    </small>
                </div>
            </div>

            <!-- v9.8.1: CONTROLE DE ESPECIALIDADES REDESENHADO -->
            <div style="background: #f9fafb; padding: 16px; border-radius: 8px; margin-top: 16px; margin-bottom: 16px; border: 1px solid #ddd;">
                <div style="margin-bottom: 16px;">
                    <strong style="font-size: 15px; color: #1e40af;">ğŸ©º Especialidades desta Unidade</strong>
                    <p style="margin: 8px 0 0 0; font-size: 13px; color: #64748b;">
                        Define quais especialidades mÃ©dicas podem utilizar esta unidade
                    </p>
                </div>
                
                <!-- CHECKBOX: ACEITA TODAS -->
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="rep-aceita-todas-esp" 
                               onchange="Reparticoes.toggleEspecialidades()">
                        <span style="font-weight: 500;">Aceita todas as especialidades?</span>
                    </label>
                    <small style="display: block; margin-top: 4px; margin-left: 28px; color: var(--text-light);">
                        â„¹ï¸ Marque para UTI, EmergÃªncia, Pronto Socorro, etc.
                    </small>
                </div>

                <input type="hidden" id="rep-especialidades-hidden" value="">

                <!-- SEÃ‡ÃƒO: ESPECIALIDADES ESPECÃFICAS -->
                <div id="rep-secao-especialidades" style="display: none;">
                    
                    <!-- ADICIONAR ESPECIALIDADE Ã€ UNIDADE -->
                    <div style="background: white; padding: 12px; border-radius: 6px; margin-top: 12px; border: 1px solid #e2e8f0;">
                        <label style="font-weight: 500; margin-bottom: 8px; display: block; color: #1e293b;">
                            â• Adicionar Especialidade
                        </label>
                        
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <select class="form-control" id="rep-especialidade-select" style="flex: 1;">
                                <option value="">Selecione do pool...</option>
                            </select>
                            <button type="button" class="btn btn-success" 
                                    onclick="Reparticoes.adicionarEspecialidade()" 
                                    title="Adicionar esta especialidade Ã  unidade"
                                    style="padding: 8px 20px; white-space: nowrap; font-weight: 500;">
                                â• Adicionar
                            </button>
                        </div>
                    </div>
                    
                    <!-- LISTA DE ESPECIALIDADES ADICIONADAS -->
                    <div style="margin-top: 12px;">
                        <label style="font-weight: 500; margin-bottom: 8px; display: block; color: #1e293b;">
                            ğŸ“‹ Especialidades Permitidas Nesta Unidade
                        </label>
                        <div id="rep-especialidades-lista" 
                             style="display: flex; flex-wrap: wrap; gap: 8px; min-height: 40px; 
                                    padding: 12px; background: #f8fafc; border-radius: 6px; border: 1px solid #e2e8f0;">
                            <p style="color: var(--text-light); margin: 0;">Nenhuma especialidade adicionada ainda</p>
                        </div>
                    </div>
                    
                </div>
            </div>

            <!-- ========================================
                 CAMPOS ESPECÃFICOS POR TIPO (v6.8.0)
                 ======================================== -->

            <!-- CONSULTÃ“RIO -->
            <div id="campos-tipo-consultorio" class="campos-tipo" style="display:none;">
                <div style="background: #eff6ff; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
                    <strong>ğŸ©º ConfiguraÃ§Ã£o de ConsultÃ³rio</strong>
                </div>
                <div class="form-group">
                    <label>HorÃ¡rio de Funcionamento</label>
                    <input type="text" class="form-control" id="cons-horario" placeholder="Ex: 08:00 - 18:00">
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="cons-agenda-habilitada" checked> 
                        Habilitar agendamento de consultas
                    </label>
                </div>
            </div>

            <!-- PROCEDIMENTO -->
            <div id="campos-tipo-procedimento" class="campos-tipo" style="display:none;">
                <div style="background: #f9fafb; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
                    <strong>ğŸ¥ ConfiguraÃ§Ã£o de Procedimento</strong>
                </div>
                <div class="form-group">
                    <label>Tipos de Procedimentos Realizados</label>
                    <textarea class="form-control" id="proc-tipos" rows="2" placeholder="Ex: Curativos, Suturas, Pequenas cirurgias..."></textarea>
                </div>
                <div class="form-group">
                    <label>PreparaÃ§Ã£o NecessÃ¡ria</label>
                    <select class="form-control" id="proc-preparacao">
                        <option value="anestesia_local">Anestesia Local</option>
                        <option value="jejum">Jejum</option>
                        <option value="nenhuma">Nenhuma</option>
                        <option value="sedacao">SedaÃ§Ã£o</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Equipamentos DisponÃ­veis</label>
                    <textarea class="form-control" id="proc-equipamentos" rows="2" placeholder="Ex: Mesa cirÃºrgica, Foco, Material de sutura..."></textarea>
                </div>
            </div>

            <!-- EMERGÃŠNCIA -->
            <div id="campos-tipo-emergencia" class="campos-tipo" style="display:none;">
                <div style="background: #fef2f2; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
                    <strong>ğŸš¨ ConfiguraÃ§Ã£o de EmergÃªncia</strong>
                </div>
                <div class="form-group">
                    <label>ClassificaÃ§Ã£o de Risco Utilizada</label>
                    <select class="form-control" id="emerg-classificacao">
                        <option value="cores">Sistema de Cores</option>
                        <option value="outro">Outro</option>
                        <option value="manchester">Protocolo de Manchester</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Equipamentos de EmergÃªncia</label>
                    <textarea class="form-control" id="emerg-equipamentos" rows="3" placeholder="Ex: Desfibrilador, Carro de emergÃªncia, Monitor multiparamÃ©trico..."></textarea>
                </div>
                <div class="form-group">
                    <label>Equipe de PlantÃ£o PadrÃ£o</label>
                    <textarea class="form-control" id="emerg-equipe" rows="2" placeholder="Ex: 2 mÃ©dicos, 4 enfermeiros, 2 tÃ©cnicos..."></textarea>
                </div>
            </div>

            <!-- INTERNAÃ‡ÃƒO -->
            <div id="campos-tipo-internacao" class="campos-tipo" style="display:none;">
                <div style="background: #f9fafb; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
                    <strong>ğŸ›ï¸ ConfiguraÃ§Ã£o de Leito</strong>
                </div>
                <div class="grid-2">
                    <div class="form-group">
                        <label>NÃºmero do Leito</label>
                        <input type="text" class="form-control" id="int-numero" placeholder="Ex: 101, 102A, UTI-05...">
                    </div>
                    <div class="form-group">
                        <label>Tipo de AcomodaÃ§Ã£o</label>
                        <select class="form-control" id="int-tipo-acomodacao">
                            <option value="apartamento">Apartamento (Individual)</option>
                            <option value="enfermaria">Enfermaria (Compartilhada)</option>
                            <option value="semi_intensiva">Semi-Intensiva</option>
                            <option value="uti">UTI</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Status Inicial</label>
                    <select class="form-control" id="int-status">
                        <option value="livre">Livre</option>
                        <option value="reservado">Reservado</option>
                        <option value="desativado">Desativado</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Equipamentos do Leito</label>
                    <textarea class="form-control" id="int-equipamentos" rows="2" placeholder="Ex: Monitor cardÃ­aco, OxÃ­metro, Bomba de infusÃ£o..."></textarea>
                </div>
            </div>

            <!-- BLOCO CIRÃšRGICO -->
            <div id="campos-tipo-bloco_cirurgico" class="campos-tipo" style="display:none;">
                <div style="background: #ede9fe; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
                    <strong>âš•ï¸ ConfiguraÃ§Ã£o de Sala CirÃºrgica</strong>
                </div>
                <div class="form-group">
                    <label>NÃºmero da Sala</label>
                    <input type="text" class="form-control" id="bc-numero" placeholder="Ex: Sala 1, CC-A, Bloco 3...">
                </div>
                <div class="form-group">
                    <label>Tipos de Cirurgia Suportados</label>
                    <textarea class="form-control" id="bc-tipos-cirurgia" rows="2" placeholder="Ex: CardÃ­aca, OrtopÃ©dica, Geral, Neurocirurgia..."></textarea>
                </div>
                <div class="form-group">
                    <label>Equipamentos CirÃºrgicos</label>
                    <textarea class="form-control" id="bc-equipamentos" rows="3" placeholder="Ex: Mesa cirÃºrgica, Foco central, Monitor multiparamÃ©trico, Bisturi elÃ©trico..."></textarea>
                </div>
                <div class="form-group">
                    <label>Status Inicial</label>
                    <select class="form-control" id="bc-status">
                        <option value="desativado">Desativado</option>
                        <option value="livre">Livre</option>
                    </select>
                </div>
            </div>

            <!-- EXAMES -->
            <div id="campos-tipo-exames" class="campos-tipo" style="display:none;">
                <div style="background: #fce7f3; padding: 12px; border-radius: 8px; margin-bottom: 16px;">
                    <strong>ğŸ”¬ ConfiguraÃ§Ã£o de Sala de Exames</strong>
                </div>
                <div class="form-group">
                    <label>Tipo de Exame</label>
                    <select class="form-control" id="exa-tipo">
                        <option value="laboratorio">LaboratÃ³rio</option>
                        <option value="mamografia">Mamografia</option>
                        <option value="outros">Outros Exames</option>
                        <option value="raio-x">Raio-X</option>
                        <option value="ressonancia">RessonÃ¢ncia MagnÃ©tica</option>
                        <option value="tomografia">Tomografia</option>
                        <option value="ultrassom">Ultrassom</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>PreparaÃ§Ã£o do Paciente</label>
                    <select class="form-control" id="exa-preparacao">
                        <option value="contraste">Uso de Contraste</option>
                        <option value="jejum">Jejum</option>
                        <option value="nenhuma">Nenhuma</option>
                        <option value="sedacao">SedaÃ§Ã£o</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Equipamento Principal</label>
                    <input type="text" class="form-control" id="exa-equipamento" placeholder="Ex: TomÃ³grafo Siemens 64 canais, Ultrassom GE Voluson...">
                </div>
            </div>

            <!-- OBSERVAÃ‡Ã•ES (TODOS OS TIPOS) -->
            <div class="form-group">
                <label>ObservaÃ§Ãµes Gerais</label>
                <textarea class="form-control" id="rep-observacoes" rows="2" placeholder="InformaÃ§Ãµes adicionais sobre esta repartiÃ§Ã£o..."></textarea>
            </div>

            <button class="btn btn-primary" onclick="Reparticoes.salvar()">ğŸ’¾ Salvar RepartiÃ§Ã£o</button>
        </div>
    </div>

    </div>

    <!-- MODAL INTERNAR PACIENTE -->
    <div id="modalInternar" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ¨ Internar Paciente</h3>
                <button class="btn-close" onclick="Reparticoes.fecharModalInternar()">Ã—</button>
            </div>
            <input type="hidden" id="internar-reparticao-id">
            
            <div class="form-group">
                <label>Selecione o Paciente</label>
                <select class="form-control" id="internar-paciente" required>
                    <option value="">Selecione...</option>
                </select>
            </div>

            <div class="form-group">
                <label>Profissional ResponsÃ¡vel <span class="required-indicator">*</span></label>
                <select class="form-control" id="internar-profissional" required>
                    <option value="">Selecione...</option>
                </select>
                <small style="display: block; margin-top: 4px; color: var(--text-light);">
                    â„¹ï¸ A especialidade do profissional serÃ¡ validada contra o leito
                </small>
            </div>

            <div class="form-group">
                <label>Motivo da InternaÃ§Ã£o</label>
                <textarea class="form-control" id="internar-motivo" rows="3" required placeholder="Descreva o motivo da internaÃ§Ã£o..."></textarea>
            </div>

            <div class="form-group">
                <label>Data e Hora da InternaÃ§Ã£o</label>
                <input type="datetime-local" class="form-control" id="internar-data" required>
            </div>

            <button class="btn btn-success" onclick="Reparticoes.confirmarInternacao()">ğŸ¨ Confirmar InternaÃ§Ã£o</button>
        </div>
    </div>

    <!-- v8.0.6: MODAL DEDICADO PARA RESERVA DE LEITO -->
    <div id="modalReservar" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ“… Reservar Leito (Matriciamento)</h3>
                <button class="btn-close" onclick="Reparticoes.fecharModalReservar()">Ã—</button>
            </div>
            <input type="hidden" id="reservar-reparticao-id">
            
            <div style="background: #f9fafb; border-left: 4px solid #ffc107; padding: 12px; margin-bottom: 20px; border-radius: 4px;">
                <strong>â„¹ï¸ Sobre o Matriciamento:</strong>
                <p style="margin: 8px 0 0 0; font-size: 14px; color: #856404;">
                    Reserva de leito para paciente que serÃ¡ internado futuramente. Use para garantir vaga em casos de regulaÃ§Ã£o ou transferÃªncia programada.
                </p>
            </div>
            
            <div class="form-group">
                <label>Selecione o Paciente <span class="required-indicator">*</span></label>
                <select class="form-control" id="reservar-paciente" required>
                    <option value="">Selecione...</option>
                </select>
                <button type="button" class="btn btn-secondary" onclick="Reparticoes.abrirPreCadastroReserva()" 
                        style="margin-top: 8px; width: 100%; background: #10b981; border-color: #10b981;">
                    â• PrÃ©-Cadastro RÃ¡pido (Paciente Novo)
                </button>
            </div>

            <div class="form-group">
                <label>Profissional ResponsÃ¡vel</label>
                <select class="form-control" id="reservar-profissional">
                    <option value="">Selecione...</option>
                </select>
                <small style="display: block; margin-top: 4px; color: var(--text-light);">
                    â„¹ï¸ Profissional que solicitou ou coordena a internaÃ§Ã£o
                </small>
            </div>

            <div class="form-group">
                <label>Data Prevista de Entrada <span class="required-indicator">*</span></label>
                <input type="date" class="form-control" id="reservar-data" required>
                <small style="display: block; margin-top: 4px; color: var(--text-light);">
                    ğŸ“… PrevisÃ£o de quando o paciente serÃ¡ internado
                </small>
            </div>

            <div class="form-group">
                <label>Tipo de Reserva</label>
                <select class="form-control" id="reservar-tipo">
                    <option value="matriciamento">Matriciamento (RegulaÃ§Ã£o)</option>
                    <option value="agendamento">Agendamento CirÃºrgico</option>
                    <option value="transferencia">TransferÃªncia</option>
                </select>
            </div>

            <div class="form-group">
                <label>ObservaÃ§Ãµes</label>
                <textarea class="form-control" id="reservar-observacoes" rows="3" placeholder="Ex: Paciente aguarda regulaÃ§Ã£o / Cirurgia programada para..."></textarea>
            </div>

            <button class="btn btn-warning" onclick="Reparticoes.confirmarReserva()">ğŸ“… Confirmar Reserva</button>
        </div>
    </div>

    <!-- MODAL DAR ALTA -->
    <div id="modalAlta" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>âœ… Dar Alta ao Paciente</h3>
                <button class="btn-close" onclick="Reparticoes.fecharModalAlta()">Ã—</button>
            </div>
            <input type="hidden" id="alta-reparticao-id">
            
            <div class="form-group">
                <label>Paciente</label>
                <input type="text" class="form-control" id="alta-paciente-nome" readonly>
            </div>

            <div class="form-group">
                <label>Data e Hora da Alta</label>
                <input type="datetime-local" class="form-control" id="alta-data" required>
            </div>

            <div class="form-group">
                <label>Tipo de Alta</label>
                <select class="form-control" id="alta-tipo" required>
                    <option value="clinica">Alta ClÃ­nica</option>
                    <option value="pedido">Alta a Pedido</option>
                    <option value="transferencia">TransferÃªncia</option>
                    <option value="obito">Ã“bito</option>
                </select>
            </div>

            <div class="form-group">
                <label>ObservaÃ§Ãµes</label>
                <textarea class="form-control" id="alta-observacoes" rows="3" placeholder="OrientaÃ§Ãµes e observaÃ§Ãµes sobre a alta..."></textarea>
            </div>

            <button class="btn btn-danger" onclick="Reparticoes.confirmarAlta()">âœ… Confirmar Alta</button>
        </div>
    </div>

    <!-- MODAL PROFISSIONAL -->
    <!-- MODAL PROFISSIONAL -->
    <div id="modalProfissional" class="modal">
        <div class="modal-content large" style="max-width: 900px;">
            <div class="modal-header">
                <h3 id="tituloModalProfissional">Novo Profissional</h3>
                <button class="btn-close" onclick="Profissionais.fecharModal()">Ã—</button>
            </div>
            <input type="hidden" id="edit-profissional-id">

            <!-- ABAS -->
            <div class="form-tabs">
                <button class="form-tab active" onclick="Profissionais.trocarAba(event, 'dados-pessoais')">ğŸ“‹ Dados Pessoais</button>
                <button class="form-tab" onclick="Profissionais.trocarAba(event, 'contato')">ğŸ“ Contato</button>
                <button class="form-tab" onclick="Profissionais.trocarAba(event, 'endereco')">ğŸ“ EndereÃ§o</button>
                <button class="form-tab" onclick="Profissionais.trocarAba(event, 'dados-profissionais')">ğŸ‘” Dados Profissionais</button>
            </div>

            <!-- ABA: DADOS PESSOAIS -->
            <div id="prof-aba-dados-pessoais" class="form-tab-content active">
                <div class="info-box">
                    â„¹ï¸ Campos marcados com <span class="required-indicator">*</span> sÃ£o obrigatÃ³rios
                </div>

                <div class="form-group">
                    <label>Nome Completo <span class="required-indicator">*</span></label>
                    <input type="text" class="form-control" id="prof-nome" required placeholder="Nome completo do profissional">
                </div>

                <div class="grid-3">
                    <div class="form-group">
                        <label>CPF <span class="required-indicator">*</span></label>
                        <input type="text" class="form-control" id="prof-cpf" required placeholder="000.000.000-00" maxlength="14">
                    </div>
                    <div class="form-group">
                        <label>RG</label>
                        <input type="text" class="form-control" id="prof-rg" placeholder="00.000.000-0">
                    </div>
                    <div class="form-group">
                        <label>Data de Nascimento</label>
                        <input type="date" class="form-control" id="prof-nascimento">
                    </div>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Sexo</label>
                        <select class="form-control" id="prof-sexo">
                            <option value="">Selecione...</option>
                            <option value="M">Masculino</option>
                            <option value="F">Feminino</option>
                            <option value="I">Intersexo</option>
                            <option value="N">NÃ£o informado</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Estado Civil</label>
                        <select class="form-control" id="prof-estado-civil">
                            <option value="">Selecione...</option>
                            <option value="solteiro">Solteiro(a)</option>
                            <option value="casado">Casado(a)</option>
                            <option value="divorciado">Divorciado(a)</option>
                            <option value="viuvo">ViÃºvo(a)</option>
                            <option value="uniao_estavel">UniÃ£o EstÃ¡vel</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Naturalidade</label>
                    <input type="text" class="form-control" id="prof-naturalidade" 
                           placeholder="Ex: SÃ£o Paulo/SP, Belo Horizonte/MG">
                </div>

                <div class="form-group">
                    <label>Cor/RaÃ§a</label>
                    <select class="form-control" id="prof-cor-raca">
                        <option value="">Selecione...</option>
                        <option value="branca">Branca</option>
                        <option value="preta">Preta</option>
                        <option value="parda">Parda</option>
                        <option value="amarela">Amarela</option>
                        <option value="indigena">IndÃ­gena</option>
                        <option value="nao_informado">NÃ£o informado</option>
                    </select>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Tipo SanguÃ­neo</label>
                        <select class="form-control" id="prof-tipo-sanguineo">
                            <option value="">Selecione...</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Fator RH</label>
                        <select class="form-control" id="prof-fator-rh">
                            <option value="">Selecione...</option>
                            <option value="positivo">Positivo (+)</option>
                            <option value="negativo">Negativo (-)</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Alergias Conhecidas</label>
                    <textarea class="form-control" id="prof-alergias" rows="2" 
                              placeholder="Descreva alergias a medicamentos, alimentos, etc"></textarea>
                </div>
            </div>

            <!-- ABA: CONTATO -->
            <div id="prof-aba-contato" class="form-tab-content">
                <div class="grid-2">
                    <div class="form-group">
                        <label>Telefone</label>
                        <input type="text" class="form-control" id="prof-telefone" placeholder="(00) 0000-0000" maxlength="15">
                    </div>
                    <div class="form-group">
                        <label>Celular</label>
                        <input type="text" class="form-control" id="prof-celular" placeholder="(00) 00000-0000" maxlength="16">
                    </div>
                </div>

                <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" id="prof-email" placeholder="profissional@email.com">
                </div>
            </div>

            <!-- ABA: ENDEREÃ‡O -->
            <div id="prof-aba-endereco" class="form-tab-content">
                <div class="form-group">
                    <label>CEP</label>
                    <div class="field-with-search">
                        <input type="text" class="form-control" id="prof-cep" placeholder="00000-000" maxlength="9" onblur="Profissionais.buscarCEP()">
                        <button type="button" class="btn btn-info" onclick="Profissionais.buscarCEP()">ğŸ” Buscar</button>
                    </div>
                </div>

                <div class="grid-3">
                    <div class="form-group" style="grid-column: span 2;">
                        <label>Logradouro</label>
                        <input type="text" class="form-control" id="prof-logradouro" placeholder="Rua, Avenida...">
                    </div>
                    <div class="form-group">
                        <label>NÃºmero</label>
                        <input type="text" class="form-control" id="prof-numero" placeholder="123">
                    </div>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Complemento</label>
                        <input type="text" class="form-control" id="prof-complemento" placeholder="Apto, Bloco...">
                    </div>
                    <div class="form-group">
                        <label>Bairro</label>
                        <input type="text" class="form-control" id="prof-bairro">
                    </div>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Cidade</label>
                        <input type="text" class="form-control" id="prof-cidade">
                    </div>
                    <div class="form-group">
                        <label>Estado</label>
                        <select class="form-control" id="prof-uf">
                            <option value="">Selecione...</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">AmapÃ¡</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">CearÃ¡</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">EspÃ­rito Santo</option>
                            <option value="GO">GoiÃ¡s</option>
                            <option value="MA">MaranhÃ£o</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">ParÃ¡</option>
                            <option value="PB">ParaÃ­ba</option>
                            <option value="PR">ParanÃ¡</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">PiauÃ­</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">RondÃ´nia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">SÃ£o Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- ABA: DADOS PROFISSIONAIS -->
            <div id="prof-aba-dados-profissionais" class="form-tab-content">
                <div class="form-group">
                    <label>Categoria Profissional <span class="required-indicator">*</span></label>
                    <select class="form-control" id="prof-categoria" required>
                        <option value="">Selecione...</option>
                        <!-- OpÃ§Ãµes carregadas dinamicamente do pool -->
                    </select>
                    <small style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ Apenas profissionais de saÃºde (mÃ©dico, enfermeiro, etc) podem acessar prontuÃ¡rios
                        <br>ğŸ’¡ Para gerenciar categorias, acesse: <strong>Estabelecimento â†’ Pools â†’ Categorias Profissionais</strong>
                    </small>
                </div>

                <div class="form-group">
                    <label>CRM/Registro <span class="required-indicator">*</span></label>
                    <input type="text" class="form-control" id="prof-registro" required placeholder="Ex: CRM 12345">
                </div>

                <!-- Cargos MÃºltiplos (v10.55) -->
                <div class="form-group">
                    <label>Cargo/FunÃ§Ã£o <span class="required-indicator">*</span></label>
                    <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                        <select class="form-control" id="prof-cargo-select" style="flex: 1;">
                            <option value="">Selecione um cargo...</option>
                            <!-- OpÃ§Ãµes carregadas dinamicamente do pool -->
                        </select>
                        <button type="button" class="btn btn-secondary" onclick="Profissionais.adicionarCargo()">
                            â• Adicionar
                        </button>
                    </div>
                    <div id="prof-cargos-lista" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                        <!-- Cargos aparecerÃ£o aqui como chips -->
                    </div>
                    <small style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ O primeiro cargo adicionado serÃ¡ considerado o principal
                        <br>ğŸ’¡ Para adicionar novos cargos ao pool, acesse: <strong>Estabelecimento â†’ Pools â†’ Cargos</strong>
                    </small>
                    <input type="hidden" id="prof-cargos-hidden" value="">
                </div>

                <!-- Especialidades MÃºltiplas -->
                <div class="form-group">
                    <label>Especialidades <span class="required-indicator">*</span></label>
                    <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                        <select class="form-control" id="prof-especialidade-select" style="flex: 1;">
                            <option value="">Selecione uma especialidade...</option>
                            <!-- OpÃ§Ãµes carregadas dinamicamente do pool -->
                        </select>
                        <button type="button" class="btn btn-secondary" onclick="Profissionais.adicionarEspecialidade()">
                            â• Adicionar
                        </button>
                    </div>
                    <div id="prof-especialidades-lista" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                        <!-- Especialidades aparecerÃ£o aqui como chips -->
                    </div>
                    <small style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ A primeira especialidade adicionada serÃ¡ considerada a principal
                        <br>ğŸ’¡ Para adicionar novas especialidades ao pool, acesse: <strong>Estabelecimento â†’ Pools â†’ Especialidades</strong>
                    </small>
                    <input type="hidden" id="prof-especialidades-hidden" value="">
                </div>

                <!-- RepartiÃ§Ãµes MÃºltiplas -->
                <div class="form-group">
                    <label>RepartiÃ§Ãµes/Setores de Trabalho</label>
                    <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                        <select class="form-control" id="prof-reparticao-select" style="flex: 1;">
                            <option value="">Selecione uma repartiÃ§Ã£o...</option>
                        </select>
                        <button type="button" class="btn btn-secondary" onclick="Profissionais.adicionarReparticao()">
                            â• Adicionar
                        </button>
                    </div>
                    <div id="prof-reparticoes-lista" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                        <!-- RepartiÃ§Ãµes aparecerÃ£o aqui como chips -->
                    </div>
                    <small style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ Profissional pode trabalhar em mÃºltiplas repartiÃ§Ãµes/setores
                    </small>
                    <input type="hidden" id="prof-reparticoes-hidden" value="">
                </div>
            </div>

            <button class="btn btn-primary" onclick="Profissionais.salvar()">ğŸ’¾ Salvar</button>
        </div>
    </div>

    <!-- MODAL ESCALA -->
    <div id="modalEscala" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 id="tituloModalEscala">â• Nova Escala</h3>
                <button class="btn-close" onclick="Escalas.fecharModal()">Ã—</button>
            </div>
            <input type="hidden" id="edit-escala-id">

            <div class="info-box" style="margin-bottom: 20px;">
                â„¹ï¸ Escalas definem quando um profissional estÃ¡ disponÃ­vel em uma repartiÃ§Ã£o especÃ­fica. 
                O profissional pode ter mÃºltiplas escalas em diferentes locais e horÃ¡rios.
            </div>

            <!-- Profissional e Especialidade -->
            <div class="form-group">
                <label>Profissional <span class="required-indicator">*</span></label>
                <select class="form-control" id="escala-profissional" required onchange="Escalas.atualizarEspecialidades()">
                    <option value="">Selecione o profissional...</option>
                </select>
            </div>

            <div class="form-group">
                <label>Especialidade <span class="required-indicator">*</span></label>
                <select class="form-control" id="escala-especialidade" required>
                    <option value="">Selecione o profissional primeiro...</option>
                </select>
                <small style="display: block; margin-top: 4px; color: var(--text-light);">
                    â„¹ï¸ SerÃ£o mostradas apenas as especialidades deste profissional
                </small>
            </div>

            <!-- RepartiÃ§Ã£o -->
            <div class="form-group">
                <label>RepartiÃ§Ã£o <span class="required-indicator">*</span></label>
                <select class="form-control" id="escala-reparticao" required>
                    <option value="">Selecione a repartiÃ§Ã£o...</option>
                </select>
            </div>

            <!-- Tipo de Escala -->
            <div class="form-group">
                <label>Tipo de Escala <span class="required-indicator">*</span></label>
                <select class="form-control" id="escala-tipo" required>
                    <option value="">Selecione...</option>
                    <option value="fixa">Fixa (Regular)</option>
                    <option value="plantao">PlantÃ£o</option>
                    <option value="eventual">Eventual</option>
                </select>
            </div>

            <!-- Dias da Semana -->
            <div class="form-group">
                <label>Dias da Semana <span class="required-indicator">*</span></label>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 8px;">
                    <label class="checkbox-label">
                        <input type="checkbox" class="dia-semana" value="seg"> Segunda
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" class="dia-semana" value="ter"> TerÃ§a
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" class="dia-semana" value="qua"> Quarta
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" class="dia-semana" value="qui"> Quinta
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" class="dia-semana" value="sex"> Sexta
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" class="dia-semana" value="sab"> SÃ¡bado
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" class="dia-semana" value="dom"> Domingo
                    </label>
                </div>
            </div>

            <!-- HorÃ¡rios -->
            <div class="grid-2">
                <div class="form-group">
                    <label>HorÃ¡rio InÃ­cio <span class="required-indicator">*</span></label>
                    <input type="time" class="form-control" id="escala-horario-inicio" required>
                </div>
                <div class="form-group">
                    <label>HorÃ¡rio Fim <span class="required-indicator">*</span></label>
                    <input type="time" class="form-control" id="escala-horario-fim" required>
                </div>
            </div>

            <!-- PerÃ­odo de VigÃªncia -->
            <div class="grid-2">
                <div class="form-group">
                    <label>Data InÃ­cio <span class="required-indicator">*</span></label>
                    <input type="date" class="form-control" id="escala-data-inicio" required>
                </div>
                <div class="form-group">
                    <label>Data Fim</label>
                    <input type="date" class="form-control" id="escala-data-fim">
                    <small style="display: block; margin-top: 4px; color: var(--text-light);">
                        â„¹ï¸ Deixe vazio para escala indeterminada
                    </small>
                </div>
            </div>

            <!-- ObservaÃ§Ãµes -->
            <div class="form-group">
                <label>ObservaÃ§Ãµes</label>
                <textarea class="form-control" id="escala-observacoes" rows="2" 
                          placeholder="ObservaÃ§Ãµes sobre esta escala (opcional)"></textarea>
            </div>

            <button class="btn btn-primary" onclick="Escalas.salvar()">ğŸ’¾ Salvar Escala</button>
        </div>
    </div>

    <!-- MODAL PACIENTE -->
    <div id="modalPaciente" class="modal">
        <div class="modal-content large" style="max-width: 900px;">
            <div class="modal-header">
                <h3 id="tituloModalPaciente">Novo Paciente</h3>
                <button class="btn-close" onclick="Pacientes.fecharModal()">Ã—</button>
            </div>
            <input type="hidden" id="edit-paciente-id">

            <!-- ABAS -->
            <div class="form-tabs">
                <button class="form-tab active" onclick="Pacientes.trocarAba(event, 'dados-pessoais')">ğŸ“‹ Dados Pessoais</button>
                <button class="form-tab" onclick="Pacientes.trocarAba(event, 'contato')">ğŸ“ Contato</button>
                <button class="form-tab" onclick="Pacientes.trocarAba(event, 'endereco')">ğŸ“ EndereÃ§o</button>
                <button class="form-tab" onclick="Pacientes.trocarAba(event, 'dados-medicos')">ğŸ¥ Dados MÃ©dicos</button>
            </div>

            <!-- ABA: DADOS PESSOAIS -->
            <div id="aba-dados-pessoais" class="form-tab-content active">
                <div class="info-box">
                    â„¹ï¸ Campos marcados com <span class="required-indicator">*</span> sÃ£o obrigatÃ³rios
                </div>

                <div class="form-group">
                    <label>Nome Completo <span class="required-indicator">*</span></label>
                    <input type="text" class="form-control" id="pac-nome" required placeholder="Nome completo do paciente">
                </div>

                <!-- v10.346: Nome Social (FHEMIG) -->
                <div class="form-group">
                    <label>Nome Social</label>
                    <input type="text" class="form-control" id="pac-nome-social" placeholder="Nome social (se diferente do nome civil)">
                    <small style="color: var(--text-light); display: block; margin-top: 4px; font-size: 11px;">
                        â„¹ï¸ Para pessoas trans ou que usam outro nome no dia a dia
                    </small>
                </div>

                <div class="form-section">
                    <div class="form-section-title">Sexo <span class="required-indicator">*</span></div>
                    <input type="hidden" id="pac-sexo" required>
                    <div class="sexo-selector" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                        <div class="sexo-option masculino" onclick="Pacientes.selecionarSexo('M')">
                            <div class="sexo-icon">â™‚ï¸</div>
                            <div class="sexo-label">Masculino</div>
                        </div>
                        <div class="sexo-option feminino" onclick="Pacientes.selecionarSexo('F')">
                            <div class="sexo-icon">â™€ï¸</div>
                            <div class="sexo-label">Feminino</div>
                        </div>
                        <div class="sexo-option intersexo" onclick="Pacientes.selecionarSexo('I')" style="border-color: #9333ea;">
                            <div class="sexo-icon">âš¥</div>
                            <div class="sexo-label">Intersexo</div>
                        </div>
                        <div class="sexo-option nao-informado" onclick="Pacientes.selecionarSexo('N')" style="border-color: #64748b;">
                            <div class="sexo-icon">â“</div>
                            <div class="sexo-label">NÃ£o informado</div>
                        </div>
                    </div>
                </div>

                <!-- SEÃ‡ÃƒO DE DOCUMENTOS -->
                <div class="form-section">
                    <div class="form-section-title">DocumentaÃ§Ã£o</div>
                    
                    <!-- CHECKBOXES DE TIPO -->
                    <div style="display: flex; gap: 24px; margin-bottom: 16px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="pac-estrangeiro-doc" onchange="Pacientes.toggleTipoDocumento()" 
                                   style="width: 18px; height: 18px;">
                            <span>Estrangeiro</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="pac-doc-provisorio" onchange="Pacientes.toggleTipoDocumento()" 
                                   style="width: 18px; height: 18px;">
                            <span>Documento ProvisÃ³rio (NÃ£o Identificado)</span>
                        </label>
                    </div>
                    
                    <!-- ID TEMPORÃRIO (aparece quando Documento ProvisÃ³rio marcado) -->
                    <div id="pac-id-provisorio-container" style="display: none; margin-bottom: 16px;">
                        <div class="alert" style="background: #f9fafb; border-color: #fbbf24; color: #92400e;">
                            <strong>ğŸ†” ID TemporÃ¡rio:</strong> <span id="pac-id-temp" style="font-family: monospace; font-size: 15px;"></span>
                            <br><small>Este ID serÃ¡ substituÃ­do quando o paciente for identificado</small>
                        </div>
                    </div>
                    
                    <div class="grid-3">
                        <!-- CPF (BRASILEIRO) -->
                        <div class="form-group" id="pac-cpf-group">
                            <label>CPF <span class="required-indicator" id="pac-cpf-required">*</span></label>
                            <input type="text" class="form-control" id="pac-cpf" placeholder="000.000.000-00" maxlength="14">
                        </div>
                        
                        <!-- PASSAPORTE (ESTRANGEIRO) -->
                        <div class="form-group" id="pac-passaporte-group" style="display: none;">
                            <label>Passaporte <span class="required-indicator">*</span></label>
                            <input type="text" class="form-control" id="pac-passaporte" placeholder="NÃºmero do passaporte">
                        </div>
                        
                        <!-- RNE (ESTRANGEIRO RESIDENTE) -->
                        <div class="form-group" id="pac-rne-group" style="display: none;">
                            <label>RNE (Registro Nacional de Estrangeiro)</label>
                            <input type="text" class="form-control" id="pac-rne" placeholder="NÃºmero do RNE">
                            <small style="display: block; margin-top: 4px; color: var(--text-light); font-size: 11px;">
                                â„¹ï¸ Ou informe o Passaporte acima
                            </small>
                        </div>
                        
                        <!-- RG -->
                        <div class="form-group" id="pac-rg-group">
                            <label>RG</label>
                            <input type="text" class="form-control" id="pac-rg" placeholder="00.000.000-0">
                        </div>
                        
                        <!-- DATA DE NASCIMENTO -->
                        <div class="form-group">
                            <label>Data de Nascimento <span class="required-indicator">*</span></label>
                            <input type="date" class="form-control" id="pac-nascimento" required onchange="Pacientes.atualizarDisplayIdade()">
                        </div>
                    </div>
                    
                    <!-- HIDDEN FIELDS PARA CONTROLE -->
                    <input type="hidden" id="pac-tipo-documento">
                    <input type="hidden" id="pac-numero-documento">
                    <input type="hidden" id="pac-prontuario">
                </div>

                <div id="pac-idade-info" style="display: none; margin-top: -8px; margin-bottom: 16px;">
                    <span class="idade-display" id="pac-idade-display"></span>
                    <span class="categoria-etaria" id="pac-categoria-display"></span>
                </div>

                <div class="form-group">
                    <label>Cor/RaÃ§a</label>
                    <select class="form-control" id="pac-cor-raca">
                        <option value="">Selecione...</option>
                        <option value="branca">Branca</option>
                        <option value="preta">Preta</option>
                        <option value="parda">Parda</option>
                        <option value="amarela">Amarela</option>
                        <option value="indigena">IndÃ­gena</option>
                        <option value="nao_informado">NÃ£o informado</option>
                    </select>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Estado Civil</label>
                        <select class="form-control" id="pac-estado-civil">
                            <option value="">Selecione...</option>
                            <option value="solteiro">Solteiro(a)</option>
                            <option value="casado">Casado(a)</option>
                            <option value="divorciado">Divorciado(a)</option>
                            <option value="viuvo">ViÃºvo(a)</option>
                            <option value="uniao_estavel">UniÃ£o EstÃ¡vel</option>
                            <option value="nao_informado">NÃ£o informado</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Naturalidade</label>
                        <input type="text" class="form-control" id="pac-naturalidade" 
                               placeholder="Cidade - UF">
                    </div>
                </div>

                <!-- NOME DA MÃƒE E DO PAI -->
                <div class="form-section">
                    <div class="form-section-title">FiliaÃ§Ã£o</div>
                    <div class="grid-2">
                        <div class="form-group">
                            <label>Nome da MÃ£e</label>
                            <input type="text" class="form-control" id="pac-nome-mae" 
                                   placeholder="Nome completo da mÃ£e">
                        </div>
                        <div class="form-group">
                            <label>Nome do Pai</label>
                            <input type="text" class="form-control" id="pac-nome-pai" 
                                   placeholder="Nome completo do pai">
                        </div>
                    </div>
                </div>

                <!-- PROFISSÃƒO E SITUAÃ‡ÃƒO -->
                <div class="form-section">
                    <div class="form-section-title">Dados Profissionais e VÃ­nculo</div>
                    <div class="grid-2">
                        <div class="form-group">
                            <label>ProfissÃ£o/OcupaÃ§Ã£o</label>
                            <input type="text" class="form-control" id="pac-profissao" 
                                   placeholder="Ex: Estudante, Aposentado, AutÃ´nomo">
                        </div>
                        <div class="form-group">
                            <label>SituaÃ§Ã£o/VÃ­nculo</label>
                            <select class="form-control" id="pac-situacao-vinculo">
                                <option value="">Selecione...</option>
                                <option value="servidor">Servidor PÃºblico</option>
                                <option value="dependente">Dependente</option>
                                <option value="estudante">Estudante</option>
                                <option value="autonomo">AutÃ´nomo</option>
                                <option value="empregado">Empregado CLT</option>
                                <option value="aposentado">Aposentado</option>
                                <option value="desempregado">Desempregado</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- DADOS ADICIONAIS -->
                <div class="form-group">
                    <label>Dados Adicionais</label>
                    <textarea class="form-control" id="pac-dados-adicionais" rows="2"
                              placeholder="InformaÃ§Ãµes complementares sobre o paciente"></textarea>
                </div>
            </div>

            <!-- ABA: CONTATO -->
            <div id="aba-contato" class="form-tab-content">
                <div class="grid-2">
                    <div class="form-group">
                        <label>Telefone Principal <span class="required-indicator">*</span></label>
                        <input type="text" class="form-control" id="pac-telefone" required placeholder="(00) 0000-0000" maxlength="15">
                    </div>
                    <div class="form-group">
                        <label>Celular</label>
                        <input type="text" class="form-control" id="pac-celular" placeholder="(00) 00000-0000" maxlength="16">
                    </div>
                </div>

                <div class="form-group">
                    <label>Email</label>
                    <input type="email" class="form-control" id="pac-email" placeholder="paciente@email.com">
                </div>

                <!-- TIPO DE CONTATO -->
                <div class="grid-2">
                    <div class="form-group">
                        <label>Tipo de Contato</label>
                        <select class="form-control" id="pac-tipo-contato" onchange="Pacientes.toggleComentarioContato()">
                            <option value="direto">Direto</option>
                            <option value="indireto">Indireto</option>
                        </select>
                    </div>
                    <div class="form-group" id="pac-comentario-contato-group" style="display: none;">
                        <label>ComentÃ¡rio (Contato Indireto)</label>
                        <input type="text" class="form-control" id="pac-comentario-contato" 
                               placeholder="Ex: Recado com vizinho">
                    </div>
                </div>

                <div class="form-section">
                    <div class="form-section-title">Contato de EmergÃªncia</div>
                    <div class="grid-2">
                        <div class="form-group">
                            <label>Nome do Contato</label>
                            <input type="text" class="form-control" id="pac-contato-emergencia-nome" placeholder="Nome completo">
                        </div>
                        <div class="form-group">
                            <label>Parentesco</label>
                            <input type="text" class="form-control" id="pac-contato-emergencia-parentesco" placeholder="Ex: MÃ£e, Pai, CÃ´njuge">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Telefone de EmergÃªncia</label>
                        <input type="text" class="form-control" id="pac-telefone-emergencia" placeholder="(00) 00000-0000" maxlength="16">
                    </div>
                </div>
            </div>

            <!-- ABA: ENDEREÃ‡O -->
            <div id="aba-endereco" class="form-tab-content">
                <!-- CHECKBOXES ESPECIAIS -->
                <div class="grid-2">
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="pac-estrangeiro" onchange="Pacientes.togglePaisEstrangeiro()">
                            Estrangeiro
                        </label>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="pac-sem-endereco-fixo">
                            Sem EndereÃ§o Fixo Formal
                        </label>
                    </div>
                </div>

                <!-- PAÃS (se estrangeiro) -->
                <div class="form-group" id="pac-pais-group" style="display: none;">
                    <label>PaÃ­s</label>
                    <input type="text" class="form-control" id="pac-pais" placeholder="Ex: Argentina, Portugal">
                </div>

                <div class="form-group">
                    <label>CEP</label>
                    <div class="field-with-search">
                        <input type="text" class="form-control" id="pac-cep" placeholder="00000-000" maxlength="9" onblur="Pacientes.buscarCEP()">
                        <button type="button" class="btn btn-info" onclick="Pacientes.buscarCEP()">ğŸ” Buscar</button>
                    </div>
                </div>

                <div class="grid-3">
                    <div class="form-group">
                        <label>Tipo Logradouro</label>
                        <select class="form-control" id="pac-tipo-logradouro">
                            <option value="">Selecione...</option>
                            <option value="rua">Rua</option>
                            <option value="avenida">Avenida</option>
                            <option value="travessa">Travessa</option>
                            <option value="alameda">Alameda</option>
                            <option value="praca">PraÃ§a</option>
                            <option value="rodovia">Rodovia</option>
                            <option value="estrada">Estrada</option>
                            <option value="viela">Viela</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Logradouro</label>
                        <input type="text" class="form-control" id="pac-logradouro" placeholder="Nome da rua, avenida...">
                    </div>
                    <div class="form-group">
                        <label>NÃºmero</label>
                        <input type="text" class="form-control" id="pac-numero" placeholder="123">
                    </div>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Complemento</label>
                        <input type="text" class="form-control" id="pac-complemento" placeholder="Apto, Bloco...">
                    </div>
                    <div class="form-group">
                        <label>Bairro</label>
                        <input type="text" class="form-control" id="pac-bairro">
                    </div>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Cidade</label>
                        <input type="text" class="form-control" id="pac-cidade">
                    </div>
                    <div class="form-group">
                        <label>Estado</label>
                        <select class="form-control" id="pac-estado">
                            <option value="">Selecione...</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">AmapÃ¡</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">CearÃ¡</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">EspÃ­rito Santo</option>
                            <option value="GO">GoiÃ¡s</option>
                            <option value="MA">MaranhÃ£o</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">ParÃ¡</option>
                            <option value="PB">ParaÃ­ba</option>
                            <option value="PR">ParanÃ¡</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">PiauÃ­</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">RondÃ´nia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">SÃ£o Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                    </div>
                </div>

                <!-- v10.39: REGIONAL DE SAÃšDE -->
                <div class="form-group" style="margin-top: 16px;">
                    <label>ğŸ“ Regional de SaÃºde</label>
                    <select class="form-control" id="pac-regional-saude">
                        <option value="">Selecione...</option>
                    </select>
                    <small style="color: var(--text-light); display: block; margin-top: 4px;">
                        ğŸ’¡ Regional de saÃºde relacionada ao endereÃ§o do paciente
                    </small>
                </div>
            </div>

            <!-- ABA: DADOS MÃ‰DICOS -->
            <div id="aba-dados-medicos" class="form-tab-content">
                <div class="grid-2">
                    <div class="form-group">
                        <label>Tipo SanguÃ­neo</label>
                        <select class="form-control" id="pac-tipo-sanguineo">
                            <option value="">NÃ£o informado</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Alergias</label>
                        <input type="text" class="form-control" id="pac-alergias" placeholder="Ex: Penicilina, Dipirona">
                    </div>
                </div>

                <!-- âœ… v10.58: MODALIDADE DE ATENDIMENTO -->
                <div class="form-section">
                    <div class="form-section-title">Modalidade de Atendimento</div>
                    
                    <div class="form-group">
                        <label style="font-weight: 600; margin-bottom: 12px; display: block;">
                            Modalidade Principal <span class="required-indicator">*</span>
                        </label>
                        <div id="pac-modalidades-container" style="display: grid; gap: 12px; padding: 12px; background: var(--bg); border-radius: 8px; border: 1px solid var(--border);">
                            <!-- Radios carregados dinamicamente via JavaScript -->
                        </div>
                        <small style="display: block; margin-top: 8px; color: var(--text-light); font-size: 12px;">
                            â„¹ï¸ Define como este paciente serÃ¡ atendido
                        </small>
                    </div>
                </div>

                <div class="form-section">
                    <div class="form-section-title">ConvÃªnio / Plano de SaÃºde</div>
                    
                    <!-- v10.60.6: CAMPOS OBRIGATÃ“RIOS SOMENTE SE MODALIDADE = CONVÃŠNIO -->
                    <div class="form-group">
                        <label>
                            Nome do ConvÃªnio
                            <span id="pac-convenio-required" class="required-indicator" style="display: none;">*</span>
                        </label>
                        <select class="form-control" id="pac-convenio" onchange="Pacientes.toggleCNS()">
                            <option value="">Selecione...</option>
                            <!-- OpÃ§Ãµes carregadas dinamicamente do pool -->
                        </select>
                        <small style="display: block; margin-top: 4px; color: var(--text-light); font-size: 12px;">
                            â„¹ï¸ ObrigatÃ³rio apenas se modalidade for "ConvÃªnio"
                        </small>
                    </div>
                    
                    <!-- CARTEIRINHA E VALIDADE LADO A LADO -->
                    <div class="grid-2">
                        <div class="form-group">
                            <label>
                                NÃºmero da Carteirinha
                                <span id="pac-carteirinha-required" class="required-indicator" style="display: none;">*</span>
                            </label>
                            <input type="text" class="form-control" id="pac-num-carteirinha" placeholder="NÃºmero da carteirinha">
                        </div>
                        <div class="form-group">
                            <label>
                                Validade do Plano
                                <span id="pac-validade-required" class="required-indicator" style="display: none;">*</span>
                            </label>
                            <input type="date" class="form-control" id="pac-validade-plano">
                        </div>
                    </div>
                    
                    <!-- âœ… v10.8: CNS - SÃ“ APARECE PARA CONVÃŠNIO SUS -->
                    <div class="form-group" id="pac-cns-group" style="display: none;">
                        <label>CNS (CartÃ£o Nacional de SaÃºde)</label>
                        <input type="text" class="form-control" id="pac-cns" 
                               placeholder="000 0000 0000 0000" maxlength="18"
                               onblur="Pacientes.validarCNS()">
                        <div id="pac-cns-validacao" style="margin-top: 4px; font-size: 12px;"></div>
                        <small style="display: block; margin-top: 4px; color: var(--text-light); font-size: 11px;">
                            â„¹ï¸ Se disponÃ­vel, informe o CNS do paciente
                        </small>
                    </div>
                </div>

                <div class="form-group">
                    <label>ObservaÃ§Ãµes MÃ©dicas</label>
                    <textarea class="form-control" id="pac-observacoes" rows="4" placeholder="CondiÃ§Ãµes prÃ©-existentes, medicamentos em uso, observaÃ§Ãµes importantes..."></textarea>
                </div>
            </div>

            <!-- BOTÃ•ES -->
            <div style="display: flex; gap: 12px; margin-top: 24px; padding-top: 20px; border-top: 2px solid var(--border);">
                <button class="btn btn-primary" onclick="Pacientes.salvar()" style="flex: 1;">ğŸ’¾ Salvar Paciente</button>
                <button class="btn btn-secondary" onclick="Pacientes.fecharModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- MODAL AGENDAMENTO -->
    <div id="modalAgendamento" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="tituloModalAgendamento">Novo Agendamento</h3>
                <button class="btn-close" onclick="Agenda.fecharModal()">Ã—</button>
            </div>
            <input type="hidden" id="edit-agendamento-id">
            <div class="form-group">
                <label>Paciente *</label>
                <select class="form-control" id="agend-paciente" required></select>
                <button type="button" class="btn btn-secondary" onclick="Agenda.abrirPreCadastroAgenda()" 
                        style="margin-top: 8px; width: 100%; background: #10b981; border-color: #10b981;">
                    â• PrÃ©-Cadastro RÃ¡pido (Paciente Novo)
                </button>
            </div>
            <div class="form-group">
                <label>Profissional *</label>
                <select class="form-control" id="agend-profissional" required></select>
            </div>
            <div class="form-group">
                <label>Tipo de Atendimento *</label>
                <select class="form-control" id="agend-tipo" onchange="Agenda.filtrarUnidadesPorTipo()">
                    <!-- v10.61: Carregado dinamicamente do pool tiposAtendimento -->
                </select>
                <small style="display: block; margin-top: 4px; color: var(--text-light);">
                    â„¹ï¸ As unidades disponÃ­veis abaixo mudam conforme o tipo selecionado
                </small>
            </div>
            <div class="form-group">
                <label>Unidade/Local *</label>
                <select class="form-control" id="agend-reparticao" required onchange="Agenda.calcularTempoTotal()"></select>
            </div>
            <div class="grid-2">
                <div class="form-group">
                    <label>Data *</label>
                    <input type="date" class="form-control" id="agend-data" required>
                </div>
                <div class="form-group">
                    <label>HorÃ¡rio *</label>
                    <input type="time" class="form-control" id="agend-hora" required>
                </div>
            </div>
            <div class="grid-2">
                <div class="form-group">
                    <label>DuraÃ§Ã£o (minutos)</label>
                    <input type="number" class="form-control" id="agend-duracao" value="30" min="15" max="480" step="15" onchange="Agenda.calcularTempoTotal()">
                </div>
                <div class="form-group">
                    <label>Tempo de Preparo (minutos)</label>
                    <input type="number" class="form-control" id="agend-tempo-preparo" value="10" min="0" max="120" step="5" onchange="Agenda.calcularTempoTotal()">
                    <small style="display: block; margin-top: 4px; color: var(--text-light); font-size: 11px;">
                        ğŸ”§ Tempo para preparar a sala (ajustÃ¡vel)
                    </small>
                </div>
            </div>
            <div id="agend-info-preparo" style="display: none; background: #f9fafb; padding: 12px; border-radius: 8px; margin-bottom: 16px; border: 1px solid #bae6fd;">
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                    <strong style="color: #0284c7;">ğŸ“Š DuraÃ§Ã£o Total Calculada</strong>
                </div>
                <div style="display: flex; gap: 16px; font-size: 14px; color: var(--text);">
                    <div>
                        â±ï¸ DuraÃ§Ã£o: <strong id="agend-display-duracao">30min</strong>
                    </div>
                    <div>
                        ğŸ”§ Preparo: <strong id="agend-display-preparo">10min</strong>
                    </div>
                    <div style="color: #0284c7;">
                        ğŸ“Š Total: <strong id="agend-display-total">40min</strong>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label>ObservaÃ§Ãµes</label>
                <textarea class="form-control" id="agend-obs" rows="3"></textarea>
            </div>
            <button class="btn btn-primary" onclick="Agenda.salvar()">ğŸ’¾ Salvar</button>
        </div>
    </div>

    <!-- MODAL PRÃ‰-CADASTRO RÃPIDO -->
    <div id="modalPreCadastro" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>ğŸš€ PrÃ©-Cadastro RÃ¡pido</h3>
                <button class="btn-close" onclick="PreCadastro.fechar()">Ã—</button>
            </div>
            <div class="info-box" style="background: #f9fafb; border-color: #fbbf24; margin-bottom: 16px;">
                <strong>âš¡ Cadastro RÃ¡pido</strong><br>
                Preencha apenas os dados essenciais. O cadastro completo pode ser feito depois.
            </div>
            <div class="form-group">
                <label>Nome Completo <span class="required-indicator">*</span></label>
                <input type="text" class="form-control" id="pre-nome" required placeholder="Nome completo do paciente">
            </div>
            <div class="form-group">
                <label>Telefone <span class="required-indicator">*</span></label>
                <input type="text" class="form-control" id="pre-telefone" required placeholder="(00) 00000-0000" maxlength="16"
                       oninput="this.value = this.value.replace(/\D/g, '').replace(/^(\d{2})(\d)/g, '($1) $2').replace(/(\d{5})(\d)/, '$1-$2')">
            </div>
            <div class="form-group">
                <label>Data de Nascimento</label>
                <input type="date" class="form-control" id="pre-nascimento">
                <small style="display: block; margin-top: 4px; color: var(--text-light);">
                    â„¹ï¸ Opcional, mas recomendado para cÃ¡lculo de idade
                </small>
            </div>
            <button class="btn btn-primary" onclick="PreCadastro.salvar()">ğŸ’¾ Salvar e Continuar</button>
        </div>
    </div>

    <!-- MODAL CAMPO DE COLETA -->
    <div id="modalCampoColeta" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="tituloModalCampoColeta">Novo Campo de Coleta</h3>
                <button class="btn-close" onclick="ColetaDados.fecharModalCampo()">Ã—</button>
            </div>
            <input type="hidden" id="edit-campo-id">
            <div class="form-group">
                <label>Nome do Campo</label>
                <input type="text" class="form-control" id="campo-nome" placeholder="Ex: Nome Completo, CPF, Data de AdmissÃ£o">
            </div>
            <div class="form-group">
                <label>Tipo do Campo</label>
                <select class="form-control" id="campo-tipo">
                    <option value="texto">Texto</option>
                    <option value="numero">NÃºmero</option>
                    <option value="data">Data</option>
                    <option value="email">E-mail</option>
                    <option value="telefone">Telefone</option>
                    <option value="cpf">CPF</option>
                    <option value="textarea">Texto Longo</option>
                    <option value="select">Lista de OpÃ§Ãµes</option>
                </select>
            </div>
            <div class="form-group" id="campo-opcoes-group" style="display: none;">
                <label>OpÃ§Ãµes (separadas por vÃ­rgula)</label>
                <input type="text" class="form-control" id="campo-opcoes" placeholder="Ex: OpÃ§Ã£o 1, OpÃ§Ã£o 2, OpÃ§Ã£o 3">
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="campo-obrigatorio">
                    Campo obrigatÃ³rio
                </label>
            </div>
            <button class="btn btn-primary" onclick="ColetaDados.salvarCampo()">ğŸ’¾ Salvar Campo</button>
        </div>
    </div>

    <!-- MODAL PRONTUÃRIO ELETRÃ”NICO -->
    <div id="modalProntuario" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>ğŸ“‹ ProntuÃ¡rio EletrÃ´nico</h3>
                <button class="btn-close" onclick="Prontuario.fecharModal()">Ã—</button>
            </div>

            <input type="hidden" id="prontuario-agendamento-id">

            <!-- CABEÃ‡ALHO DO PRONTUÃRIO -->
            <div class="prontuario-header">
                <h2 style="margin: 0; color: white;">ğŸ‘¤ <span id="prontuario-paciente-nome"></span></h2>
                <div class="prontuario-paciente-info" id="prontuario-paciente-info"></div>
            </div>

            <!-- ANAMNESE -->
            <div class="prontuario-section">
                <h3>ğŸ“ Anamnese</h3>
                <div class="form-group">
                    <label>Queixa Principal</label>
                    <textarea class="form-control" id="pront-queixa" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label>HistÃ³ria da DoenÃ§a Atual (HDA)</label>
                    <textarea class="form-control" id="pront-hda" rows="6" placeholder="Descreva a evoluÃ§Ã£o da queixa principal..."></textarea>
                </div>
                <div class="form-group">
                    <label>HistÃ³ria PatolÃ³gica Pregressa</label>
                    <textarea class="form-control" id="pront-hpp" rows="6" placeholder="DoenÃ§as prÃ©vias, cirurgias anteriores, internaÃ§Ãµes..."></textarea>
                </div>
                <div class="form-group">
                    <label>MedicaÃ§Ãµes em Uso</label>
                    <textarea class="form-control" id="pront-medicacoes" rows="4" placeholder="Liste todas as medicaÃ§Ãµes em uso contÃ­nuo..."></textarea>
                </div>
                <div class="form-group">
                    <label>Alergias</label>
                    <textarea class="form-control" id="pront-alergias" rows="3" placeholder="Medicamentosas, alimentares, lÃ¡tex, etc..."></textarea>
                </div>
            </div>

            <!-- EXAME FÃSICO -->
            <div class="prontuario-section">
                <h3>ğŸ” Exame FÃ­sico</h3>
                <div class="grid-3">
                    <div class="form-group">
                        <label>PA (mmHg)</label>
                        <input type="text" class="form-control" id="pront-pa" placeholder="120/80">
                    </div>
                    <div class="form-group">
                        <label>FC (bpm)</label>
                        <input type="text" class="form-control" id="pront-fc" placeholder="72">
                    </div>
                    <div class="form-group">
                        <label>Temp (Â°C)</label>
                        <input type="text" class="form-control" id="pront-temp" placeholder="36.5">
                    </div>
                </div>
                <div class="form-group">
                    <label>Exame FÃ­sico Geral</label>
                    <textarea class="form-control" id="pront-exame-geral" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Exame FÃ­sico EspecÃ­fico</label>
                    <textarea class="form-control" id="pront-exame-especifico" rows="4"></textarea>
                </div>
            </div>

            <!-- HIPÃ“TESE DIAGNÃ“STICA -->
            <div class="prontuario-section">
                <h3>ğŸ¯ HipÃ³tese DiagnÃ³stica</h3>
                <div class="form-group">
                    <label>DiagnÃ³stico Principal</label>
                    <textarea class="form-control" id="pront-diagnostico" rows="3"></textarea>
                </div>
            </div>

            <!-- CONDUTA/PLANO -->
            <div class="prontuario-section">
                <h3>ğŸ’Š Conduta e Plano TerapÃªutico</h3>
                <div class="form-group">
                    <label>Conduta</label>
                    <textarea class="form-control" id="pront-conduta" rows="6" placeholder="Plano terapÃªutico, exames solicitados, encaminhamentos..."></textarea>
                </div>
                <div class="form-group">
                    <label>PrescriÃ§Ã£o</label>
                    <textarea class="form-control" id="pront-prescricao" rows="6" placeholder="MedicaÃ§Ãµes prescritas com posologia completa..."></textarea>
                </div>
                <div class="form-group">
                    <label>OrientaÃ§Ãµes ao Paciente</label>
                    <textarea class="form-control" id="pront-orientacoes" rows="3"></textarea>
                </div>
            </div>

            <!-- CAMPOS PERSONALIZADOS DE COLETA (SE HOUVER) -->
            <div id="prontuario-campos-coleta" style="display: none;">
                <div class="prontuario-section">
                    <h3>ğŸ“‹ Dados Adicionais</h3>
                    <div id="prontuario-campos-coleta-container"></div>
                </div>
            </div>

            <!-- BOTÃ•ES DE AÃ‡ÃƒO -->
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button class="btn btn-success" onclick="Prontuario.salvar()">ğŸ’¾ Salvar ProntuÃ¡rio</button>
                <button class="btn btn-info" onclick="Prontuario.imprimir()">ğŸ–¨ï¸ Imprimir</button>
                <button class="btn btn-secondary" onclick="Prontuario.fecharModal()">Cancelar</button>
            </div>
        </div>
    </div>


    <!-- MODAL FOLHA DE ROSTO -->
    <div id="modalFolhaRosto" class="modal">
        <div class="modal-content large" style="max-width: 1000px;">
            <div class="modal-header">
                <h3>ğŸ“‹ Folha de Rosto - Entrada do Paciente</h3>
                <button class="btn-close" onclick="FolhaRosto.fecharModal()">Ã—</button>
            </div>
            <input type="hidden" id="fr-id">
            
            <!-- NÃšMERO DE REGISTRO -->
            <div class="info-box" style="background: #dbeafe; border-left: 4px solid #3b82f6; margin-bottom: 20px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span style="font-size: 24px;">ğŸ“‹</span>
                    <div>
                        <strong>NÃºmero de Registro:</strong>
                        <div style="font-size: 20px; color: #1e40af; font-weight: bold; margin-top: 4px;" id="fr-numero-registro">
                            <!-- SerÃ¡ gerado automaticamente -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- SEÃ‡ÃƒO: DADOS DA ENTRADA -->
            <div class="form-section">
                <div class="form-section-title">ğŸšª Dados da Entrada</div>
                
                <div class="grid-2">
                    <div class="form-group">
                        <label>Local de Entrada <span class="required-indicator">*</span></label>
                        <select class="form-control" id="fr-local-entrada" required>
                            <option value="">Selecione...</option>
                            <option value="emergencia">EmergÃªncia</option>
                            <option value="ambulatorio">AmbulatÃ³rio</option>
                            <option value="pronto_socorro">Pronto Socorro</option>
                            <option value="transferencia">TransferÃªncia</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Tipo de Entrada <span class="required-indicator">*</span></label>
                        <select class="form-control" id="fr-tipo-entrada" required>
                            <option value="">Selecione...</option>
                            <option value="urgencia">UrgÃªncia</option>
                            <option value="emergencia">EmergÃªncia</option>
                            <option value="eletivo">Eletivo</option>
                            <option value="consulta">Consulta</option>
                        </select>
                    </div>
                </div>

                <div class="grid-2">
                    <div class="form-group">
                        <label>Meio de Chegada</label>
                        <select class="form-control" id="fr-meio-chegada">
                            <option value="">Selecione...</option>
                            <option value="ambulancia">AmbulÃ¢ncia</option>
                            <option value="viatura">Viatura</option>
                            <option value="transporte_proprio">Transporte PrÃ³prio</option>
                            <option value="caminhando">Caminhando</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>NÃºmero da Senha</label>
                        <input type="text" class="form-control" id="fr-numero-senha" 
                               placeholder="Ex: A001, 123">
                    </div>
                </div>

                <div class="form-group">
                    <label>ClassificaÃ§Ã£o de Risco (Protocolo de Manchester)</label>
                    <select class="form-control" id="fr-classificacao-risco">
                        <option value="">Selecione...</option>
                        <option value="vermelho">ğŸ”´ Vermelho - Emergente (0 min)</option>
                        <option value="laranja">ğŸŸ  Laranja - Muito Urgente (10 min)</option>
                        <option value="amarelo">ğŸŸ¡ Amarelo - Urgente (60 min)</option>
                        <option value="verde">ğŸŸ¢ Verde - Pouco Urgente (120 min)</option>
                        <option value="azul">ğŸ”µ Azul - NÃ£o Urgente (240 min)</option>
                    </select>
                </div>
            </div>

            <!-- SEÃ‡ÃƒO: IDENTIFICAÃ‡ÃƒO DO PACIENTE -->
            <div class="form-section">
                <div class="form-section-title">ğŸ‘¤ IdentificaÃ§Ã£o do Paciente</div>
                
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="fr-nao-identificado" onchange="FolhaRosto.togglePacienteNaoIdentificado()">
                        <span>Paciente NÃ£o Identificado</span>
                    </label>
                </div>

                <div id="fr-campos-paciente">
                    <div class="form-group">
                        <label>Paciente <span class="required-indicator">*</span></label>
                        <select class="form-control" id="fr-paciente-select" onchange="FolhaRosto.selecionarPaciente()" required>
                            <option value="">Selecione um paciente...</option>
                        </select>
                        <input type="hidden" id="fr-paciente-id">
                    </div>

                    <!-- DADOS DO PACIENTE SELECIONADO -->
                    <div id="fr-dados-paciente" style="display: none; margin-top: 16px; padding: 16px; background: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb;">
                        <div class="grid-3" style="gap: 16px;">
                            <div>
                                <small style="color: #6b7280; font-weight: 600;">CPF</small>
                                <div id="fr-paciente-cpf" style="font-size: 14px; margin-top: 4px;">-</div>
                            </div>
                            <div>
                                <small style="color: #6b7280; font-weight: 600;">CNS</small>
                                <div id="fr-paciente-cns" style="font-size: 14px; margin-top: 4px;">-</div>
                            </div>
                            <div>
                                <small style="color: #6b7280; font-weight: 600;">Data de Nascimento</small>
                                <div id="fr-paciente-nascimento" style="font-size: 14px; margin-top: 4px;">-</div>
                            </div>
                        </div>
                        <div class="grid-3" style="gap: 16px; margin-top: 12px;">
                            <div>
                                <small style="color: #6b7280; font-weight: 600;">Sexo</small>
                                <div id="fr-paciente-sexo" style="font-size: 14px; margin-top: 4px;">-</div>
                            </div>
                            <div>
                                <small style="color: #6b7280; font-weight: 600;">Cor/RaÃ§a</small>
                                <div id="fr-paciente-cor-raca" style="font-size: 14px; margin-top: 4px;">-</div>
                            </div>
                            <div>
                                <small style="color: #6b7280; font-weight: 600;">Estado Civil</small>
                                <div id="fr-paciente-estado-civil" style="font-size: 14px; margin-top: 4px;">-</div>
                            </div>
                        </div>
                        <div class="grid-2" style="gap: 16px; margin-top: 12px;">
                            <div>
                                <small style="color: #6b7280; font-weight: 600;">Telefone</small>
                                <div id="fr-paciente-telefone" style="font-size: 14px; margin-top: 4px;">-</div>
                            </div>
                            <div>
                                <small style="color: #6b7280; font-weight: 600;">ConvÃªnio</small>
                                <div id="fr-paciente-convenio" style="font-size: 14px; margin-top: 4px;">-</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SEÃ‡ÃƒO: MOTIVO DO ATENDIMENTO -->
            <div class="form-section">
                <div class="form-section-title">ğŸ“ Motivo do Atendimento</div>
                
                <div class="form-group">
                    <label>Motivo do Atendimento</label>
                    <select class="form-control" id="fr-motivo">
                        <option value="">Selecione...</option>
                        <option value="traumatismo">Traumatismo</option>
                        <option value="clinico">ClÃ­nico</option>
                        <option value="cirurgico">CirÃºrgico</option>
                        <option value="obstetrico">ObstÃ©trico</option>
                        <option value="psiquiatrico">PsiquiÃ¡trico</option>
                        <option value="outros">Outros</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Queixa Principal</label>
                    <textarea class="form-control" id="fr-queixa" rows="3" 
                              placeholder="Descreva a queixa principal do paciente..."></textarea>
                </div>
            </div>

            <!-- SEÃ‡ÃƒO: ACOMPANHANTE -->
            <div class="form-section">
                <div class="form-section-title">ğŸ‘¥ Acompanhante</div>
                
                <div class="grid-3">
                    <div class="form-group">
                        <label>Nome do Acompanhante</label>
                        <input type="text" class="form-control" id="fr-acompanhante-nome" 
                               placeholder="Nome completo">
                    </div>
                    <div class="form-group">
                        <label>Parentesco</label>
                        <input type="text" class="form-control" id="fr-acompanhante-parentesco" 
                               placeholder="Ex: MÃ£e, Filho, Esposo">
                    </div>
                    <div class="form-group">
                        <label>Telefone</label>
                        <input type="text" class="form-control" id="fr-acompanhante-telefone" 
                               placeholder="(00) 00000-0000" maxlength="16">
                    </div>
                </div>
            </div>

            <!-- SEÃ‡ÃƒO: INTERNAÃ‡ÃƒO -->
            <div class="form-section">
                <div class="form-section-title">ğŸ¥ InternaÃ§Ã£o</div>
                
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="fr-foi-internado" onchange="FolhaRosto.toggleInternacao()">
                        <span>Paciente foi internado</span>
                    </label>
                </div>

                <div id="fr-campos-internacao" style="display: none;">
                    <div class="grid-2">
                        <div class="form-group">
                            <label>Data e Hora da InternaÃ§Ã£o</label>
                            <input type="datetime-local" class="form-control" id="fr-data-internacao">
                        </div>
                        
                        <div class="form-group">
                            <label>Leito</label>
                            <select class="form-control" id="fr-leito">
                                <option value="">Selecione o leito...</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Motivo da InternaÃ§Ã£o</label>
                        <textarea class="form-control" id="fr-motivo-internacao" rows="2" 
                                  placeholder="Descreva o motivo da internaÃ§Ã£o..."></textarea>
                    </div>
                </div>
            </div>

            <!-- BOTÃ•ES -->
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button class="btn btn-primary" onclick="FolhaRosto.salvar(event)" style="flex: 1;">
                    ğŸ’¾ Salvar Folha de Rosto
                </button>
                <button class="btn btn-secondary" onclick="FolhaRosto.fecharModal()">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============================================================
        // ğŸ”§ FUNÃ‡ÃƒO AUXILIAR: CÃ³pia Profunda de Objetos
        // ============================================================
        // CRÃTICO: Sempre usar deepCopyAtlas ao atribuir atlas para inst.atlasAtual
        // Isso evita que modificaÃ§Ãµes em um atlas afetem outros atlas!
        function deepCopyAtlas(atlas) {
            // ğŸ”§ CORREÃ‡ÃƒO v10.323: Copiar dados MAS preservar funÃ§Ãµes!
            // JSON.parse(JSON.stringify()) MATA as funÃ§Ãµes (obterPercentual, etc)
            // SoluÃ§Ã£o: Copiar sÃ³ as regiÃµes, manter funÃ§Ãµes do original
            
            const copia = {
                versao: atlas.versao,
                data: atlas.data,
                descricao: atlas.descricao,
                metodo: atlas.metodo,
                totalEsperado: atlas.totalEsperado,
                imagemBase64: atlas.imagemBase64,
                faixasEtarias: atlas.faixasEtarias, // Arrays simples, pode copiar direto
                
                // Copiar regiÃµes profundamente (sÃ£o dados mutÃ¡veis)
                regioes: JSON.parse(JSON.stringify(atlas.regioes)),
                
                // âœ… CRÃTICO: Manter as FUNÃ‡Ã•ES do atlas original!
                obterRegioesPorVista: atlas.obterRegioesPorVista,
                obterPercentual: atlas.obterPercentual,
                validarTotal: atlas.validarTotal,
                obterDescricaoRegiao: atlas.obterDescricaoRegiao
            };
            
            return copia;
        }
        
        // ============================================================
        // ATLAS ANATÃ”MICO - 18 RegiÃµes MACRO (Base para divisÃµes virtuais)
        // ============================================================
        const ATLAS_ANATOMICO = 
{
  "versao": "2.0",
  "data": "2025-11-16T20:38:36.354Z",
  "imagemBase64": "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDIwMDEwOTA0Ly9FTiIKICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4wIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiB3aWR0aD0iMTQwOS4wMDAwMDBwdCIgaGVpZ2h0PSIxMjU0LjAwMDAwMHB0IiB2aWV3Qm94PSIwIDAgMTQwOS4wMDAwMDAgMTI1NC4wMDAwMDAiCiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0Ij4KCjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLDEyNTQuMDAwMDAwKSBzY2FsZSgwLjEwMDAwMCwtMC4xMDAwMDApIgpmaWxsPSIjMDAwMDAwIiBzdHJva2U9Im5vbmUiPgo8cGF0aCBkPSJNMCA2MjcwIGwwIC02MjcwIDcwNDUgMCA3MDQ1IDAgMCA2MjcwIDAgNjI3MCAtNzA0NSAwIC03MDQ1IDAgMAotNjI3MHogbTEwNTUyIDYxNTQgYzE1OCAtNjEgMjI0IC0xMTcgMjg3IC0yNDQgNTYgLTExNSA4MSAtMjM3IDgxIC00MDIgMCAtODAKNCAtMTI4IDEwIC0xMjggNiAwIDE5IDYgMzAgMTMgMjcgMTYgMzYgMiA0NSAtNjkgMTYgLTEzMyAtMzMgLTI3NCAtOTUgLTI3NAotMzUgMCAtNTAgLTIzIC01MCAtNzQgMCAtNjggLTg0IC0xMzYgLTIxNiAtMTc1IC01OCAtMTcgLTk5IC0yMSAtMjE0IC0yMQotMTk3IDAgLTMwOCAzMSAtMzg3IDExMCAtMzUgMzQgLTM4IDQyIC00OCAxMTMgLTYgNDUgLTcgNDcgLTQwIDQ3IC01MiAwIC04Ngo2MCAtMTAxIDE3NSAtNSA0NiA4IDE2MSAyMSAxNzQgMyAzIDE1IDAgMjUgLTcgMzcgLTIzIDQwIC0xNSA0MCAxMDkgMCAzNTkKMTIxIDU2NyAzODAgNjUzIDYyIDIwIDE3OSAyMCAyMzIgMHogbS02ODEzIC01NSBjMTE1IC0yNCAyMzIgLTE0MCAyODYgLTI4Mwo3NiAtMjAzIDcyIC00NDEgLTE1IC04NzEgLTI3IC0xMjkgLTY3IC0xNzMgLTIwNSAtMjIxIC03MCAtMjUgLTk1IC0yOCAtMTk1Ci0yOCAtMTAwIDAgLTEyNSAzIC0xOTUgMjggLTQ0IDE1IC05NSAzOSAtMTE0IDUzIC00MyAzMyAtODcgMTI4IC0xMDAgMjEzIC02CjM2IC0yMCAxMjEgLTMyIDE5MCAtMzAgMTcwIC0zMyA0MjEgLTUgNTMwIDUyIDIxMCAxNzggMzYwIDMyNiAzOTEgNTUgMTEgMTk0CjEwIDI0OSAtMnogbTcyMzEgLTY1NSBjMCAtOCAtNCAtMTQgLTEwIC0xNCAtNSAwIC0xMCA5IC0xMCAyMSAwIDExIDUgMTcgMTAKMTQgNiAtMyAxMCAtMTMgMTAgLTIxeiBtLTc4NjMgLTg2IGMxOSAtMjUgNjcgLTMwOCA1NSAtMzIwIC0yMCAtMjAgLTQ3IC0xCi03NCA1MSAtMjUgNDcgLTI4IDY0IC0yOCAxNDggMCAxMTMgMTggMTU4IDQ3IDEyMXogbTEwNDMgLTcgYzE2IC0zMSAxMiAtMTk2Ci01IC0yMzkgLTIwIC00NyAtNTMgLTgyIC03OCAtODIgLTIyIDAgLTIzIC02IDEyIDE5NCAyNSAxNDEgNDQgMTc2IDcxIDEyN3oKbTU4MjAgLTM0NiBjMCAtOCAtNCAtMTUgLTEwIC0xNSAtNSAwIC0xMCA3IC0xMCAxNSAwIDggNSAxNSAxMCAxNSA2IDAgMTAgLTcKMTAgLTE1eiBtOTUwIDYgYzAgLTUgLTcgLTE0IC0xNSAtMjEgLTEzIC0xMCAtMTUgLTkgLTE1IDkgMCAxMiA2IDIxIDE1IDIxIDgKMCAxNSAtNCAxNSAtOXogbS03MzUgLTIyNSBjNjcgLTIzIDMxNCAtMzMgNDEyIC0xNyA3NiAxMyAxODMgNTkgMjIxIDkzIDI3IDI2CjI3IDIyIDYgLTkyIC04IC00NyAtMTYgLTE0MiAtMTYgLTIxMSAtMSAtMTI0IDAgLTEyOCAyNyAtMTYzIDE1IC0yMCA0NSAtNTAKNjYgLTY3IDIyIC0xNyAzNyAtMzUgMzQgLTQwIC03IC0xMCAtNTEgLTMxIC0xMTAgLTU0IGwtNDAgLTE1IDM2IDYgYzIxIDMgNTkKMTYgODUgMjkgMjYgMTMgNTUgMjAgNjMgMTcgOSAtMyA2MyAtMzUgMTIxIC03MSA1OCAtMzYgMTE5IC03MyAxMzUgLTgxIDM5Ci0yMCA0MiAtNDcgMzEgLTI2OCAtNSAtOTggLTUgLTIxMSAwIC0yNjAgOCAtNzQgOSAtNDkgMTEgMTU4IDEgMTM1IDYgMjY4IDEwCjI5NSBsOCA1MCA0OCAzIGMzMSAyIDU1IC0yIDY5IC0xMiAxNiAtMTEgNDYgLTE2IDk4IC0xNiA1OCAwIDgyIC01IDEwNSAtMjAKMTcgLTExIDM4IC0yMCA0OSAtMjAgMTAgMCAzNSAtMTMgNTUgLTI5IDIwIC0xNSA0NyAtMzQgNjEgLTQxIDE0IC03IDQwIC0yOQo1OCAtNDkgMTYyIC0xNzcgMjI2IC00MjYgMTkzIC03NDggbC0xMyAtMTE4IDQ2IC0xMzcgYzI1IC03NSA1NyAtMTkyIDcxIC0yNjAKNDEgLTE5NyA2MiAtMjYyIDEwNSAtMzMwIDIyIC0zNSA0MCAtNjggNDAgLTc1IDAgLTcgLTMwIC0zNSAtNjYgLTYzIC0zNyAtMjcKLTYzIC01MCAtNTcgLTUwIDUgMCAzNiAyMCA2NyA0NSAzMiAyNSA2NCA0NSA3MCA0NSAxNCAwIDExOSAtMTM5IDE3MSAtMjI2IDQ4Ci04MCA5MSAtMTk1IDEyMCAtMzIyIDYyIC0yNzQgNjcgLTI4NyAxNzggLTUzMiA4NiAtMTg5IDEyNSAtMjY4IDIxNCAtNDM0IDM1Ci02NSA2MiAtMTI1IDYxIC0xMzQgLTIgLTExIDE3IC0yMyA3MiAtNDEgNDIgLTE1IDk4IC00MiAxMjUgLTYyIDI4IC0yMCA2MAotNDEgNzIgLTQ4IDEyIC02IDUzIC01MyA5MCAtMTAzIDEwMiAtMTM3IDExNSAtMTU3IDEwOCAtMTY4IC0xOSAtMzEgLTk3IDcKLTE2MCA3OCAtMzcgNDIgLTY1IDU0IC02NSAyOSAwIC00OSA1MSAtMTk1IDExNSAtMzI3IDcxIC0xNDggMTAyIC0yNDAgODkKLTI2MSAtOSAtMTYgLTMxIDggLTExMCAxMTYgLTEyNCAxNzAgLTE0NCAxOTUgLTE1NCAxOTUgLTIzIDAgLTIxIC0zNSA1IC0xMDgKMTUgLTQyIDMxIC05NiAzNiAtMTE5IDQgLTIzIDIyIC04NCAzOSAtMTM1IDMyIC05OSAzOSAtMTU4IDE3IC0xNTggLTE3IDAgLTgxCjk5IC0xMDMgMTU4IC05IDI2IC0zNCA4NSAtNTQgMTMyIC0yMSA0NyAtNDcgMTA2IC01OCAxMzMgLTIyIDUwIC00NCA2MCAtNjIKMjcgLTcgLTE0IC02IC00MCA0IC05MiA4IC00MCAxOCAtOTUgMjEgLTEyMyA0IC0yNyAxNiAtOTIgMjcgLTE0MyAyNCAtMTEzIDE1Ci0xNTMgLTI4IC0xMjQgLTMwIDE5IC04MCAxODAgLTExMCAzNDkgLTggNDggLTIyIDk5IC0zMSAxMTIgbC0xNSAyMyAtMjEgLTIwCmMtMTggLTE4IC0yMiAtNDEgLTMxIC0xNzYgLTExIC0xNTggLTIxIC0xOTEgLTQ3IC0xNjAgLTEwIDEzIC0xNiA2NCAtMjAgMTkzCmwtNiAxNzYgLTUyIDEzOSBjLTQwIDEwNyAtNTUgMTY1IC02OCAyNTggbC0xNyAxMjEgMjIgMTggMjIgMTggLTIyIDMgYy0yMCAzCi0yNCAxMSAtMzAgNjIgLTUgMzcgLTIwIDgxIC00MSAxMjAgLTUzIDk2IC0xNzYgMjgxIC0yNjMgMzk2IC00NCA1OCAtMTA3IDE0MQotMTQxIDE4NSAtMzQgNDUgLTk1IDE0OCAtMTM4IDIzNSAtNDMgODUgLTkwIDE3MyAtMTA1IDE5NSAtNjcgOTggLTExNSAyNDEKLTEwOCAzMjEgMSAxOSAtNiA0MSAtMTkgNTggLTEyIDE1IC0yNyA0NCAtMzMgNjQgLTI1IDc5IC04MyAyMDQgLTE0NSAzMTIgLTM2CjYzIC04MSAxNTcgLTEwMSAyMDkgLTIxIDUzIC00MyAxMDMgLTUxIDExMiAtNyA4IC0xMyAyMiAtMTMgMzAgLTEgOCAtOCAyNQotMTYgMzkgLTkgMTUgLTEzIDE3IC0xMCA2IDMzIC0xMDMgNDAgLTYzIC05NyAtNTY2IGwtNDIgLTE1NSAyIC0xODUgYzIgLTE1NAo2IC0yMDQgMjcgLTMwMCAxMyAtNjQgMjcgLTE3MSAzMSAtMjQwIDYgLTExNCAyOSAtMjgxIDU0IC0zOTEgMjQgLTEwNiA0MAotMTg3IDQ2IC0yMjcgbDYgLTQ0IC01MyA2IGMtMzkgNCAtNDQgMyAtMjEgLTMgNjIgLTE2IDgwIC0zNSA4NyAtOTMgNCAtMjkgMTgKLTEwOSAzMiAtMTc4IDgwIC00MDMgMTE0IC02MjggMTE0IC03NjQgMCAtNzUgLTYgLTk2IC0yOSAtOTcgLTEwIDAgLTggLTQgOAotMTAgMjQgLTkgMjQgLTEwIDE4IC0xMjIgLTM1IC02MTMgLTUyIC04NTEgLTYyIC04NjYgLTIgLTQgLTExIC02MSAtMTkgLTEyNgotMTkgLTE0MCAtMjAgLTI3MiAtNSAtNDg1IDUgLTg1IDE0IC0yMTEgMTkgLTI3OSA0IC02OSA2IC0xMzAgNCAtMTM2IC0zIC02Ci0yMyAtMTkgLTQ1IC0yOSAtMjIgLTEwIC0zOCAtMjAgLTM2IC0yMyAzIC0yIDE5IDMgMzcgMTIgMTcgOSAzOCAxNCA0NSAxMiAxNQotNiAxMDUgLTIzMyAxMzkgLTM1NCA0NyAtMTY0IDU5IC0yNjggNTggLTUyOCAwIC0xOTYgLTUgLTI4MSAtMjcgLTQ2NSAtNDAKLTMzMSAtNDQgLTM5MiAtNDUgLTY0MiAwIC0xNzQgMyAtMjM3IDE1IC0yNzAgMzAgLTkxIDQ1IC0xNzYgNDUgLTI2OCAwIC0xMjYKLTExIC0xNDEgLTQwIC01NSAtMzkgMTE3IC0xNDMgMTkyIC0yMzAgMTY2IC01MSAtMTUgLTEwMyAtNzggLTEyNyAtMTU0IC0xMAotMzEgLTIxIC01NyAtMjUgLTU3IC0xMSAwIC0yOCA2MiAtMjggMTA0IDAgMjMgMTUgOTcgMzMgMTY2IGwzMiAxMjUgMTQwIDUKYzk1IDMgMTMyIDggMTE2IDE0IC0xMyA0IC03NSA1IC0xMzcgMSBsLTExNCAtNyAwIDI3IGMwIDEyOSAtODAgNDcyIC0xNTMgNjYxCi01MyAxMzUgLTExMiAzMTMgLTE1OSA0NzkgLTIxIDc2IC0yMiA5OSAtMjQgNDMwIC0xIDMzNyAtMiAzNTIgLTIzIDQwOCAtMTMKMzIgLTIwIDY0IC0xNyA3MiAzIDggMjQgMTUgNTMgMTggNDEgMyA0MCA0IC0xMiAzIGwtNjAgMCAtMjcgNTAgYy01NCA5NyAtNzgKMTc4IC0xMDMgMzM5IC0xMyA4OCAtMzIgMTk4IC00MCAyNDUgLTkgNDcgLTMxIDE3NSAtNTEgMjg1IC0zOSAyMjUgLTU5IDMxMwotMTMyIDU2NSAtNTIgMTgwIC04MCAyOTIgLTEwNiA0MTUgLTE2IDc5IC0zMiAzNzcgLTIxIDM5NSA1IDcgMTkgLTYgNDAgLTM3CjM4IC01NyA5MCAtMTA1IDE0MyAtMTMyIDk2IC00OSAyMzYgLTY2IDM3MiAtNDYgNTIgOCAxMTEgMTYgMTMwIDE4IDE5IDIgLTI4CjIgLTEwNSAtMSAtMTc4IC02IC0yODYgOSAtMzgwIDUyIC04NiA0MCAtMTMyIDkwIC0xODUgMjAxIC0zNCA3MiAtMzkgNzcgLTQyCjUwIC0zIC0yNyAtNyAtMzAgLTM4IC0zMCAtMzEgMCAtMzUgMyAtMzggMjkgLTMgMjUgLTggMTkgLTQ2IC01NSAtNjcgLTEzMAotMTA4IC0xNjcgLTI0MSAtMjIxIC0zNSAtMTQgLTE0NyAtMjggLTIyNCAtMjggLTU5IDAgLTcyIC0zIC02MyAtMTIgMTcgLTE3CjE3MSAtMTMgMjU1IDYgMTE3IDI3IDE5MCA3NiAyNTIgMTY5IGwzNCA1MCA3IC0yOSBjNCAtMTYgMiAtMTA1IC00IC0xOTkgLTEzCi0xODcgLTMyIC0yNzUgLTE0NyAtNjgwIC0yMCAtNzEgLTQ0IC0xNTUgLTUyIC0xODUgLTE1IC01NSAtNzEgLTM2MSAtMTE4Ci02NTAgLTYwIC0zNTkgLTYxIC0zNjQgLTExMiAtNDY3IC0zMCAtNjIgLTU0IC05OCAtNjMgLTk3IC04IDAgLTUxIDMgLTk1IDcKLTQ3IDMgLTY4IDIgLTUwIC0zIDE3IC00IDU0IC04IDgzIC05IDM0IC0xIDU0IC02IDU4IC0xNSAzIC03IC01IC00MiAtMTYgLTc3Ci0yMSAtNjAgLTIyIC04NSAtMjQgLTQwOSAtMiAtMzQ0IC0yIC0zNDUgLTMwIC00NDUgLTM1IC0xMjUgLTExNiAtMzcwIC0xNTcKLTQ3MiAtNjAgLTE1MCAtMTExIC0zNTUgLTE0MCAtNTU4IC0xMiAtOTAgLTEyIC05MSAyNSAtMjM1IDM4IC0xNTIgNDMgLTIwNgoyNSAtMjU5IC0xMiAtMzQgLTI5IC00MiAtMjkgLTEzIDAgMzQgLTYxIDE0MiAtOTQgMTY3IC01MiAzOSAtODcgNDIgLTE1MiAxMAotNjUgLTMyIC0xMDUgLTgxIC0xMzAgLTE2MSAtMjYgLTgzIC0zOCAtNDcgLTMxIDk1IDMgODYgMTEgMTM3IDMwIDE5NiAxNSA0NAoyOSAxMDkgMzMgMTQ1IDkgOTEgLTEzIDUwNCAtMzYgNjkwIC0zNSAyODAgLTQzIDM5MiAtNDMgNjEwIDEgMjUzIDE5IDM3NSA4Mgo1NjUgNDUgMTM2IDk5IDI3NSAxMTIgMjg5IDYgNiAyNiAyIDU0IC0xMiAyNSAtMTIgNTMgLTIyIDYzIC0yMSAxNCAxIDEzIDIgLTMKOCAtNTQgMTggLTEwNCA0NCAtMTA3IDU0IC01IDE0IDcgMTk5IDIyIDM1NyAxOCAxOTQgMTMgNDQ1IC0xNCA2MTkgLTEzIDg2Ci0zMSAyNjYgLTQwIDQwMSAtOSAxMzUgLTIxIDMxNyAtMjcgNDA1IC0xNCAyMDIgLTEyIDIyNyAyMSAyMzYgMjMgNyAyNCA3IDMgOAotMTYgMSAtMjUgOSAtMzAgMjkgLTkgMzUgMTIgMzA1IDMyIDQwNyA4IDQ0IDIyIDExNiAzMCAxNjAgOSA0NCAyOCAxNDggNDUKMjMwIDE2IDgzIDMyIDE3MyAzNiAyMDAgOSA2OSAxNyA4MSA2NiA5OSBsNDMgMTUgLTQ3IC01IC00NyAtNiA1IDM4IGMzIDIyIDE2Cjg5IDMwIDE0OSAzOCAxNzUgNjMgMzM4IDcwIDQ2NCAzIDY0IDE3IDE3MiAzMSAyNDEgMjEgMTA1IDI2IDE1NSAyNyAzMTAgbDEKMTg1IC00MiAxNTUgYy0yMyA4NSAtNTYgMjA3IC03MyAyNzAgLTQ4IDE3NCAtNTEgMTg5IC00NCAyMjggbDYgMzcgLTIyIC0zNApjLTEyIC0xOCAtMzUgLTcxIC01MSAtMTE2IC0xNiAtNDUgLTU3IC0xMzEgLTkwIC0xOTEgLTg4IC0xNTggLTEwOCAtMTk5IC0xNDUKLTI5OSAtMTkgLTQ5IC00MiAtOTcgLTUxIC0xMDUgLTEzIC0xMSAtMTggLTMwIC0xOSAtNzAgMCAtOTAgLTIyIC0xNjIgLTc0Ci0yNTEgLTI4IC00NiAtODggLTE1OCAtMTM0IC0yNDkgLTY5IC0xMzUgLTEwNSAtMTkyIC0yMDEgLTMxNSAtMTMwIC0xNjcgLTI5MQotNDA1IC0zNDQgLTUwNyAtMjAgLTQwIC0zNiAtODcgLTM5IC0xMTggLTMgLTMxIC0xMCAtNTQgLTE5IC01NyAtNyAtMyAtNDIgNAotNzcgMTYgLTM0IDExIC03MSAyMSAtODIgMjAgLTIyIC0xIC0yMiAtMSA3OSAtMzAgNjQgLTE5IDc5IC0yNyA4NCAtNDcgMTIKLTUwIC0yOCAtMjQzIC04MSAtMzkxIGwtNTMgLTE0NiAtMSAtMTQ5IGMtMSAtMTQyIC0xMSAtMjA2IC0zMyAtMjA2IC0xNyAwCi0yNiA0NSAtMzQgMTY1IC02IDExNCAtMjAgMTc1IC00NCAxODkgLTE5IDEyIC00MyAtNDMgLTU3IC0xMzEgLTI0IC0xNTQgLTgyCi0zMzYgLTExMSAtMzQ3IC0zNyAtMTUgLTQyIDI1IC0xOCAxNTcgNDEgMjMwIDQ2IDI2NiA0NyAyOTYgMSAzOSAtMTYgNjAgLTM4CjQ2IC0xNSAtMTAgLTc4IC0xNDggLTExNSAtMjUzIC0yMSAtNjEgLTcxIC0xNTYgLTk5IC0xOTAgLTIyIC0yNyAtNDAgLTIxIC00MAoxMSAwIDIzIDQ4IDE5OCAxMDMgMzcwIDIzIDczIDI4IDEwMCAxOSAxMDkgLTE2IDE2IC00NSAtMTEgLTkwIC04MiAtNDQgLTY4Ci0xNDQgLTIwMSAtMTY1IC0yMTggLTUwIC00MiAtMTkgNzcgNjMgMjM4IDU3IDExMyAxMDQgMjQyIDExNiAzMjAgOSA1NCAtMTMKNTMgLTYzIC0zIC01MCAtNTcgLTEwNSAtOTcgLTEzMSAtOTcgLTQ4IDAgLTM4IDIxIDk3IDIwNSA0NiA2MyAxNTUgMTU0IDIxMgoxNzkgMTkgNyA1NiAyMCA4MyAyOCA0MiAxMSA0OSAxNyA1MCAzOSAxIDE0IDI0IDY2IDUzIDExNSAyMTMgMzc0IDMzMSA2NTYKMzg4IDkyOSA0MSAyMDAgOTIgMzE2IDIxNCA0ODggNjYgOTMgNzkgMTA3IDk5IDEwMiAyMCAtNSAyMSAtMyAxMSAxNCAtMTEgMTYKLTggMjcgMTkgNjggNTIgODEgNzEgMTM0IDExMiAzMTggMjEgOTcgNTggMjMyIDgxIDMwMSAzNyAxMTIgNDEgMTMxIDM1IDE4NwotMjUgMjQyIC0xNyAzNzEgMjkgNTIxIDMyIDEwNSAxMjcgMjU3IDE5MCAzMDggNjkgNTUgMTM2IDk4IDE1NCA5OCAxMCAwIDMwIDkKNDQgMjAgMjEgMTcgNDAgMjAgMTE0IDIwIDYzIDAgOTUgNCAxMDkgMTUgMjUgMTkgODMgMTkgOTAgMCA3IC0xOCAyNCAtMjAgMjQKLTIgMCA2IDIxIDI0IDQ4IDM5IDI2IDE1IDkwIDU0IDE0MiA4OCA5NyA2MyAxMTIgNjcgMTc1IDQ1IDExIC00IDUgMiAtMTIgMTQKLTE4IDExIC0zMyAyMiAtMzMgMjUgMCAyIDE3IDE1IDM4IDI4IDIwIDE0IDUwIDQ0IDY2IDY2IDI3IDQwIDI4IDQzIDI4IDE3OQotMSA4NyAtNiAxNjUgLTE2IDIxMSAtMjMgMTA2IC0yMyAxMDUgNDIgNjMgMzEgLTIxIDgwIC00NiAxMDcgLTU1eiBtLTY4NDEKLTcwIGM2OSAtMzEgMTg3IC01NiAyNjYgLTU2IDgyIDAgMjA5IDI4IDI3NCA2MCAyMiAxMCA0NCAxNiA0OSAxMyA2IC0zIDcgLTQ4CjIgLTExMyAtOCAtMTM0IDAgLTE1NSA5NCAtMjUyIGw3MSAtNzIgLTMzIC0zNCBjLTYxIC02NCAtMTQ2IC0xMTQgLTI2MiAtMTUzCi01OSAtMjAgLTg5IC0yNCAtMTk1IC0yNCAtMTQxIDEgLTIwMyAxNSAtMzEwIDcxIC03NiA0MCAtMTgwIDExOSAtMTgwIDEzNyAwCjYgMjIgMjggNDcgNDcgMjYgMTkgNjQgNjIgODUgOTQgbDM4IDU5IDAgMTI0IGMwIDY5IDMgMTIzIDggMTIxIDQgLTIgMjUgLTEyCjQ2IC0yMnogbS0xOTkgLTQ3NyBjMzQgLTM4IDE2MiAtMTE2IDIyMCAtMTM0IDk5IC0zMSA3OCAtMzcgLTExNCAtMzQgLTk5IDMKLTE4MSAxIC0xODEgLTIgMCAtMTAgMTE1IC0xOSAyNTEgLTE5IDE0MCAwIDE3OSAtOSAxNzkgLTQwIDAgLTExIDUgLTIwIDEwCi0yMCAxMyAwIDEzIDI2IDAgNTEgLTEwIDE4IC02IDE5IDEwMCAxOSAxMDYgMCAxMTAgLTEgMTAwIC0xOSAtMTMgLTI1IC0xMwotNTEgMCAtNTEgNiAwIDEwIDkgMTAgMjAgMCAzMyAzMyA0MCAxOTIgNDEgMTMzIDAgMjYzIDExIDIzMyAxOSAtNSAyIC04OSAyCi0xODUgMCAtMTc1IC0yIC0xOTggNCAtMTIwIDI5IDU5IDE5IDE5MiA5OSAyMzcgMTQzIDI3IDI2IDQ3IDM5IDU3IDM1IDkgLTQKNjIgLTM1IDExOSAtNzAgNTYgLTM1IDEyMiAtNzUgMTQ3IC04OCAzNyAtMjAgNTIgLTM3IDgyIC05NCA3MyAtMTM5IDEzMiAtMzY2CjEzMiAtNTA1IC0xIC0xMzMgLTQxIC0zMTcgLTg5IC00MTAgLTQwIC03NyAtMTQ1IC0xMzkgLTMyMiAtMTkyIC05OSAtMjkgLTExOQotMzIgLTI0MyAtMzEgLTk5IDEgLTEyOCAtMiAtMTEwIC05IDE1IC02IDgxIC04IDE2MCAtNSAxMTYgNCAxNDggOSAyMjcgMzYKMTIyIDQwIDIwOSA4NSAyNTUgMTI5IDQyIDQwIDg4IDE0MCAxMDkgMjQwIDEwIDQ2IDE1IDU4IDIyIDQ2IDUgLTkgMTEgLTE1MgoxMyAtMzE3IGwzIC0zMDIgLTU1IC0yMDUgYy0xMTIgLTQxMiAtMTA5IC0zOTcgLTEwOCAtNTc2IDEgLTEyNiA3IC0xOTAgMjcKLTI5NSAxNCAtNzQgMzEgLTIwNCAzNyAtMjg5IDExIC0xNDcgMjkgLTI1OSA2NSAtNDE1IDkgLTM4IDI1IC0xMjggMzYgLTIwMAoxMCAtNzEgMjIgLTE0OSAyNSAtMTcyIGw3IC00MyAtMTA2MiAwIGMtNzgwIDAgLTEwNjEgMyAtMTA2MSAxMSAwIDEyIDIyIDE1Mgo0MSAyNjQgNSAzMyAyMSAxMTAgMzQgMTcwIDM1IDE2MSA1MyAyNjkgNTkgMzcwIDEwIDE0MiAxNiAxOTEgNDIgMzMzIDE4IDEwMAoyNCAxNjggMjQgMjcyIDAgMTMxIC0yIDE0OCAtNDQgMzEyIC0yNCA5NSAtNjEgMjM0IC04MyAzMDggbC0zOCAxMzUgMCAzMTIgYzAKMjExIDQgMzE2IDExIDMyMyA4IDggMTQgLTYgMjMgLTQ3IDIxIC05NCA2OCAtMTk2IDEwOSAtMjM2IDQ1IC00NCAxMzAgLTg3CjI1NCAtMTI4IDgwIC0yNyAxMTEgLTMyIDIyOCAtMzYgNzggLTMgMTQ2IC0xIDE2MCA1IDE4IDcgLTEyIDEwIC0xMTAgOSAtMTI1Ci0xIC0xNDMgMSAtMjQzIDMxIC0xOTkgNTkgLTI4NyAxMTcgLTMzMyAyMTcgLTUwIDEwOSAtOTAgMzM1IC03OSA0NDUgOCA4NyA1OAoyNzggOTUgMzY3IDQ5IDExNiA2NyAxNDEgMTI5IDE3NCAzMSAxNiAxMDMgNTggMTYxIDkzIDExMCA2OCAxMTcgNjkgMTU1IDI1egptLTQxMiAtMTQ1IGMzIC00IC0xIC0yMyAtOSAtNDMgLTgxIC0xODcgLTEyNCAtMzMzIC0xNDEgLTQ3NCBsLTYgLTQ5IC0zMyA3CmMtNDMgOCAtNDQgLTcgLTMgLTIyIGwzMSAtMTIgLTYgLTgzIGMtNCAtNDYgLTggLTIxMyAtOCAtMzczIGwtMSAtMjkwIC0zOQotMTAzIGMtMjIgLTU3IC03MSAtMTYwIC0xMDkgLTIyOCAtNzYgLTEzNyAtOTMgLTE3NSAtMTM0IC0yODQgLTE1IC00MSAtMzIKLTgxIC0zOCAtODcgLTExIC0xNSAtODUgLTE3IC0xNTYgLTMgLTc5IDE1IC0xNjAgNTkgLTIyMyAxMjIgLTY2IDY0IC03MSA4NwotMzUgMTQ2IDQyIDY5IDY5IDE1NyAxMDMgMzM0IDkgNDYgMzggMTUzIDY2IDIzOCBsNTAgMTU1IC0xMiAxMjMgYy0xNSAxNDEgLTgKMzA5IDE1IDM5NSA4IDMyIDM3IDEwNCA2MyAxNjAgNTQgMTEzIDE0OSAyMzQgMjExIDI2OCAyMCAxMCA0MyAyMyA1MSAyNyA2NwozNyAxMDIgNTIgMTIyIDUyIDEzIDEgMzQgNyA0OCAxNSAyNSAxNCAxODAgMjEgMTkzIDl6IG0xODMxIC05IGMxNCAtMTEgNDUKLTE1IDEwMyAtMTUgNjQgMCA5MyAtNSAxMjEgLTIwIDIwIC0xMCA0OCAtMjEgNjIgLTI0IDM1IC03IDE0OSAtMTA0IDE5NCAtMTY1Cjg2IC0xMTcgMTM3IC0yNTkgMTU3IC00NDAgOCAtNzYgNyAtMTIyIC02IC0yMzUgbC0xNyAtMTQxIDMxIC04NSBjMzkgLTEwNiA3MwotMjMwIDEwNSAtMzg1IDI4IC0xMzYgNDYgLTE5MSA4MSAtMjUxIDM3IC02MyAzMyAtODUgLTI4IC0xNDcgLTc1IC03NyAtMTc5Ci0xMjUgLTI4NiAtMTM0IC05MiAtNyAtMTA0IC0xIC0xMjIgNTUgLTI0IDc3IC04NSAyMTEgLTE0MyAzMTIgLTY0IDExMyAtMTAzCjE5NiAtMTMxIDI3NSAtMTUgNDIgLTE4IDkzIC0yMCAzMjUgLTIgMTUxIC02IDMyMyAtMTAgMzgyIGwtNyAxMDggMzEgMTMgYzM2CjE1IDMxIDI5IC04IDIxIC0yNiAtNiAtMjcgLTUgLTQwIDczIC0yNSAxNTAgLTc5IDMzMCAtMTI3IDQyNiAtMTQgMjYgLTIyIDUyCi0xOSA1NyA5IDE1IDU3IDExIDc5IC01eiBtMTA2IC0xNDQwIGMwIC0xNiAtNiAtMjUgLTE2IC0yNSAtMTEgMCAtMTQgNSAtMTAKMTYgMyA5IDYgMjAgNiAyNSAwIDUgNSA5IDEwIDkgNiAwIDEwIC0xMSAxMCAtMjV6IG04NTggLTUwOCBjMTQxIC0xOTAgMTgxCi0yODEgMjM3IC01NDIgMTQgLTY2IDM3IC0xNTYgNTIgLTIwMCA0NyAtMTQ0IDE3MSAtNDA3IDMzNyAtNzE1IDI1IC00NyA0NgotODggNDYgLTkxIDAgLTQgLTE3IC0xMCAtMzcgLTEzIC0xNDggLTI2IC0yMTcgLTQzIC0yODAgLTcyIC04MyAtMzcgLTc1IC00MgotODggNTcgLTEwIDgyIC0xODkgMzY1IC0zODUgNjA5IC04MiAxMDIgLTExNCAxNTMgLTE3NyAyODAgLTQyIDg1IC05NiAxODQKLTExOSAyMjAgLTUzIDgyIC04OSAxNjggLTEwMyAyNDQgLTE5IDEwNCAtMTkgMTA2IDQwIDEwNiA2NyAwIDE1NyAyNCAyMTkgNTgKNTEgMjkgMTQzIDExMSAxNjEgMTQ0IDYgMTAgMTQgMTYgMTkgMTMgNSAtMyA0MCAtNDcgNzggLTk4eiBtLTM3MDcgNDAgYzgzCi05MyAyMjQgLTE1NyAzNDggLTE1NyBsNTQgMCAtNyAtNjEgYy0xMSAtOTUgLTQxIC0xNzcgLTk2IC0yNjQgLTI5IC00NCAtODAKLTE0MCAtMTE2IC0yMTQgLTY3IC0xNDAgLTExMCAtMjA2IC0yMzUgLTM2MSAtNDIgLTUyIC0xMTIgLTE0OSAtMTU2IC0yMTUKLTE2MSAtMjQzIC0xOTMgLTMwNiAtMTkzIC0zODIgMCAtMTcgLTUgLTM1IC0xMSAtMzggLTYgLTQgLTM3IDUgLTY5IDE5IC02NQoyOSAtMjE1IDY1IC0yNzIgNjYgLTIwIDAgLTQwIDQgLTQzIDEwIC0zIDUgMjMgNjEgNTkgMTIzIDM2IDYyIDY5IDEyNCA3NCAxMzgKNiAxMyAzNSA3NiA2NyAxMzkgNzcgMTU2IDE1OCAzNDEgMTgzIDQyMCAxMiAzNiAzNSAxMjYgNTEgMjAwIDQ3IDIxNSA5NSAzNDMKMTY4IDQ0MyA5OSAxNDAgMTM1IDE4NyAxNDEgMTg3IDQgMCAyOCAtMjQgNTMgLTUzeiBtLTY3OCAtMTYzNyBjMTA4IC0xOSAyMTUKLTU5IDI1MCAtOTQgMTggLTE4IDE4IC0yMSAtNSAtMTcxIC02IC0zOCAtMzMgLTEzMyAtNjAgLTIxMCBsLTUwIC0xNDAgLTMKLTE2MSBjLTQgLTE2NCAtMTMgLTIxNCAtNDAgLTIxNCAtMjAgMCAtMjQgMjMgLTMzIDE4MyAtNiAxMDUgLTEyIDE0MSAtMjQgMTU0Ci0zNSAzNSAtNjMgLTUgLTc0IC0xMDUgLTggLTc1IC02NiAtMjgyIC05MSAtMzI0IC0yNCAtNDEgLTUwIC00OCAtNTggLTE2IC0zCjEzIDMgNjEgMTQgMTA4IDEyIDQ3IDIxIDEwNSAyMSAxMzAgMCAyNSA3IDY3IDE1IDk0IDIwIDY2IDIwIDE0NSAwIDE1MiAtMjIgOQotNDAgLTEwIC02MCAtNjQgLTEwIC0yNiAtMzMgLTc5IC01MiAtMTE5IC0xOCAtNDAgLTMzIC03NyAtMzMgLTgzIDAgLTE2IC01OQotMTMxIC04NyAtMTY4IC0yMCAtMjYgLTI4IC0zMSAtMzkgLTIxIC0xNiAxMyAtMTQgMjMgMzIgMTc0IDEwMiAzMzEgMTAwIDMyMAo4NCAzMzAgLTE3IDEwIC00NCAtMTkgLTExOCAtMTI1IC0zNiAtNTIgLTgxIC0xMTQgLTEwMCAtMTM3IC0zNSAtNDQgLTYyIC01NgotNjIgLTI4IDAgMjUgNjMgMTgyIDExMyAyODIgMjYgNTEgNTkgMTM2IDc0IDE5MCAxNCA1NCAzNiAxMDkgNDcgMTIxIDE5IDIxCjI3IDIzIDc0IDE4IDY3IC04IDY5IDEwIDEgMTkgLTQ1IDYgLTU0IDQgLTkwIC0yMSAtMjIgLTE1IC03MSAtNTggLTEwOSAtOTYKLTQ5IC00OSAtNzUgLTY4IC05NCAtNjggLTUwIDAgLTQxIDE5IDkyIDE5OCA2NCA4NyAxNzQgMTczIDI1MyAxOTggMzAgOSA1OAoyMSA2NCAyNSAxMyAxMiAyNSAxMSAxNDggLTExeiBtNTEzNSAtOSBjNDUgLTE3IDEwMiAtNDUgMTI2IC02MyAyNSAtMTggNTcKLTQxIDcwIC01MSAxNCAtOSA1MSAtNTIgODIgLTk1IDMyIC00MiA3MiAtOTcgOTEgLTEyMSAzNSAtNDcgMzcgLTY0IDkgLTY5Ci0zNiAtNyAtNjMgMTAgLTE0MyA4OCAtOTMgOTAgLTExOCAxMDQgLTE4MCA5NCAtNTggLTggLTQ2IC0yMiAxNCAtMTcgNjQgNiA4MwotMTUgMTEyIC0xMjcgMTMgLTQ3IDQ0IC0xMjggNzEgLTE4MCA1NiAtMTEyIDEyMCAtMjcyIDEyMCAtMzAwIDAgLTExIC02IC0yMAotMTQgLTIwIC0xNSAwIC0xMjQgMTM1IC0xODEgMjI0IC00MyA2OCAtNzIgOTMgLTg3IDc4IC05IC05IC00IC0zNSAxOSAtMTA5CjExNCAtMzU5IDEyNCAtNDAzIDkyIC00MDMgLTI0IDAgLTg1IDEwNiAtMTM5IDI0MCAtNTQgMTM1IC04OSAyMTMgLTk4IDIyMiAtNgo2IC0xOCA4IC0yNiA1IC0yMSAtOCAtMjEgLTk5IC0xIC0xNTcgOCAtMjMgMTUgLTYxIDE1IC04NCAwIC0yMiA5IC03OCAyMAotMTI0IDExIC00NiAyMCAtOTQgMjAgLTEwNyAwIC01MSAtNDkgLTQzIC03NCAxMyAtMjUgNTYgLTczIDIzOSAtODAgMzA1IC04CjcwIC0zMCAxMjcgLTQ5IDEyNyAtMzIgMCAtNDEgLTMyIC00OCAtMTcxIC04IC0xNTIgLTEzIC0xNzkgLTM0IC0xNzkgLTIzIDAKLTM0IDY2IC00MCAyMjcgLTUgMTQ4IC02IDE1NCAtNTAgMjc1IC00NyAxMzAgLTY5IDIyMCAtODAgMzI5IGwtNiA2NyA1NCAyNgpjOTEgNDIgMjEzIDc1IDMyMyA4NSA2IDEgNDggLTEyIDkyIC0yOHogbS0zMTgxIC03MSBjMTUgLTE0IDIyIC0xOCAxNiAtMTAKLTM2IDQwIC0zNSA0MCA0OTYgNDAgMzk2IDAgNTEwIC0zIDUxMyAtMTIgNCAtMTAgMTAgLTEwIDMyIDAgMzIgMTQgNDkyIDE3CjUxNSAzIDggLTUgMjYgLTcxIDQzIC0xNTcgMTAyIC01MjAgMTA1IC02MDIgNTMgLTE0MTkgLTggLTEyNiAtMjQgLTI4NCAtMzUKLTM1MCAtMzggLTIxNyAtMzcgLTM1OCA1IC05MTEgNiAtODMgMiAtODkgLTcwIC05OSAtMjcgLTQgLTU0IC0xMSAtNjAgLTE1IC01Ci00IC0yOSAtMTAgLTUxIC0xNCAtMzEgLTQgLTQ1IC0yIC01NCA5IC0xMSAxMyAtMTUgMTQgLTI5IDIgLTIwIC0xOCAtNjEgLTI1Ci0xNzUgLTMyIC0xMzcgLTggLTExNiAtMTYgMzAgLTExIDEyOSA0IDE4NiAxMSAzMjMgNDEgNDAgOSA3OCAxNyA4NCAxOCAyMSA0CjE0MSAtMzI2IDE3MSAtNDc0IDUyIC0yNTMgNDUgLTU3MCAtMjUgLTExMDkgLTUgLTQxIC0xMiAtMTk0IC0xNiAtMzM5IC03Ci0zMjcgNSAtMzA1IC0xNjAgLTI5OSAtNzUgMyAtMTA3IDEgLTkyIC01IDI2IC05IDE5NCAtMTEgMjMxIC0yIDIyIDUgMjUgMCA1MQotODkgMjYgLTg5IDI4IC0xMDUgMjUgLTI0MyAtNCAtMjAwIDQgLTIyNSAxMjEgLTM3MSA4OSAtMTEyIDEzMSAtMTk1IDEzMQotMjYyIDAgLTYwIC04NyAtMTA4IC0yMDYgLTExNCAtMjMgLTEgLTQ5IC04IC01OCAtMTUgLTE2IC0xNCAtMTkgLTEyIC04MiAzNAotOSA3IC0yMSAyIC00MiAtMTggLTIyIC0yMSAtMzggLTI3IC03MSAtMjcgLTY0IDAgLTkxIDIyIC0xNDAgMTE0IC00NyA4OCAtNDcKODAgLTI1IDIzNCA1IDMxIDEgNTUgLTE0IDkwIC0xNiAzOCAtMjEgNjkgLTIwIDE0MyAwIDYwIC02IDExNCAtMTYgMTQ5IC0zMQoxMDEgLTMwIDEyOCAyIDIzNSAxNyA1NSAzMyAxMTIgMzYgMTI4IDQgMTYgMTMgMjcgMjMgMjcgMTUgMCAxNSAxIDEgMTMgLTkgNwotMTggMzYgLTIyIDcxIC04IDc1IC01MSAyODkgLTc3IDM4NCAtMTAgNDEgLTQyIDEzMyAtNzAgMjA1IC01NyAxNDggLTEyMCAzMzUKLTE1MCA0NDcgLTMzIDEyNiAtNDIgMjU2IC0zNSA1MDUgNyAyNjYgMCAzMjYgLTUwIDQzNCAtMTkgNDEgLTMyIDgxIC0zMCA4OCAzCjcgMTggMTQgMzMgMTQgMjEgMSAxOCAzIC0xMiA4IC0zNyA2IC00MiAxMCAtNzIgNzEgLTI3IDU1IC0zNyA5OSAtNjcgMjkwIC0zOQoyNDkgLTEwOSA2NDcgLTEyNyA3MjUgLTYgMjggLTM2IDEzNiAtNjYgMjQwIC05NCAzMzAgLTEzMiA0OTcgLTE0MyA2MzIgLTEyCjE1NSAtMTMgMzk0IC0xIDQyNSA4IDIzIDcgMjMgLTU2IDIzIGwtNjQgMCA2IC0xNDAgYzE0IC0yOTcgLTEzIC00NjAgLTE2MAotOTgwIC01NyAtMTk5IC02MiAtMjIxIC04NSAtMzU1IC0xMSAtNjkgLTM0IC0xOTcgLTUwIC0yODUgLTE3IC04OCAtNDEgLTIzNAotNTUgLTMyNCAtMjkgLTE5MSAtMzcgLTIyMiAtNjggLTI3NiAtMTggLTMzIC0yOSAtNDEgLTU3IC00NCAtMzIgLTQgLTMzIC00Ci0xMCAtMTEgMzMgLTggMzEgLTI2IC0xNiAtMTMwIGwtMzkgLTg1IDMgLTI2NSBjNSAtNDEwIC05IC01MDIgLTEyOSAtODQyIC0zNAotOTUgLTc4IC0yMjIgLTk5IC0yODMgLTM5IC0xMTAgLTkzIC0zNTUgLTEwNSAtNDczIC01IC00NCAtMTIgLTY1IC0yMyAtNjkKLTEyIC01IC0xMSAtOCA2IC0xNCAxMiAtNSAyMiAtMTcgMjIgLTI3IDAgLTExIDEzIC02NSAzMCAtMTIwIDM0IC0xMTMgMzYKLTE0NSAxNiAtMTk5IC0yOCAtNzkgLTM4IC0xNDIgLTMxIC0yMDggNyAtNTkgNCAtNzIgLTIwIC0xMjYgLTI3IC02MSAtMjcgLTYxCi0xMSAtMTE4IDI1IC04OSAyMSAtMTIzIC0yNCAtMjA4IC01MiAtOTcgLTcxIC0xMTIgLTEzNyAtMTEzIC00MyAwIC01NSA0IC03MQoyNSAtMjUgMzIgLTM5IDMxIC03NCAtMiAtMjggLTI3IC0yOSAtMjcgLTU4IC05IC0yMSAxMiAtNDAgMTUgLTYwIDExIC0xOSAtNAotMzcgLTEgLTUxIDkgLTEyIDggLTI3IDEyIC0zNCA5IC0yMiAtOCAtMTA0IDQ2IC0xMTEgNzIgLTEyIDQ5IDQxIDE4NCA5MyAyNDAKNTUgNTggMTI0IDE1NSAxNDEgMTk3IDEzIDM1IDE2IDczIDE0IDIwNSAtMiAxNTcgLTEgMTY2IDI5IDI1OCAyOCA4OSAzMiA5NQo1MiA4OSAyOCAtOSAxNTMgLTggMjA4IDEgMjkgNSAzOCAxMCAzMCAxOCAtNyA3IC0xNCA3IC0yMyAwIC0yMCAtMTYgLTIwMiAtMTcKLTIxNSAtMSAtNiA3IC0xNSAxMzQgLTIyIDI5OCAtNiAxNTcgLTE1IDMxNyAtMjAgMzU1IC00MiAzMTggLTUzIDQ1MSAtNTMgNjc1CjAgMjk1IDEzIDM4NyA4NiA2MDQgMzAgODkgNjYgMTg3IDgwIDIxOSBsMjYgNTkgNDMgLTcgYzIzIC00IDY1IC0xMyA5MiAtMjAKMjggLTcgNTQgLTEwIDYwIC03IDUgMyAtMjAgMTIgLTU1IDIwIC0zNiA4IC04MSAxOSAtMTAwIDI2IGwtMzUgMTIgMyA2OSBjMgozOSA3IDExNyAxMyAxNzUgNSA1OCAxMiAyMDQgMTUgMzI1IDYgMjA1IDQgMjMyIC0yMCAzOTggLTE1IDk5IC0zMyAyODMgLTQxCjQxMCAtNTEgODAyIC01MCA4MjMgNDkgMTM1MCAyMCAxMTIgMzggMTgyIDQ3IDE4OCA4IDUgMTI1IDggMjY2IDcgbDI1MSAtMyAyOQotMjV6IG0tMjM2MCAtMjk1IGMtMTUgLTQ0IC0yNCAtNDkgLTQwIC0yMyAtOCAxMyAtNCAyNSAxOCA1NSAzNCA0NCA0MyAzMCAyMgotMzJ6IG01Nzg4IDkgYzI5IC0zNSA0NCAtNTkgMzcgLTYzIC02IC0zIC0xNyAtMTkgLTI1IC0zNSBsLTE1IC0yOCAtMjAgNTUKYy0yMSA1NCAtMzggMTI3IC0zMCAxMjcgMiAwIDI2IC0yNSA1MyAtNTZ6IG0xMDM1IDM3IGMwIC0yNSAtMjAgLTgxIC0zMCAtODEKLTQgMCAtMTMgNiAtMTkgMTQgLTEwIDExIC03IDIyIDExIDUwIDI2IDQwIDM4IDQ1IDM4IDE3eiBtNTc4MyAtMjMgYzI1IC0zOQoyNiAtNDMgMTAgLTYwIC0yMyAtMjYgLTI3IC0yMyAtNDAgMjUgLTcgMjMgLTE1IDUwIC0xOCA2MCAtMTQgMzQgMjEgMTcgNDgKLTI1eiBtLTU3MjggLTM0NCBjLTE1IC00MSAtMjkgLTc0IC0zMSAtNzQgLTIgMCAtMTMgNSAtMjMgMTIgLTE4IDExIC0xOSAxNAotNCA0MiAzMCA1OCA3NyAxMjAgODEgMTA3IDIgLTcgLTggLTQ2IC0yMyAtODd6IG01NjYwIDI2IGMyNSAtMzkgNDUgLTc0IDQ1Ci03OCAwIC00IC05IC0xNSAtMjAgLTI1IC0yMCAtMTYgLTIxIC0xNiAtMzEgMTAgLTYgMTYgLTE3IDQyIC0yNCA1OSAtMTcgMzkKLTMwIDEwNCAtMjEgMTA0IDMgMCAyNiAtMzIgNTEgLTcweiBtLTEyNDUwIDM4IGMtMjAgLTY2IC00NCAtMTA4IC02MCAtMTAyCi0xOSA4IC0xMiAzMyAyMyA4NiAyNyA0MiA0NyA1MCAzNyAxNnogbTU2MjQgLTQzIGMzOSAtNjIgNTIgLTEwNSAzMSAtMTA1IC01CjAgLTEwIC03IC0xMCAtMTYgMCAtMjUgLTI1IC0xMCAtMjggMTcgLTIgMTMgLTE0IDU1IC0yOCA5MiAtMjcgNzcgLTI3IDc3IC0xNQo3NyA1IDAgMjggLTI5IDUwIC02NXogbTEzNDUgLTk1IGMtMTMgLTM3IC0yMSAtNDYgLTM1IC00MyAtMTEgMyAtMTkgMTEgLTE5CjE4IDAgMTQgNDcgMTQyIDU4IDE2MCAxNiAyMyAxMiAtOTAgLTQgLTEzNXogbS02ODEwIDEzIGMtOSAtNDAgLTIxIC03NiAtMjYKLTc5IC00IC0zIC04IDAgLTggNSAwIDYgLTcgMTEgLTE1IDExIC04IDAgLTE1IDQgLTE1IDkgMCAxMiA1MiAxNDIgNjUgMTYxIDE4CjI4IDE4IC0yOCAtMSAtMTA3eiBtNTI5NiA0IGMyNyAtNzEgMzEgLTkwIDIwIC05NyAtNyAtNCAtMTkgLTIxIC0yNSAtMzcgbC0xMgotMjggLTcgNDAgYy0zIDIyIC0xMyA3MiAtMjEgMTEwIC05IDM5IC0xNSA4MyAtMTUgMTAwIDAgMjUgMiAyNyAxMyAxNSA4IC04CjI5IC01NSA0NyAtMTAzeiBtNjc5OCA4MSBjNiAtMTggMTcgLTUxIDI2IC03MyAxMiAtMzMgMTIgLTQzIDEgLTYwIC03IC0xMgotMTUgLTMwIC0xOCAtNDAgLTMgLTE1IC01IC0xNCAtNiA3IDAgMTUgLTYgMzkgLTEyIDU1IC0xMyAzNSAtMjggMTI1IC0yMiAxMzYKOSAxNSAyMCA2IDMxIC0yNXogbS0xMTkwOCAtMjggYzAgLTIwIC01IC0zMCAtMTUgLTMwIC0xNSAwIC0yMSA0MCAtOCA1MyAxNAoxNSAyMyA2IDIzIC0yM3ogbTI0NjggLTU4IGMzIC03NyAxIC04NCAtMTggLTg5IC0xMSAtMyAtMjAgLTEyIC0yMCAtMjAgMCAtOAotNCAtMTEgLTEwIC04IC0xMSA3IC0xNCAxODggLTMgMTk5IDQgNCAxNiA2IDI4IDQgMTggLTMgMjAgLTExIDIzIC04NnogbTI0NDAKNTAgYzIgLTI0IC0xIC0zMiAtMTIgLTMyIC0xMiAwIC0xNiAxMCAtMTYgMzYgMCA0NSAyNCA0MiAyOCAtNHogbTE5MDYgMTYgYzMKLTE1IC0xIC0zMCAtMTQgLTQzIC0yMCAtMTkgLTIwIC0xOSAtMjAgMTYgMCA1MSAyMiA2OSAzNCAyN3ogbTQ5MjQgLTExIGMzCi0yMiAtMSAtMjcgLTE3IC0yNyAtMjEgMCAtMjYgMTUgLTE1IDQ1IDkgMjMgMjkgMTMgMzIgLTE4eiBtLTI0OTYgLTExOSBjLTE1Ci0xNSAtMjYgLTQgLTE4IDE4IDUgMTMgOSAxNSAxOCA2IDkgLTkgOSAtMTUgMCAtMjR6IG0tMTAwNiAtNDYzNyBjMzcgLTIzIDY1Ci02NyA4OSAtMTQwIDE2IC00OSAxNyAtNzUgMTAgLTIzMCAtOCAtMTc4IC0xMCAtMzIyIC02IC00MzAgMyAtNTMgLTIgLTcwIC00MgotMTU0IC0yNyAtNTYgLTU1IC0xMDAgLTcxIC0xMTAgLTQ1IC0zMCAtMTI4IC0xNyAtMTQxIDIyIC05IDI5IC00MSAyNiAtNjEgLTQKLTE5IC0yOSAtNDAgLTMyIC03MyAtOSAtMTggMTMgLTI4IDE0IC00OCA1IC0yMCAtOSAtMjkgLTggLTUwIDkgLTE1IDExIC0zNAoxOCAtNDMgMTUgLTEwIC0zIC0yMyAyIC0zMSAxMSAtNyA5IC0yNCAyMCAtMzYgMjUgLTMwIDExIC00NSA1MSAtMzggOTggMjEKMTI4IDMyIDE1MiAxNDMgMzE5IDczIDEwOSA3MiAxMDggMTE3IDI4OCAzOCAxNTEgNjggMjI2IDEwMSAyNTUgNTggNTAgMTI4IDYyCjE4MCAzMHogbTIxNzcgMyBjNzkgLTQxIDEwMSAtODUgMTYyIC0zMjkgMzAgLTExOSAzOSAtMTM5IDEzMyAtMjgzIDgxIC0xMjQKMTA4IC0xODYgMTE5IC0yODMgNiAtNTEgLTE0IC05OSAtNDEgLTk5IC03IDAgLTIxIC05IC0zMSAtMjAgLTExIC0xMyAtMjUgLTE4Ci0zNyAtMTQgLTEwIDMgLTI5IC0zIC00NCAtMTUgLTIwIC0xNiAtMzAgLTE4IC00OSAtOSAtMTggOCAtMjggNyAtNDYgLTYgLTMzCi0yMyAtNTQgLTIwIC03MyA5IC0xOSAzMCAtNTYgMzMgLTYzIDYgLTYgLTIzIC00MyAtNDEgLTg0IC00MSAtNTMgMCAtODIgMzEKLTEyOSAxMzYgbC00MiA5OCA2IDExNSBjNCA3NSAxIDE3OCAtOCAyOTEgLTIyIDI0OCAtMyAzNDkgODAgNDI2IDQxIDM5IDkzIDQ1CjE0NyAxOHogbS04ODgyIC01MDYgYy05IC0zMSAtOSAtMzEgLTEwIC02IC0xIDMwIDExIDY3IDE2IDUxIDIgLTYgMCAtMjYgLTYKLTQ1eiBtMTgyOSAyIGMwIC0xNiAtNCAtMzAgLTEwIC0zMCAtNSAwIC0xMCAxNCAtMTAgMzAgMCAxNyA1IDMwIDEwIDMwIDYgMAoxMCAtMTMgMTAgLTMweiBtNDIwIC0zNzkgYzAgLTEyIC0yMCAtMjUgLTI3IC0xOCAtNyA3IDYgMjcgMTggMjcgNSAwIDkgLTQgOQotOXogbTQyODAgLTE5MSBjMCAtMTEgLTQgLTIwIC05IC0yMCAtMTQgMCAtMjMgMTggLTE2IDMwIDEwIDE3IDI1IDExIDI1IC0xMHoKbTI0MjggLTMgYzIgLTEwIC0zIC0xNyAtMTIgLTE3IC0xMCAwIC0xNiA5IC0xNiAyMSAwIDI0IDIzIDIxIDI4IC00eiIvPgo8cGF0aCBkPSJNMzMyOCAxMTkwOCBjLTIxIC02IC0zOCAtMTQgLTM4IC0xOSAwIC0xMSAzIC0xMSAzNyAyIDE1IDYgNjQgMTUKMTA4IDE5IGw4MCA3IC03NSAxIGMtNDEgMCAtOTIgLTUgLTExMiAtMTB6Ii8+CjxwYXRoIGQ9Ik0zNzg1IDExOTA5IGM0NCAtNCA5NSAtMTIgMTE0IC0xOCAyNCAtNyAzMiAtOCAyNCAwIC0xNyAxNyAtODMgMjkKLTE1MyAyNyBsLTY1IC0xIDgwIC04eiIvPgo8cGF0aCBkPSJNMzgwNSAxMTc4MCBjLTM5IC04IC04NyAtNDAgLTgyIC01NCAyIC02IDI3IC0xNyA1NSAtMjQgODUgLTIxIDE3MgoxNCAxMzEgNTIgLTIyIDIxIC03MSAzMyAtMTA0IDI2eiBtLTUgLTQwIGMwIC0xMSAtNyAtMjMgLTE2IC0yNyAtMjAgLTggLTM2CjE3IC0yMiAzNCAxNiAyMCAzOCAxNSAzOCAtN3ogbTkzIDYgYzYgLTE2IC0xNiAtNDAgLTI2IC0yOSAtNCAzIC03IDE1IC03IDI1CjAgMjEgMjUgMjQgMzMgNHoiLz4KPHBhdGggZD0iTTMzMTUgMTE3NTggbC0yOCAtMjIgMjIgLTE3IGMxMSAtOSAzOCAtMjAgNTkgLTIzIDQwIC03IDEyMyAxMyAxMjkKMzEgMiA2IC0xMSAyMCAtMzAgMzIgLTQ3IDI5IC0xMTUgMjggLTE1MiAtMXogbTU3IC0xMyBjLTYgLTMzIC0yMCAtNDEgLTM5Ci0yMyAtMTMgMTMgLTEyIDE3IDIgMzIgMjUgMjUgNDMgMjAgMzcgLTl6IG04NyAxIGM4IC0xMCA4IC0xNiAtMiAtMjUgLTE2IC0xMwotMjcgLTUgLTI3IDIxIDAgMjEgMTMgMjMgMjkgNHoiLz4KPHBhdGggZD0iTTM1MzIgMTE1NjAgYy0zMSAtNjIgLTQzIC0xMzAgLTIyIC0xMzAgNSAwIDcgMTMgNCAyOSAtNiAyOCAxMyA3OQo0MyAxMTMgOCA5IDEzIDI1IDExIDM1IC0yIDEyIC0xNCAtNCAtMzYgLTQ3eiIvPgo8cGF0aCBkPSJNMzY0NiAxMTYwOCBjMyAtMTIgMjAgLTQzIDM1IC02OSAyNyAtNDQgMzggLTg5IDIxIC04OSAtNCAwIC0xMiAxMAotMTcgMjIgLTEyIDI3IC00NSAzNyAtNDUgMTQgMCAtOSAzIC0xNSA4IC0xNSAyMCAzIDMyIC0yIDI3IC0xMiAtNCAtNiAtMTMgLTgKLTIxIC01IC04IDMgLTE0IC0xIC0xNCAtOSAwIC0xMCAxMiAtMTQgNDAgLTEzIDM4IDAgNDAgMiA0MCAzMiAwIDMyIC01OCAxNjQKLTczIDE2NSAtNSAxIC01IC05IC0xIC0yMXoiLz4KPHBhdGggZD0iTTM1NDIgMTE0ODQgYy03IC04IC0xMiAtMjIgLTEwIC0zMiA0IC0yMCAzOSAtMjMgNDYgLTQgMiA3IC0yIDEwCi0xMSA2IC04IC0zIC0xOCAtMSAtMjIgNSAtNSAxMCA3IDE1IDI4IDEyIDQgMCA3IDYgNyAxNCAwIDE5IC0yMSAxOSAtMzggLTF6Ii8+CjxwYXRoIGQ9Ik0zNTI1IDExMzE2IGMtMjcgLTEzIC02NiAtMzcgLTg1IC01NCAtMjkgLTI0IC0zMiAtMzIgLTIyIC00NCAxNQotMTkgMTQzIC01MSAxOTcgLTUwIDc0IDIgMTk1IDQwIDE5NSA2MiAwIDE2IC05MiA3OCAtMTM5IDk1IC01OSAyMCAtODYgMTgKLTE0NiAtOXogbTEzNiAtMSBjMjQgLTggNTcgLTI1IDcyIC0zOCBsMjggLTIyIC0xNTEgMCAtMTUyIDAgMzIgMjUgYzM0IDI2IDgzCjQ4IDExMSA0OSA4IDEgMzUgLTYgNjAgLTE0eiBtNTQgLTc2IGMyOCAtNyA0MiAtMTYgMzkgLTIzIC02IC0xNSAtOTAgLTM2Ci0xNDUgLTM2IC01MCAwIC0xMzIgMjAgLTE0MSAzNCAtMjAgMjkgMTU5IDQ3IDI0NyAyNXoiLz4KPHBhdGggZD0iTTk5OTMgMTA1MTMgYzggLTggNzcgLTMzIDkxIC0zMyAyMCAwIC00IDEyIC01MCAyNiAtMjYgOCAtNDQgMTEgLTQxCjd6Ii8+CjxwYXRoIGQ9Ik0xMDc0MCAxMDQ4MyBjLTY4IC0xMSAtMTMxIC0yNSAtMTI4IC0yOSA2IC01IDE1NyAyMiAxNjUgMzAgMyAzIDIgNQotMyA1IC01IC0xIC0yMCAtNCAtMzQgLTZ6Ii8+CjxwYXRoIGQ9Ik0xMDEzNSAxMDQ2OSBjMjIgLTQgNTEgLTggNjUgLTcgbDI1IDAgLTI1IDggYy0xNCA0IC00MyA4IC02NSA4CmwtNDAgMCA0MCAtOXoiLz4KPHBhdGggZD0iTTEwMjc3IDEwNDQ4IGMyIC01IDY0IC04IDEzOCAtOCA3NCAwIDEzNiAzIDEzOCA4IDMgNCAtNTkgNyAtMTM4IDcKLTc5IDAgLTE0MSAtMyAtMTM4IC03eiIvPgo8cGF0aCBkPSJNOTU5MyAxMDIzNSBjMCAtNDQgMiAtNjEgNCAtMzcgMiAyMyAyIDU5IDAgODAgLTIgMjAgLTQgMSAtNCAtNDN6Ii8+CjxwYXRoIGQ9Ik0xMDQyMCA5NTAwIGMwIC01MTMgMyAtNzgwIDEwIC03ODAgNyAwIDEwIDI2NyAxMCA3ODAgMCA1MTMgLTMgNzgwCi0xMCA3ODAgLTcgMCAtMTAgLTI2NyAtMTAgLTc4MHoiLz4KPHBhdGggZD0iTTk1OTYgMTAwNDggYzkgLTgyIDE0IC04NiAxNCAtMTAgMCAzMyAtNSA2NCAtMTEgNjcgLTcgNSAtOCAtMTMgLTMKLTU3eiIvPgo8cGF0aCBkPSJNOTU5NCA5ODYwIGMwIC01MiAxIC03NCAzIC00NyAyIDI2IDIgNjggMCA5NSAtMiAyNiAtMyA0IC0zIC00OHoiLz4KPHBhdGggZD0iTTExMjcxIDk3MjkgYzAgLTE5IDQgLTUyIDkgLTc0IDcgLTMxIDcgLTI0IDMgMzAgLTYgNzQgLTEzIDEwMSAtMTIKNDR6Ii8+CjxwYXRoIGQ9Ik05NTgxIDk3MjQgYzAgLTExIDMgLTE0IDYgLTYgMyA3IDIgMTYgLTEgMTkgLTMgNCAtNiAtMiAtNSAtMTN6Ii8+CjxwYXRoIGQ9Ik05NTcyIDk2NjMgYy0xIC0xNyAtNSAtNDAgLTggLTUwIC01IC0xNyAtNSAtMTcgNiAwIDYgOSA5IDMyIDcgNTAKbC00IDMyIC0xIC0zMnoiLz4KPHBhdGggZD0iTTk1NDEgOTU0MyBjMCAtMTIgLTQgLTMwIC03IC00MCAtNSAtMTQgLTQgLTE1IDUgLTcgNyA2IDExIDI0IDggNDAKLTMgMjEgLTQgMjMgLTYgN3oiLz4KPHBhdGggZD0iTTExMzEwIDk1MjEgYzAgLTExIDQgLTIyIDkgLTI1IDQgLTMgNiA2IDMgMTkgLTUgMzAgLTEyIDMzIC0xMiA2eiIvPgo8cGF0aCBkPSJNOTUxNyA5NDYzIGMtNCAtMyAtNyAtMjAgLTYgLTM3IGwxIC0zMSA5IDM0IGMxMCAzMyA4IDQ3IC00IDM0eiIvPgo8cGF0aCBkPSJNMTEzNDAgOTQxNyBjMCAtMTQgNSAtMjkgMTAgLTMyIDcgLTQgOCAzIDQgMjIgLTkgMzggLTE0IDQyIC0xNCAxMHoiLz4KPHBhdGggZD0iTTk0ODUgOTM0OCBjLTQgLTE4IC0xNiAtNTkgLTI3IC05MiAtMTAgLTMyIC0xNyAtNjAgLTE1IC02MyA2IC01IDQyCjEwNSA1MiAxNTUgNCAxNyA0IDMyIDIgMzIgLTMgMCAtOCAtMTUgLTEyIC0zMnoiLz4KPHBhdGggZD0iTTExMzcyIDkzMjAgYzAgLTE0IDIgLTE5IDUgLTEyIDIgNiAyIDE4IDAgMjUgLTMgNiAtNSAxIC01IC0xM3oiLz4KPHBhdGggZD0iTTExNDAxIDkyMjQgYzAgLTExIDMgLTE0IDYgLTYgMyA3IDIgMTYgLTEgMTkgLTMgNCAtNiAtMiAtNSAtMTN6Ii8+CjxwYXRoIGQ9Ik0xMTQxMSA5MTk1IGMwIC02IDcgLTI2IDE1IC00NSBsMTQgLTM1IC01IDM1IGMtNSAzMCAtMjYgNzAgLTI0IDQ1eiIvPgo8cGF0aCBkPSJNOTQyMCA5MTQ0IGMtMTEgLTI3IC0xMyAtNTEgLTUgLTQyIDggOCAyNSA2OCAxOSA2OCAtMiAwIC05IC0xMiAtMTQKLTI2eiIvPgo8cGF0aCBkPSJNODY0NiA4NDQ1IGMxNiAtMTQgMzQgLTI1IDM5IC0yNSAxMiAwIC00NiA0OSAtNTkgNTAgLTUgMCA0IC0xMSAyMAotMjV6Ii8+CjxwYXRoIGQ9Ik04NzIwIDgzOTAgYzE0IC0xMSA0NSAtMjkgNzAgLTQxIDI1IC0xMSA1MyAtMjUgNjIgLTMwIDEwIC01IDI4IC05CjQwIC05IDEzIDEgLTQgMTAgLTM3IDIyIC0zMyAxMSAtNzkgMzQgLTEwMiA0OSAtNDcgMzMgLTcxIDM5IC0zMyA5eiIvPgo8cGF0aCBkPSJNMTIwOTQgODM3NSBjLTEwIC04IC0xNCAtMTUgLTggLTE1IDUgMCAxOSA3IDMwIDE1IDEwIDggMTQgMTUgOCAxNQotNSAwIC0xOSAtNyAtMzAgLTE1eiIvPgo8cGF0aCBkPSJNMTE5OTUgODMyOSBjLTI4IC0xMCAtNDEgLTE4IC0yOSAtMTkgMTIgMCA0MSA5IDY1IDIwIDU0IDI0IDMyIDI0Ci0zNiAtMXoiLz4KPHBhdGggZD0iTTg5MzMgODMwMyBjOSAtMiAyMyAtMiAzMCAwIDYgMyAtMSA1IC0xOCA1IC0xNiAwIC0yMiAtMiAtMTIgLTV6Ii8+CjxwYXRoIGQ9Ik0xMTkwOCA4MzAzIGM3IC0zIDE2IC0yIDE5IDEgNCAzIC0yIDYgLTEzIDUgLTExIDAgLTE0IC0zIC02IC02eiIvPgo8cGF0aCBkPSJNOTczNSA3MDUwIGMtMjIgLTMgMzcgLTQgMTMwIC0yIDk0IDIgMTc1IDUgMTgwIDcgMTkgNiAtMjcwIDIgLTMxMAotNXoiLz4KPHBhdGggZD0iTTEwNzc1IDcwNTAgYy00MiAtMTEgLTEgLTExIDUwIC0xIDM0IDcgMzUgOSAxMCA5IC0xNiAwIC00MyAtNCAtNjAKLTh6Ii8+CjxwYXRoIGQ9Ik0xMDkyMyA3MDUzIGMyNiAtMiA2OCAtMiA5NSAwIDI2IDIgNCAzIC00OCAzIC01MiAwIC03NCAtMSAtNDcgLTN6Ii8+CjxwYXRoIGQ9Ik0xMDA4OCA3MDQzIGM3IC0zIDE2IC0yIDE5IDEgNCAzIC0yIDYgLTEzIDUgLTExIDAgLTE0IC0zIC02IC02eiIvPgo8cGF0aCBkPSJNMTExMjMgNzA0MyBjOSAtMiAyMyAtMiAzMCAwIDYgMyAtMSA1IC0xOCA1IC0xNiAwIC0yMiAtMiAtMTIgLTV6Ii8+CjxwYXRoIGQ9Ik05NTgxIDcwMjkgYy03MCAtMTMgLTcyIC0xOCAtNiAtMTIgMzMgMyA2NCA5IDcwIDE0IDExIDExIC0zIDEwIC02NAotMnoiLz4KPHBhdGggZD0iTTEwMTQ1IDcwMzAgYzMgLTUgMTQgLTEwIDIzIC0xMCA5IDAgNDYgLTE0IDgyIC0zMiAzNiAtMTggNjkgLTM0IDc0Ci0zNiA1IC0zIDYgMCAzIDUgLTQgNiAtMzUgMjQgLTY5IDQwIC03MiAzNCAtMTIzIDQ5IC0xMTMgMzN6Ii8+CjxwYXRoIGQ9Ik0xMDY3MyA3MDI5IGMtMTggLTUgLTMzIC0xMiAtMzMgLTE1IDAgLTggNjMgNiA3NSAxNyAxMSAxMSAxIDEwIC00MgotMnoiLz4KPHBhdGggZD0iTTExMjIxIDcwMjYgYzIgLTIgMzEgLTYgNjQgLTkgMzkgLTQgNTEgLTMgMzUgMiAtMjUgOSAtMTA3IDE1IC05OSA3eiIvPgo8cGF0aCBkPSJNMTA1NDQgNjk2NSBjLTE4IC0xNCAtMTggLTE0IDQgLTggMTIgMyAyMiA5IDIyIDE0IDAgMTIgLTMgMTEgLTI2Ci02eiIvPgo8cGF0aCBkPSJNMTAzNDAgNjkzNiBjMCAtMiAxMiAtMTIgMjggLTIxIGwyNyAtMTggLTE5IDIxIGMtMTcgMjAgLTM2IDI5IC0zNgoxOHoiLz4KPHBhdGggZD0iTTEwNDc5IDY5MjEgYy0xMyAtMTEgLTIyIC0yMiAtMTkgLTI0IDMgLTMgMTggNiAzMyAxOSAzMyAyOCAyMCAzMwotMTQgNXoiLz4KPHBhdGggZD0iTTEwNDAwIDY4ODkgYzAgLTQgNSAtMTEgMTEgLTE1IDkgLTUgMTAgLTk2IDYgLTM0MyAtNCAtMTg1IC05IC0zNDkKLTExIC0zNjYgLTMgLTE2IC0zIC0yMiAwIC0xMiA2IDE4IDI0IDI0IDI0IDYgMCAtNSA0IC04IDkgLTUgNSA0IDEyIDAgMTQgLTYKMyAtNyAyIDE2IC0xIDUyIC00IDM2IC03IDIwNSAtNyAzNzcgbDAgMzEyIC0yMiA0IGMtMTMgMiAtMjMgMSAtMjMgLTR6Ii8+CjxwYXRoIGQ9Ik03OTEzIDY4MTMgYzkgLTIgMjMgLTIgMzAgMCA2IDMgLTEgNSAtMTggNSAtMTYgMCAtMjIgLTIgLTEyIC01eiIvPgo8cGF0aCBkPSJNMTI5MjMgNjgxMyBjOSAtMiAyNSAtMiAzNSAwIDkgMyAxIDUgLTE4IDUgLTE5IDAgLTI3IC0yIC0xNyAtNXoiLz4KPHBhdGggZD0iTTc5NjggNjgwMyBjNiAtMiAxOCAtMiAyNSAwIDYgMyAxIDUgLTEzIDUgLTE0IDAgLTE5IC0yIC0xMiAtNXoiLz4KPHBhdGggZD0iTTEyODU4IDY4MDMgYzYgLTIgMTggLTIgMjUgMCA2IDMgMSA1IC0xMyA1IC0xNCAwIC0xOSAtMiAtMTIgLTV6Ii8+CjxwYXRoIGQ9Ik0xMjc3NSA2NzgzIGwtNDAgLTEzIDQwIDYgYzM5IDYgNTIgMTEgNDQgMTcgLTIgMiAtMjIgLTIgLTQ0IC0xMHoiLz4KPHBhdGggZD0iTTkyOTggNTg0MyBjNiAtMiAxOCAtMiAyNSAwIDYgMyAxIDUgLTEzIDUgLTE0IDAgLTE5IC0yIC0xMiAtNXoiLz4KPHBhdGggZD0iTTExNTA2IDU4NDIgYy0zIC01IDggLTYgMjUgLTQgMTYgMiAyOSA2IDI5IDggMCA4IC00OSA0IC01NCAtNHoiLz4KPHBhdGggZD0iTTk0MDUgNTgyNSBjMjIgLTEwIDEyNSAtMjEgMTI1IC0xMyAwIDQgLTEyIDggLTI3IDggLTE2IDAgLTQ2IDIgLTY4CjUgLTIyIDMgLTM1IDMgLTMwIDB6Ii8+CjxwYXRoIGQ9Ik0xMTQyMyA1ODIzIGM5IC0yIDI1IC0yIDM1IDAgOSAzIDEgNSAtMTggNSAtMTkgMCAtMjcgLTIgLTE3IC01eiIvPgo8cGF0aCBkPSJNMTEzMTUgNTgxMCBjLTE4IC04IC0xOCAtOSA1IC04IDE0IDAgMzkgNCA1NSA4IGwzMCA4IC0zNSAwIGMtMTkgMAotNDQgLTMgLTU1IC04eiIvPgo8cGF0aCBkPSJNOTU5MyA1NzkzIGM5IC0yIDI1IC0yIDM1IDAgOSAzIDEgNSAtMTggNSAtMTkgMCAtMjcgLTIgLTE3IC01eiIvPgo8cGF0aCBkPSJNMTEyNDMgNTc5MyBjOSAtMiAyMyAtMiAzMCAwIDYgMyAtMSA1IC0xOCA1IC0xNiAwIC0yMiAtMiAtMTIgLTV6Ii8+CjxwYXRoIGQ9Ik05NjYxIDU3ODYgYzIgLTIgMzYgLTYgNzQgLTkgNDIgLTMgNTggLTIgNDAgMyAtMzAgOCAtMTIyIDEzIC0xMTQgNnoiLz4KPHBhdGggZD0iTTk0NDUgMzc1MCBjMyAtNSAxOCAtMTAgMzIgLTEwIDMyIDAgMjggNSAtMTAgMTQgLTE5IDQgLTI2IDMgLTIyIC00eiIvPgo8cGF0aCBkPSJNMTEzNzUgMzc1MCBsLTIwIC05IDIwIDAgYzExIDAgMjcgNCAzNSA5IDEzIDkgMTMgMTAgMCA5IC04IDAgLTI0Ci00IC0zNSAtOXoiLz4KPHBhdGggZD0iTTk1MTUgMzczMCBjMyAtNSAxNCAtMTAgMjMgLTEwIDE1IDAgMTUgMiAyIDEwIC0yMCAxMyAtMzMgMTMgLTI1IDB6Ii8+CjxwYXRoIGQ9Ik0xMTMyMCAzNzMwIGMtMTMgLTggLTEzIC0xMCAyIC0xMCA5IDAgMjAgNSAyMyAxMCA4IDEzIC01IDEzIC0yNSAweiIvPgo8cGF0aCBkPSJNOTU4MyAzNzEzIGM5IC0yIDI1IC0yIDM1IDAgOSAzIDEgNSAtMTggNSAtMTkgMCAtMjcgLTIgLTE3IC01eiIvPgo8cGF0aCBkPSJNMTEyNDMgMzcxMyBjOSAtMiAyMyAtMiAzMCAwIDYgMyAtMSA1IC0xOCA1IC0xNiAwIC0yMiAtMiAtMTIgLTV6Ii8+CjxwYXRoIGQ9Ik0xMTEyMyAzNjkzIGM5IC0yIDI1IC0yIDM1IDAgOSAzIDEgNSAtMTggNSAtMTkgMCAtMjcgLTIgLTE3IC01eiIvPgo8cGF0aCBkPSJNOTI5MCAxNTkwIGMwIC02IDMyIC0xMCA3OCAtOSA1NiAxIDY5IDMgNDcgOSAtNDUgMTEgLTEyNSAxMSAtMTI1IDB6Ii8+CjxwYXRoIGQ9Ik0yOTM3IDk0OTMgYy0yOCAtNyAtMTYgLTM4IDE2IC00MSAxOCAtMiAyOSAyIDM0IDEzIDUgMTUgLTEyIDM3IC0yNwozNCAtMyAtMSAtMTMgLTMgLTIzIC02eiIvPgo8cGF0aCBkPSJNNDIzMyA5NDg5IGMtMTcgLTE3IDIgLTM5IDM0IC0zOSAyMCAwIDQzIDI0IDMyIDM1IC0xMiAxMiAtNTYgMTQKLTY2IDR6Ii8+CjxwYXRoIGQ9Ik0zMzk0IDg3MTkgYy0zMiAtMTggLTc5IC00NiAtMTA0IC02MyAtMjQgLTE3IC00OSAtMzQgLTU0IC0zOCAtNiAtNAotOCAtMTAgLTUgLTEzIDQgLTMgMzUgMTQgNzEgMzcgMzUgMjQgODcgNTQgMTE2IDY3IDI5IDE0IDUyIDI4IDUyIDMzIDAgMTQKLTE1IDkgLTc2IC0yM3oiLz4KPHBhdGggZD0iTTM3NDAgODc0NSBjMCAtMyAyOCAtMTkgNjMgLTM2IDM0IC0xOCA4OCAtNDkgMTIwIC03MSA2NyAtNDYgNzggLTMzCjExIDE1IC04MCA1NyAtMTk0IDExMSAtMTk0IDkyeiIvPgo8cGF0aCBkPSJNMzU5NyA3NzQzIGMtMTEgLTEwIC04IC0yNSAzIC0xOCA2IDQgMTggMSAyNyAtNyAxNSAtMTIgMTUgLTExIDQgMTAKLTEyIDIyIC0yMiAyNyAtMzQgMTV6Ii8+CjxwYXRoIGQ9Ik0zNTg1IDc2OTAgYzIgLTE0IDUgLTI4IDUgLTMyIDAgLTE3IDMwIC02IDQwIDE1IDExIDIxIDEwIDIxIC00IDMKLTE4IC0yMiAtMjEgLTIxIC0zNiAxNCBsLTExIDI1IDYgLTI1eiIvPgo8cGF0aCBkPSJNMTA4MSA2NDk5IGMtMjkgLTQ0IC01MSAtODMgLTQ4IC04NSA5IC05IDExNyAxMzggMTE3IDE2MCAwIDIwIC0yMQotMyAtNjkgLTc1eiIvPgo8cGF0aCBkPSJNMTAwMCA2MzEyIGMwIC01IDM1IC0xOSA3OCAtMzEgODUgLTIzIDEwMiAtMjUgMTAyIC0xMyAwIDQgLTMwIDE1Ci02OCAyNCAtMzcgMTAgLTc3IDIwIC04OSAyNCAtMTMgNCAtMjMgMiAtMjMgLTR6Ii8+CjxwYXRoIGQ9Ik02MDc0IDY1NjQgYzEwIC0yNyA3NSAtMTIwIDk3IC0xNDAgMjkgLTI2IDIzIC0xMiAtMzYgNzggLTQ2IDcwIC03NgoxMDEgLTYxIDYyeiIvPgo8cGF0aCBkPSJNNjExNiA2Mjk0IGMtODIgLTI0IC0xMDIgLTM0IC03MSAtMzQgMzAgMCAxNzUgNDMgMTc1IDUyIDAgMTIgLTE1IDkKLTEwNCAtMTh6Ii8+CjxwYXRoIGQ9Ik00MDY1IDY2OTAgYy0zIC01IC0xIC0xMCA0IC0xMCA2IDAgMTEgNSAxMSAxMCAwIDYgLTIgMTAgLTQgMTAgLTMgMAotOCAtNCAtMTEgLTEweiIvPgo8cGF0aCBkPSJNMzE3MCA2NjYwIGMwIC01IDUgLTEwIDExIC0xMCA1IDAgNyA1IDQgMTAgLTMgNiAtOCAxMCAtMTEgMTAgLTIgMAotNCAtNCAtNCAtMTB6Ii8+CjxwYXRoIGQ9Ik0zMjc5IDY1NTYgYzI3IC0yOSAzMyAtMzIgMjUgLTEzIC0yIDcgLTE0IDE5IC0yNyAyNiAtMjEgMTMgLTIxIDEyCjIgLTEzeiIvPgo8cGF0aCBkPSJNMzczNiA2MzAzIGMtNiAtMTQgLTUgLTE1IDUgLTYgNyA3IDEwIDE1IDcgMTggLTMgMyAtOSAtMiAtMTIgLTEyeiIvPgo8cGF0aCBkPSJNMzUzMSA2MjA0IGMwIC0xMSAzIC0xNCA2IC02IDMgNyAyIDE2IC0xIDE5IC0zIDQgLTYgLTIgLTUgLTEzeiIvPgo8cGF0aCBkPSJNMjgwMCA0MTkxIGMwIC01IDI0IC0yMCA1MyAtMzQgNjUgLTMzIDc5IC01NSA4NSAtMTM5IDYgLTgxIDIyIC05MQoyMiAtMTMgMCA4OCAtMjEgMTI4IC05MCAxNjQgLTYyIDMzIC03MCAzNiAtNzAgMjJ6Ii8+CjxwYXRoIGQ9Ik00MzU2IDQxNzIgYy03MiAtMzkgLTkwIC02OSAtOTQgLTE1NCAtMyAtNTAgLTEgLTY5IDcgLTY0IDYgNCAxMSAzMAoxMSA1NyAwIDgxIDIwIDExNiA4NSAxNDUgMzAgMTQgNTUgMzAgNTUgMzUgMCAxNCAtMTEgMTEgLTY0IC0xOXoiLz4KPHBhdGggZD0iTTI3MjAgMzc5NiBjMCAtOCAtOCAtMTYgLTE3IC0xOCAtMTAgLTIgMTAgLTEwIDQ1IC0xNyA0NiAtMTAgNjggLTExCjg1IC0zIDIyIDExIDIyIDExIC0zIDExIC0xNCAxIC00MyAxMCAtNjUgMjEgLTQ3IDI0IC00NSAyNCAtNDUgNnoiLz4KPHBhdGggZD0iTTI5MDUgMzc1OSBjLTE2IC02IC0xNCAtOCAxMyAtOCAzMyAtMSA0MSA0IDIwIDEyIC03IDIgLTIyIDEgLTMzIC00eiIvPgo8L2c+Cjwvc3ZnPgo=",
  "regioes": [
    {
      "nome": "Membro superior esquerdo (anterior)",
      "grupo": "Membros Superiores",
      "sexo": "Masculino",
      "vista": "Anterior",
      "cor": "#C0392B",
      "points": "221.1649627685547,396.525634765625 231.18545532226562,425.87139892578125 230.46971130371094,464.52191162109375 248.36346435546875,498.8778991699219 252.65797424316406,516.7716674804688 266.2572326660156,538.2442016601562 277.709228515625,555.4221801757812 288.4454650878906,571.8844604492188 287.01397705078125,582.6206665039062 293.4557189941406,602.6616821289062 295.60296630859375,623.41845703125 297.750244140625,624.1342163085938 302.04473876953125,605.5247192382812 308.4864807128906,629.8602294921875 310.63372802734375,629.8602294921875 309.2022399902344,606.2404174804688 321.3699951171875,628.4287109375 324.2330017089844,628.4287109375 317.07550048828125,599.7987060546875 329.958984375,618.408203125 332.1062316894531,618.408203125 321.3699951171875,588.3466796875 332.8219909667969,594.0726928710938 336.4007568359375,593.35693359375 327.0959777832031,585.4837036132812 317.07550048828125,576.178955078125 308.4864807128906,569.7371826171875 289.8769836425781,532.5181884765625 286.2982177734375,514.6243896484375 280.5722351074219,500.3094177246094 269.8359680175781,488.14166259765625 264.8257141113281,473.82666015625 261.2469787597656,457.3644104003906 259.0997314453125,449.49114990234375 259.0997314453125,435.89190673828125 256.95245361328125,418.7138977050781 250.51071166992188,406.546142578125 239.7744598388672,399.3886413574219 231.18545532226562,395.0941162109375",
      "pontos": 39,
      "path": "M 221.1649627685547 396.525634765625 L 231.18545532226562 425.87139892578125 L 230.46971130371094 464.52191162109375 L 248.36346435546875 498.8778991699219 L 252.65797424316406 516.7716674804688 L 266.2572326660156 538.2442016601562 L 277.709228515625 555.4221801757812 L 288.4454650878906 571.8844604492188 L 287.01397705078125 582.6206665039062 L 293.4557189941406 602.6616821289062 L 295.60296630859375 623.41845703125 L 297.750244140625 624.1342163085938 L 302.04473876953125 605.5247192382812 L 308.4864807128906 629.8602294921875 L 310.63372802734375 629.8602294921875 L 309.2022399902344 606.2404174804688 L 321.3699951171875 628.4287109375 L 324.2330017089844 628.4287109375 L 317.07550048828125 599.7987060546875 L 329.958984375 618.408203125 L 332.1062316894531 618.408203125 L 321.3699951171875 588.3466796875 L 332.8219909667969 594.0726928710938 L 336.4007568359375 593.35693359375 L 327.0959777832031 585.4837036132812 L 317.07550048828125 576.178955078125 L 308.4864807128906 569.7371826171875 L 289.8769836425781 532.5181884765625 L 286.2982177734375 514.6243896484375 L 280.5722351074219 500.3094177246094 L 269.8359680175781 488.14166259765625 L 264.8257141113281 473.82666015625 L 261.2469787597656 457.3644104003906 L 259.0997314453125 449.49114990234375 L 259.0997314453125 435.89190673828125 L 256.95245361328125 418.7138977050781 L 250.51071166992188 406.546142578125 L 239.7744598388672 399.3886413574219 L 231.18545532226562 395.0941162109375 Z"
    },
    {
      "nome": "Membro superior direito (anterior)",
      "grupo": "Membros Superiores",
      "sexo": "Masculino",
      "vista": "Anterior",
      "cor": "#C0392B",
      "points": "136.70643615722656,397.24139404296875 128.117431640625,423.7241516113281 127.40167999267578,443.0494079589844 128.117431640625,463.80615234375 121.67567443847656,475.2581481933594 113.80242156982422,490.2889099121094 112.37091827392578,501.0251770019531 108.07642364501953,512.4771728515625 103.06616973876953,520.3504028320312 100.20317077636719,527.5079345703125 88.03541564941406,542.5386962890625 80.87791442871094,553.27490234375 70.85740661621094,569.0214233398438 70.85740661621094,578.326171875 69.42591094970703,591.9254150390625 66.56290435791016,598.3671875 65.84716033935547,604.0932006835938 62.98415756225586,624.1342163085938 61.55265426635742,624.1342163085938 57.97390365600586,606.9561767578125 50.100650787353516,630.575927734375 47.23765182495117,629.8602294921875 49.38490295410156,605.5247192382812 37.93289566040039,628.4287109375 33.638397216796875,627.7129516601562 41.51165008544922,602.6616821289062 29.343894958496094,619.8397216796875 25.049392700195312,617.6924438476562 40.08014678955078,586.9151611328125 29.343894958496094,595.5042114257812 24.333642959594727,593.35693359375 32.20689392089844,584.0521850585938 40.7958984375,576.8947143554688 50.100650787353516,570.4529418945312 57.25815200805664,556.8536987304688 64.41565704345703,543.2544555664062 70.14165496826172,531.8024291992188 71.57315826416016,517.4874267578125 77.29916381835938,503.17242431640625 85.17241668701172,494.5834045410156 88.75116729736328,488.14166259765625 92.32991790771484,476.6896667480469 96.62442016601562,465.2376403808594 100.20317077636719,448.05963134765625 100.20317077636719,432.3131408691406 103.06616973876953,420.1453857421875 108.79216766357422,405.83038330078125 116.66542053222656,400.82012939453125 126.68592834472656,396.525634765625",
      "pontos": 49,
      "path": "M 136.70643615722656 397.24139404296875 L 128.117431640625 423.7241516113281 L 127.40167999267578 443.0494079589844 L 128.117431640625 463.80615234375 L 121.67567443847656 475.2581481933594 L 113.80242156982422 490.2889099121094 L 112.37091827392578 501.0251770019531 L 108.07642364501953 512.4771728515625 L 103.06616973876953 520.3504028320312 L 100.20317077636719 527.5079345703125 L 88.03541564941406 542.5386962890625 L 80.87791442871094 553.27490234375 L 70.85740661621094 569.0214233398438 L 70.85740661621094 578.326171875 L 69.42591094970703 591.9254150390625 L 66.56290435791016 598.3671875 L 65.84716033935547 604.0932006835938 L 62.98415756225586 624.1342163085938 L 61.55265426635742 624.1342163085938 L 57.97390365600586 606.9561767578125 L 50.100650787353516 630.575927734375 L 47.23765182495117 629.8602294921875 L 49.38490295410156 605.5247192382812 L 37.93289566040039 628.4287109375 L 33.638397216796875 627.7129516601562 L 41.51165008544922 602.6616821289062 L 29.343894958496094 619.8397216796875 L 25.049392700195312 617.6924438476562 L 40.08014678955078 586.9151611328125 L 29.343894958496094 595.5042114257812 L 24.333642959594727 593.35693359375 L 32.20689392089844 584.0521850585938 L 40.7958984375 576.8947143554688 L 50.100650787353516 570.4529418945312 L 57.25815200805664 556.8536987304688 L 64.41565704345703 543.2544555664062 L 70.14165496826172 531.8024291992188 L 71.57315826416016 517.4874267578125 L 77.29916381835938 503.17242431640625 L 85.17241668701172 494.5834045410156 L 88.75116729736328 488.14166259765625 L 92.32991790771484 476.6896667480469 L 96.62442016601562 465.2376403808594 L 100.20317077636719 448.05963134765625 L 100.20317077636719 432.3131408691406 L 103.06616973876953 420.1453857421875 L 108.79216766357422 405.83038330078125 L 116.66542053222656 400.82012939453125 L 126.68592834472656 396.525634765625 Z"
    },
    {
      "nome": "Membro superior direito (posterior)",
      "grupo": "Membros Superiores",
      "sexo": "Masculino",
      "vista": "Posterior",
      "cor": "#C0392B",
      "points": "561.862060546875,395.80987548828125 560.4305419921875,412.2721252441406 561.1463012695312,430.88165283203125 566.1565551757812,448.775390625 571.1668090820312,463.80615234375 581.1873168945312,485.2786560058594 587.6290893554688,499.5936584472656 591.2078247070312,514.6243896484375 600.5125732421875,531.8024291992188 612.6803588867188,549.6961669921875 621.985107421875,558.28515625 626.995361328125,575.4631958007812 630.5740966796875,590.4939575195312 634.15283203125,605.5247192382812 634.8685913085938,622.7026977539062 637.7315673828125,624.8499755859375 640.5946044921875,605.5247192382812 648.4678344726562,632.7232055664062 652.7623291015625,629.8602294921875 647.7520751953125,603.37744140625 661.3513793945312,628.4287109375 663.4985961914062,628.4287109375 654.19384765625,601.230224609375 669.224609375,618.408203125 659.9198608398438,588.3466796875 671.371826171875,595.5042114257812 673.5191040039062,591.9254150390625 664.9301147460938,583.33642578125 654.19384765625,576.8947143554688 646.3206176757812,569.7371826171875 639.1630859375,553.27490234375 630.5740966796875,534.6654052734375 626.2796020507812,518.2031860351562 619.1220703125,502.4566650390625 610.5330810546875,488.14166259765625 604.09130859375,477.4053955078125 601.2283325195312,461.6589050292969 597.6495971679688,450.9226379394531 599.7968139648438,441.6178894042969 597.6495971679688,425.1556396484375 591.2078247070312,410.1248779296875 581.1873168945312,400.1043701171875 571.882568359375,397.9571228027344",
      "pontos": 43,
      "path": "M 561.862060546875 395.80987548828125 L 560.4305419921875 412.2721252441406 L 561.1463012695312 430.88165283203125 L 566.1565551757812 448.775390625 L 571.1668090820312 463.80615234375 L 581.1873168945312 485.2786560058594 L 587.6290893554688 499.5936584472656 L 591.2078247070312 514.6243896484375 L 600.5125732421875 531.8024291992188 L 612.6803588867188 549.6961669921875 L 621.985107421875 558.28515625 L 626.995361328125 575.4631958007812 L 630.5740966796875 590.4939575195312 L 634.15283203125 605.5247192382812 L 634.8685913085938 622.7026977539062 L 637.7315673828125 624.8499755859375 L 640.5946044921875 605.5247192382812 L 648.4678344726562 632.7232055664062 L 652.7623291015625 629.8602294921875 L 647.7520751953125 603.37744140625 L 661.3513793945312 628.4287109375 L 663.4985961914062 628.4287109375 L 654.19384765625 601.230224609375 L 669.224609375 618.408203125 L 659.9198608398438 588.3466796875 L 671.371826171875 595.5042114257812 L 673.5191040039062 591.9254150390625 L 664.9301147460938 583.33642578125 L 654.19384765625 576.8947143554688 L 646.3206176757812 569.7371826171875 L 639.1630859375 553.27490234375 L 630.5740966796875 534.6654052734375 L 626.2796020507812 518.2031860351562 L 619.1220703125 502.4566650390625 L 610.5330810546875 488.14166259765625 L 604.09130859375 477.4053955078125 L 601.2283325195312 461.6589050292969 L 597.6495971679688 450.9226379394531 L 599.7968139648438 441.6178894042969 L 597.6495971679688 425.1556396484375 L 591.2078247070312 410.1248779296875 L 581.1873168945312 400.1043701171875 L 571.882568359375 397.9571228027344 Z"
    },
    {
      "nome": "Membro superior esquerdo (posterior)",
      "grupo": "Membros Superiores",
      "sexo": "Masculino",
      "vista": "Posterior",
      "cor": "#C0392B",
      "points": "475.9720458984375,395.80987548828125 477.4035339355469,413.7036437988281 475.9720458984375,431.5973815917969 469.5302734375,449.49114990234375 467.3830261230469,460.2273864746094 464.5200500488281,467.3848876953125 456.64678955078125,483.84716796875 451.63653564453125,491.72039794921875 450.20501708984375,498.8778991699219 448.7735290527344,510.3299255371094 441.61602783203125,521.7819213867188 435.1742858886719,533.2339477539062 424.4380187988281,548.9804077148438 415.1332702636719,560.4324340820312 410.8387756347656,567.5899047851562 410.8387756347656,578.326171875 409.4072570800781,590.4939575195312 402.96551513671875,604.0932006835938 402.249755859375,624.8499755859375 401.5340270996094,624.8499755859375 395.0922546386719,606.2404174804688 390.0820007324219,629.8602294921875 386.5032653808594,628.4287109375 387.93475341796875,604.0932006835938 376.4827575683594,627.7129516601562 373.6197509765625,626.9971923828125 379.34576416015625,603.37744140625 367.8937683105469,620.5554809570312 365.03076171875,619.1239624023438 375.7669982910156,587.6309204101562 366.4622497558594,592.6411743164062 363.5992431640625,591.9254150390625 377.1985168457031,578.326171875 387.2190246582031,572.6001586914062 397.95526123046875,554.7064208984375 405.1127624511719,540.3914184570312 408.6915283203125,526.7921752929688 412.98602294921875,512.4771728515625 420.8592834472656,497.4464111328125 427.301025390625,489.5731506347656 432.311279296875,473.82666015625 437.321533203125,458.08013916015625 440.1845397949219,445.9123840332031 438.7530212402344,430.1658935546875 442.331787109375,415.85089111328125 448.0577697753906,406.546142578125 458.7940368652344,397.24139404296875",
      "pontos": 47,
      "path": "M 475.9720458984375 395.80987548828125 L 477.4035339355469 413.7036437988281 L 475.9720458984375 431.5973815917969 L 469.5302734375 449.49114990234375 L 467.3830261230469 460.2273864746094 L 464.5200500488281 467.3848876953125 L 456.64678955078125 483.84716796875 L 451.63653564453125 491.72039794921875 L 450.20501708984375 498.8778991699219 L 448.7735290527344 510.3299255371094 L 441.61602783203125 521.7819213867188 L 435.1742858886719 533.2339477539062 L 424.4380187988281 548.9804077148438 L 415.1332702636719 560.4324340820312 L 410.8387756347656 567.5899047851562 L 410.8387756347656 578.326171875 L 409.4072570800781 590.4939575195312 L 402.96551513671875 604.0932006835938 L 402.249755859375 624.8499755859375 L 401.5340270996094 624.8499755859375 L 395.0922546386719 606.2404174804688 L 390.0820007324219 629.8602294921875 L 386.5032653808594 628.4287109375 L 387.93475341796875 604.0932006835938 L 376.4827575683594 627.7129516601562 L 373.6197509765625 626.9971923828125 L 379.34576416015625 603.37744140625 L 367.8937683105469 620.5554809570312 L 365.03076171875 619.1239624023438 L 375.7669982910156 587.6309204101562 L 366.4622497558594 592.6411743164062 L 363.5992431640625 591.9254150390625 L 377.1985168457031 578.326171875 L 387.2190246582031 572.6001586914062 L 397.95526123046875 554.7064208984375 L 405.1127624511719 540.3914184570312 L 408.6915283203125 526.7921752929688 L 412.98602294921875 512.4771728515625 L 420.8592834472656 497.4464111328125 L 427.301025390625 489.5731506347656 L 432.311279296875 473.82666015625 L 437.321533203125 458.08013916015625 L 440.1845397949219 445.9123840332031 L 438.7530212402344 430.1658935546875 L 442.331787109375 415.85089111328125 L 448.0577697753906 406.546142578125 L 458.7940368652344 397.24139404296875 Z"
    },
    {
      "nome": "Membro inferior esquerdo (anterior)",
      "grupo": "Membros Inferiores",
      "sexo": "Masculino",
      "vista": "Anterior",
      "cor": "#C0392B",
      "points": "203.98695373535156,574.0316772460938 232.61695861816406,576.178955078125 237.62721252441406,596.9356689453125 240.49021911621094,621.9869384765625 237.62721252441406,652.0484619140625 235.47996520996094,672.8052368164062 235.47996520996094,700.0037231445312 236.91146850585938,720.760498046875 244.7847137451172,737.9384765625 245.50045776367188,756.5479736328125 246.9319610595703,775.8732299804688 244.7847137451172,792.3355102539062 242.63746643066406,805.218994140625 243.35321044921875,819.5339965820312 241.20596313476562,830.270263671875 246.21621704101562,843.8695068359375 246.21621704101562,858.1845092773438 258.38397216796875,880.372802734375 252.65797424316406,888.2460327148438 243.35321044921875,888.9617919921875 234.7642059326172,890.393310546875 227.60670471191406,886.0988159179688 224.0279541015625,875.362548828125 225.45945739746094,868.2050170898438 222.59645080566406,856.0372924804688 221.1649627685547,844.5852661132812 224.74371337890625,830.270263671875 219.73345947265625,805.218994140625 211.86019897460938,783.7465209960938 207.56570434570312,762.2739868164062 207.56570434570312,745.811767578125 208.99720764160156,734.3597412109375 201.83970642089844,723.6234741210938 198.97669982910156,705.729736328125 193.96644592285156,677.8154907226562 188.24044799804688,657.0587158203125 183.23019409179688,637.7334594726562 181.08294677734375,620.5554809570312 180.3671875,604.8089599609375",
      "pontos": 39,
      "path": "M 203.98695373535156 574.0316772460938 L 232.61695861816406 576.178955078125 L 237.62721252441406 596.9356689453125 L 240.49021911621094 621.9869384765625 L 237.62721252441406 652.0484619140625 L 235.47996520996094 672.8052368164062 L 235.47996520996094 700.0037231445312 L 236.91146850585938 720.760498046875 L 244.7847137451172 737.9384765625 L 245.50045776367188 756.5479736328125 L 246.9319610595703 775.8732299804688 L 244.7847137451172 792.3355102539062 L 242.63746643066406 805.218994140625 L 243.35321044921875 819.5339965820312 L 241.20596313476562 830.270263671875 L 246.21621704101562 843.8695068359375 L 246.21621704101562 858.1845092773438 L 258.38397216796875 880.372802734375 L 252.65797424316406 888.2460327148438 L 243.35321044921875 888.9617919921875 L 234.7642059326172 890.393310546875 L 227.60670471191406 886.0988159179688 L 224.0279541015625 875.362548828125 L 225.45945739746094 868.2050170898438 L 222.59645080566406 856.0372924804688 L 221.1649627685547 844.5852661132812 L 224.74371337890625 830.270263671875 L 219.73345947265625 805.218994140625 L 211.86019897460938 783.7465209960938 L 207.56570434570312 762.2739868164062 L 207.56570434570312 745.811767578125 L 208.99720764160156 734.3597412109375 L 201.83970642089844 723.6234741210938 L 198.97669982910156 705.729736328125 L 193.96644592285156 677.8154907226562 L 188.24044799804688 657.0587158203125 L 183.23019409179688 637.7334594726562 L 181.08294677734375 620.5554809570312 L 180.3671875 604.8089599609375 Z"
    },
    {
      "nome": "Membro inferior direito (anterior)",
      "grupo": "Membros Inferiores",
      "sexo": "Masculino",
      "vista": "Anterior",
      "cor": "#C0392B",
      "points": "125.97017669677734,574.0316772460938 151.0214385986328,576.178955078125 178.21994018554688,605.5247192382812 176.78843688964844,617.6924438476562 175.35694885253906,636.3019409179688 170.34669494628906,654.1957397460938 166.7679443359375,669.9421997070312 162.4734344482422,684.9729614257812 159.61044311523438,700.0037231445312 158.89468383789062,714.3187255859375 156.0316925048828,725.0549926757812 151.0214385986328,734.3597412109375 150.30567932128906,751.5377197265625 149.58993530273438,769.4315185546875 145.29542541503906,787.3252563476562 140.28518676757812,799.4929809570312 136.70643615722656,809.5134887695312 133.127685546875,830.9860229492188 138.8536834716797,846.0167846679688 135.27493286132812,853.8900146484375 137.42218017578125,863.1947631835938 134.55917358398438,868.2050170898438 136.70643615722656,876.7940063476562 128.8331756591797,888.2460327148438 118.81267547607422,886.8145141601562 110.93942260742188,886.0988159179688 103.78192138671875,886.0988159179688 99.48741912841797,882.52001953125 109.50791931152344,864.6262817382812 114.51817321777344,858.1845092773438 113.086669921875,841.7222900390625 118.096923828125,830.9860229492188 115.23392486572266,814.5237426757812 113.80242156982422,785.8937377929688 113.086669921875,767.2842407226562 113.80242156982422,747.2432250976562 123.82292175292969,721.4762573242188 125.25442504882812,693.5619506835938 124.5386734008789,670.657958984375 120.95992279052734,649.9011840820312 118.81267547607422,626.2814331054688 120.95992279052734,609.1034545898438 123.107177734375,589.7781982421875",
      "pontos": 43,
      "path": "M 125.97017669677734 574.0316772460938 L 151.0214385986328 576.178955078125 L 178.21994018554688 605.5247192382812 L 176.78843688964844 617.6924438476562 L 175.35694885253906 636.3019409179688 L 170.34669494628906 654.1957397460938 L 166.7679443359375 669.9421997070312 L 162.4734344482422 684.9729614257812 L 159.61044311523438 700.0037231445312 L 158.89468383789062 714.3187255859375 L 156.0316925048828 725.0549926757812 L 151.0214385986328 734.3597412109375 L 150.30567932128906 751.5377197265625 L 149.58993530273438 769.4315185546875 L 145.29542541503906 787.3252563476562 L 140.28518676757812 799.4929809570312 L 136.70643615722656 809.5134887695312 L 133.127685546875 830.9860229492188 L 138.8536834716797 846.0167846679688 L 135.27493286132812 853.8900146484375 L 137.42218017578125 863.1947631835938 L 134.55917358398438 868.2050170898438 L 136.70643615722656 876.7940063476562 L 128.8331756591797 888.2460327148438 L 118.81267547607422 886.8145141601562 L 110.93942260742188 886.0988159179688 L 103.78192138671875 886.0988159179688 L 99.48741912841797 882.52001953125 L 109.50791931152344 864.6262817382812 L 114.51817321777344 858.1845092773438 L 113.086669921875 841.7222900390625 L 118.096923828125 830.9860229492188 L 115.23392486572266 814.5237426757812 L 113.80242156982422 785.8937377929688 L 113.086669921875 767.2842407226562 L 113.80242156982422 747.2432250976562 L 123.82292175292969 721.4762573242188 L 125.25442504882812 693.5619506835938 L 124.5386734008789 670.657958984375 L 120.95992279052734 649.9011840820312 L 118.81267547607422 626.2814331054688 L 120.95992279052734 609.1034545898438 L 123.107177734375 589.7781982421875 Z"
    },
    {
      "nome": "Membro inferior direito (posterior)",
      "grupo": "Membros Inferiores",
      "sexo": "Masculino",
      "vista": "Posterior",
      "cor": "#C0392B",
      "points": "522.4957885742188,614.8294677734375 528.2218017578125,621.2711791992188 539.673828125,624.1342163085938 552.5573120117188,622.7026977539062 566.1565551757812,620.5554809570312 577.6085815429688,618.408203125 576.892822265625,632.7232055664062 576.1770629882812,653.47998046875 576.892822265625,665.647705078125 573.3140869140625,679.9627075195312 575.4613037109375,697.8565063476562 575.4613037109375,720.760498046875 582.6188354492188,737.9384765625 586.1975708007812,761.5582275390625 584.7660522460938,783.03076171875 581.903076171875,800.208740234375 582.6188354492188,815.9552612304688 581.903076171875,831.7017822265625 584.7660522460938,844.5852661132812 584.7660522460938,853.8900146484375 585.4818115234375,865.342041015625 591.2078247070312,873.9310302734375 596.933837890625,885.383056640625 597.6495971679688,892.54052734375 590.4920654296875,898.2665405273438 580.4715576171875,899.6980590820312 573.3140869140625,902.56103515625 563.2935791015625,888.9617919921875 564.0093383789062,873.2152709960938 564.0093383789062,854.6057739257812 559.71484375,846.7325439453125 566.1565551757812,832.4175415039062 559.71484375,806.6505126953125 551.1257934570312,784.4622802734375 547.5470581054688,767.2842407226562 546.831298828125,733.6439819335938 541.1052856445312,720.760498046875 536.0950317382812,697.8565063476562 531.0847778320312,677.0997314453125 526.790283203125,655.627197265625 521.780029296875,632.0074462890625",
      "pontos": 41,
      "path": "M 522.4957885742188 614.8294677734375 L 528.2218017578125 621.2711791992188 L 539.673828125 624.1342163085938 L 552.5573120117188 622.7026977539062 L 566.1565551757812 620.5554809570312 L 577.6085815429688 618.408203125 L 576.892822265625 632.7232055664062 L 576.1770629882812 653.47998046875 L 576.892822265625 665.647705078125 L 573.3140869140625 679.9627075195312 L 575.4613037109375 697.8565063476562 L 575.4613037109375 720.760498046875 L 582.6188354492188 737.9384765625 L 586.1975708007812 761.5582275390625 L 584.7660522460938 783.03076171875 L 581.903076171875 800.208740234375 L 582.6188354492188 815.9552612304688 L 581.903076171875 831.7017822265625 L 584.7660522460938 844.5852661132812 L 584.7660522460938 853.8900146484375 L 585.4818115234375 865.342041015625 L 591.2078247070312 873.9310302734375 L 596.933837890625 885.383056640625 L 597.6495971679688 892.54052734375 L 590.4920654296875 898.2665405273438 L 580.4715576171875 899.6980590820312 L 573.3140869140625 902.56103515625 L 563.2935791015625 888.9617919921875 L 564.0093383789062 873.2152709960938 L 564.0093383789062 854.6057739257812 L 559.71484375 846.7325439453125 L 566.1565551757812 832.4175415039062 L 559.71484375 806.6505126953125 L 551.1257934570312 784.4622802734375 L 547.5470581054688 767.2842407226562 L 546.831298828125 733.6439819335938 L 541.1052856445312 720.760498046875 L 536.0950317382812 697.8565063476562 L 531.0847778320312 677.0997314453125 L 526.790283203125 655.627197265625 L 521.780029296875 632.0074462890625 Z"
    },
    {
      "nome": "Membro inferior esquerdo (posterior)",
      "grupo": "Membros Inferiores",
      "sexo": "Masculino",
      "vista": "Posterior",
      "cor": "#C0392B",
      "points": "514.62255859375,613.39794921875 508.89654541015625,617.6924438476562 501.0232849121094,623.41845703125 484.56103515625,624.1342163085938 458.0782775878906,619.8397216796875 459.5097961425781,651.3327026367188 463.0885314941406,675.668212890625 463.8042907714844,694.9934692382812 460.9412841796875,719.3289794921875 457.362548828125,730.0652465820312 452.352294921875,746.5274658203125 451.63653564453125,775.8732299804688 455.21527099609375,806.6505126953125 455.21527099609375,830.9860229492188 452.352294921875,842.4380493164062 453.0680236816406,854.6057739257812 450.20501708984375,866.0578002929688 444.4790344238281,877.509765625 439.4687805175781,886.8145141601562 438.7530212402344,893.9720458984375 446.62628173828125,897.55078125 455.9310302734375,901.8452758789062 464.5200500488281,899.6980590820312 472.3932800292969,889.6775512695312 472.3932800292969,873.2152709960938 474.54052734375,858.1845092773438 478.1192932128906,848.1640014648438 472.3932800292969,830.270263671875 477.4035339355469,810.229248046875 483.1295471191406,790.9039916992188 488.85552978515625,777.3047485351562 491.0028076171875,757.2637329101562 490.28704833984375,735.791259765625 494.58154296875,722.90771484375 499.591796875,707.1612548828125 502.4548034667969,686.4044799804688 506.0335388183594,669.9421997070312 512.4752807617188,648.4697265625 516.769775390625,632.0074462890625",
      "pontos": 39,
      "path": "M 514.62255859375 613.39794921875 L 508.89654541015625 617.6924438476562 L 501.0232849121094 623.41845703125 L 484.56103515625 624.1342163085938 L 458.0782775878906 619.8397216796875 L 459.5097961425781 651.3327026367188 L 463.0885314941406 675.668212890625 L 463.8042907714844 694.9934692382812 L 460.9412841796875 719.3289794921875 L 457.362548828125 730.0652465820312 L 452.352294921875 746.5274658203125 L 451.63653564453125 775.8732299804688 L 455.21527099609375 806.6505126953125 L 455.21527099609375 830.9860229492188 L 452.352294921875 842.4380493164062 L 453.0680236816406 854.6057739257812 L 450.20501708984375 866.0578002929688 L 444.4790344238281 877.509765625 L 439.4687805175781 886.8145141601562 L 438.7530212402344 893.9720458984375 L 446.62628173828125 897.55078125 L 455.9310302734375 901.8452758789062 L 464.5200500488281 899.6980590820312 L 472.3932800292969 889.6775512695312 L 472.3932800292969 873.2152709960938 L 474.54052734375 858.1845092773438 L 478.1192932128906 848.1640014648438 L 472.3932800292969 830.270263671875 L 477.4035339355469 810.229248046875 L 483.1295471191406 790.9039916992188 L 488.85552978515625 777.3047485351562 L 491.0028076171875 757.2637329101562 L 490.28704833984375 735.791259765625 L 494.58154296875 722.90771484375 L 499.591796875 707.1612548828125 L 502.4548034667969 686.4044799804688 L 506.0335388183594 669.9421997070312 L 512.4752807617188 648.4697265625 L 516.769775390625 632.0074462890625 Z"
    },
    {
      "nome": "Abdome",
      "grupo": "Tronco",
      "sexo": "Masculino",
      "vista": "Anterior",
      "cor": "#C0392B",
      "points": "228.3224639892578,550.4119262695312 200.408203125,574.7474365234375 153.88442993164062,576.8947143554688 131.69618225097656,551.8434448242188 133.8434295654297,534.6654052734375 137.42218017578125,508.18267822265625 131.69618225097656,478.12115478515625 227.60670471191406,475.9739074707031 223.3122100830078,498.8778991699219 226.17520141601562,527.5079345703125",
      "pontos": 10,
      "path": "M 228.3224639892578 550.4119262695312 L 200.408203125 574.7474365234375 L 153.88442993164062 576.8947143554688 L 131.69618225097656 551.8434448242188 L 133.8434295654297 534.6654052734375 L 137.42218017578125 508.18267822265625 L 131.69618225097656 478.12115478515625 L 227.60670471191406 475.9739074707031 L 223.3122100830078 498.8778991699219 L 226.17520141601562 527.5079345703125 Z"
    },
    {
      "nome": "Pelve (anterior)",
      "grupo": "Tronco",
      "sexo": "Masculino",
      "vista": "Anterior",
      "cor": "#C0392B",
      "points": "130.26467895507812,553.27490234375 126.68592834472656,573.31591796875 151.0214385986328,579.7576904296875 178.21994018554688,606.9561767578125 202.55545043945312,579.0419311523438 233.3327178955078,574.7474365234375 227.60670471191406,551.8434448242188 201.83970642089844,570.4529418945312 151.7371826171875,572.6001586914062",
      "pontos": 9,
      "path": "M 130.26467895507812 553.27490234375 L 126.68592834472656 573.31591796875 L 151.0214385986328 579.7576904296875 L 178.21994018554688 606.9561767578125 L 202.55545043945312 579.0419311523438 L 233.3327178955078 574.7474365234375 L 227.60670471191406 551.8434448242188 L 201.83970642089844 570.4529418945312 L 151.7371826171875 572.6001586914062 Z"
    },
    {
      "nome": "Pelve (posterior)",
      "grupo": "Tronco",
      "sexo": "Masculino",
      "vista": "Posterior",
      "cor": "#C0392B",
      "points": "469.5302734375,556.137939453125 517.4855346679688,569.0214233398438 566.872314453125,556.137939453125 574.0298461914062,582.6206665039062 577.6085815429688,611.9664306640625 561.862060546875,619.8397216796875 541.1052856445312,624.1342163085938 525.3588256835938,616.9766845703125 518.2012939453125,608.3876953125 511.0437927246094,616.2609252929688 493.86578369140625,623.41845703125 470.9617919921875,619.8397216796875 458.0782775878906,617.6924438476562 461.65704345703125,583.33642578125",
      "pontos": 14,
      "path": "M 469.5302734375 556.137939453125 L 517.4855346679688 569.0214233398438 L 566.872314453125 556.137939453125 L 574.0298461914062 582.6206665039062 L 577.6085815429688 611.9664306640625 L 561.862060546875 619.8397216796875 L 541.1052856445312 624.1342163085938 L 525.3588256835938 616.9766845703125 L 518.2012939453125 608.3876953125 L 511.0437927246094 616.2609252929688 L 493.86578369140625 623.41845703125 L 470.9617919921875 619.8397216796875 L 458.0782775878906 617.6924438476562 L 461.65704345703125 583.33642578125 Z"
    },
    {
      "nome": "RegiÃ£o lombossacra",
      "grupo": "Tronco",
      "sexo": "Masculino",
      "vista": "Posterior",
      "cor": "#C0392B",
      "points": "475.25628662109375,502.4566650390625 517.4855346679688,476.6896667480469 563.2935791015625,501.0251770019531 566.872314453125,526.7921752929688 568.3038330078125,553.9906616210938 518.2012939453125,585.4837036132812 470.24603271484375,555.4221801757812 470.24603271484375,528.9393920898438",
      "pontos": 8,
      "path": "M 475.25628662109375 502.4566650390625 L 517.4855346679688 476.6896667480469 L 563.2935791015625 501.0251770019531 L 566.872314453125 526.7921752929688 L 568.3038330078125 553.9906616210938 L 518.2012939453125 585.4837036132812 L 470.24603271484375 555.4221801757812 L 470.24603271484375 528.9393920898438 Z"
    },
    {
      "nome": "TÃ³rax (anterior)",
      "grupo": "Tronco",
      "sexo": "Masculino",
      "vista": "Anterior",
      "cor": "#C0392B",
      "points": "137.42218017578125,398.6728820800781 153.8844451904297,386.505126953125 171.7781982421875,397.9571228027344 183.23019409179688,398.6728820800781 203.27120971679688,386.505126953125 219.01771545410156,397.9571228027344 229.03822326660156,422.2926330566406 231.1854705810547,467.3848876953125 226.89096069335938,475.9739074707031 131.69618225097656,476.6896667480469 127.40168762207031,465.9533996582031 125.97018432617188,425.1556396484375 130.98043823242188,408.6933898925781",
      "pontos": 13,
      "path": "M 137.42218017578125 398.6728820800781 L 153.8844451904297 386.505126953125 L 171.7781982421875 397.9571228027344 L 183.23019409179688 398.6728820800781 L 203.27120971679688 386.505126953125 L 219.01771545410156 397.9571228027344 L 229.03822326660156 422.2926330566406 L 231.1854705810547 467.3848876953125 L 226.89096069335938 475.9739074707031 L 131.69618225097656 476.6896667480469 L 127.40168762207031 465.9533996582031 L 125.97018432617188 425.1556396484375 L 130.98043823242188 408.6933898925781 Z"
    },
    {
      "nome": "CabeÃ§a",
      "grupo": "CabeÃ§a e PescoÃ§o",
      "sexo": "Masculino",
      "vista": "Anterior",
      "cor": "#C0392B",
      "points": "154.60018920898438,332.10809326171875 156.7474365234375,316.3616027832031 163.90493774414062,304.90960693359375 171.06243896484375,297.0363464355469 188.24044799804688,296.3205871582031 195.39794921875,302.0466003417969 201.83970642089844,312.7828369140625 203.2711944580078,331.3923645019531 209.71295166015625,337.11834716796875 211.1444549560547,344.2758483886719 201.83970642089844,352.14910888671875 197.54519653320312,364.3168640136719 186.80894470214844,368.6113586425781 173.20968627929688,367.8956298828125 161.7576904296875,365.0326232910156 156.7474365234375,353.58062744140625 148.87417602539062,345.7073669433594 147.44268798828125,337.11834716796875",
      "pontos": 18,
      "path": "M 154.60018920898438 332.10809326171875 L 156.7474365234375 316.3616027832031 L 163.90493774414062 304.90960693359375 L 171.06243896484375 297.0363464355469 L 188.24044799804688 296.3205871582031 L 195.39794921875 302.0466003417969 L 201.83970642089844 312.7828369140625 L 203.2711944580078 331.3923645019531 L 209.71295166015625 337.11834716796875 L 211.1444549560547 344.2758483886719 L 201.83970642089844 352.14910888671875 L 197.54519653320312 364.3168640136719 L 186.80894470214844 368.6113586425781 L 173.20968627929688 367.8956298828125 L 161.7576904296875 365.0326232910156 L 156.7474365234375 353.58062744140625 L 148.87417602539062 345.7073669433594 L 147.44268798828125 337.11834716796875 Z"
    },
    {
      "nome": "CabeÃ§a (posterior)",
      "grupo": "CabeÃ§a e PescoÃ§o",
      "sexo": "Masculino",
      "vista": "Posterior",
      "cor": "#C0392B",
      "points": "491.0028076171875,328.52935791015625 492.4342956542969,316.3616027832031 498.87603759765625,303.47808837890625 505.31781005859375,296.3205871582031 517.4855346679688,291.3103332519531 531.800537109375,296.3205871582031 543.2525634765625,313.49859619140625 544.68408203125,328.52935791015625 550.4100341796875,334.25537109375 550.4100341796875,343.56011962890625 542.5368041992188,351.433349609375 534.66357421875,360.0223693847656 521.780029296875,363.6011047363281 513.9067993164062,362.8853759765625 501.7390441894531,360.0223693847656 494.58154296875,351.433349609375 487.4240417480469,344.2758483886719 485.9925537109375,333.53961181640625",
      "pontos": 18,
      "path": "M 491.0028076171875 328.52935791015625 L 492.4342956542969 316.3616027832031 L 498.87603759765625 303.47808837890625 L 505.31781005859375 296.3205871582031 L 517.4855346679688 291.3103332519531 L 531.800537109375 296.3205871582031 L 543.2525634765625 313.49859619140625 L 544.68408203125 328.52935791015625 L 550.4100341796875 334.25537109375 L 550.4100341796875 343.56011962890625 L 542.5368041992188 351.433349609375 L 534.66357421875 360.0223693847656 L 521.780029296875 363.6011047363281 L 513.9067993164062 362.8853759765625 L 501.7390441894531 360.0223693847656 L 494.58154296875 351.433349609375 L 487.4240417480469 344.2758483886719 L 485.9925537109375 333.53961181640625 Z"
    },
    {
      "nome": "PescoÃ§o (anterior)",
      "grupo": "CabeÃ§a e PescoÃ§o",
      "sexo": "Masculino",
      "vista": "Anterior",
      "cor": "#C0392B",
      "points": "161.7576904296875,366.464111328125 173.20968627929688,367.8956298828125 183.23019409179688,368.6113586425781 196.82945251464844,364.3168640136719 196.1136932373047,377.20037841796875 203.98695373535156,385.78936767578125 197.54519653320312,390.0838623046875 184.6616973876953,396.525634765625 173.20968627929688,397.9571228027344 161.7576904296875,391.515380859375 156.7474365234375,387.22088623046875 162.4734344482422,377.20037841796875",
      "pontos": 12,
      "path": "M 161.7576904296875 366.464111328125 L 173.20968627929688 367.8956298828125 L 183.23019409179688 368.6113586425781 L 196.82945251464844 364.3168640136719 L 196.1136932373047 377.20037841796875 L 203.98695373535156 385.78936767578125 L 197.54519653320312 390.0838623046875 L 184.6616973876953 396.525634765625 L 173.20968627929688 397.9571228027344 L 161.7576904296875 391.515380859375 L 156.7474365234375 387.22088623046875 L 162.4734344482422 377.20037841796875 Z"
    },
    {
      "nome": "PescoÃ§o (posterior)",
      "grupo": "CabeÃ§a e PescoÃ§o",
      "sexo": "Masculino",
      "vista": "Posterior",
      "cor": "#C0392B",
      "points": "498.1603088378906,360.7381286621094 511.0437927246094,362.8853759765625 523.9273071289062,362.16961669921875 538.2423095703125,359.3066101074219 537.5265502929688,378.6318664550781 546.1155395507812,388.6523742675781 519.6328125,393.6626281738281 491.7185363769531,387.9366149902344 498.87603759765625,380.0633850097656",
      "pontos": 9,
      "path": "M 498.1603088378906 360.7381286621094 L 511.0437927246094 362.8853759765625 L 523.9273071289062 362.16961669921875 L 538.2423095703125 359.3066101074219 L 537.5265502929688 378.6318664550781 L 546.1155395507812 388.6523742675781 L 519.6328125 393.6626281738281 L 491.7185363769531 387.9366149902344 L 498.87603759765625 380.0633850097656 Z"
    },
    {
      "nome": "TÃ³rax (posterior)",
      "grupo": "Tronco",
      "sexo": "Masculino",
      "vista": "Posterior",
      "cor": "#C0392B",
      "points": "475.9720458984375,395.0941162109375 491.7185363769531,387.9366149902344 508.89654541015625,391.515380859375 519.6328125,392.9468688964844 534.66357421875,390.0838623046875 546.1155395507812,388.6523742675781 560.4305419921875,396.525634765625 559.71484375,415.85089111328125 562.5778198242188,436.6076354980469 571.1668090820312,463.09039306640625 566.1565551757812,474.54241943359375 563.2935791015625,501.0251770019531 518.9170532226562,476.6896667480469 476.68780517578125,502.4566650390625 468.8145446777344,475.9739074707031 466.66729736328125,462.3746643066406 477.4035339355469,433.74462890625 477.4035339355469,412.2721252441406",
      "pontos": 18,
      "path": "M 475.9720458984375 395.0941162109375 L 491.7185363769531 387.9366149902344 L 508.89654541015625 391.515380859375 L 519.6328125 392.9468688964844 L 534.66357421875 390.0838623046875 L 546.1155395507812 388.6523742675781 L 560.4305419921875 396.525634765625 L 559.71484375 415.85089111328125 L 562.5778198242188 436.6076354980469 L 571.1668090820312 463.09039306640625 L 566.1565551757812 474.54241943359375 L 563.2935791015625 501.0251770019531 L 518.9170532226562 476.6896667480469 L 476.68780517578125 502.4566650390625 L 468.8145446777344 475.9739074707031 L 466.66729736328125 462.3746643066406 L 477.4035339355469 433.74462890625 L 477.4035339355469 412.2721252441406 Z"
    }
  ]
};


        // ============================================================
        // [QUEIMADOS] ATLAS DE QUEIMADURAS - REGRA DOS 9
        // ============================================================
        
        const ATLAS_QUEIMADOS = {
            versao: "4.0-regra9",
            data: "2025-11-18T05:00:00.000Z",
            descricao: "Atlas de Queimaduras - Regra dos 9 com 13 regiÃµes CORRETAS",
            totalEsperado: 100,
            imagemBase64: null, // Usar mesma imagem do ATLAS_ANATOMICO
            regioes: [
                {
                    id: "cabeca_pescoco_anterior",
                    nome: "CabeÃ§a e PescoÃ§o (anterior)",
                    percentual: 4.5,
                    grupo: "CabeÃ§a e PescoÃ§o",
                    vista: "Anterior",
                    cor: "#FF6B6B",
                    path: "M 155.31593322753906 332.10809326171875 L 156.7474365234375 316.3616027832031 L 163.90493774414062 302.7623596191406 L 172.4939422607422 296.3205871582031 L 186.80894470214844 297.0363464355469 L 195.39794921875 302.7623596191406 L 201.83970642089844 314.93011474609375 L 203.2711944580078 332.10809326171875 L 208.2814483642578 337.11834716796875 L 207.56570434570312 345.7073669433594 L 201.83970642089844 352.8648681640625 L 198.26095581054688 362.8853759765625 L 196.1136932373047 372.19012451171875 L 198.26095581054688 379.3476257324219 L 203.98695373535156 384.3578796386719 L 196.1136932373047 391.515380859375 L 186.09320068359375 397.24139404296875 L 173.92544555664062 398.6728820800781 L 161.7576904296875 392.23114013671875 L 156.0316925048828 386.505126953125 L 159.61044311523438 378.6318664550781 L 161.7576904296875 370.75860595703125 L 161.7576904296875 363.6011047363281 L 156.7474365234375 353.58062744140625 L 151.0214385986328 346.4231262207031 L 150.30567932128906 338.54986572265625 Z"
                },
                {
                    id: "cabeca_pescoco_posterior",
                    nome: "CabeÃ§a e PescoÃ§o (posterior)",
                    percentual: 4.5,
                    grupo: "CabeÃ§a e PescoÃ§o",
                    vista: "Posterior",
                    cor: "#FF6B6B",
                    path: "M 491.7185363769531 329.2451171875 L 493.1500549316406 315.6458435058594 L 498.87603759765625 304.19384765625 L 506.0335388183594 296.3205871582031 L 518.9170532226562 291.3103332519531 L 530.3690795898438 295.6048583984375 L 537.5265502929688 303.47808837890625 L 543.2525634765625 314.93011474609375 L 542.5368041992188 326.3821105957031 L 547.5470581054688 333.53961181640625 L 548.2628173828125 344.9916076660156 L 542.5368041992188 352.14910888671875 L 538.9580688476562 359.3066101074219 L 537.5265502929688 378.6318664550781 L 545.3998413085938 386.505126953125 L 535.3793334960938 390.79962158203125 L 519.6328125 394.3783874511719 L 503.88629150390625 391.515380859375 L 492.4342956542969 387.22088623046875 L 498.1603088378906 380.0633850097656 L 498.1603088378906 357.8751220703125 L 494.58154296875 351.433349609375 L 488.1398010253906 344.9916076660156 L 488.1398010253906 335.6868591308594 Z"
                },
                {
                    id: "tronco_anterior",
                    nome: "Tronco (anterior)",
                    percentual: 18,
                    grupo: "Tronco",
                    vista: "Anterior",
                    cor: "#4ECDC4",
                    path: "M 222.43716430664062 396.2420349121094 L 229.61257934570312 420.1600646972656 L 232.00437927246094 463.2125244140625 L 226.4235076904297 483.9414978027344 L 224.03170776367188 499.0895690917969 L 224.82896423339844 518.2239990234375 L 228.01803588867188 538.9529418945312 L 232.00437927246094 558.8846435546875 L 205.8 575.0 L 189.9 593.9 L 181.1 607.1 L 176.3 607.7 L 166.6 591.6 L 153.8 575.7 L 126.76504516601562 573.2354736328125 L 129.15684509277344 554.8983154296875 L 132.34591674804688 538.9529418945312 L 135.5349884033203 519.0213012695312 L 136.33226013183594 503.8731994628906 L 132.34591674804688 483.9414978027344 L 128.3595733642578 467.9961242675781 L 127.56230926513672 423.3491516113281 L 136.33226013183594 397.8365783691406 L 154.66941833496094 385.8775634765625 L 170.61476135253906 398.63385009765625 L 184.96559143066406 397.039306640625 L 205.69454956054688 385.8775634765625 Z"
                },
                {
                    id: "tronco_posterior",
                    nome: "Tronco (posterior)",
                    percentual: 18,
                    grupo: "Tronco",
                    vista: "Posterior",
                    cor: "#4ECDC4",
                    path: "M 476.68780517578125 396.525634765625 L 491.0028076171875 387.22088623046875 L 503.1705627441406 392.23114013671875 L 517.4855346679688 392.9468688964844 L 531.800537109375 392.23114013671875 L 545.3998413085938 387.9366149902344 L 558.2833251953125 395.0941162109375 L 560.4305419921875 419.42962646484375 L 561.1463012695312 432.3131408691406 L 565.4407958984375 448.05963134765625 L 569.7352905273438 461.6589050292969 L 563.2935791015625 493.86767578125 L 562.5778198242188 511.76141357421875 L 566.1565551757812 530.3709106445312 L 566.872314453125 547.5489501953125 L 569.7352905273438 565.4426879882812 L 574.0298461914062 581.9049682617188 L 576.892822265625 600.5144653320312 L 578.3243408203125 614.8294677734375 L 562.5778198242188 620.5554809570312 L 545.3998413085938 622.7026977539062 L 532.5162963867188 621.9869384765625 L 522.4957885742188 614.1137084960938 L 518.2012939453125 606.9561767578125 L 514.62255859375 613.39794921875 L 504.60205078125 621.2711791992188 L 492.4342956542969 622.7026977539062 L 475.9720458984375 620.5554809570312 L 457.362548828125 617.6924438476562 L 458.7940368652344 602.6616821289062 L 462.3727722167969 581.9049682617188 L 466.66729736328125 564.7269287109375 L 469.5302734375 543.9701538085938 L 472.3932800292969 524.6448974609375 L 473.8247985839844 509.6141662597656 L 473.8247985839844 496.0149230957031 L 466.66729736328125 464.52191162109375 L 470.9617919921875 448.775390625 L 476.68780517578125 430.88165283203125 L 478.1192932128906 413.7036437988281 Z"
                },
                {
                    id: "ms_direito_anterior",
                    nome: "Membro superior direito (anterior)",
                    percentual: 4.5,
                    grupo: "Membros Superiores",
                    vista: "Anterior",
                    cor: "#95E1D3",
                    path: "M 136.70643615722656 397.24139404296875 L 128.117431640625 423.7241516113281 L 127.40167999267578 443.0494079589844 L 128.117431640625 463.80615234375 L 121.67567443847656 475.2581481933594 L 113.80242156982422 490.2889099121094 L 112.37091827392578 501.0251770019531 L 108.07642364501953 512.4771728515625 L 103.06616973876953 520.3504028320312 L 100.20317077636719 527.5079345703125 L 88.03541564941406 542.5386962890625 L 80.87791442871094 553.27490234375 L 70.85740661621094 569.0214233398438 L 70.85740661621094 578.326171875 L 69.42591094970703 591.9254150390625 L 66.56290435791016 598.3671875 L 65.84716033935547 604.0932006835938 L 62.98415756225586 624.1342163085938 L 61.55265426635742 624.1342163085938 L 57.97390365600586 606.9561767578125 L 50.100650787353516 630.575927734375 L 47.23765182495117 629.8602294921875 L 49.38490295410156 605.5247192382812 L 37.93289566040039 628.4287109375 L 33.638397216796875 627.7129516601562 L 41.51165008544922 602.6616821289062 L 29.343894958496094 619.8397216796875 L 25.049392700195312 617.6924438476562 L 40.08014678955078 586.9151611328125 L 29.343894958496094 595.5042114257812 L 24.333642959594727 593.35693359375 L 32.20689392089844 584.0521850585938 L 40.7958984375 576.8947143554688 L 50.100650787353516 570.4529418945312 L 57.25815200805664 556.8536987304688 L 64.41565704345703 543.2544555664062 L 70.14165496826172 531.8024291992188 L 71.57315826416016 517.4874267578125 L 77.29916381835938 503.17242431640625 L 85.17241668701172 494.5834045410156 L 88.75116729736328 488.14166259765625 L 92.32991790771484 476.6896667480469 L 96.62442016601562 465.2376403808594 L 100.20317077636719 448.05963134765625 L 100.20317077636719 432.3131408691406 L 103.06616973876953 420.1453857421875 L 108.79216766357422 405.83038330078125 L 116.66542053222656 400.82012939453125 L 126.68592834472656 396.525634765625 Z"
                },
                {
                    id: "ms_esquerdo_anterior",
                    nome: "Membro superior esquerdo (anterior)",
                    percentual: 4.5,
                    grupo: "Membros Superiores",
                    vista: "Anterior",
                    cor: "#95E1D3",
                    path: "M 221.1649627685547 396.525634765625 L 231.18545532226562 425.87139892578125 L 230.46971130371094 464.52191162109375 L 248.36346435546875 498.8778991699219 L 252.65797424316406 516.7716674804688 L 266.2572326660156 538.2442016601562 L 277.709228515625 555.4221801757812 L 288.4454650878906 571.8844604492188 L 287.01397705078125 582.6206665039062 L 293.4557189941406 602.6616821289062 L 295.60296630859375 623.41845703125 L 297.750244140625 624.1342163085938 L 302.04473876953125 605.5247192382812 L 308.4864807128906 629.8602294921875 L 310.63372802734375 629.8602294921875 L 309.2022399902344 606.2404174804688 L 321.3699951171875 628.4287109375 L 324.2330017089844 628.4287109375 L 317.07550048828125 599.7987060546875 L 329.958984375 618.408203125 L 332.1062316894531 618.408203125 L 321.3699951171875 588.3466796875 L 332.8219909667969 594.0726928710938 L 336.4007568359375 593.35693359375 L 327.0959777832031 585.4837036132812 L 317.07550048828125 576.178955078125 L 308.4864807128906 569.7371826171875 L 289.8769836425781 532.5181884765625 L 286.2982177734375 514.6243896484375 L 280.5722351074219 500.3094177246094 L 269.8359680175781 488.14166259765625 L 264.8257141113281 473.82666015625 L 261.2469787597656 457.3644104003906 L 259.0997314453125 449.49114990234375 L 259.0997314453125 435.89190673828125 L 256.95245361328125 418.7138977050781 L 250.51071166992188 406.546142578125 L 239.7744598388672 399.3886413574219 L 231.18545532226562 395.0941162109375 Z"
                },
                {
                    id: "ms_direito_posterior",
                    nome: "Membro superior direito (posterior)",
                    percentual: 4.5,
                    grupo: "Membros Superiores",
                    vista: "Posterior",
                    cor: "#95E1D3",
                    path: "M 561.862060546875 395.80987548828125 L 560.4305419921875 412.2721252441406 L 561.1463012695312 430.88165283203125 L 566.1565551757812 448.775390625 L 571.1668090820312 463.80615234375 L 581.1873168945312 485.2786560058594 L 587.6290893554688 499.5936584472656 L 591.2078247070312 514.6243896484375 L 600.5125732421875 531.8024291992188 L 612.6803588867188 549.6961669921875 L 621.985107421875 558.28515625 L 626.995361328125 575.4631958007812 L 630.5740966796875 590.4939575195312 L 634.15283203125 605.5247192382812 L 634.8685913085938 622.7026977539062 L 637.7315673828125 624.8499755859375 L 640.5946044921875 605.5247192382812 L 648.4678344726562 632.7232055664062 L 652.7623291015625 629.8602294921875 L 647.7520751953125 603.37744140625 L 661.3513793945312 628.4287109375 L 663.4985961914062 628.4287109375 L 654.19384765625 601.230224609375 L 669.224609375 618.408203125 L 659.9198608398438 588.3466796875 L 671.371826171875 595.5042114257812 L 673.5191040039062 591.9254150390625 L 664.9301147460938 583.33642578125 L 654.19384765625 576.8947143554688 L 646.3206176757812 569.7371826171875 L 639.1630859375 553.27490234375 L 630.5740966796875 534.6654052734375 L 626.2796020507812 518.2031860351562 L 619.1220703125 502.4566650390625 L 610.5330810546875 488.14166259765625 L 604.09130859375 477.4053955078125 L 601.2283325195312 461.6589050292969 L 597.6495971679688 450.9226379394531 L 599.7968139648438 441.6178894042969 L 597.6495971679688 425.1556396484375 L 591.2078247070312 410.1248779296875 L 581.1873168945312 400.1043701171875 L 571.882568359375 397.9571228027344 Z"
                },
                {
                    id: "ms_esquerdo_posterior",
                    nome: "Membro superior esquerdo (posterior)",
                    percentual: 4.5,
                    grupo: "Membros Superiores",
                    vista: "Posterior",
                    cor: "#95E1D3",
                    path: "M 475.9720458984375 395.80987548828125 L 477.4035339355469 413.7036437988281 L 475.9720458984375 431.5973815917969 L 469.5302734375 449.49114990234375 L 467.3830261230469 460.2273864746094 L 464.5200500488281 467.3848876953125 L 456.64678955078125 483.84716796875 L 451.63653564453125 491.72039794921875 L 450.20501708984375 498.8778991699219 L 448.7735290527344 510.3299255371094 L 441.61602783203125 521.7819213867188 L 435.1742858886719 533.2339477539062 L 424.4380187988281 548.9804077148438 L 415.1332702636719 560.4324340820312 L 410.8387756347656 567.5899047851562 L 410.8387756347656 578.326171875 L 409.4072570800781 590.4939575195312 L 402.96551513671875 604.0932006835938 L 402.249755859375 624.8499755859375 L 401.5340270996094 624.8499755859375 L 395.0922546386719 606.2404174804688 L 390.0820007324219 629.8602294921875 L 386.5032653808594 628.4287109375 L 387.93475341796875 604.0932006835938 L 376.4827575683594 627.7129516601562 L 373.6197509765625 626.9971923828125 L 379.34576416015625 603.37744140625 L 367.8937683105469 620.5554809570312 L 365.03076171875 619.1239624023438 L 375.7669982910156 587.6309204101562 L 366.4622497558594 592.6411743164062 L 363.5992431640625 591.9254150390625 L 377.1985168457031 578.326171875 L 387.2190246582031 572.6001586914062 L 397.95526123046875 554.7064208984375 L 405.1127624511719 540.3914184570312 L 408.6915283203125 526.7921752929688 L 412.98602294921875 512.4771728515625 L 420.8592834472656 497.4464111328125 L 427.301025390625 489.5731506347656 L 432.311279296875 473.82666015625 L 437.321533203125 458.08013916015625 L 440.1845397949219 445.9123840332031 L 438.7530212402344 430.1658935546875 L 442.331787109375 415.85089111328125 L 448.0577697753906 406.546142578125 L 458.7940368652344 397.24139404296875 Z"
                },
                {
                    id: "mi_direito_anterior",
                    nome: "Membro inferior direito (anterior)",
                    percentual: 9,
                    grupo: "Membros Inferiores",
                    vista: "Anterior",
                    cor: "#F38181",
                    path: "M 125.97017669677734 574.0316772460938 L 153.8 575.7 L 166.6 591.6 L 176.3 607.7 L 178.21994018554688 605.5247192382812 L 176.78843688964844 617.6924438476562 L 175.35694885253906 636.3019409179688 L 170.34669494628906 654.1957397460938 L 166.7679443359375 669.9421997070312 L 162.4734344482422 684.9729614257812 L 159.61044311523438 700.0037231445312 L 158.89468383789062 714.3187255859375 L 156.0316925048828 725.0549926757812 L 151.0214385986328 734.3597412109375 L 150.30567932128906 751.5377197265625 L 149.58993530273438 769.4315185546875 L 145.29542541503906 787.3252563476562 L 140.28518676757812 799.4929809570312 L 136.70643615722656 809.5134887695312 L 133.127685546875 830.9860229492188 L 138.8536834716797 846.0167846679688 L 135.27493286132812 853.8900146484375 L 137.42218017578125 863.1947631835938 L 134.55917358398438 868.2050170898438 L 136.70643615722656 876.7940063476562 L 128.8331756591797 888.2460327148438 L 118.81267547607422 886.8145141601562 L 110.93942260742188 886.0988159179688 L 103.78192138671875 886.0988159179688 L 99.48741912841797 882.52001953125 L 109.50791931152344 864.6262817382812 L 114.51817321777344 858.1845092773438 L 113.086669921875 841.7222900390625 L 118.096923828125 830.9860229492188 L 115.23392486572266 814.5237426757812 L 113.80242156982422 785.8937377929688 L 113.086669921875 767.2842407226562 L 113.80242156982422 747.2432250976562 L 123.82292175292969 721.4762573242188 L 125.25442504882812 693.5619506835938 L 124.5386734008789 670.657958984375 L 120.95992279052734 649.9011840820312 L 118.81267547607422 626.2814331054688 L 120.95992279052734 609.1034545898438 L 123.107177734375 589.7781982421875 Z"
                },
                {
                    id: "mi_esquerdo_anterior",
                    nome: "Membro inferior esquerdo (anterior)",
                    percentual: 9,
                    grupo: "Membros Inferiores",
                    vista: "Anterior",
                    cor: "#F38181",
                    path: "M 181.1 607.1 L 189.9 593.9 L 205.8 575.0 L 232.61695861816406 576.178955078125 L 237.62721252441406 596.9356689453125 L 240.49021911621094 621.9869384765625 L 237.62721252441406 652.0484619140625 L 235.47996520996094 672.8052368164062 L 235.47996520996094 700.0037231445312 L 236.91146850585938 720.760498046875 L 244.7847137451172 737.9384765625 L 245.50045776367188 756.5479736328125 L 246.9319610595703 775.8732299804688 L 244.7847137451172 792.3355102539062 L 242.63746643066406 805.218994140625 L 243.35321044921875 819.5339965820312 L 241.20596313476562 830.270263671875 L 246.21621704101562 843.8695068359375 L 246.21621704101562 858.1845092773438 L 258.38397216796875 880.372802734375 L 252.65797424316406 888.2460327148438 L 243.35321044921875 888.9617919921875 L 234.7642059326172 890.393310546875 L 227.60670471191406 886.0988159179688 L 224.0279541015625 875.362548828125 L 225.45945739746094 868.2050170898438 L 222.59645080566406 856.0372924804688 L 221.1649627685547 844.5852661132812 L 224.74371337890625 830.270263671875 L 219.73345947265625 805.218994140625 L 211.86019897460938 783.7465209960938 L 207.56570434570312 762.2739868164062 L 207.56570434570312 745.811767578125 L 208.99720764160156 734.3597412109375 L 201.83970642089844 723.6234741210938 L 198.97669982910156 705.729736328125 L 193.96644592285156 677.8154907226562 L 188.24044799804688 657.0587158203125 L 183.23019409179688 637.7334594726562 L 181.08294677734375 620.5554809570312 L 180.3671875 604.8089599609375 Z"
                },
                {
                    id: "mi_direito_posterior",
                    nome: "Membro inferior direito (posterior)",
                    percentual: 9,
                    grupo: "Membros Inferiores",
                    vista: "Posterior",
                    cor: "#F38181",
                    path: "M 522.4957885742188 614.8294677734375 L 528.2218017578125 621.2711791992188 L 539.673828125 624.1342163085938 L 552.5573120117188 622.7026977539062 L 566.1565551757812 620.5554809570312 L 577.6085815429688 618.408203125 L 576.892822265625 632.7232055664062 L 576.1770629882812 653.47998046875 L 576.892822265625 665.647705078125 L 573.3140869140625 679.9627075195312 L 575.4613037109375 697.8565063476562 L 575.4613037109375 720.760498046875 L 582.6188354492188 737.9384765625 L 586.1975708007812 761.5582275390625 L 584.7660522460938 783.03076171875 L 581.903076171875 800.208740234375 L 582.6188354492188 815.9552612304688 L 581.903076171875 831.7017822265625 L 584.7660522460938 844.5852661132812 L 584.7660522460938 853.8900146484375 L 585.4818115234375 865.342041015625 L 591.2078247070312 873.9310302734375 L 596.933837890625 885.383056640625 L 597.6495971679688 892.54052734375 L 590.4920654296875 898.2665405273438 L 580.4715576171875 899.6980590820312 L 573.3140869140625 902.56103515625 L 563.2935791015625 888.9617919921875 L 564.0093383789062 873.2152709960938 L 564.0093383789062 854.6057739257812 L 559.71484375 846.7325439453125 L 566.1565551757812 832.4175415039062 L 559.71484375 806.6505126953125 L 551.1257934570312 784.4622802734375 L 547.5470581054688 767.2842407226562 L 546.831298828125 733.6439819335938 L 541.1052856445312 720.760498046875 L 536.0950317382812 697.8565063476562 L 531.0847778320312 677.0997314453125 L 526.790283203125 655.627197265625 L 521.780029296875 632.0074462890625 Z"
                },
                {
                    id: "mi_esquerdo_posterior",
                    nome: "Membro inferior esquerdo (posterior)",
                    percentual: 9,
                    grupo: "Membros Inferiores",
                    vista: "Posterior",
                    cor: "#F38181",
                    path: "M 514.62255859375 613.39794921875 L 508.89654541015625 617.6924438476562 L 501.0232849121094 623.41845703125 L 484.56103515625 624.1342163085938 L 458.0782775878906 619.8397216796875 L 459.5097961425781 651.3327026367188 L 463.0885314941406 675.668212890625 L 463.8042907714844 694.9934692382812 L 460.9412841796875 719.3289794921875 L 457.362548828125 730.0652465820312 L 452.352294921875 746.5274658203125 L 451.63653564453125 775.8732299804688 L 455.21527099609375 806.6505126953125 L 455.21527099609375 830.9860229492188 L 452.352294921875 842.4380493164062 L 453.0680236816406 854.6057739257812 L 450.20501708984375 866.0578002929688 L 444.4790344238281 877.509765625 L 439.4687805175781 886.8145141601562 L 438.7530212402344 893.9720458984375 L 446.62628173828125 897.55078125 L 455.9310302734375 901.8452758789062 L 464.5200500488281 899.6980590820312 L 472.3932800292969 889.6775512695312 L 472.3932800292969 873.2152709960938 L 474.54052734375 858.1845092773438 L 478.1192932128906 848.1640014648438 L 472.3932800292969 830.270263671875 L 477.4035339355469 810.229248046875 L 483.1295471191406 790.9039916992188 L 488.85552978515625 777.3047485351562 L 491.0028076171875 757.2637329101562 L 490.28704833984375 735.791259765625 L 494.58154296875 722.90771484375 L 499.591796875 707.1612548828125 L 502.4548034667969 686.4044799804688 L 506.0335388183594 669.9421997070312 L 512.4752807617188 648.4697265625 L 516.769775390625 632.0074462890625 Z"
                },
                {
                    id: "genitalia",
                    nome: "GenitÃ¡lia",
                    percentual: 1,
                    grupo: "GenitÃ¡lia",
                    vista: "Anterior",
                    cor: "#AA96DA",
                    path: "M 153.8,575.7 L 172.5,574.2 L 188.1,574.8 L 205.8,575.0 L 189.9,593.9 L 181.1,607.1 L 176.3,607.7 L 166.6,591.6 Z"
                }
            ]
        }
        // Compartilhar imagem base do ATLAS_ANATOMICO com ATLAS_QUEIMADOS
        if (typeof ATLAS_ANATOMICO !== 'undefined' && ATLAS_ANATOMICO.imagemBase64) {
            ATLAS_QUEIMADOS.imagemBase64 = ATLAS_ANATOMICO.imagemBase64;
            console.log('âœ… Imagem base compartilhada com ATLAS_QUEIMADOS');
        }

        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        // ğŸ”¥ ATLAS LUND-BROWDER v3.1 (32 regiÃµes com coordenadas CORRETAS)
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        const ATLAS_LUND_BROWDER = {
            versao: "3.2-ordem-anatomica",
            data: "2025-11-19T02:00:00.000Z",
            descricao: "Atlas Lund-Browder com 32 regiÃµes em ORDEM ANATÃ”MICA (CabeÃ§aâ†’PescoÃ§oâ†’Troncoâ†’MSâ†’MI)",
            metodo: "lund-browder",
            totalEsperado: 100,
            imagemBase64: null,
            
            faixasEtarias: [
                { id: "0-1", nome: "0-1 ano", min: 0, max: 1 },
                { id: "1-4", nome: "1-4 anos", min: 1, max: 4 },
                { id: "5-9", nome: "5-9 anos", min: 5, max: 9 },
                { id: "10-14", nome: "10-14 anos", min: 10, max: 14 },
                { id: "15+", nome: "15+ anos (adulto)", min: 15, max: 999 }
            ],
            
            regioes: [
                {
                    id: "lb_cabeca_anterior",
                    nome: "CabeÃ§a (anterior)",
                    grupo: "CabeÃ§a e PescoÃ§o",
                    vista: "Anterior",
                    cor: "#FF6B6B",
                    percentuais: { "0-1": 9.5, "1-4": 8.5, "5-9": 6.5, "10-14": 5.5, "15+": 3.5 },
                    points: "165.4817352294922,299.11383056640625 173.25091552734375,295.2292175292969 185.68162536621094,295.2292175292969 197.3354034423828,304.55224609375 205.10459899902344,318.53680419921875 205.8815155029297,327.8598327636719 208.98919677734375,337.182861328125 208.98919677734375,344.9520568847656 202.7738494873047,352.72125244140625 199.66616821289062,361.267333984375 191.89697265625,365.1519470214844 181.79702758789062,367.4826965332031 173.25091552734375,369.0365295410156 163.92788696289062,364.3750305175781 157.71253967285156,352.72125244140625 152.27410888671875,346.5058898925781 150.7202606201172,337.182861328125 154.6048583984375,324.7521667480469 155.38177490234375,316.2060546875",
                    path: "M 165.4817352294922,299.11383056640625 L 173.25091552734375,295.2292175292969 L 185.68162536621094,295.2292175292969 L 197.3354034423828,304.55224609375 L 205.10459899902344,318.53680419921875 L 205.8815155029297,327.8598327636719 L 208.98919677734375,337.182861328125 L 208.98919677734375,344.9520568847656 L 202.7738494873047,352.72125244140625 L 199.66616821289062,361.267333984375 L 191.89697265625,365.1519470214844 L 181.79702758789062,367.4826965332031 L 173.25091552734375,369.0365295410156 L 163.92788696289062,364.3750305175781 L 157.71253967285156,352.72125244140625 L 152.27410888671875,346.5058898925781 L 150.7202606201172,337.182861328125 L 154.6048583984375,324.7521667480469 L 155.38177490234375,316.2060546875 Z"
                },
                {
                    id: "lb_cabeca_posterior",
                    nome: "CabeÃ§a (posterior)",
                    grupo: "CabeÃ§a e PescoÃ§o",
                    vista: "Posterior",
                    cor: "#FF6B6B",
                    percentuais: { "0-1": 9.5, "1-4": 8.5, "5-9": 6.5, "10-14": 5.5, "15+": 3.5 },
                    points: "491.0028076171875,328.52935791015625 492.4342956542969,316.3616027832031 498.87603759765625,303.47808837890625 505.31781005859375,296.3205871582031 517.4855346679688,291.3103332519531 531.800537109375,296.3205871582031 543.2525634765625,313.49859619140625 544.68408203125,328.52935791015625 550.4100341796875,334.25537109375 550.4100341796875,343.56011962890625 542.5368041992188,351.433349609375 534.66357421875,360.0223693847656 521.780029296875,363.6011047363281 513.9067993164062,362.8853759765625 501.7390441894531,360.0223693847656 494.58154296875,351.433349609375 487.4240417480469,344.2758483886719 485.9925537109375,333.53961181640625",
                    path: "M 491.0028076171875,328.52935791015625 L 492.4342956542969,316.3616027832031 L 498.87603759765625,303.47808837890625 L 505.31781005859375,296.3205871582031 L 517.4855346679688,291.3103332519531 L 531.800537109375,296.3205871582031 L 543.2525634765625,313.49859619140625 L 544.68408203125,328.52935791015625 L 550.4100341796875,334.25537109375 L 550.4100341796875,343.56011962890625 L 542.5368041992188,351.433349609375 L 534.66357421875,360.0223693847656 L 521.780029296875,363.6011047363281 L 513.9067993164062,362.8853759765625 L 501.7390441894531,360.0223693847656 L 494.58154296875,351.433349609375 L 487.4240417480469,344.2758483886719 L 485.9925537109375,333.53961181640625 Z"
                },
                {
                    id: "lb_pescoco_anterior",
                    nome: "PescoÃ§o (anterior)",
                    grupo: "CabeÃ§a e PescoÃ§o",
                    vista: "Anterior",
                    cor: "#FFD93D",
                    percentual: 1.0,
                    points: "163.15097045898438,365.9288635253906 174.8047637939453,365.9288635253906 185.68162536621094,366.7057800292969 194.2277374267578,364.3750305175781 197.3354034423828,378.35955810546875 204.3276824951172,386.1287536621094 187.23545837402344,398.5594482421875 172.4739990234375,398.5594482421875 155.38177490234375,386.9056701660156 162.37405395507812,377.5826416015625",
                    path: "M 163.15097045898438,365.9288635253906 L 174.8047637939453,365.9288635253906 L 185.68162536621094,366.7057800292969 L 194.2277374267578,364.3750305175781 L 197.3354034423828,378.35955810546875 L 204.3276824951172,386.1287536621094 L 187.23545837402344,398.5594482421875 L 172.4739990234375,398.5594482421875 L 155.38177490234375,386.9056701660156 L 162.37405395507812,377.5826416015625 Z"
                },
                {
                    id: "lb_pescoco_posterior",
                    nome: "PescoÃ§o (posterior)",
                    grupo: "CabeÃ§a e PescoÃ§o",
                    vista: "Posterior",
                    cor: "#FFD93D",
                    percentual: 1.0,
                    points: "498.1603088378906,360.7381286621094 511.0437927246094,362.8853759765625 523.9273071289062,362.16961669921875 538.2423095703125,359.3066101074219 537.5265502929688,378.6318664550781 546.1155395507812,388.6523742675781 519.6328125,393.6626281738281 491.7185363769531,387.9366149902344 498.87603759765625,380.0633850097656",
                    path: "M 498.1603088378906,360.7381286621094 L 511.0437927246094,362.8853759765625 L 523.9273071289062,362.16961669921875 L 538.2423095703125,359.3066101074219 L 537.5265502929688,378.6318664550781 L 546.1155395507812,388.6523742675781 L 519.6328125,393.6626281738281 L 491.7185363769531,387.9366149902344 L 498.87603759765625,380.0633850097656 Z"
                },
                {
                    id: "lb_tronco_anterior",
                    nome: "Tronco (anterior)",
                    grupo: "Tronco",
                    vista: "Anterior",
                    cor: "#6BCF7F",
                    percentual: 13.0,
                    points: "138.137939453125,396.525634765625 154.60018920898438,386.505126953125 163.18919372558594,392.9468688964844 172.49395751953125,397.9571228027344 186.09320068359375,397.9571228027344 198.26095581054688,392.9468688964844 204.7027130126953,386.505126953125 221.1649627685547,396.525634765625 231.90121459960938,425.87139892578125 231.90121459960938,463.09039306640625 229.03822326660156,475.9739074707031 224.02796936035156,496.0149230957031 224.74371337890625,512.4771728515625 226.89096069335938,526.7921752929688 227.60671997070312,543.2544555664062 231.1854705810547,559.0009155273438 234.04847717285156,573.31591796875 205.8,575.0 189.9,593.9 181.1,607.1 176.3,607.7 166.6,591.6 153.8,575.7 128.11743927001953,572.6001586914062 130.2646942138672,556.8536987304688 133.127685546875,538.2442016601562 134.55918884277344,525.3606567382812 137.4221954345703,506.035400390625 135.99069213867188,493.15191650390625 128.83319091796875,465.9533996582031 128.83319091796875,425.87139892578125 133.127685546875,408.6933898925781",
                    path: "M 138.137939453125,396.525634765625 L 154.60018920898438,386.505126953125 L 163.18919372558594,392.9468688964844 L 172.49395751953125,397.9571228027344 L 186.09320068359375,397.9571228027344 L 198.26095581054688,392.9468688964844 L 204.7027130126953,386.505126953125 L 221.1649627685547,396.525634765625 L 231.90121459960938,425.87139892578125 L 231.90121459960938,463.09039306640625 L 229.03822326660156,475.9739074707031 L 224.02796936035156,496.0149230957031 L 224.74371337890625,512.4771728515625 L 226.89096069335938,526.7921752929688 L 227.60671997070312,543.2544555664062 L 231.1854705810547,559.0009155273438 L 234.04847717285156,573.31591796875 L 205.8,575.0 L 189.9,593.9 L 181.1,607.1 L 176.3,607.7 L 166.6,591.6 L 153.8,575.7 L 128.11743927001953,572.6001586914062 L 130.2646942138672,556.8536987304688 L 133.127685546875,538.2442016601562 L 134.55918884277344,525.3606567382812 L 137.4221954345703,506.035400390625 L 135.99069213867188,493.15191650390625 L 128.83319091796875,465.9533996582031 L 128.83319091796875,425.87139892578125 L 133.127685546875,408.6933898925781 Z"
                },
                {
                    id: "lb_tronco_posterior",
                    nome: "Tronco (posterior)",
                    grupo: "Tronco",
                    vista: "Posterior",
                    cor: "#6BCF7F",
                    percentual: 13.0,
                    points: "476.68780517578125,396.525634765625 491.0028076171875,387.9366149902344 511.7595520019531,393.6626281738281 522.4957885742188,393.6626281738281 546.1155395507812,387.9366149902344 558.9990844726562,395.80987548828125 559.71484375,423.0083923339844 564.72509765625,441.6178894042969 569.7352905273438,463.09039306640625 566.872314453125,474.54241943359375 563.2935791015625,495.2991638183594 563.2935791015625,512.4771728515625 567.5880737304688,528.2236938476562 568.3038330078125,553.9906616210938 570.4510498046875,565.4426879882812 556.1360473632812,561.148193359375 539.673828125,560.4324340820312 524.64306640625,566.158447265625 517.4855346679688,570.4529418945312 509.6123046875,564.7269287109375 493.1500549316406,560.4324340820312 479.55078125,563.29541015625 466.66729736328125,566.158447265625 468.8145446777344,553.27490234375 470.24603271484375,534.6654052734375 473.1090393066406,518.2031860351562 473.8247985839844,498.16217041015625 470.24603271484375,478.12115478515625 468.8145446777344,464.52191162109375 473.1090393066406,442.3336486816406 478.1192932128906,425.1556396484375",
                    path: "M 476.68780517578125,396.525634765625 L 491.0028076171875,387.9366149902344 L 511.7595520019531,393.6626281738281 L 522.4957885742188,393.6626281738281 L 546.1155395507812,387.9366149902344 L 558.9990844726562,395.80987548828125 L 559.71484375,423.0083923339844 L 564.72509765625,441.6178894042969 L 569.7352905273438,463.09039306640625 L 566.872314453125,474.54241943359375 L 563.2935791015625,495.2991638183594 L 563.2935791015625,512.4771728515625 L 567.5880737304688,528.2236938476562 L 568.3038330078125,553.9906616210938 L 570.4510498046875,565.4426879882812 L 556.1360473632812,561.148193359375 L 539.673828125,560.4324340820312 L 524.64306640625,566.158447265625 L 517.4855346679688,570.4529418945312 L 509.6123046875,564.7269287109375 L 493.1500549316406,560.4324340820312 L 479.55078125,563.29541015625 L 466.66729736328125,566.158447265625 L 468.8145446777344,553.27490234375 L 470.24603271484375,534.6654052734375 L 473.1090393066406,518.2031860351562 L 473.8247985839844,498.16217041015625 L 470.24603271484375,478.12115478515625 L 468.8145446777344,464.52191162109375 L 473.1090393066406,442.3336486816406 L 478.1192932128906,425.1556396484375 Z"
                },
                {
                    id: "lb_gluteos",
                    nome: "GlÃºteos (nÃ¡degas)",
                    grupo: "Tronco",
                    vista: "Posterior",
                    cor: "#8FCF7F",
                    percentual: 5.0,
                    points: "467.3830261230469,568.3056640625 490.28704833984375,560.4324340820312 503.88629150390625,562.5797119140625 516.769775390625,569.0214233398438 532.5162963867188,564.0111694335938 543.2525634765625,560.4324340820312 571.1668090820312,566.8742065429688 576.892822265625,585.4837036132812 578.3243408203125,616.2609252929688 561.862060546875,621.9869384765625 544.68408203125,624.1342163085938 530.3690795898438,622.7026977539062 523.2115478515625,616.9766845703125 519.6328125,610.5349731445312 513.9067993164062,616.2609252929688 504.60205078125,621.2711791992188 488.85552978515625,624.1342163085938 473.1090393066406,621.9869384765625 459.5097961425781,619.1239624023438 460.9412841796875,585.4837036132812",
                    path: "M 467.3830261230469,568.3056640625 L 490.28704833984375,560.4324340820312 L 503.88629150390625,562.5797119140625 L 516.769775390625,569.0214233398438 L 532.5162963867188,564.0111694335938 L 543.2525634765625,560.4324340820312 L 571.1668090820312,566.8742065429688 L 576.892822265625,585.4837036132812 L 578.3243408203125,616.2609252929688 L 561.862060546875,621.9869384765625 L 544.68408203125,624.1342163085938 L 530.3690795898438,622.7026977539062 L 523.2115478515625,616.9766845703125 L 519.6328125,610.5349731445312 L 513.9067993164062,616.2609252929688 L 504.60205078125,621.2711791992188 L 488.85552978515625,624.1342163085938 L 473.1090393066406,621.9869384765625 L 459.5097961425781,619.1239624023438 L 460.9412841796875,585.4837036132812 Z"
                },
                {
                    id: "lb_genitalia",
                    nome: "GenitÃ¡lia",
                    grupo: "Tronco",
                    vista: "Anterior",
                    cor: "#FFF3E0",
                    percentual: 1.0,
                    points: "153.8,575.7 172.5,574.2 188.1,574.8 205.8,575.0 189.9,593.9 181.1,607.1 176.3,607.7 166.6,591.6",
                    path: "M 153.8,575.7 L 172.5,574.2 L 188.1,574.8 L 205.8,575.0 L 189.9,593.9 L 181.1,607.1 L 176.3,607.7 L 166.6,591.6 Z"
                },
                {
                    id: "lb_braco_esquerdo_anterior",
                    nome: "BraÃ§o esquerdo (anterior)",
                    grupo: "Membros Superiores",
                    vista: "Anterior",
                    cor: "#AA96DA",
                    percentual: 2.0,
                    points: "223.3122100830078,398.6728820800781 230.46971130371094,422.2926330566406 231.18545532226562,468.10064697265625 246.9319610595703,498.8778991699219 260.5312194824219,496.73065185546875 270.5517272949219,489.5731506347656 259.0997314453125,449.49114990234375 258.38397216796875,417.9981384277344 252.65797424316406,406.546142578125 234.0484619140625,397.24139404296875",
                    path: "M 223.3122100830078,398.6728820800781 L 230.46971130371094,422.2926330566406 L 231.18545532226562,468.10064697265625 L 246.9319610595703,498.8778991699219 L 260.5312194824219,496.73065185546875 L 270.5517272949219,489.5731506347656 L 259.0997314453125,449.49114990234375 L 258.38397216796875,417.9981384277344 L 252.65797424316406,406.546142578125 L 234.0484619140625,397.24139404296875 Z"
                },
                {
                    id: "lb_braco_direito_anterior",
                    nome: "BraÃ§o direito (anterior)",
                    grupo: "Membros Superiores",
                    vista: "Anterior",
                    cor: "#AA96DA",
                    percentual: 2.0,
                    points: "135.9906768798828,397.24139404296875 126.68592834472656,422.2926330566406 128.8331756591797,461.6589050292969 115.94967651367188,487.4259033203125 113.80242156982422,499.5936584472656 98.05591583251953,497.4464111328125 87.31966400146484,489.5731506347656 100.91891479492188,451.6383972167969 98.77166748046875,427.3028869628906 107.36067199707031,409.40911865234375 124.5386734008789,397.9571228027344",
                    path: "M 135.9906768798828,397.24139404296875 L 126.68592834472656,422.2926330566406 L 128.8331756591797,461.6589050292969 L 115.94967651367188,487.4259033203125 L 113.80242156982422,499.5936584472656 L 98.05591583251953,497.4464111328125 L 87.31966400146484,489.5731506347656 L 100.91891479492188,451.6383972167969 L 98.77166748046875,427.3028869628906 L 107.36067199707031,409.40911865234375 L 124.5386734008789,397.9571228027344 Z"
                },
                {
                    id: "lb_braco_esquerdo_posterior",
                    nome: "BraÃ§o esquerdo (posterior)",
                    grupo: "Membros Superiores",
                    vista: "Posterior",
                    cor: "#AA96DA",
                    percentual: 2.0,
                    points: "476.68780517578125,395.80987548828125 477.4035339355469,428.0186462402344 465.9515380859375,461.6589050292969 450.9207763671875,498.8778991699219 426.58526611328125,490.2889099121094 440.1845397949219,446.6281433105469 439.4687805175781,429.45013427734375 444.4790344238281,412.2721252441406 459.5097961425781,398.6728820800781",
                    path: "M 476.68780517578125,395.80987548828125 L 477.4035339355469,428.0186462402344 L 465.9515380859375,461.6589050292969 L 450.9207763671875,498.8778991699219 L 426.58526611328125,490.2889099121094 L 440.1845397949219,446.6281433105469 L 439.4687805175781,429.45013427734375 L 444.4790344238281,412.2721252441406 L 459.5097961425781,398.6728820800781 Z"
                },
                {
                    id: "lb_braco_direito_posterior",
                    nome: "BraÃ§o direito (posterior)",
                    grupo: "Membros Superiores",
                    vista: "Posterior",
                    cor: "#AA96DA",
                    percentual: 2.0,
                    points: "560.4305419921875,395.0941162109375 559.71484375,419.42962646484375 570.4510498046875,463.80615234375 586.913330078125,498.16217041015625 596.933837890625,495.2991638183594 611.2488403320312,489.5731506347656 603.3756103515625,471.6794128417969 598.3653564453125,450.9226379394531 597.6495971679688,435.89190673828125 592.6393432617188,412.2721252441406 579.7557983398438,400.82012939453125",
                    path: "M 560.4305419921875,395.0941162109375 L 559.71484375,419.42962646484375 L 570.4510498046875,463.80615234375 L 586.913330078125,498.16217041015625 L 596.933837890625,495.2991638183594 L 611.2488403320312,489.5731506347656 L 603.3756103515625,471.6794128417969 L 598.3653564453125,450.9226379394531 L 597.6495971679688,435.89190673828125 L 592.6393432617188,412.2721252441406 L 579.7557983398438,400.82012939453125 Z"
                },
                {
                    id: "lb_antebraco_esquerdo_anterior",
                    nome: "AntebraÃ§o esquerdo (anterior)",
                    grupo: "Membros Superiores",
                    vista: "Anterior",
                    cor: "#C3AED6",
                    percentual: 1.5,
                    points: "246.21621704101562,499.5936584472656 261.96270751953125,494.5834045410156 271.98321533203125,489.5731506347656 280.5722351074219,501.74090576171875 288.4454650878906,523.2134399414062 292.739990234375,538.9598999023438 309.9179992675781,569.0214233398438 287.729736328125,577.6104125976562 287.01397705078125,570.4529418945312 272.698974609375,548.9804077148438 264.1099853515625,536.8126831054688 255.52096557617188,520.3504028320312 250.51071166992188,508.18267822265625",
                    path: "M 246.21621704101562,499.5936584472656 L 261.96270751953125,494.5834045410156 L 271.98321533203125,489.5731506347656 L 280.5722351074219,501.74090576171875 L 288.4454650878906,523.2134399414062 L 292.739990234375,538.9598999023438 L 309.9179992675781,569.0214233398438 L 287.729736328125,577.6104125976562 L 287.01397705078125,570.4529418945312 L 272.698974609375,548.9804077148438 L 264.1099853515625,536.8126831054688 L 255.52096557617188,520.3504028320312 L 250.51071166992188,508.18267822265625 Z"
                },
                {
                    id: "lb_antebraco_direito_anterior",
                    nome: "AntebraÃ§o direito (anterior)",
                    grupo: "Membros Superiores",
                    vista: "Anterior",
                    cor: "#C3AED6",
                    percentual: 1.5,
                    points: "87.31966400146484,489.5731506347656 98.77166748046875,496.0149230957031 113.80242156982422,500.3094177246094 100.91891479492188,528.9393920898438 89.46691131591797,541.8229370117188 72.28890991210938,566.158447265625 73.0046615600586,576.178955078125 65.13140869140625,574.7474365234375 49.38490295410156,570.4529418945312 56.54240417480469,559.7166748046875 64.41565704345703,545.4016723632812 69.42591094970703,529.6551513671875 72.28890991210938,517.4874267578125 77.29916381835938,502.4566650390625",
                    path: "M 87.31966400146484,489.5731506347656 L 98.77166748046875,496.0149230957031 L 113.80242156982422,500.3094177246094 L 100.91891479492188,528.9393920898438 L 89.46691131591797,541.8229370117188 L 72.28890991210938,566.158447265625 L 73.0046615600586,576.178955078125 L 65.13140869140625,574.7474365234375 L 49.38490295410156,570.4529418945312 L 56.54240417480469,559.7166748046875 L 64.41565704345703,545.4016723632812 L 69.42591094970703,529.6551513671875 L 72.28890991210938,517.4874267578125 L 77.29916381835938,502.4566650390625 Z"
                },
                {
                    id: "lb_antebraco_esquerdo_posterior",
                    nome: "AntebraÃ§o esquerdo (posterior)",
                    grupo: "Membros Superiores",
                    vista: "Posterior",
                    cor: "#C3AED6",
                    percentual: 1.5,
                    points: "425.8695373535156,490.2889099121094 448.7735290527344,500.3094177246094 446.62628173828125,508.8984069824219 439.4687805175781,527.5079345703125 429.4482727050781,543.9701538085938 412.98602294921875,564.0111694335938 411.55450439453125,576.178955078125 387.2190246582031,572.6001586914062 392.94500732421875,562.5797119140625 402.96551513671875,548.9804077148438 408.6915283203125,530.3709106445312 414.4175109863281,508.8984069824219",
                    path: "M 425.8695373535156,490.2889099121094 L 448.7735290527344,500.3094177246094 L 446.62628173828125,508.8984069824219 L 439.4687805175781,527.5079345703125 L 429.4482727050781,543.9701538085938 L 412.98602294921875,564.0111694335938 L 411.55450439453125,576.178955078125 L 387.2190246582031,572.6001586914062 L 392.94500732421875,562.5797119140625 L 402.96551513671875,548.9804077148438 L 408.6915283203125,530.3709106445312 L 414.4175109863281,508.8984069824219 Z"
                },
                {
                    id: "lb_antebraco_direito_posterior",
                    nome: "AntebraÃ§o direito (posterior)",
                    grupo: "Membros Superiores",
                    vista: "Posterior",
                    cor: "#C3AED6",
                    percentual: 1.5,
                    points: "586.1975708007812,500.3094177246094 611.964599609375,487.4259033203125 621.2693481445312,503.8881530761719 626.2796020507812,518.2031860351562 632.7213134765625,535.3811645507812 644.8890991210938,567.5899047851562 626.2796020507812,576.178955078125 621.2693481445312,560.4324340820312 609.1015625,547.5489501953125 599.0810546875,529.6551513671875 590.4920654296875,515.3401489257812",
                    path: "M 586.1975708007812,500.3094177246094 L 611.964599609375,487.4259033203125 L 621.2693481445312,503.8881530761719 L 626.2796020507812,518.2031860351562 L 632.7213134765625,535.3811645507812 L 644.8890991210938,567.5899047851562 L 626.2796020507812,576.178955078125 L 621.2693481445312,560.4324340820312 L 609.1015625,547.5489501953125 L 599.0810546875,529.6551513671875 L 590.4920654296875,515.3401489257812 Z"
                },
                {
                    id: "lb_mao_esquerda_anterior",
                    nome: "MÃ£o esquerda (anterior)",
                    grupo: "Membros Superiores",
                    vista: "Anterior",
                    cor: "#E8DAEF",
                    percentual: 1.25,
                    points: "286.2982177734375,576.8947143554688 310.63372802734375,569.7371826171875 337.8322448730469,590.4939575195312 334.25347900390625,594.7884521484375 319.9384765625,589.7781982421875 336.4007568359375,619.8397216796875 333.5377502441406,620.5554809570312 317.7912292480469,601.230224609375 327.8117370605469,629.8602294921875 324.94873046875,630.575927734375 310.63372802734375,606.9561767578125 314.2124938964844,630.575927734375 308.4864807128906,633.43896484375 303.4762268066406,607.6719360351562 298.4659729003906,626.9971923828125 294.1714782714844,623.41845703125 294.1714782714844,606.9561767578125 289.8769836425781,592.6411743164062",
                    path: "M 286.2982177734375,576.8947143554688 L 310.63372802734375,569.7371826171875 L 337.8322448730469,590.4939575195312 L 334.25347900390625,594.7884521484375 L 319.9384765625,589.7781982421875 L 336.4007568359375,619.8397216796875 L 333.5377502441406,620.5554809570312 L 317.7912292480469,601.230224609375 L 327.8117370605469,629.8602294921875 L 324.94873046875,630.575927734375 L 310.63372802734375,606.9561767578125 L 314.2124938964844,630.575927734375 L 308.4864807128906,633.43896484375 L 303.4762268066406,607.6719360351562 L 298.4659729003906,626.9971923828125 L 294.1714782714844,623.41845703125 L 294.1714782714844,606.9561767578125 L 289.8769836425781,592.6411743164062 Z"
                },
                {
                    id: "lb_mao_direita_anterior",
                    nome: "MÃ£o direita (anterior)",
                    grupo: "Membros Superiores",
                    vista: "Anterior",
                    cor: "#E8DAEF",
                    percentual: 1.25,
                    points: "49.38490295410156,571.8844604492188 64.41565704345703,575.4631958007812 72.28890991210938,576.8947143554688 70.85740661621094,591.209716796875 65.13140869140625,602.6616821289062 64.41565704345703,624.1342163085938 62.98415756225586,624.1342163085938 58.68965530395508,609.8192138671875 51.53215026855469,632.7232055664062 47.953399658203125,632.7232055664062 47.953399658203125,605.5247192382812 39.36439895629883,629.8602294921875 35.785648345947266,627.7129516601562 43.65890121459961,601.230224609375 30.05964469909668,621.2711791992188 26.480894088745117,618.408203125 42.22739791870117,586.199462890625 30.05964469909668,594.7884521484375 25.76514434814453,591.9254150390625 36.50139617919922,580.4734497070312",
                    path: "M 49.38490295410156,571.8844604492188 L 64.41565704345703,575.4631958007812 L 72.28890991210938,576.8947143554688 L 70.85740661621094,591.209716796875 L 65.13140869140625,602.6616821289062 L 64.41565704345703,624.1342163085938 L 62.98415756225586,624.1342163085938 L 58.68965530395508,609.8192138671875 L 51.53215026855469,632.7232055664062 L 47.953399658203125,632.7232055664062 L 47.953399658203125,605.5247192382812 L 39.36439895629883,629.8602294921875 L 35.785648345947266,627.7129516601562 L 43.65890121459961,601.230224609375 L 30.05964469909668,621.2711791992188 L 26.480894088745117,618.408203125 L 42.22739791870117,586.199462890625 L 30.05964469909668,594.7884521484375 L 25.76514434814453,591.9254150390625 L 36.50139617919922,580.4734497070312 Z"
                },
                {
                    id: "lb_mao_esquerda_posterior",
                    nome: "MÃ£o esquerda (posterior)",
                    grupo: "Membros Superiores",
                    vista: "Posterior",
                    cor: "#E8DAEF",
                    percentual: 1.25,
                    points: "390.0820007324219,571.168701171875 408.6915283203125,577.6104125976562 409.4072570800781,591.9254150390625 405.8285217285156,601.9459228515625 405.1127624511719,621.2711791992188 400.8182678222656,626.2814331054688 396.5237731933594,604.0932006835938 391.5135192871094,626.9971923828125 387.2190246582031,626.9971923828125 387.2190246582031,606.2404174804688 380.0615234375,628.4287109375 375.05126953125,626.9971923828125 380.0615234375,601.230224609375 366.4622497558594,621.2711791992188 364.31500244140625,619.1239624023438 377.91424560546875,587.6309204101562 366.4622497558594,595.5042114257812 361.4519958496094,593.35693359375 375.05126953125,579.7576904296875",
                    path: "M 390.0820007324219,571.168701171875 L 408.6915283203125,577.6104125976562 L 409.4072570800781,591.9254150390625 L 405.8285217285156,601.9459228515625 L 405.1127624511719,621.2711791992188 L 400.8182678222656,626.2814331054688 L 396.5237731933594,604.0932006835938 L 391.5135192871094,626.9971923828125 L 387.2190246582031,626.9971923828125 L 387.2190246582031,606.2404174804688 L 380.0615234375,628.4287109375 L 375.05126953125,626.9971923828125 L 380.0615234375,601.230224609375 L 366.4622497558594,621.2711791992188 L 364.31500244140625,619.1239624023438 L 377.91424560546875,587.6309204101562 L 366.4622497558594,595.5042114257812 L 361.4519958496094,593.35693359375 L 375.05126953125,579.7576904296875 Z"
                },
                {
                    id: "lb_mao_direita_posterior",
                    nome: "MÃ£o direita (posterior)",
                    grupo: "Membros Superiores",
                    vista: "Posterior",
                    cor: "#E8DAEF",
                    percentual: 1.25,
                    points: "626.2796020507812,579.0419311523438 647.7520751953125,567.5899047851562 662.7828369140625,581.189208984375 676.382080078125,594.0726928710938 674.9506225585938,594.0726928710938 658.4883422851562,588.3466796875 674.23486328125,618.408203125 672.8033447265625,619.8397216796875 655.6253662109375,601.9459228515625 667.7930908203125,627.7129516601562 664.21435546875,629.1444702148438 647.0363159179688,604.8089599609375 654.9096069335938,629.1444702148438 650.6151123046875,630.575927734375 640.5946044921875,605.5247192382812 638.4473266601562,623.41845703125 634.15283203125,623.41845703125 632.7213134765625,602.6616821289062",
                    path: "M 626.2796020507812,579.0419311523438 L 647.7520751953125,567.5899047851562 L 662.7828369140625,581.189208984375 L 676.382080078125,594.0726928710938 L 674.9506225585938,594.0726928710938 L 658.4883422851562,588.3466796875 L 674.23486328125,618.408203125 L 672.8033447265625,619.8397216796875 L 655.6253662109375,601.9459228515625 L 667.7930908203125,627.7129516601562 L 664.21435546875,629.1444702148438 L 647.0363159179688,604.8089599609375 L 654.9096069335938,629.1444702148438 L 650.6151123046875,630.575927734375 L 640.5946044921875,605.5247192382812 L 638.4473266601562,623.41845703125 L 634.15283203125,623.41845703125 L 632.7213134765625,602.6616821289062 Z"
                },
                {
                    id: "lb_coxa_esquerda_anterior",
                    nome: "Coxa esquerda (anterior)",
                    grupo: "Membros Inferiores",
                    vista: "Anterior",
                    cor: "#FFB6C1",
                    percentuais: { "0-1": 2.75, "1-4": 3.25, "5-9": 4.0, "10-14": 4.25, "15+": 4.75 },
                    points: "181.1,607.1 189.9,593.9 205.8,575.0 232.80165100097656,575.6272583007812 239.17979431152344,617.085205078125 238.3825225830078,651.3677368164062 236.78797912597656,675.2857666015625 233.5989227294922,692.0283813476562 237.5852508544922,719.9327392578125 220.84263610839844,725.5136108398438 204.10000610351562,723.9190673828125 200.11367797851562,714.3518676757812 195.33006286621094,688.8392944335938 189.7491912841797,662.5294799804688 184.96559143066406,644.9895629882812 181.77651977539062,625.057861328125",
                    path: "M 181.1,607.1 L 189.9,593.9 L 205.8,575.0 L 232.80165100097656,575.6272583007812 L 239.17979431152344,617.085205078125 L 238.3825225830078,651.3677368164062 L 236.78797912597656,675.2857666015625 L 233.5989227294922,692.0283813476562 L 237.5852508544922,719.9327392578125 L 220.84263610839844,725.5136108398438 L 204.10000610351562,723.9190673828125 L 200.11367797851562,714.3518676757812 L 195.33006286621094,688.8392944335938 L 189.7491912841797,662.5294799804688 L 184.96559143066406,644.9895629882812 L 181.77651977539062,625.057861328125 Z"
                },
                {
                    id: "lb_coxa_direita_anterior",
                    nome: "Coxa direita (anterior)",
                    grupo: "Membros Inferiores",
                    vista: "Anterior",
                    cor: "#FFB6C1",
                    percentuais: { "0-1": 2.75, "1-4": 3.25, "5-9": 4.0, "10-14": 4.25, "15+": 4.75 },
                    points: "125.97017669677734,574.7474365234375 153.8,575.7 166.6,591.6 176.3,607.7 173.92544555664062,635.586181640625 161.04193115234375,691.4147338867188 161.7576904296875,711.4557495117188 156.7474365234375,724.3392333984375 137.42218017578125,724.3392333984375 123.82292175292969,722.1919555664062 125.97017669677734,695.709228515625 124.5386734008789,667.0792236328125 119.52842712402344,627.7129516601562 121.67567443847656,599.0829467773438",
                    path: "M 125.97017669677734,574.7474365234375 L 153.8,575.7 L 166.6,591.6 L 176.3,607.7 L 173.92544555664062,635.586181640625 L 161.04193115234375,691.4147338867188 L 161.7576904296875,711.4557495117188 L 156.7474365234375,724.3392333984375 L 137.42218017578125,724.3392333984375 L 123.82292175292969,722.1919555664062 L 125.97017669677734,695.709228515625 L 124.5386734008789,667.0792236328125 L 119.52842712402344,627.7129516601562 L 121.67567443847656,599.0829467773438 Z"
                },
                {
                    id: "lb_coxa_esquerda_posterior",
                    nome: "Coxa esquerda (posterior)",
                    grupo: "Membros Inferiores",
                    vista: "Posterior",
                    cor: "#FFB6C1",
                    percentuais: { "0-1": 2.75, "1-4": 3.25, "5-9": 4.0, "10-14": 4.25, "15+": 4.75 },
                    points: "515.3383178710938,614.8294677734375 517.4855346679688,630.575927734375 509.6123046875,658.490234375 506.0335388183594,677.8154907226562 501.7390441894531,702.86669921875 499.591796875,713.6029663085938 493.86578369140625,725.770751953125 492.4342956542969,730.0652465820312 461.65704345703125,720.0447387695312 464.5200500488281,687.8359985351562 460.22552490234375,650.616943359375 458.7940368652344,617.6924438476562 472.3932800292969,621.9869384765625 492.4342956542969,623.41845703125 503.1705627441406,622.7026977539062",
                    path: "M 515.3383178710938,614.8294677734375 L 517.4855346679688,630.575927734375 L 509.6123046875,658.490234375 L 506.0335388183594,677.8154907226562 L 501.7390441894531,702.86669921875 L 499.591796875,713.6029663085938 L 493.86578369140625,725.770751953125 L 492.4342956542969,730.0652465820312 L 461.65704345703125,720.0447387695312 L 464.5200500488281,687.8359985351562 L 460.22552490234375,650.616943359375 L 458.7940368652344,617.6924438476562 L 472.3932800292969,621.9869384765625 L 492.4342956542969,623.41845703125 L 503.1705627441406,622.7026977539062 Z"
                },
                {
                    id: "lb_coxa_direita_posterior",
                    nome: "Coxa direita (posterior)",
                    grupo: "Membros Inferiores",
                    vista: "Posterior",
                    cor: "#FFB6C1",
                    percentuais: { "0-1": 2.75, "1-4": 3.25, "5-9": 4.0, "10-14": 4.25, "15+": 4.75 },
                    points: "522.4957885742188,615.5452270507812 536.810791015625,623.41845703125 549.6943359375,622.7026977539062 561.1463012695312,620.5554809570312 577.6085815429688,617.6924438476562 577.6085815429688,649.1854858398438 577.6085815429688,669.9421997070312 574.7455444335938,682.1099853515625 575.4613037109375,719.3289794921875 556.1360473632812,729.3494873046875 545.3998413085938,727.2022094726562 541.821044921875,717.1817626953125 534.66357421875,691.4147338867188 530.3690795898438,667.0792236328125 525.3588256835938,646.3224487304688 521.780029296875,631.2916870117188",
                    path: "M 522.4957885742188,615.5452270507812 L 536.810791015625,623.41845703125 L 549.6943359375,622.7026977539062 L 561.1463012695312,620.5554809570312 L 577.6085815429688,617.6924438476562 L 577.6085815429688,649.1854858398438 L 577.6085815429688,669.9421997070312 L 574.7455444335938,682.1099853515625 L 575.4613037109375,719.3289794921875 L 556.1360473632812,729.3494873046875 L 545.3998413085938,727.2022094726562 L 541.821044921875,717.1817626953125 L 534.66357421875,691.4147338867188 L 530.3690795898438,667.0792236328125 L 525.3588256835938,646.3224487304688 L 521.780029296875,631.2916870117188 Z"
                },
                {
                    id: "lb_perna_esquerda_anterior",
                    nome: "Perna esquerda (anterior)",
                    grupo: "Membros Inferiores",
                    vista: "Anterior",
                    cor: "#FFDAB9",
                    percentuais: { "0-1": 2.5, "1-4": 2.5, "5-9": 2.75, "10-14": 3.0, "15+": 3.5 },
                    points: "218.3019561767578,725.770751953125 236.19570922851562,722.1919555664062 242.63746643066406,737.2227172851562 245.50045776367188,755.1165161132812 248.36346435546875,773.01025390625 244.7847137451172,804.5032348632812 244.7847137451172,835.9962768554688 227.60670471191406,835.280517578125 219.73345947265625,804.5032348632812 211.86019897460938,781.5992431640625 208.2814483642578,754.4007568359375 209.71295166015625,735.0755004882812 203.2711944580078,723.6234741210938",
                    path: "M 218.3019561767578,725.770751953125 L 236.19570922851562,722.1919555664062 L 242.63746643066406,737.2227172851562 L 245.50045776367188,755.1165161132812 L 248.36346435546875,773.01025390625 L 244.7847137451172,804.5032348632812 L 244.7847137451172,835.9962768554688 L 227.60670471191406,835.280517578125 L 219.73345947265625,804.5032348632812 L 211.86019897460938,781.5992431640625 L 208.2814483642578,754.4007568359375 L 209.71295166015625,735.0755004882812 L 203.2711944580078,723.6234741210938 Z"
                },
                {
                    id: "lb_perna_direita_anterior",
                    nome: "Perna direita (anterior)",
                    grupo: "Membros Inferiores",
                    vista: "Anterior",
                    cor: "#FFDAB9",
                    percentuais: { "0-1": 2.5, "1-4": 2.5, "5-9": 2.75, "10-14": 3.0, "15+": 3.5 },
                    points: "124.5386734008789,722.1919555664062 136.70643615722656,724.3392333984375 155.31593322753906,726.4865112304688 152.45294189453125,732.92822265625 152.45294189453125,755.832275390625 148.87417602539062,778.0205078125 146.0111846923828,788.7567749023438 139.56942749023438,801.6402587890625 135.9906768798828,818.1025390625 135.9906768798828,826.6915283203125 125.25442504882812,834.5647583007812 115.94967651367188,831.7017822265625 115.94967651367188,807.3662719726562 112.37091827392578,780.167724609375 112.37091827392578,762.98974609375 115.23392486572266,745.0960083007812",
                    path: "M 124.5386734008789,722.1919555664062 L 136.70643615722656,724.3392333984375 L 155.31593322753906,726.4865112304688 L 152.45294189453125,732.92822265625 L 152.45294189453125,755.832275390625 L 148.87417602539062,778.0205078125 L 146.0111846923828,788.7567749023438 L 139.56942749023438,801.6402587890625 L 135.9906768798828,818.1025390625 L 135.9906768798828,826.6915283203125 L 125.25442504882812,834.5647583007812 L 115.94967651367188,831.7017822265625 L 115.94967651367188,807.3662719726562 L 112.37091827392578,780.167724609375 L 112.37091827392578,762.98974609375 L 115.23392486572266,745.0960083007812 Z"
                },
                {
                    id: "lb_perna_esquerda_posterior",
                    nome: "Perna esquerda (posterior)",
                    grupo: "Membros Inferiores",
                    vista: "Posterior",
                    cor: "#FFDAB9",
                    percentuais: { "0-1": 2.5, "1-4": 2.5, "5-9": 2.75, "10-14": 3.0, "15+": 3.5 },
                    points: "461.65704345703125,722.1919555664062 491.7185363769531,730.781005859375 490.28704833984375,743.6644897460938 491.0028076171875,758.6952514648438 490.28704833984375,775.1575317382812 483.1295471191406,792.3355102539062 477.4035339355469,810.229248046875 474.54052734375,833.8489990234375 455.21527099609375,832.4175415039062 454.4995422363281,803.7875366210938 451.63653564453125,777.3047485351562 453.7837829589844,746.5274658203125 455.9310302734375,733.6439819335938",
                    path: "M 461.65704345703125,722.1919555664062 L 491.7185363769531,730.781005859375 L 490.28704833984375,743.6644897460938 L 491.0028076171875,758.6952514648438 L 490.28704833984375,775.1575317382812 L 483.1295471191406,792.3355102539062 L 477.4035339355469,810.229248046875 L 474.54052734375,833.8489990234375 L 455.21527099609375,832.4175415039062 L 454.4995422363281,803.7875366210938 L 451.63653564453125,777.3047485351562 L 453.7837829589844,746.5274658203125 L 455.9310302734375,733.6439819335938 Z"
                },
                {
                    id: "lb_perna_direita_posterior",
                    nome: "Perna direita (posterior)",
                    grupo: "Membros Inferiores",
                    vista: "Posterior",
                    cor: "#FFDAB9",
                    percentuais: { "0-1": 2.5, "1-4": 2.5, "5-9": 2.75, "10-14": 3.0, "15+": 3.5 },
                    points: "545.3998413085938,729.3494873046875 555.4202880859375,729.3494873046875 574.7455444335938,722.1919555664062 584.7660522460938,747.958984375 585.4818115234375,783.7465209960938 582.6188354492188,807.3662719726562 582.6188354492188,832.4175415039062 565.4407958984375,833.8489990234375 558.9990844726562,803.7875366210938 548.9785766601562,771.5787353515625 546.1155395507812,747.958984375",
                    path: "M 545.3998413085938,729.3494873046875 L 555.4202880859375,729.3494873046875 L 574.7455444335938,722.1919555664062 L 584.7660522460938,747.958984375 L 585.4818115234375,783.7465209960938 L 582.6188354492188,807.3662719726562 L 582.6188354492188,832.4175415039062 L 565.4407958984375,833.8489990234375 L 558.9990844726562,803.7875366210938 L 548.9785766601562,771.5787353515625 L 546.1155395507812,747.958984375 Z"
                },
                {
                    id: "lb_pe_esquerdo_anterior",
                    nome: "PÃ© esquerdo (anterior)",
                    grupo: "Membros Inferiores",
                    vista: "Anterior",
                    cor: "#A8E6CF",
                    percentuais: { "0-1": 1.75, "1-4": 1.75, "5-9": 1.75, "10-14": 1.75, "15+": 1.75 },
                    points: "224.0279541015625,835.280517578125 243.35321044921875,836.7120361328125 247.64772033691406,844.5852661132812 246.21621704101562,855.321533203125 258.38397216796875,879.6570434570312 256.2367248535156,886.8145141601562 236.19570922851562,889.6775512695312 226.89096069335938,885.383056640625 223.3122100830078,877.509765625 225.45945739746094,865.342041015625 219.73345947265625,847.4483032226562",
                    path: "M 224.0279541015625,835.280517578125 L 243.35321044921875,836.7120361328125 L 247.64772033691406,844.5852661132812 L 246.21621704101562,855.321533203125 L 258.38397216796875,879.6570434570312 L 256.2367248535156,886.8145141601562 L 236.19570922851562,889.6775512695312 L 226.89096069335938,885.383056640625 L 223.3122100830078,877.509765625 L 225.45945739746094,865.342041015625 L 219.73345947265625,847.4483032226562 Z"
                },
                {
                    id: "lb_pe_direito_anterior",
                    nome: "PÃ© direito (anterior)",
                    grupo: "Membros Inferiores",
                    vista: "Anterior",
                    cor: "#A8E6CF",
                    percentuais: { "0-1": 1.75, "1-4": 1.75, "5-9": 1.75, "10-14": 1.75, "15+": 1.75 },
                    points: "115.94967651367188,833.13330078125 134.55917358398438,830.9860229492188 138.8536834716797,846.0167846679688 136.70643615722656,855.321533203125 138.13792419433594,861.7633056640625 134.55917358398438,868.2050170898438 136.70643615722656,876.0783081054688 130.26467895507812,886.8145141601562 105.92916870117188,887.5302734375 98.77166748046875,882.52001953125 114.51817321777344,858.1845092773438 111.6551742553711,843.8695068359375",
                    path: "M 115.94967651367188,833.13330078125 L 134.55917358398438,830.9860229492188 L 138.8536834716797,846.0167846679688 L 136.70643615722656,855.321533203125 L 138.13792419433594,861.7633056640625 L 134.55917358398438,868.2050170898438 L 136.70643615722656,876.0783081054688 L 130.26467895507812,886.8145141601562 L 105.92916870117188,887.5302734375 L 98.77166748046875,882.52001953125 L 114.51817321777344,858.1845092773438 L 111.6551742553711,843.8695068359375 Z"
                },
                {
                    id: "lb_pe_esquerdo_posterior",
                    nome: "PÃ© esquerdo (posterior)",
                    grupo: "Membros Inferiores",
                    vista: "Posterior",
                    cor: "#A8E6CF",
                    percentuais: { "0-1": 1.75, "1-4": 1.75, "5-9": 1.75, "10-14": 1.75, "15+": 1.75 },
                    points: "454.4995422363281,832.4175415039062 472.3932800292969,833.13330078125 478.1192932128906,846.7325439453125 475.25628662109375,856.0372924804688 474.54052734375,885.383056640625 468.0987854003906,898.2665405273438 458.0782775878906,899.6980590820312 440.9002685546875,894.6878051757812 437.321533203125,887.5302734375 449.4892883300781,869.6365356445312 451.63653564453125,857.46875 450.9207763671875,844.5852661132812 453.7837829589844,831.7017822265625 472.3932800292969,833.13330078125",
                    path: "M 454.4995422363281,832.4175415039062 L 472.3932800292969,833.13330078125 L 478.1192932128906,846.7325439453125 L 475.25628662109375,856.0372924804688 L 474.54052734375,885.383056640625 L 468.0987854003906,898.2665405273438 L 458.0782775878906,899.6980590820312 L 440.9002685546875,894.6878051757812 L 437.321533203125,887.5302734375 L 449.4892883300781,869.6365356445312 L 451.63653564453125,857.46875 L 450.9207763671875,844.5852661132812 L 453.7837829589844,831.7017822265625 L 472.3932800292969,833.13330078125 Z"
                },
                {
                    id: "lb_pe_direito_posterior",
                    nome: "PÃ© direito (posterior)",
                    grupo: "Membros Inferiores",
                    vista: "Posterior",
                    cor: "#A8E6CF",
                    percentuais: { "0-1": 1.75, "1-4": 1.75, "5-9": 1.75, "10-14": 1.75, "15+": 1.75 },
                    points: "564.0093383789062,833.8489990234375 582.6188354492188,832.4175415039062 586.913330078125,843.8695068359375 584.0503540039062,856.7530517578125 586.1975708007812,866.0578002929688 595.5023193359375,882.52001953125 597.6495971679688,890.393310546875 574.7455444335938,901.1295166015625 564.72509765625,891.1090698242188 563.2935791015625,853.8900146484375 558.9990844726562,846.0167846679688 562.5778198242188,834.5647583007812",
                    path: "M 564.0093383789062,833.8489990234375 L 582.6188354492188,832.4175415039062 L 586.913330078125,843.8695068359375 L 584.0503540039062,856.7530517578125 L 586.1975708007812,866.0578002929688 L 595.5023193359375,882.52001953125 L 597.6495971679688,890.393310546875 L 574.7455444335938,901.1295166015625 L 564.72509765625,891.1090698242188 L 563.2935791015625,853.8900146484375 L 558.9990844726562,846.0167846679688 L 562.5778198242188,834.5647583007812 Z"
                }
            ],            
            obterRegioesPorVista(vista) {
                return this.regioes.filter(r => r.vista === vista);
            },
            
            obterPercentual(regiaoId, faixaEtaria) {
                const regiao = this.regioes.find(r => r.id === regiaoId);
                if (!regiao) return 0;
                if (regiao.percentuais) return regiao.percentuais[faixaEtaria] || 0;
                return regiao.percentual || 0;
            },
            
            validarTotal(faixaEtaria) {
                let total = 0;
                this.regioes.forEach(r => {
                    total += this.obterPercentual(r.id, faixaEtaria);
                });
                return Math.round(total * 100) / 100;
            },
            
            obterDescricaoRegiao(regiaoId) {
                const regiao = this.regioes.find(r => r.id === regiaoId);
                return regiao ? regiao.nome : regiaoId;
            }
        };

        // Compartilhar imagem do ATLAS_ANATOMICO com ATLAS_LUND_BROWDER
        if (typeof ATLAS_ANATOMICO !== 'undefined' && ATLAS_ANATOMICO.imagemBase64) {
            ATLAS_LUND_BROWDER.imagemBase64 = ATLAS_ANATOMICO.imagemBase64;
            console.log('âœ… Imagem base compartilhada com ATLAS_LUND_BROWDER');
        }
        
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        // ğŸ’¾ CARREGAR ATLAS DO LOCALSTORAGE (ALTERAÃ‡Ã•ES SALVAS PELO EDITOR)
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        // IMPORTANTE: Este cÃ³digo SUBSTITUI os arrays globais propositalmente!
        // Isso Ã© correto porque:
        // 1. As ediÃ§Ãµes do Editor devem persistir nos objetos globais
        // 2. deepCopyAtlas() garante que cada instÃ¢ncia tenha sua prÃ³pria cÃ³pia independente
        // 3. NÃ£o hÃ¡ mais risco de contaminaÃ§Ã£o entre atlas diferentes
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        // ğŸ’¾ Guardar cÃ³pia dos atlas originais (ANTES de carregar localStorage)
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        window.ATLAS_ANATOMICO_ORIGINAL = JSON.parse(JSON.stringify(ATLAS_ANATOMICO.regioes));
        window.ATLAS_QUEIMADOS_ORIGINAL = JSON.parse(JSON.stringify(ATLAS_QUEIMADOS.regioes));
        window.ATLAS_LUND_BROWDER_ORIGINAL = JSON.parse(JSON.stringify(ATLAS_LUND_BROWDER.regioes));
        console.log('ğŸ“¦ Atlas originais salvos para referÃªncia de reparo');
        
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        
        (function carregarAtlasDoLocalStorage() {
            console.log('\nğŸ’¾ Verificando atlas salvos no localStorage...');
            
            // ATLAS ANATÃ”MICO
            const atlasAnatomico = localStorage.getItem('ATLAS_ANATOMICO');
            if (atlasAnatomico) {
                try {
                    const atlasSalvo = JSON.parse(atlasAnatomico);
                    // Sobrescrever regiÃµes com as editadas
                    ATLAS_ANATOMICO.regioes = atlasSalvo.regioes;
                    console.log('âœ… ATLAS_ANATOMICO carregado do localStorage (versÃ£o editada)');
                } catch (e) {
                    console.warn('âš ï¸ Erro ao carregar ATLAS_ANATOMICO do localStorage:', e);
                }
            }
            
            // ATLAS QUEIMADOS (REGRA DOS 9)
            const atlasQueimados = localStorage.getItem('ATLAS_QUEIMADOS');
            if (atlasQueimados) {
                try {
                    const atlasSalvo = JSON.parse(atlasQueimados);
                    ATLAS_QUEIMADOS.regioes = atlasSalvo.regioes;
                    console.log('âœ… ATLAS_QUEIMADOS carregado do localStorage (versÃ£o editada)');
                } catch (e) {
                    console.warn('âš ï¸ Erro ao carregar ATLAS_QUEIMADOS do localStorage:', e);
                }
            }
            
            // ATLAS LUND-BROWDER
            const atlasLundBrowder = localStorage.getItem('ATLAS_LUND_BROWDER');
            if (atlasLundBrowder) {
                try {
                    const atlasSalvo = JSON.parse(atlasLundBrowder);
                    ATLAS_LUND_BROWDER.regioes = atlasSalvo.regioes;
                    console.log('âœ… ATLAS_LUND_BROWDER carregado do localStorage (versÃ£o editada)');
                } catch (e) {
                    console.warn('âš ï¸ Erro ao carregar ATLAS_LUND_BROWDER do localStorage:', e);
                }
            }
            
            if (!atlasAnatomico && !atlasQueimados && !atlasLundBrowder) {
                console.log('â„¹ï¸ Nenhum atlas editado encontrado - usando versÃµes padrÃ£o');
            }
        })();
        
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        // ğŸ”§ FUNÃ‡ÃƒO DE REPARO AUTOMÃTICO: Restaurar campos perdidos em regiÃµes editadas
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        (function repararRegioesCorrompidas() {
            console.log('\nğŸ”§ Verificando regiÃµes por campos perdidos...');
            
            // Guardar referÃªncia aos atlas originais (cÃ³digo puro, antes de carregar localStorage)
            const atlasOriginais = {
                ATLAS_ANATOMICO: { regioes: window.ATLAS_ANATOMICO_ORIGINAL || ATLAS_ANATOMICO.regioes },
                ATLAS_QUEIMADOS: { regioes: window.ATLAS_QUEIMADOS_ORIGINAL || ATLAS_QUEIMADOS.regioes },
                ATLAS_LUND_BROWDER: { regioes: window.ATLAS_LUND_BROWDER_ORIGINAL || ATLAS_LUND_BROWDER.regioes }
            };
            
            const atlasParaVerificar = [
                { nome: 'ATLAS_LUND_BROWDER', atlasAtual: ATLAS_LUND_BROWDER, atlasOriginal: atlasOriginais.ATLAS_LUND_BROWDER },
                { nome: 'ATLAS_QUEIMADOS', atlasAtual: ATLAS_QUEIMADOS, atlasOriginal: atlasOriginais.ATLAS_QUEIMADOS },
                { nome: 'ATLAS_ANATOMICO', atlasAtual: ATLAS_ANATOMICO, atlasOriginal: atlasOriginais.ATLAS_ANATOMICO }
            ];
            
            let totalRegioesReparadas = 0;
            let totalCamposRestaurados = 0;
            
            atlasParaVerificar.forEach(({ nome, atlasAtual, atlasOriginal }) => {
                let regioesReparadas = 0;
                let camposRestaurados = 0;
                let precisaSalvar = false;
                
                atlasAtual.regioes.forEach(regiaoAtual => {
                    const regiaoOriginal = atlasOriginal.regioes.find(r => r.id === regiaoAtual.id);
                    if (!regiaoOriginal) return;
                    
                    let modificouRegiao = false;
                    
                    // Restaurar percentual/percentuais
                    if (!regiaoAtual.percentual && !regiaoAtual.percentuais) {
                        if (regiaoOriginal.percentuais) {
                            regiaoAtual.percentuais = { ...regiaoOriginal.percentuais };
                            camposRestaurados++;
                            modificouRegiao = true;
                            console.log(`  âœ… ${regiaoAtual.nome}: percentuais restaurado`);
                        } else if (regiaoOriginal.percentual) {
                            regiaoAtual.percentual = regiaoOriginal.percentual;
                            camposRestaurados++;
                            modificouRegiao = true;
                            console.log(`  âœ… ${regiaoAtual.nome}: percentual restaurado (${regiaoOriginal.percentual}%)`);
                        }
                    }
                    
                    // Restaurar cor
                    if (!regiaoAtual.cor && regiaoOriginal.cor) {
                        regiaoAtual.cor = regiaoOriginal.cor;
                        camposRestaurados++;
                        modificouRegiao = true;
                    }
                    
                    // Restaurar grupo
                    if (!regiaoAtual.grupo && regiaoOriginal.grupo) {
                        regiaoAtual.grupo = regiaoOriginal.grupo;
                        camposRestaurados++;
                        modificouRegiao = true;
                    }
                    
                    // Restaurar vista
                    if (!regiaoAtual.vista && regiaoOriginal.vista) {
                        regiaoAtual.vista = regiaoOriginal.vista;
                        camposRestaurados++;
                        modificouRegiao = true;
                    }
                    
                    if (modificouRegiao) {
                        regioesReparadas++;
                        precisaSalvar = true;
                    }
                });
                
                if (precisaSalvar) {
                    try {
                        localStorage.setItem(nome, JSON.stringify(atlasAtual));
                        console.log(`âœ… ${nome}: ${regioesReparadas} regiÃµes reparadas (${camposRestaurados} campos restaurados)`);
                        totalRegioesReparadas += regioesReparadas;
                        totalCamposRestaurados += camposRestaurados;
                    } catch (e) {
                        console.error(`âŒ Erro ao salvar ${nome} reparado:`, e);
                    }
                }
            });
            
            if (totalRegioesReparadas > 0) {
                console.log(`\nğŸ‰ REPARO CONCLUÃDO: ${totalRegioesReparadas} regiÃµes reparadas, ${totalCamposRestaurados} campos restaurados!`);
            } else {
                console.log('âœ… Todas as regiÃµes estÃ£o OK - nenhum reparo necessÃ¡rio');
            }
        })();
        // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        
        // Log de inicializaÃ§Ã£o
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        console.log('ğŸ”¥ ATLAS_LUND_BROWDER v3.1 - 32 REGIÃ•ES (COORDENADAS CORRETAS)');
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        console.log(`ğŸ“Š Total de regiÃµes: ${ATLAS_LUND_BROWDER.regioes.length}`);
        console.log('\nğŸ“‹ ValidaÃ§Ã£o de totais por faixa etÃ¡ria:');
        ATLAS_LUND_BROWDER.faixasEtarias.forEach(faixa => {
            const total = ATLAS_LUND_BROWDER.validarTotal(faixa.id);
            const status = Math.abs(total - 100) < 0.5 ? 'âœ…' : 'âŒ';
            console.log(`   ${faixa.nome.padEnd(20)} = ${total.toFixed(2)}% ${status}`);
        });
        console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');


        const SistemaCore = {
            dados: {
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // ğŸ¥ ESTABELECIMENTO - Dados e Pools Estruturais
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // v10.39: Pools estruturais movidos para o estabelecimento
                // Estes pools sÃ£o compartilhados/utilizados em mÃºltiplas Ã¡reas do sistema
                estabelecimento: {
                    // Dados bÃ¡sicos (preenchidos na aba Estabelecimento)
                    nome: '',
                    cnpj: '',
                    cnes: '',
                    tipo: '', // Do pool tiposEstabelecimento
                    endereco: {},
                    contato: {},
                    responsavelTecnico: {},
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // ğŸ—ï¸ POOLS ESTRUTURAIS DO ESTABELECIMENTO
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    
                    // Pool de Tipos de Estabelecimento (usado no cadastro)
                    tiposEstabelecimento: [
                        'ConsultÃ³rio (apenas consultas)',
                        'ClÃ­nica (consultas + exames + procedimentos)',
                        'Hospital Dia (internaÃ§Ãµes atÃ© 24h)',
                        'Hospital (internaÃ§Ãµes prolongadas + cirurgias)',
                        'Pronto Atendimento / UPA',
                        'LaboratÃ³rio de AnÃ¡lises',
                        'Centro de DiagnÃ³stico por Imagem'
                    ],
                    
                    // Pool de Especialidades MÃ©dicas
                    // Usado em: Cadastro de Profissionais + ConfiguraÃ§Ã£o de RepartiÃ§Ãµes
                    especialidades: [
                        'Cirurgia PlÃ¡stica',
                        'Cardiologia',
                        'ClÃ­nica Geral',
                        'Ortopedia',
                        'Pediatria',
                        'Ginecologia',
                        'Neurologia',
                        'Psiquiatria',
                        'Dermatologia'
                    ],
                    
                    // Pool de ConvÃªnios Atendidos
                    // Usado em: Cadastro de Pacientes (nome do convÃªnio)
                    convenios: [
                        'Particular',
                        'SUS',
                        'Unimed',
                        'Amil',
                        'Bradesco SaÃºde',
                        'SulAmÃ©rica',
                        'Hapvida',
                        'NotreDame IntermÃ©dica'
                    ],
                    
                    // Pool de Categorias Profissionais
                    // Usado em: Cadastro de Profissionais (categoria)
                    categoriasProfissionais: [
                        'MÃ©dico(a)',
                        'Enfermeiro(a)',
                        'Fisioterapeuta',
                        'PsicÃ³logo(a)',
                        'Nutricionista',
                        'FarmacÃªutico(a)',
                        'Assistente Social',
                        'Recepcionista',
                        'Administrativo'
                    ],
                    
                    // Pool de Cargos/FunÃ§Ãµes
                    // Usado em: Cadastro de Profissionais (cargo/funÃ§Ã£o)
                    // Novos cargos sÃ£o adicionados automaticamente ao pool
                    cargos: [
                        'Diretor ClÃ­nico',
                        'Coordenador MÃ©dico',
                        'MÃ©dico Assistente',
                        'MÃ©dico Plantonista',
                        'Enfermeiro Chefe',
                        'TÃ©cnico de Enfermagem',
                        'Recepcionista',
                        'SecretÃ¡ria'
                    ],
                    
                    // Pool de Regionais de SaÃºde
                    // Usado em: Cadastro de Pacientes (regional)
                    // TODO: Automatizar por CEP se possÃ­vel
                    regionaisSaude: [
                        'Regional Centro',
                        'Regional Norte',
                        'Regional Sul',
                        'Regional Leste',
                        'Regional Oeste',
                        'Regional Nordeste',
                        'Regional Noroeste',
                        'Regional Venda Nova',
                        'Regional Barreiro'
                    ],
                    
                    // Pool de Tipos de Atendimento
                    // v10.61: Usado em: Agendamento (tipo de consulta/procedimento)
                    // Filtra automaticamente as unidades disponÃ­veis conforme o tipo
                    // v10.109: Removida "EmergÃªncia" - nunca Ã© agendada
                    tiposAtendimento: [
                        'Consulta',
                        'Retorno',
                        'Exame',
                        'Procedimento',
                        'Cirurgia',
                        'InternaÃ§Ã£o'
                    ],
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // ğŸ—ï¸ POOLS DE INFRAESTRUTURA FÃSICA
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    
                    // Pool de PavilhÃµes
                    // Usado em: Cadastro de RepartiÃ§Ãµes
                    pavilhoes: [
                        'PavilhÃ£o A',
                        'PavilhÃ£o B',
                        'Bloco Principal',
                        'Ala Norte',
                        'Ala Sul'
                    ],
                    
                    // Pool de Andares
                    // Usado em: Cadastro de RepartiÃ§Ãµes
                    andares: [
                        'TÃ©rreo',
                        'Subsolo',
                        '1Âº Andar',
                        '2Âº Andar',
                        '3Âº Andar',
                        '4Âº Andar',
                        '5Âº Andar'
                    ],
                    
                    // Pool de Setores
                    // Usado em: Cadastro de Profissionais (setores de trabalho)
                    setores: [
                        'Cardiologia',
                        'ClÃ­nica Geral',
                        'Ortopedia',
                        'Pediatria',
                        'Ginecologia',
                        'Neurologia',
                        'Psiquiatria',
                        'EmergÃªncia'
                    ]
                },
                
                // Arrays principais do sistema
                reparticoes: [],
                profissionais: [],
                pacientes: [],
                agendamentos: [],
                atendimentos: [],
                prontuarios: [],
                campos_coleta: [],
                dados_coletados: [],
                permissoes: {
                    categorias: ['medico', 'enfermeiro', 'assistente_social', 'fisioterapeuta', 'psicologo', 'nutricionista', 'farmaceutico', 'recepcionista', 'administrativo']
                },
                same: [], // HistÃ³rico de altas hospitalares
                escalas: [], // v6.8.1: Sistema de escalas e plantÃµes
                entradas: [], // v10.6: Folhas de Rosto - Registro de entrada de pacientes
                modelos_atendimento: [], // v10.130: Modelos customizÃ¡veis de atendimento por tipo e especialidade
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // ğŸ“‹ POOLS CLÃNICOS/PRONTUÃRIO - Dados MÃ©dicos Padronizados
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // v10.39: Pools reorganizados por categoria funcional
                // Estes pools sÃ£o usados em dropdowns do prontuÃ¡rio e atendimento
                pools: {
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // ğŸ“‹ POOL DE ATENDIMENTO (v10.53)
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // Pool de Motivos de Atendimento
                    // Usado em: Folha de Rosto (motivo do atendimento)
                    motivosAtendimento: [
                        'Dor torÃ¡cica',
                        'Dor abdominal',
                        'Febre',
                        'Dispneia',
                        'Cefaleia',
                        'Trauma',
                        'Mal-estar geral',
                        'Consulta de rotina',
                        'Retorno',
                        'Exames'
                    ],
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // ğŸ’Š POOLS DE TRATAMENTOS (Procedimentos e MedicaÃ§Ãµes)
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    tratamentos: {
                        // Pool de AntibiÃ³ticos
                        // Usado em: Eventos ClÃ­nicos (registro de ATB)
                        antibioticos: [
                            'Ceftriaxone',
                            'Vancomicina',
                            'Metronidazol',
                            'Ampicilina',
                            'Clindamicina',
                            'Meropenem',
                            'Piperacilina + Tazobactam'
                        ],
                        
                        // Pool de MedicaÃ§Ãµes de Uso ContÃ­nuo
                        // Usado em: Anamnese (medicaÃ§Ãµes em uso)
                        medicacoes: [
                            'Losartana',
                            'Metformina',
                            'Sinvastatina',
                            'Omeprazol',
                            'AAS',
                            'Levotiroxina',
                            'Anlodipino',
                            'Enalapril',
                            'Hidroclorotiazida'
                        ],
                        
                        // Pool de Procedimentos CirÃºrgicos
                        // Usado em: Eventos ClÃ­nicos (registro de cirurgias)
                        procedimentos: [
                            'Laparotomia exploradora',
                            'Desbridamento',
                            'Apendicectomia',
                            'Colecistectomia',
                            'Herniorrafia',
                            'Drenagem de abscesso',
                            'Traqueostomia'
                        ],
                        
                        // Pool de Locais de InternaÃ§Ã£o
                        // Usado em: Eventos ClÃ­nicos (registro de internaÃ§Ã£o)
                        locaisInternacao: [
                            'UTI',
                            'UTI Neonatal',
                            'Enfermaria',
                            'Semi-intensiva',
                            'Isolamento',
                            'BerÃ§Ã¡rio',
                            'Pronto Socorro'
                        ]
                    },
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // ğŸ“ POOLS DE ANAMNESE (HistÃ³ria e Dados do Paciente)
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    anamnese: {
                        // Pool de Alergias
                        // Usado em: Dados Estruturados (alergias medicamentosas)
                        alergias: [
                            'Dipirona',
                            'Penicilina',
                            'AAS (Ãcido AcetilsalicÃ­lico)',
                            'Contraste Iodado',
                            'LÃ¡tex',
                            'Sulfas',
                            'Cefalosporinas'
                        ],
                        
                        // Pool de Cirurgias Pregressas
                        // Usado em: Dados Estruturados (histÃ³rico cirÃºrgico)
                        cirurgiasPregressas: [
                            'Cesariana',
                            'Apendicectomia',
                            'Colecistectomia',
                            'Herniorrafia',
                            'Histerectomia',
                            'Amigdalectomia',
                            'Tireoidectomia',
                            'Mastectomia'
                        ],
                        
                        // Pool de DoenÃ§as CrÃ´nicas
                        // Usado em: Dados Estruturados (comorbidades)
                        doencasCronicas: [
                            'HipertensÃ£o Arterial (HAS)',
                            'Diabetes Mellitus',
                            'Cardiopatia',
                            'DPOC',
                            'Asma',
                            'InsuficiÃªncia Renal',
                            'Hepatopatia',
                            'Hipotireoidismo',
                            'Hipertireoidismo',
                            'Obesidade'
                        ],
                        
                        // Pool de Drogas IlÃ­citas
                        // Usado em: Dados Estruturados (histÃ³ria social)
                        drogas: [
                            'Maconha',
                            'CocaÃ­na',
                            'Crack',
                            'LSD',
                            'Ecstasy',
                            'Anfetaminas',
                            'Inalantes'
                        ],
                        
                        // Pool de Atividades FÃ­sicas
                        // Usado em: Dados Estruturados (estilo de vida)
                        atividadesFisicas: [
                            'Caminhada',
                            'Corrida',
                            'MusculaÃ§Ã£o',
                            'NataÃ§Ã£o',
                            'Ciclismo',
                            'Futebol',
                            'Yoga',
                            'Pilates',
                            'DanÃ§a'
                        ],
                        
                        // Pool de Expectativas do Paciente
                        // Usado em: MÃ³dulo de Expectativas e Objetivos
                        expectativas: [
                            'Melhorar aparÃªncia',
                            'Reduzir dor',
                            'Aumentar autoestima',
                            'Recuperar funÃ§Ã£o',
                            'Corrigir assimetria',
                            'Rejuvenescimento'
                        ],
                        
                        // Pool de Parentescos
                        // Usado em: HistÃ³ria Familiar (relacionamento familiar)
                        parentescos: [
                            'Pai', 'MÃ£e', 
                            'IrmÃ£o(Ã£)', 'Meio-irmÃ£o(Ã£) paterno', 'Meio-irmÃ£o(Ã£) materno',
                            'AvÃ´ paterno', 'AvÃ³ paterna', 'AvÃ´ materno', 'AvÃ³ materna',
                            'Tio(a) paterno(a)', 'Tio(a) materno(a)',
                            'Primo(a) paterno(a)', 'Primo(a) materno(a)',
                            'Filho(a)', 'Neto(a)', 'Sobrinho(a)'
                        ],
                        
                        // Pool de DoenÃ§as Familiares
                        // Usado em: HistÃ³ria Familiar (doenÃ§as hereditÃ¡rias)
                        doencasFamiliares: [
                            'HipertensÃ£o Arterial (HAS)', 'Diabetes Mellitus', 'Dislipidemia',
                            'Infarto Agudo do MiocÃ¡rdio (IAM)', 'AVC / AVE', 'Arritmias',
                            'CÃ¢ncer de mama', 'CÃ¢ncer de prÃ³stata', 'CÃ¢ncer colorretal',
                            'CÃ¢ncer de pulmÃ£o', 'CÃ¢ncer de estÃ´mago', 'Outros cÃ¢nceres',
                            'DoenÃ§as Autoimunes', 'LÃºpus', 'Artrite Reumatoide',
                            'Trombofilia', 'Hemofilia', 'Problemas de CoagulaÃ§Ã£o',
                            'Alzheimer', 'Parkinson', 'Epilepsia'
                        ]
                    }
                },
                // v8.0.1: Sistema de permissÃµes granulares
                permissoes_categorias: {
                    'medico': {
                        nivel_acesso_prontuario: 'total',
                        reservar_consultorio: true,
                        matriciamento: true,
                        internar: true,
                        dar_alta: true
                    },
                    'enfermeiro': {
                        nivel_acesso_prontuario: 'total',
                        reservar_consultorio: true,
                        matriciamento: true,
                        internar: false,
                        dar_alta: false
                    },
                    'fisioterapeuta': {
                        nivel_acesso_prontuario: 'total',
                        reservar_consultorio: true,
                        matriciamento: true,
                        internar: false,
                        dar_alta: false
                    },
                    'psicologo': {
                        nivel_acesso_prontuario: 'total',
                        reservar_consultorio: true,
                        matriciamento: true,
                        internar: false,
                        dar_alta: false
                    },
                    'nutricionista': {
                        nivel_acesso_prontuario: 'total',
                        reservar_consultorio: true,
                        matriciamento: true,
                        internar: false,
                        dar_alta: false
                    },
                    'farmaceutico': {
                        nivel_acesso_prontuario: 'especifico',
                        acesso_especifico: {
                            prescricoes: true,
                            medicamentos: true,
                            alergias: true,
                            evolucoes: false,
                            diagnosticos: false,
                            exames: false
                        },
                        reservar_consultorio: true,
                        matriciamento: true,
                        internar: false,
                        dar_alta: false
                    },
                    'assistente_social': {
                        nivel_acesso_prontuario: 'total',
                        reservar_consultorio: true,
                        matriciamento: true,
                        internar: false,
                        dar_alta: false
                    },
                    'recepcionista': {
                        nivel_acesso_prontuario: 'nenhum',
                        acesso_dados: {
                            cadastrais: true,
                            estatisticas: true,
                            agendamentos: true
                        },
                        reservar_consultorio: true,
                        matriciamento: false,
                        internar: false,
                        dar_alta: false
                    },
                    'administrativo': {
                        nivel_acesso_prontuario: 'nenhum',
                        acesso_dados: {
                            cadastrais: true,
                            estatisticas: true,
                            relatorios_gerenciais: true,
                            dashboard: true
                        },
                        reservar_consultorio: false,
                        matriciamento: false,
                        internar: false,
                        dar_alta: false
                    }
                },
                // v8.0.1: MÃ³dulo de equipes multiprofissionais
                equipes: [],
                // v9.0: Tempos de preparo de sala (ajustÃ¡veis)
                tempos_preparo: {
                    consultorio: 10,
                    procedimento: 15,
                    bloco_cirurgico: 30,
                    exames: 10,
                    emergencia: 15,
                    internacao: 0
                },
                // v10.12.1: Dados clÃ­nicos de EXEMPLO (para preview/configuraÃ§Ã£o)
                dadosClinicosExemplo: {
                    internacao: null,
                    cirurgias: [],
                    antibioticos: {
                        emUso: [],
                        suspensos: []
                    }
                },
                // v10.12.0: ConfiguraÃ§Ã£o por tipo de documento
                tiposDocumento: {
                    'folha-rosto-emergencia': {
                        mostrarDiasInternacao: true,
                        mostrarCirurgias: true,
                        cirurgiasFormato: 'lista',
                        mostrarAtbUso: true,
                        atbUsoFormato: 'lista',
                        mostrarAtbSuspensos: false
                    },
                    'cabecalho-consultorio': {
                        mostrarDiasInternacao: false,
                        mostrarCirurgias: false,
                        cirurgiasFormato: 'lista',
                        mostrarAtbUso: false,
                        atbUsoFormato: 'lista',
                        mostrarAtbSuspensos: false
                    },
                    'cabecalho-internacao': {
                        mostrarDiasInternacao: true,
                        mostrarCirurgias: true,
                        cirurgiasFormato: 'lista',
                        mostrarAtbUso: true,
                        atbUsoFormato: 'lista',
                        mostrarAtbSuspensos: true
                    },
                    'cabecalho-cirurgico': {
                        mostrarDiasInternacao: true,
                        mostrarCirurgias: true,
                        cirurgiasFormato: 'lista',
                        mostrarAtbUso: true,
                        atbUsoFormato: 'lista',
                        mostrarAtbSuspensos: false
                    },
                    'folha-sala': {
                        mostrarDiasInternacao: false,
                        mostrarCirurgias: true,
                        cirurgiasFormato: 'resumo',
                        mostrarAtbUso: true,
                        atbUsoFormato: 'resumo',
                        mostrarAtbSuspensos: false
                    }
                }
            },

            carregar() {
                const saved = localStorage.getItem('sistema_hospitalar_v5');
                if (saved) {
                    this.dados = JSON.parse(saved);
                    // Garantir que arrays existam
                    if (!this.dados.same) this.dados.same = [];
                    if (!this.dados.prontuarios) this.dados.prontuarios = [];
                    if (!this.dados.escalas) this.dados.escalas = []; // v6.8.1
                    // v6.8.2: Garantir pools (CORRIGIDO v10.5.3)
                    if (!this.dados.pools) {
                        this.dados.pools = {};
                    }
                    // v10.39: Garantir estruturas organizadas de pools
                    if (!this.dados.pools.tratamentos) {
                        this.dados.pools.tratamentos = {};
                    }
                    if (!this.dados.pools.anamnese) {
                        this.dados.pools.anamnese = {};
                    }
                    // v10.39: Garantir estrutura do estabelecimento
                    if (!this.dados.estabelecimento) {
                        this.dados.estabelecimento = {};
                    }
                    // Inicializar cada pool individualmente se nÃ£o existir
                    if (!this.dados.estabelecimento.pavilhoes) {
                        this.dados.estabelecimento.pavilhoes = ['PavilhÃ£o A', 'PavilhÃ£o B', 'Bloco Principal'];
                    }
                    if (!this.dados.estabelecimento.andares) {
                        this.dados.estabelecimento.andares = ['TÃ©rreo', '1Âº Andar', '2Âº Andar', '3Âº Andar'];
                    }
                    if (!this.dados.estabelecimento.setores) {
                        this.dados.estabelecimento.setores = ['Cardiologia', 'ClÃ­nica Geral', 'Ortopedia', 'Pediatria', 'Ginecologia', 'Neurologia', 'Psiquiatria', 'EmergÃªncia'];
                    }
                    if (!this.dados.pools.nomes_sugeridos) {
                        this.dados.pools.nomes_sugeridos = ['ConsultÃ³rio', 'Sala', 'Leito', 'Box', 'Quarto', 'Enfermaria', 'Ala', 'Posto'];
                    }
                    if (!this.dados.estabelecimento.especialidades) {
                        this.dados.estabelecimento.especialidades = [];
                    }
                    if (!this.dados.estabelecimento.cargos) {
                        this.dados.estabelecimento.cargos = [];
                    }
                    if (!this.dados.estabelecimento.categoriasProfissionais) {
                        this.dados.estabelecimento.categoriasProfissionais = [];
                    }
                    if (!this.dados.estabelecimento.convenios) {
                        this.dados.estabelecimento.convenios = [];
                    }
                    // v10.12.0: Garantir pools de antibiÃ³ticos e procedimentos
                    if (!this.dados.pools.tratamentos.antibioticos) {
                        this.dados.pools.tratamentos.antibioticos = [
                            'Ceftriaxone', 'Vancomicina', 'Metronidazol', 'Ampicilina',
                            'Clindamicina', 'Meropenem', 'Piperacilina + Tazobactam'
                        ];
                    }
                    if (!this.dados.pools.tratamentos.procedimentos) {
                        this.dados.pools.tratamentos.procedimentos = [
                            'Laparotomia exploradora', 'Desbridamento', 'Apendicectomia',
                            'Colecistectomia', 'Herniorrafia', 'Drenagem de abscesso', 'Traqueostomia'
                        ];
                    }
                    // v10.13.0: Garantir novos pools para eventos clÃ­nicos e prontuÃ¡rio estruturado
                    if (!this.dados.pools.tratamentos.locaisInternacao) {
                        this.dados.pools.tratamentos.locaisInternacao = [
                            'UTI', 'UTI Neonatal', 'Enfermaria', 'Semi-intensiva',
                            'Isolamento', 'BerÃ§Ã¡rio', 'Pronto Socorro'
                        ];
                    }
                    if (!this.dados.pools.anamnese.alergias) {
                        this.dados.pools.anamnese.alergias = [
                            'Penicilina', 'Dipirona', 'AINEs (Ibuprofeno, Diclofenaco)', 'Sulfa',
                            'LÃ¡tex', 'Contraste iodado', 'AnestÃ©sicos locais', 'Paracetamol',
                            'Adesivos/Esparadrapo', 'Poeira', 'Ãcaro', 'Frutos do mar'
                        ];
                    }
                    if (!this.dados.pools.anamnese.cirurgiasPregressas) {
                        this.dados.pools.anamnese.cirurgiasPregressas = [
                            'Cesariana', 'Apendicectomia', 'Colecistectomia', 'Herniorrafia',
                            'Histerectomia', 'Mastectomia', 'Abdominoplastia', 'Mamoplastia',
                            'Rinoplastia', 'LipoaspiraÃ§Ã£o', 'Artroscopia', 'Amigdalectomia'
                        ];
                    }
                    if (!this.dados.pools.tratamentos.medicacoes) {
                        this.dados.pools.tratamentos.medicacoes = [
                            'Losartana', 'Enalapril', 'Hidroclorotiazida', 'AAS',
                            'Metformina', 'Insulina', 'Sinvastatina', 'Atorvastatina',
                            'Omeprazol', 'Levotiroxina', 'Fluoxetina', 'Sertralina'
                        ];
                    }
                    if (!this.dados.pools.anamnese.expectativas) {
                        this.dados.pools.anamnese.expectativas = [
                            'Melhorar aparÃªncia', 'Reduzir dor', 'Aumentar autoestima',
                            'Recuperar funÃ§Ã£o', 'Corrigir assimetria', 'Rejuvenescimento'
                        ];
                    }
                    if (!this.dados.pools.anamnese.doencasCronicas) {
                        this.dados.pools.anamnese.doencasCronicas = [
                            'HipertensÃ£o Arterial (HAS)', 'Diabetes Mellitus', 'Dislipidemia',
                            'Cardiopatias', 'Pneumopatias', 'Asma', 'DPOC', 'Nefropatias',
                            'Hepatopatias', 'DistÃºrbios de CoagulaÃ§Ã£o', 'Alergias',
                            'Tireopatias', 'Hipotireoidismo', 'Hipertireoidismo',
                            'Obesidade', 'Refluxo gastroesofÃ¡gico'
                        ];
                    }
                    if (!this.dados.pools.anamnese.drogas) {
                        this.dados.pools.anamnese.drogas = [
                            'Maconha', 'CocaÃ­na', 'Crack', 'LSD', 'Ecstasy',
                            'Anfetaminas', 'Inalantes'
                        ];
                    }
                    if (!this.dados.pools.anamnese.atividadesFisicas) {
                        this.dados.pools.anamnese.atividadesFisicas = [
                            'Caminhada', 'Corrida', 'MusculaÃ§Ã£o', 'NataÃ§Ã£o',
                            'Ciclismo', 'Futebol', 'Yoga', 'Pilates', 'DanÃ§a'
                        ];
                    }
                    if (!this.dados.pools.anamnese.parentescos) {
                        this.dados.pools.anamnese.parentescos = [
                            'Pai', 'MÃ£e', 
                            'IrmÃ£o(Ã£)', 'Meio-irmÃ£o(Ã£) paterno', 'Meio-irmÃ£o(Ã£) materno',
                            'AvÃ´ paterno', 'AvÃ³ paterna', 'AvÃ´ materno', 'AvÃ³ materna',
                            'Tio(a) paterno(a)', 'Tio(a) materno(a)',
                            'Primo(a) paterno(a)', 'Primo(a) materno(a)',
                            'Filho(a)', 'Neto(a)', 'Sobrinho(a)'
                        ];
                    }
                    if (!this.dados.pools.anamnese.doencasFamiliares) {
                        this.dados.pools.anamnese.doencasFamiliares = [
                            'HipertensÃ£o Arterial (HAS)', 'Diabetes Mellitus', 'Dislipidemia',
                            'Infarto Agudo do MiocÃ¡rdio (IAM)', 'AVC / AVE', 'Arritmias',
                            'CÃ¢ncer de mama', 'CÃ¢ncer de prÃ³stata', 'CÃ¢ncer colorretal',
                            'CÃ¢ncer de pulmÃ£o', 'CÃ¢ncer de estÃ´mago', 'Outros cÃ¢nceres',
                            'DoenÃ§as Autoimunes', 'LÃºpus', 'Artrite Reumatoide',
                            'Trombofilia', 'Hemofilia', 'Problemas de CoagulaÃ§Ã£o',
                            'Alzheimer', 'Parkinson', 'Epilepsia',
                            'Asma', 'DPOC', 'Fibrose CÃ­stica',
                            'Obesidade', 'DoenÃ§as Tireoidianas',
                            'Transtornos PsiquiÃ¡tricos', 'DepressÃ£o', 'Esquizofrenia'
                        ];
                    }
                    // v10.12.1: MIGRAÃ‡ÃƒO - Renomear dadosClinicos â†’ dadosClinicosExemplo (se existir)
                    if (this.dados.dadosClinicos && !this.dados.dadosClinicosExemplo) {
                        console.log('ğŸ”„ [MigraÃ§Ã£o v10.12.1] Renomeando dadosClinicos â†’ dadosClinicosExemplo');
                        this.dados.dadosClinicosExemplo = this.dados.dadosClinicos;
                        delete this.dados.dadosClinicos;
                    }
                    
                    // v10.12.1: Garantir dadosClinicosExemplo
                    if (!this.dados.dadosClinicosExemplo) {
                        this.dados.dadosClinicosExemplo = {
                            internacao: null,
                            cirurgias: [],
                            antibioticos: { emUso: [], suspensos: [] }
                        };
                    }
                    
                    // v10.12.1: Garantir que todos atendimentos tÃªm estrutura dadosClinicos
                    if (this.dados.atendimentos && this.dados.atendimentos.length > 0) {
                        this.dados.atendimentos.forEach(atendimento => {
                            if (!atendimento.dadosClinicos) {
                                atendimento.dadosClinicos = {
                                    internacao: null,
                                    cirurgias: [],
                                    antibioticos: { emUso: [], suspensos: [] }
                                };
                            }
                        });
                    }
                    // v10.12.0: Garantir tiposDocumento
                    if (!this.dados.tiposDocumento) {
                        this.dados.tiposDocumento = {
                            'folha-rosto-emergencia': {
                                mostrarDiasInternacao: true,
                                mostrarCirurgias: true,
                                cirurgiasFormato: 'lista',
                                mostrarAtbUso: true,
                                atbUsoFormato: 'lista',
                                mostrarAtbSuspensos: false
                            },
                            'cabecalho-consultorio': {
                                mostrarDiasInternacao: false,
                                mostrarCirurgias: false,
                                cirurgiasFormato: 'lista',
                                mostrarAtbUso: false,
                                atbUsoFormato: 'lista',
                                mostrarAtbSuspensos: false
                            },
                            'cabecalho-internacao': {
                                mostrarDiasInternacao: true,
                                mostrarCirurgias: true,
                                cirurgiasFormato: 'lista',
                                mostrarAtbUso: true,
                                atbUsoFormato: 'lista',
                                mostrarAtbSuspensos: true
                            },
                            'cabecalho-cirurgico': {
                                mostrarDiasInternacao: true,
                                mostrarCirurgias: true,
                                cirurgiasFormato: 'lista',
                                mostrarAtbUso: true,
                                atbUsoFormato: 'lista',
                                mostrarAtbSuspensos: false
                            },
                            'folha-sala': {
                                mostrarDiasInternacao: false,
                                mostrarCirurgias: true,
                                cirurgiasFormato: 'resumo',
                                mostrarAtbUso: true,
                                atbUsoFormato: 'resumo',
                                mostrarAtbSuspensos: false
                            }
                        };
                    }
                    if (!this.dados.permissoes) {
                        this.dados.permissoes = {
                            categorias: ['medico', 'enfermeiro', 'assistente_social', 'fisioterapeuta', 'psicologo', 'nutricionista', 'farmaceutico', 'recepcionista', 'administrativo']
                        };
                    }
                    // v8.0.1: Garantir permissoes_categorias
                    if (!this.dados.permissoes_categorias) {
                        this.dados.permissoes_categorias = {
                            'medico': {
                                nivel_acesso_prontuario: 'total',
                                reservar_consultorio: true,
                                matriciamento: true,
                                internar: true,
                                dar_alta: true
                            },
                            'enfermeiro': {
                                nivel_acesso_prontuario: 'total',
                                reservar_consultorio: true,
                                matriciamento: true,
                                internar: false,
                                dar_alta: false
                            },
                            'fisioterapeuta': {
                                nivel_acesso_prontuario: 'total',
                                reservar_consultorio: true,
                                matriciamento: true,
                                internar: false,
                                dar_alta: false
                            },
                            'psicologo': {
                                nivel_acesso_prontuario: 'total',
                                reservar_consultorio: true,
                                matriciamento: true,
                                internar: false,
                                dar_alta: false
                            },
                            'nutricionista': {
                                nivel_acesso_prontuario: 'total',
                                reservar_consultorio: true,
                                matriciamento: true,
                                internar: false,
                                dar_alta: false
                            },
                            'farmaceutico': {
                                nivel_acesso_prontuario: 'especifico',
                                acesso_especifico: {
                                    prescricoes: true,
                                    medicamentos: true,
                                    alergias: true,
                                    evolucoes: false,
                                    diagnosticos: false,
                                    exames: false
                                },
                                reservar_consultorio: true,
                                matriciamento: true,
                                internar: false,
                                dar_alta: false
                            },
                            'assistente_social': {
                                nivel_acesso_prontuario: 'total',
                                reservar_consultorio: true,
                                matriciamento: true,
                                internar: false,
                                dar_alta: false
                            },
                            'recepcionista': {
                                nivel_acesso_prontuario: 'nenhum',
                                acesso_dados: {
                                    cadastrais: true,
                                    estatisticas: true,
                                    agendamentos: true
                                },
                                reservar_consultorio: true,
                                matriciamento: false,
                                internar: false,
                                dar_alta: false
                            },
                            'administrativo': {
                                nivel_acesso_prontuario: 'nenhum',
                                acesso_dados: {
                                    cadastrais: true,
                                    estatisticas: true,
                                    relatorios_gerenciais: true,
                                    dashboard: true
                                },
                                reservar_consultorio: false,
                                matriciamento: false,
                                internar: false,
                                dar_alta: false
                            }
                        };
                    }
                    // v8.0.1: Garantir equipes
                    if (!this.dados.equipes) this.dados.equipes = [];
                    
                    // v10.34: MigraÃ§Ã£o SIMPLES de status
                    console.log('ğŸ”„ [MigraÃ§Ã£o v10.34] Iniciando...');
                    let migradas = 0;
                    
                    this.dados.reparticoes.forEach(rep => {
                        // Adicionar status_operacional se nÃ£o existir
                        if (!rep.status_operacional) {
                            rep.status_operacional = 'disponivel';
                            migradas++;
                        }
                        
                        // Para leitos: adicionar status_ocupacao se nÃ£o existir
                        if (rep.eh_subreparticao && (rep.tipo_reparticao === 'internacao' || rep.tipo_reparticao === 'emergencia')) {
                            if (!rep.status_ocupacao) {
                                rep.status_ocupacao = rep.status || 'livre';
                                migradas++;
                            }
                        }
                    });
                    
                    if (migradas > 0) {
                        console.log(`âœ… [MigraÃ§Ã£o v10.34] ${migradas} campos adicionados`);
                        this.salvar();
                    }
                    
                    // v10.54: MIGRAÃ‡ÃƒO - pre_cadastro â†’ cadastro_completo
                    console.log('ğŸ”„ [MigraÃ§Ã£o v10.54] Convertendo pre_cadastro â†’ cadastro_completo...');
                    let pacientesMigrados = 0;
                    
                    this.dados.pacientes.forEach(pac => {
                        // Se tem campo pre_cadastro, converter
                        if (pac.pre_cadastro !== undefined) {
                            // pre_cadastro: true â†’ cadastro_completo: false (precisa completar)
                            // pre_cadastro: false â†’ cadastro_completo: true (jÃ¡ estÃ¡ completo)
                            pac.cadastro_completo = !pac.pre_cadastro;
                            delete pac.pre_cadastro; // Remover campo antigo
                            pacientesMigrados++;
                        } else {
                            // Se nÃ£o tem nem pre_cadastro nem cadastro_completo, assumir completo
                            if (pac.cadastro_completo === undefined) {
                                pac.cadastro_completo = true;
                                pacientesMigrados++;
                            }
                        }
                    });
                    
                    if (pacientesMigrados > 0) {
                        console.log(`âœ… [MigraÃ§Ã£o v10.54] ${pacientesMigrados} pacientes migrados para novo sistema`);
                        this.salvar();
                    }
                    
                    // v10.55: MIGRAÃ‡ÃƒO - cargo Ãºnico â†’ mÃºltiplos cargos
                    console.log('ğŸ”„ [MigraÃ§Ã£o v10.55] Convertendo cargo Ãºnico â†’ mÃºltiplos cargos...');
                    let profissionaisMigrados = 0;
                    
                    this.dados.profissionais.forEach(prof => {
                        // Se NÃƒO tem array de cargos, mas TEM cargo Ãºnico
                        if (!prof.cargos && prof.cargo) {
                            prof.cargos = [prof.cargo]; // Converter para array
                            prof.cargo_principal = prof.cargo; // Manter campo principal
                            profissionaisMigrados++;
                        } 
                        // Se NÃƒO tem nem cargos nem cargo, mas tem categoria (profissional antigo)
                        else if (!prof.cargos && !prof.cargo && prof.categoria_profissional) {
                            prof.cargos = ['Profissional']; // Cargo genÃ©rico
                            prof.cargo = 'Profissional'; // Compatibilidade
                            prof.cargo_principal = 'Profissional';
                            profissionaisMigrados++;
                        }
                        // Se tem array de cargos, garantir campos de compatibilidade
                        else if (prof.cargos && prof.cargos.length > 0) {
                            prof.cargo = prof.cargos[0]; // Primeiro cargo = principal
                            prof.cargo_principal = prof.cargos[0];
                        }
                    });
                    
                    if (profissionaisMigrados > 0) {
                        console.log(`âœ… [MigraÃ§Ã£o v10.55] ${profissionaisMigrados} profissionais migrados para sistema de mÃºltiplos cargos`);
                        this.salvar();
                    }
                    
                    // v10.58: MIGRAÃ‡ÃƒO - Corrigir eh_grupo para repartiÃ§Ãµes com sub-repartiÃ§Ãµes
                    console.log('ğŸ”„ [MigraÃ§Ã£o v10.58] Corrigindo eh_grupo para repartiÃ§Ãµes com sub-repartiÃ§Ãµes...');
                    let reparticoesMigradas = 0;
                    
                    this.dados.reparticoes.forEach(rep => {
                        // Se tem sub-repartiÃ§Ãµes MAS nÃ£o estÃ¡ marcada como grupo, corrigir
                        if (rep.subreparticoes_ids && rep.subreparticoes_ids.length > 0 && !rep.eh_grupo) {
                            rep.eh_grupo = true;
                            reparticoesMigradas++;
                            console.log(`   âœ… ${rep.nome}: eh_grupo = true (${rep.subreparticoes_ids.length} sub-repartiÃ§Ãµes)`);
                        }
                    });
                    
                    if (reparticoesMigradas > 0) {
                        console.log(`âœ… [MigraÃ§Ã£o v10.58] ${reparticoesMigradas} repartiÃ§Ãµes corrigidas`);
                        this.salvar();
                    }
                }
            },

            salvar() {
                localStorage.setItem('sistema_hospitalar_v5', JSON.stringify(this.dados));
            },

            // v10.86: NOVA - Sincronizar todas as visualizaÃ§Ãµes apÃ³s alteraÃ§Ãµes
            sincronizarVisualizacoes() {
                console.log('ğŸ”„ [SINCRONIZAÃ‡ÃƒO] Atualizando todas as visualizaÃ§Ãµes...');
                
                // 1ï¸âƒ£ Atualizar Mapa das Unidades (GestÃ£o)
                if (typeof Reparticoes !== 'undefined' && Reparticoes.listar) {
                    Reparticoes.listar();
                    console.log('âœ… [SINCRONIZAÃ‡ÃƒO] Mapa das Unidades atualizado');
                }
                
                // 2ï¸âƒ£ Atualizar Unidades (Agenda - Cards)
                if (typeof Agenda !== 'undefined' && Agenda.renderizarCards) {
                    Agenda.renderizarCards();
                    console.log('âœ… [SINCRONIZAÃ‡ÃƒO] Unidades (Agenda) atualizado');
                }
                
                // 3ï¸âƒ£ Atualizar CalendÃ¡rio (Agenda)
                if (typeof Calendario !== 'undefined' && Calendario.renderizar) {
                    Calendario.renderizar();
                    console.log('âœ… [SINCRONIZAÃ‡ÃƒO] CalendÃ¡rio atualizado');
                }
                
                // 4ï¸âƒ£ Atualizar Lista de Agendamentos (se estiver visÃ­vel)
                if (typeof Agenda !== 'undefined' && Agenda.listar) {
                    Agenda.listar();
                    console.log('âœ… [SINCRONIZAÃ‡ÃƒO] Lista de Agendamentos atualizada');
                }
                
                console.log('âœ… [SINCRONIZAÃ‡ÃƒO] Todas as visualizaÃ§Ãµes sincronizadas!');
            },

            proximoId(array) {
                return array.length > 0 ? Math.max(...array.map(i => i.id)) + 1 : 1;
            },

            // v10.6: Gerar nÃºmero de registro Ãºnico para Folha de Rosto
            gerarNumeroRegistro() {
                const ano = new Date().getFullYear();
                const entradas = this.dados.entradas || [];
                
                // Contar entradas do ano atual
                const entradasAno = entradas.filter(e => {
                    const anoEntrada = new Date(e.data_hora_entrada).getFullYear();
                    return anoEntrada === ano;
                });
                
                const numeroSequencial = entradasAno.length + 1;
                
                // Formato: AAAA/NNNNNN (ano/nÃºmero sequencial com 6 dÃ­gitos)
                return `${ano}/${String(numeroSequencial).padStart(6, '0')}`;
            }
        };

        /* ============================================================
           [STATUS UNIDADE] v10.34 - Gerenciamento Completo
           ============================================================ */
        
        const StatusUnidade = {
            podeAgendar(unidade) {
                if (!unidade) return false;
                return unidade.status_operacional === 'disponivel';
            },
            
            podeInternar(leito) {
                if (!leito) return false;
                return leito.status_operacional === 'disponivel' && 
                       leito.status_ocupacao === 'livre';
            },
            
            bloquear(id, motivo = null) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === id);
                if (!rep) {
                    alert('âš ï¸ Unidade nÃ£o encontrada');
                    return;
                }
                
                if (!motivo) {
                    motivo = prompt('âš ï¸ Motivo do bloqueio temporÃ¡rio:', '');
                    if (!motivo) return;
                }
                
                rep.status_operacional = 'bloqueado';
                rep.motivo_bloqueio = motivo;
                rep.data_bloqueio = new Date().toISOString();
                
                SistemaCore.salvar();
                console.log(`âš ï¸ [StatusUnidade] "${rep.nome}" bloqueado: ${motivo}`);
                
                if (typeof Reparticoes !== 'undefined' && Reparticoes.listar) {
                    Reparticoes.listar();
                }
            },
            
            desbloquear(id) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === id);
                if (!rep) {
                    alert('âš ï¸ Unidade nÃ£o encontrada');
                    return;
                }
                
                rep.status_operacional = 'disponivel';
                delete rep.motivo_bloqueio;
                delete rep.data_bloqueio;
                
                SistemaCore.salvar();
                console.log(`ğŸŸ¢ [StatusUnidade] "${rep.nome}" desbloqueado`);
                
                if (typeof Reparticoes !== 'undefined' && Reparticoes.listar) {
                    Reparticoes.listar();
                }
            },
            
            desativar(id, motivo = null) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === id);
                if (!rep) {
                    alert('âš ï¸ Unidade nÃ£o encontrada');
                    return;
                }
                
                if (!motivo) {
                    motivo = prompt('âš« Motivo da desativaÃ§Ã£o permanente:', '');
                    if (!motivo) return;
                }
                
                rep.status_operacional = 'desativado';
                rep.motivo_desativacao = motivo;
                rep.data_desativacao = new Date().toISOString();
                
                SistemaCore.salvar();
                console.log(`âš« [StatusUnidade] "${rep.nome}" desativado: ${motivo}`);
                
                if (typeof Reparticoes !== 'undefined' && Reparticoes.listar) {
                    Reparticoes.listar();
                }
            },
            
            reativar(id) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === id);
                if (!rep) {
                    alert('âš ï¸ Unidade nÃ£o encontrada');
                    return;
                }
                
                rep.status_operacional = 'disponivel';
                delete rep.motivo_desativacao;
                delete rep.data_desativacao;
                delete rep.motivo_bloqueio;
                delete rep.data_bloqueio;
                
                SistemaCore.salvar();
                console.log(`ğŸŸ¢ [StatusUnidade] "${rep.nome}" reativado`);
                
                if (typeof Reparticoes !== 'undefined' && Reparticoes.listar) {
                    Reparticoes.listar();
                }
            },
            
            getCorStatus(status) {
                const cores = {
                    'disponivel': '#16a34a',
                    'bloqueado': '#f59e0b',
                    'desativado': '#6b7280'
                };
                return cores[status] || '#6b7280';
            },
            
            getEmojiStatus(status) {
                const emojis = {
                    'disponivel': 'ğŸŸ¢',
                    'bloqueado': 'âš ï¸',
                    'desativado': 'âš«'
                };
                return emojis[status] || 'âš«';
            },
            
            getTextoStatus(status) {
                const textos = {
                    'disponivel': 'DISPONÃVEL',
                    'bloqueado': 'BLOQUEADO',
                    'desativado': 'DESATIVADO'
                };
                return textos[status] || 'DESCONHECIDO';
            }
        };

        /* ============================================================
           [SISTEMA] Controle Geral do Sistema
           ============================================================ */
        
        /* ============================================================
           [AUTH] MÃ³dulo de AutenticaÃ§Ã£o e PermissÃµes
           ============================================================ */
        
        const Auth = {
            usuarioAtual: null,
            _inicializado: false,
            
            init() {
                console.log('ğŸ” [AUTH] Inicializando sistema de autenticaÃ§Ã£o...');
                
                try {
                    // Verificar se jÃ¡ estÃ¡ logado
                    const usuarioSalvo = localStorage.getItem('usuario_logado');
                    
                    if (usuarioSalvo) {
                        console.log('âœ… [AUTH] UsuÃ¡rio encontrado no localStorage');
                        try {
                            this.usuarioAtual = JSON.parse(usuarioSalvo);
                            console.log('âœ… [AUTH] UsuÃ¡rio parseado:', this.usuarioAtual.nome);
                            this.mostrarSistema();
                        } catch (parseError) {
                            console.error('âŒ [AUTH] Erro ao parsear usuÃ¡rio:', parseError);
                            localStorage.removeItem('usuario_logado');
                            this.mostrarLogin();
                        }
                    } else {
                        console.log('â„¹ï¸ [AUTH] Nenhum usuÃ¡rio logado, mostrando tela de login');
                        this.mostrarLogin();
                    }
                    
                    this._inicializado = true;
                    console.log('âœ… [AUTH] Sistema de autenticaÃ§Ã£o inicializado com sucesso!');
                } catch (error) {
                    console.error('âŒ [AUTH] Erro fatal na inicializaÃ§Ã£o:', error);
                    // ForÃ§ar mostrar login em caso de erro
                    this.mostrarLogin();
                }
            },

            selecionarPerfil(perfil) {
                console.log('ğŸ”„ [AUTH] Selecionando perfil:', perfil);
                try {
                    document.querySelectorAll('.perfil-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    event.target.closest('.perfil-option').classList.add('selected');
                    document.getElementById('loginPerfil').value = perfil;
                    console.log('âœ… [AUTH] Perfil selecionado:', perfil);
                } catch (error) {
                    console.error('âŒ [AUTH] Erro ao selecionar perfil:', error);
                }
            },

            login(event) {
                console.log('ğŸ” [AUTH] Tentativa de login iniciada...');
                
                try {
                    event.preventDefault();
                    
                    const usuario = document.getElementById('loginUsuario').value;
                    const senha = document.getElementById('loginSenha').value;
                    const perfil = document.getElementById('loginPerfil').value;

                    console.log('ğŸ“ [AUTH] Dados do login:', { usuario, perfil, senhaPreenchida: !!senha });

                    // ValidaÃ§Ã£o de campos
                    if (!usuario || !senha) {
                        alert('âš ï¸ Preencha usuÃ¡rio e senha!');
                        console.warn('âš ï¸ [AUTH] Campos vazios');
                        return;
                    }

                    // ValidaÃ§Ã£o simples (para demo - em produÃ§Ã£o usar backend)
                    if (perfil === 'admin' && (usuario !== 'admin' || senha !== 'admin')) {
                        alert('âš ï¸ Login de administrador incorreto!\nUsuÃ¡rio: admin\nSenha: admin');
                        console.warn('âš ï¸ [AUTH] Credenciais de admin incorretas');
                        return;
                    }

                    console.log('âœ… [AUTH] ValidaÃ§Ã£o OK, criando sessÃ£o...');

                    // Criar objeto de usuÃ¡rio
                    this.usuarioAtual = {
                        usuario: usuario,
                        perfil: perfil,
                        nome: usuario.charAt(0).toUpperCase() + usuario.slice(1),
                        loginEm: new Date().toISOString()
                    };

                    console.log('âœ… [AUTH] Objeto de usuÃ¡rio criado:', this.usuarioAtual);

                    // Salvar no localStorage
                    try {
                        localStorage.setItem('usuario_logado', JSON.stringify(this.usuarioAtual));
                        console.log('âœ… [AUTH] UsuÃ¡rio salvo no localStorage');
                    } catch (storageError) {
                        console.error('âŒ [AUTH] Erro ao salvar no localStorage:', storageError);
                        alert('âš ï¸ Erro ao salvar sessÃ£o. Tente novamente.');
                        return;
                    }

                    // Mostrar sistema
                    console.log('âœ… [AUTH] Mostrando sistema...');
                    this.mostrarSistema();
                    
                    // Notificar com delay para garantir que o sistema carregou
                    setTimeout(() => {
                        if (typeof Sistema !== 'undefined' && Sistema.notificar) {
                            Sistema.notificar(`Bem-vindo, ${this.usuarioAtual.nome}!`);
                        }
                    }, 100);
                    
                    console.log('âœ… [AUTH] Login concluÃ­do com sucesso!');
                } catch (error) {
                    console.error('âŒ [AUTH] Erro fatal no login:', error);
                    alert('âš ï¸ Erro ao fazer login. Verifique o console (F12) para detalhes.');
                }
            },

            logout() {
                console.log('ğŸ” [AUTH] Logout solicitado');
                if (confirm('Deseja realmente sair do sistema?')) {
                    try {
                        localStorage.removeItem('usuario_logado');
                        this.usuarioAtual = null;
                        console.log('âœ… [AUTH] Logout realizado, recarregando pÃ¡gina...');
                        location.reload();
                    } catch (error) {
                        console.error('âŒ [AUTH] Erro no logout:', error);
                        location.reload(); // ForÃ§ar reload mesmo com erro
                    }
                }
            },

            mostrarLogin() {
                console.log('ğŸ”“ [AUTH] Mostrando tela de login...');
                try {
                    const loginOverlay = document.getElementById('loginOverlay');
                    const mainContainer = document.getElementById('mainContainer');
                    
                    if (loginOverlay && mainContainer) {
                        loginOverlay.classList.remove('hidden');
                        mainContainer.style.display = 'none';
                        console.log('âœ… [AUTH] Tela de login exibida');
                    } else {
                        console.error('âŒ [AUTH] Elementos de login nÃ£o encontrados');
                    }
                } catch (error) {
                    console.error('âŒ [AUTH] Erro ao mostrar login:', error);
                }
            },

            mostrarSistema() {
                console.log('ğŸ” [AUTH] Mostrando sistema principal...');
                try {
                    const loginOverlay = document.getElementById('loginOverlay');
                    const mainContainer = document.getElementById('mainContainer');
                    
                    if (!loginOverlay || !mainContainer) {
                        console.error('âŒ [AUTH] Elementos do sistema nÃ£o encontrados');
                        return;
                    }
                    
                    loginOverlay.classList.add('hidden');
                    mainContainer.style.display = 'block';
                    console.log('âœ… [AUTH] Containers alternados');
                    
                    // Atualizar informaÃ§Ãµes do usuÃ¡rio no header
                    if (this.usuarioAtual && this.usuarioAtual.nome) {
                        const inicial = this.usuarioAtual.nome.charAt(0).toUpperCase();
                        
                        const userAvatar = document.getElementById('userAvatar');
                        const userName = document.getElementById('userName');
                        const userRole = document.getElementById('userRole');
                        
                        if (userAvatar) userAvatar.textContent = inicial;
                        if (userName) userName.textContent = this.usuarioAtual.nome;
                        
                        const roleText = this.usuarioAtual.perfil === 'admin' ? 'ğŸ‘‘ Administrador' : 'ğŸ‘¨â€âš•ï¸ Profissional';
                        if (userRole) userRole.textContent = roleText;
                        
                        console.log('âœ… [AUTH] InformaÃ§Ãµes do usuÃ¡rio atualizadas no header');
                    }

                    // Atualizar nome do estabelecimento se existir
                    try {
                        if (typeof SistemaCore !== 'undefined' && SistemaCore.dados && SistemaCore.dados.estabelecimento) {
                            const estab = SistemaCore.dados.estabelecimento;
                            if (estab.nome) {
                                const nomeEstab = document.getElementById('nomeEstabelecimento');
                                if (nomeEstab) {
                                    nomeEstab.textContent = estab.nome;
                                    console.log('âœ… [AUTH] Nome do estabelecimento atualizado');
                                }
                            }
                        }
                    } catch (error) {
                        console.warn('âš ï¸ [AUTH] Erro ao atualizar estabelecimento:', error);
                        // NÃ£o Ã© crÃ­tico, continuar
                    }

                    // Aplicar permissÃµes (mostrar/ocultar abas)
                    this.aplicarPermissoes();
                    console.log('âœ… [AUTH] Sistema principal exibido com sucesso!');
                } catch (error) {
                    console.error('âŒ [AUTH] Erro ao mostrar sistema:', error);
                    // Em caso de erro, tentar mostrar login novamente
                    this.mostrarLogin();
                }
            },

            aplicarPermissoes() {
                const perfil = this.usuarioAtual.perfil;
                
                // Abas que sÃ³ ADMIN vÃª
                const abasAdmin = ['estabelecimento', 'reparticoes', 'profissionais', 'coleta', 'pools', 'configuracoes'];
                
                if (perfil === 'profissional') {
                    // Ocultar abas administrativas
                    abasAdmin.forEach(aba => {
                        const botao = document.querySelector(`button[onclick="Sistema.trocarTab('${aba}')"]`);
                        if (botao) {
                            botao.style.display = 'none';
                        }
                    });

                    // Mudar aba inicial para agenda
                    Sistema.trocarTab('agenda');
                } else {
                    // Admin vÃª tudo
                    abasAdmin.forEach(aba => {
                        const botao = document.querySelector(`button[onclick="Sistema.trocarTab('${aba}')"]`);
                        if (botao) {
                            botao.style.display = 'inline-flex';
                        }
                    });
                }
            },

            isAdmin() {
                return this.usuarioAtual && this.usuarioAtual.perfil === 'admin';
            },

            isProfissional() {
                return this.usuarioAtual && this.usuarioAtual.perfil === 'profissional';
            }
        };

        /* ============================================================
           [SISTEMA] MÃ³dulo Principal do Sistema
           ============================================================ */
        
        const Sistema = {
            // FunÃ§Ã£o de pluralizaÃ§Ã£o automÃ¡tica
            pluralizar(quantidade, palavraSingular) {
                if (quantidade === 1) return palavraSingular;
                
                // Regras bÃ¡sicas de pluralizaÃ§Ã£o em portuguÃªs
                const palavra = palavraSingular.toLowerCase();
                
                // Palavras terminadas em vogal â†’ adicionar 's'
                if (/[aeiou]$/.test(palavra)) {
                    return palavraSingular + 's';
                }
                
                // Palavras terminadas em 'r', 's', 'z' â†’ adicionar 'es'
                if (/[rsz]$/.test(palavra)) {
                    return palavraSingular + 'es';
                }
                
                // Palavras terminadas em 'l' â†’ trocar 'l' por 'is'
                if (/l$/.test(palavra)) {
                    return palavraSingular.slice(0, -1) + 'is';
                }
                
                // Palavras terminadas em 'Ã£o' â†’ trocar por 'Ãµes' (regra comum)
                if (/Ã£o$/.test(palavra)) {
                    return palavraSingular.slice(0, -2) + 'Ãµes';
                }
                
                // Caso padrÃ£o: adicionar 's'
                return palavraSingular + 's';
            },

            init() {
                SistemaCore.carregar();
                
                // AGORA SIM inicializar pools (DEPOIS de carregar dados)
                inicializarPools();
                
                this.atualizarData();
                this.atualizarDashboard();
                setInterval(() => this.atualizarData(), 60000);
            },

            trocarTab(nome) {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                event.target.classList.add('active');
                document.getElementById('tab-' + nome).classList.add('active');

                if (nome === 'agenda') {
                    Agenda.init(); // v7.6: Inicializar toda a Agenda
                }
                if (nome === 'escalas') {
                    Escalas.carregarFiltros();
                    Escalas.listar();
                }
                // v10.448: Tratar aba Cadastros
                if (nome === 'cadastros') {
                    Cadastros.init();
                }
                if (nome === 'coleta') ColetaDados.renderizar();
                if (nome === 'pools') Pools.listar(); // v7.3: Atualizar pools ao abrir aba
                if (nome === 'dashboard') this.atualizarDashboard();
                // if (nome === 'atendimentos') Atendimentos.listar(); // REMOVIDO v10.10.3: funÃ§Ã£o nÃ£o existe
                if (nome === 'atendimentos') {
                    console.log('ğŸ©º [v10.402] Inicializando aba Atendimentos...');
                    
                    // v10.449: Limpar atendimentos fantasmas ao entrar na aba
                    const fantasmasRemovidos = Atendimentos.limparAtendimentosFantasmas();
                    if (fantasmasRemovidos > 0) {
                        console.log(`ğŸ§¹ [v10.449] ${fantasmasRemovidos} registros fantasmas limpos`);
                    }
                    
                    // v10.402: Ativar sub-aba "Novo" e carregar modelos
                    setTimeout(() => {
                        Atendimentos.trocarAba('novo');
                        console.log('âœ… [v10.402] Sub-aba "Novo Atendimento" ativada e modelos carregados');
                    }, 100);
                }
                if (nome === 'prontuarios') {
                    Prontuarios.atualizarEstatisticas();
                    Prontuarios.listar();
                }
                if (nome === 'same') SAME.listar();
            },

            atualizarData() {
                const agora = new Date();
                const opcoes = { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                };
                document.getElementById('dataAtual').textContent = 
                    agora.toLocaleDateString('pt-BR', opcoes);
            },

            atualizarDashboard() {
                // Atualizar estatÃ­sticas bÃ¡sicas
                document.getElementById('stat-pacientes').textContent = 
                    SistemaCore.dados.pacientes.length;
                document.getElementById('stat-profissionais').textContent = 
                    SistemaCore.dados.profissionais.length;
                document.getElementById('stat-agendamentos').textContent = 
                    this.contarAgendamentosHoje();
                document.getElementById('stat-atendimentos').textContent = 
                    SistemaCore.dados.atendimentos.length;
                
                // Renderizar novos componentes
                this.renderizarNotificacoes();
                this.renderizarOcupacaoInternacao();
                this.renderizarOcupacaoEmergencia();
                this.renderizarOcupacaoCirurgia();
                this.renderizarProximosAgendamentos();
                this.renderizarProximasCirurgias();
                this.renderizarPacientesInternados();
            },

            renderizarNotificacoes() {
                const container = document.getElementById('painel-notificacoes');
                const notificacoes = this.gerarNotificacoes();
                
                if (notificacoes.length === 0) {
                    container.innerHTML = '';
                    return;
                }

                let html = '<div style="background: white; border-radius: 12px; padding: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">';
                html += '<h3 style="margin: 0 0 12px 0; display: flex; align-items: center; gap: 8px;"><span style="font-size: 20px;">ğŸ””</span> NotificaÃ§Ãµes <span class="notificacao-badge">' + notificacoes.length + '</span></h3>';
                
                notificacoes.forEach(n => {
                    html += `
                        <div class="notificacao-item ${n.tipo}">
                            <div class="notificacao-icone">${n.icone}</div>
                            <div class="notificacao-conteudo">
                                <div class="notificacao-titulo">${n.titulo}</div>
                                <div class="notificacao-descricao">${n.descricao}</div>
                            </div>
                            <div class="notificacao-tempo">${n.tempo}</div>
                        </div>
                    `;
                });
                
                html += '</div>';
                container.innerHTML = html;
            },

            gerarNotificacoes() {
                const notificacoes = [];
                const hoje = new Date().toISOString().split('T')[0];
                const agora = new Date();
                const horaAtual = agora.getHours() * 60 + agora.getMinutes();

                // Agendamentos prÃ³ximos (30 minutos)
                const agendamentosProximos = SistemaCore.dados.agendamentos.filter(a => {
                    if (a.data !== hoje || a.status !== 'agendado') return false;
                    const [h, m] = a.hora.split(':').map(Number);
                    const horaAgend = h * 60 + m;
                    return horaAgend - horaAtual > 0 && horaAgend - horaAtual <= 30;
                });

                agendamentosProximos.forEach(a => {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === a.paciente_id);
                    const [h, m] = a.hora.split(':').map(Number);
                    const horaAgend = h * 60 + m;
                    const minutos = horaAgend - horaAtual;
                    
                    notificacoes.push({
                        tipo: 'atencao',
                        icone: 'â°',
                        titulo: 'Agendamento em ' + minutos + ' minutos',
                        descricao: (paciente ? paciente.nome : 'Paciente') + ' Ã s ' + a.hora,
                        tempo: 'Hoje'
                    });
                });

                // Leitos reservados hÃ¡ mais de 24h
                const leitosReservados = SistemaCore.dados.reparticoes.filter(r => 
                    r.status === 'reservado' && r.reservado_em
                );

                leitosReservados.forEach(r => {
                    const horasReservado = (Date.now() - new Date(r.reservado_em)) / (1000 * 60 * 60);
                    if (horasReservado > 24) {
                        const paciente = SistemaCore.dados.pacientes.find(p => p.id === r.reservado_para_paciente_id);
                        notificacoes.push({
                            tipo: 'atencao',
                            icone: 'âš ï¸',
                            titulo: 'Reserva hÃ¡ ' + Math.floor(horasReservado) + 'h',
                            descricao: r.nome + ' - ' + (paciente ? paciente.nome : 'Paciente'),
                            tempo: 'HÃ¡ ' + Math.floor(horasReservado) + 'h'
                        });
                    }
                });

                // InternaÃ§Ãµes longas (>7 dias)
                const internacoesLongas = SistemaCore.dados.reparticoes.filter(r => 
                    r.status === 'ocupado' && r.data_ocupacao && r.tipo_reparticao === 'internacao'
                );

                internacoesLongas.forEach(r => {
                    const dias = Math.floor((Date.now() - new Date(r.data_ocupacao)) / (1000 * 60 * 60 * 24));
                    if (dias > 7) {
                        const paciente = SistemaCore.dados.pacientes.find(p => p.id === r.paciente_id);
                        notificacoes.push({
                            tipo: 'info',
                            icone: 'ğŸ“Š',
                            titulo: 'InternaÃ§Ã£o hÃ¡ ' + dias + ' dias',
                            descricao: r.nome + ' - ' + (paciente ? paciente.nome : 'Paciente'),
                            tempo: dias + ' dias'
                        });
                    }
                });

                // Cirurgias hoje
                const cirurgiasHoje = SistemaCore.dados.agendamentos.filter(a => {
                    const rep = SistemaCore.dados.reparticoes.find(r => r.id === a.reparticao_id);
                    return a.data === hoje && rep && rep.tipo_reparticao === 'bloco_cirurgico';
                });

                if (cirurgiasHoje.length > 0) {
                    notificacoes.push({
                        tipo: 'urgente',
                        icone: 'âš•ï¸',
                        titulo: cirurgiasHoje.length + ' cirurgia(s) hoje',
                        descricao: 'Bloco cirÃºrgico com agendamentos',
                        tempo: 'Hoje'
                    });
                }

                return notificacoes.slice(0, 5); // MÃ¡ximo 5 notificaÃ§Ãµes
            },

            renderizarOcupacaoInternacao() {
                const container = document.getElementById('stat-internacao-detalhes');
                const leitos = SistemaCore.dados.reparticoes.filter(r => r.tipo_reparticao === 'internacao');
                
                const total = leitos.length;
                const ocupados = leitos.filter(r => r.status === 'ocupado').length;
                const reservados = leitos.filter(r => r.status === 'reservado').length;
                const livres = leitos.filter(r => r.status === 'livre').length;
                const percentual = total > 0 ? Math.round((ocupados / total) * 100) : 0;

                container.innerHTML = `
                    <div class="mini-stat">
                        <span class="mini-stat-label">Total de Leitos</span>
                        <span class="mini-stat-value">${total}</span>
                    </div>
                    <div class="mini-stat">
                        <span class="mini-stat-label">ğŸ”´ Ocupados</span>
                        <span class="mini-stat-value" style="color: #ef4444;">${ocupados}</span>
                    </div>
                    <div class="mini-stat">
                        <span class="mini-stat-label">ğŸŸ¡ Reservados</span>
                        <span class="mini-stat-value" style="color: #f59e0b;">${reservados}</span>
                    </div>
                    <div class="mini-stat">
                        <span class="mini-stat-label">ğŸŸ¢ Livres</span>
                        <span class="mini-stat-value" style="color: #10b981;">${livres}</span>
                    </div>
                    <div style="margin-top: 12px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                            <span style="font-size: 12px; color: var(--text-light);">Taxa de OcupaÃ§Ã£o</span>
                            <span style="font-size: 14px; font-weight: 700; color: var(--text);">${percentual}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentual}%; background: ${percentual > 80 ? '#ef4444' : percentual > 60 ? '#f59e0b' : '#10b981'}"></div>
                        </div>
                    </div>
                `;
            },

            renderizarOcupacaoEmergencia() {
                const container = document.getElementById('stat-emergencia-detalhes');
                const leitos = SistemaCore.dados.reparticoes.filter(r => r.tipo_reparticao === 'emergencia');
                
                const total = leitos.length;
                const ocupados = leitos.filter(r => r.status === 'ocupado').length;
                const livres = leitos.filter(r => r.status === 'livre').length;
                const percentual = total > 0 ? Math.round((ocupados / total) * 100) : 0;

                container.innerHTML = `
                    <div class="mini-stat">
                        <span class="mini-stat-label">Total de Leitos</span>
                        <span class="mini-stat-value">${total}</span>
                    </div>
                    <div class="mini-stat">
                        <span class="mini-stat-label">ğŸ”´ Ocupados</span>
                        <span class="mini-stat-value" style="color: #ef4444;">${ocupados}</span>
                    </div>
                    <div class="mini-stat">
                        <span class="mini-stat-label">ğŸŸ¢ Livres</span>
                        <span class="mini-stat-value" style="color: #10b981;">${livres}</span>
                    </div>
                    <div style="margin-top: 12px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                            <span style="font-size: 12px; color: var(--text-light);">Taxa de OcupaÃ§Ã£o</span>
                            <span style="font-size: 14px; font-weight: 700; color: var(--text);">${percentual}%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentual}%; background: ${percentual > 80 ? '#ef4444' : percentual > 60 ? '#f59e0b' : '#10b981'}"></div>
                        </div>
                    </div>
                `;
            },

            renderizarOcupacaoCirurgia() {
                const container = document.getElementById('stat-cirurgia-detalhes');
                const salas = SistemaCore.dados.reparticoes.filter(r => r.tipo_reparticao === 'bloco_cirurgico');
                const hoje = new Date().toISOString().split('T')[0];
                
                const cirurgiasHoje = SistemaCore.dados.agendamentos.filter(a => {
                    const rep = SistemaCore.dados.reparticoes.find(r => r.id === a.reparticao_id);
                    return a.data === hoje && rep && rep.tipo_reparticao === 'bloco_cirurgico';
                }).length;

                const cirurgiasSemana = SistemaCore.dados.agendamentos.filter(a => {
                    const rep = SistemaCore.dados.reparticoes.find(r => r.id === a.reparticao_id);
                    if (!rep || rep.tipo_reparticao !== 'bloco_cirurgico') return false;
                    
                    const dataAgend = new Date(a.data + 'T00:00:00');
                    const hojeDt = new Date(hoje + 'T00:00:00');
                    const diff = (dataAgend - hojeDt) / (1000 * 60 * 60 * 24);
                    return diff >= 0 && diff <= 7;
                }).length;

                container.innerHTML = `
                    <div class="mini-stat">
                        <span class="mini-stat-label">Salas CirÃºrgicas</span>
                        <span class="mini-stat-value">${salas.length}</span>
                    </div>
                    <div class="mini-stat">
                        <span class="mini-stat-label">âš•ï¸ Cirurgias Hoje</span>
                        <span class="mini-stat-value" style="color: #8b5cf6;">${cirurgiasHoje}</span>
                    </div>
                    <div class="mini-stat">
                        <span class="mini-stat-label">ğŸ“… Esta Semana</span>
                        <span class="mini-stat-value" style="color: #3b82f6;">${cirurgiasSemana}</span>
                    </div>
                `;
            },

            renderizarProximosAgendamentos() {
                const container = document.getElementById('proximos-agendamentos');
                const hoje = new Date().toISOString().split('T')[0];
                const agora = new Date();
                const horaAtual = agora.getHours() * 60 + agora.getMinutes();

                let agendamentos = SistemaCore.dados.agendamentos.filter(a => {
                    if (a.status !== 'agendado') return false;
                    
                    // Se Ã© hoje, sÃ³ mostrar futuros
                    if (a.data === hoje) {
                        const [h, m] = a.hora.split(':').map(Number);
                        const horaAgend = h * 60 + m;
                        return horaAgend >= horaAtual;
                    }
                    
                    // Se Ã© futuro, mostrar
                    return a.data > hoje;
                }).sort((a, b) => {
                    if (a.data !== b.data) return a.data.localeCompare(b.data);
                    return a.hora.localeCompare(b.hora);
                }).slice(0, 5);

                if (agendamentos.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 20px;">Nenhum agendamento prÃ³ximo</p>';
                    return;
                }

                let html = '<div style="display: flex; flex-direction: column; gap: 8px;">';
                agendamentos.forEach(a => {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === a.paciente_id);
                    const profissional = SistemaCore.dados.profissionais.find(p => p.id === a.profissional_id);
                    const rep = SistemaCore.dados.reparticoes.find(r => r.id === a.reparticao_id);
                    
                    const dataFormatada = new Date(a.data + 'T00:00:00').toLocaleDateString('pt-BR', { 
                        day: '2-digit', 
                        month: '2-digit'
                    });
                    
                    html += `
                        <div style="background: var(--bg); padding: 12px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; color: var(--text); margin-bottom: 4px;">
                                        ${paciente ? paciente.nome : 'Paciente'}
                                    </div>
                                    <div style="font-size: 13px; color: var(--text-light);">
                                        ğŸ‘¨â€âš•ï¸ ${profissional ? profissional.nome : 'Profissional'}<br>
                                        ğŸ¥ ${rep ? rep.nome : 'Unidade'}
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 600; color: #3b82f6;">${a.hora}</div>
                                    <div style="font-size: 12px; color: var(--text-light);">${dataFormatada}</div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;
            },

            renderizarProximasCirurgias() {
                const container = document.getElementById('proximas-cirurgias');
                const hoje = new Date().toISOString().split('T')[0];

                let cirurgias = SistemaCore.dados.agendamentos.filter(a => {
                    const rep = SistemaCore.dados.reparticoes.find(r => r.id === a.reparticao_id);
                    return a.status === 'agendado' && rep && rep.tipo_reparticao === 'bloco_cirurgico' && a.data >= hoje;
                }).sort((a, b) => {
                    if (a.data !== b.data) return a.data.localeCompare(b.data);
                    return a.hora.localeCompare(b.hora);
                }).slice(0, 5);

                if (cirurgias.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 20px;">Nenhuma cirurgia agendada</p>';
                    return;
                }

                let html = '<div style="display: flex; flex-direction: column; gap: 8px;">';
                cirurgias.forEach(a => {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === a.paciente_id);
                    const profissional = SistemaCore.dados.profissionais.find(p => p.id === a.profissional_id);
                    const sala = SistemaCore.dados.reparticoes.find(r => r.id === a.reparticao_id);
                    
                    const dataFormatada = new Date(a.data + 'T00:00:00').toLocaleDateString('pt-BR', { 
                        day: '2-digit', 
                        month: '2-digit'
                    });
                    
                    const isHoje = a.data === hoje;
                    
                    html += `
                        <div style="background: var(--bg); padding: 12px; border-radius: 8px; border-left: 3px solid ${isHoje ? '#ef4444' : '#8b5cf6'};">
                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; color: var(--text); margin-bottom: 4px;">
                                        ${paciente ? paciente.nome : 'Paciente'}
                                    </div>
                                    <div style="font-size: 13px; color: var(--text-light);">
                                        ğŸ‘¨â€âš•ï¸ ${profissional ? profissional.nome : 'Profissional'}<br>
                                        âš•ï¸ ${sala ? sala.nome : 'Sala'}
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 600; color: ${isHoje ? '#ef4444' : '#8b5cf6'};">${a.hora}</div>
                                    <div style="font-size: 12px; color: var(--text-light);">${dataFormatada}</div>
                                    ${isHoje ? '<div style="font-size: 11px; color: #ef4444; font-weight: 600;">HOJE</div>' : ''}
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;
            },

            renderizarPacientesInternados() {
                const container = document.getElementById('pacientes-internados');
                const internados = SistemaCore.dados.reparticoes.filter(r => 
                    r.status === 'ocupado' && r.paciente_id && (r.tipo_reparticao === 'internacao' || r.tipo_reparticao === 'emergencia')
                ).sort((a, b) => new Date(a.data_ocupacao) - new Date(b.data_ocupacao));

                if (internados.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 20px;">Nenhum paciente internado</p>';
                    return;
                }

                let html = '<div style="display: grid; gap: 12px;">';
                internados.forEach(r => {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === r.paciente_id);
                    const dias = Math.floor((Date.now() - new Date(r.data_ocupacao)) / (1000 * 60 * 60 * 24));
                    const cor = r.tipo_reparticao === 'emergencia' ? '#ef4444' : '#f59e0b';
                    
                    html += `
                        <div style="background: var(--bg); padding: 16px; border-radius: 8px; border-left: 4px solid ${cor};">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                <div>
                                    <div style="font-weight: 600; font-size: 16px; color: var(--text); margin-bottom: 4px;">
                                        ğŸ‘¤ ${paciente ? paciente.nome : 'Paciente nÃ£o encontrado'}
                                    </div>
                                    <div style="font-size: 13px; color: var(--text-light);">
                                        ğŸ›ï¸ ${r.nome}
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="background: ${cor}; color: white; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 600;">
                                        ${dias} dia(s)
                                    </div>
                                </div>
                            </div>
                            ${r.motivo_internacao ? `
                            <div style="background: rgba(0,0,0,0.03); padding: 8px; border-radius: 4px; font-size: 13px; color: var(--text-light);">
                                ğŸ“ ${r.motivo_internacao}
                            </div>
                            ` : ''}
                            <div style="margin-top: 8px; display: flex; gap: 8px;">
                                <button class="btn btn-info btn-sm" onclick="Atendimentos.verProntuario(${r.paciente_id})">ğŸ“‹ ProntuÃ¡rio</button>
                                <button class="btn btn-danger btn-sm" onclick="Reparticoes.abrirModalAlta(${r.id})">âœ… Alta</button>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;
            },

            contarAgendamentosHoje() {
                const hoje = new Date().toISOString().split('T')[0];
                return SistemaCore.dados.agendamentos.filter(a => a.data === hoje).length;
            },

            renderizarAgendaHoje() {
                const container = document.getElementById('agendaHoje');
                const hoje = new Date().toISOString().split('T')[0];
                const agendamentos = SistemaCore.dados.agendamentos
                    .filter(a => a.data === hoje)
                    .sort((a, b) => a.hora.localeCompare(b.hora));

                if (agendamentos.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light);">Nenhum agendamento para hoje.</p>';
                    return;
                }

                let html = '<div class="item-list">';
                agendamentos.forEach(a => {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === a.paciente_id);
                    const profissional = SistemaCore.dados.profissionais.find(p => p.id === a.profissional_id);
                    
                    const statusBadge = {
                        'agendado': 'badge-info',
                        'realizado': 'badge-success',
                        'cancelado': 'badge-danger'
                    }[a.status] || 'badge-info';
                    
                    html += `
                        <div class="item-card">
                            <div>
                                <strong>${a.hora}</strong> - ${paciente ? paciente.nome : 'Paciente nÃ£o encontrado'}
                                <br>
                                <small style="color: var(--text-light);">
                                    Dr(a). ${profissional ? profissional.nome : 'Profissional nÃ£o encontrado'}
                                </small>
                            </div>
                            <div class="action-buttons">
                                <span class="badge ${statusBadge}">${a.status || 'agendado'}</span>
                                ${a.status !== 'realizado' ? `<button class="btn btn-icon btn-success" onclick="Atendimentos.atenderDaAgenda(${a.id})">ğŸ©º</button>` : ''}
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;
            },

            // v10.448: Sistema de notificaÃ§Ãµes empilhadas
            notificacoesAtivas: [],
            
            notificar(mensagem, tipo = 'success') {
                const div = document.createElement('div');
                div.className = 'notificacao ' + (tipo === 'error' ? 'error' : tipo === 'warning' ? 'warning' : '');
                div.textContent = mensagem;
                
                // Calcular posiÃ§Ã£o baseada nas notificaÃ§Ãµes ativas
                const offset = this.notificacoesAtivas.length * 60; // 60px por notificaÃ§Ã£o
                div.style.top = (20 + offset) + 'px';
                
                document.body.appendChild(div);
                this.notificacoesAtivas.push(div);
                
                // Remover apÃ³s 3 segundos
                setTimeout(() => {
                    const index = this.notificacoesAtivas.indexOf(div);
                    if (index > -1) {
                        this.notificacoesAtivas.splice(index, 1);
                    }
                    div.style.animation = 'slideOut 0.3s forwards';
                    setTimeout(() => {
                        div.remove();
                        // Reposicionar notificaÃ§Ãµes restantes
                        this.notificacoesAtivas.forEach((n, i) => {
                            n.style.top = (20 + i * 60) + 'px';
                        });
                    }, 300);
                }, 3000);
            },

            exportarDados() {
                const dataStr = JSON.stringify(SistemaCore.dados, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `sistema_hospitalar_backup_${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                this.notificar('Dados exportados com sucesso!');
            },

            importarDados() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            SistemaCore.dados = JSON.parse(event.target.result);
                            SistemaCore.salvar();
                            this.notificar('Dados importados com sucesso!');
                            location.reload();
                        } catch (error) {
                            this.notificar('Erro ao importar dados!', 'error');
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            },

            limparDados() {
                if (!confirm('âš ï¸ ATENÃ‡ÃƒO: RESET TOTAL! âš ï¸\n\nVocÃª estÃ¡ prestes a apagar ABSOLUTAMENTE TUDO:\n\nâŒ Estabelecimento\nâŒ RepartiÃ§Ãµes\nâŒ Profissionais\nâŒ Pacientes\nâŒ Agendamentos\nâŒ Atendimentos\nâŒ ProntuÃ¡rios\nâŒ SAME\nâŒ Todas as configuraÃ§Ãµes\n\nO sistema voltarÃ¡ ao estado inicial como se nunca tivesse sido usado!\n\nTem CERTEZA que deseja continuar?')) return;
                
                if (!confirm('ÃšLTIMA CHANCE!\n\nTodos os dados serÃ£o PERMANENTEMENTE APAGADOS.\n\nDeseja realmente continuar com o RESET TOTAL?')) return;
                
                localStorage.removeItem('sistema_hospitalar_v5');
                location.reload();
            },

            resetarDadosTeste() {
                if (!confirm('Deseja resetar os dados de teste?\n\nIsso vai manter apenas o Estabelecimento configurado e limpar:\nâ€¢ RepartiÃ§Ãµes\nâ€¢ Profissionais\nâ€¢ Pacientes\nâ€¢ Agendamentos\nâ€¢ Atendimentos\nâ€¢ ProntuÃ¡rios\nâ€¢ SAME\n\nÃ‰ Ãºtil para comeÃ§ar testes limpos. Confirmar?')) return;
                
                // Manter apenas o estabelecimento e configuraÃ§Ãµes
                const estabelecimento = SistemaCore.dados.estabelecimento;
                const permissoes = SistemaCore.dados.permissoes;
                
                // Resetar tudo
                SistemaCore.dados = {
                    estabelecimento: estabelecimento || {},
                    reparticoes: [],
                    profissionais: [],
                    pacientes: [],
                    agendamentos: [],
                    atendimentos: [],
                    prontuarios: [],
                    camposColeta: [],
                    dadosColetados: [],
                    permissoes: permissoes || {
                        categorias: ['medico', 'enfermeiro', 'assistente_social', 'fisioterapeuta', 'psicologo', 'nutricionista', 'farmaceutico']
                    },
                    same: [] // HistÃ³rico de altas
                };
                
                SistemaCore.salvar();
                this.notificar('âœ… Dados de teste resetados! Estabelecimento mantido.');
                setTimeout(() => location.reload(), 1500);
            },

            // v7.9: Diagnosticar leitos fantasmas
            diagnosticarLeitos() {
                console.log('ğŸ” [DIAGNÃ“STICO] Iniciando diagnÃ³stico de leitos fantasmas...');
                
                const reparticoes = SistemaCore.dados.reparticoes;
                const pacientes = SistemaCore.dados.pacientes;
                const resultado = document.getElementById('diagnostico-resultado');
                
                let problemasEncontrados = [];
                let totalLeitos = 0;
                let leitosOcupados = 0;
                let leitosFantasmas = 0;
                
                reparticoes.forEach(rep => {
                    // SÃ³ verificar leitos (nÃ£o grupos)
                    if (!rep.eh_grupo) {
                        totalLeitos++;
                        
                        if (rep.status === 'ocupado') {
                            leitosOcupados++;
                            
                            // Verificar se tem paciente vÃ¡lido
                            if (!rep.paciente_id) {
                                leitosFantasmas++;
                                problemasEncontrados.push({
                                    id: rep.id,
                                    nome: rep.nome,
                                    tipo: rep.tipo_reparticao || 'consultorio',
                                    problema: 'Marcado como ocupado mas SEM paciente_id'
                                });
                            } else {
                                // Verificar se o paciente existe
                                const pacienteExiste = pacientes.find(p => p.id === rep.paciente_id);
                                if (!pacienteExiste) {
                                    leitosFantasmas++;
                                    problemasEncontrados.push({
                                        id: rep.id,
                                        nome: rep.nome,
                                        tipo: rep.tipo_reparticao || 'consultorio',
                                        problema: `Paciente ID ${rep.paciente_id} nÃ£o existe mais`
                                    });
                                }
                            }
                        }
                    }
                });
                
                // Mostrar resultado
                resultado.style.display = 'block';
                
                if (problemasEncontrados.length === 0) {
                    resultado.innerHTML = `
                        <div style="color: #059669; font-weight: 600; margin-bottom: 12px;">
                            âœ… SISTEMA LIMPO! Nenhum problema encontrado.
                        </div>
                        <div style="font-size: 14px; color: var(--text-light);">
                            ğŸ“Š <strong>EstatÃ­sticas:</strong><br>
                            â€¢ Total de leitos: ${totalLeitos}<br>
                            â€¢ Leitos ocupados: ${leitosOcupados}<br>
                            â€¢ Leitos fantasmas: 0<br><br>
                            Todos os leitos ocupados tÃªm pacientes vÃ¡lidos associados.
                        </div>
                    `;
                } else {
                    let html = `
                        <div style="color: #dc2626; font-weight: 600; margin-bottom: 12px;">
                            âš ï¸ PROBLEMAS ENCONTRADOS: ${leitosFantasmas} ${Sistema.pluralizar(leitosFantasmas, 'leito fantasma')}
                        </div>
                        <div style="font-size: 14px; color: var(--text-light); margin-bottom: 16px;">
                            ğŸ“Š <strong>EstatÃ­sticas:</strong><br>
                            â€¢ Total de leitos: ${totalLeitos}<br>
                            â€¢ Leitos ocupados: ${leitosOcupados}<br>
                            â€¢ Leitos fantasmas: ${leitosFantasmas}<br>
                        </div>
                        <div style="margin-top: 16px;">
                            <strong style="color: #dc2626;">Leitos com problema:</strong>
                            <div style="margin-top: 8px; max-height: 300px; overflow-y: auto;">
                    `;
                    
                    problemasEncontrados.forEach((p, index) => {
                        html += `
                            <div style="padding: 12px; background: white; border: 1px solid #fecaca; border-radius: 6px; margin-bottom: 8px;">
                                <div style="font-weight: 600; color: #991b1b;">${index + 1}. ${p.nome}</div>
                                <div style="font-size: 13px; color: #dc2626; margin-top: 4px;">
                                    âš ï¸ ${p.problema}
                                </div>
                                <div style="font-size: 12px; color: var(--text-light); margin-top: 4px;">
                                    Tipo: ${p.tipo} | ID: ${p.id}
                                </div>
                            </div>
                        `;
                    });
                    
                    html += `
                            </div>
                        </div>
                        <div style="margin-top: 16px; padding: 12px; background: #f9fafb; border-radius: 6px; border: 1px solid #fbbf24;">
                            <p style="font-size: 13px; color: #92400e; margin: 0;">
                                ğŸ’¡ <strong>Como corrigir:</strong><br>
                                Clique no botÃ£o "ğŸ§¹ Limpar Leitos Fantasmas" acima para liberar automaticamente todos esses leitos.
                            </p>
                        </div>
                    `;
                    
                    resultado.innerHTML = html;
                }
                
                console.log('âœ… [DIAGNÃ“STICO] Completo!', {
                    totalLeitos,
                    leitosOcupados,
                    leitosFantasmas,
                    problemas: problemasEncontrados
                });
            },

            // v7.9: Limpar leitos fantasmas
            limparLeitosFantasmas() {
                console.log('ğŸ§¹ [LIMPEZA] Iniciando limpeza de leitos fantasmas...');
                
                // Primeiro diagnosticar
                const reparticoes = SistemaCore.dados.reparticoes;
                const pacientes = SistemaCore.dados.pacientes;
                
                let leitosLimpos = 0;
                
                reparticoes.forEach(rep => {
                    // SÃ³ verificar leitos ocupados (nÃ£o grupos)
                    if (!rep.eh_grupo && rep.status === 'ocupado') {
                        let precisaLimpar = false;
                        
                        // Sem paciente_id = problema
                        if (!rep.paciente_id) {
                            precisaLimpar = true;
                        } else {
                            // Paciente nÃ£o existe mais = problema
                            const pacienteExiste = pacientes.find(p => p.id === rep.paciente_id);
                            if (!pacienteExiste) {
                                precisaLimpar = true;
                            }
                        }
                        
                        if (precisaLimpar) {
                            console.log(`ğŸ§¹ Limpando leito: ${rep.nome} (ID: ${rep.id})`);
                            rep.status = 'livre';
                            rep.paciente_id = null;
                            rep.data_ocupacao = null;
                            rep.motivo_internacao = null;
                            leitosLimpos++;
                        }
                    }
                });
                
                if (leitosLimpos > 0) {
                    SistemaCore.salvar();
                    
                    const resultado = document.getElementById('diagnostico-resultado');
                    resultado.style.display = 'block';
                    resultado.innerHTML = `
                        <div style="color: #059669; font-weight: 600; margin-bottom: 12px;">
                            âœ… LIMPEZA CONCLUÃDA COM SUCESSO!
                        </div>
                        <div style="font-size: 14px; color: var(--text-light);">
                            ğŸ§¹ ${leitosLimpos} ${Sistema.pluralizar(leitosLimpos, 'leito')} ${leitosLimpos === 1 ? 'foi liberado' : 'foram liberados'}<br><br>
                            Todos os leitos fantasmas foram marcados como LIVRES e estÃ£o prontos para uso novamente.<br><br>
                            <strong>PrÃ³ximo passo:</strong> VÃ¡ na aba "Unidades" e verifique se pode excluir ou usar os leitos normalmente.
                        </div>
                    `;
                    
                    this.notificar(`âœ… ${leitosLimpos} ${Sistema.pluralizar(leitosLimpos, 'leito')} ${leitosLimpos === 1 ? 'limpo' : 'limpos'}!`);
                    
                    console.log('âœ… [LIMPEZA] Completa!', { leitosLimpos });
                    
                    // Atualizar visualizaÃ§Ã£o se estiver em Unidades ou Agenda
                    if (document.getElementById('tab-reparticoes').classList.contains('active')) {
                        setTimeout(() => Reparticoes.listar(), 1000);
                    }
                    if (document.getElementById('tab-agenda').classList.contains('active')) {
                        setTimeout(() => Agenda.renderizarCards(), 1000);
                    }
                } else {
                    const resultado = document.getElementById('diagnostico-resultado');
                    resultado.style.display = 'block';
                    resultado.innerHTML = `
                        <div style="color: #059669; font-weight: 600; margin-bottom: 12px;">
                            â„¹ï¸ NENHUM PROBLEMA ENCONTRADO
                        </div>
                        <div style="font-size: 14px; color: var(--text-light);">
                            NÃ£o hÃ¡ leitos fantasmas para limpar. Seu sistema estÃ¡ em ordem!
                        </div>
                    `;
                    
                    console.log('â„¹ï¸ [LIMPEZA] Nenhum leito para limpar');
                }
            },

            // v7.10: Diagnosticar profissionais com repartiÃ§Ãµes fantasmas
            diagnosticarProfissionais() {
                console.log('ğŸ” [DIAGNÃ“STICO] Verificando profissionais...');
                
                const profissionais = SistemaCore.dados.profissionais;
                const reparticoes = SistemaCore.dados.reparticoes;
                const reparticoesIds = reparticoes.map(r => r.id);
                const reparticoesValidas = reparticoes.filter(r => !r.eh_subreparticao).map(r => r.id); // v7.10.1: Apenas grupos
                
                let problemas = [];
                
                profissionais.forEach(prof => {
                    let fantasmasEncontrados = [];
                    
                    // Verificar reparticoes_ids (novo formato)
                    if (prof.reparticoes_ids && prof.reparticoes_ids.length > 0) {
                        // Remover IDs que nÃ£o existem OU que sÃ£o sub-repartiÃ§Ãµes
                        const invalidos = prof.reparticoes_ids.filter(id => !reparticoesValidas.includes(id));
                        if (invalidos.length > 0) {
                            fantasmasEncontrados = fantasmasEncontrados.concat(invalidos);
                        }
                    }
                    
                    // Verificar reparticao_id (formato antigo)
                    if (prof.reparticao_id && !reparticoesValidas.includes(prof.reparticao_id)) {
                        fantasmasEncontrados.push(prof.reparticao_id);
                    }
                    
                    if (fantasmasEncontrados.length > 0) {
                        problemas.push({
                            profissional: prof,
                            fantasmas: fantasmasEncontrados,
                            total: fantasmasEncontrados.length
                        });
                    }
                });
                
                console.log('ğŸ“Š [DIAGNÃ“STICO] Resultado:', {
                    totalProfissionais: profissionais.length,
                    profissionaisComProblema: problemas.length,
                    problemas: problemas
                });
                
                const resultado = document.getElementById('diagnostico-profissionais-resultado');
                resultado.style.display = 'block';
                
                if (problemas.length === 0) {
                    resultado.innerHTML = `
                        <div style="color: #059669; font-weight: 600; margin-bottom: 12px;">
                            âœ… TUDO OK!
                        </div>
                        <div style="font-size: 14px; color: var(--text-light);">
                            Nenhum profissional com repartiÃ§Ãµes fantasmas ou sub-repartiÃ§Ãµes encontrado.<br>
                            Todos os ${profissionais.length} ${Sistema.pluralizar(profissionais.length, 'profissional')} ${profissionais.length === 1 ? 'estÃ¡' : 'estÃ£o'} com vÃ­nculos corretos.
                        </div>
                    `;
                } else {
                    let detalhes = '';
                    problemas.forEach(p => {
                        detalhes += `
                            <div style="padding: 8px; background: white; border-radius: 4px; margin-bottom: 8px;">
                                <strong>ğŸ‘¤ ${p.profissional.nome}</strong><br>
                                <span style="font-size: 13px; color: #64748b;">
                                    ${p.fantasmas.length} vÃ­nculo(s) invÃ¡lido(s): IDs ${p.fantasmas.join(', ')}<br>
                                    <em>(repartiÃ§Ãµes deletadas ou sub-repartiÃ§Ãµes individuais)</em>
                                </span>
                            </div>
                        `;
                    });
                    
                    resultado.innerHTML = `
                        <div style="color: #dc2626; font-weight: 600; margin-bottom: 12px;">
                            âš ï¸ PROBLEMAS ENCONTRADOS!
                        </div>
                        <div style="font-size: 14px; margin-bottom: 16px;">
                            ${problemas.length} ${Sistema.pluralizar(problemas.length, 'profissional')} com vÃ­nculos invÃ¡lidos:
                        </div>
                        ${detalhes}
                        <div style="margin-top: 16px; padding: 12px; background: #f9fafb; border-radius: 6px; font-size: 13px;">
                            ğŸ’¡ <strong>SoluÃ§Ã£o:</strong> Clique no botÃ£o "ğŸ§¹ Limpar RepartiÃ§Ãµes Fantasmas" para corrigir automaticamente.<br>
                            <em>Nota: Profissionais devem ser vinculados a grupos (Enfermaria UTQ), nÃ£o a leitos individuais (Leito 1).</em>
                        </div>
                    `;
                }
            },

            // v7.10.1: Limpar repartiÃ§Ãµes fantasmas e sub-repartiÃ§Ãµes dos profissionais
            limparReparticoesFantasmas() {
                console.log('ğŸ§¹ [LIMPEZA] Iniciando limpeza de repartiÃ§Ãµes fantasmas e sub-repartiÃ§Ãµes...');
                
                const profissionais = SistemaCore.dados.profissionais;
                const reparticoes = SistemaCore.dados.reparticoes;
                const reparticoesValidas = reparticoes.filter(r => !r.eh_subreparticao).map(r => r.id); // v7.10.1: Apenas grupos
                
                let profissionaisCorrigidos = 0;
                let totalRemocoes = 0;
                
                profissionais.forEach(prof => {
                    let corrigiu = false;
                    
                    // Limpar reparticoes_ids (novo formato)
                    if (prof.reparticoes_ids && prof.reparticoes_ids.length > 0) {
                        const antes = prof.reparticoes_ids.length;
                        // v7.10.1: Manter apenas repartiÃ§Ãµes vÃ¡lidas (que existem E nÃ£o sÃ£o sub-repartiÃ§Ãµes)
                        prof.reparticoes_ids = prof.reparticoes_ids.filter(id => reparticoesValidas.includes(id));
                        const depois = prof.reparticoes_ids.length;
                        
                        if (antes !== depois) {
                            corrigiu = true;
                            totalRemocoes += (antes - depois);
                            console.log(`ğŸ§¹ ${prof.nome}: Removidos ${antes - depois} vÃ­nculos invÃ¡lidos`);
                        }
                    }
                    
                    // Limpar reparticao_id (formato antigo)
                    if (prof.reparticao_id && !reparticoesValidas.includes(prof.reparticao_id)) {
                        console.log(`ğŸ§¹ ${prof.nome}: Removido vÃ­nculo antigo invÃ¡lido (ID: ${prof.reparticao_id})`);
                        prof.reparticao_id = null;
                        corrigiu = true;
                        totalRemocoes++;
                    }
                    
                    if (corrigiu) {
                        profissionaisCorrigidos++;
                    }
                });
                
                if (profissionaisCorrigidos > 0) {
                    SistemaCore.salvar();
                    
                    const resultado = document.getElementById('diagnostico-profissionais-resultado');
                    resultado.style.display = 'block';
                    resultado.innerHTML = `
                        <div style="color: #059669; font-weight: 600; margin-bottom: 12px;">
                            âœ… LIMPEZA CONCLUÃDA COM SUCESSO!
                        </div>
                        <div style="font-size: 14px; color: var(--text-light);">
                            ğŸ§¹ ${profissionaisCorrigidos} ${Sistema.pluralizar(profissionaisCorrigidos, 'profissional')} ${profissionaisCorrigidos === 1 ? 'corrigido' : 'corrigidos'}<br>
                            ğŸ—‘ï¸ ${totalRemocoes} ${Sistema.pluralizar(totalRemocoes, 'vÃ­nculo')} ${totalRemocoes === 1 ? 'removido' : 'removidos'}<br><br>
                            Removidos vÃ­nculos com:<br>
                            â€¢ RepartiÃ§Ãµes que nÃ£o existem mais<br>
                            â€¢ Sub-repartiÃ§Ãµes individuais (Leito 1, Leito 2, etc)<br><br>
                            <strong>PrÃ³ximo passo:</strong> Edite cada profissional e adicione os grupos corretos (ex: Enfermaria UTQ, nÃ£o Leito 1).
                        </div>
                    `;
                    
                    this.notificar(`âœ… ${profissionaisCorrigidos} ${Sistema.pluralizar(profissionaisCorrigidos, 'profissional')} ${profissionaisCorrigidos === 1 ? 'corrigido' : 'corrigidos'}!`);
                    
                    console.log('âœ… [LIMPEZA] Completa!', { profissionaisCorrigidos, totalRemocoes });
                } else {
                    const resultado = document.getElementById('diagnostico-profissionais-resultado');
                    resultado.style.display = 'block';
                    resultado.innerHTML = `
                        <div style="color: #059669; font-weight: 600; margin-bottom: 12px;">
                            â„¹ï¸ NENHUM PROBLEMA ENCONTRADO
                        </div>
                        <div style="font-size: 14px; color: var(--text-light);">
                            NÃ£o hÃ¡ vÃ­nculos invÃ¡lidos para limpar. Seu sistema estÃ¡ em ordem!
                        </div>
                    `;
                    
                    console.log('â„¹ï¸ [LIMPEZA] Nenhum vÃ­nculo invÃ¡lido para limpar');
                }
            },

            // v7.10.2: Sincronizar configuraÃ§Ãµes de especialidades de grupos para leitos
            sincronizarEspecialidadesLeitos() {
                console.log('ğŸ”„ [SINC] Iniciando sincronizaÃ§Ã£o de especialidades...');
                
                const reparticoes = SistemaCore.dados.reparticoes;
                const grupos = reparticoes.filter(r => r.eh_grupo && r.subreparticoes_ids && r.subreparticoes_ids.length > 0);
                
                let leitosAtualizados = 0;
                let gruposProcessados = 0;
                
                grupos.forEach(grupo => {
                    console.log(`ğŸ”„ [SINC] Processando grupo: ${grupo.nome}`);
                    console.log(`   Aceita todas: ${grupo.aceita_todas_especialidades}`);
                    console.log(`   Especialidades: ${grupo.especialidades_permitidas}`);
                    
                    grupo.subreparticoes_ids.forEach(leitoId => {
                        const leito = reparticoes.find(r => r.id === leitoId);
                        if (leito) {
                            // Copiar configuraÃ§Ãµes do grupo para o leito
                            leito.aceita_todas_especialidades = grupo.aceita_todas_especialidades || false;
                            leito.especialidades_permitidas = grupo.especialidades_permitidas ? [...grupo.especialidades_permitidas] : [];
                            
                            console.log(`   âœ… ${leito.nome} atualizado`);
                            leitosAtualizados++;
                        }
                    });
                    
                    gruposProcessados++;
                });
                
                if (leitosAtualizados > 0) {
                    SistemaCore.salvar();
                    
                    const resultado = document.getElementById('diagnostico-sincronizacao-resultado');
                    resultado.style.display = 'block';
                    resultado.innerHTML = `
                        <div style="color: #059669; font-weight: 600; margin-bottom: 12px;">
                            âœ… SINCRONIZAÃ‡ÃƒO CONCLUÃDA!
                        </div>
                        <div style="font-size: 14px; color: var(--text-light);">
                            ğŸ”„ ${gruposProcessados} ${Sistema.pluralizar(gruposProcessados, 'grupo')} processado(s)<br>
                            âœ… ${leitosAtualizados} ${Sistema.pluralizar(leitosAtualizados, 'leito')} ${leitosAtualizados === 1 ? 'atualizado' : 'atualizados'}<br><br>
                            Todos os leitos individuais agora tÃªm as mesmas configuraÃ§Ãµes de especialidades dos seus grupos!<br><br>
                            <strong>PrÃ³ximo passo:</strong> Tente internar um paciente. Agora deve funcionar!
                        </div>
                    `;
                    
                    this.notificar(`âœ… ${leitosAtualizados} ${Sistema.pluralizar(leitosAtualizados, 'leito')} sincronizado(s)!`);
                    console.log('âœ… [SINC] Completa!', { gruposProcessados, leitosAtualizados });
                } else {
                    const resultado = document.getElementById('diagnostico-sincronizacao-resultado');
                    resultado.style.display = 'block';
                    resultado.innerHTML = `
                        <div style="color: #059669; font-weight: 600; margin-bottom: 12px;">
                            â„¹ï¸ NENHUMA ATUALIZAÃ‡ÃƒO NECESSÃRIA
                        </div>
                        <div style="font-size: 14px; color: var(--text-light);">
                            NÃ£o hÃ¡ grupos com leitos para sincronizar, ou jÃ¡ estÃ£o sincronizados!
                        </div>
                    `;
                    
                    console.log('â„¹ï¸ [SINC] Nada para sincronizar');
                }
            },

            // ğŸ”´ FASE 1 - ETAPA 1.1: Limpar duplicatas de pacientes e profissionais
            limparDuplicatas() {
                console.log('ğŸ§¹ [LIMPEZA] Iniciando limpeza de duplicatas...');
                
                let pacientesRemovidos = 0;
                let profissionaisRemovidos = 0;
                
                // 1. LIMPAR DUPLICATAS DE PACIENTES (por CPF)
                const pacientes = SistemaCore.dados.pacientes;
                const cpfsVistos = new Map();
                const pacientesParaManter = [];
                
                pacientes.forEach(pac => {
                    if (!pac.cpf) {
                        pacientesParaManter.push(pac); // Manter pacientes sem CPF
                        return;
                    }
                    
                    if (cpfsVistos.has(pac.cpf)) {
                        // Duplicata encontrada - manter o mais recente (maior ID)
                        const existente = cpfsVistos.get(pac.cpf);
                        if (pac.id > existente.id) {
                            // Novo Ã© mais recente, substituir
                            const index = pacientesParaManter.findIndex(p => p.id === existente.id);
                            pacientesParaManter[index] = pac;
                            cpfsVistos.set(pac.cpf, pac);
                            pacientesRemovidos++;
                            console.log(`ğŸ—‘ï¸ Removida duplicata: ${existente.nome} (ID ${existente.id}), mantido ${pac.nome} (ID ${pac.id})`);
                        } else {
                            // Existente Ã© mais recente, descartar novo
                            pacientesRemovidos++;
                            console.log(`ğŸ—‘ï¸ Removida duplicata: ${pac.nome} (ID ${pac.id}), mantido ${existente.nome} (ID ${existente.id})`);
                        }
                    } else {
                        cpfsVistos.set(pac.cpf, pac);
                        pacientesParaManter.push(pac);
                    }
                });
                
                // 2. LIMPAR DUPLICATAS DE PROFISSIONAIS (por registro CRM/COREN)
                const profissionais = SistemaCore.dados.profissionais;
                const registrosVistos = new Map();
                const profissionaisParaManter = [];
                
                profissionais.forEach(prof => {
                    if (!prof.registro) {
                        profissionaisParaManter.push(prof); // Manter profissionais sem registro
                        return;
                    }
                    
                    if (registrosVistos.has(prof.registro)) {
                        // Duplicata encontrada - manter o mais recente (maior ID)
                        const existente = registrosVistos.get(prof.registro);
                        if (prof.id > existente.id) {
                            // Novo Ã© mais recente, substituir
                            const index = profissionaisParaManter.findIndex(p => p.id === existente.id);
                            profissionaisParaManter[index] = prof;
                            registrosVistos.set(prof.registro, prof);
                            profissionaisRemovidos++;
                            console.log(`ğŸ—‘ï¸ Removida duplicata: ${existente.nome} (ID ${existente.id}), mantido ${prof.nome} (ID ${prof.id})`);
                        } else {
                            // Existente Ã© mais recente, descartar novo
                            profissionaisRemovidos++;
                            console.log(`ğŸ—‘ï¸ Removida duplicata: ${prof.nome} (ID ${prof.id}), mantido ${existente.nome} (ID ${existente.id})`);
                        }
                    } else {
                        registrosVistos.set(prof.registro, prof);
                        profissionaisParaManter.push(prof);
                    }
                });
                
                // 3. ATUALIZAR DADOS E SALVAR
                if (pacientesRemovidos > 0 || profissionaisRemovidos > 0) {
                    SistemaCore.dados.pacientes = pacientesParaManter;
                    SistemaCore.dados.profissionais = profissionaisParaManter;
                    SistemaCore.salvar();
                    
                    this.notificar(`âœ… Duplicatas removidas: ${pacientesRemovidos} paciente(s), ${profissionaisRemovidos} profissional(is)!`, 'success');
                    
                    console.log('âœ… [LIMPEZA] Completa!', { 
                        pacientesRemovidos, 
                        profissionaisRemovidos,
                        pacientesRestantes: pacientesParaManter.length,
                        profissionaisRestantes: profissionaisParaManter.length
                    });
                    
                    // Recarregar listas
                    if (typeof Pacientes !== 'undefined') Pacientes.listar();
                    if (typeof Profissionais !== 'undefined') Profissionais.listar();
                } else {
                    this.notificar('â„¹ï¸ Nenhuma duplicata encontrada!', 'info');
                    console.log('â„¹ï¸ [LIMPEZA] Nenhuma duplicata para limpar');
                }
            },
            
            // v10.463: Diagnosticar pacientes
            diagnosticarPacientes() {
                const pacientes = SistemaCore.dados.pacientes || [];
                const agendamentos = SistemaCore.dados.agendamentos || [];
                const atendimentos = SistemaCore.dados.atendimentos || [];
                const entradas = SistemaCore.dados.entradas || [];
                
                // Contadores
                let total = pacientes.length;
                let completos = 0;
                let incompletos = 0;
                let naoIdentificados = 0;
                let preCadastros = 0;
                let semAgendamento = 0;
                let semAtendimento = 0;
                
                pacientes.forEach(p => {
                    const nomeUpper = (p.nome || '').toUpperCase();
                    const ehNI = nomeUpper.includes('NÃƒO IDENTIFICADO') || nomeUpper.includes('NAO IDENTIFICADO');
                    const ehPRE = (p.prontuario || '').startsWith('PRE-');
                    
                    if (ehNI) naoIdentificados++;
                    if (ehPRE) preCadastros++;
                    if (p.cadastro_completo === true) completos++;
                    if (p.cadastro_completo === false) incompletos++;
                    
                    const temAgendamento = agendamentos.some(a => a.paciente_id === p.id);
                    const temAtendimento = atendimentos.some(a => a.paciente_id === p.id);
                    const temEntrada = entradas.some(e => e.paciente_id === p.id);
                    
                    if (!temAgendamento) semAgendamento++;
                    if (!temAtendimento && !temEntrada) semAtendimento++;
                });
                
                const msg = `ğŸ“Š DIAGNÃ“STICO DE PACIENTES\n\n` +
                    `Total: ${total} pacientes\n` +
                    `âœ… Cadastro completo: ${completos}\n` +
                    `âš ï¸ Cadastro incompleto: ${incompletos}\n` +
                    `ğŸš¨ "NÃ£o Identificado": ${naoIdentificados}\n` +
                    `ğŸ“‹ PrÃ©-cadastro (PRE-): ${preCadastros}\n\n` +
                    `ğŸ“… Sem agendamento: ${semAgendamento}\n` +
                    `ğŸ©º Sem atendimento: ${semAtendimento}`;
                
                alert(msg);
                console.log(msg);
            },
            
            // v10.463: Corrigir prontuÃ¡rios PRE- para definitivo
            corrigirProntuarios() {
                const pacientes = SistemaCore.dados.pacientes || [];
                let corrigidos = 0;
                
                // Primeiro, encontrar o maior prontuÃ¡rio numÃ©rico existente
                let maiorNum = 0;
                pacientes.forEach(pac => {
                    const num = parseInt(pac.prontuario);
                    if (!isNaN(num) && num > maiorNum) maiorNum = num;
                });
                
                pacientes.forEach(p => {
                    const prontuario = p.prontuario || '';
                    const ehPRE = prontuario.startsWith('PRE-') || prontuario.startsWith('NI-') || !prontuario;
                    const nomeUpper = (p.nome || '').toUpperCase();
                    const ehNaoIdentificado = nomeUpper.includes('NÃƒO IDENTIFICADO') || nomeUpper.includes('NAO IDENTIFICADO');
                    
                    // Se tem CPF vÃ¡lido E nÃ£o Ã© "NÃ£o Identificado"
                    const cpfLimpo = (p.cpf || '').replace(/\D/g, '');
                    const temCPF = cpfLimpo.length >= 11;
                    
                    if (temCPF && !ehNaoIdentificado) {
                        let precisaCorrigir = false;
                        
                        // Corrigir prontuÃ¡rio PRE-
                        if (ehPRE) {
                            maiorNum++;
                            const novoProntuario = String(maiorNum).padStart(6, '0');
                            console.log(`ğŸ”§ Corrigindo prontuÃ¡rio: ${p.nome} | ${prontuario} â†’ ${novoProntuario}`);
                            p.prontuario = novoProntuario;
                            p.numero_prontuario = novoProntuario;
                            precisaCorrigir = true;
                        }
                        
                        // Corrigir tipo_documento se ainda Ã© provisÃ³rio
                        if (p.tipo_documento === 'provisorio' || (p.numero_documento || '').startsWith('TEMP-') || (p.numero_documento || '').startsWith('NI-')) {
                            console.log(`ğŸ”§ Corrigindo documento: ${p.nome} | ${p.tipo_documento}/${p.numero_documento} â†’ cpf/${p.cpf}`);
                            p.tipo_documento = 'cpf';
                            p.numero_documento = p.cpf;
                            p.documento_provisorio = false;
                            precisaCorrigir = true;
                        }
                        
                        if (precisaCorrigir) {
                            p.cadastro_completo = true;
                            corrigidos++;
                        }
                    }
                });
                
                if (corrigidos > 0) {
                    SistemaCore.salvar();
                    this.notificar(`âœ… ${corrigidos} paciente(s) corrigido(s)!`, 'success');
                    if (typeof Pacientes !== 'undefined') Pacientes.listar();
                } else {
                    this.notificar('â„¹ï¸ Nenhum paciente para corrigir.', 'info');
                }
            },
            
            // v10.463: Limpar "NÃ£o Identificados" sem atendimento
            limparNaoIdentificados() {
                const pacientes = SistemaCore.dados.pacientes || [];
                const atendimentos = SistemaCore.dados.atendimentos || [];
                const entradas = SistemaCore.dados.entradas || [];
                
                // Filtrar NIs sem histÃ³rico
                const nisParaRemover = pacientes.filter(p => {
                    const nomeUpper = (p.nome || '').toUpperCase();
                    const ehNI = nomeUpper.includes('NÃƒO IDENTIFICADO') || nomeUpper.includes('NAO IDENTIFICADO');
                    
                    if (!ehNI) return false;
                    
                    const temAtendimento = atendimentos.some(a => a.paciente_id === p.id);
                    const temEntrada = entradas.some(e => e.paciente_id === p.id && e.status !== 'cancelado');
                    
                    return !temAtendimento && !temEntrada;
                });
                
                if (nisParaRemover.length === 0) {
                    this.notificar('â„¹ï¸ Nenhum "NÃ£o Identificado" para remover.', 'info');
                    return;
                }
                
                if (!confirm(`âš ï¸ Remover ${nisParaRemover.length} paciente(s) "NÃ£o Identificado" sem atendimento?\n\nEsta aÃ§Ã£o nÃ£o pode ser desfeita.`)) {
                    return;
                }
                
                const idsRemover = nisParaRemover.map(p => p.id);
                SistemaCore.dados.pacientes = pacientes.filter(p => !idsRemover.includes(p.id));
                SistemaCore.salvar();
                
                this.notificar(`âœ… ${nisParaRemover.length} "NÃ£o Identificado(s)" removido(s)!`, 'success');
                if (typeof Pacientes !== 'undefined') Pacientes.listar();
            },
            
            // v10.463: Limpar prÃ©-cadastros sem agendamento
            limparPreCadastrosAntigos() {
                const pacientes = SistemaCore.dados.pacientes || [];
                const agendamentos = SistemaCore.dados.agendamentos || [];
                const atendimentos = SistemaCore.dados.atendimentos || [];
                
                // Filtrar PRE- sem agendamento ativo
                const presParaRemover = pacientes.filter(p => {
                    const prontuario = p.prontuario || '';
                    const ehPRE = prontuario.startsWith('PRE-');
                    const ehIncompleto = p.cadastro_completo === false;
                    
                    if (!ehPRE || !ehIncompleto) return false;
                    
                    const temAgendamentoAtivo = agendamentos.some(a => 
                        a.paciente_id === p.id && 
                        a.status !== 'cancelado' && 
                        a.status !== 'realizado'
                    );
                    const temAtendimento = atendimentos.some(a => a.paciente_id === p.id);
                    
                    return !temAgendamentoAtivo && !temAtendimento;
                });
                
                if (presParaRemover.length === 0) {
                    this.notificar('â„¹ï¸ Nenhum prÃ©-cadastro antigo para remover.', 'info');
                    return;
                }
                
                const lista = presParaRemover.map(p => `â€¢ ${p.nome}`).join('\n');
                if (!confirm(`âš ï¸ Remover ${presParaRemover.length} prÃ©-cadastro(s) sem agendamento?\n\n${lista}\n\nEsta aÃ§Ã£o nÃ£o pode ser desfeita.`)) {
                    return;
                }
                
                const idsRemover = presParaRemover.map(p => p.id);
                SistemaCore.dados.pacientes = pacientes.filter(p => !idsRemover.includes(p.id));
                SistemaCore.salvar();
                
                this.notificar(`âœ… ${presParaRemover.length} prÃ©-cadastro(s) removido(s)!`, 'success');
                if (typeof Pacientes !== 'undefined') Pacientes.listar();
            }
        };

        /* ============================================================
           [CADASTROS] v10.448: MÃ³dulo de Cadastros Unificado
           ============================================================ */
        
        const Cadastros = {
            abaAtual: 'estabelecimento',
            
            init() {
                // Atualizar listas ao abrir
                if (this.abaAtual === 'profissionais') {
                    Profissionais.listar();
                } else if (this.abaAtual === 'pacientes') {
                    Pacientes.listar();
                }
            },
            
            trocarAba(aba) {
                // Desativar todas as sub-abas
                const container = document.getElementById('tab-cadastros');
                container.querySelectorAll('.sub-tab-btn').forEach(tab => tab.classList.remove('active'));
                container.querySelectorAll('.sub-tab-content').forEach(content => content.classList.remove('active'));
                
                // Ativar aba selecionada
                const indice = { 'estabelecimento': 1, 'profissionais': 2, 'pacientes': 3 }[aba] || 1;
                const botoes = container.querySelectorAll('.sub-tab-btn');
                if (botoes[indice - 1]) botoes[indice - 1].classList.add('active');
                
                const conteudo = document.getElementById(`cadastros-${aba}`);
                if (conteudo) conteudo.classList.add('active');
                
                this.abaAtual = aba;
                
                // Carregar dados especÃ­ficos da aba
                if (aba === 'profissionais') {
                    Profissionais.listar();
                } else if (aba === 'pacientes') {
                    Pacientes.listar();
                } else if (aba === 'estabelecimento') {
                    Estabelecimento.carregar();
                }
            }
        };

        /* ============================================================
           [ESTABELECIMENTO] MÃ³dulo Estabelecimento
           ============================================================ */
        
        const Estabelecimento = {
            abaAtual: 'identificacao',
            
            trocarAba(aba) {
                // Desativar todas as abas
                document.querySelectorAll('.sub-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.sub-tab-content').forEach(content => content.classList.remove('active'));
                
                // Ativar aba selecionada
                document.querySelector(`.sub-tab:nth-child(${this.getIndiceAba(aba)})`).classList.add('active');
                document.getElementById(`estab-aba-${aba}`).classList.add('active');
                
                this.abaAtual = aba;
                
                // Carregar dados especÃ­ficos da aba
                if (aba === 'unidades') {
                    Reparticoes.listar();
                } else if (aba === 'pools') {
                    Pools.listar();
                }
            },
            
            getIndiceAba(aba) {
                const indices = {
                    'identificacao': 1,
                    'caracterizacao': 2,
                    'endereco': 3,
                    'contato': 4,
                    'tecnico': 5,
                    'unidades': 6,
                    'pools': 7
                };
                return indices[aba] || 1;
            },
            
            carregar() {
                const estab = SistemaCore.dados.estabelecimento || {};
                
                // ABA IDENTIFICAÃ‡ÃƒO
                document.getElementById('estab-tipo-pessoa').value = estab.tipo_pessoa || 'juridica';
                
                // Campos PJ
                document.getElementById('estab-razao-social').value = estab.razao_social || '';
                document.getElementById('estab-nome-fantasia').value = estab.nome_fantasia || '';
                document.getElementById('estab-cnpj').value = estab.cnpj || '';
                document.getElementById('estab-ie').value = estab.ie || '';
                document.getElementById('estab-im').value = estab.im || '';
                
                // Campos PF
                document.getElementById('estab-nome-completo').value = estab.nome_completo || '';
                document.getElementById('estab-nome-profissional').value = estab.nome_profissional || '';
                document.getElementById('estab-cpf').value = estab.cpf || '';
                document.getElementById('estab-rg').value = estab.rg || '';
                
                // ABA CARACTERIZAÃ‡ÃƒO
                document.getElementById('estab-tipo').value = estab.tipo || '';
                document.getElementById('estab-modal-particular').checked = estab.modalidades?.particular || false;
                document.getElementById('estab-modal-convenio').checked = estab.modalidades?.convenio || false;
                document.getElementById('estab-modal-sus').checked = estab.modalidades?.sus || false;
                document.getElementById('estab-cnes').value = estab.cnes || '';
                // v10.45: Especialidades agora usa sistema inteligente
                this.carregarEspecialidades();
                
                // ABA ENDEREÃ‡O
                document.getElementById('estab-cep').value = estab.cep || '';
                document.getElementById('estab-uf').value = estab.uf || '';
                document.getElementById('estab-logradouro').value = estab.logradouro || '';
                document.getElementById('estab-numero').value = estab.numero || '';
                document.getElementById('estab-complemento').value = estab.complemento || '';
                document.getElementById('estab-bairro').value = estab.bairro || '';
                document.getElementById('estab-cidade').value = estab.cidade || '';
                
                // ABA CONTATO
                document.getElementById('estab-telefone').value = estab.telefone || '';
                document.getElementById('estab-celular').value = estab.celular || '';
                document.getElementById('estab-email').value = estab.email || '';
                document.getElementById('estab-website').value = estab.website || '';
                
                // ABA TÃ‰CNICO & LEGAL
                document.getElementById('estab-resp-tecnico').value = estab.resp_tecnico || '';
                document.getElementById('estab-crm').value = estab.crm || '';
                document.getElementById('estab-crm-uf').value = estab.crm_uf || '';
                document.getElementById('estab-especialidade-rt').value = estab.especialidade_rt || '';
                document.getElementById('estab-observacoes').value = estab.observacoes || '';
                
                // Aplicar mÃ¡scaras
                this.aplicarMascaras();
                
                // Atualizar campos condicionais
                this.toggleTipoPessoa();
                // toggleCNES() removida - CNES sempre visÃ­vel (v10.44)
            },
            
            salvar() {
                const tipoPessoa = document.getElementById('estab-tipo-pessoa').value;
                const tipo = document.getElementById('estab-tipo').value;
                
                // VALIDAÃ‡Ã•ES BÃSICAS
                if (tipoPessoa === 'juridica') {
                    const razaoSocial = document.getElementById('estab-razao-social').value.trim();
                    const cnpj = document.getElementById('estab-cnpj').value.trim();
                    
                    if (!razaoSocial) {
                        Sistema.notificar('Preencha a RazÃ£o Social!', 'error');
                        this.trocarAba('identificacao');
                        return;
                    }
                    if (!cnpj) {
                        Sistema.notificar('CNPJ Ã© obrigatÃ³rio para Pessoa JurÃ­dica!', 'error');
                        this.trocarAba('identificacao');
                        return;
                    }
                } else {
                    const nomeCompleto = document.getElementById('estab-nome-completo').value.trim();
                    const cpf = document.getElementById('estab-cpf').value.trim();
                    
                    if (!nomeCompleto) {
                        Sistema.notificar('Preencha o Nome Completo!', 'error');
                        this.trocarAba('identificacao');
                        return;
                    }
                    if (!cpf) {
                        Sistema.notificar('CPF Ã© obrigatÃ³rio para Pessoa FÃ­sica!', 'error');
                        this.trocarAba('identificacao');
                        return;
                    }
                }
                
                if (!tipo) {
                    Sistema.notificar('Selecione o Tipo de Estabelecimento!', 'error');
                    this.trocarAba('caracterizacao');
                    return;
                }
                
                // Validar ao menos uma modalidade
                const particular = document.getElementById('estab-modal-particular').checked;
                const convenio = document.getElementById('estab-modal-convenio').checked;
                const sus = document.getElementById('estab-modal-sus').checked;
                
                if (!particular && !convenio && !sus) {
                    Sistema.notificar('Selecione ao menos uma Modalidade de Atendimento!', 'error');
                    this.trocarAba('caracterizacao');
                    return;
                }
                
                // CNES agora Ã© opcional para todos (v10.44)
                
                // Validar ResponsÃ¡vel TÃ©cnico se Hospital
                if (tipo === 'hospital' || tipo === 'hospital_dia') {
                    const respTecnico = document.getElementById('estab-resp-tecnico').value.trim();
                    if (!respTecnico) {
                        Sistema.notificar('ResponsÃ¡vel TÃ©cnico Ã© obrigatÃ³rio para Hospitais!', 'error');
                        this.trocarAba('tecnico');
                        return;
                    }
                }
                
                // SALVAR TODOS OS DADOS
                SistemaCore.dados.estabelecimento = {
                    tipo_pessoa: tipoPessoa,
                    
                    // IdentificaÃ§Ã£o PJ
                    razao_social: document.getElementById('estab-razao-social').value.trim(),
                    nome_fantasia: document.getElementById('estab-nome-fantasia').value.trim(),
                    cnpj: document.getElementById('estab-cnpj').value.trim(),
                    ie: document.getElementById('estab-ie').value.trim(),
                    im: document.getElementById('estab-im').value.trim(),
                    
                    // IdentificaÃ§Ã£o PF
                    nome_completo: document.getElementById('estab-nome-completo').value.trim(),
                    nome_profissional: document.getElementById('estab-nome-profissional').value.trim(),
                    cpf: document.getElementById('estab-cpf').value.trim(),
                    rg: document.getElementById('estab-rg').value.trim(),
                    
                    // CaracterizaÃ§Ã£o
                    tipo: tipo,
                    modalidades: {
                        particular: particular,
                        convenio: convenio,
                        sus: sus
                    },
                    cnes: document.getElementById('estab-cnes').value.trim(),
                    // v10.45: especialidadesSelecionadas gerenciado por funÃ§Ãµes especÃ­ficas (nÃ£o sobrescrever)
                    especialidadesSelecionadas: SistemaCore.dados.estabelecimento?.especialidadesSelecionadas || [],
                    // Manter pools existentes
                    especialidades: SistemaCore.dados.estabelecimento?.especialidades || [],
                    pavilhoes: SistemaCore.dados.estabelecimento?.pavilhoes || [],
                    andares: SistemaCore.dados.estabelecimento?.andares || [],
                    setores: SistemaCore.dados.estabelecimento?.setores || [],
                    categoriasProfissionais: SistemaCore.dados.estabelecimento?.categoriasProfissionais || [],
                    cargos: SistemaCore.dados.estabelecimento?.cargos || [],
                    convenios: SistemaCore.dados.estabelecimento?.convenios || [],
                    regionaisSaude: SistemaCore.dados.estabelecimento?.regionaisSaude || [],
                    // motivosAtendimento removido - agora Ã© pool clÃ­nico
                    
                    // EndereÃ§o
                    cep: document.getElementById('estab-cep').value.trim(),
                    uf: document.getElementById('estab-uf').value,
                    logradouro: document.getElementById('estab-logradouro').value.trim(),
                    numero: document.getElementById('estab-numero').value.trim(),
                    complemento: document.getElementById('estab-complemento').value.trim(),
                    bairro: document.getElementById('estab-bairro').value.trim(),
                    cidade: document.getElementById('estab-cidade').value.trim(),
                    
                    // Contato
                    telefone: document.getElementById('estab-telefone').value.trim(),
                    celular: document.getElementById('estab-celular').value.trim(),
                    email: document.getElementById('estab-email').value.trim(),
                    website: document.getElementById('estab-website').value.trim(),
                    
                    // TÃ©cnico & Legal
                    resp_tecnico: document.getElementById('estab-resp-tecnico').value.trim(),
                    crm: document.getElementById('estab-crm').value.trim(),
                    crm_uf: document.getElementById('estab-crm-uf').value,
                    especialidade_rt: document.getElementById('estab-especialidade-rt').value.trim(),
                    observacoes: document.getElementById('estab-observacoes').value.trim()
                };
                
                SistemaCore.salvar();
                
                // Atualizar nome no header
                const nomeExibir = tipoPessoa === 'juridica' 
                    ? (document.getElementById('estab-nome-fantasia').value.trim() || document.getElementById('estab-razao-social').value.trim())
                    : (document.getElementById('estab-nome-profissional').value.trim() || document.getElementById('estab-nome-completo').value.trim());
                
                if (nomeExibir) {
                    document.getElementById('nomeEstabelecimento').textContent = nomeExibir;
                }
                
                Sistema.notificar('âœ… Estabelecimento salvo com sucesso!', 'success');
            },
            
            toggleTipoPessoa() {
                const tipoPessoa = document.getElementById('estab-tipo-pessoa').value;
                const camposPJ = document.getElementById('campos-pj');
                const camposPF = document.getElementById('campos-pf');
                
                if (tipoPessoa === 'juridica') {
                    camposPJ.style.display = 'block';
                    camposPF.style.display = 'none';
                } else {
                    camposPJ.style.display = 'none';
                    camposPF.style.display = 'block';
                }
            },
            
            // toggleCNES() removida - CNES agora Ã© sempre visÃ­vel (v10.44)
            
            async buscarCEP() {
                const cep = document.getElementById('estab-cep').value.replace(/\D/g, '');
                
                if (cep.length !== 8) return;
                
                try {
                    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                    const data = await response.json();
                    
                    if (data.erro) {
                        Sistema.notificar('CEP nÃ£o encontrado!', 'error');
                        return;
                    }
                    
                    document.getElementById('estab-logradouro').value = data.logradouro || '';
                    document.getElementById('estab-bairro').value = data.bairro || '';
                    document.getElementById('estab-cidade').value = data.localidade || '';
                    document.getElementById('estab-uf').value = data.uf || '';
                    
                    Sistema.notificar('CEP encontrado!', 'success');
                } catch (error) {
                    console.error('Erro ao buscar CEP:', error);
                }
            },
            
            aplicarMascaras() {
                // MÃ¡scara CNPJ
                const cnpjInput = document.getElementById('estab-cnpj');
                if (cnpjInput && !cnpjInput.dataset.mascaraAplicada) {
                    cnpjInput.dataset.mascaraAplicada = 'true';
                    cnpjInput.addEventListener('input', function(e) {
                        let value = e.target.value.replace(/\D/g, '');
                        if (value.length <= 14) {
                            value = value.replace(/^(\d{2})(\d)/, '$1.$2');
                            value = value.replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3');
                            value = value.replace(/\.(\d{3})(\d)/, '.$1/$2');
                            value = value.replace(/(\d{4})(\d)/, '$1-$2');
                        }
                        e.target.value = value;
                    });
                }
                
                // MÃ¡scara CPF
                const cpfInput = document.getElementById('estab-cpf');
                if (cpfInput && !cpfInput.dataset.mascaraAplicada) {
                    cpfInput.dataset.mascaraAplicada = 'true';
                    cpfInput.addEventListener('input', function(e) {
                        let value = e.target.value.replace(/\D/g, '');
                        if (value.length <= 11) {
                            value = value.replace(/(\d{3})(\d)/, '$1.$2');
                            value = value.replace(/(\d{3})(\d)/, '$1.$2');
                            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                        }
                        e.target.value = value;
                    });
                }
                
                // MÃ¡scara CEP
                const cepInput = document.getElementById('estab-cep');
                if (cepInput && !cepInput.dataset.mascaraAplicada) {
                    cepInput.dataset.mascaraAplicada = 'true';
                    cepInput.addEventListener('input', function(e) {
                        let value = e.target.value.replace(/\D/g, '');
                        if (value.length <= 8) {
                            value = value.replace(/^(\d{5})(\d)/, '$1-$2');
                        }
                        e.target.value = value;
                    });
                }
                
                // MÃ¡scara Telefone
                const telefoneInput = document.getElementById('estab-telefone');
                if (telefoneInput && !telefoneInput.dataset.mascaraAplicada) {
                    telefoneInput.dataset.mascaraAplicada = 'true';
                    telefoneInput.addEventListener('input', function(e) {
                        let value = e.target.value.replace(/\D/g, '');
                        if (value.length <= 11) {
                            if (value.length <= 10) {
                                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                                value = value.replace(/(\d{4})(\d)/, '$1-$2');
                            } else {
                                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                                value = value.replace(/(\d{5})(\d)/, '$1-$2');
                            }
                        }
                        e.target.value = value;
                    });
                }
                
                // MÃ¡scara Celular
                const celularInput = document.getElementById('estab-celular');
                if (celularInput && !celularInput.dataset.mascaraAplicada) {
                    celularInput.dataset.mascaraAplicada = 'true';
                    celularInput.addEventListener('input', function(e) {
                        let value = e.target.value.replace(/\D/g, '');
                        if (value.length <= 11) {
                            if (value.length <= 10) {
                                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                                value = value.replace(/(\d{4})(\d)/, '$1-$2');
                            } else {
                                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                                value = value.replace(/(\d{5})(\d)/, '$1-$2');
                            }
                        }
                        e.target.value = value;
                    });
                }
            },

            // ============================================================
            // SISTEMA INTELIGENTE DE ESPECIALIDADES (v10.45)
            // ============================================================

            carregarEspecialidades() {
                // Carregar dropdown do pool
                this.atualizarDropdownEspecialidades();
                
                // Renderizar lista de especialidades do estabelecimento
                this.renderizarEspecialidadesEstabelecimento();
            },

            atualizarDropdownEspecialidades() {
                const select = document.getElementById('estab-especialidade-pool');
                if (!select) return;

                const poolEspecialidades = SistemaCore.dados.estabelecimento?.especialidades || [];
                const especialidadesEstab = SistemaCore.dados.estabelecimento?.especialidadesSelecionadas || [];

                // Filtrar especialidades que jÃ¡ estÃ£o no estabelecimento
                const disponiveis = poolEspecialidades.filter(esp => !especialidadesEstab.includes(esp));

                select.innerHTML = '<option value="">Selecione do pool...</option>';
                disponiveis.forEach(esp => {
                    select.innerHTML += `<option value="${esp}">${esp}</option>`;
                });
            },

            renderizarEspecialidadesEstabelecimento() {
                const container = document.getElementById('estab-especialidades-lista');
                if (!container) return;

                const especialidades = SistemaCore.dados.estabelecimento?.especialidadesSelecionadas || [];

                if (especialidades.length === 0) {
                    container.innerHTML = `
                        <small style="color: var(--text-light); font-size: 11px; display: block; text-align: center; padding: 20px;">
                            Nenhuma especialidade adicionada ainda
                        </small>
                    `;
                    return;
                }

                container.innerHTML = especialidades.map(esp => `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: white; border-radius: 4px; margin-bottom: 6px; border: 1px solid var(--border);">
                        <span style="font-size: 13px;">ğŸ©º ${esp}</span>
                        <button type="button" onclick="Estabelecimento.removerEspecialidade('${esp.replace(/'/g, "\\'")}')" 
                                style="background: none; border: none; color: var(--danger); cursor: pointer; font-size: 16px; padding: 0 4px;">
                            âŒ
                        </button>
                    </div>
                `).join('');
            },

            adicionarEspecialidadeDoPool() {
                const select = document.getElementById('estab-especialidade-pool');
                if (!select) return;

                const especialidade = select.value.trim();
                if (!especialidade) {
                    Sistema.notificar('Selecione uma especialidade!', 'error');
                    return;
                }

                // Inicializar se necessÃ¡rio
                if (!SistemaCore.dados.estabelecimento.especialidadesSelecionadas) {
                    SistemaCore.dados.estabelecimento.especialidadesSelecionadas = [];
                }

                // Adicionar se nÃ£o existir
                if (!SistemaCore.dados.estabelecimento.especialidadesSelecionadas.includes(especialidade)) {
                    SistemaCore.dados.estabelecimento.especialidadesSelecionadas.push(especialidade);
                    SistemaCore.salvar();
                    
                    this.atualizarDropdownEspecialidades();
                    this.renderizarEspecialidadesEstabelecimento();
                    
                    Sistema.notificar('âœ… Especialidade adicionada!');
                } else {
                    Sistema.notificar('Esta especialidade jÃ¡ estÃ¡ adicionada!', 'warning');
                }
            },

            removerEspecialidade(especialidade) {
                if (!confirm(`Remover "${especialidade}" das especialidades do estabelecimento?`)) return;

                const index = SistemaCore.dados.estabelecimento.especialidadesSelecionadas?.indexOf(especialidade);
                if (index > -1) {
                    SistemaCore.dados.estabelecimento.especialidadesSelecionadas.splice(index, 1);
                    SistemaCore.salvar();
                    
                    this.atualizarDropdownEspecialidades();
                    this.renderizarEspecialidadesEstabelecimento();
                    
                    Sistema.notificar('âœ… Especialidade removida!');
                }
            },

            // v10.52: FunÃ§Ã£o removida - especialidades agora sÃ£o gerenciadas apenas em GestÃ£o â†’ Pools
        };

        /* ============================================================
           [CONFIGURAÃ‡Ã•ES] MÃ³dulo de ConfiguraÃ§Ãµes (Mapa, Pools, Escalas)
           ============================================================ */
        
        const Gestao = {
            abaAtual: 'mapa',
            
            trocarAba(aba) {
                // Desativar todas as sub-abas de GestÃ£o
                const container = document.querySelector('#tab-gestao');
                if (!container) return;
                
                container.querySelectorAll('.sub-tab').forEach(tab => tab.classList.remove('active'));
                container.querySelectorAll('.sub-tab-content').forEach(content => content.classList.remove('active'));
                
                // Ativar aba selecionada
                const botaoAba = Array.from(container.querySelectorAll('.sub-tab')).find(btn => 
                    btn.textContent.toLowerCase().includes(this.getNomeAba(aba).toLowerCase())
                );
                if (botaoAba) botaoAba.classList.add('active');
                
                const conteudoAba = document.getElementById(`gestao-aba-${aba}`);
                if (conteudoAba) conteudoAba.classList.add('active');
                
                this.abaAtual = aba;
                
                // Carregar dados especÃ­ficos da aba
                if (aba === 'mapa') {
                    Reparticoes.listar();
                } else if (aba === 'pools') {
                    Pools.listar();
                } else if (aba === 'escalas') {
                    Escalas.listar();
                } else if (aba === 'configuracoes') {
                    Gestao.carregarConfiguracoes();
                } else if (aba === 'templates') {
                    Gestao.carregarConfigFolhaRosto();
                } else if (aba === 'protocolos') {
                    Manchester.init(); // Manchester estÃ¡ dentro de Protocolos agora
                } else if (aba === 'editor-atlas') {
                    EditorAtlas.inicializar();
                }
            },
            
            getNomeAba(aba) {
                const nomes = {
                    'mapa': 'Mapa das Unidades',
                    'pools': 'Pools',
                    'especialidades': 'Especialidades',
                    'configuracoes': 'CustomizaÃ§Ã£o Documental',
                    'protocolos': 'Protocolos de Atendimento',
                    'escalas': 'Escalas de Profissionais',
                    'financeiro': 'Financeiro Geral',
                    'estoque': 'Estoque Geral',
                    'permissoes': 'PermissÃµes de Sistema',
                    'editor-atlas': 'Editor de Atlas'
                };
                return nomes[aba] || 'Mapa das Unidades';
            },
            
            // ========== FUNÃ‡Ã•ES DE CONFIGURAÃ‡ÃƒO (v10.9.0) ==========
            
            aplicarMascaraCNPJ(input) {
                let valor = input.value.replace(/\D/g, '');
                if (valor.length <= 14) {
                    valor = valor.replace(/^(\d{2})(\d)/, '$1.$2');
                    valor = valor.replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3');
                    valor = valor.replace(/\.(\d{3})(\d)/, '.$1/$2');
                    valor = valor.replace(/(\d{4})(\d)/, '$1-$2');
                }
                input.value = valor;
            },
            
            uploadLogo(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                // Validar tipo de arquivo
                if (!file.type.match('image/png') && !file.type.match('image/jpeg') && !file.type.match('image/jpg')) {
                    Sistema.notificar('âŒ Por favor, selecione uma imagem PNG ou JPG', 'erro');
                    return;
                }
                
                // Validar tamanho (max 2MB)
                if (file.size > 2 * 1024 * 1024) {
                    Sistema.notificar('âŒ A imagem deve ter no mÃ¡ximo 2MB', 'erro');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const logoBase64 = e.target.result;
                    
                    // Salvar no localStorage
                    if (!SistemaCore.dados.configuracao) {
                        SistemaCore.dados.configuracao = {};
                    }
                    SistemaCore.dados.configuracao.logo = logoBase64;
                    SistemaCore.salvar();
                    
                    // Atualizar preview IMEDIATAMENTE
                    this.atualizarPreviewLogo(logoBase64);
                    
                    Sistema.notificar('âœ… Logo carregada com sucesso!', 'sucesso');
                };
                reader.readAsDataURL(file);
            },
            
            atualizarPreviewLogo(logoBase64) {
                const preview = document.getElementById('logo-preview');
                const btnRemover = document.getElementById('btn-remover-logo');
                
                if (!preview) return;
                
                if (logoBase64) {
                    preview.innerHTML = `<img src="${logoBase64}" alt="Logo" style="max-width: 100%; max-height: 150px; object-fit: contain;">`;
                    if (btnRemover) btnRemover.style.display = 'block';
                } else {
                    preview.innerHTML = `
                        <div style="font-size: 48px; margin-bottom: 10px;">ğŸ¥</div>
                        <div>Nenhuma logo carregada</div>
                    `;
                    if (btnRemover) btnRemover.style.display = 'none';
                }
            },
            
            removerLogo() {
                if (!confirm('Tem certeza que deseja remover a logo?')) return;
                
                if (!SistemaCore.dados.configuracao) {
                    SistemaCore.dados.configuracao = {};
                }
                SistemaCore.dados.configuracao.logo = null;
                SistemaCore.salvar();
                
                // Atualizar preview IMEDIATAMENTE
                this.atualizarPreviewLogo(null);
                
                const inputLogo = document.getElementById('input-logo');
                if (inputLogo) inputLogo.value = '';
                
                Sistema.notificar('âœ… Logo removida com sucesso!', 'sucesso');
            },
            
            salvarConfiguracoes() {
                const config = {
                    logo: SistemaCore.dados.configuracao?.logo || null,
                    hospital: {
                        nome: document.getElementById('config-nome-hospital').value,
                        cnpj: document.getElementById('config-cnpj-hospital').value,
                        endereco: document.getElementById('config-endereco-hospital').value,
                        cep: document.getElementById('config-cep-hospital').value,
                        telefone: document.getElementById('config-telefone-hospital').value,
                        email: document.getElementById('config-email-hospital').value
                    },
                    templates: {
                        folha_rosto: {
                            incluir_qr_code: document.getElementById('config-qr-code').checked,
                            incluir_codigo_barras: document.getElementById('config-codigo-barras').checked,
                            layout: document.getElementById('config-layout-folha').value
                        }
                    }
                };
                
                SistemaCore.dados.configuracao = config;
                SistemaCore.salvar();
                
                Sistema.notificar('âœ… ConfiguraÃ§Ãµes salvas com sucesso!');
            },
            
            carregarConfiguracoes() {
                // v10.130: Inicializar mÃ³dulo de modelos de atendimento
                if (typeof ModelosAtendimento !== 'undefined') {
                    ModelosAtendimento.init();
                }
                
                // v10.130: Inicializar sandbox
                if (typeof Sandbox !== 'undefined') {
                    Sandbox.init();
                }
                
                // Se ainda nÃ£o verificou campos, sair
                const campoNome = document.getElementById('config-nome-hospital');
                if (!campoNome) return;
                
                const config = SistemaCore.dados.configuracao;
                const estabelecimento = SistemaCore.dados.estabelecimento;
                
                // Carregar logo
                if (config?.logo) {
                    this.atualizarPreviewLogo(config.logo);
                }
                
                // Carregar dados do hospital
                // PRIORIDADE: config salva > dados do estabelecimento > vazio
                if (config?.hospital) {
                    // Se jÃ¡ tem config salva, usar ela
                    document.getElementById('config-nome-hospital').value = config.hospital.nome || '';
                    document.getElementById('config-cnpj-hospital').value = config.hospital.cnpj || '';
                    document.getElementById('config-endereco-hospital').value = config.hospital.endereco || '';
                    document.getElementById('config-cep-hospital').value = config.hospital.cep || '';
                    document.getElementById('config-telefone-hospital').value = config.hospital.telefone || '';
                    document.getElementById('config-email-hospital').value = config.hospital.email || '';
                } else if (estabelecimento) {
                    // Se nÃ£o tem config, puxar do estabelecimento
                    document.getElementById('config-nome-hospital').value = estabelecimento.nome || '';
                    document.getElementById('config-cnpj-hospital').value = estabelecimento.cnpj || '';
                    
                    // Montar endereÃ§o completo
                    let enderecoCompleto = '';
                    if (estabelecimento.logradouro) enderecoCompleto += estabelecimento.logradouro;
                    if (estabelecimento.numero) enderecoCompleto += ', ' + estabelecimento.numero;
                    if (estabelecimento.complemento) enderecoCompleto += ' - ' + estabelecimento.complemento;
                    if (estabelecimento.bairro) enderecoCompleto += ', ' + estabelecimento.bairro;
                    if (estabelecimento.cidade && estabelecimento.estado) enderecoCompleto += ', ' + estabelecimento.cidade + ' - ' + estabelecimento.estado;
                    
                    document.getElementById('config-endereco-hospital').value = enderecoCompleto;
                    document.getElementById('config-cep-hospital').value = estabelecimento.cep || '';
                    document.getElementById('config-telefone-hospital').value = estabelecimento.telefone || '';
                    document.getElementById('config-email-hospital').value = estabelecimento.email || '';
                }
                
                // Carregar configuraÃ§Ãµes da folha de rosto
                if (config?.templates?.folha_rosto) {
                    document.getElementById('config-qr-code').checked = config.templates.folha_rosto.incluir_qr_code ?? true;
                    document.getElementById('config-codigo-barras').checked = config.templates.folha_rosto.incluir_codigo_barras ?? true;
                    document.getElementById('config-layout-folha').value = config.templates.folha_rosto.layout || 'padrao';
                }
            },
            
            previewFolhaRosto() {
                const config = SistemaCore.dados.configuracao;
                const hospital = config?.hospital || SistemaCore.dados.estabelecimento || {};
                
                let preview = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    PREVIEW - FOLHA DE ROSTO                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

${config?.logo ? '[LOGO DO HOSPITAL]' : '[SEM LOGO]'}

${hospital.nome || 'HOSPITAL NÃƒO CONFIGURADO'}
${hospital.endereco || ''}
Tel: ${hospital.telefone || 'NÃ£o informado'} | Email: ${hospital.email || 'NÃ£o informado'}
CNPJ: ${hospital.cnpj || 'NÃ£o informado'}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    FOLHA DE ROSTO - EMERGÃŠNCIA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ REGISTRO: 20251106000001
${config?.templates?.folha_rosto?.incluir_codigo_barras !== false ? 'â–â–ˆâ–Œâ–â–ˆâ–Œâ–â–ˆâ–Œ [CÃ“DIGO DE BARRAS]' : ''}

ğŸ†” PRONTUÃRIO: 000001
${config?.templates?.folha_rosto?.incluir_qr_code !== false ? 'â–â–ˆâ–Œâ–â–ˆâ–Œ [QR CODE]\nâ–â–ˆâ–Œâ–â–ˆâ–Œ' : ''}

ğŸš¨ CLASSIFICAÃ‡ÃƒO MANCHESTER: ğŸ”´ VERMELHO
   Fluxograma: Dor TorÃ¡cica
   Discriminador: Dor cardÃ­aca severa
   Tempo mÃ¡ximo: IMEDIATO

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
IDENTIFICAÃ‡ÃƒO DO PACIENTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Nome: JOÃƒO SILVA SANTOS (exemplo)
Data Nascimento: 01/01/1970 (55 anos)
Sexo: Masculino | Cor/RaÃ§a: Branco
CPF: 123.456.789-00
CNS: 706 4011 6925 5582

EndereÃ§o: Rua das Flores, 123
          Bairro Centro - Belo Horizonte/MG
          CEP: 30000-000

Telefone: (31) 99999-9999
ConvÃªnio: SUS

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
DADOS DA ENTRADA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Data/Hora Entrada: 06/11/2025 Ã s 15:30
Local: EmergÃªncia
Tipo: UrgÃªncia
Meio de Chegada: AmbulÃ¢ncia

Queixa Principal:
Dor no peito hÃ¡ 30 minutos, em aperto,
irradiando para braÃ§o esquerdo

Acompanhante: Ana Silva (esposa)
Tel: (31) 99999-9999

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ClassificaÃ§Ã£o realizada por: Enf. Maria Silva
Data/Hora: 06/11/2025 Ã s 15:32
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Layout: ${config?.templates?.folha_rosto?.layout || 'PadrÃ£o'}
QR Code: ${config?.templates?.folha_rosto?.incluir_qr_code !== false ? 'SIM' : 'NÃƒO'}
CÃ³digo de Barras: ${config?.templates?.folha_rosto?.incluir_codigo_barras !== false ? 'SIM' : 'NÃƒO'}
`;
                
                alert(preview);
            },
            
            // ========== CUSTOMIZAÃ‡ÃƒO DA FOLHA DE ROSTO (v10.10.4) ==========
            
            atualizarPreviewFolha() {
                // Pegar estados dos checkboxes
                const mostrarCabecalho = document.getElementById('folha-mostrar-cabecalho')?.checked ?? true;
                const mostrarIdentificacao = document.getElementById('folha-mostrar-identificacao')?.checked ?? true;
                const mostrarEndereco = document.getElementById('folha-mostrar-endereco')?.checked ?? true;
                const mostrarContato = document.getElementById('folha-mostrar-contato')?.checked ?? true;
                const mostrarDadosAdicionais = document.getElementById('folha-mostrar-dados-adicionais')?.checked ?? true;
                const mostrarAtendimento = document.getElementById('folha-mostrar-atendimento')?.checked ?? true;
                const mostrarManchester = document.getElementById('folha-mostrar-manchester')?.checked ?? true;
                
                // Pegar dados do estabelecimento
                const estabelecimento = SistemaCore.dados.estabelecimento || {};
                const config = SistemaCore.dados.configuracao || {};
                
                // Estilo de tabela base
                const estiloTabela = 'border-collapse: collapse; width: 100%; border: 1px solid #000;';
                const estiloCelula = 'border: 1px solid #000; padding: 4px 6px; font-size: 10px;';
                const estiloLabel = 'font-weight: bold; background: #f0f0f0;';
                const estiloTitulo = 'background: #666; color: white; font-weight: bold; text-align: center; padding: 6px;';
                
                let html = '';
                
                // ===== CABEÃ‡ALHO =====
                if (mostrarCabecalho) {
                    html += `
                        <table style="${estiloTabela} margin-bottom: 8px;">
                            <tr>
                                <td style="${estiloCelula} width: 160px; text-align: center; padding: 8px;" rowspan="2">
                                    ${config.logo ? 
                                        `<img src="${config.logo}" style="max-width: 140px; max-height: 50px;">` :
                                        `<div style="font-size: 32px;">ğŸ¥</div><div style="font-size: 9px; color: #666;">[Logo]</div>`
                                    }
                                </td>
                                <td style="${estiloCelula} ${estiloLabel} text-align: center; font-size: 11px;">
                                    ${estabelecimento.razao_social || 'RazÃ£o Social do Estabelecimento'}
                                </td>
                                <td style="${estiloCelula} width: 180px;">
                                    <div style="font-size: 10px; font-weight: bold;">${estabelecimento.nome_fantasia || 'Nome Fantasia'}</div>
                                </td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} text-align: center; font-size: 10px;" colspan="2">
                                    <strong>PRONTUÃRIO:</strong> [NÂº ProntuÃ¡rio]
                                </td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} ${estiloTitulo}" colspan="3">FOLHA DE ROSTO DE PRONTUÃRIO</td>
                            </tr>
                        </table>
                    `;
                }
                
                // ===== IDENTIFICAÃ‡ÃƒO DO PACIENTE =====
                if (mostrarIdentificacao) {
                    html += `
                        <table style="${estiloTabela} margin-bottom: 8px;">
                            <tr>
                                <td style="${estiloCelula} ${estiloTitulo}" colspan="4">IDENTIFICAÃ‡ÃƒO DO PACIENTE</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} ${estiloLabel}" colspan="4">USUÃRIO: JOSE ORLANDO BARBOSA</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="4">
                                    <strong>NOME CIVIL:</strong> JOSE ORLANDO BARBOSA
                                </td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} width: 30%;"><strong>DATA DE NASCIMENTO:</strong> 18/07/1961</td>
                                <td style="${estiloCelula} width: 30%;"><strong>CNS:</strong> 706401169255582</td>
                                <td style="${estiloCelula} width: 40%;" colspan="2"><strong>IDADE:</strong> 64 ano(s)</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}"><strong>SEXO:</strong> MASCULINO</td>
                                <td style="${estiloCelula}" colspan="3"><strong>ESTADO CIVIL:</strong> Casado</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}"><strong>COR/RAÃ‡A:</strong> Parda</td>
                                <td style="${estiloCelula}" colspan="3"></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}"><strong>TIPO DOCUMENTO:</strong> Carteira de Identidade</td>
                                <td style="${estiloCelula}" colspan="3"><strong>NÃšMERO DOCUMENTO:</strong> 016733</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}"><strong>NATURALIDADE:</strong> ABAETE</td>
                                <td style="${estiloCelula}" colspan="3"></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="4"><strong>NOME DA MÃƒE:</strong> CONCEICAO DE SOUSA LIMA</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="4"><strong>NOME DO PAI:</strong> VALDEMAR VICENTE BARBOSA</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="4"><strong>PROFISSÃƒO / OCUPAÃ‡ÃƒO:</strong></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="4"><strong>SITUAÃ‡ÃƒO / VÃNCULO:</strong></td>
                            </tr>
                        </table>
                    `;
                }
                
                // ===== ENDEREÃ‡O DO PACIENTE =====
                if (mostrarEndereco) {
                    html += `
                        <table style="${estiloTabela} margin-bottom: 8px;">
                            <tr>
                                <td style="${estiloCelula} ${estiloTitulo}" colspan="4">ENDEREÃ‡O DO PACIENTE</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} width: 25%;"><strong>CEP:</strong> 35620000</td>
                                <td style="${estiloCelula} width: 25%;"><strong>ESTADO:</strong> MG</td>
                                <td style="${estiloCelula}" colspan="2"></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}"><strong>MUNICÃPIO:</strong> AbaetÃ©</td>
                                <td style="${estiloCelula}" colspan="3"></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}"><strong>BAIRRO:</strong> SAO JOAO</td>
                                <td style="${estiloCelula}" colspan="3"></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="4"><strong>REGIONAL:</strong></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}"><strong>TIPO LOGRADOURO:</strong> Rua</td>
                                <td style="${estiloCelula}" colspan="3"></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="4"><strong>LOGRADOURO:</strong> FRANCISCO CAMPOS</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} width: 25%;"><strong>NÃšMERO:</strong> 510</td>
                                <td style="${estiloCelula}" colspan="3"><strong>COMPLEMENTO:</strong></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="4">
                                    <div style="font-size: 9px;">ESTRANGEIRO / SEM ENDEREÃ‡O FIXO FORMAL</div>
                                </td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}"><strong>PAÃS:</strong></td>
                                <td style="${estiloCelula}" colspan="3"><strong>MUNICÃPIO:</strong></td>
                            </tr>
                        </table>
                    `;
                }
                
                // ===== CONTATO DO PACIENTE =====
                if (mostrarContato) {
                    html += `
                        <table style="${estiloTabela} margin-bottom: 8px;">
                            <tr>
                                <td style="${estiloCelula}" colspan="4"><strong>DADOS ADICIONAIS:</strong></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} ${estiloTitulo}" colspan="4">CONTATO DO PACIENTE</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} ${estiloLabel} width: 25%;">TIPO TELEFONE</td>
                                <td style="${estiloCelula} ${estiloLabel} width: 25%;">NÃšMERO</td>
                                <td style="${estiloCelula} ${estiloLabel} width: 25%;">TIPO CONTATO</td>
                                <td style="${estiloCelula} ${estiloLabel} width: 25%;">COMENTÃRIO CONTATO INDIRETO</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}">Celular</td>
                                <td style="${estiloCelula}">(37) 99958-6885</td>
                                <td style="${estiloCelula}">DIRETO</td>
                                <td style="${estiloCelula}"></td>
                            </tr>
                        </table>
                    `;
                }
                
                // ===== DADOS DO ATENDIMENTO =====
                if (mostrarAtendimento) {
                    html += `
                        <table style="${estiloTabela} margin-bottom: 8px;">
                            <tr>
                                <td style="${estiloCelula} ${estiloTitulo}" colspan="4">DADOS DO ATENDIMENTO</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="4" style="font-size: 8px;">
                                    A identificaÃ§Ã£o, o endereÃ§o e o contato do paciente sÃ£o os informados no registro inicial do paciente
                                </td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} ${estiloLabel} width: 25%;">NÃšMERO DO REGISTRO</td>
                                <td style="${estiloCelula} ${estiloLabel} width: 25%;">DATA/HORA ADMISSÃƒO</td>
                                <td style="${estiloCelula} ${estiloLabel} width: 25%;">LOCAL DA ADMISSÃƒO</td>
                                <td style="${estiloCelula} ${estiloLabel} width: 25%;">NÃšMERO DA SENHA</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}">202511D000257</td>
                                <td style="${estiloCelula}">03/11/2025 / 19:32</td>
                                <td style="${estiloCelula}">PRONTO SOCORRO</td>
                                <td style="${estiloCelula}"></td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula} ${estiloLabel}" colspan="2">MOTIVO DO ATENDIMENTO</td>
                                <td style="${estiloCelula} ${estiloLabel}">NOME DO ACOMPANHANTE</td>
                                <td style="${estiloCelula} ${estiloLabel}">TELEFONE DO ACOMPANHANTE</td>
                            </tr>
                            <tr>
                                <td style="${estiloCelula}" colspan="2">ACIDENTE C/ CÃƒO</td>
                                <td style="${estiloCelula}">JONATHAN CESAR BARBOSA - FILHO</td>
                                <td style="${estiloCelula}"></td>
                            </tr>
                        </table>
                    `;
                }
                
                // ===== MANCHESTER (SE HABILITADO) =====
                if (mostrarManchester) {
                    html += `
                        <div style="margin-top: 12px; padding: 12px; background: #f9fafb; border: 2px solid #ffc107; border-radius: 6px;">
                            <h4 style="margin: 0 0 8px 0; color: #856404; font-size: 12px;">ğŸš¨ CLASSIFICAÃ‡ÃƒO DE MANCHESTER (EmergÃªncias)</h4>
                            <table style="${estiloTabela} background: white;">
                                <tr>
                                    <td style="${estiloCelula} width: 50%;"><strong>Fluxograma:</strong> Dor TorÃ¡cica</td>
                                    <td style="${estiloCelula} width: 50%;"><strong>Discriminador:</strong> Dor cardÃ­aca moderada</td>
                                </tr>
                                <tr>
                                    <td style="${estiloCelula} text-align: center;" colspan="2">
                                        <div style="display: inline-block; background: #f97316; color: white; padding: 8px 16px; border-radius: 6px; font-weight: bold;">
                                            ğŸŸ  LARANJA - Muito Urgente (10 min)
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    `;
                }
                
                // Atualizar preview
                const previewContainer = document.getElementById('preview-folha-rosto');
                if (previewContainer) {
                    previewContainer.innerHTML = html;
                }
            },
            
            salvarConfigFolhaRosto() {
                // Pegar estados dos checkboxes das SEÃ‡Ã•ES
                const config = {
                    mostrarCabecalho: document.getElementById('folha-mostrar-cabecalho')?.checked ?? true,
                    mostrarIdentificacao: document.getElementById('folha-mostrar-identificacao')?.checked ?? true,
                    mostrarEndereco: document.getElementById('folha-mostrar-endereco')?.checked ?? true,
                    mostrarContato: document.getElementById('folha-mostrar-contato')?.checked ?? true,
                    mostrarDadosAdicionais: document.getElementById('folha-mostrar-dados-adicionais')?.checked ?? true,
                    mostrarAtendimento: document.getElementById('folha-mostrar-atendimento')?.checked ?? true,
                    mostrarManchester: document.getElementById('folha-mostrar-manchester')?.checked ?? true
                };
                
                // Salvar no localStorage
                if (!SistemaCore.dados.configuracao) {
                    SistemaCore.dados.configuracao = {};
                }
                if (!SistemaCore.dados.configuracao.folhaRosto) {
                    SistemaCore.dados.configuracao.folhaRosto = {};
                }
                
                SistemaCore.dados.configuracao.folhaRosto = config;
                SistemaCore.salvar();
                
                Sistema.notificar('âœ… ConfiguraÃ§Ã£o da Folha de Rosto salva com sucesso!', 'sucesso');
            },
            
            carregarConfigFolhaRosto() {
                const config = SistemaCore.dados.configuracao?.folhaRosto;
                
                if (config) {
                    // Aplicar configuraÃ§Ãµes salvas
                    if (document.getElementById('folha-mostrar-cabecalho')) {
                        document.getElementById('folha-mostrar-cabecalho').checked = config.mostrarCabecalho ?? true;
                    }
                    if (document.getElementById('folha-mostrar-identificacao')) {
                        document.getElementById('folha-mostrar-identificacao').checked = config.mostrarIdentificacao ?? true;
                    }
                    if (document.getElementById('folha-mostrar-endereco')) {
                        document.getElementById('folha-mostrar-endereco').checked = config.mostrarEndereco ?? true;
                    }
                    if (document.getElementById('folha-mostrar-contato')) {
                        document.getElementById('folha-mostrar-contato').checked = config.mostrarContato ?? true;
                    }
                    if (document.getElementById('folha-mostrar-dados-adicionais')) {
                        document.getElementById('folha-mostrar-dados-adicionais').checked = config.mostrarDadosAdicionais ?? true;
                    }
                    if (document.getElementById('folha-mostrar-atendimento')) {
                        document.getElementById('folha-mostrar-atendimento').checked = config.mostrarAtendimento ?? true;
                    }
                    if (document.getElementById('folha-mostrar-manchester')) {
                        document.getElementById('folha-mostrar-manchester').checked = config.mostrarManchester ?? true;
                    }
                }
                
                // Gerar preview inicial
                this.atualizarPreviewFolha();
            }
        };

        /* ============================================================
           [EDITOR DE ATLAS] Editor Visual para Ajustes Finos - v10.285
           ============================================================ */
        
        const EditorAtlas = {
            atlasAtual: null,
            tipoAtlas: 'anatomico',
            regiaoAtual: null,
            pontosOriginais: null,
            pontoSelecionado: null,
            arrastandoPonto: false,
            
            // Zoom e Pan
            zoomLevel: 1,
            panX: 0,
            panY: 0,
            isPanning: false,
            panStartX: 0,
            panStartY: 0,
            viewBoxOriginal: { x: 0, y: 290, width: 700, height: 620 },
            
            getAtlas() {
                switch(this.tipoAtlas) {
                    case 'queimados': return ATLAS_QUEIMADOS;
                    case 'lundBrowder': return ATLAS_LUND_BROWDER;
                    default: return ATLAS_ANATOMICO;
                }
            },
            
            trocarAtlas() {
                const select = document.getElementById('editor-atlas-tipo');
                if (!select) {
                    console.warn('âš ï¸ Select de tipo de atlas nÃ£o encontrado!');
                    return;
                }
                
                this.tipoAtlas = select.value;
                // âœ… CRÃTICO: Fazer deepCopy para nÃ£o modificar atlas global diretamente!
                this.atlasAtual = deepCopyAtlas(this.getAtlas());
                
                console.log(`ğŸ”„ Trocando para atlas: ${this.tipoAtlas}`, {
                    atlas: this.atlasAtual?.descricao,
                    regioes: this.atlasAtual?.regioes?.length,
                    imagemBase64: !!this.atlasAtual?.imagemBase64
                });
                
                // Limpar seleÃ§Ã£o atual
                this.limparEditor();
                
                // Atualizar select de regiÃµes
                this.preencherSelectRegioes();
                
                // Atualizar imagem
                this.atualizarImagem();
                
                Sistema.notificar(`Atlas alterado: ${select.options[select.selectedIndex].text}`, 'info');
            },
            
            inicializar() {
                console.log('ğŸ¨ Inicializando Editor de Atlas...');
                this.tipoAtlas = 'anatomico';
                // âœ… CRÃTICO: Fazer deepCopy para nÃ£o modificar atlas global diretamente!
                this.atlasAtual = deepCopyAtlas(this.getAtlas());
                
                console.log(`ğŸ“– Atlas inicial:`, {
                    tipo: this.tipoAtlas,
                    atlas: this.atlasAtual?.descricao,
                    regioes: this.atlasAtual?.regioes?.length,
                    imagemBase64: !!this.atlasAtual?.imagemBase64
                });
                
                this.preencherSelectRegioes();
                this.atualizarImagem();
                
                // Configurar pan (arrastar canvas)
                this.configurarPan();
                
                // Resetar zoom inicial
                this.resetZoom();
                
                console.log('âœ… Editor de Atlas inicializado!');
            },
            
            preencherSelectRegioes() {
                const select = document.getElementById('editor-atlas-regiao');
                if (!select || !this.atlasAtual || !this.atlasAtual.regioes) {
                    console.warn('âš ï¸ NÃ£o foi possÃ­vel preencher select:', {
                        select: !!select,
                        atlasAtual: !!this.atlasAtual,
                        regioes: this.atlasAtual?.regioes?.length
                    });
                    return;
                }
                
                console.log(`ğŸ“‹ Preenchendo select com ${this.atlasAtual.regioes.length} regiÃµes do tipo: ${this.tipoAtlas}`);
                
                // Limpar opÃ§Ãµes antigas
                select.innerHTML = '<option value="">-- Escolha uma regiÃ£o --</option>';
                
                // Adicionar opÃ§Ãµes agrupadas
                const grupos = {};
                this.atlasAtual.regioes.forEach((regiao, index) => {
                    const grupo = regiao.grupo || 'Outros';
                    if (!grupos[grupo]) grupos[grupo] = [];
                    grupos[grupo].push({index, regiao});
                });
                
                console.log(`ğŸ“ Grupos encontrados:`, Object.keys(grupos));
                
                // Criar optgroups
                Object.keys(grupos).sort().forEach(grupo => {
                    const optgroup = document.createElement('optgroup');
                    optgroup.label = grupo;
                    
                    grupos[grupo].forEach(({index, regiao}) => {
                        const option = document.createElement('option');
                        option.value = index;
                        
                        // Texto com informaÃ§Ã£o adicional
                        let texto = regiao.nome;
                        if (regiao.vista) texto += ` (${regiao.vista})`;
                        if (regiao.percentual) texto += ` - ${regiao.percentual}%`;
                        
                        option.textContent = texto;
                        optgroup.appendChild(option);
                    });
                    
                    select.appendChild(optgroup);
                });
                
                console.log(`âœ… Select preenchido com sucesso!`);
            },
            
            atualizarImagem() {
                const imgSilhueta = document.getElementById('editor-atlas-silhueta');
                if (!imgSilhueta || !this.atlasAtual) {
                    console.warn('âš ï¸ NÃ£o foi possÃ­vel atualizar imagem:', {
                        imgSilhueta: !!imgSilhueta,
                        atlasAtual: !!this.atlasAtual
                    });
                    return;
                }
                
                if (this.atlasAtual.imagemBase64) {
                    imgSilhueta.setAttribute('href', this.atlasAtual.imagemBase64);
                    console.log('ğŸ–¼ï¸ Imagem da silhueta atualizada!');
                } else {
                    console.warn('âš ï¸ Atlas nÃ£o tem imagemBase64!');
                }
            },
            
            carregarRegiao() {
                const select = document.getElementById('editor-atlas-regiao');
                if (!select) return;
                
                const index = parseInt(select.value);
                if (isNaN(index) || !this.atlasAtual.regioes[index]) {
                    this.limparEditor();
                    return;
                }
                
                this.regiaoAtual = this.atlasAtual.regioes[index];
                this.pontosOriginais = this.regiaoAtual.points || this.regiaoAtual.path;
                
                // Desenhar polÃ­gono e pontos
                this.desenharPoligono();
                this.desenharPontos();
                this.atualizarCoordenadas();
            },
            
            desenharPoligono() {
                const group = document.getElementById('editor-atlas-poligono-group');
                if (!group || !this.regiaoAtual) return;
                
                group.innerHTML = '';
                
                const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                
                // Usar points se disponÃ­vel, senÃ£o extrair do path
                let points = this.regiaoAtual.points;
                if (!points && this.regiaoAtual.path) {
                    points = this.pathToPoints(this.regiaoAtual.path);
                }
                
                polygon.setAttribute('points', points);
                polygon.setAttribute('fill', this.regiaoAtual.cor || '#C0392B');
                polygon.setAttribute('fill-opacity', '0.3');
                polygon.setAttribute('stroke', this.regiaoAtual.cor || '#C0392B');
                polygon.setAttribute('stroke-width', '2');
                
                group.appendChild(polygon);
            },
            
            pathToPoints(path) {
                // Converter path SVG para points
                // Path formato: "M x y L x y L x y Z" (coordenadas separadas por espaÃ§o)
                // Points formato: "x,y x,y x,y" (coordenadas com vÃ­rgula)
                
                console.log('ğŸ”„ Convertendo path para points...');
                console.log('Path original:', path.substring(0, 100) + '...');
                
                // Remover comandos (M, L, Z) e pegar sÃ³ os nÃºmeros
                const numerosSemComandos = path.replace(/[MLHVCSQTAZ]/gi, ' ');
                
                // Extrair todos os nÃºmeros (incluindo decimais e negativos)
                const numeros = numerosSemComandos.match(/-?[\d.]+/g);
                
                if (!numeros || numeros.length < 2) {
                    console.warn('âš ï¸ Path invÃ¡lido ou sem coordenadas:', path);
                    return '';
                }
                
                console.log(`ğŸ“Š Encontrados ${numeros.length} nÃºmeros`);
                
                // Agrupar em pares (x,y)
                const pontos = [];
                for (let i = 0; i < numeros.length - 1; i += 2) {
                    const x = parseFloat(numeros[i]);
                    const y = parseFloat(numeros[i + 1]);
                    if (!isNaN(x) && !isNaN(y)) {
                        pontos.push(`${x},${y}`);
                    }
                }
                
                const resultado = pontos.join(' ');
                console.log(`âœ… Convertido para ${pontos.length} pontos`);
                console.log('Primeiros 3 pontos:', pontos.slice(0, 3));
                
                return resultado;
            },
            
            desenharPontos() {
                const group = document.getElementById('editor-atlas-pontos-group');
                if (!group || !this.regiaoAtual) return;
                
                group.innerHTML = '';
                
                let points = this.regiaoAtual.points;
                if (!points && this.regiaoAtual.path) {
                    points = this.pathToPoints(this.regiaoAtual.path);
                }
                
                const pontosArray = points.split(' ');
                
                console.log(`ğŸ¨ Desenhando ${pontosArray.length} pontos...`);
                
                pontosArray.forEach((ponto, index) => {
                    // Validar se o ponto tem formato correto
                    if (!ponto || !ponto.includes(',')) {
                        console.warn(`âš ï¸ Ponto ${index} invÃ¡lido:`, ponto);
                        return;
                    }
                    
                    const [x, y] = ponto.split(',').map(Number);
                    
                    // Validar se x e y sÃ£o nÃºmeros vÃ¡lidos
                    if (isNaN(x) || isNaN(y)) {
                        console.warn(`âš ï¸ Coordenadas invÃ¡lidas no ponto ${index}:`, { x, y, ponto });
                        return;
                    }
                    
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', x);
                    circle.setAttribute('cy', y);
                    circle.setAttribute('r', '3');
                    circle.setAttribute('fill', '#ef4444');
                    circle.setAttribute('stroke', 'white');
                    circle.setAttribute('stroke-width', '1.5');
                    circle.setAttribute('cursor', 'move');
                    circle.setAttribute('data-index', index);
                    
                    // Adicionar eventos de arrastar
                    circle.addEventListener('mousedown', (e) => this.iniciarArrastar(e, index));
                    
                    // Highlight ao hover
                    circle.addEventListener('mouseenter', function() {
                        this.setAttribute('r', '5');
                        this.setAttribute('fill', '#fbbf24');
                    });
                    circle.addEventListener('mouseleave', function() {
                        this.setAttribute('r', '3');
                        this.setAttribute('fill', '#ef4444');
                    });
                    
                    group.appendChild(circle);
                });
            },
            
            iniciarArrastar(e, index) {
                e.preventDefault();
                this.pontoSelecionado = index;
                this.arrastandoPonto = true;
                
                const svg = document.getElementById('editor-atlas-svg');
                
                const moverPonto = (e) => {
                    if (!this.arrastandoPonto) return;
                    
                    const rect = svg.getBoundingClientRect();
                    const viewBox = svg.viewBox.baseVal;
                    
                    // Converter coordenadas do mouse para coordenadas SVG
                    const x = ((e.clientX - rect.left) / rect.width) * viewBox.width + viewBox.x;
                    const y = ((e.clientY - rect.top) / rect.height) * viewBox.height + viewBox.y;
                    
                    // Atualizar pontos
                    let points = this.regiaoAtual.points;
                    if (!points && this.regiaoAtual.path) {
                        points = this.pathToPoints(this.regiaoAtual.path);
                        this.regiaoAtual.points = points; // Adicionar campo points se nÃ£o existir
                    }
                    
                    const pontosArray = points.split(' ');
                    pontosArray[this.pontoSelecionado] = `${x.toFixed(2)},${y.toFixed(2)}`;
                    this.regiaoAtual.points = pontosArray.join(' ');
                    
                    // Redesenhar
                    this.desenharPoligono();
                    this.desenharPontos();
                    this.atualizarCoordenadas();
                };
                
                const pararArrastar = () => {
                    this.arrastandoPonto = false;
                    document.removeEventListener('mousemove', moverPonto);
                    document.removeEventListener('mouseup', pararArrastar);
                };
                
                document.addEventListener('mousemove', moverPonto);
                document.addEventListener('mouseup', pararArrastar);
            },
            
            atualizarCoordenadas() {
                const panel = document.getElementById('editor-atlas-coords');
                if (!panel || !this.regiaoAtual) return;
                
                let points = this.regiaoAtual.points;
                if (!points && this.regiaoAtual.path) {
                    points = this.pathToPoints(this.regiaoAtual.path);
                }
                
                const pontosArray = points.split(' ');
                
                let html = '<div style="font-size: 12px;">';
                html += `<strong>${this.regiaoAtual.nome}</strong><br>`;
                html += `<small style="color: var(--text-light);">${pontosArray.length} pontos</small><br>`;
                
                // Mostrar percentual se for atlas de queimaduras
                if (this.regiaoAtual.percentual) {
                    html += `<small style="color: var(--primary); font-weight: bold;">${this.regiaoAtual.percentual}%</small><br>`;
                }
                
                html += '<br>';
                
                pontosArray.forEach((ponto, index) => {
                    const [x, y] = ponto.split(',');
                    html += `<div style="padding: 4px 8px; margin-bottom: 4px; background: var(--bg); border-radius: 4px; font-family: monospace; font-size: 11px;">`;
                    html += `<strong>${index + 1}:</strong> (${parseFloat(x).toFixed(1)}, ${parseFloat(y).toFixed(1)})`;
                    html += `</div>`;
                });
                
                html += '</div>';
                panel.innerHTML = html;
            },
            
            resetar() {
                if (!this.regiaoAtual || !this.pontosOriginais) return;
                
                if (!confirm('Deseja resetar esta regiÃ£o para as coordenadas originais?')) return;
                
                this.regiaoAtual.points = this.pontosOriginais;
                this.desenharPoligono();
                this.desenharPontos();
                this.atualizarCoordenadas();
                
                Sistema.notificar('RegiÃ£o resetada para coordenadas originais', 'info');
            },
            
            salvar() {
                if (!this.regiaoAtual) {
                    Sistema.notificar('Nenhuma regiÃ£o selecionada', 'error');
                    return;
                }
                
                const nomeAtlas = this.tipoAtlas === 'queimados' ? 'ATLAS_QUEIMADOS' : 
                                 this.tipoAtlas === 'lundBrowder' ? 'ATLAS_LUND_BROWDER' : 
                                 'ATLAS_ANATOMICO';
                
                if (!confirm(`Salvar alteraÃ§Ãµes na regiÃ£o "${this.regiaoAtual.nome}"?\n\nIsso atualizarÃ¡ permanentemente o ${nomeAtlas}.`)) return;
                
                // ğŸ”§ REPARO: Restaurar campos perdidos se nÃ£o existirem
                // Buscar a regiÃ£o ORIGINAL do atlas padrÃ£o para copiar campos perdidos
                const atlasOriginal = this.tipoAtlas === 'queimados' ? ATLAS_QUEIMADOS : 
                                     this.tipoAtlas === 'lundBrowder' ? ATLAS_LUND_BROWDER : 
                                     ATLAS_ANATOMICO;
                
                // Encontrar regiÃ£o original pelo ID
                const regiaoOriginal = atlasOriginal.regioes.find(r => r.id === this.regiaoAtual.id);
                
                if (regiaoOriginal) {
                    // Restaurar campos crÃ­ticos se nÃ£o existirem na regiÃ£o atual
                    if (!this.regiaoAtual.percentual && !this.regiaoAtual.percentuais) {
                        if (regiaoOriginal.percentuais) {
                            this.regiaoAtual.percentuais = { ...regiaoOriginal.percentuais };
                            console.log('âœ… Campo percentuais restaurado:', this.regiaoAtual.percentuais);
                        } else if (regiaoOriginal.percentual) {
                            this.regiaoAtual.percentual = regiaoOriginal.percentual;
                            console.log('âœ… Campo percentual restaurado:', this.regiaoAtual.percentual);
                        }
                    }
                    
                    // Restaurar outros campos se nÃ£o existirem
                    if (!this.regiaoAtual.cor) {
                        this.regiaoAtual.cor = regiaoOriginal.cor;
                        console.log('âœ… Campo cor restaurado:', this.regiaoAtual.cor);
                    }
                    if (!this.regiaoAtual.grupo) {
                        this.regiaoAtual.grupo = regiaoOriginal.grupo;
                    }
                    if (!this.regiaoAtual.vista) {
                        this.regiaoAtual.vista = regiaoOriginal.vista;
                    }
                } else {
                    console.warn('âš ï¸ RegiÃ£o original nÃ£o encontrada para restaurar campos!');
                }
                
                // Atualizar o path tambÃ©m
                let points = this.regiaoAtual.points;
                if (!points && this.regiaoAtual.path) {
                    points = this.pathToPoints(this.regiaoAtual.path);
                }
                
                // ğŸ”§ CORREÃ‡ÃƒO: Garantir que o path seja construÃ­do no formato correto
                // Formato consistente: "M x,y L x,y L x,y ... Z" (com vÃ­rgulas entre x e y)
                const pontosArray = points.split(' ');
                let path = 'M ';
                path += pontosArray.map((p, i) => {
                    // Garantir que o ponto tem vÃ­rgula entre x e y
                    const coords = p.split(',');
                    if (coords.length !== 2) {
                        console.warn('âš ï¸ Ponto com formato invÃ¡lido:', p);
                        return null;
                    }
                    const x = parseFloat(coords[0]);
                    const y = parseFloat(coords[1]);
                    if (isNaN(x) || isNaN(y)) {
                        console.warn('âš ï¸ Coordenadas invÃ¡lidas:', coords);
                        return null;
                    }
                    // Usar vÃ­rgula entre x e y (formato original do atlas)
                    return i === 0 ? `${x},${y}` : `L ${x},${y}`;
                }).filter(p => p !== null).join(' ');
                path += ' Z';
                
                // Validar path antes de salvar
                const testPolygon = this.pathToPolygon(path);
                if (testPolygon.length === 0) {
                    Sistema.notificar('âŒ Erro: Path invÃ¡lido gerado! NÃ£o foi possÃ­vel salvar.', 'error');
                    console.error('Path invÃ¡lido:', path);
                    console.error('Points originais:', points);
                    return;
                }
                
                console.log('âœ… Path validado:', {
                    pontosNoPath: testPolygon.length,
                    pontosOriginais: pontosArray.length,
                    path: path.substring(0, 100) + '...'
                });
                
                this.regiaoAtual.path = path;
                this.regiaoAtual.points = points;
                
                // Atualizar nÃºmero de pontos se o campo existir
                if ('pontos' in this.regiaoAtual) {
                    this.regiaoAtual.pontos = pontosArray.length;
                }
                
                // Verificar se os campos crÃ­ticos existem antes de salvar
                const temPercentual = this.regiaoAtual.percentual || this.regiaoAtual.percentuais;
                if (!temPercentual) {
                    Sistema.notificar('âš ï¸ AVISO: RegiÃ£o sem percentual! Salvando mesmo assim...', 'warning');
                    console.error('âš ï¸ RegiÃ£o sem percentual:', this.regiaoAtual);
                }
                
                // Salvar no localStorage
                try {
                    localStorage.setItem(nomeAtlas, JSON.stringify(this.atlasAtual));
                    
                    // ========================================
                    // ATUALIZAR ATLAS GLOBAL
                    // ========================================
                    // âœ… CRÃTICO: Usar deepCopy para evitar vazamento de referÃªncias!
                    // NUNCA fazer atribuiÃ§Ã£o direta ou todos os atlas ficam com mesmas regiÃµes!
                    if (nomeAtlas === 'ATLAS_LUND_BROWDER') {
                        ATLAS_LUND_BROWDER.regioes = JSON.parse(JSON.stringify(this.atlasAtual.regioes));
                        console.log('âœ… Atlas global ATLAS_LUND_BROWDER atualizado (deep copy)');
                    } else if (nomeAtlas === 'ATLAS_QUEIMADOS') {
                        ATLAS_QUEIMADOS.regioes = JSON.parse(JSON.stringify(this.atlasAtual.regioes));
                        console.log('âœ… Atlas global ATLAS_QUEIMADOS atualizado (deep copy)');
                    } else if (nomeAtlas === 'ATLAS_ANATOMICO') {
                        ATLAS_ANATOMICO.regioes = JSON.parse(JSON.stringify(this.atlasAtual.regioes));
                        console.log('âœ… Atlas global ATLAS_ANATOMICO atualizado (deep copy)');
                    }
                    
                    // ========================================
                    // ATUALIZAR INSTÃ‚NCIAS ATIVAS
                    // ========================================
                    // Se jÃ¡ existem instÃ¢ncias de AnatomiaAtendimento abertas,
                    // atualizar seus atlas para usar as novas coordenadas
                    if (typeof AnatomiaAtendimento !== 'undefined' && AnatomiaAtendimento.instancias) {
                        Object.keys(AnatomiaAtendimento.instancias).forEach(containerId => {
                            const inst = AnatomiaAtendimento.instancias[containerId];
                            if (inst && inst.contexto === 'queimados') {
                                // Atualizar Lund-Browder
                                if (nomeAtlas === 'ATLAS_LUND_BROWDER' && inst.metodoQueimaduras === 'lundBrowder') {
                                    inst.atlasAtual = deepCopyAtlas(ATLAS_LUND_BROWDER);
                                    console.log('âœ… InstÃ¢ncia', containerId, 'atualizada com novo ATLAS_LUND_BROWDER');
                                    // Se possÃ­vel, redesenhar
                                    if (typeof inst.desenharSilhueta === 'function') {
                                        inst.desenharSilhueta();
                                    }
                                }
                                // Atualizar Regra dos 9
                                else if (nomeAtlas === 'ATLAS_QUEIMADOS' && inst.metodoQueimaduras === 'regra9') {
                                    inst.atlasAtual = deepCopyAtlas(ATLAS_QUEIMADOS);
                                    console.log('âœ… InstÃ¢ncia', containerId, 'atualizada com novo ATLAS_QUEIMADOS');
                                    // Se possÃ­vel, redesenhar
                                    if (typeof inst.desenharSilhueta === 'function') {
                                        inst.desenharSilhueta();
                                    }
                                }
                            }
                        });
                    }
                    
                    const msg = temPercentual 
                        ? `âœ… AlteraÃ§Ãµes salvas no ${nomeAtlas}! (${testPolygon.length} pontos)`
                        : `âš ï¸ Salvo com ${testPolygon.length} pontos, MAS sem percentual!`;
                    Sistema.notificar(msg, temPercentual ? 'success' : 'warning');
                    this.pontosOriginais = this.regiaoAtual.points; // Atualizar pontos originais
                } catch (e) {
                    Sistema.notificar('âŒ Erro ao salvar: ' + e.message, 'error');
                }
            },
            
            limparEditor() {
                this.regiaoAtual = null;
                this.pontosOriginais = null;
                
                const group1 = document.getElementById('editor-atlas-poligono-group');
                const group2 = document.getElementById('editor-atlas-pontos-group');
                const panel = document.getElementById('editor-atlas-coords');
                
                if (group1) group1.innerHTML = '';
                if (group2) group2.innerHTML = '';
                if (panel) {
                    panel.innerHTML = `<p style="color: var(--text-light); font-size: 13px; text-align: center; padding: 40px 20px;">
                        Selecione uma regiÃ£o para ver as coordenadas
                    </p>`;
                }
                
                const selectRegiao = document.getElementById('editor-atlas-regiao');
                if (selectRegiao) selectRegiao.value = '';
            },
            
            // ============================================================
            // GERENCIAMENTO DOS ATLAS
            // ============================================================
            
            exportarAtlas() {
                const data = {
                    exportado: new Date().toISOString(),
                    versao: '10.291',
                    atlasAnatomico: localStorage.getItem('ATLAS_ANATOMICO') ? JSON.parse(localStorage.getItem('ATLAS_ANATOMICO')) : null,
                    atlasQueimados: localStorage.getItem('ATLAS_QUEIMADOS') ? JSON.parse(localStorage.getItem('ATLAS_QUEIMADOS')) : null,
                    atlasLundBrowder: localStorage.getItem('ATLAS_LUND_BROWDER') ? JSON.parse(localStorage.getItem('ATLAS_LUND_BROWDER')) : null
                };
                
                // Verificar se hÃ¡ alteraÃ§Ãµes salvas
                const temAlteracoes = data.atlasAnatomico || data.atlasQueimados || data.atlasLundBrowder;
                
                if (!temAlteracoes) {
                    Sistema.notificar('âš ï¸ NÃ£o hÃ¡ alteraÃ§Ãµes salvas para exportar', 'warning');
                    return;
                }
                
                // Criar arquivo JSON
                const json = JSON.stringify(data, null, 2);
                const blob = new Blob([json], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                // Criar link de download
                const a = document.createElement('a');
                a.href = url;
                a.download = `backup_atlas_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                Sistema.notificar('âœ… Backup dos atlas exportado com sucesso!', 'success');
            },
            
            restaurarPadrao() {
                const confirmar = confirm(
                    'âš ï¸ ATENÃ‡ÃƒO!\n\n' +
                    'Isso vai REMOVER TODAS as suas alteraÃ§Ãµes e restaurar as coordenadas ORIGINAIS dos atlas.\n\n' +
                    'Recomendamos fazer um backup antes!\n\n' +
                    'Deseja continuar?'
                );
                
                if (!confirmar) return;
                
                // Remover do localStorage
                localStorage.removeItem('ATLAS_ANATOMICO');
                localStorage.removeItem('ATLAS_QUEIMADOS');
                localStorage.removeItem('ATLAS_LUND_BROWDER');
                
                Sistema.notificar('âœ… Atlas restaurados para versÃµes padrÃ£o! Recarregue a pÃ¡gina.', 'success');
                
                // Perguntar se quer recarregar agora
                setTimeout(() => {
                    if (confirm('Deseja recarregar a pÃ¡gina agora para aplicar as mudanÃ§as?')) {
                        location.reload();
                    }
                }, 1000);
            },
            
            // ============================================================
            // FUNÃ‡Ã•ES DE ZOOM E PAN
            // ============================================================
            
            zoom(delta) {
                this.zoomLevel = Math.max(1, Math.min(5, this.zoomLevel + delta));
                this.atualizarZoom();
            },
            
            setZoom(level) {
                this.zoomLevel = Math.max(1, Math.min(5, level));
                this.atualizarZoom();
            },
            
            resetZoom() {
                this.zoomLevel = 1;
                this.panX = 0;
                this.panY = 0;
                this.atualizarZoom();
            },
            
            atualizarZoom() {
                const svg = document.getElementById('editor-atlas-svg');
                const slider = document.getElementById('editor-atlas-zoom-slider');
                const valorText = document.getElementById('editor-atlas-zoom-valor');
                
                if (!svg) return;
                
                // Atualizar slider e texto
                if (slider) slider.value = this.zoomLevel;
                if (valorText) valorText.textContent = Math.round(this.zoomLevel * 100) + '%';
                
                // Calcular novo viewBox baseado no zoom e pan
                const vb = this.viewBoxOriginal;
                const newWidth = vb.width / this.zoomLevel;
                const newHeight = vb.height / this.zoomLevel;
                
                // Aplicar pan (limitado aos bounds)
                const maxPanX = vb.width - newWidth;
                const maxPanY = vb.height - newHeight;
                this.panX = Math.max(0, Math.min(maxPanX, this.panX));
                this.panY = Math.max(0, Math.min(maxPanY, this.panY));
                
                const newX = vb.x + this.panX;
                const newY = vb.y + this.panY;
                
                svg.setAttribute('viewBox', `${newX} ${newY} ${newWidth} ${newHeight}`);
            },
            
            configurarPan() {
                const container = document.getElementById('editor-atlas-container');
                const svg = document.getElementById('editor-atlas-svg');
                
                if (!container || !svg) return;
                
                let isPanning = false;
                let startX, startY;
                let startPanX, startPanY;
                
                container.addEventListener('mousedown', (e) => {
                    // NÃ£o iniciar pan se estiver arrastando um ponto
                    if (e.target.tagName === 'circle') return;
                    
                    isPanning = true;
                    container.style.cursor = 'grabbing';
                    
                    const rect = svg.getBoundingClientRect();
                    startX = e.clientX;
                    startY = e.clientY;
                    startPanX = this.panX;
                    startPanY = this.panY;
                    
                    e.preventDefault();
                });
                
                document.addEventListener('mousemove', (e) => {
                    if (!isPanning) return;
                    
                    const rect = svg.getBoundingClientRect();
                    const vb = this.viewBoxOriginal;
                    
                    // Converter movimento do mouse para coordenadas do viewBox
                    const deltaX = (e.clientX - startX) / rect.width * (vb.width / this.zoomLevel);
                    const deltaY = (e.clientY - startY) / rect.height * (vb.height / this.zoomLevel);
                    
                    this.panX = startPanX - deltaX;
                    this.panY = startPanY - deltaY;
                    
                    this.atualizarZoom();
                });
                
                document.addEventListener('mouseup', () => {
                    if (isPanning) {
                        isPanning = false;
                        container.style.cursor = 'grab';
                    }
                });
                
                // Zoom com scroll do mouse
                container.addEventListener('wheel', (e) => {
                    e.preventDefault();
                    const delta = e.deltaY > 0 ? -0.1 : 0.1;
                    this.zoom(delta);
                });
            },
            
            // ğŸ¨ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // SISTEMA DE PINTURA NO CANVAS (para testar alinhamento)
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            canvasVisible: false,
            isPainting: false,
            paintData: {},
            
            inicializarCanvas() {
                const canvas = document.getElementById('editor-atlas-canvas');
                const controls = document.getElementById('editor-atlas-paint-controls');
                const brushSlider = document.getElementById('editor-atlas-brush');
                const brushValue = document.getElementById('editor-atlas-brush-value');
                
                if (!canvas || !controls) {
                    console.warn('âš ï¸ Canvas ou controles nÃ£o encontrados no editor');
                    return;
                }
                
                console.log('ğŸ¨ Inicializando canvas de pintura no editor...');
                
                // âœ… CALCULAR ESCALA DINÃ‚MICA DO CANVAS PARA ALINHAR COM VIEWBOX
                const ctx = canvas.getContext('2d');
                const svg = document.getElementById('editor-atlas-svg');
                
                // Obter dimensÃµes reais renderizadas no navegador
                const rectCanvas = canvas.getBoundingClientRect();
                const rectSVG = svg.getBoundingClientRect();
                const viewBox = svg.viewBox.baseVal;
                
                // ğŸ¯ CALCULAR ESCALA BASEADA NO TAMANHO RENDERIZADO
                // ProporÃ§Ã£o entre o tamanho renderizado e as dimensÃµes do canvas/viewBox
                const scaleX = (canvas.width / viewBox.width) * (rectSVG.width / rectCanvas.width);
                const scaleY = (canvas.height / viewBox.height) * (rectSVG.height / rectCanvas.height);
                
                // Aplicar transformaÃ§Ã£o completa: escala + translate
                ctx.setTransform(scaleX, 0, 0, scaleY, 0, -viewBox.y * scaleY);
                
                console.log('âœ… TransformaÃ§Ã£o aplicada no canvas (BASEADA EM RENDERIZAÃ‡ÃƒO):', {
                    canvasSize: `${canvas.width}x${canvas.height}`,
                    canvasRendered: `${rectCanvas.width.toFixed(1)}x${rectCanvas.height.toFixed(1)}`,
                    svgRendered: `${rectSVG.width.toFixed(1)}x${rectSVG.height.toFixed(1)}`,
                    viewBox: `${viewBox.x},${viewBox.y} ${viewBox.width}x${viewBox.height}`,
                    scale: `${scaleX.toFixed(3)}, ${scaleY.toFixed(3)}`,
                    translateY: (-viewBox.y * scaleY).toFixed(1)
                });
                
                // Atualizar valor do pincel
                brushSlider.addEventListener('input', () => {
                    brushValue.textContent = brushSlider.value + 'px';
                });
                
                // Event listeners de pintura
                let isPainting = false;
                
                const paint = (e) => {
                    if (!isPainting && e.type !== 'mousedown') return;
                    
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const canvas = document.getElementById('editor-atlas-canvas');
                    const svg = document.getElementById('editor-atlas-svg');
                    const rect = canvas.getBoundingClientRect();
                    
                    // âœ… USAR VIEWBOX DO SVG (considera zoom/pan)
                    const viewBox = svg.viewBox.baseVal;
                    const viewBoxX = viewBox.x + ((e.clientX - rect.left) / rect.width) * viewBox.width;
                    const viewBoxY = viewBox.y + ((e.clientY - rect.top) / rect.height) * viewBox.height;
                    
                    // âœ… USAR COORDENADAS DO VIEWBOX DIRETO (canvas jÃ¡ transformado)
                    const canvasX = viewBoxX;
                    const canvasY = viewBoxY; // Canvas estÃ¡ em coordenadas do viewBox agora!
                    
                    if (e.type === 'mousedown') {
                        console.log('ğŸ¨ Editor Canvas - Mousedown:', {
                            mouse: `${e.clientX}, ${e.clientY}`,
                            viewBox: `${viewBox.x}, ${viewBox.y}, ${viewBox.width}x${viewBox.height}`,
                            viewBoxCoords: `${viewBoxX.toFixed(1)}, ${viewBoxY.toFixed(1)}`,
                            canvasCoords: `${canvasX.toFixed(1)}, ${canvasY.toFixed(1)}`,
                            zoom: this.zoomLevel,
                            regiaoAtual: this.regiaoAtual?.nome
                        });
                    }
                    
                    // Testar se clicou dentro da regiÃ£o atual
                    if (this.regiaoAtual) {
                        const polygon = this.pathToPolygon(this.regiaoAtual.path);
                        const isInside = this.isPointInPolygon({ x: viewBoxX, y: viewBoxY }, polygon);
                        
                        if (isInside) {
                            console.log('âœ… Clique DENTRO da regiÃ£o:', this.regiaoAtual.nome);
                            this.desenharPintura(canvasX, canvasY);
                        } else {
                            console.log('âŒ Clique FORA da regiÃ£o');
                            console.log('   PolÃ­gono bounds:', {
                                minX: Math.min(...polygon.map(p => p.x)).toFixed(1),
                                maxX: Math.max(...polygon.map(p => p.x)).toFixed(1),
                                minY: Math.min(...polygon.map(p => p.y)).toFixed(1),
                                maxY: Math.max(...polygon.map(p => p.y)).toFixed(1)
                            });
                        }
                    } else {
                        console.warn('âš ï¸ Nenhuma regiÃ£o selecionada no editor');
                    }
                };
                
                canvas.addEventListener('mousedown', (e) => {
                    console.log('ğŸ–±ï¸ MOUSEDOWN no canvas do editor');
                    isPainting = true;
                    paint(e);
                });
                
                canvas.addEventListener('mousemove', (e) => {
                    if (isPainting) paint(e);
                });
                
                canvas.addEventListener('mouseup', () => {
                    if (isPainting) {
                        console.log('ğŸ–±ï¸ MOUSEUP no canvas do editor');
                        isPainting = false;
                    }
                });
                
                canvas.addEventListener('mouseleave', () => {
                    if (isPainting) {
                        console.log('ğŸ–±ï¸ MOUSELEAVE no canvas do editor');
                        isPainting = false;
                    }
                });
                
                console.log('âœ… Canvas de pintura inicializado no editor');
            },
            
            desenharPintura(x, y) {
                const canvas = document.getElementById('editor-atlas-canvas');
                const ctx = canvas.getContext('2d');
                const brushSize = parseInt(document.getElementById('editor-atlas-brush').value);
                const grau = parseInt(document.getElementById('editor-atlas-grau').value);
                
                // Cor baseada no grau
                ctx.fillStyle = grau === 2 ? 'rgba(255, 152, 0, 0.5)' : 'rgba(198, 40, 40, 0.6)';
                ctx.beginPath();
                ctx.arc(x, y, brushSize / 2, 0, Math.PI * 2);
                ctx.fill();
            },
            
            toggleCanvas() {
                const canvas = document.getElementById('editor-atlas-canvas');
                const controls = document.getElementById('editor-atlas-paint-controls');
                const toggleText = document.getElementById('editor-atlas-canvas-toggle-text');
                const container = document.getElementById('editor-atlas-container');
                const svg = document.getElementById('editor-atlas-svg');
                
                this.canvasVisible = !this.canvasVisible;
                
                if (this.canvasVisible) {
                    // ATIVAR CANVAS
                    canvas.style.display = 'block';
                    controls.style.display = 'block';
                    toggleText.textContent = 'ğŸ¨ Esconder Canvas';
                    
                    // âœ… BLOQUEAR PAN/ZOOM quando canvas ativo
                    container.style.cursor = 'crosshair';
                    svg.style.pointerEvents = 'none';  // SVG nÃ£o captura eventos
                    canvas.style.pointerEvents = 'auto'; // Canvas captura eventos
                    canvas.style.zIndex = '10';
                    
                    console.log('ğŸ¨ Canvas ATIVADO - Pan/Zoom desabilitado');
                    
                    // Inicializar canvas se ainda nÃ£o foi
                    if (!canvas.hasAttribute('data-initialized')) {
                        this.inicializarCanvas();
                        canvas.setAttribute('data-initialized', 'true');
                    }
                } else {
                    // DESATIVAR CANVAS
                    canvas.style.display = 'none';
                    controls.style.display = 'none';
                    toggleText.textContent = 'ğŸ¨ Mostrar Canvas';
                    
                    // âœ… RESTAURAR PAN/ZOOM
                    container.style.cursor = 'grab';
                    svg.style.pointerEvents = 'auto';  // SVG volta a capturar eventos
                    canvas.style.pointerEvents = 'none';
                    
                    console.log('ğŸ¨ Canvas DESATIVADO - Pan/Zoom reabilitado');
                }
            },
            
            limparCanvas() {
                const canvas = document.getElementById('editor-atlas-canvas');
                const ctx = canvas.getContext('2d');
                const svg = document.getElementById('editor-atlas-svg');
                const viewBox = svg.viewBox.baseVal;
                
                // Salvar transformaÃ§Ã£o atual
                ctx.save();
                // Resetar para identidade e limpar tudo
                ctx.setTransform(1, 0, 0, 1, 0, 0);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                // Restaurar transformaÃ§Ã£o com escala correta
                ctx.restore();
                
                // Recalcular escala baseada em dimensÃµes renderizadas
                const rectCanvas = canvas.getBoundingClientRect();
                const rectSVG = svg.getBoundingClientRect();
                const scaleX = (canvas.width / viewBox.width) * (rectSVG.width / rectCanvas.width);
                const scaleY = (canvas.height / viewBox.height) * (rectSVG.height / rectCanvas.height);
                ctx.setTransform(scaleX, 0, 0, scaleY, 0, -viewBox.y * scaleY);
                
                console.log('ğŸ—‘ï¸ Canvas limpo (transformaÃ§Ã£o baseada em renderizaÃ§Ã£o mantida)');
            },
            
            pathToPolygon(pathString) {
                const commands = pathString.match(/[ML][\d\s.,]+/g) || [];
                const points = [];
                
                commands.forEach(cmd => {
                    const coords = cmd.slice(1).trim().split(/[\s,]+/);
                    for (let i = 0; i < coords.length; i += 2) {
                        const x = parseFloat(coords[i]);
                        const y = parseFloat(coords[i + 1]);
                        if (!isNaN(x) && !isNaN(y)) {
                            points.push({ x, y });
                        }
                    }
                });
                
                return points;
            },
            
            isPointInPolygon(point, polygon) {
                let inside = false;
                for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {
                    const xi = polygon[i].x, yi = polygon[i].y;
                    const xj = polygon[j].x, yj = polygon[j].y;
                    
                    const intersect = ((yi > point.y) !== (yj > point.y))
                        && (point.x < (xj - xi) * (point.y - yi) / (yj - yi) + xi);
                    if (intersect) inside = !inside;
                }
                return inside;
            },
            
            adicionarPontoIntermediario() {
                if (!this.regiaoAtual) {
                    alert('âš ï¸ Selecione uma regiÃ£o primeiro!');
                    return;
                }
                
                // Obter pontos atuais
                let points = this.regiaoAtual.points;
                if (!points && this.regiaoAtual.path) {
                    points = this.pathToPoints(this.regiaoAtual.path);
                }
                
                const pontosArray = points.split(' ');
                
                if (pontosArray.length < 2) {
                    alert('âš ï¸ RegiÃ£o precisa ter pelo menos 2 pontos!');
                    return;
                }
                
                console.log(`ğŸ“ Adicionando pontos intermediÃ¡rios... Atual: ${pontosArray.length} pontos`);
                
                // Criar novo array com pontos intermediÃ¡rios
                const novosPontos = [];
                
                for (let i = 0; i < pontosArray.length; i++) {
                    const p1 = pontosArray[i].split(',').map(Number);
                    const p2Idx = (i + 1) % pontosArray.length;
                    const p2 = pontosArray[p2Idx].split(',').map(Number);
                    
                    // Adicionar ponto original
                    novosPontos.push(pontosArray[i]);
                    
                    // Adicionar ponto intermediÃ¡rio (mÃ©dia entre p1 e p2)
                    const pontoMedioX = (p1[0] + p2[0]) / 2;
                    const pontoMedioY = (p1[1] + p2[1]) / 2;
                    novosPontos.push(`${pontoMedioX},${pontoMedioY}`);
                }
                
                // Atualizar regiÃ£o com novos pontos
                this.regiaoAtual.points = novosPontos.join(' ');
                
                // Redesenhar polÃ­gono e pontos
                this.desenharPoligono();
                this.desenharPontos();
                this.atualizarCoordenadas();
                
                console.log(`âœ… Pontos adicionados! Novo total: ${novosPontos.length} pontos`);
                alert(`âœ… Pontos adicionados!\n\nAntes: ${pontosArray.length} pontos\nDepois: ${novosPontos.length} pontos\n\nArraste os novos pontos (cÃ­rculos vermelhos) para ajustar!`);
            }
        };

        /* ============================================================
           [MANCHESTER] Protocolo de Manchester - v10.9.0
           ============================================================ */
        
        const Manchester = {
            // DEFINIÃ‡ÃƒO DAS PRIORIDADES
            prioridades: {
                vermelho: { nome: 'VERMELHO - EmergÃªncia', cor: '#ef4444', tempo: 0, emoji: 'ğŸ”´' },
                laranja: { nome: 'LARANJA - Muito Urgente', cor: '#f97316', tempo: 10, emoji: 'ğŸŸ ' },
                amarelo: { nome: 'AMARELO - Urgente', cor: '#eab308', tempo: 60, emoji: 'ğŸŸ¡' },
                verde: { nome: 'VERDE - Pouco Urgente', cor: '#22c55e', tempo: 120, emoji: 'ğŸŸ¢' },
                azul: { nome: 'AZUL - NÃ£o Urgente', cor: '#3b82f6', tempo: 240, emoji: 'ğŸ”µ' }
            },
            
            // TOP 10 FLUXOGRAMAS MAIS UTILIZADOS
            fluxogramas: [
                {
                    id: 1,
                    codigo: 'dor_toracica',
                    nome: 'Dor TorÃ¡cica',
                    icone: 'â¤ï¸',
                    descricao: 'AvaliaÃ§Ã£o de dor no peito ou desconforto torÃ¡cico',
                    discriminadores: [
                        { nome: 'Dor cardÃ­aca severa', descricao: 'Dor em aperto/peso com irradiaÃ§Ã£o para braÃ§o/mandÃ­bula', prioridade: 'vermelho' },
                        { nome: 'Dor pleurÃ­tica aguda', descricao: 'Dor que piora com respiraÃ§Ã£o profunda', prioridade: 'laranja' },
                        { nome: 'HistÃ³ria cardÃ­aca recente', descricao: 'Infarto ou cirurgia cardÃ­aca recente', prioridade: 'laranja' },
                        { nome: 'Dor torÃ¡cica moderada', descricao: 'Dor persistente sem caracterÃ­sticas de gravidade', prioridade: 'amarelo' },
                        { nome: 'Dor torÃ¡cica leve', descricao: 'Dor leve e localizada', prioridade: 'verde' },
                        { nome: 'Problema recente', descricao: 'Dor tratada recentemente sem mudanÃ§as', prioridade: 'azul' }
                    ]
                },
                {
                    id: 2,
                    codigo: 'dor_abdominal',
                    nome: 'Dor Abdominal',
                    icone: 'ğŸ¤°',
                    descricao: 'AvaliaÃ§Ã£o de dor ou desconforto abdominal',
                    discriminadores: [
                        { nome: 'Choque', descricao: 'HipotensÃ£o, taquicardia, sudorese fria', prioridade: 'vermelho' },
                        { nome: 'Dor severa', descricao: 'Dor intensa (>7/10) com sinais de peritonismo', prioridade: 'laranja' },
                        { nome: 'Sangramento GI', descricao: 'VÃ´mitos com sangue ou fezes escuras', prioridade: 'laranja' },
                        { nome: 'Dor moderada', descricao: 'Dor persistente (4-7/10)', prioridade: 'amarelo' },
                        { nome: 'VÃ´mitos persistentes', descricao: 'VÃ´mitos frequentes sem sangue', prioridade: 'amarelo' },
                        { nome: 'Dor leve recente', descricao: 'Dor leve (<4/10) de inÃ­cio recente', prioridade: 'verde' },
                        { nome: 'Problema crÃ´nico', descricao: 'Sintomas crÃ´nicos sem piora', prioridade: 'azul' }
                    ]
                },
                {
                    id: 3,
                    codigo: 'dispneia',
                    nome: 'Dispneia (Falta de Ar)',
                    icone: 'ğŸ˜®â€ğŸ’¨',
                    descricao: 'AvaliaÃ§Ã£o de dificuldade respiratÃ³ria',
                    discriminadores: [
                        { nome: 'Via aÃ©rea comprometida', descricao: 'ObstruÃ§Ã£o de vias aÃ©reas, estridor', prioridade: 'vermelho' },
                        { nome: 'Dispneia severa', descricao: 'Incapaz de falar frases completas, cianose', prioridade: 'vermelho' },
                        { nome: 'Dispneia aguda', descricao: 'Falta de ar de inÃ­cio sÃºbito nas Ãºltimas horas', prioridade: 'laranja' },
                        { nome: 'HistÃ³ria cardÃ­aca', descricao: 'Dispneia em paciente cardiopata', prioridade: 'laranja' },
                        { nome: 'Dispneia moderada', descricao: 'Falta de ar ao esforÃ§o moderado', prioridade: 'amarelo' },
                        { nome: 'Dispneia leve', descricao: 'Falta de ar apenas em grandes esforÃ§os', prioridade: 'verde' },
                        { nome: 'DPOC crÃ´nica estÃ¡vel', descricao: 'Paciente com DPOC sem piora', prioridade: 'azul' }
                    ]
                },
                {
                    id: 4,
                    codigo: 'cefaleia',
                    nome: 'Cefaleia (Dor de CabeÃ§a)',
                    icone: 'ğŸ¤•',
                    descricao: 'AvaliaÃ§Ã£o de dor de cabeÃ§a',
                    discriminadores: [
                        { nome: 'Cefaleia sÃºbita intensa', descricao: '"Pior dor de cabeÃ§a da vida", inÃ­cio sÃºbito', prioridade: 'vermelho' },
                        { nome: 'Sinais neurolÃ³gicos', descricao: 'ConfusÃ£o, alteraÃ§Ã£o de consciÃªncia, dÃ©ficit motor', prioridade: 'vermelho' },
                        { nome: 'Cefaleia + febre alta', descricao: 'Dor de cabeÃ§a com febre >39Â°C e rigidez de nuca', prioridade: 'laranja' },
                        { nome: 'Cefaleia severa', descricao: 'Dor intensa (>7/10) sem sinais de alarme', prioridade: 'amarelo' },
                        { nome: 'VÃ´mitos associados', descricao: 'NÃ¡useas e vÃ´mitos significativos', prioridade: 'amarelo' },
                        { nome: 'Cefaleia moderada', descricao: 'Dor moderada (4-7/10)', prioridade: 'verde' },
                        { nome: 'Cefaleia crÃ´nica', descricao: 'PadrÃ£o habitual de enxaqueca', prioridade: 'azul' }
                    ]
                },
                {
                    id: 5,
                    codigo: 'trauma',
                    nome: 'Trauma',
                    icone: 'ğŸ©¹',
                    descricao: 'AvaliaÃ§Ã£o de lesÃµes traumÃ¡ticas',
                    discriminadores: [
                        { nome: 'Trauma grave', descricao: 'Politrauma, queda de grande altura, atropelamento', prioridade: 'vermelho' },
                        { nome: 'Hemorragia importante', descricao: 'Sangramento ativo abundante', prioridade: 'vermelho' },
                        { nome: 'TCE com perda de consciÃªncia', descricao: 'Trauma craniano com desmaio', prioridade: 'laranja' },
                        { nome: 'Deformidade Ã³ssea', descricao: 'Fratura exposta ou deformidade evidente', prioridade: 'laranja' },
                        { nome: 'LesÃ£o significativa', descricao: 'Ferimento que necessita sutura', prioridade: 'amarelo' },
                        { nome: 'Trauma leve', descricao: 'ContusÃµes, escoriaÃ§Ãµes leves', prioridade: 'verde' },
                        { nome: 'Ferimento superficial', descricao: 'Pequeno corte ou arranhÃ£o', prioridade: 'azul' }
                    ]
                },
                {
                    id: 6,
                    codigo: 'convulsao',
                    nome: 'ConvulsÃµes',
                    icone: 'ğŸ§ ',
                    descricao: 'AvaliaÃ§Ã£o de crises convulsivas',
                    discriminadores: [
                        { nome: 'ConvulsÃ£o ativa', descricao: 'Paciente convulsionando no momento', prioridade: 'vermelho' },
                        { nome: 'Status epilepticus', descricao: 'ConvulsÃµes repetidas sem recuperaÃ§Ã£o entre elas', prioridade: 'vermelho' },
                        { nome: 'Primeira convulsÃ£o', descricao: 'Primeira crise convulsiva na vida', prioridade: 'laranja' },
                        { nome: 'PÃ³s-ictal prolongado', descricao: 'ConfusÃ£o ou sonolÃªncia >30min apÃ³s crise', prioridade: 'laranja' },
                        { nome: 'ConvulsÃ£o recente', descricao: 'Crise hÃ¡ menos de 6 horas, jÃ¡ recuperado', prioridade: 'amarelo' },
                        { nome: 'HistÃ³ria de epilepsia', descricao: 'EpilÃ©ptico conhecido com crise habitual', prioridade: 'verde' },
                        { nome: 'Ajuste medicaÃ§Ã£o', descricao: 'Consulta para ajuste de anticonvulsivante', prioridade: 'azul' }
                    ]
                },
                {
                    id: 7,
                    codigo: 'mal_estar_adulto',
                    nome: 'Mal-Estar em Adultos',
                    icone: 'ğŸ¤’',
                    descricao: 'AvaliaÃ§Ã£o de mal-estar geral inespecÃ­fico',
                    discriminadores: [
                        { nome: 'Sinais de choque', descricao: 'PA baixa, FC alta, perfusÃ£o ruim', prioridade: 'vermelho' },
                        { nome: 'AlteraÃ§Ã£o de consciÃªncia', descricao: 'ConfusÃ£o, desorientaÃ§Ã£o', prioridade: 'vermelho' },
                        { nome: 'Febre alta', descricao: 'Temperatura â‰¥39Â°C', prioridade: 'laranja' },
                        { nome: 'Dor significativa', descricao: 'Dor importante em qualquer local', prioridade: 'laranja' },
                        { nome: 'VÃ´mitos persistentes', descricao: 'VÃ´mitos frequentes, sinais de desidrataÃ§Ã£o', prioridade: 'amarelo' },
                        { nome: 'Mal-estar moderado', descricao: 'Sintomas gripais, febre baixa', prioridade: 'verde' },
                        { nome: 'Sintomas leves', descricao: 'Mal-estar leve sem sinais de gravidade', prioridade: 'azul' }
                    ]
                },
                {
                    id: 8,
                    codigo: 'problemas_membros',
                    nome: 'Problemas em Membros',
                    icone: 'ğŸ¦µ',
                    descricao: 'AvaliaÃ§Ã£o de problemas em braÃ§os ou pernas',
                    discriminadores: [
                        { nome: 'Membro isquÃªmico', descricao: 'Membro frio, pÃ¡lido, sem pulsos', prioridade: 'vermelho' },
                        { nome: 'Deformidade importante', descricao: 'Fratura exposta ou luxaÃ§Ã£o evidente', prioridade: 'laranja' },
                        { nome: 'Dor severa', descricao: 'Dor intensa que impede movimentaÃ§Ã£o', prioridade: 'laranja' },
                        { nome: 'Sinais de TVP', descricao: 'Edema unilateral, dor, empastamento', prioridade: 'amarelo' },
                        { nome: 'Incapacidade funcional', descricao: 'Impossibilidade de apoiar ou usar o membro', prioridade: 'amarelo' },
                        { nome: 'Dor ou edema leve', descricao: 'Desconforto que permite movimentaÃ§Ã£o', prioridade: 'verde' },
                        { nome: 'Problema crÃ´nico', descricao: 'Dor ou limitaÃ§Ã£o crÃ´nica sem piora', prioridade: 'azul' }
                    ]
                },
                {
                    id: 9,
                    codigo: 'sangramento_gi',
                    nome: 'Sangramento Gastrointestinal',
                    icone: 'ğŸ©¸',
                    descricao: 'AvaliaÃ§Ã£o de sangramento digestivo',
                    discriminadores: [
                        { nome: 'Choque hipovolÃªmico', descricao: 'HipotensÃ£o, taquicardia, palidez intensa', prioridade: 'vermelho' },
                        { nome: 'HematÃªmese volumosa', descricao: 'VÃ´mito com grande quantidade de sangue vivo', prioridade: 'vermelho' },
                        { nome: 'Melena recente', descricao: 'Fezes escuras/sanguinolentas de inÃ­cio recente', prioridade: 'laranja' },
                        { nome: 'HematÃªmese pequena', descricao: 'VÃ´mito com estrias ou pequena quantidade de sangue', prioridade: 'laranja' },
                        { nome: 'HistÃ³ria de cirrose', descricao: 'Paciente com doenÃ§a hepÃ¡tica e sangramento', prioridade: 'amarelo' },
                        { nome: 'Sangramento leve', descricao: 'Pequeno sangramento sem repercussÃ£o', prioridade: 'verde' },
                        { nome: 'HistÃ³ria de sangramento', descricao: 'InvestigaÃ§Ã£o de episÃ³dio antigo', prioridade: 'azul' }
                    ]
                },
                {
                    id: 10,
                    codigo: 'febre',
                    nome: 'Febre',
                    icone: 'ğŸŒ¡ï¸',
                    descricao: 'AvaliaÃ§Ã£o de estado febril',
                    discriminadores: [
                        { nome: 'Febre + choque', descricao: 'Febre com sinais de choque sÃ©ptico', prioridade: 'vermelho' },
                        { nome: 'Febre + alteraÃ§Ã£o consciÃªncia', descricao: 'Febre com confusÃ£o ou sonolÃªncia', prioridade: 'vermelho' },
                        { nome: 'Febre alta â‰¥39Â°C', descricao: 'Temperatura â‰¥39Â°C', prioridade: 'laranja' },
                        { nome: 'Febre + imunossupressÃ£o', descricao: 'Febre em paciente imunodeprimido', prioridade: 'laranja' },
                        { nome: 'Febre + petÃ©quias', descricao: 'Febre com manchas roxas na pele', prioridade: 'laranja' },
                        { nome: 'Febre moderada', descricao: 'Temperatura 38-39Â°C sem sinais de alarme', prioridade: 'amarelo' },
                        { nome: 'Febre baixa', descricao: 'Febre <38Â°C com bom estado geral', prioridade: 'verde' },
                        { nome: 'Febre crÃ´nica', descricao: 'InvestigaÃ§Ã£o de febre prolongada', prioridade: 'azul' }
                    ]
                }
            ],
            
            // FUNÃ‡Ã•ES DO MÃ“DULO
            init() {
                console.log('ğŸš¨ [Manchester] MÃ³dulo Protocolo de Manchester inicializado');
                this.renderizarListaFluxogramas();
                this.popularSelectFluxogramas();
            },
            
            renderizarListaFluxogramas() {
                const container = document.getElementById('lista-fluxogramas-manchester');
                if (!container) return;
                
                let html = '';
                this.fluxogramas.forEach(fluxograma => {
                    const totalDiscriminadores = fluxograma.discriminadores.length;
                    html += `
                        <div style="margin-bottom: 16px; padding: 16px; background: white; border-radius: 8px; border: 1px solid #e0e0e0; cursor: pointer;" onclick="Manchester.expandirFluxograma(${fluxograma.id})">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span style="font-size: 32px;">${fluxograma.icone}</span>
                                    <div>
                                        <h4 style="margin: 0; color: var(--primary);">${fluxograma.nome}</h4>
                                        <p style="margin: 4px 0 0 0; color: var(--text-light); font-size: 14px;">${fluxograma.descricao}</p>
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <span style="background: var(--bg); padding: 8px 12px; border-radius: 6px; font-size: 14px;">
                                        ${totalDiscriminadores} discriminadores
                                    </span>
                                </div>
                            </div>
                            
                            <!-- DISCRIMINADORES (inicialmente oculto) -->
                            <div id="discriminadores-${fluxograma.id}" style="display: none; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border);">
                                ${fluxograma.discriminadores.map(disc => {
                                    const prioridade = this.prioridades[disc.prioridade];
                                    return `
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 12px; background: var(--bg); border-radius: 6px; border-left: 4px solid ${prioridade.cor};">
                                            <div style="font-size: 24px;">${prioridade.emoji}</div>
                                            <div style="flex: 1;">
                                                <div style="font-weight: bold; color: ${prioridade.cor};">${disc.nome}</div>
                                                <div style="font-size: 14px; color: var(--text-light); margin-top: 4px;">${disc.descricao}</div>
                                            </div>
                                            <div style="text-align: right; padding: 8px 12px; background: ${prioridade.cor}; color: white; border-radius: 6px; white-space: nowrap; font-size: 12px;">
                                                <div style="font-weight: bold;">${prioridade.nome.split(' - ')[0]}</div>
                                                <div>${prioridade.tempo === 0 ? 'IMEDIATO' : prioridade.tempo + ' min'}</div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },
            
            expandirFluxograma(id) {
                const div = document.getElementById(`discriminadores-${id}`);
                if (!div) return;
                
                const isVisible = div.style.display !== 'none';
                div.style.display = isVisible ? 'none' : 'block';
            },
            
            popularSelectFluxogramas() {
                const select = document.getElementById('simulador-fluxograma');
                if (!select) return;
                
                select.innerHTML = '<option value="">-- Escolha o fluxograma --</option>';
                this.fluxogramas.forEach(fluxo => {
                    select.innerHTML += `<option value="${fluxo.codigo}">${fluxo.icone} ${fluxo.nome}</option>`;
                });
            },
            
            carregarDiscriminadores() {
                const selectFluxo = document.getElementById('simulador-fluxograma');
                const selectDisc = document.getElementById('simulador-discriminador');
                const resultado = document.getElementById('resultado-classificacao');
                
                if (!selectFluxo || !selectDisc) return;
                
                const codigoFluxo = selectFluxo.value;
                const fluxograma = this.fluxogramas.find(f => f.codigo === codigoFluxo);
                
                // Limpar resultado
                resultado.style.display = 'none';
                
                if (!fluxograma) {
                    selectDisc.innerHTML = '<option value="">-- Escolha o discriminador --</option>';
                    selectDisc.disabled = true;
                    return;
                }
                
                selectDisc.disabled = false;
                selectDisc.innerHTML = '<option value="">-- Escolha o discriminador --</option>';
                
                fluxograma.discriminadores.forEach((disc, index) => {
                    const prioridade = this.prioridades[disc.prioridade];
                    selectDisc.innerHTML += `<option value="${index}">${prioridade.emoji} ${disc.nome}</option>`;
                });
            },
            
            exibirClassificacao() {
                const selectFluxo = document.getElementById('simulador-fluxograma');
                const selectDisc = document.getElementById('simulador-discriminador');
                const resultado = document.getElementById('resultado-classificacao');
                
                if (!selectFluxo || !selectDisc || !resultado) return;
                
                const codigoFluxo = selectFluxo.value;
                const indexDisc = selectDisc.value;
                
                if (!codigoFluxo || indexDisc === '') {
                    resultado.style.display = 'none';
                    return;
                }
                
                const fluxograma = this.fluxogramas.find(f => f.codigo === codigoFluxo);
                const discriminador = fluxograma.discriminadores[parseInt(indexDisc)];
                const prioridade = this.prioridades[discriminador.prioridade];
                
                // Exibir resultado
                resultado.style.display = 'block';
                resultado.style.background = prioridade.cor;
                resultado.style.color = 'white';
                
                document.getElementById('resultado-emoji').textContent = prioridade.emoji;
                document.getElementById('resultado-nivel').textContent = prioridade.nome;
                document.getElementById('resultado-tempo').textContent = prioridade.tempo === 0 ? 
                    'Atendimento IMEDIATO' : 
                    `Tempo mÃ¡ximo de espera: ${prioridade.tempo} minutos`;
                document.getElementById('resultado-descricao').textContent = discriminador.descricao;
            },
            
            obterClassificacao(codigoFluxo, nomeDiscriminador) {
                const fluxograma = this.fluxogramas.find(f => f.codigo === codigoFluxo);
                if (!fluxograma) return null;
                
                const discriminador = fluxograma.discriminadores.find(d => d.nome === nomeDiscriminador);
                if (!discriminador) return null;
                
                const prioridade = this.prioridades[discriminador.prioridade];
                
                return {
                    fluxograma: fluxograma.nome,
                    discriminador: discriminador.nome,
                    descricao: discriminador.descricao,
                    cor: prioridade.cor,
                    nivel: prioridade.nome,
                    tempo_maximo: prioridade.tempo,
                    emoji: prioridade.emoji
                };
            }
        };

        /* ============================================================
           [EDITOR VISUAL] MÃ³dulo Editor Visual de Documentos - v10.11.0
           ============================================================ */
        
        const Cabecalhos = {
            layoutAtual: null,
            layouts: [],

            init() {
                console.log('ğŸ¨ [Cabecalhos] MÃ³dulo inicializado');
                this.carregarLayouts();
                this.renderizarLista();
            },

            carregarLayouts() {
                // Carregar layouts salvos ou criar padrÃµes
                if (!SistemaCore.dados.cabecalhos) {
                    console.log('ğŸ”„ [Cabecalhos] Criando layouts padrÃ£o...');
                    SistemaCore.dados.cabecalhos = this.criarLayoutsPadrao();
                    SistemaCore.salvar();
                }
                this.layouts = SistemaCore.dados.cabecalhos;
                console.log('ğŸ“‚ [Cabecalhos] Layouts carregados:', this.layouts.length);
                this.layouts.forEach(l => console.log(`   - ${l.id}: ${l.nome} (qrcode: ${l.qrcode}, barcode: ${l.barcode})`));
            },

            criarLayoutsPadrao() {
                return [
                    {
                        id: 1,
                        nome: 'Minimalista',
                        tipoBase: 'minimalista',
                        logo: { ativo: false },
                        camposEstab: ['nome'],
                        camposPaciente: ['nome', 'prontuario', 'data'],
                        barcode: false,
                        qrcode: false
                    },
                    {
                        id: 2,
                        nome: 'PadrÃ£o',
                        tipoBase: 'padrao',
                        logo: { ativo: true, tamanho: 'medio', posicao: 'esquerda' },
                        camposEstab: ['nome'],
                        camposPaciente: ['nome', 'prontuario', 'data'],
                        barcode: false,
                        qrcode: false
                    },
                    {
                        id: 3,
                        nome: 'Folha de Rosto Completa',
                        tipoBase: 'folha-rosto',
                        logo: { ativo: true, tamanho: 'grande', posicao: 'centro' },
                        camposEstab: ['nome', 'cnpj', 'cnes', 'endereco'],
                        camposPaciente: ['nome', 'prontuario', 'atendimento', 'data', 'idade', 'cpf'],
                        barcode: true,
                        qrcode: true
                    }
                ];
            },

            renderizarLista() {
                const container = document.getElementById('cabecalhos-lista');
                if (!container) return;

                if (this.layouts.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: var(--text-light); font-size: 12px; padding: 20px;">Nenhum layout cadastrado</p>';
                    return;
                }

                container.innerHTML = this.layouts.map(layout => `
                    <div class="layout-item ${this.layoutAtual?.id === layout.id ? 'active' : ''}" 
                         onclick="Cabecalhos.selecionarLayout(${layout.id})"
                         style="
                            padding: 12px;
                            background: ${this.layoutAtual?.id === layout.id ? 'var(--primary)' : 'var(--bg)'};
                            color: ${this.layoutAtual?.id === layout.id ? 'white' : 'inherit'};
                            border-radius: 6px;
                            cursor: pointer;
                            transition: all 0.2s;
                            border: 2px solid ${this.layoutAtual?.id === layout.id ? 'var(--primary)' : 'transparent'};
                        ">
                        <div style="font-weight: 600; font-size: 13px; margin-bottom: 4px;">
                            ${layout.nome}
                        </div>
                        <div style="font-size: 10px; opacity: 0.8;">
                            ${this.getNomeTipoBase(layout.tipoBase)}
                        </div>
                    </div>
                `).join('');
            },

            getNomeTipoBase(tipo) {
                const nomes = {
                    'minimalista': 'Minimalista',
                    'compacto': 'Compacto',
                    'padrao': 'PadrÃ£o',
                    'completo': 'Completo',
                    'folha-rosto': 'Folha de Rosto'
                };
                return nomes[tipo] || tipo;
            },

            novoLayout() {
                this.layoutAtual = {
                    id: SistemaCore.proximoId(SistemaCore.dados.cabecalhos || []),
                    nome: '',
                    tipoBase: 'padrao',
                    logo: { ativo: true, url: '', tamanho: 'medio', posicao: 'esquerda' },
                    camposEstab: ['nome'],
                    camposPaciente: ['nome', 'prontuario', 'data'],
                    barcode: false,
                    qrcode: false
                };
                this.mostrarEditor();
                this.preencherFormulario();
                this.atualizarPreview();
            },

            selecionarLayout(id) {
                this.layoutAtual = this.layouts.find(l => l.id === id);
                if (this.layoutAtual) {
                    this.renderizarLista();
                    this.mostrarEditor();
                    this.preencherFormulario();
                    this.atualizarPreview();
                }
            },

            mostrarEditor() {
                document.getElementById('cabecalhos-editor-vazio').style.display = 'none';
                document.getElementById('cabecalhos-editor-form').style.display = 'block';
            },

            preencherFormulario() {
                if (!this.layoutAtual) return;

                // Nome
                document.getElementById('cab-nome').value = this.layoutAtual.nome;
                
                // Tipo Base
                document.getElementById('cab-tipo-base').value = this.layoutAtual.tipoBase;
                
                // Logo
                document.getElementById('cab-logo-ativo').checked = this.layoutAtual.logo.ativo;
                document.getElementById('cab-logo-url').value = this.layoutAtual.logo.url || '';
                document.getElementById('cab-logo-tamanho').value = this.layoutAtual.logo.tamanho || 'medio';
                document.getElementById('cab-logo-posicao').value = this.layoutAtual.logo.posicao || 'esquerda';
                document.getElementById('cab-logo-opcoes').style.display = this.layoutAtual.logo.ativo ? 'block' : 'none';
                
                // Campos Estabelecimento
                document.querySelectorAll('.cab-campo-estab').forEach(cb => {
                    cb.checked = this.layoutAtual.camposEstab.includes(cb.value);
                });
                
                // Campos Paciente
                document.querySelectorAll('.cab-campo-paciente').forEach(cb => {
                    cb.checked = this.layoutAtual.camposPaciente.includes(cb.value);
                });
                
                // CÃ³digos - v10.385: com configuraÃ§Ãµes
                const qrcodeAtivo = document.getElementById('cab-qrcode-ativo');
                const barcodeAtivo = document.getElementById('cab-barcode-ativo');
                
                if (qrcodeAtivo) {
                    qrcodeAtivo.checked = this.layoutAtual.qrcode || false;
                    const qrcodeOpcoes = document.getElementById('cab-qrcode-opcoes');
                    if (qrcodeOpcoes) qrcodeOpcoes.style.display = this.layoutAtual.qrcode ? 'block' : 'none';
                    
                    const qrcodeConteudo = document.getElementById('cab-qrcode-conteudo');
                    const qrcodePosicao = document.getElementById('cab-qrcode-posicao');
                    if (qrcodeConteudo) qrcodeConteudo.value = this.layoutAtual.qrcodeConfig?.conteudo || 'prontuario';
                    if (qrcodePosicao) qrcodePosicao.value = this.layoutAtual.qrcodeConfig?.posicao || 'topo-direita';
                }
                
                if (barcodeAtivo) {
                    barcodeAtivo.checked = this.layoutAtual.barcode || false;
                    const barcodeOpcoes = document.getElementById('cab-barcode-opcoes');
                    if (barcodeOpcoes) barcodeOpcoes.style.display = this.layoutAtual.barcode ? 'block' : 'none';
                    
                    const barcodeConteudo = document.getElementById('cab-barcode-conteudo');
                    const barcodePosicao = document.getElementById('cab-barcode-posicao');
                    if (barcodeConteudo) barcodeConteudo.value = this.layoutAtual.barcodeConfig?.conteudo || 'prontuario';
                    if (barcodePosicao) barcodePosicao.value = this.layoutAtual.barcodeConfig?.posicao || 'topo-direita';
                }
            },

            trocarTipoBase() {
                if (!this.layoutAtual) return;
                this.layoutAtual.tipoBase = document.getElementById('cab-tipo-base').value;
                this.atualizarPreview();
            },

            toggleSecao(secao) {
                if (!this.layoutAtual) return;
                
                if (secao === 'barcode') {
                    const ativo = document.getElementById('cab-barcode-ativo').checked;
                    this.layoutAtual.barcode = ativo;
                    const opcoes = document.getElementById('cab-barcode-opcoes');
                    if (opcoes) opcoes.style.display = ativo ? 'block' : 'none';
                } else if (secao === 'qrcode') {
                    const ativo = document.getElementById('cab-qrcode-ativo').checked;
                    this.layoutAtual.qrcode = ativo;
                    const opcoes = document.getElementById('cab-qrcode-opcoes');
                    if (opcoes) opcoes.style.display = ativo ? 'block' : 'none';
                }
                
                // Toggle logo options
                if (secao === 'logo') {
                    const ativo = document.getElementById('cab-logo-ativo').checked;
                    document.getElementById('cab-logo-opcoes').style.display = ativo ? 'block' : 'none';
                }
                
                this.atualizarPreview();
            },

            atualizarPreview() {
                if (!this.layoutAtual) return;

                // Coletar dados do formulÃ¡rio
                this.layoutAtual.nome = document.getElementById('cab-nome').value;
                this.layoutAtual.tipoBase = document.getElementById('cab-tipo-base').value;
                
                this.layoutAtual.logo = {
                    ativo: document.getElementById('cab-logo-ativo').checked,
                    url: document.getElementById('cab-logo-url').value,
                    tamanho: document.getElementById('cab-logo-tamanho').value,
                    posicao: document.getElementById('cab-logo-posicao').value
                };
                
                this.layoutAtual.camposEstab = Array.from(document.querySelectorAll('.cab-campo-estab:checked')).map(cb => cb.value);
                this.layoutAtual.camposPaciente = Array.from(document.querySelectorAll('.cab-campo-paciente:checked')).map(cb => cb.value);
                
                // v10.385: QR Code e CÃ³digo de Barras com configuraÃ§Ãµes
                this.layoutAtual.qrcode = document.getElementById('cab-qrcode-ativo')?.checked || false;
                this.layoutAtual.qrcodeConfig = {
                    conteudo: document.getElementById('cab-qrcode-conteudo')?.value || 'prontuario',
                    posicao: document.getElementById('cab-qrcode-posicao')?.value || 'topo-direita'
                };
                
                this.layoutAtual.barcode = document.getElementById('cab-barcode-ativo')?.checked || false;
                this.layoutAtual.barcodeConfig = {
                    conteudo: document.getElementById('cab-barcode-conteudo')?.value || 'prontuario',
                    posicao: document.getElementById('cab-barcode-posicao')?.value || 'topo-direita'
                };

                // Renderizar preview
                this.renderizarPreview();
            },

            salvar() {
                console.log('ğŸ”„ [Cabecalhos.salvar] Iniciando...');
                console.log('ğŸ”„ [Cabecalhos.salvar] layoutAtual:', this.layoutAtual);
                
                if (!this.layoutAtual) {
                    Sistema.notificar('âŒ Nenhum layout selecionado', 'erro');
                    console.error('âŒ [Cabecalhos.salvar] Nenhum layout selecionado');
                    return;
                }

                // Coletar dados do formulÃ¡rio
                this.layoutAtual.nome = document.getElementById('cab-nome').value.trim();
                console.log('ğŸ”„ [Cabecalhos.salvar] Nome:', this.layoutAtual.nome);
                
                if (!this.layoutAtual.nome) {
                    Sistema.notificar('âŒ Digite um nome para o layout', 'erro');
                    return;
                }

                this.layoutAtual.tipoBase = document.getElementById('cab-tipo-base').value;
                console.log('ğŸ”„ [Cabecalhos.salvar] Tipo Base:', this.layoutAtual.tipoBase);
                
                this.layoutAtual.logo = {
                    ativo: document.getElementById('cab-logo-ativo').checked,
                    url: document.getElementById('cab-logo-url').value,
                    tamanho: document.getElementById('cab-logo-tamanho').value,
                    posicao: document.getElementById('cab-logo-posicao').value
                };
                
                this.layoutAtual.camposEstab = Array.from(document.querySelectorAll('.cab-campo-estab:checked')).map(cb => cb.value);
                this.layoutAtual.camposPaciente = Array.from(document.querySelectorAll('.cab-campo-paciente:checked')).map(cb => cb.value);
                
                // v10.385: QR Code e CÃ³digo de Barras com configuraÃ§Ãµes
                this.layoutAtual.qrcode = document.getElementById('cab-qrcode-ativo')?.checked || false;
                this.layoutAtual.qrcodeConfig = {
                    conteudo: document.getElementById('cab-qrcode-conteudo')?.value || 'prontuario',
                    posicao: document.getElementById('cab-qrcode-posicao')?.value || 'topo-direita'
                };
                
                this.layoutAtual.barcode = document.getElementById('cab-barcode-ativo')?.checked || false;
                this.layoutAtual.barcodeConfig = {
                    conteudo: document.getElementById('cab-barcode-conteudo')?.value || 'prontuario',
                    posicao: document.getElementById('cab-barcode-posicao')?.value || 'topo-direita'
                };

                // Verificar se Ã© novo ou ediÃ§Ã£o
                const index = this.layouts.findIndex(l => l.id === this.layoutAtual.id);
                
                if (index !== -1) {
                    // Atualizar existente
                    this.layouts[index] = { ...this.layoutAtual };
                    Sistema.notificar('âœ… Layout atualizado!', 'sucesso');
                } else {
                    // Adicionar novo
                    this.layouts.push({ ...this.layoutAtual });
                    Sistema.notificar('âœ… Layout criado!', 'sucesso');
                }

                // Salvar no SistemaCore
                SistemaCore.dados.cabecalhos = this.layouts;
                SistemaCore.salvar();

                // Atualizar lista
                this.renderizarLista();
                
                console.log('âœ… [Cabecalhos.salvar] SUCESSO! Layout salvo:', this.layoutAtual.nome);
                console.log('âœ… [Cabecalhos.salvar] ID:', this.layoutAtual.id);
                console.log('âœ… [Cabecalhos.salvar] QR Code:', this.layoutAtual.qrcode, this.layoutAtual.qrcodeConfig);
                console.log('âœ… [Cabecalhos.salvar] Barcode:', this.layoutAtual.barcode, this.layoutAtual.barcodeConfig);
                console.log('âœ… [Cabecalhos.salvar] Campos Paciente:', this.layoutAtual.camposPaciente);
                console.log('âœ… [Cabecalhos.salvar] Total layouts salvos:', this.layouts.length);
            },

            excluir(id) {
                const layout = this.layouts.find(l => l.id === id);
                if (!layout) return;

                if (confirm(`Excluir o layout "${layout.nome}"?`)) {
                    this.layouts = this.layouts.filter(l => l.id !== id);
                    SistemaCore.dados.cabecalhos = this.layouts;
                    SistemaCore.salvar();
                    
                    // Limpar seleÃ§Ã£o se era o atual
                    if (this.layoutAtual?.id === id) {
                        this.layoutAtual = null;
                        document.getElementById('cabecalhos-editor-vazio').style.display = 'block';
                        document.getElementById('cabecalhos-editor-form').style.display = 'none';
                    }
                    
                    this.renderizarLista();
                    Sistema.notificar('âœ… Layout excluÃ­do!', 'sucesso');
                }
            },

            cancelar() {
                this.layoutAtual = null;
                document.getElementById('cabecalhos-editor-vazio').style.display = 'block';
                document.getElementById('cabecalhos-editor-form').style.display = 'none';
                this.renderizarLista();
            },

            renderizarPreview() {
                // v10.346: Preview mostra apenas ESTRUTURA, nÃ£o dados fictÃ­cios
                const previewVazio = document.getElementById('cabecalhos-preview-vazio');
                const previewContainer = document.getElementById('cabecalhos-preview-container');
                const previewCabecalho = document.getElementById('cabecalhos-preview-cabecalho');
                
                if (!this.layoutAtual || !previewCabecalho) {
                    if (previewVazio) previewVazio.style.display = 'block';
                    if (previewContainer) previewContainer.style.display = 'none';
                    return;
                }
                
                // Mostrar preview, esconder vazio
                if (previewVazio) previewVazio.style.display = 'none';
                if (previewContainer) previewContainer.style.display = 'block';
                
                const layout = this.layoutAtual;
                const ce = layout.camposEstab || [];
                const cp = layout.camposPaciente || [];
                const config = SistemaCore.dados.configuracao || {};
                const logoUrl = layout.logo?.url || config.logo || null;
                
                // FunÃ§Ã£o para criar placeholder de campo
                const campo = (nome, largura = 'auto') => `<span style="background: #e5e7eb; padding: 2px 6px; border-radius: 3px; font-size: 9px; color: #666; display: inline-block; margin: 1px;">${nome}</span>`;
                
                let html = '';
                
                // Renderizar baseado no tipo - mostrando CAMPOS, nÃ£o valores
                switch(layout.tipoBase) {
                    case 'minimalista':
                        html = `
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 8px 12px; background: white; border-bottom: 2px solid #ddd; font-size: 10px;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    ${layout.logo?.ativo ? `<div style="width: 40px; height: 25px; background: #dbeafe; border: 1px dashed #3b82f6; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #3b82f6;">LOGO</div>` : ''}
                                    ${ce.includes('nome') ? campo('Nome Fantasia') : ''}
                                </div>
                                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                    ${cp.includes('nome') ? campo('Paciente') : ''}
                                    ${cp.includes('prontuario') ? campo('ProntuÃ¡rio') : ''}
                                    ${cp.includes('data') ? campo('Data') : ''}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'compacto':
                        html = `
                            <div style="background: white; padding: 10px; border-bottom: 2px solid #ddd; font-size: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 6px;">
                                    <div style="display: flex; gap: 8px; align-items: center;">
                                        ${layout.logo?.ativo ? `<div style="width: 50px; height: 35px; background: #dbeafe; border: 1px dashed #3b82f6; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #3b82f6;">LOGO</div>` : ''}
                                        <div>
                                            ${ce.includes('nome') ? campo('Nome Fantasia') : ''}
                                            ${ce.includes('cnpj') ? `<div style="margin-top: 4px;">${campo('CNPJ')}</div>` : ''}
                                        </div>
                                    </div>
                                    ${layout.qrcode ? '<div style="width: 35px; height: 35px; background: #f3f4f6; border: 1px dashed #999; display: flex; align-items: center; justify-content: center; font-size: 7px; color: #666;">QR</div>' : ''}
                                </div>
                                <div style="border-top: 1px solid #ddd; padding-top: 6px; display: flex; gap: 8px; flex-wrap: wrap;">
                                    ${cp.includes('nome') ? campo('Paciente') : ''}
                                    ${cp.includes('prontuario') ? campo('ProntuÃ¡rio') : ''}
                                    ${cp.includes('data') ? campo('Data') : ''}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'completo':
                        html = `
                            <div style="background: white; padding: 10px; border-bottom: 2px solid #ddd; font-size: 9px;">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <tr>
                                        ${layout.logo?.ativo ? `<td rowspan="3" style="width: 60px; text-align: center; border-right: 1px solid #ddd; padding-right: 8px;"><div style="width: 50px; height: 50px; background: #dbeafe; border: 1px dashed #3b82f6; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #3b82f6; margin: auto;">LOGO</div></td>` : ''}
                                        <td colspan="2" style="padding: 3px;">${ce.includes('nome') ? campo('Nome Fantasia') : ''} ${ce.includes('razao_social') ? campo('RazÃ£o Social') : ''}</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 3px; width: 50%;">${ce.includes('cnpj') ? campo('CNPJ') : ''}</td>
                                        <td style="padding: 3px;">${ce.includes('cnes') ? campo('CNES') : ''}</td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" style="padding: 3px;">${ce.includes('endereco') ? campo('EndereÃ§o') : ''} ${ce.includes('telefone') ? campo('Telefone') : ''}</td>
                                    </tr>
                                </table>
                                <div style="margin-top: 8px; padding-top: 8px; border-top: 2px solid #ddd; display: flex; gap: 6px; flex-wrap: wrap;">
                                    ${cp.includes('nome') ? campo('Paciente') : ''}
                                    ${cp.includes('prontuario') ? campo('ProntuÃ¡rio') : ''}
                                    ${cp.includes('nascimento') ? campo('Nascimento') : ''}
                                    ${cp.includes('idade') ? campo('Idade') : ''}
                                    ${cp.includes('sexo') ? campo('Sexo') : ''}
                                </div>
                            </div>
                        `;
                        break;
                        
                    case 'folha-rosto':
                        html = `
                            <div style="border: 1px solid #000; background: white; font-size: 9px; position: relative;">
                                ${(layout.qrcode || layout.barcode) ? `
                                <div style="position: absolute; top: 4px; right: 4px; display: flex; gap: 4px; align-items: start; z-index: 10;">
                                    ${layout.barcode ? `<div style="padding: 2px 4px; background: white; border-radius: 2px;"><div style="width: 50px; height: 15px; background: repeating-linear-gradient(90deg, #000 0px, #000 1px, #fff 1px, #fff 2px);"></div></div>` : ''}
                                    ${layout.qrcode ? `<div style="width: 30px; height: 30px; background: white; border: 1px solid #999; font-size: 7px; display: flex; align-items: center; justify-content: center; border-radius: 2px;">QR</div>` : ''}
                                </div>` : ''}
                                <div style="background: #1e40af; color: white; padding: 8px; text-align: center;">
                                    ${layout.logo?.ativo ? `<div style="width: 60px; height: 40px; background: rgba(255,255,255,0.2); border: 1px dashed rgba(255,255,255,0.5); display: flex; align-items: center; justify-content: center; font-size: 8px; margin: 0 auto 4px auto;">LOGO</div>` : ''}
                                    ${ce.includes('razao_social') ? `<div style="font-size: 10px; margin-bottom: 2px;">${campo('RazÃ£o Social')}</div>` : ''}
                                    ${ce.includes('nome') ? `<div>${campo('Nome Fantasia')}</div>` : ''}
                                </div>
                                <div style="background: #f3f4f6; padding: 4px; text-align: center; font-weight: bold; border-bottom: 1px solid #ddd; font-size: 10px;">
                                    FOLHA DE ROSTO
                                </div>
                                ${cp.includes('prontuario') ? `<div style="padding: 4px; background: #dbeafe;">${campo('ProntuÃ¡rio')}</div>` : ''}
                                ${cp.includes('alergias') ? `
                                <div style="padding: 4px 6px; background: #fef2f2; border-bottom: 1px solid #fecaca; display: flex; align-items: center; gap: 4px;">
                                    <span style="color: #ef4444; font-weight: bold; font-size: 8px;">âš ï¸ ALERGIAS:</span>
                                    <span style="background: #fecaca; padding: 1px 4px; border-radius: 2px; font-size: 8px; color: #991b1b;">[HPP]</span>
                                </div>` : ''}
                                <div style="padding: 6px;">
                                    <div style="font-weight: bold; background: #e5e7eb; padding: 3px; margin: -6px -6px 6px -6px; font-size: 8px;">IDENTIFICAÃ‡ÃƒO</div>
                                    <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                        ${cp.includes('nome') ? campo('Nome') : ''}
                                        ${cp.includes('nascimento') ? campo('Nascimento') : ''}
                                        ${cp.includes('sexo') ? campo('Sexo') : ''}
                                        ${cp.includes('cpf') ? campo('CPF') : ''}
                                        ${cp.includes('cns') ? campo('CNS') : ''}
                                    </div>
                                </div>
                                ${cp.includes('endereco') ? `
                                <div style="padding: 6px; border-top: 1px solid #ddd;">
                                    <div style="font-weight: bold; background: #e5e7eb; padding: 3px; margin: -6px -6px 6px -6px; font-size: 8px;">ENDEREÃ‡O</div>
                                    <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                        ${campo('CEP')} ${campo('Cidade')} ${campo('Bairro')} ${campo('Logradouro')}
                                    </div>
                                </div>` : ''}
                            </div>
                        `;
                        break;
                        
                    default: // padrao
                        html = `
                            <div style="background: white; padding: 10px; border-bottom: 2px solid #ddd; font-size: 10px; position: relative;">
                                ${(layout.qrcode || layout.barcode) ? `
                                <div style="position: absolute; top: 8px; right: 8px; display: flex; gap: 6px; align-items: start;">
                                    ${layout.barcode ? `<div style="padding: 4px 8px; background: #f3f4f6; border: 1px dashed #999; font-size: 7px; color: #666;">|||||||||||</div>` : ''}
                                    ${layout.qrcode ? `<div style="width: 40px; height: 40px; background: #f3f4f6; border: 1px dashed #999; display: flex; align-items: center; justify-content: center; font-size: 7px; color: #666;">QR</div>` : ''}
                                </div>` : ''}
                                <div style="display: flex; gap: 12px; align-items: start; ${(layout.qrcode || layout.barcode) ? 'padding-right: 100px;' : ''}">
                                    ${layout.logo?.ativo ? `<div style="width: 60px; height: 45px; background: #dbeafe; border: 1px dashed #3b82f6; display: flex; align-items: center; justify-content: center; font-size: 8px; color: #3b82f6;">LOGO</div>` : ''}
                                    <div style="flex: 1;">
                                        <div style="margin-bottom: 4px;">
                                            ${ce.includes('razao_social') ? campo('RazÃ£o Social') : ''}
                                            ${ce.includes('nome') ? campo('Nome Fantasia') : ''}
                                        </div>
                                        <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                            ${ce.includes('cnpj') ? campo('CNPJ') : ''}
                                            ${ce.includes('cnes') ? campo('CNES') : ''}
                                            ${ce.includes('endereco') ? campo('EndereÃ§o') : ''}
                                            ${ce.includes('telefone') ? campo('Telefone') : ''}
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #ddd; display: flex; gap: 6px; flex-wrap: wrap;">
                                    ${cp.includes('nome') ? campo('Paciente') : ''}
                                    ${cp.includes('prontuario') ? campo('ProntuÃ¡rio') : ''}
                                    ${cp.includes('data') ? campo('Data') : ''}
                                    ${cp.includes('idade') ? campo('Idade') : ''}
                                    ${cp.includes('sexo') ? campo('Sexo') : ''}
                                </div>
                                ${cp.includes('alergias') ? `
                                <div style="margin-top: 8px; padding: 6px 8px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 4px; display: flex; align-items: center; gap: 6px;">
                                    <span style="color: #ef4444; font-weight: bold; font-size: 10px;">âš ï¸ ALERGIAS:</span>
                                    <span style="background: #fecaca; padding: 2px 6px; border-radius: 3px; font-size: 9px; color: #991b1b;">[da avaliaÃ§Ã£o clÃ­nica]</span>
                                </div>` : ''}
                            </div>
                        `;
                }
                
                previewCabecalho.innerHTML = html;
            }
        };

        /* ============================================================
           [ELEMENTOS] MÃ³dulo de Elementos do Atendimento - v10.346
           ============================================================ */
        
        const Elementos = {
            elementos: [],
            elementoAtual: null,
            
            init() {
                console.log('ğŸ§© [Elementos] MÃ³dulo inicializado');
                this.carregar();
                this.renderizarLista();
            },
            
            carregar() {
                if (!SistemaCore.dados.elementos) {
                    SistemaCore.dados.elementos = [];
                }
                this.elementos = SistemaCore.dados.elementos;
                
                // Criar elementos padrÃ£o se nÃ£o existirem
                if (this.elementos.length === 0) {
                    this.criarElementosPadrao();
                }
            },
            
            criarElementosPadrao() {
                console.log('ğŸ§© [Elementos] Criando elementos padrÃ£o...');
                
                const elementosPadrao = [
                    // QUEIXA E HISTÃ“RIA ATUAL
                    {
                        id: 1, // v10.434: IDs simples para elementos padrÃ£o
                        codigo: 'anamnese',  // CÃ³digo fixo para referÃªncia
                        nome: 'Queixa e HistÃ³ria Atual',
                        tipo: 'anamnese',
                        descricao: 'Motivo da consulta e histÃ³ria da doenÃ§a atual',
                        htmlTemplate: `
                            <div class="secao-prontuario">
                                <div class="secao-titulo">ğŸ—£ï¸ Queixa e HistÃ³ria</div>
                                <p class="secao-subtitulo">Motivo da consulta e histÃ³ria da doenÃ§a atual</p>
                                
                                <div style="display: grid; gap: 12px;">
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Queixa Principal (QP)</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Ex: InsatisfaÃ§Ã£o com aparÃªncia abdominal pÃ³s-gestacional"></textarea>
                                    </div>
                                    
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">HistÃ³ria da DoenÃ§a Atual (HDA)</label>
                                        <textarea rows="4" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Detalhe a evoluÃ§Ã£o da queixa, fatores relacionados, tentativas prÃ©vias..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    
                    // SINAIS VITAIS E ANTROPOMETRIA
                    {
                        id: 2, // v10.434
                        codigo: 'sinais-vitais',
                        nome: 'Sinais Vitais e Antropometria',
                        tipo: 'sinais-vitais',
                        descricao: 'Medidas vitais e dados antropomÃ©tricos',
                        htmlTemplate: `
                            <div class="secao-prontuario">
                                <div class="secao-titulo">â¤ï¸ Sinais Vitais</div>
                                
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">PA (mmHg)</label>
                                        <div style="display: flex; gap: 6px; align-items: center;">
                                            <input type="number" placeholder="120" style="flex: 1; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                            <span style="font-weight: bold;">/</span>
                                            <input type="number" placeholder="80" style="flex: 1; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">FC (bpm)</label>
                                        <input type="number" placeholder="72" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">FR (irpm)</label>
                                        <input type="number" placeholder="16" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">Temp (Â°C)</label>
                                        <input type="number" step="0.1" placeholder="36.5" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">SpOâ‚‚ (%)</label>
                                        <input type="number" placeholder="98" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">GC (mg/dL)</label>
                                        <input type="number" placeholder="105" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                    </div>
                                </div>
                                
                                <div class="secao-titulo" style="font-size: 14px; margin-top: 16px;">ğŸ“ Antropometria</div>
                                
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">Peso (kg)</label>
                                        <input type="number" step="0.1" placeholder="65.5" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">Altura (cm)</label>
                                        <input type="number" placeholder="165" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">IMC</label>
                                        <input type="text" disabled placeholder="Auto" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; background: #f0f0f0; font-size: 13px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; font-weight: 600; display: block; margin-bottom: 4px;">ClassificaÃ§Ã£o</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option>Selecione...</option>
                                            <option>Baixo peso</option>
                                            <option>Normal</option>
                                            <option>Sobrepeso</option>
                                            <option>Obesidade I</option>
                                            <option>Obesidade II</option>
                                            <option>Obesidade III</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    
                    // EXAME FÃSICO GERAL
                    {
                        id: 3, // v10.434
                        codigo: 'exame-fisico',
                        nome: 'Exame FÃ­sico Geral',
                        tipo: 'exame-fisico-geral',
                        descricao: 'AvaliaÃ§Ã£o clÃ­nica sistÃªmica',
                        htmlTemplate: `
                            <div class="secao-prontuario">
                                <div class="secao-titulo">Exame FÃ­sico Geral</div>
                                
                                <div style="display: grid; gap: 12px;">
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Estado Geral</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="BEG, REG, MEG, lÃºcido, orientado..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Pele e Mucosas</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Hidratadas, coradas, anictÃ©ricas, acianÃ³ticas..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Aparelho Cardiovascular</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="RCR 2T, BNF, sem sopros..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Aparelho RespiratÃ³rio</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="MVF bilateralmente, sem RA..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Abdome</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Plano, flÃ¡cido, RHA+, indolor..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Extremidades</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Sem edemas, pulsos palpÃ¡veis..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    
                    // DIAGNÃ“STICO
                    {
                        id: 4, // v10.434
                        codigo: 'diagnostico',
                        nome: 'HipÃ³tese DiagnÃ³stica',
                        tipo: 'diagnostico',
                        descricao: 'DiagnÃ³sticos principal, secundÃ¡rios e diferenciais',
                        htmlTemplate: `
                            <div class="secao-prontuario">
                                <div class="secao-titulo">HipÃ³tese DiagnÃ³stica</div>
                                
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 150px 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">CID-10</label>
                                            <input type="text" placeholder="Ex: J18.9" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">DiagnÃ³stico Principal</label>
                                            <input type="text" placeholder="DescriÃ§Ã£o do diagnÃ³stico..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">DiagnÃ³sticos SecundÃ¡rios</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Comorbidades, outros diagnÃ³sticos..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">DiagnÃ³sticos Diferenciais</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Possibilidades a investigar..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    
                    // CONDUTA
                    {
                        id: 5, // v10.434
                        codigo: 'conduta',
                        nome: 'Conduta e Plano TerapÃªutico',
                        tipo: 'conduta',
                        descricao: 'PrescriÃ§Ãµes, exames, orientaÃ§Ãµes e encaminhamentos',
                        htmlTemplate: `
                            <div class="secao-prontuario">
                                <div class="secao-titulo">Conduta</div>
                                
                                <div style="display: grid; gap: 12px;">
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">PrescriÃ§Ã£o</label>
                                        <textarea rows="4" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Medicamentos: nome, dose, via, frequÃªncia..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Exames Solicitados</label>
                                        <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Laboratoriais, imagem, outros..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">OrientaÃ§Ãµes ao Paciente</label>
                                        <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Repouso, dieta, cuidados..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Encaminhamentos</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-family: inherit; font-size: 13px;" placeholder="Especialidades, procedimentos..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 13px; font-weight: 600; display: block; margin-bottom: 4px;">Retorno</label>
                                        <input type="text" placeholder="Ex: 7 dias, 1 mÃªs, SN" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 13px;">
                                    </div>
                                </div>
                            </div>
                        `
                    }
                ];
                
                this.elementos = elementosPadrao;
                SistemaCore.dados.elementos = this.elementos;
                SistemaCore.salvarDados();
                
                console.log(`ğŸ§© [Elementos] ${elementosPadrao.length} elementos padrÃ£o criados`);
            },
            
            renderizarLista() {
                const lista = document.getElementById('elementos-lista');
                if (!lista) return;
                
                if (this.elementos.length === 0) {
                    lista.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-light); font-size: 11px;">Nenhum elemento<br>criado ainda</div>';
                    return;
                }
                
                const icones = {
                    'anamnese': 'ğŸ—£ï¸',
                    'sinais-vitais': 'â¤ï¸',
                    'antropometria': 'ğŸ“',
                    'exame-fisico-geral': 'ğŸ©º',
                    'exame-fisico-especifico': 'ğŸ‘¤',
                    'escalas': 'ğŸ“Š',
                    'diagnostico': 'ğŸ”',
                    'conduta': 'ğŸ“',
                    'outro': 'âœ¨'
                };
                
                lista.innerHTML = this.elementos.map(elem => `
                    <div class="elemento-item" 
                         onclick="Elementos.selecionar(${elem.id})"
                         style="padding: 10px; background: ${this.elementoAtual?.id === elem.id ? 'var(--primary)' : '#f8f9fa'}; 
                                border-radius: 6px; cursor: pointer; transition: all 0.2s; border: 1px solid ${this.elementoAtual?.id === elem.id ? 'var(--primary)' : '#e5e7eb'};">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                            <span style="font-size: 16px;">${icones[elem.tipo] || 'âœ¨'}</span>
                            <strong style="font-size: 11px; color: ${this.elementoAtual?.id === elem.id ? 'white' : '#1a1a1a'}; flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${elem.nome}</strong>
                        </div>
                        <div style="font-size: 9px; color: ${this.elementoAtual?.id === elem.id ? 'rgba(255,255,255,0.9)' : '#999'};">
                            ${elem.campos?.length || 0} campos
                        </div>
                    </div>
                `).join('');
            },
            
            novo() {
                this.elementoAtual = {
                    id: SistemaCore.proximoId(SistemaCore.dados.elementos || []),
                    nome: '',
                    tipo: 'anamnese',
                    campos: []
                };
                this.mostrarEditor();
                this.preencherFormulario();
                this.renderizarPreview();
            },
            
            selecionar(id) {
                this.elementoAtual = this.elementos.find(e => e.id === id);
                if (this.elementoAtual) {
                    this.renderizarLista();
                    this.mostrarEditor();
                    this.preencherFormulario();
                    this.renderizarPreview();
                }
            },
            
            mostrarEditor() {
                document.getElementById('elementos-editor-vazio').style.display = 'none';
                document.getElementById('elementos-editor-form').style.display = 'block';
            },
            
            preencherFormulario() {
                if (!this.elementoAtual) return;
                
                document.getElementById('elem-nome').value = this.elementoAtual.nome;
                document.getElementById('elem-tipo').value = this.elementoAtual.tipo;
                
                this.renderizarCampos();
            },
            
            renderizarCampos() {
                const lista = document.getElementById('elem-campos-lista');
                if (!lista) return;
                
                if (!this.elementoAtual.campos || this.elementoAtual.campos.length === 0) {
                    lista.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-light); font-size: 11px;">Nenhum campo adicionado<br>Clique em "Adicionar Campo"</div>';
                    return;
                }
                
                lista.innerHTML = this.elementoAtual.campos.map((campo, idx) => `
                    <div class="campo-editor" style="background: #f8f9fa; padding: 12px; border-radius: 6px; border: 1px solid #e5e7eb;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                            <strong style="font-size: 11px; color: #666;">Campo ${idx + 1}</strong>
                            <button onclick="Elementos.removerCampo(${idx})" style="background: #fee; color: #c00; border: none; padding: 2px 8px; border-radius: 4px; cursor: pointer; font-size: 10px;">ğŸ—‘ï¸</button>
                        </div>
                        
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <div>
                                <label style="font-size: 10px; color: #666; display: block; margin-bottom: 4px;">Tipo:</label>
                                <select onchange="Elementos.atualizarCampo(${idx}, 'tipo', this.value); Elementos.renderizarCampos();" style="width: 100%; font-size: 11px; padding: 6px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="input" ${campo.tipo === 'input' ? 'selected' : ''}>Texto curto</option>
                                    <option value="textarea" ${campo.tipo === 'textarea' ? 'selected' : ''}>Texto longo</option>
                                    <option value="select" ${campo.tipo === 'select' ? 'selected' : ''}>SeleÃ§Ã£o (dropdown)</option>
                                    <option value="checkbox" ${campo.tipo === 'checkbox' ? 'selected' : ''}>Checkbox</option>
                                    <option value="radio" ${campo.tipo === 'radio' ? 'selected' : ''}>Radio button</option>
                                    <option value="number" ${campo.tipo === 'number' ? 'selected' : ''}>NÃºmero</option>
                                    <option value="date" ${campo.tipo === 'date' ? 'selected' : ''}>Data</option>
                                    <option value="conditional" ${campo.tipo === 'conditional' ? 'selected' : ''}>ğŸ”€ Condicional (mostra/esconde)</option>
                                    <option value="pool" ${campo.tipo === 'pool' ? 'selected' : ''}>â• Pool dinÃ¢mico (adicionar itens)</option>
                                    <option value="compound" ${campo.tipo === 'compound' ? 'selected' : ''}>ğŸ”— Composto (2 campos juntos)</option>
                                </select>
                            </div>
                            
                            <div>
                                <label style="font-size: 10px; color: #666; display: block; margin-bottom: 4px;">Label:</label>
                                <input type="text" value="${campo.label || ''}" onchange="Elementos.atualizarCampo(${idx}, 'label', this.value)" style="width: 100%; font-size: 11px; padding: 6px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Ex: Queixa Principal">
                            </div>
                            
                            <div>
                                <label style="font-size: 10px; color: #666; display: block; margin-bottom: 4px;">Placeholder:</label>
                                <input type="text" value="${campo.placeholder || ''}" onchange="Elementos.atualizarCampo(${idx}, 'placeholder', this.value)" style="width: 100%; font-size: 11px; padding: 6px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Texto de ajuda...">
                            </div>
                            
                            ${campo.tipo === 'select' || campo.tipo === 'radio' || campo.tipo === 'conditional' ? `
                            <div>
                                <label style="font-size: 10px; color: #666; display: block; margin-bottom: 4px;">OpÃ§Ãµes (separadas por vÃ­rgula):</label>
                                <input type="text" value="${(campo.opcoes || []).join(', ')}" onchange="Elementos.atualizarCampo(${idx}, 'opcoes', this.value.split(',').map(o => o.trim()))" style="width: 100%; font-size: 11px; padding: 6px; border: 1px solid #ddd; border-radius: 4px;" placeholder="OpÃ§Ã£o 1, OpÃ§Ã£o 2, OpÃ§Ã£o 3">
                            </div>
                            ` : ''}
                            
                            ${campo.tipo === 'pool' ? `
                            <div>
                                <label style="font-size: 10px; color: #666; display: block; margin-bottom: 4px;">Nome do pool:</label>
                                <input type="text" value="${campo.poolName || ''}" onchange="Elementos.atualizarCampo(${idx}, 'poolName', this.value)" style="width: 100%; font-size: 11px; padding: 6px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Ex: alergias, cirurgias">
                            </div>
                            ` : ''}
                            
                            ${campo.tipo === 'compound' ? `
                            <div>
                                <label style="font-size: 10px; color: #666; display: block; margin-bottom: 4px;">Campos (separados por vÃ­rgula):</label>
                                <input type="text" value="${(campo.subCampos || []).join(', ')}" onchange="Elementos.atualizarCampo(${idx}, 'subCampos', this.value.split(',').map(o => o.trim()))" style="width: 100%; font-size: 11px; padding: 6px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Campo 1, Campo 2">
                            </div>
                            ` : ''}
                        </div>
                    </div>
                `).join('');
            },
            
            adicionarCampo() {
                if (!this.elementoAtual) return;
                
                if (!this.elementoAtual.campos) {
                    this.elementoAtual.campos = [];
                }
                
                this.elementoAtual.campos.push({
                    tipo: 'input',
                    label: '',
                    placeholder: '',
                    opcoes: []
                });
                
                this.renderizarCampos();
                this.renderizarPreview();
            },
            
            removerCampo(idx) {
                if (!this.elementoAtual) return;
                this.elementoAtual.campos.splice(idx, 1);
                this.renderizarCampos();
                this.renderizarPreview();
            },
            
            atualizarCampo(idx, propriedade, valor) {
                if (!this.elementoAtual) return;
                this.elementoAtual.campos[idx][propriedade] = valor;
                this.renderizarPreview();
            },
            
            renderizarPreview() {
                const previewVazio = document.getElementById('elementos-preview-vazio');
                const previewContainer = document.getElementById('elementos-preview-container');
                const previewConteudo = document.getElementById('elementos-preview-conteudo');
                
                if (!this.elementoAtual || !previewConteudo) {
                    if (previewVazio) previewVazio.style.display = 'block';
                    if (previewContainer) previewContainer.style.display = 'none';
                    return;
                }
                
                // Atualizar nome e tipo
                const nome = document.getElementById('elem-nome')?.value || 'Elemento sem nome';
                this.elementoAtual.nome = nome;
                
                const tipo = document.getElementById('elem-tipo')?.value || this.elementoAtual.tipo;
                this.elementoAtual.tipo = tipo;
                
                if (previewVazio) previewVazio.style.display = 'none';
                if (previewContainer) previewContainer.style.display = 'block';
                
                const icones = {
                    'anamnese': 'ğŸ—£ï¸',
                    'sinais-vitais': 'â¤ï¸',
                    'antropometria': 'ğŸ“',
                    'exame-fisico-geral': 'ğŸ©º',
                    'exame-fisico-especifico': 'ğŸ‘¤',
                    'escalas': 'ğŸ“Š',
                    'diagnostico': 'ğŸ”',
                    'conduta': 'ğŸ“',
                    'outro': 'âœ¨'
                };
                
                let html = `
                    <div style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 2px solid #ddd;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 24px;">${icones[tipo] || 'âœ¨'}</span>
                            <strong style="font-size: 14px; color: #1a1a1a;">${nome}</strong>
                        </div>
                        ${this.elementoAtual.descricao ? `<div style="font-size: 11px; color: #666; margin-top: 4px;">${this.elementoAtual.descricao}</div>` : ''}
                    </div>
                `;
                
                // Se tem htmlTemplate, renderiza ele (zoom 70% para caber)
                if (this.elementoAtual.htmlTemplate) {
                    html += `
                        <div style="transform: scale(0.7); transform-origin: top left; width: 142.86%; height: auto; overflow: hidden;">
                            ${this.elementoAtual.htmlTemplate}
                        </div>
                    `;
                } else if (!this.elementoAtual.campos || this.elementoAtual.campos.length === 0) {
                    // Elemento sem template e sem campos
                    html += '<div style="text-align: center; padding: 30px; color: #999; font-size: 11px;">Adicione campos ou HTML template</div>';
                } else {
                    // Renderizar baseado em campos (legado)
                    html += '<div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">';
                    
                    this.elementoAtual.campos.forEach(campo => {
                        const fullWidth = campo.tipo === 'textarea' || campo.tipo === 'conditional' || campo.tipo === 'pool';
                        html += `<div style="${fullWidth ? 'grid-column: 1 / -1;' : ''}">`;
                        html += `<label style="font-size: 11px; font-weight: 600; color: #444; display: block; margin-bottom: 4px;">${campo.label || 'Campo sem label'}</label>`;
                        
                        switch(campo.tipo) {
                            case 'textarea':
                                html += `<div style="min-height: 60px; background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 8px; font-size: 11px; color: #999;">${campo.placeholder || ''}</div>`;
                                break;
                            case 'select':
                                html += `<div style="background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 8px; font-size: 11px; color: #666;">â–¼ Selecione...</div>`;
                                break;
                            case 'checkbox':
                                html += `<div style="display: flex; align-items: center; gap: 6px; font-size: 11px;"><input type="checkbox" style="width: auto;"> <span style="color: #666;">${campo.placeholder || 'OpÃ§Ã£o'}</span></div>`;
                                break;
                            case 'radio':
                                html += `<div style="display: flex; align-items: center; gap: 6px; font-size: 11px;"><input type="radio" style="width: auto;"> <span style="color: #666;">${campo.placeholder || 'OpÃ§Ã£o'}</span></div>`;
                                break;
                            case 'conditional':
                                html += `
                                    <div style="background: #f9fafb; border: 2px solid #ffc107; border-radius: 6px; padding: 12px;">
                                        <div style="background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 8px; font-size: 11px; color: #666; margin-bottom: 8px;">â–¼ ${campo.opcoes?.[0] || 'OpÃ§Ã£o 1'} / ${campo.opcoes?.[1] || 'OpÃ§Ã£o 2'}</div>
                                        <div style="padding: 8px; background: rgba(255,255,255,0.7); border-radius: 4px; font-size: 10px; color: #856404;">
                                            ğŸ”€ <strong>Condicional:</strong> Ao selecionar mostra/esconde campos
                                        </div>
                                    </div>`;
                                break;
                            case 'pool':
                                html += `
                                    <div style="background: #d1ecf1; border: 2px solid #17a2b8; border-radius: 6px; padding: 12px;">
                                        <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                            <div style="flex: 1; background: white; padding: 8px; border-radius: 4px; font-size: 10px; color: #999; text-align: center;">Item 1</div>
                                            <div style="flex: 1; background: white; padding: 8px; border-radius: 4px; font-size: 10px; color: #999; text-align: center;">Item 2</div>
                                        </div>
                                        <button style="width: 100%; padding: 6px; background: #17a2b8; color: white; border: none; border-radius: 4px; font-size: 10px; cursor: pointer;">â• Adicionar ${campo.poolName || 'item'}</button>
                                        <div style="margin-top: 6px; padding: 6px; background: rgba(255,255,255,0.7); border-radius: 4px; font-size: 9px; color: #0c5460;">
                                            â• <strong>Pool dinÃ¢mico:</strong> Lista que cresce ao adicionar itens
                                        </div>
                                    </div>`;
                                break;
                            case 'compound':
                                html += `
                                    <div style="background: #e7f3ff; border: 2px solid #2196f3; border-radius: 6px; padding: 10px;">
                                        <div style="display: flex; gap: 8px;">
                                            ${(campo.subCampos || ['Campo 1', 'Campo 2']).map(sc => 
                                                `<div style="flex: 1; background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 8px; font-size: 10px; color: #999; text-align: center;">${sc}</div>`
                                            ).join('')}
                                        </div>
                                        <div style="margin-top: 6px; padding: 6px; background: rgba(255,255,255,0.7); border-radius: 4px; font-size: 9px; color: #0d47a1;">
                                            ğŸ”— <strong>Campo composto:</strong> MÃºltiplos inputs juntos (ex: quantidade + unidade)
                                        </div>
                                    </div>`;
                                break;
                            default: // input, number, date
                                html += `<div style="background: white; border: 1px solid #e0e0e0; border-radius: 6px; padding: 8px; font-size: 11px; color: #999;">${campo.placeholder || ''}</div>`;
                        }
                        
                        html += '</div>';
                    });
                    
                    html += '</div>';
                }
                
                previewConteudo.innerHTML = html;
            },
            
            salvar() {
                if (!this.elementoAtual) {
                    Sistema.notificar('âŒ Nenhum elemento selecionado', 'erro');
                    return;
                }
                
                // Coletar dados do formulÃ¡rio
                this.elementoAtual.nome = document.getElementById('elem-nome').value.trim();
                this.elementoAtual.tipo = document.getElementById('elem-tipo').value;
                
                if (!this.elementoAtual.nome) {
                    Sistema.notificar('âŒ Digite um nome para o elemento', 'erro');
                    return;
                }
                
                if (!this.elementoAtual.campos || this.elementoAtual.campos.length === 0) {
                    Sistema.notificar('âŒ Adicione pelo menos um campo', 'erro');
                    return;
                }
                
                // Verificar se Ã© novo ou ediÃ§Ã£o
                const index = this.elementos.findIndex(e => e.id === this.elementoAtual.id);
                
                if (index !== -1) {
                    // Atualizar existente
                    this.elementos[index] = { ...this.elementoAtual };
                    Sistema.notificar('âœ… Elemento atualizado!', 'sucesso');
                } else {
                    // Adicionar novo
                    this.elementos.push({ ...this.elementoAtual });
                    Sistema.notificar('âœ… Elemento criado!', 'sucesso');
                }
                
                // Salvar no localStorage
                SistemaCore.dados.elementos = this.elementos;
                SistemaCore.salvarDados();
                
                this.renderizarLista();
            },
            
            cancelar() {
                this.elementoAtual = null;
                document.getElementById('elementos-editor-form').style.display = 'none';
                document.getElementById('elementos-editor-vazio').style.display = 'block';
                document.getElementById('elementos-preview-container').style.display = 'none';
                document.getElementById('elementos-preview-vazio').style.display = 'block';
                this.renderizarLista();
            },
            
            excluir(id) {
                if (!confirm('Tem certeza que deseja excluir este elemento?')) return;
                
                this.elementos = this.elementos.filter(e => e.id !== id);
                SistemaCore.dados.elementos = this.elementos;
                SistemaCore.salvarDados();
                
                if (this.elementoAtual?.id === id) {
                    this.cancelar();
                }
                
                this.renderizarLista();
                Sistema.notificar('âœ… Elemento excluÃ­do!', 'sucesso');
            },
            
            listar() {
                this.renderizarLista();
            }
        };

        /* ============================================================
           [EDITOR VISUAL] MÃ³dulo Editor Visual de Documentos - v10.11.0
           ============================================================ */
        
        const EditorVisual = {
            tipoAtual: 'folha-rosto-emergencia',
            
            init() {
                console.log('ğŸ¨ [EditorVisual] MÃ³dulo inicializado');
                this.carregarConfiguracao();
                this.configurarEventos();
                this.atualizarPreview();
            },
            
            configurarEventos() {
                // Evento para mostrar/ocultar opÃ§Ãµes de QR Code
                const qrcodeCheckbox = document.getElementById('editor-qrcode-ativo');
                if (qrcodeCheckbox) {
                    qrcodeCheckbox.addEventListener('change', () => {
                        const opcoes = document.getElementById('editor-qrcode-opcoes');
                        opcoes.style.display = qrcodeCheckbox.checked ? 'block' : 'none';
                    });
                }
                
                // Evento para mostrar/ocultar opÃ§Ãµes de Barcode
                const barcodeCheckbox = document.getElementById('editor-barcode-ativo');
                if (barcodeCheckbox) {
                    barcodeCheckbox.addEventListener('change', () => {
                        const opcoes = document.getElementById('editor-barcode-opcoes');
                        opcoes.style.display = barcodeCheckbox.checked ? 'block' : 'none';
                    });
                }
            },
            
            trocarTipoDocumento() {
                const select = document.getElementById('editor-tipo-documento');
                this.tipoAtual = select.value;
                
                // Mostrar/ocultar seÃ§Ã£o Manchester
                const secaoManchester = document.getElementById('editor-secao-manchester');
                if (this.tipoAtual === 'folha-rosto-emergencia') {
                    secaoManchester.style.display = 'block';
                } else {
                    secaoManchester.style.display = 'none';
                }
                
                this.carregarConfiguracao();
                this.atualizarPreview();
            },
            
            carregarConfiguracao() {
                if (!SistemaCore.dados.editorVisual) {
                    SistemaCore.dados.editorVisual = {};
                }
                
                const config = SistemaCore.dados.editorVisual[this.tipoAtual] || {};
                
                // Carregar logo
                if (config.logoUrl) {
                    document.getElementById('editor-logo-url').value = config.logoUrl;
                }
                if (config.logoTamanho) {
                    document.getElementById('editor-logo-tamanho').value = config.logoTamanho;
                }
                if (config.logoPosicao) {
                    document.getElementById('editor-logo-posicao').value = config.logoPosicao;
                }
                
                // Carregar textos
                if (config.textoLinha1) {
                    document.getElementById('editor-texto-linha1').value = config.textoLinha1;
                }
                if (config.textoLinha2) {
                    document.getElementById('editor-texto-linha2').value = config.textoLinha2;
                }
                if (config.textoTitulo) {
                    document.getElementById('editor-texto-titulo').value = config.textoTitulo;
                }
                
                // Carregar barcode
                if (config.barcodeAtivo !== undefined) {
                    document.getElementById('editor-barcode-ativo').checked = config.barcodeAtivo;
                }
                if (config.barcodePosicao) {
                    document.getElementById('editor-barcode-posicao').value = config.barcodePosicao;
                }
                if (config.barcodeTipo) {
                    document.getElementById('editor-barcode-tipo').value = config.barcodeTipo;
                }
                
                // Carregar QR Code
                if (config.qrcodeAtivo !== undefined) {
                    document.getElementById('editor-qrcode-ativo').checked = config.qrcodeAtivo;
                    document.getElementById('editor-qrcode-opcoes').style.display = config.qrcodeAtivo ? 'block' : 'none';
                }
                if (config.qrcodePosicao) {
                    document.getElementById('editor-qrcode-posicao').value = config.qrcodePosicao;
                }
                if (config.qrcodeTamanho) {
                    document.getElementById('editor-qrcode-tamanho').value = config.qrcodeTamanho;
                }
                
                // Carregar Manchester
                if (config.manchesterAtivo !== undefined) {
                    document.getElementById('editor-manchester-ativo').checked = config.manchesterAtivo;
                }
                
                // Carregar estilo
                if (config.estiloLayout) {
                    document.getElementById('editor-estilo-layout').value = config.estiloLayout;
                }
                
                // Carregar assinatura
                if (config.assinaturaAtiva !== undefined) {
                    document.getElementById('editor-assinatura-ativa').checked = config.assinaturaAtiva;
                }
            },
            
            recarregarLogo() {
                const url = document.getElementById('editor-logo-url').value;
                if (!url) {
                    Sistema.notificar('âš ï¸ Digite uma URL primeiro!', 'warning');
                    return;
                }
                this.atualizarPreview();
                Sistema.notificar('ğŸ”„ Logo recarregada!');
            },
            
            atualizarPreview() {
                const previewElement = document.getElementById('editor-preview-documento');
                if (!previewElement) {
                    // Elemento nÃ£o existe nesta aba - silenciosamente ignorar
                    return;
                }
                const config = this.obterConfiguracao();
                const html = this.gerarPreviewHTML(config);
                previewElement.innerHTML = html;
            },
            
            obterConfiguracao() {
                return {
                    // Logo
                    logoUrl: document.getElementById('editor-logo-url')?.value || '',
                    logoTamanho: document.getElementById('editor-logo-tamanho')?.value || 'medio',
                    logoPosicao: document.getElementById('editor-logo-posicao')?.value || 'esquerda',
                    
                    // Textos
                    textoLinha1: document.getElementById('editor-texto-linha1')?.value || '',
                    textoLinha2: document.getElementById('editor-texto-linha2')?.value || '',
                    textoTitulo: document.getElementById('editor-texto-titulo')?.value || '',
                    
                    // Barcode
                    barcodeAtivo: document.getElementById('editor-barcode-ativo')?.checked || false,
                    barcodePosicao: document.getElementById('editor-barcode-posicao')?.value || 'inferior-direita',
                    barcodeTipo: document.getElementById('editor-barcode-tipo')?.value || 'code128',
                    
                    // QR Code
                    qrcodeAtivo: document.getElementById('editor-qrcode-ativo')?.checked || false,
                    qrcodePosicao: document.getElementById('editor-qrcode-posicao')?.value || 'inferior-direita',
                    qrcodeTamanho: document.getElementById('editor-qrcode-tamanho')?.value || 'medio',
                    
                    // Manchester
                    manchesterAtivo: document.getElementById('editor-manchester-ativo')?.checked || false,
                    
                    // Campos
                    campos: {
                        nome: document.getElementById('campo-nome')?.checked || false,
                        prontuario: document.getElementById('campo-prontuario')?.checked || false,
                        nascimento: document.getElementById('campo-nascimento')?.checked || false,
                        idade: document.getElementById('campo-idade')?.checked || false,
                        sexo: document.getElementById('campo-sexo')?.checked || false,
                        cpf: document.getElementById('campo-cpf')?.checked || false,
                        cns: document.getElementById('campo-cns')?.checked || false,
                        estadoCivil: document.getElementById('campo-estado-civil')?.checked || false,
                        corRaca: document.getElementById('campo-cor-raca')?.checked || false,
                        naturalidade: document.getElementById('campo-naturalidade')?.checked || false,
                        mae: document.getElementById('campo-mae')?.checked || false,
                        pai: document.getElementById('campo-pai')?.checked || false,
                        endereco: document.getElementById('campo-endereco')?.checked || false,
                        telefone: document.getElementById('campo-telefone')?.checked || false,
                        convenio: document.getElementById('campo-convenio')?.checked || false
                    },
                    
                    // Layout
                    estiloLayout: document.getElementById('editor-estilo-layout')?.value || 'moderno',
                    assinaturaAtiva: document.getElementById('editor-assinatura-ativa')?.checked || false
                };
            },
            
            gerarPreviewHTML(config) {
                const tamanhoLogo = config.logoTamanho === 'pequeno' ? '60px' : 
                                   config.logoTamanho === 'grande' ? '120px' : '90px';
                
                const tamanhoQR = config.qrcodeTamanho === 'pequeno' ? '60px' :
                                 config.qrcodeTamanho === 'grande' ? '100px' : '80px';
                
                const exemplo = {
                    nome: 'JOSÃ‰ ORLANDO BARBOSA',
                    prontuario: '956726',
                    nascimento: '18/07/1961',
                    idade: '64 anos',
                    sexo: 'MASCULINO',
                    cpf: '016.733.XXX-XX',
                    cns: '706 4011 6925 5582',
                    estadoCivil: 'Casado',
                    corRaca: 'Parda',
                    naturalidade: 'AbaetÃ© - MG',
                    mae: 'CONCEIÃ‡ÃƒO DE SOUSA LIMA',
                    pai: 'VALDEMAR VICENTE BARBOSA',
                    endereco: 'Rua Francisco Campos, 510 - SÃ£o JoÃ£o - AbaetÃ©/MG - CEP: 35620-000',
                    telefone: '(37) 99958-8885',
                    convenio: 'SUS'
                };
                
                let html = '';
                
                // CABEÃ‡ALHO
                html += '<table style="width: 100%; border-collapse: collapse; border: 1px solid #000; margin-bottom: 0;">';
                
                // Linha do cabeÃ§alho com logo
                html += '<tr>';
                
                // Logo (se tiver)
                if (config.logoUrl) {
                    const alinhamento = config.logoPosicao === 'centro' ? 'center' : 
                                       config.logoPosicao === 'direita' ? 'right' : 'left';
                    html += `
                        <td rowspan="2" style="border: 1px solid #000; padding: 8px; width: ${tamanhoLogo}; text-align: ${alinhamento}; vertical-align: middle;">
                            <img src="${config.logoUrl}" style="max-width: ${tamanhoLogo}; max-height: ${tamanhoLogo};" 
                                 onerror="this.style.display='none'">
                        </td>
                    `;
                }
                
                // Textos Institucionais
                html += `
                    <td style="border: 1px solid #000; padding: 8px; text-align: center; vertical-align: middle;">
                        <div style="font-weight: bold; font-size: 11px; line-height: 1.4;">
                            ${config.textoLinha1}
                            ${config.textoLinha2 ? '<br>' + config.textoLinha2 : ''}
                        </div>
                    </td>
                `;
                
                // Barcode no cabeÃ§alho direita
                if (config.barcodeAtivo && config.barcodePosicao === 'cabecalho-direita') {
                    html += `
                        <td rowspan="2" style="border: 1px solid #000; padding: 8px; width: 150px; text-align: right; vertical-align: middle;">
                            <div style="font-size: 9px; margin-bottom: 4px;">
                                ${config.barcodeTipo === 'prontuario' ? 'PRONTUÃRIO' : 
                                  config.barcodeTipo === 'registro' ? 'REGISTRO' : 'PRONTUÃRIO/REGISTRO'}
                            </div>
                            <svg width="120" height="40" style="display: block;">
                                <rect width="3" height="40" x="0" fill="#000"/>
                                <rect width="1" height="40" x="5" fill="#000"/>
                                <rect width="3" height="40" x="8" fill="#000"/>
                                <rect width="1" height="40" x="13" fill="#000"/>
                                <rect width="2" height="40" x="16" fill="#000"/>
                                <rect width="3" height="40" x="20" fill="#000"/>
                                <rect width="1" height="40" x="25" fill="#000"/>
                                <rect width="2" height="40" x="28" fill="#000"/>
                                <rect width="3" height="40" x="32" fill="#000"/>
                                <rect width="1" height="40" x="37" fill="#000"/>
                                <rect width="2" height="40" x="40" fill="#000"/>
                                <rect width="3" height="40" x="44" fill="#000"/>
                                <rect width="1" height="40" x="49" fill="#000"/>
                                <rect width="3" height="40" x="52" fill="#000"/>
                                <rect width="1" height="40" x="57" fill="#000"/>
                                <rect width="2" height="40" x="60" fill="#000"/>
                                <rect width="3" height="40" x="64" fill="#000"/>
                                <rect width="1" height="40" x="69" fill="#000"/>
                                <rect width="2" height="40" x="72" fill="#000"/>
                                <rect width="3" height="40" x="76" fill="#000"/>
                                <rect width="1" height="40" x="81" fill="#000"/>
                                <rect width="2" height="40" x="84" fill="#000"/>
                                <rect width="3" height="40" x="88" fill="#000"/>
                                <rect width="1" height="40" x="93" fill="#000"/>
                                <rect width="3" height="40" x="96" fill="#000"/>
                                <rect width="1" height="40" x="101" fill="#000"/>
                                <rect width="2" height="40" x="104" fill="#000"/>
                                <rect width="3" height="40" x="108" fill="#000"/>
                                <rect width="1" height="40" x="113" fill="#000"/>
                                <rect width="3" height="40" x="116" fill="#000"/>
                            </svg>
                            <div style="font-size: 9px; margin-top: 2px;">${exemplo.prontuario}</div>
                        </td>
                    `;
                }
                
                html += '</tr>';
                
                // TÃ­tulo do Documento
                html += `
                    <tr>
                        <td style="border: 1px solid #000; padding: 8px; background: #e0e0e0; text-align: center; font-weight: bold; font-size: 12px;">
                            ${config.textoTitulo}
                        </td>
                    </tr>
                `;
                
                // Manchester (se ativo e for emergÃªncia)
                if (config.manchesterAtivo && this.tipoAtual === 'folha-rosto-emergencia') {
                    html += `
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 8px; background: #ef4444; color: white; text-align: center; font-weight: bold;">
                                ğŸš¨ CLASSIFICAÃ‡ÃƒO MANCHESTER: VERMELHO - EMERGÃŠNCIA
                            </td>
                        </tr>
                    `;
                }
                
                // IDENTIFICAÃ‡ÃƒO DO PACIENTE
                html += `
                    <tr>
                        <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 6px; background: #d0d0d0; font-weight: bold;">
                            IDENTIFICAÃ‡ÃƒO DO PACIENTE
                        </td>
                    </tr>
                `;
                
                // Campos do paciente
                if (config.campos.nome) {
                    html += `
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 4px;">
                                <strong>USUÃRIO:</strong> ${exemplo.nome}
                            </td>
                        </tr>
                    `;
                }
                
                if (config.campos.prontuario) {
                    html += `
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 4px;">
                                <strong>PRONTUÃRIO:</strong> ${exemplo.prontuario}
                            </td>
                        </tr>
                    `;
                }
                
                // Linha com Nascimento e CNS
                if (config.campos.nascimento || config.campos.cns) {
                    html += '<tr>';
                    if (config.campos.nascimento) {
                        html += `
                            <td ${config.campos.cns ? '' : `colspan="${config.logoUrl ? '3' : '2'}"`} style="border: 1px solid #000; padding: 4px;">
                                <strong>DATA NASCIMENTO:</strong> ${exemplo.nascimento}
                            </td>
                        `;
                    }
                    if (config.campos.cns) {
                        html += `
                            <td ${config.campos.nascimento ? '' : `colspan="${config.logoUrl ? '3' : '2'}"`} style="border: 1px solid #000; padding: 4px;">
                                <strong>CNS:</strong> ${exemplo.cns}
                            </td>
                        `;
                    }
                    html += '</tr>';
                }
                
                // Linha com Idade e Sexo
                if (config.campos.idade || config.campos.sexo) {
                    html += '<tr>';
                    if (config.campos.idade) {
                        html += `
                            <td ${config.campos.sexo ? '' : `colspan="${config.logoUrl ? '3' : '2'}"`} style="border: 1px solid #000; padding: 4px;">
                                <strong>IDADE:</strong> ${exemplo.idade}
                            </td>
                        `;
                    }
                    if (config.campos.sexo) {
                        html += `
                            <td ${config.campos.idade ? '' : `colspan="${config.logoUrl ? '3' : '2'}"`} style="border: 1px solid #000; padding: 4px;">
                                <strong>SEXO:</strong> ${exemplo.sexo}
                            </td>
                        `;
                    }
                    html += '</tr>';
                }
                
                // Estado Civil
                if (config.campos.estadoCivil) {
                    html += `
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 4px;">
                                <strong>ESTADO CIVIL:</strong> ${exemplo.estadoCivil}
                            </td>
                        </tr>
                    `;
                }
                
                // Linha com CPF e Cor/RaÃ§a
                if (config.campos.cpf || config.campos.corRaca) {
                    html += '<tr>';
                    if (config.campos.cpf) {
                        html += `
                            <td ${config.campos.corRaca ? '' : `colspan="${config.logoUrl ? '3' : '2'}"`} style="border: 1px solid #000; padding: 4px;">
                                <strong>CPF:</strong> ${exemplo.cpf}
                            </td>
                        `;
                    }
                    if (config.campos.corRaca) {
                        html += `
                            <td ${config.campos.cpf ? '' : `colspan="${config.logoUrl ? '3' : '2'}"`} style="border: 1px solid #000; padding: 4px;">
                                <strong>COR/RAÃ‡A:</strong> ${exemplo.corRaca}
                            </td>
                        `;
                    }
                    html += '</tr>';
                }
                
                if (config.campos.naturalidade) {
                    html += `
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 4px;">
                                <strong>NATURALIDADE:</strong> ${exemplo.naturalidade}
                            </td>
                        </tr>
                    `;
                }
                
                if (config.campos.mae) {
                    html += `
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 4px;">
                                <strong>NOME DA MÃƒE:</strong> ${exemplo.mae}
                            </td>
                        </tr>
                    `;
                }
                
                if (config.campos.pai) {
                    html += `
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 4px;">
                                <strong>NOME DO PAI:</strong> ${exemplo.pai}
                            </td>
                        </tr>
                    `;
                }
                
                if (config.campos.endereco) {
                    html += `
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 6px; background: #d0d0d0; font-weight: bold;">
                                ENDEREÃ‡O DO PACIENTE
                            </td>
                        </tr>
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 4px;">
                                ${exemplo.endereco}
                            </td>
                        </tr>
                    `;
                }
                
                if (config.campos.telefone || config.campos.convenio) {
                    html += `
                        <tr>
                            <td colspan="${config.logoUrl ? '3' : '2'}" style="border: 1px solid #000; padding: 6px; background: #d0d0d0; font-weight: bold;">
                                CONTATO
                            </td>
                        </tr>
                        <tr>
                    `;
                    if (config.campos.telefone) {
                        html += `
                            <td style="border: 1px solid #000; padding: 4px;">
                                <strong>TELEFONE:</strong> ${exemplo.telefone}
                            </td>
                        `;
                    }
                    if (config.campos.convenio) {
                        html += `
                            <td colspan="${config.campos.telefone ? '1' : config.logoUrl ? '2' : '1'}" style="border: 1px solid #000; padding: 4px;">
                                <strong>CONVÃŠNIO:</strong> ${exemplo.convenio}
                            </td>
                        `;
                    }
                    html += '</tr>';
                }
                
                html += '</table>';
                
                // RODAPÃ‰
                if (config.assinaturaAtiva || (config.qrcodeAtivo && config.qrcodePosicao.includes('rodape')) || 
                    (config.barcodeAtivo && config.barcodePosicao.includes('rodape'))) {
                    html += '<div style="margin-top: 40px; display: flex; justify-content: space-between; align-items: flex-end;">';
                    
                    if (config.assinaturaAtiva) {
                        html += `
                            <div style="flex: 1;">
                                <div style="border-top: 1px solid #000; width: 250px; margin-top: 60px;"></div>
                                <div style="font-size: 10px; margin-top: 4px;">Assinatura do Profissional</div>
                            </div>
                        `;
                    }
                    
                    if (config.qrcodeAtivo && config.qrcodePosicao.includes('rodape')) {
                        html += `
                            <div style="text-align: right;">
                                <svg width="${tamanhoQR}" height="${tamanhoQR}" style="border: 1px solid #ddd;">
                                    <rect width="${tamanhoQR}" height="${tamanhoQR}" fill="white"/>
                                    ${this.gerarPatternQRCode(tamanhoQR)}
                                </svg>
                                <div style="font-size: 9px; margin-top: 2px;">QR Code</div>
                            </div>
                        `;
                    }
                    
                    html += '</div>';
                }
                
                return html;
            },
            
            gerarPatternQRCode(tamanho) {
                // Gera um pattern simples de QR Code para preview
                let svg = '';
                const tam = parseInt(tamanho);
                const quadrado = Math.floor(tam / 8);
                
                for (let i = 0; i < 8; i++) {
                    for (let j = 0; j < 8; j++) {
                        if (Math.random() > 0.5) {
                            svg += `<rect x="${j * quadrado}" y="${i * quadrado}" width="${quadrado}" height="${quadrado}" fill="#000"/>`;
                        }
                    }
                }
                return svg;
            },
            
            salvarConfiguracao() {
                const config = this.obterConfiguracao();
                
                if (!SistemaCore.dados.editorVisual) {
                    SistemaCore.dados.editorVisual = {};
                }
                
                SistemaCore.dados.editorVisual[this.tipoAtual] = config;
                SistemaCore.salvar();
                
                Sistema.notificar('âœ… ConfiguraÃ§Ã£o salva com sucesso!');
            }
        };


        /* ============================================================
           [CUSTOM DOC SUBABAS] Controle de Subabas de CustomizaÃ§Ã£o - v10.11.1
           ============================================================ */
        
        const CustomDocSubabas = {
            trocar(subaba) {
                // Desativar todas as subabas
                document.querySelectorAll('#gestao-aba-configuracoes .sub-tab').forEach(tab => {
                    tab.style.borderBottom = '3px solid transparent';
                    tab.style.color = 'var(--text-light)';
                    tab.classList.remove('active');
                });
                
                document.querySelectorAll('.customdoc-subaba-content').forEach(content => {
                    content.style.display = 'none';
                });
                
                // Ativar subaba selecionada
                const botao = document.getElementById(`subaba-${subaba}`);
                const conteudo = document.getElementById(`customdoc-subaba-${subaba}`);
                
                if (botao && conteudo) {
                    botao.style.borderBottom = '3px solid var(--primary)';
                    botao.style.color = 'var(--primary)';
                    botao.classList.add('active');
                    conteudo.style.display = 'block';
                    
                    // v10.346: Recarregar dados ao abrir cada subaba
                    if (subaba === 'sandbox' && typeof Sandbox !== 'undefined') {
                        // ForÃ§ar reload dos dados do localStorage
                        SistemaCore.carregarDados();
                        Sandbox.carregarModelos();
                        Sandbox.carregarLayoutsCabecalho();
                        console.log('ğŸ”„ [Sandbox] Dados recarregados do localStorage');
                        console.log('ğŸ”„ [Sandbox] Modelos disponÃ­veis:', SistemaCore.dados.modelos_atendimento?.length || 0);
                        console.log('ğŸ”„ [Sandbox] CabeÃ§alhos disponÃ­veis:', SistemaCore.dados.cabecalhos?.length || 0);
                    } else if (subaba === 'modelos' && typeof ModelosAtendimento !== 'undefined') {
                        ModelosAtendimento.listar();
                    } else if (subaba === 'cabecalhos' && typeof Cabecalhos !== 'undefined') {
                        Cabecalhos.renderizarLista();
                    } else if (subaba === 'templates' && typeof Elementos !== 'undefined') {
                        Elementos.listar();
                        console.log('ğŸ§© [Elementos] Lista atualizada');
                    }
                }
            }
        };


        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // SIMULADOR CIRÃšRGICO - v10.463
        // Abre o simulador externo (simulador_LUPA_E_AMPLIFICACAO.html)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const SimuladorCirurgico = {
            // Abrir simulador para editar foto existente ou criar nova simulaÃ§Ã£o
            abrir(fotoBase64 = null, fotoIdx = null) {
                // Salvar dados no localStorage para o simulador ler
                const dados = {
                    base64: fotoBase64,
                    idx: fotoIdx,
                    timestamp: Date.now()
                };
                localStorage.setItem('simulador_foto_entrada', JSON.stringify(dados));
                console.log('[SimuladorCirurgico] Abrindo, idx:', fotoIdx);
                
                // Abrir simulador em nova aba
                const win = window.open('simulador_LUPA_E_AMPLIFICACAO.html', '_blank');
                
                if (!win) {
                    Sistema.notificar('âš ï¸ Pop-up bloqueado! Permita pop-ups.', 'warning');
                    return;
                }
                
                // Monitorar retorno
                this._monitorarRetorno(fotoIdx);
                
                const msg = fotoIdx !== null ? 'Editando foto...' : 'Nova simulaÃ§Ã£o...';
                Sistema.notificar('ğŸ”¬ Simulador aberto!\n' + msg, 'info');
            },
            
            // Monitorar quando simulador salvar
            _monitorarRetorno(idx) {
                const interval = setInterval(() => {
                    const retorno = localStorage.getItem('simulador_foto_retorno');
                    if (retorno) {
                        try {
                            const dados = JSON.parse(retorno);
                            if (!dados.base64) return;
                            
                            // Atualizar ou adicionar foto no ModuloFotos
                            if (idx !== null && idx !== undefined && ModuloFotos.fotos[idx]) {
                                // Atualizar foto existente
                                ModuloFotos.fotos[idx].base64 = dados.base64;
                                ModuloFotos.fotos[idx].editada = true;
                                ModuloFotos.fotos[idx].editada_em = new Date().toISOString();
                            } else {
                                // Adicionar como nova foto
                                ModuloFotos.fotos.push({
                                    id: Date.now(),
                                    base64: dados.base64,
                                    nome: 'SimulaÃ§Ã£o ' + new Date().toLocaleString('pt-BR'),
                                    editada: true,
                                    editada_em: new Date().toISOString(),
                                    tipo: 'simulacao'
                                });
                            }
                            
                            ModuloFotos.renderizar();
                            
                            // v10.463: SALVAR AUTOMATICAMENTE NO ATENDIMENTO ATUAL
                            this._salvarFotosNoAtendimento();
                            
                            Sistema.notificar('âœ… SimulaÃ§Ã£o salva no prontuÃ¡rio!', 'success');
                            
                            // Limpar
                            localStorage.removeItem('simulador_foto_retorno');
                            localStorage.removeItem('simulador_foto_entrada');
                            clearInterval(interval);
                            
                        } catch (e) {
                            console.error('[SimuladorCirurgico] Erro:', e);
                        }
                    }
                }, 1000);
                
                // Timeout 30 min
                setTimeout(() => clearInterval(interval), 30 * 60 * 1000);
            },
            
            // v10.463: Salvar fotos no atendimento atual
            _salvarFotosNoAtendimento() {
                // v10.463: CORREÃ‡ÃƒO - NÃ£o atualizar atendimentos jÃ¡ finalizados!
                // Fotos sÃ£o salvas APENAS quando salvarAtendimento() Ã© chamado
                // Esta funÃ§Ã£o agora sÃ³ mostra log, nÃ£o modifica dados
                
                const entrada = Atendimentos?.entradaAtual;
                if (!entrada) {
                    console.log('[SimuladorCirurgico] Sem entrada ativa, fotos aguardando no ModuloFotos');
                    return;
                }
                
                // Fotos ficam no ModuloFotos atÃ© salvarAtendimento() ser chamado
                // Isso evita que fotos sejam copiadas para atendimentos anteriores
                console.log('[SimuladorCirurgico] Fotos atualizadas no ModuloFotos, serÃ£o salvas ao finalizar');
            }
        };
        
        // Alias para compatibilidade
        const EditorFotos = SimuladorCirurgico;
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MÃ“DULO FOTOS - Galeria de fotos no prontuÃ¡rio - v10.463
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const ModuloFotos = {
            fotos: [], // Array de {id, base64, nome, editada}
            
            adicionar() {
                document.getElementById('modulo-fotos-input')?.click();
            },
            
            processar(event) {
                const files = event.target.files;
                if (!files || files.length === 0) return;
                
                Array.from(files).forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        this.fotos.push({
                            id: Date.now() + Math.random(),
                            base64: e.target.result,
                            nome: file.name,
                            editada: false
                        });
                        this.renderizar();
                    };
                    reader.readAsDataURL(file);
                });
                
                // Limpar input para permitir adicionar mesma foto
                event.target.value = '';
            },
            
            renderizar() {
                const galeria = document.getElementById('modulo-fotos-galeria');
                if (!galeria) return;
                
                if (this.fotos.length === 0) {
                    galeria.innerHTML = `
                        <div style="text-align: center; padding: 20px; color: #9ca3af; grid-column: 1/-1;">
                            Nenhuma foto adicionada
                        </div>
                    `;
                    return;
                }
                
                galeria.innerHTML = this.fotos.map((foto, idx) => `
                    <div style="position: relative; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; background: #f9fafb;">
                        <img src="${foto.base64}" style="width: 100%; height: 100px; object-fit: cover; cursor: pointer;" 
                             onclick="ModuloFotos.visualizar(${idx})" title="Clique para ampliar">
                        ${foto.editada ? '<span style="position: absolute; top: 4px; left: 4px; background: #3b82f6; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">âœï¸</span>' : ''}
                        <div style="display: flex; justify-content: center; gap: 4px; padding: 6px; background: white;">
                            <button onclick="ModuloFotos.editar(${idx})" style="background: #3b82f6; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 10px; cursor: pointer;" title="Editar">âœï¸</button>
                            <button onclick="ModuloFotos.remover(${idx})" style="background: #ef4444; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 10px; cursor: pointer;" title="Remover">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
            },
            
            visualizar(idx) {
                const foto = this.fotos[idx];
                if (!foto) return;
                
                // Modal de visualizaÃ§Ã£o
                const modal = document.createElement('div');
                modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.9); z-index: 9999; display: flex; align-items: center; justify-content: center; cursor: pointer;';
                modal.onclick = () => modal.remove();
                modal.innerHTML = `<img src="${foto.base64}" style="max-width: 90%; max-height: 90%; object-fit: contain; border-radius: 8px;">`;
                document.body.appendChild(modal);
            },
            
            editar(idx) {
                const foto = this.fotos[idx];
                if (!foto) return;
                
                // v10.463: Usar SimuladorCirurgico
                SimuladorCirurgico.abrir(foto.base64, idx);
            },
            
            remover(idx) {
                if (confirm('Remover esta foto?')) {
                    this.fotos.splice(idx, 1);
                    this.renderizar();
                }
            },
            
            // Obter fotos para salvar no atendimento
            obterFotos() {
                return [...this.fotos];
            },
            
            // Carregar fotos de um atendimento
            carregar(fotos) {
                this.fotos = fotos || [];
                this.renderizar();
            },
            
            // Limpar
            limpar() {
                this.fotos = [];
            }
        };

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // MÃ“DULO ANEXOS - Arquivos PDF, DOC, etc no prontuÃ¡rio - v10.463
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const ModuloAnexos = {
            anexos: [], // Array de {id, base64, nome, tipo, tamanho, adicionado_em}
            
            // Ãcones por tipo de arquivo
            ICONES: {
                'pdf': 'ğŸ“•',
                'doc': 'ğŸ“˜', 'docx': 'ğŸ“˜',
                'xls': 'ğŸ“—', 'xlsx': 'ğŸ“—',
                'ppt': 'ğŸ“™', 'pptx': 'ğŸ“™',
                'txt': 'ğŸ“„',
                'csv': 'ğŸ“Š',
                'zip': 'ğŸ“¦', 'rar': 'ğŸ“¦',
                'xml': 'ğŸ“‹',
                'jpg': 'ğŸ–¼ï¸', 'jpeg': 'ğŸ–¼ï¸', 'png': 'ğŸ–¼ï¸', 'gif': 'ğŸ–¼ï¸', 'webp': 'ğŸ–¼ï¸',
                'mp3': 'ğŸµ', 'wav': 'ğŸµ',
                'mp4': 'ğŸ¬', 'avi': 'ğŸ¬', 'mov': 'ğŸ¬',
                'default': 'ğŸ“'
            },
            
            adicionar() {
                document.getElementById('modulo-anexos-input')?.click();
            },
            
            processar(event) {
                const files = event.target.files;
                if (!files || files.length === 0) return;
                
                const maxSize = 10 * 1024 * 1024; // 10MB limite
                
                Array.from(files).forEach(file => {
                    if (file.size > maxSize) {
                        alert(`âš ï¸ Arquivo "${file.name}" Ã© muito grande (mÃ¡x 10MB)`);
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const ext = file.name.split('.').pop().toLowerCase();
                        this.anexos.push({
                            id: Date.now() + Math.random(),
                            base64: e.target.result,
                            nome: file.name,
                            tipo: ext,
                            tamanho: file.size,
                            adicionado_em: new Date().toISOString()
                        });
                        this.renderizar();
                        Sistema.notificar(`ğŸ“ Anexo "${file.name}" adicionado!`, 'success');
                    };
                    reader.readAsDataURL(file);
                });
                
                event.target.value = '';
            },
            
            getIcone(tipo) {
                return this.ICONES[tipo] || this.ICONES['default'];
            },
            
            formatarTamanho(bytes) {
                if (bytes < 1024) return bytes + ' B';
                if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
                return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
            },
            
            renderizar() {
                const lista = document.getElementById('modulo-anexos-lista');
                if (!lista) return;
                
                if (this.anexos.length === 0) {
                    lista.innerHTML = `
                        <div style="text-align: center; padding: 20px; color: #9ca3af;">
                            Nenhum anexo adicionado
                        </div>
                    `;
                    return;
                }
                
                lista.innerHTML = this.anexos.map((anexo, idx) => `
                    <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 8px;">
                        <span style="font-size: 28px;">${this.getIcone(anexo.tipo)}</span>
                        <div style="flex: 1; min-width: 0;">
                            <div style="font-weight: 500; color: #1f2937; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;" title="${anexo.nome}">
                                ${anexo.nome}
                            </div>
                            <div style="font-size: 12px; color: #6b7280;">
                                ${anexo.tipo.toUpperCase()} â€¢ ${this.formatarTamanho(anexo.tamanho)}
                            </div>
                        </div>
                        <div style="display: flex; gap: 6px;">
                            <button onclick="ModuloAnexos.visualizar(${idx})" 
                                    style="background: #3b82f6; color: white; border: none; padding: 6px 10px; border-radius: 4px; font-size: 12px; cursor: pointer;" 
                                    title="Visualizar/Baixar">ğŸ‘ï¸</button>
                            <button onclick="ModuloAnexos.baixar(${idx})" 
                                    style="background: #10b981; color: white; border: none; padding: 6px 10px; border-radius: 4px; font-size: 12px; cursor: pointer;" 
                                    title="Baixar">â¬‡ï¸</button>
                            <button onclick="ModuloAnexos.remover(${idx})" 
                                    style="background: #ef4444; color: white; border: none; padding: 6px 10px; border-radius: 4px; font-size: 12px; cursor: pointer;" 
                                    title="Remover">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
            },
            
            visualizar(idx) {
                const anexo = this.anexos[idx];
                if (!anexo) return;
                
                // Para PDFs e imagens, abrir em nova aba
                if (['pdf', 'jpg', 'jpeg', 'png', 'gif', 'webp'].includes(anexo.tipo)) {
                    const win = window.open();
                    if (anexo.tipo === 'pdf') {
                        win.document.write(`
                            <html><head><title>${anexo.nome}</title></head>
                            <body style="margin:0; background:#333;">
                                <embed src="${anexo.base64}" type="application/pdf" width="100%" height="100%">
                            </body></html>
                        `);
                    } else {
                        win.document.write(`
                            <html><head><title>${anexo.nome}</title></head>
                            <body style="margin:0; background:#333; display:flex; align-items:center; justify-content:center; min-height:100vh;">
                                <img src="${anexo.base64}" style="max-width:100%; max-height:100vh;">
                            </body></html>
                        `);
                    }
                } else {
                    // Para outros tipos, baixar diretamente
                    this.baixar(idx);
                }
            },
            
            baixar(idx) {
                const anexo = this.anexos[idx];
                if (!anexo) return;
                
                const link = document.createElement('a');
                link.href = anexo.base64;
                link.download = anexo.nome;
                link.click();
            },
            
            remover(idx) {
                const anexo = this.anexos[idx];
                if (confirm(`Remover "${anexo?.nome}"?`)) {
                    this.anexos.splice(idx, 1);
                    this.renderizar();
                }
            },
            
            // Obter anexos para salvar
            obterAnexos() {
                return [...this.anexos];
            },
            
            // Carregar anexos de um atendimento
            carregar(anexos) {
                this.anexos = anexos || [];
                this.renderizar();
            },
            
            // Limpar
            limpar() {
                this.anexos = [];
            }
        };

        /* ============================================================
           [MÃ“DULOS ORDENÃVEL] Sistema de MÃ³dulos com Ordem - v10.354
           ============================================================ */
        
        const ModulosOrdenavel = {
            // Array de mÃ³dulos selecionados NA ORDEM
            modulosSelecionados: [],
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // MÃ“DULOS DISPONÃVEIS - REORGANIZADOS v10.359
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            MODULOS: {
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                // ğŸ“– ANAMNESE (histÃ³ria clÃ­nica)
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                anamnese: [
                    { id: 'queixa', nome: 'ğŸ—£ï¸ Queixa Principal' },
                    { id: 'hda', nome: 'ğŸ“– HistÃ³ria da DoenÃ§a Atual' },
                    { id: 'hpp', nome: 'ğŸ“‹ HistÃ³ria PatolÃ³gica Pregressa' },
                    { id: 'h-familiar', nome: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ HistÃ³ria Familiar' },
                    { id: 'h-social', nome: 'ğŸ  HistÃ³ria Social' }
                    // v10.383: REMOVIDOS DUPLICADOS (jÃ¡ incluÃ­dos em HPP):
                    // - 'h-ginecologica' (jÃ¡ em HPP expandÃ­vel)
                    // - 'alergias' (jÃ¡ em HPP)
                    // - 'medicacoes' (jÃ¡ em HPP)
                    // - 'cirurgias-previas' (jÃ¡ em HPP)
                ],
                
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                // âš•ï¸ EXAME FÃSICO
                // Geral: Sinais Vitais, Antropometria, Ectoscopia
                // EspecÃ­fico: Mapeamento, Sistemas, Especialidades (painÃ©is internos)
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                exame_fisico: [
                    { id: 'exame-geral', nome: 'âš•ï¸ Exame FÃ­sico Geral' },
                    { id: 'exame-especifico', nome: 'ğŸ¯ Exame FÃ­sico EspecÃ­fico' }
                ],
                
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                // ğŸ“Š ESCALAS CLÃNICAS
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                escalas: [
                    { id: 'glasgow', nome: 'ğŸ§  Escala de Glasgow' },
                    { id: 'braden', nome: 'ğŸ›ï¸ Escala de Braden' },
                    { id: 'abcde', nome: 'ğŸš‘ AvaliaÃ§Ã£o ABCDE' },
                    { id: 'rass', nome: 'ğŸ’¤ Escala RASS' },
                    { id: 'manchester', nome: 'ğŸš¦ Protocolo Manchester', disabled: true }
                ],
                
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                // ğŸ” DIAGNÃ“STICO E CONDUTA
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                diagnostico: [
                    { id: 'hipotese', nome: 'ğŸ” HipÃ³tese DiagnÃ³stica' },
                    { id: 'cid10', nome: 'ğŸ·ï¸ CID-10' },
                    { id: 'conduta', nome: 'ğŸ“ Conduta' },
                    { id: 'prescricao', nome: 'ğŸ’Š PrescriÃ§Ã£o/Receita' },
                    { id: 'exames-solicitar', nome: 'ğŸ”¬ Exames a Solicitar' },
                    { id: 'encaminhamento', nome: 'â†—ï¸ Encaminhamento' }
                ],
                
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                // âš•ï¸ CIRÃšRGICO
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                cirurgico: [
                    { id: 'desc-cirurgica', nome: 'ğŸ“„ DescriÃ§Ã£o CirÃºrgica' },
                    { id: 'planejamento', nome: 'ğŸ“… Planejamento CirÃºrgico' },
                    { id: 'consentimento', nome: 'âœï¸ Termo de Consentimento' },
                    { id: 'anestesia', nome: 'ğŸ’‰ Ficha de Anestesia' },
                    { id: 'pos-op', nome: 'ğŸ¥ PÃ³s-OperatÃ³rio' },
                    { id: 'drenos', nome: 'ğŸ©¹ Drenos/Dispositivos' }
                ],
                
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                // ğŸ›ï¸ EVOLUÃ‡ÃƒO E INTERNAÃ‡ÃƒO
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                internacao: [
                    { id: 'controle-hospitalar', nome: 'ğŸ¥ DPO / AntibiÃ³ticos' },
                    { id: 'evolucao', nome: 'ğŸ“ EvoluÃ§Ã£o DiÃ¡ria' },
                    { id: 'evolucao-soap', nome: 'ğŸ“‹ EvoluÃ§Ã£o SOAP' },
                    { id: 'balanco-hidrico', nome: 'ğŸ’§ BalanÃ§o HÃ­drico' },
                    { id: 'intercorrencias', nome: 'âš ï¸ IntercorrÃªncias' },
                    { id: 'enfermagem', nome: 'ğŸ‘©â€âš•ï¸ AnotaÃ§Ãµes Enfermagem' },
                    { id: 'parecer', nome: 'ğŸ‘¨â€âš•ï¸ Parecer Especialista' },
                    { id: 'alta', nome: 'ğŸ“¤ SumÃ¡rio de Alta' }
                ],
                
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                // ğŸ“· DOCUMENTAÃ‡ÃƒO VISUAL - v10.463
                // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                documentacao_visual: [
                    { id: 'fotos', nome: 'ğŸ“· Fotos + Editor' },
                    { id: 'anexos', nome: 'ğŸ“ Anexos (PDF, DOC...)' }
                ]
            },
            
            // Inicializar ao abrir modal
            init(modulosExistentes = []) {
                this.modulosSelecionados = [...modulosExistentes];
                this.renderizarSelecionados();
                this.renderizarDisponiveis();
            },
            
            // Limpar ao fechar modal
            limpar() {
                this.modulosSelecionados = [];
            },
            
            // Obter array de IDs na ordem
            obterModulos() {
                return [...this.modulosSelecionados];
            },
            
            // Buscar info do mÃ³dulo por ID - v10.359 com subcategorias
            buscarModulo(id) {
                for (const [cat, dados] of Object.entries(this.MODULOS)) {
                    if (Array.isArray(dados)) {
                        const modulo = dados.find(m => m.id === id);
                        if (modulo) return modulo;
                    }
                }
                return { id, nome: id, icone: 'ğŸ“„' };
            },
            
            // Adicionar mÃ³dulo
            adicionar(id) {
                if (this.modulosSelecionados.includes(id)) {
                    Sistema.notificar('MÃ³dulo jÃ¡ adicionado', 'warning');
                    return;
                }
                this.modulosSelecionados.push(id);
                this.renderizarSelecionados();
                this.renderizarDisponiveis();
            },
            
            // Remover mÃ³dulo
            remover(index) {
                this.modulosSelecionados.splice(index, 1);
                this.renderizarSelecionados();
                this.renderizarDisponiveis();
            },
            
            // Mover para cima
            moverCima(index) {
                if (index <= 0) return;
                const temp = this.modulosSelecionados[index];
                this.modulosSelecionados[index] = this.modulosSelecionados[index - 1];
                this.modulosSelecionados[index - 1] = temp;
                this.renderizarSelecionados();
            },
            
            // Mover para baixo
            moverBaixo(index) {
                if (index >= this.modulosSelecionados.length - 1) return;
                const temp = this.modulosSelecionados[index];
                this.modulosSelecionados[index] = this.modulosSelecionados[index + 1];
                this.modulosSelecionados[index + 1] = temp;
                this.renderizarSelecionados();
            },
            
            // Renderizar lista de selecionados
            renderizarSelecionados() {
                const container = document.getElementById('lista-modulos-selecionados');
                const msgVazio = document.getElementById('msg-sem-modulos');
                if (!container) return;
                
                if (this.modulosSelecionados.length === 0) {
                    if (msgVazio) msgVazio.style.display = 'block';
                    container.innerHTML = '<p id="msg-sem-modulos" style="color: #999; text-align: center; padding: 20px; margin: 0;">Nenhum mÃ³dulo selecionado. Use o menu abaixo para adicionar.</p>';
                    return;
                }
                
                let html = '';
                this.modulosSelecionados.forEach((id, index) => {
                    const modulo = this.buscarModulo(id);
                    const isFirst = index === 0;
                    const isLast = index === this.modulosSelecionados.length - 1;
                    
                    html += `
                        <div style="display: flex; align-items: center; padding: 8px 12px; background: white; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 4px;">
                            <span style="font-size: 13px; font-weight: 500; color: #667eea; margin-right: 10px; min-width: 20px;">${index + 1}.</span>
                            <span style="flex: 1; font-size: 13px; color: #333;">${modulo.nome}</span>
                            <div style="display: flex; gap: 4px;">
                                <button onclick="ModulosOrdenavel.moverCima(${index})" ${isFirst ? 'disabled' : ''} 
                                    style="width: 24px; height: 24px; border: 1px solid #ddd; background: ${isFirst ? '#f5f5f5' : 'white'}; color: ${isFirst ? '#ccc' : '#667eea'}; border-radius: 4px; cursor: ${isFirst ? 'not-allowed' : 'pointer'}; font-size: 12px;"
                                    title="Mover para cima">â†‘</button>
                                <button onclick="ModulosOrdenavel.moverBaixo(${index})" ${isLast ? 'disabled' : ''} 
                                    style="width: 24px; height: 24px; border: 1px solid #ddd; background: ${isLast ? '#f5f5f5' : 'white'}; color: ${isLast ? '#ccc' : '#667eea'}; border-radius: 4px; cursor: ${isLast ? 'not-allowed' : 'pointer'}; font-size: 12px;"
                                    title="Mover para baixo">â†“</button>
                                <button onclick="ModulosOrdenavel.remover(${index})" 
                                    style="width: 24px; height: 24px; border: 1px solid #ddd; background: white; color: #ef4444; border-radius: 4px; cursor: pointer; font-size: 12px;"
                                    title="Remover">Ã—</button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },
            
            // Filtrar mÃ³dulos por categoria
            filtrarModulos() {
                this.renderizarDisponiveis();
            },
            
            // Renderizar lista de disponÃ­veis - v10.359 com subcategorias
            renderizarDisponiveis() {
                const container = document.getElementById('lista-modulos-disponiveis');
                if (!container) return;
                
                const categoriaFiltro = document.getElementById('select-categoria-modulo')?.value || '';
                
                let html = '';
                
                const nomesCategoria = {
                    anamnese: 'ğŸ“– Anamnese',
                    exame_fisico: 'âš•ï¸ Exame FÃ­sico',
                    escalas: 'ğŸ“Š Escalas ClÃ­nicas',
                    diagnostico: 'ğŸ” DiagnÃ³stico e Conduta',
                    cirurgico: 'âš•ï¸ CirÃºrgico',
                    internacao: 'ğŸ›ï¸ EvoluÃ§Ã£o e InternaÃ§Ã£o',
                    documentacao_visual: 'ğŸ“· DocumentaÃ§Ã£o Visual'
                };
                
                // FunÃ§Ã£o auxiliar para renderizar mÃ³dulos
                const renderizarModulos = (modulos, mostrarTitulo = false, titulo = '') => {
                    let modulosHtml = '';
                    
                    if (mostrarTitulo && titulo) {
                        modulosHtml += `<div style="grid-column: 1 / -1; font-size: 11px; color: #888; padding: 6px 0 4px 0; border-bottom: 1px solid #eee; margin-top: 6px; text-transform: uppercase; letter-spacing: 0.5px;">${titulo}</div>`;
                    }
                    
                    modulos.forEach(modulo => {
                        const jaAdicionado = this.modulosSelecionados.includes(modulo.id);
                        const isDisabled = modulo.disabled || false;
                        const btnDisabled = jaAdicionado || isDisabled;
                        
                        modulosHtml += `
                            <button onclick="${isDisabled ? '' : `ModulosOrdenavel.adicionar('${modulo.id}')`}" 
                                ${btnDisabled ? 'disabled' : ''}
                                title="${isDisabled ? 'Em desenvolvimento' : ''}"
                                style="
                                    display: flex;
                                    align-items: center;
                                    gap: 6px;
                                    padding: 8px 10px;
                                    border: 1px solid ${btnDisabled ? '#ccc' : '#ddd'};
                                    background: ${btnDisabled ? '#f5f5f5' : 'white'};
                                    border-radius: 4px;
                                    cursor: ${btnDisabled ? 'not-allowed' : 'pointer'};
                                    font-size: 12px;
                                    text-align: left;
                                    color: ${btnDisabled ? '#999' : '#333'};
                                    opacity: ${isDisabled ? '0.6' : '1'};
                                "
                            >
                                <span style="flex: 1;">${isDisabled ? 'ğŸš§ ' : ''}${modulo.nome}</span>
                                ${jaAdicionado ? '<span style="color: #22c55e;">âœ“</span>' : (isDisabled ? '' : '<span style="color: #667eea;">+</span>')}
                            </button>
                        `;
                    });
                    
                    return modulosHtml;
                };
                
                // Se filtrando por categoria especÃ­fica
                if (categoriaFiltro) {
                    const dados = this.MODULOS[categoriaFiltro];
                    if (Array.isArray(dados)) {
                        html += renderizarModulos(dados, false);
                    }
                } else {
                    // Mostrar todas as categorias
                    for (const [cat, dados] of Object.entries(this.MODULOS)) {
                        if (!dados || !Array.isArray(dados)) continue;
                        html += renderizarModulos(dados, true, nomesCategoria[cat] || cat);
                    }
                }
                
                container.innerHTML = html;
            }
        };

        /* ============================================================
           [MODELOS ATENDIMENTO] MÃ³dulo de Modelos - v10.130
           ============================================================ */
        
        const ModelosAtendimento = {
            
            init() {
                console.log('ğŸ“‹ [ModelosAtendimento] MÃ³dulo inicializado');
                this.criarModelosPadrao();
                this.listar();
            },

            criarModelosPadrao() {
                // Se jÃ¡ existem modelos, nÃ£o cria novamente
                if (SistemaCore.dados.modelos_atendimento && SistemaCore.dados.modelos_atendimento.length > 0) {
                    return;
                }

                // Criar modelo padrÃ£o de consulta
                const modeloPadrao = {
                    id: 1, // v10.434: ID simples para modelo padrÃ£o Ãºnico
                    nome: 'Consulta - Modelo PadrÃ£o',
                    tipo: 'consulta',
                    especialidade: '', // Geral
                    ativo: true,
                    timer: true,
                    sinais_vitais: ['pa', 'fc', 'fr', 'temp', 'spo2'],
                    antropometria: ['peso', 'altura', 'imc'],
                    escalas: [],
                    criado_em: new Date().toISOString()
                };

                SistemaCore.dados.modelos_atendimento = [modeloPadrao];
                SistemaCore.salvar();
                console.log('âœ… Modelo padrÃ£o criado');
            },

            listar() {
                const container = document.getElementById('lista-modelos-atendimento');
                if (!container) return;

                const modelos = SistemaCore.dados.modelos_atendimento || [];

                if (modelos.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 60px 20px; color: var(--text-light);">
                            <div style="font-size: 48px; margin-bottom: 12px;">ğŸ“‹</div>
                            <p>Nenhum modelo cadastrado ainda.</p>
                            <p style="font-size: 14px; margin-top: 8px;">Clique em "Novo Modelo" para comeÃ§ar.</p>
                        </div>
                    `;
                    return;
                }

                // Agrupar por tipo
                const grupos = {
                    'consulta': { icon: 'ğŸ©º', label: 'Consultas', modelos: [] },
                    'emergencia': { icon: 'ğŸš¨', label: 'EmergÃªncia', modelos: [] },
                    'cirurgia': { icon: 'âš•ï¸', label: 'Cirurgias', modelos: [] },
                    'internacao': { icon: 'ğŸ›ï¸', label: 'InternaÃ§Ãµes', modelos: [] },
                    'exame': { icon: 'ğŸ”¬', label: 'Exames', modelos: [] },
                    'procedimento': { icon: 'ğŸ¥', label: 'Procedimentos', modelos: [] }
                };

                modelos.forEach(m => {
                    if (grupos[m.tipo]) {
                        grupos[m.tipo].modelos.push(m);
                    }
                });

                let html = '';

                Object.entries(grupos).forEach(([tipo, grupo]) => {
                    if (grupo.modelos.length === 0) return;

                    html += `
                        <div style="margin-bottom: 32px;">
                            <h4 style="margin-bottom: 16px; color: var(--primary); display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 24px;">${grupo.icon}</span>
                                ${grupo.label}
                                <span style="background: var(--bg); padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 600; color: var(--text-light);">
                                    ${grupo.modelos.length}
                                </span>
                            </h4>
                            <div style="display: grid; gap: 12px;">
                    `;

                    grupo.modelos.forEach(modelo => {
                        const statusBadge = modelo.ativo 
                            ? '<span style="background: #f9fafb; color: #16a34a; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">âœ… ATIVO</span>'
                            : '<span style="background: #f9fafb; color: #ca8a04; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">â¸ï¸ INATIVO</span>';

                        const especialidadeBadge = modelo.especialidade 
                            ? `<span style="background: #e0e7ff; color: #4f46e5; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">${modelo.especialidade}</span>`
                            : '<span style="background: #f3f4f6; color: #6b7280; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">GERAL</span>';

                        const timerIcon = modelo.timer ? 'â±ï¸' : '';
                        const escalasInfo = modelo.escalas && modelo.escalas.length > 0 
                            ? `<span style="font-size: 11px; color: var(--text-light);">ğŸ“Š ${modelo.escalas.length} escala(s)</span>`
                            : '';

                        html += `
                            <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 16px; display: flex; justify-content: space-between; align-items: center;">
                                <div style="flex: 1;">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                        <strong style="font-size: 15px;">${modelo.nome}</strong>
                                        ${timerIcon}
                                        ${statusBadge}
                                        ${especialidadeBadge}
                                    </div>
                                    <div style="font-size: 12px; color: var(--text-light); display: flex; gap: 16px;">
                                        <span>Sinais: ${modelo.sinais_vitais?.length || 0}</span>
                                        <span>Antropometria: ${modelo.antropometria?.length || 0}</span>
                                        ${escalasInfo}
                                    </div>
                                </div>
                                <div style="display: flex; gap: 8px;">
                                    <button class="btn btn-secondary" onclick="ModelosAtendimento.editar(${modelo.id})" style="padding: 8px 16px; font-size: 13px;">
                                        âœï¸ Editar
                                    </button>
                                    <button class="btn btn-danger" onclick="ModelosAtendimento.excluir(${modelo.id})" style="padding: 8px 16px; font-size: 13px;">
                                        ğŸ—‘ï¸
                                    </button>
                                </div>
                            </div>
                        `;
                    });

                    html += `
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            },

            abrirModal(modeloId = null) {
                const modal = document.getElementById('modalModelo');
                const titulo = document.getElementById('tituloModalModelo');
                
                // Preencher especialidades
                const selectEsp = document.getElementById('modelo-especialidade');
                if (selectEsp) {
                    selectEsp.innerHTML = '<option value="">Geral (todas especialidades)</option>';
                    const especialidades = SistemaCore.dados.estabelecimento.especialidades || [];
                    especialidades.forEach(esp => {
                        selectEsp.innerHTML += `<option value="${esp}">${esp}</option>`;
                    });
                }

                // v10.346: Preencher layouts de cabeÃ§alho
                const selectCab = document.getElementById('modelo-cabecalho');
                if (selectCab) {
                    selectCab.innerHTML = '<option value="">-- PadrÃ£o do Sistema --</option>';
                    const cabecalhos = SistemaCore.dados.cabecalhos || [];
                    cabecalhos.forEach(cab => {
                        const icone = cab.tipoBase === 'folha-rosto' ? 'ğŸ“„' : 
                                     cab.tipoBase === 'minimalista' ? 'ğŸ“' : 'ğŸ“ƒ';
                        selectCab.innerHTML += `<option value="${cab.id}">${icone} ${cab.nome}</option>`;
                    });
                }

                if (modeloId) {
                    // MODO EDIÃ‡ÃƒO
                    titulo.textContent = 'âœï¸ Editar Modelo de ProntuÃ¡rio';
                    const modelo = SistemaCore.dados.modelos_atendimento.find(m => m.id === modeloId);
                    
                    if (!modelo) {
                        Sistema.notificar('âŒ Modelo nÃ£o encontrado', 'erro');
                        return;
                    }

                    document.getElementById('edit-modelo-id').value = modelo.id;
                    document.getElementById('modelo-nome').value = modelo.nome;
                    document.getElementById('modelo-tipo').value = modelo.tipo;
                    document.getElementById('modelo-especialidade').value = modelo.especialidade || '';
                    document.getElementById('modelo-ativo').value = modelo.ativo.toString();
                    document.getElementById('modelo-timer').checked = modelo.timer;

                    // v10.346: Carregar cabeÃ§alho
                    if (selectCab) selectCab.value = modelo.cabecalho_id || '';
                    
                    // v10.354: Carregar mÃ³dulos no sistema ordenÃ¡vel
                    ModulosOrdenavel.init(modelo.modulos_prontuario || []);

                    // Exame EspecÃ­fico
                    document.getElementById('modelo-exame-tipo').value = modelo.exame_especifico?.tipo || '';
                    document.getElementById('modelo-iframe-url').value = modelo.exame_especifico?.iframe_url || '';
                    document.getElementById('modelo-iframe-altura').value = modelo.exame_especifico?.iframe_altura || 800;
                    
                    // Corpo ClicÃ¡vel
                    if (modelo.exame_especifico?.corpo) {
                        document.getElementById('modelo-corpo-visualizacao').value = modelo.exame_especifico.corpo.visualizacao || 'frente';
                        document.getElementById('modelo-corpo-template').value = modelo.exame_especifico.corpo.template || '';
                        document.getElementById('modelo-corpo-permitir-edicao').checked = modelo.exame_especifico.corpo.permitirEdicao !== false;
                        document.getElementById('modelo-corpo-obrigatorio').checked = modelo.exame_especifico.corpo.obrigatorio || false;
                    }
                    
                    this.trocarTipoExame();

                } else {
                    // MODO CRIAÃ‡ÃƒO
                    titulo.textContent = 'Novo Modelo de ProntuÃ¡rio';
                    document.getElementById('edit-modelo-id').value = '';
                    document.getElementById('modelo-nome').value = '';
                    document.getElementById('modelo-tipo').value = '';
                    document.getElementById('modelo-especialidade').value = '';
                    document.getElementById('modelo-ativo').value = 'true';
                    document.getElementById('modelo-timer').checked = true;

                    // v10.354: Inicializar mÃ³dulos ordenÃ¡veis com padrÃ£o
                    ModulosOrdenavel.init(['queixa', 'hda', 'exame-geral', 'hipotese', 'conduta']);

                    // Resetar Exame EspecÃ­fico
                    document.getElementById('modelo-exame-tipo').value = '';
                    document.getElementById('modelo-iframe-url').value = '';
                    document.getElementById('modelo-iframe-altura').value = 800;
                    this.trocarTipoExame();
                }

                modal.style.display = 'flex';
            },

            fecharModal() {
                document.getElementById('modalModelo').style.display = 'none';
                ModulosOrdenavel.limpar(); // v10.354: Limpar ao fechar
            },

            salvar() {
                const id = document.getElementById('edit-modelo-id').value;
                const nome = document.getElementById('modelo-nome').value.trim();
                const tipo = document.getElementById('modelo-tipo').value;
                const especialidade = document.getElementById('modelo-especialidade').value;
                const ativo = document.getElementById('modelo-ativo').value === 'true';
                const timer = document.getElementById('modelo-timer').checked;

                // ValidaÃ§Ãµes
                if (!nome) {
                    Sistema.notificar('âŒ Digite um nome para o modelo', 'erro');
                    return;
                }

                if (!tipo) {
                    Sistema.notificar('âŒ Selecione o tipo de atendimento', 'erro');
                    return;
                }

                // Usar valores padrÃ£o para sinais vitais, antropometria e escalas
                const sinais_vitais = ['pa', 'fc', 'fr', 'temp', 'spo2'];
                const antropometria = ['peso', 'altura', 'imc'];
                const escalas = [];

                // v10.346: Coletar cabeÃ§alho
                const cabecalhoId = document.getElementById('modelo-cabecalho')?.value || '';

                // v10.354: Obter mÃ³dulos do sistema ordenÃ¡vel (NA ORDEM)
                const modulos = ModulosOrdenavel.obterModulos();

                const modelo = {
                    nome,
                    tipo,
                    especialidade,
                    ativo,
                    timer,
                    cabecalho_id: cabecalhoId ? (isNaN(cabecalhoId) ? cabecalhoId : parseInt(cabecalhoId)) : null,
                    modulos_prontuario: modulos, // v10.346: MÃ³dulos unificados
                    sinais_vitais,
                    antropometria,
                    escalas,
                    exame_especifico: {
                        tipo: document.getElementById('modelo-exame-tipo').value,
                        iframe_url: document.getElementById('modelo-iframe-url')?.value || '',
                        iframe_altura: parseInt(document.getElementById('modelo-iframe-altura')?.value) || 800,
                        corpo: {
                            visualizacao: document.getElementById('modelo-corpo-visualizacao')?.value || 'frente',
                            template: document.getElementById('modelo-corpo-template')?.value || '',
                            permitirEdicao: document.getElementById('modelo-corpo-permitir-edicao')?.checked !== false,
                            obrigatorio: document.getElementById('modelo-corpo-obrigatorio')?.checked || false
                        }
                    }
                };

                if (id) {
                    // EDITAR
                    const index = SistemaCore.dados.modelos_atendimento.findIndex(m => m.id == id);
                    if (index !== -1) {
                        modelo.id = parseInt(id);
                        modelo.criado_em = SistemaCore.dados.modelos_atendimento[index].criado_em;
                        modelo.atualizado_em = new Date().toISOString();
                        SistemaCore.dados.modelos_atendimento[index] = modelo;
                        Sistema.notificar('âœ… Modelo atualizado com sucesso!', 'sucesso');
                    }
                } else {
                    // CRIAR
                    modelo.id = Date.now();
                    modelo.criado_em = new Date().toISOString();
                    SistemaCore.dados.modelos_atendimento.push(modelo);
                    Sistema.notificar('âœ… Modelo criado com sucesso!', 'sucesso');
                }

                SistemaCore.salvar();
                this.listar();
                this.fecharModal();
            },

            editar(id) {
                this.abrirModal(id);
            },

            excluir(id) {
                const modelo = SistemaCore.dados.modelos_atendimento.find(m => m.id === id);
                if (!modelo) return;

                if (confirm(`Tem certeza que deseja excluir o modelo "${modelo.nome}"?\n\nEsta aÃ§Ã£o nÃ£o pode ser desfeita.`)) {
                    const index = SistemaCore.dados.modelos_atendimento.findIndex(m => m.id === id);
                    if (index !== -1) {
                        SistemaCore.dados.modelos_atendimento.splice(index, 1);
                        SistemaCore.salvar();
                        Sistema.notificar('âœ… Modelo excluÃ­do com sucesso', 'sucesso');
                        this.listar();
                    }
                }
            },

            trocarTipoExame() {
                const tipo = document.getElementById('modelo-exame-tipo').value;
                const configIframe = document.getElementById('config-iframe');
                const configCorpo = document.getElementById('config-corpo');
                const configOutros = document.getElementById('config-outros');
                
                // Esconder todos
                if (configIframe) configIframe.style.display = 'none';
                if (configCorpo) configCorpo.style.display = 'none';
                if (configOutros) configOutros.style.display = 'none';
                
                // Mostrar o correto
                if (tipo === 'iframe' && configIframe) {
                    configIframe.style.display = 'block';
                } else if (tipo === 'corpo' && configCorpo) {
                    configCorpo.style.display = 'block';
                } else if (tipo === 'sistemas' && configOutros) {
                    configOutros.style.display = 'block';
                }
            }
        };

        /* ============================================================
           [SANDBOX] MÃ³dulo de Testes - v10.130
           ============================================================ */
        
        const Sandbox = {
            pacienteSelecionado: null,
            modeloAtualId: null, // v10.441: Guardar modelo atual para poder atualizar cabeÃ§alho
            
            init() {
                console.log('ğŸ§ª [Sandbox] MÃ³dulo inicializado');
                this.carregarModelos();
                this.carregarLayoutsCabecalho();
                this.definirDataAtual();
            },
            
            // v10.405: Carregar templates globalmente para uso em Atendimentos
            carregarTemplatesGlobais() {
                console.log('ğŸ“‹ [Sandbox] Carregando window.TEMPLATES_MODULOS...');
                
                // Definir window.TEMPLATES_MODULOS se ainda nÃ£o existe
                if (typeof window.TEMPLATES_MODULOS === 'undefined') {
                    // IMPORTANTE: Este bloco de templates estava dentro de renderizarModelo()
                    window.TEMPLATES_MODULOS = {
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // QUEIXA PRINCIPAL
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'queixa': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #555; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    Queixa Principal (QP)
                                </h4>
                                <textarea id="campo-queixa-principal" rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Ex: InsatisfaÃ§Ã£o com aparÃªncia abdominal pÃ³s-gestacional"></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HDA - HISTÃ“RIA DA DOENÃ‡A ATUAL
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'hda': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #555; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    HistÃ³ria da DoenÃ§a Atual (HDA)
                                </h4>
                                <textarea id="campo-hda" rows="4" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Detalhe a evoluÃ§Ã£o da queixa, fatores relacionados, tentativas prÃ©vias..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HPP - HISTÃ“RIA PATOLÃ“GICA PREGRESSA COM CARDS DINÃ‚MICOS
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'hpp': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 20px 0; color: #333; font-size: 15px; display: flex; align-items: center; gap: 10px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                                    HistÃ³ria Pregressa
                                    <span style="font-size: 12px; color: #666; font-weight: normal;">Antecedentes pessoais e cirÃºrgicos</span>
                                </h4>
                                
                                <!-- CONTAINER ALERGIAS -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #ef4444; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <div>
                                            <h3 style="font-size: 14px; color: #333; margin: 0;">Alergias</h3>
                                            <p style="color: #c62828; font-size: 11px; margin: 4px 0 0 0;"><strong>IMPORTANTE:</strong> Registrar todas as alergias conhecidas</p>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="prontuario-btn-adicionar" style="background: #ef4444; padding: 8px 16px; font-size: 12px;" onclick="ProntuarioModular.adicionarAlergia()">+ Adicionar</button>
                                            <button class="prontuario-btn-gerenciar" style="padding: 8px 12px; font-size: 11px;" onclick="ProntuarioModular.gerenciarAlergias()">Pool</button>
                                        </div>
                                    </div>
                                    <div id="pront-listaAlergias" style="min-height: 30px;"></div>
                                </div>
                                
                                <!-- CONTAINER CIRURGIAS PRÃ‰VIAS -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #8b5cf6; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #333; margin: 0;">Cirurgias PrÃ©vias</h3>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="prontuario-btn-adicionar" style="background: #8b5cf6; padding: 8px 16px; font-size: 12px;" onclick="ProntuarioModular.adicionarCirurgia()">+ Adicionar</button>
                                            <button class="prontuario-btn-gerenciar" style="padding: 8px 12px; font-size: 11px;" onclick="ProntuarioModular.gerenciarCirurgias()">Pool</button>
                                        </div>
                                    </div>
                                    <div id="pront-listaCirurgias" style="min-height: 30px;"></div>
                                </div>
                                
                                <!-- CONTAINER MEDICAÃ‡Ã•ES EM USO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #10b981; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #333; margin: 0;">MedicaÃ§Ãµes em Uso</h3>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="prontuario-btn-adicionar" style="background: #10b981; padding: 8px 16px; font-size: 12px;" onclick="ProntuarioModular.adicionarMedicacao()">+ Adicionar</button>
                                            <button class="prontuario-btn-gerenciar" style="padding: 8px 12px; font-size: 11px;" onclick="ProntuarioModular.gerenciarMedicacoes()">Pool</button>
                                        </div>
                                    </div>
                                    <div id="pront-listaMedicacoes" style="min-height: 30px;"></div>
                                </div>
                                
                                <!-- CONTAINER DOENÃ‡AS PRÃ‰VIAS / COMORBIDADES -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #3b82f6; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #333; margin: 0;">DoenÃ§as PrÃ©vias / Comorbidades</h3>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="prontuario-btn-adicionar" style="background: #3b82f6; padding: 8px 16px; font-size: 12px;" onclick="ProntuarioModular.adicionarDoenca()">+ Adicionar</button>
                                            <button class="prontuario-btn-gerenciar" style="padding: 8px 12px; font-size: 11px;" onclick="ProntuarioModular.gerenciarDoencas()">Pool</button>
                                        </div>
                                    </div>
                                    <div id="pront-listaDoencas" style="min-height: 30px;"></div>
                                </div>
                                
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <!-- HISTÃ“RIA GINECO-OBSTÃ‰TRICA (apenas para pacientes femininas) -->
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <div style="margin-top: 20px; background: #fce4ec; border-radius: 6px; border-left: 4px solid #ec407a; overflow: hidden;">
                                    <div onclick="const c = document.getElementById('pront-expand-gineco'); const i = this.querySelector('.toggle-icon'); const t = this.querySelector('.toggle-text'); c.style.display = c.style.display === 'none' ? 'block' : 'none'; i.textContent = c.style.display === 'none' ? 'â–¶' : 'â–¼'; t.textContent = c.style.display === 'none' ? 'Clique para expandir' : 'Clique para fechar';" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; cursor: pointer; background: #f8bbd0;">
                                        <div style="display: flex; align-items: center; gap: 10px;">
                                            <span class="toggle-icon" style="font-size: 12px; color: #c2185b;">â–¶</span>
                                            <h3 style="font-size: 14px; color: #c2185b; margin: 0;">ğŸ‘© HistÃ³ria Gineco-ObstÃ©trica</h3>
                                            <span style="font-size: 11px; color: #880e4f; font-style: italic;">Apenas para pacientes do sexo feminino</span>
                                        </div>
                                        <span class="toggle-text" style="font-size: 11px; color: #880e4f; background: white; padding: 4px 8px; border-radius: 4px;">Clique para expandir</span>
                                    </div>
                                    
                                    <div id="pront-expand-gineco" style="display: none; padding: 15px;">
                                        <!-- CONTAINER GESTAÃ‡Ã•ES -->
                                        <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #ec407a; margin-bottom: 15px;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                                <h3 style="font-size: 14px; color: #c2185b; margin: 0;">ğŸ¤° GestaÃ§Ãµes</h3>
                                                <select id="pront-gineco-gestacoes" onchange="ProntuarioModular.toggleGestacao(this.value)" style="padding: 8px 12px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="nao">NulÃ­para (nunca engravidou)</option>
                                                    <option value="sim">JÃ¡ teve gestaÃ§Ã£o(Ãµes)</option>
                                                </select>
                                            </div>
                                            
                                            <div id="pront-texto-nulipara" style="padding: 10px; background: #fce4ec; border-radius: 6px; text-align: center; color: #666; font-size: 13px;">
                                                Paciente nulÃ­para - sem histÃ³rico gestacional
                                            </div>
                                            
                                            <div id="pront-campos-gpa" style="display: none;">
                                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 12px;">
                                                <div style="background: #fce4ec; padding: 12px; border-radius: 6px; text-align: center;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">GestaÃ§Ãµes (G)</label>
                                                    <input type="number" id="pront-gineco-g" min="0" max="20" value="0" style="width: 60px; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 18px; font-weight: bold; text-align: center; color: #c2185b;">
                                                </div>
                                                <div style="background: #fce4ec; padding: 12px; border-radius: 6px; text-align: center;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Partos (P)</label>
                                                    <input type="number" id="pront-gineco-p" min="0" max="20" value="0" style="width: 60px; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 18px; font-weight: bold; text-align: center; color: #c2185b;">
                                                </div>
                                                <div style="background: #fce4ec; padding: 12px; border-radius: 6px; text-align: center;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Abortos (A)</label>
                                                    <input type="number" id="pront-gineco-a" min="0" max="20" value="0" style="width: 60px; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 18px; font-weight: bold; text-align: center; color: #c2185b;">
                                                </div>
                                            </div>
                                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                                <div style="background: #fce4ec; padding: 10px; border-radius: 6px;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Partos Vaginais</label>
                                                    <input type="number" id="pront-gineco-pv" min="0" max="20" value="0" style="width: 100%; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 14px; text-align: center;">
                                                </div>
                                                <div style="background: #fce4ec; padding: 10px; border-radius: 6px;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">CesÃ¡reas</label>
                                                    <input type="number" id="pront-gineco-c" min="0" max="20" value="0" style="width: 100%; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 14px; text-align: center;">
                                                </div>
                                            </div>
                                            <div style="background: #fce4ec; padding: 10px; border-radius: 6px;">
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre gestaÃ§Ãµes</label>
                                                <textarea id="pront-gineco-obs-gest" rows="2" style="width: 100%; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 13px;" placeholder="Ex: 1 aborto espontÃ¢neo no 1Âº trimestre, cesÃ¡rea por sofrimento fetal..."></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- CONTAINER ANTICONCEPCIONAL -->
                                    <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #9c27b0; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #7b1fa2; margin: 0 0 15px 0;">ğŸ’Š Anticoncepcional</h3>
                                        
                                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Usa anticoncepcional?</label>
                                                <select id="pront-gineco-anticonc" onchange="document.getElementById('pront-anticonc-detalhes').style.display = this.value === 'sim' ? 'block' : 'none'" style="width: 100%; padding: 10px; border: 1px solid #ce93d8; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="nao">NÃ£o</option>
                                                    <option value="sim">Sim</option>
                                                </select>
                                            </div>
                                            <div id="pront-anticonc-detalhes" style="display: none;">
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">MÃ©todo utilizado</label>
                                                <select id="pront-gineco-metodo" style="width: 100%; padding: 10px; border: 1px solid #ce93d8; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="">Selecione...</option>
                                                    <option value="pÃ­lula">PÃ­lula anticoncepcional</option>
                                                    <option value="diu-cobre">DIU de cobre</option>
                                                    <option value="diu-mirena">DIU Mirena (hormonal)</option>
                                                    <option value="implante">Implante subdÃ©rmico</option>
                                                    <option value="injetavel-mensal">InjetÃ¡vel mensal</option>
                                                    <option value="injetavel-trimestral">InjetÃ¡vel trimestral</option>
                                                    <option value="adesivo">Adesivo</option>
                                                    <option value="anel">Anel vaginal</option>
                                                    <option value="laqueadura">Laqueadura tubÃ¡ria</option>
                                                    <option value="preservativo">Preservativo</option>
                                                    <option value="outro">Outro</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div style="margin-top: 12px;">
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre anticoncepÃ§Ã£o</label>
                                            <textarea id="pront-gineco-obs-anticonc" rows="1" style="width: 100%; padding: 8px; border: 1px solid #ce93d8; border-radius: 6px; font-size: 13px;" placeholder="Ex: Usa hÃ¡ 5 anos, sem intercorrÃªncias..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- CONTAINER CICLO MENSTRUAL -->
                                    <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #ff9800;">
                                        <h3 style="font-size: 14px; color: #e65100; margin: 0 0 15px 0;">ğŸ©¸ Ciclo Menstrual</h3>
                                        
                                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Menarca (1Âª menstruaÃ§Ã£o)</label>
                                                <div style="display: flex; gap: 6px; align-items: center;">
                                                    <input type="number" id="pront-gineco-menarca" min="8" max="20" placeholder="12" style="width: 70px; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; text-align: center;">
                                                    <span style="font-size: 13px; color: #666;">anos</span>
                                                </div>
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Menopausa</label>
                                                <select id="pront-gineco-menopausa" onchange="document.getElementById('pront-menopausa-idade').style.display = this.value === 'sim' ? 'flex' : 'none'" style="padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="nao">NÃ£o</option>
                                                    <option value="sim">Sim</option>
                                                </select>
                                                <div id="pront-menopausa-idade" style="display: none; gap: 6px; align-items: center; margin-top: 6px;">
                                                    <input type="number" id="pront-gineco-idade-menopausa" min="35" max="65" placeholder="50" style="width: 70px; padding: 8px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; text-align: center;">
                                                    <span style="font-size: 12px; color: #666;">anos</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Ciclo</label>
                                                <select id="pront-gineco-ciclo" style="width: 100%; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="">Selecione...</option>
                                                    <option value="regular">Regular</option>
                                                    <option value="irregular">Irregular</option>
                                                    <option value="amenorreia">Amenorreia</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Intervalo (dias)</label>
                                                <input type="text" id="pront-gineco-intervalo" placeholder="28-30" style="width: 100%; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">DuraÃ§Ã£o fluxo</label>
                                                <div style="display: flex; gap: 6px; align-items: center;">
                                                    <input type="number" id="pront-gineco-duracao" min="1" max="15" placeholder="5" style="width: 60px; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; text-align: center;">
                                                    <span style="font-size: 12px; color: #666;">dias</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">DUM (Ãšltima MenstruaÃ§Ã£o)</label>
                                                <input type="date" id="pront-gineco-dum" style="width: 100%; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Intensidade do fluxo</label>
                                                <select id="pront-gineco-fluxo" style="width: 100%; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="">Selecione...</option>
                                                    <option value="leve">Leve</option>
                                                    <option value="moderado">Moderado</option>
                                                    <option value="intenso">Intenso</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre ciclo menstrual</label>
                                            <textarea id="pront-gineco-obs-ciclo" rows="2" style="width: 100%; padding: 8px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px;" placeholder="Ex: Dismenorreia, TPM intensa, sangramento intermenstrual, uso de medicaÃ§Ã£o para cÃ³lica..."></textarea>
                                        </div>
                                    </div>
                                    </div><!-- Fim pront-expand-gineco -->
                                </div><!-- Fim container gineco colapsÃ¡vel -->
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HISTÃ“RIA FAMILIAR - EXATAMENTE COMO NO ARQUIVO CORRETO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'h-familiar': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 15px 0; color: #333; font-size: 15px;">HistÃ³ria Familiar</h4>
                                <p style="color: #666; font-size: 13px; margin-bottom: 20px;">Antecedentes familiares relevantes</p>
                                
                                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                                    <button onclick="ProntuarioModular.adicionarFamiliar()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; flex: 1;">
                                        Adicionar Familiar
                                    </button>
                                    <button onclick="ProntuarioModular.gerenciarParentescos()" style="padding: 10px 20px; background: #ff9800; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                        Gerenciar Parentescos
                                    </button>
                                    <button onclick="ProntuarioModular.gerenciarDoencasFamiliares()" style="padding: 10px 20px; background: #ff9800; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                        Gerenciar DoenÃ§as
                                    </button>
                                </div>
                                
                                <div id="pront-listaFamiliares"></div>
                                
                                <div class="prontuario-form-grid" style="margin-top: 20px;">
                                    <div class="prontuario-form-group full">
                                        <label>ObservaÃ§Ãµes Gerais sobre HistÃ³ria Familiar</label>
                                        <textarea style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 60px;" placeholder="InformaÃ§Ãµes adicionais relevantes sobre a famÃ­lia..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HISTÃ“RIA SOCIAL - EXATAMENTE COMO NO ARQUIVO CORRETO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'h-social': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 20px 0; color: #333; font-size: 15px; display: flex; align-items: center; gap: 10px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                                    HistÃ³ria Social e HÃ¡bitos de Vida
                                    <span style="font-size: 12px; color: #666; font-weight: normal;">Estilo de vida, hÃ¡bitos e contexto social</span>
                                </h4>
                                
                                <!-- CONTAINER ESTADO CIVIL -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #e91e63; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #c2185b; margin: 0;">ğŸ’ Estado Civil</h3>
                                        <select id="pront-social-estadocivil" style="padding: 8px 12px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="solteiro">Solteiro(a)</option>
                                            <option value="casado">Casado(a)</option>
                                            <option value="uniao">UniÃ£o estÃ¡vel</option>
                                            <option value="divorciado">Divorciado(a)</option>
                                            <option value="separado">Separado(a)</option>
                                            <option value="viuvo">ViÃºvo(a)</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER FILHOS -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #00bcd4; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #0097a7; margin: 0;">ğŸ‘¶ Filhos</h3>
                                        <select id="pront-social-filhos" onchange="document.getElementById('pront-expand-filhos').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #b2ebf2; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">NÃ£o tem filhos</option>
                                            <option value="sim">Tem filhos</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-filhos" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; margin-bottom: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Quantos filhos?</label>
                                                <input type="number" id="pront-filhos-qtd" min="1" max="20" placeholder="2" style="width: 100%; padding: 10px; border: 1px solid #b2ebf2; border-radius: 6px; text-align: center; font-size: 16px; font-weight: bold;">
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Idades (anos)</label>
                                                <input type="text" id="pront-filhos-idades" placeholder="Ex: 5, 12, 18" style="width: 100%; padding: 10px; border: 1px solid #b2ebf2; border-radius: 6px;">
                                            </div>
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes</label>
                                            <textarea id="pront-filhos-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #b2ebf2; border-radius: 6px; font-size: 13px;" placeholder="Ex: Moram com o paciente, dependentes, etc..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER TABAGISMO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #795548; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #5d4037; margin: 0;">ğŸš¬ Tabagismo</h3>
                                        <select id="pront-social-tabaco" onchange="document.getElementById('pront-expand-tabaco').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #d7ccc8; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">NÃ£o fuma / Nunca fumou</option>
                                            <option value="ativo">Fumante ativo</option>
                                            <option value="passivo">Fumante passivo</option>
                                            <option value="ex">Ex-fumante</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-tabaco" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <button onclick="ProntuarioModular.adicionarTabaco()" style="padding: 8px 16px; background: #795548; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; margin-bottom: 12px;">
                                            + Adicionar Tipo de Fumo
                                        </button>
                                        <div id="pront-listaTabaco" style="min-height: 30px;"></div>
                                        <div style="margin-top: 12px;">
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes gerais</label>
                                            <textarea id="pront-tabaco-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #d7ccc8; border-radius: 6px; font-size: 13px;" placeholder="Ex: Tentativas de parar, carga tabÃ¡gica calculada..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER ETILISMO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #f59e0b; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #b45309; margin: 0;">ğŸº Etilismo</h3>
                                        <select id="pront-social-alcool" onchange="document.getElementById('pront-expand-alcool').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #fcd34d; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">NÃ£o bebe / Nunca bebeu</option>
                                            <option value="esporadico">EsporÃ¡dico (1-2x/ano)</option>
                                            <option value="social">Social (ocasiÃµes)</option>
                                            <option value="moderado">Moderado (semanal)</option>
                                            <option value="frequente">Frequente (diÃ¡rio)</option>
                                            <option value="ex">Ex-etilista</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-alcool" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <button onclick="ProntuarioModular.adicionarAlcool()" style="padding: 8px 16px; background: #f59e0b; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; margin-bottom: 12px;">
                                            + Adicionar Tipo de Bebida
                                        </button>
                                        <div id="pront-listaAlcool" style="min-height: 30px;"></div>
                                        <div style="margin-top: 12px;">
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes gerais</label>
                                            <textarea id="pront-alcool-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; font-size: 13px;" placeholder="Ex: Finais de semana, histÃ³rico de problemas relacionados ao Ã¡lcool..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER OUTRAS DROGAS -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #9333ea; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #7e22ce; margin: 0;">ğŸ’Š Outras Drogas/SubstÃ¢ncias</h3>
                                        <select id="pront-social-drogas" onchange="document.getElementById('pront-expand-drogas').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #c4b5fd; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">Nega uso</option>
                                            <option value="atual">Uso atual</option>
                                            <option value="pregresso">Uso pregresso</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-drogas" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <button onclick="ProntuarioModular.adicionarDroga()" style="padding: 8px 16px; background: #9333ea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; margin-bottom: 12px;">
                                            + Adicionar SubstÃ¢ncia
                                        </button>
                                        <div id="pront-listaDrogas" style="min-height: 30px;"></div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER ATIVIDADE FÃSICA -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #22c55e; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #16a34a; margin: 0;">ğŸƒ Atividade FÃ­sica</h3>
                                        <select id="pront-social-exercicio" onchange="document.getElementById('pront-expand-exercicio').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #86efac; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">SedentÃ¡rio</option>
                                            <option value="leve">Leve (1-2x/semana)</option>
                                            <option value="moderado">Moderado (3-4x/semana)</option>
                                            <option value="intenso">Intenso (5+x/semana)</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-exercicio" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <button onclick="ProntuarioModular.adicionarAtividade()" style="padding: 8px 16px; background: #22c55e; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; margin-bottom: 12px;">
                                            + Adicionar Atividade
                                        </button>
                                        <div id="pront-listaAtividades" style="min-height: 30px;"></div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER ALIMENTAÃ‡ÃƒO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #ef4444; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #dc2626; margin: 0;">ğŸ AlimentaÃ§Ã£o</h3>
                                        <select id="pront-social-alimentacao" onchange="document.getElementById('pront-expand-alimentacao').style.display = (this.value !== '' && this.value !== 'equilibrada') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #fca5a5; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="equilibrada">Equilibrada/SaudÃ¡vel</option>
                                            <option value="irregular">Irregular</option>
                                            <option value="restritiva">Restritiva/Dieta</option>
                                            <option value="vegetariana">Vegetariana</option>
                                            <option value="vegana">Vegana</option>
                                            <option value="hipossodica">HipossÃ³dica</option>
                                            <option value="diabetico">Para diabÃ©tico</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-alimentacao" style="display: none; background: white; padding: 12px; border-radius: 6px; margin-top: 15px;">
                                        <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre alimentaÃ§Ã£o</label>
                                        <textarea id="pront-alimentacao-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; font-size: 13px;" placeholder="Ex: RestriÃ§Ãµes alimentares, nÃºmero de refeiÃ§Ãµes/dia, preferÃªncias..."></textarea>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER SONO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #6366f1;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #4f46e5; margin: 0;">ğŸ˜´ Sono e Rotina</h3>
                                        <select id="pront-social-sono" onchange="document.getElementById('pront-expand-sono').style.display = (this.value !== '' && this.value !== 'bom') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #a5b4fc; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="bom">Bom (7-8h, reparador)</option>
                                            <option value="regular">Regular (5-6h)</option>
                                            <option value="ruim">Ruim (insÃ´nia, fragmentado)</option>
                                            <option value="irregular">Irregular (horÃ¡rios variados)</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-sono" style="display: none; background: white; padding: 12px; border-radius: 6px; margin-top: 15px;">
                                        <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre sono e rotina</label>
                                        <textarea id="pront-sono-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #a5b4fc; border-radius: 6px; font-size: 13px;" placeholder="Ex: Horas de sono, qualidade, uso de medicaÃ§Ãµes para dormir, trabalho noturno..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // CONTROLE HOSPITALAR (DPO, ATB) - ABAIXO DO CABEÃ‡ALHO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'controle-hospitalar': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 15px 0; color: #333; font-size: 15px;">Controle Hospitalar</h4>
                                <p style="color: #666; font-size: 13px; margin-bottom: 20px;">InformaÃ§Ãµes de acompanhamento pÃ³s-operatÃ³rio e antibioticoterapia</p>
                                
                                <!-- CONTAINER DPO -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #0ea5e9; margin-bottom: 15px; padding: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #0ea5e9; margin: 0;">ğŸ“… DPO - Dia PÃ³s-OperatÃ³rio</h3>
                                        <button onclick="ProntuarioModular.adicionarDPO()" style="padding: 8px 16px; background: #0ea5e9; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;">+ Adicionar DPO</button>
                                    </div>
                                    <div id="pront-listaDPO" style="min-height: 30px;"></div>
                                    <label style="display: flex; align-items: center; gap: 8px; padding: 10px; background: #dbeafe; border-radius: 6px; cursor: pointer; font-size: 12px; margin-top: 10px;">
                                        <input type="checkbox" id="pront-dpo-manter" onchange="ProntuarioModular.salvarControleHospitalar()">
                                        <span style="color: #1e40af;">ğŸ“Œ Manter na prÃ³xima evoluÃ§Ã£o (atualiza DPO automaticamente)</span>
                                    </label>
                                </div>
                                
                                <!-- CONTAINER ATB EM USO -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #22c55e; margin-bottom: 15px; padding: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <div style="display: flex; align-items: center; gap: 10px;">
                                            <h3 style="font-size: 14px; color: #22c55e; margin: 0;">ğŸ’Š AntibiÃ³tico em Uso</h3>
                                            <button onclick="ProntuarioModular.gerenciarAntibioticos()" style="padding: 4px 10px; background: #ff9800; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;">Pool</button>
                                        </div>
                                        <button onclick="ProntuarioModular.adicionarATB()" style="padding: 8px 16px; background: #22c55e; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;">+ Adicionar ATB</button>
                                    </div>
                                    <div id="pront-listaATB" style="min-height: 30px;"></div>
                                    <label style="display: flex; align-items: center; gap: 8px; padding: 10px; background: #dcfce7; border-radius: 6px; cursor: pointer; font-size: 12px; margin-top: 10px;">
                                        <input type="checkbox" id="pront-atb-manter" onchange="ProntuarioModular.salvarControleHospitalar()">
                                        <span style="color: #166534;">ğŸ“Œ Manter na prÃ³xima evoluÃ§Ã£o (atualiza dia de uso automaticamente)</span>
                                    </label>
                                </div>
                                
                                <!-- CONTAINER ATB SUSPENSO -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #f59e0b; padding: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <div style="display: flex; align-items: center; gap: 10px;">
                                            <h3 style="font-size: 14px; color: #f59e0b; margin: 0;">ğŸ”¶ AntibiÃ³tico Suspenso</h3>
                                            <button onclick="ProntuarioModular.gerenciarAntibioticos()" style="padding: 4px 10px; background: #ff9800; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;">Pool</button>
                                        </div>
                                        <button onclick="ProntuarioModular.adicionarATBSuspenso()" style="padding: 8px 16px; background: #f59e0b; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;">+ Adicionar ATB Suspenso</button>
                                    </div>
                                    <div id="pront-listaATBSusp" style="min-height: 30px;"></div>
                                    <label style="display: flex; align-items: center; gap: 8px; padding: 10px; background: #fef3c7; border-radius: 6px; cursor: pointer; font-size: 12px; margin-top: 10px;">
                                        <input type="checkbox" id="pront-atb-susp-manter" onchange="ProntuarioModular.salvarControleHospitalar()">
                                        <span style="color: #92400e;">ğŸ“Œ Manter na prÃ³xima evoluÃ§Ã£o (histÃ³rico de antibiÃ³ticos)</span>
                                    </label>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // EVOLUÃ‡ÃƒO - CAMPO ABERTO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'evolucao': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 15px 0; color: #333; font-size: 15px;">EvoluÃ§Ã£o</h4>
                                <p style="color: #666; font-size: 13px; margin-bottom: 15px;">EvoluÃ§Ã£o clÃ­nica do paciente</p>
                                <textarea style="width: 100%; padding: 15px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 150px; font-size: 14px; line-height: 1.6;" placeholder="Descreva a evoluÃ§Ã£o do paciente, intercorrÃªncias, exames, condutas tomadas..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // EXAME FÃSICO GERAL - CORRIGIDO IGUAL AO ARQUIVO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'exame-geral': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 15px 0; color: #333; font-size: 15px;">Exame FÃ­sico Geral</h4>
                                <p style="color: #666; font-size: 13px; margin-bottom: 20px;">AvaliaÃ§Ã£o clÃ­nica comum a todas as especialidades</p>
                                
                                <!-- SINAIS VITAIS - COLAPSÃVEL -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #ef4444; margin-bottom: 15px; overflow: hidden;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; cursor: pointer;" onclick="const c = document.getElementById('pront-expand-sv'); const i = this.querySelector('.toggle-icon'); c.style.display = c.style.display === 'none' ? 'block' : 'none'; i.textContent = c.style.display === 'none' ? 'â–¶' : 'â–¼';">
                                        <h3 style="font-size: 14px; color: #333; margin: 0; display: flex; align-items: center; gap: 8px;">
                                            <span class="toggle-icon" style="font-size: 10px; color: #666;">â–¼</span>
                                            Sinais Vitais
                                        </h3>
                                    </div>
                                    <div id="pront-expand-sv" style="padding: 0 15px 15px 15px; border-top: 1px solid #e0e0e0;">
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">PA (mmHg)</label>
                                                <div style="display: flex; gap: 6px; align-items: center;">
                                                    <input type="number" id="pront-pa-sistolica" placeholder="120" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                                    <span style="font-weight: bold; font-size: 12px;">/</span>
                                                    <input type="number" id="pront-pa-diastolica" placeholder="80" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                                </div>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">FC (bpm)</label>
                                                <input type="number" id="pront-fc" placeholder="72" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">FR (irpm)</label>
                                                <input type="number" id="pront-fr" placeholder="16" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Temp (Â°C)</label>
                                                <input type="number" step="0.1" id="pront-temp" placeholder="36.5" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">SpOâ‚‚ (%)</label>
                                                <input type="number" id="pront-spo2" placeholder="98" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">GC (mg/dL)</label>
                                                <input type="number" id="pront-glicemia" placeholder="105" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ANTROPOMETRIA - COLAPSÃVEL -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #22c55e; margin-bottom: 15px; overflow: hidden;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; cursor: pointer;" onclick="const c = document.getElementById('pront-expand-antrop'); const i = this.querySelector('.toggle-icon'); c.style.display = c.style.display === 'none' ? 'block' : 'none'; i.textContent = c.style.display === 'none' ? 'â–¶' : 'â–¼';">
                                        <h3 style="font-size: 14px; color: #333; margin: 0; display: flex; align-items: center; gap: 8px;">
                                            <span class="toggle-icon" style="font-size: 10px; color: #666;">â–¼</span>
                                            Antropometria
                                        </h3>
                                    </div>
                                    <div id="pront-expand-antrop" style="padding: 0 15px 15px 15px; border-top: 1px solid #e0e0e0;">
                                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Peso (kg)</label>
                                                <input type="text" id="pront-peso" placeholder="65,5" oninput="this.value = this.value.replace(',', '.'); ProntuarioModular.calcularIMCAutomatic && ProntuarioModular.calcularIMCAutomatic()" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Altura (cm)</label>
                                                <input type="text" id="pront-altura" placeholder="165" oninput="this.value = this.value.replace(',', '.'); ProntuarioModular.calcularIMCAutomatic && ProntuarioModular.calcularIMCAutomatic()" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">IMC</label>
                                                <input type="text" id="pront-imc" readonly style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f0f0f0; font-weight: bold;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">ClassificaÃ§Ã£o</label>
                                                <input type="text" id="pront-imc-class" readonly style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f0f0f0; font-weight: bold;">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ECTOSCOPIA - COLAPSÃVEL -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #3b82f6; overflow: hidden;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; cursor: pointer;" onclick="const c = document.getElementById('pront-expand-ecto'); const i = this.querySelector('.toggle-icon'); c.style.display = c.style.display === 'none' ? 'block' : 'none'; i.textContent = c.style.display === 'none' ? 'â–¶' : 'â–¼';">
                                        <h3 style="font-size: 14px; color: #333; margin: 0; display: flex; align-items: center; gap: 8px;">
                                            <span class="toggle-icon" style="font-size: 10px; color: #666;">â–¼</span>
                                            Ectoscopia (InspeÃ§Ã£o Geral)
                                        </h3>
                                    </div>
                                    <div id="pront-expand-ecto" style="padding: 0 15px 15px 15px; border-top: 1px solid #e0e0e0;">
                                
                                        <!-- Linha 1: Estado Geral, ConsciÃªncia, Estado Nutricional -->
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 15px; margin-bottom: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Estado Geral</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="bom">Bom</option>
                                                    <option value="regular">Regular</option>
                                                    <option value="comprometido">Comprometido</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">ConsciÃªncia</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="lucido">LÃºcido(a) e orientado(a)</option>
                                                    <option value="confuso">Confuso(a)</option>
                                                    <option value="sonolento">Sonolento(a)</option>
                                                    <option value="torporoso">Torporoso(a)</option>
                                                    <option value="comatoso">Comatoso(a)</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Estado Nutricional</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="desnutrido">Desnutrido(a)</option>
                                                    <option value="eutrofico" selected>EutrÃ³fico(a)</option>
                                                    <option value="sobrepeso">Sobrepeso</option>
                                                    <option value="obeso">Obeso(a)</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <!-- Linha 2: ColoraÃ§Ã£o, HidrataÃ§Ã£o, Cianose, IcterÃ­cia -->
                                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">ColoraÃ§Ã£o</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="hipocorado4">Hipocorado(a) ++++/4+</option>
                                                    <option value="hipocorado3">Hipocorado(a) +++/4+</option>
                                                    <option value="hipocorado2">Hipocorado(a) ++/4+</option>
                                                    <option value="hipocorado1">Hipocorado(a) +/4+</option>
                                                    <option value="normocorado" selected>Normocorado(a)</option>
                                                    <option value="hipercorado1">Hipercorado(a) +/4+</option>
                                                    <option value="hipercorado2">Hipercorado(a) ++/4+</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">HidrataÃ§Ã£o</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="desidratado4">Desidratado(a) ++++/4+</option>
                                                    <option value="desidratado3">Desidratado(a) +++/4+</option>
                                                    <option value="desidratado2">Desidratado(a) ++/4+</option>
                                                    <option value="desidratado1">Desidratado(a) +/4+</option>
                                                    <option value="limiar">Hidratado(a) no limiar</option>
                                                    <option value="hidratado" selected>Hidratado(a)</option>
                                                    <option value="hipervolemico">HipervolÃªmico(a)</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Cianose</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="acianotico" selected>AcianÃ³tico(a)</option>
                                                    <option value="periferico1">CianÃ³tico(a) perifÃ©rico +/4+</option>
                                                    <option value="periferico2">CianÃ³tico(a) perifÃ©rico ++/4+</option>
                                                    <option value="periferico3">CianÃ³tico(a) perifÃ©rico +++/4+</option>
                                                    <option value="periferico4">CianÃ³tico(a) perifÃ©rico ++++/4+</option>
                                                    <option value="central1">CianÃ³tico(a) central +/4+</option>
                                                    <option value="central2">CianÃ³tico(a) central ++/4+</option>
                                                    <option value="central3">CianÃ³tico(a) central +++/4+</option>
                                                    <option value="central4">CianÃ³tico(a) central ++++/4+</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">IcterÃ­cia</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="anict" selected>AnictÃ©rico(a)</option>
                                                    <option value="leve">IctÃ©rico(a) +/4+</option>
                                                    <option value="moderado">IctÃ©rico(a) ++/4+</option>
                                                    <option value="grave">IctÃ©rico(a) +++/4+</option>
                                                    <option value="intenso">IctÃ©rico(a) ++++/4+</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <!-- Linha 3: Temperatura, Batimentos, RespiraÃ§Ã£o -->
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Temperatura</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="afebril" selected>Afebril</option>
                                                    <option value="subfebril">Subfebril</option>
                                                    <option value="febril">Febril</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Batimentos CardÃ­acos</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="bradicardico">BradicÃ¡rdico(a)</option>
                                                    <option value="normocardico" selected>NormocÃ¡rdico(a)</option>
                                                    <option value="taquicardico">TaquicÃ¡rdico(a)</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">RespiraÃ§Ã£o</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="bradipneico">Bradipneico(a)</option>
                                                    <option value="eupneico" selected>Eupneico(a)</option>
                                                    <option value="taquipneico">Taquipneico(a)</option>
                                                    <option value="dispneico">Dispneico(a)</option>
                                                </select>
                                            </div>
                                        </div>
                                
                                        <!-- Campo de descriÃ§Ã£o por Ãºltimo -->
                                        <div class="prontuario-form-group full">
                                            <label style="font-size: 12px;">DescriÃ§Ã£o da Ectoscopia</label>
                                            <textarea placeholder="ObservaÃ§Ãµes adicionais sobre a inspeÃ§Ã£o geral..." rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // EXAME FÃSICO ESPECÃFICO - ESTRUTURA ESCALÃVEL v10.356
                        // Taxonomia: Mapeamento â†’ Sistemas â†’ Especialidades
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'exame-especifico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #8b5cf6;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                                    <h4 style="margin: 0; color: #333; font-size: 15px;">ğŸ¯ Exame FÃ­sico EspecÃ­fico</h4>
                                </div>
                                
                                <!-- BOTÃ•ES DE CATEGORIA -->
                                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                                    <button onclick="
                                        const painel = document.getElementById('sandbox-painel-mapeamento');
                                        const isOpen = painel.style.display !== 'none';
                                        painel.style.display = isOpen ? 'none' : 'block';
                                        this.style.background = isOpen ? 'white' : '#8b5cf6';
                                        this.style.color = isOpen ? '#8b5cf6' : 'white';
                                    " style="flex: 1; padding: 12px 16px; background: white; border: 2px solid #8b5cf6; color: #8b5cf6; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px;">
                                        ğŸ“ Mapa do Corpo
                                    </button>
                                    <button onclick="
                                        const painel = document.getElementById('sandbox-painel-sistemas');
                                        const isOpen = painel.style.display !== 'none';
                                        painel.style.display = isOpen ? 'none' : 'block';
                                        this.style.background = isOpen ? 'white' : '#3b82f6';
                                        this.style.color = isOpen ? '#3b82f6' : 'white';
                                    " style="flex: 1; padding: 12px 16px; background: white; border: 2px solid #3b82f6; color: #3b82f6; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px;">
                                        ğŸ”„ Sistemas
                                    </button>
                                    <button onclick="
                                        const painel = document.getElementById('sandbox-painel-especialidades');
                                        const isOpen = painel.style.display !== 'none';
                                        painel.style.display = isOpen ? 'none' : 'block';
                                        this.style.background = isOpen ? 'white' : '#22c55e';
                                        this.style.color = isOpen ? '#22c55e' : 'white';
                                    " style="flex: 1; padding: 12px 16px; background: white; border: 2px solid #22c55e; color: #22c55e; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px;">
                                        ğŸ¥ Especialidades
                                    </button>
                                </div>
                                
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <!-- PAINEL: MAPEAMENTO CORPORAL -->
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <div id="sandbox-painel-mapeamento" style="display: none; background: #f5f3ff; padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid #c4b5fd;">
                                    <div style="font-size: 12px; color: #6d28d9; font-weight: 600; margin-bottom: 12px;">ğŸ“ MAPEAMENTO CORPORAL</div>
                                    
                                    <!-- Exame por RegiÃµes -->
                                    <div style="margin-bottom: 12px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #d8b4fe; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="
                                                const container = document.getElementById('sandbox-container-map-lesoes');
                                                if (this.checked) {
                                                    container.style.display = 'block';
                                                    if (typeof AnatomiaAtendimento !== 'undefined') {
                                                        AnatomiaAtendimento.renderizar('sandbox-container-map-lesoes', {
                                                            visualizacao: 'frente',
                                                            template: '',
                                                            permitirEdicao: true,
                                                            modoSimplificado: true,
                                                            contextoInicial: 'anatomico'
                                                        });
                                                    }
                                                } else {
                                                    container.style.display = 'none';
                                                }
                                            "> 
                                            ğŸ—ºï¸ Exame por RegiÃµes
                                        </label>
                                        <div id="sandbox-container-map-lesoes" style="display: none; margin-top: 10px; min-height: 400px;"></div>
                                    </div>
                                    
                                    <!-- Queimaduras -->
                                    <div style="margin-bottom: 12px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #d8b4fe; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="
                                                const container = document.getElementById('sandbox-container-map-queimaduras');
                                                if (this.checked) {
                                                    container.style.display = 'block';
                                                    if (typeof AnatomiaAtendimento !== 'undefined') {
                                                        AnatomiaAtendimento.renderizar('sandbox-container-map-queimaduras', {
                                                            visualizacao: 'frente',
                                                            template: '',
                                                            permitirEdicao: true,
                                                            modoSimplificado: true,
                                                            contextoInicial: 'queimados'
                                                        });
                                                    }
                                                } else {
                                                    container.style.display = 'none';
                                                }
                                            "> 
                                            ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras
                                        </label>
                                        <div id="sandbox-container-map-queimaduras" style="display: none; margin-top: 10px; min-height: 400px;"></div>
                                    </div>
                                    
                                    <p style="margin: 10px 0 0 0; font-size: 10px; color: #888;">ğŸ’¡ Clique nas regiÃµes da silhueta para marcar achados</p>
                                </div>
                                
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <!-- PAINEL: SISTEMAS ORGÃ‚NICOS -->
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <div id="sandbox-painel-sistemas" style="display: none; background: #eff6ff; padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid #93c5fd;">
                                    <div style="font-size: 12px; color: #1d4ed8; font-weight: 600; margin-bottom: 12px;">ğŸ”„ SISTEMAS ORGÃ‚NICOS</div>
                                    
                                    <!-- Cardiovascular -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-cardio').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ«€ Cardiovascular
                                        </label>
                                        <div id="sandbox-sis-cardio" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                                <div><label style="font-size: 10px; color: #666;">FC:</label><input type="text" placeholder="bpm" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">Ritmo:</label><input type="text" placeholder="Regular/Irregular" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">Bulhas:</label><input type="text" placeholder="B1/B2 normofonÃ©ticas" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                            </div>
                                            <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="Sopros, estase jugular, edema, pulsos perifÃ©ricos..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- RespiratÃ³rio -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-resp').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ« RespiratÃ³rio
                                        </label>
                                        <div id="sandbox-sis-resp" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                                <div><label style="font-size: 10px; color: #666;">FR:</label><input type="text" placeholder="irpm" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">SpO2:</label><input type="text" placeholder="%" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">PadrÃ£o:</label><input type="text" placeholder="Eupneico" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                            </div>
                                            <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="MV presente bilateralmente, ruÃ­dos adventÃ­cios..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- DigestÃ³rio -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-digest').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ©º DigestÃ³rio
                                        </label>
                                        <div id="sandbox-sis-digest" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="Abdome: inspeÃ§Ã£o, ausculta, percussÃ£o, palpaÃ§Ã£o. RHA, dor, massas, visceromegalias..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Nervoso -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-neuro').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ§  Nervoso
                                        </label>
                                        <div id="sandbox-sis-neuro" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                                <div><label style="font-size: 10px; color: #666;">Glasgow:</label><input type="text" placeholder="AO+RV+RM" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">Pupilas:</label><input type="text" placeholder="IsocÃ³ricas/Fotorreagentes" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                            </div>
                                            <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="ForÃ§a motora, sensibilidade, reflexos, coordenaÃ§Ã£o, marcha..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Tegumentar -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-tegum').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ”¬ Tegumentar
                                        </label>
                                        <div id="sandbox-sis-tegum" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="Pele, mucosas, anexos. ColoraÃ§Ã£o, turgor, lesÃµes elementares..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Vascular -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-vasc').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ©¸ Vascular PerifÃ©rico
                                        </label>
                                        <div id="sandbox-sis-vasc" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="Pulsos perifÃ©ricos, enchimento capilar, varizes, edema, sinais de TVP..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <!-- PAINEL: ESPECIALIDADES -->
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <div id="sandbox-painel-especialidades" style="display: none; background: #f0fdf4; padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid #86efac;">
                                    <div style="font-size: 12px; color: #15803d; font-weight: 600; margin-bottom: 12px;">ğŸ¥ ESPECIALIDADES</div>
                                    
                                    <!-- Bucomaxilofacial -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-bmf').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ¦· Bucomaxilofacial
                                        </label>
                                        <div id="sandbox-esp-bmf" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="OclusÃ£o, abertura bucal, ATM, dentiÃ§Ã£o, mucosa oral, terÃ§os faciais..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Oftalmologia -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-oftalmo').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ‘ï¸ Oftalmologia
                                        </label>
                                        <div id="sandbox-esp-oftalmo" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                                <div><label style="font-size: 10px; color: #666;">AV OD:</label><input type="text" placeholder="20/20" style="width: 100%; padding: 6px; border: 1px solid #86efac; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">AV OE:</label><input type="text" placeholder="20/20" style="width: 100%; padding: 6px; border: 1px solid #86efac; border-radius: 4px; font-size: 12px;"></div>
                                            </div>
                                            <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="Biomicroscopia, fundoscopia, motilidade ocular extrÃ­nseca, PIO..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Ortopedia -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-orto').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ¦´ Ortopedia
                                        </label>
                                        <div id="sandbox-esp-orto" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="InspeÃ§Ã£o, palpaÃ§Ã£o, ADM, forÃ§a muscular, testes especiais..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Otorrinolaringologia -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-orl').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ‘‚ Otorrinolaringologia
                                        </label>
                                        <div id="sandbox-esp-orl" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="Otoscopia, rinoscopia, oroscopia, laringoscopia..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Cirurgia Vascular -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-vascular').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ©¸ Cirurgia Vascular
                                        </label>
                                        <div id="sandbox-esp-vascular" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="Ãndice tornozelo-braquial, varizes (CEAP), Ãºlceras..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ObservaÃ§Ãµes gerais -->
                                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px dashed #ddd;">
                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes adicionais</label>
                                    <textarea id="pront-exame-especifico-obs" rows="2" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Outras observaÃ§Ãµes..."></textarea>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // MÃ“DULOS INDIVIDUAIS DE EXAME ESPECÃFICO (para seleÃ§Ã£o avulsa)
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'mapa-anatomico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f5f3ff; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                                <h4 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ—ºï¸ Exame por RegiÃµes</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 12px;">
                                    <div style="background: white; padding: 15px; border-radius: 6px; text-align: center;">
                                        <p style="font-size: 11px; color: #666; margin: 0 0 10px 0;">Vista Anterior</p>
                                        <div style="width: 150px; height: 200px; background: #f0f0f0; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #999;">[Silhueta Anterior]</div>
                                    </div>
                                    <div style="background: white; padding: 15px; border-radius: 6px; text-align: center;">
                                        <p style="font-size: 11px; color: #666; margin: 0 0 10px 0;">Vista Posterior</p>
                                        <div style="width: 150px; height: 200px; background: #f0f0f0; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #999;">[Silhueta Posterior]</div>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; font-size: 13px;" placeholder="Descreva localizaÃ§Ã£o e caracterÃ­sticas das lesÃµes..."></textarea>
                            </div>
                        `,
                        'avaliacao-queimaduras': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #ef4444;">
                                <h4 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">MÃ©todo de CÃ¡lculo:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                            <option>Regra dos 9 (Wallace)</option>
                                            <option>Lund-Browder (pediÃ¡trico)</option>
                                            <option>Palma da mÃ£o (1%)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">SCQ Total (%):</label>
                                        <input type="number" min="0" max="100" placeholder="%" style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px; font-size: 16px; font-weight: bold; text-align: center;">
                                    </div>
                                </div>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                                    <div style="background: white; padding: 10px; border-radius: 6px; text-align: center;">
                                        <div style="font-size: 11px; color: #666;">1Âº Grau</div>
                                        <input type="number" min="0" max="100" placeholder="%" style="width: 60px; padding: 6px; border: 1px solid #fca5a5; border-radius: 4px; text-align: center; margin-top: 4px;">
                                    </div>
                                    <div style="background: white; padding: 10px; border-radius: 6px; text-align: center;">
                                        <div style="font-size: 11px; color: #666;">2Âº Grau</div>
                                        <input type="number" min="0" max="100" placeholder="%" style="width: 60px; padding: 6px; border: 1px solid #fca5a5; border-radius: 4px; text-align: center; margin-top: 4px;">
                                    </div>
                                    <div style="background: white; padding: 10px; border-radius: 6px; text-align: center;">
                                        <div style="font-size: 11px; color: #666;">3Âº Grau</div>
                                        <input type="number" min="0" max="100" placeholder="%" style="width: 60px; padding: 6px; border: 1px solid #fca5a5; border-radius: 4px; text-align: center; margin-top: 4px;">
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; font-size: 13px;" placeholder="Ex: Escaldadura por Ã¡gua quente, acometendo face anterior de tÃ³rax e MMSS..."></textarea>
                            </div>
                        `,
                        'avaliacao-feridas': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fffbeb; border-radius: 8px; border-left: 4px solid #f59e0b;">
                                <h4 style="margin: 0 0 12px 0; color: #d97706; font-size: 14px;">ğŸ©¹ AvaliaÃ§Ã£o de Feridas</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Tipo:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px;">
                                            <option>Incisa</option><option>Contusa</option><option>Lacerada</option><option>Perfurante</option><option>AvulsÃ£o</option><option>AbrasÃ£o</option><option>Ãšlcera</option><option>DeiscÃªncia</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">DimensÃµes (cm):</label>
                                        <input type="text" placeholder="Ex: 5x3x1" style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Leito:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px;">
                                            <option>GranulaÃ§Ã£o</option><option>EpitelizaÃ§Ã£o</option><option>Necrose</option><option>Esfacelo</option><option>Misto</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fcd34d; border-radius: 6px; font-size: 13px;" placeholder="LocalizaÃ§Ã£o, bordas, exsudato, sinais de infecÃ§Ã£o..."></textarea>
                            </div>
                        `,
                        'exame-cardiovascular': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #dc2626;">
                                <h4 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸ«€ Exame Cardiovascular</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Ritmo:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                            <option>Regular, 2 tempos</option><option>Regular, 3 tempos (B3)</option><option>Regular, 3 tempos (B4)</option><option>Irregular</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Bulhas:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                            <option>NormofonÃ©ticas</option><option>HipofonÃ©ticas</option><option>HiperfonÃ©ticas</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; font-size: 13px;" placeholder="Sopros, pulsos perifÃ©ricos, estase jugular, edema..."></textarea>
                            </div>
                        `,
                        'exame-respiratorio': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #0ea5e9;">
                                <h4 style="margin: 0 0 12px 0; color: #0284c7; font-size: 14px;">ğŸ« Exame RespiratÃ³rio</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">MurmÃºrio Vesicular:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px;">
                                            <option>Presente bilateral, simÃ©trico</option><option>DiminuÃ­do Ã  direita</option><option>DiminuÃ­do Ã  esquerda</option><option>DiminuÃ­do bilateral</option><option>Abolido Ã  direita</option><option>Abolido Ã  esquerda</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">RuÃ­dos AdventÃ­cios:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px;">
                                            <option>Ausentes</option><option>Estertores crepitantes</option><option>Estertores bolhosos</option><option>Sibilos</option><option>Roncos</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #7dd3fc; border-radius: 6px; font-size: 13px;" placeholder="Expansibilidade, percussÃ£o, tiragem, uso de musculatura acessÃ³ria..."></textarea>
                            </div>
                        `,
                        'exame-abdominal': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f0fdf4; border-radius: 8px; border-left: 4px solid #22c55e;">
                                <h4 style="margin: 0 0 12px 0; color: #16a34a; font-size: 14px;">ğŸ©º Exame Abdominal</h4>
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">InspeÃ§Ã£o:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                            <option>Plano</option><option>Globoso</option><option>Escavado</option><option>Distendido</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">RHA:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                            <option>Presentes</option><option>Aumentados</option><option>DiminuÃ­dos</option><option>Ausentes</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">PalpaÃ§Ã£o:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                            <option>FlÃ¡cido, indolor</option><option>Tenso</option><option>Doloroso difuso</option><option>Doloroso localizado</option><option>Defesa</option><option>DescompressÃ£o +</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Visceromegalias:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                            <option>Ausentes</option><option>Hepatomegalia</option><option>Esplenomegalia</option><option>Ambas</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; font-size: 13px;" placeholder="Massas, hÃ©rnias, cicatrizes, sinais de irritaÃ§Ã£o peritoneal..."></textarea>
                            </div>
                        `,
                        'exame-neurologico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #faf5ff; border-radius: 8px; border-left: 4px solid #a855f7;">
                                <h4 style="margin: 0 0 12px 0; color: #9333ea; font-size: 14px;">ğŸ§  Exame NeurolÃ³gico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">NÃ­vel de consciÃªncia:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                            <option>Alerta, orientado</option><option>Sonolento</option><option>Torporoso</option><option>Comatoso</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Pupilas:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                            <option>IsocÃ³ricas, fotorreagentes</option><option>AnisocÃ³ricas</option><option>MidrÃ­ase bilateral</option><option>Miose bilateral</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">ForÃ§a muscular:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                            <option>Preservada (grau V)</option><option>DiminuÃ­da</option><option>Hemiparesia D</option><option>Hemiparesia E</option><option>Paraparesia</option><option>Tetraparesia</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; font-size: 13px;" placeholder="Reflexos, sensibilidade, coordenaÃ§Ã£o, marcha, sinais menÃ­ngeos..."></textarea>
                            </div>
                        `,
                        'exame-ortopedico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fafaf9; border-radius: 8px; border-left: 4px solid #78716c;">
                                <h4 style="margin: 0 0 12px 0; color: #57534e; font-size: 14px;">ğŸ¦´ Exame OrtopÃ©dico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">RegiÃ£o acometida:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px;">
                                            <option>Coluna cervical</option><option>Coluna torÃ¡cica</option><option>Coluna lombar</option><option>Ombro</option><option>Cotovelo</option><option>Punho/MÃ£o</option><option>Quadril</option><option>Joelho</option><option>Tornozelo/PÃ©</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Lateralidade:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px;">
                                            <option>Direito</option><option>Esquerdo</option><option>Bilateral</option><option>Linha mÃ©dia</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #d6d3d1; border-radius: 6px; font-size: 13px;" placeholder="InspeÃ§Ã£o (edema, deformidade, equimose), palpaÃ§Ã£o, amplitude de movimento, testes especiais, avaliaÃ§Ã£o neurovascular distal..."></textarea>
                            </div>
                        `,
                        'exame-vascular': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fff1f2; border-radius: 8px; border-left: 4px solid #be123c;">
                                <h4 style="margin: 0 0 12px 0; color: #be123c; font-size: 14px;">ğŸ©¸ Exame Vascular PerifÃ©rico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Pulsos perifÃ©ricos:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                            <option>Presentes e simÃ©tricos</option><option>DiminuÃ­dos</option><option>Ausentes Ã  direita</option><option>Ausentes Ã  esquerda</option><option>Ausentes bilateral</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">PerfusÃ£o:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                            <option>Adequada (TEC < 3s)</option><option>Lentificada (TEC 3-5s)</option><option>Muito lenta (TEC > 5s)</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fda4af; border-radius: 6px; font-size: 13px;" placeholder="Edema, varizes, Ãºlceras, alteraÃ§Ãµes de cor/temperatura, ITB..."></textarea>
                            </div>
                        `,
                        'exame-dermatologico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fdf2f8; border-radius: 8px; border-left: 4px solid #ec4899;">
                                <h4 style="margin: 0 0 12px 0; color: #db2777; font-size: 14px;">ğŸ”¬ Exame DermatolÃ³gico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">LesÃ£o elementar:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                            <option>MÃ¡cula</option><option>PÃ¡pula</option><option>Placa</option><option>NÃ³dulo</option><option>VesÃ­cula</option><option>Bolha</option><option>PÃºstula</option><option>Ãšlcera</option><option>ErosÃ£o</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">DistribuiÃ§Ã£o:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                            <option>Localizada</option><option>Disseminada</option><option>Generalizada</option><option>Ãreas fotoexpostas</option><option>Ãreas intertriginosas</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #f9a8d4; border-radius: 6px; font-size: 13px;" placeholder="Cor, tamanho, bordas, superfÃ­cie, anexos cutÃ¢neos..."></textarea>
                            </div>
                        `,
                        'exame-oftalmologico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #ecfeff; border-radius: 8px; border-left: 4px solid #0891b2;">
                                <h4 style="margin: 0 0 12px 0; color: #0e7490; font-size: 14px;">ğŸ‘ï¸ Exame OftalmolÃ³gico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">AV OD:</label>
                                        <input type="text" placeholder="20/20" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">AV OE:</label>
                                        <input type="text" placeholder="20/20" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Reflexos pupilares:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                            <option>Preservados</option><option>Alterados</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #67e8f9; border-radius: 6px; font-size: 13px;" placeholder="Biomicroscopia, fundoscopia, motilidade ocular extrÃ­nseca..."></textarea>
                            </div>
                        `,
                        'exame-otorrino': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f5f3ff; border-radius: 8px; border-left: 4px solid #7c3aed;">
                                <h4 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ‘‚ Exame OtorrinolaringolÃ³gico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Otoscopia:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                            <option>Normal bilateral</option><option>Hiperemia OD</option><option>Hiperemia OE</option><option>Cerume</option><option>PerfuraÃ§Ã£o</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Rinoscopia:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                            <option>Normal</option><option>Hiperemia</option><option>Edema</option><option>Desvio septal</option><option>PÃ³lipos</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Orofaringe:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                            <option>Normal</option><option>Hiperemia</option><option>Hipertrofia amÃ­gdalas</option><option>Exsudato</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; font-size: 13px;" placeholder="Acumetria, palpaÃ§Ã£o cervical, laringoscopia..."></textarea>
                            </div>
                        `,
                        'exame-bucomaxilo': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #ecfdf5; border-radius: 8px; border-left: 4px solid #059669;">
                                <h4 style="margin: 0 0 12px 0; color: #047857; font-size: 14px;">ğŸ¦· Exame Bucomaxilofacial</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Abertura bucal:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px;">
                                            <option>Normal (> 40mm)</option><option>Limitada (20-40mm)</option><option>Muito limitada (< 20mm)</option><option>Trismo</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">ATM:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px;">
                                            <option>Sem alteraÃ§Ãµes</option><option>Estalido</option><option>CrepitaÃ§Ã£o</option><option>Dor Ã  palpaÃ§Ã£o</option><option>LuxaÃ§Ã£o</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #6ee7b7; border-radius: 6px; font-size: 13px;" placeholder="Face, oclusÃ£o dentÃ¡ria, mucosa oral, glÃ¢ndulas salivares, fraturas..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HIPÃ“TESE DIAGNÃ“STICA
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'hipotese': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #92400e; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ¯ HipÃ³tese DiagnÃ³stica
                                </h4>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="DiagnÃ³stico principal e diagnÃ³sticos diferenciais..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // CID-10
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'cid10': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #4338ca; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ·ï¸ CID-10
                                </h4>
                                <div style="display: flex; gap: 12px;">
                                    <input type="text" placeholder="CÃ³digo (ex: J18.9)" style="width: 150px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; font-weight: 600;">
                                    <input type="text" placeholder="DescriÃ§Ã£o" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // CONDUTA
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'conduta': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #ecfdf5; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #065f46; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    Conduta
                                </h4>
                                <textarea rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Plano terapÃªutico, orientaÃ§Ãµes, retorno..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // PRESCRIÃ‡ÃƒO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'prescricao': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #555; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ’‰ PrescriÃ§Ã£o
                                </h4>
                                <textarea rows="5" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="1) Medicamento - dose - via - frequÃªncia - duraÃ§Ã£o"></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // EXAMES A SOLICITAR
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'exames-solicitar': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #6b21a8; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ”¬ Exames a Solicitar
                                </h4>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Hemograma completo, Glicemia jejum, ECG, RX tÃ³rax..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ENCAMINHAMENTO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'encaminhamento': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #c2410c; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    â¡ï¸ Encaminhamento
                                </h4>
                                <div style="margin-bottom: 12px;">
                                    <input type="text" placeholder="Especialidade" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Motivo do encaminhamento, informaÃ§Ãµes relevantes..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // DESCRIÃ‡ÃƒO CIRÃšRGICA
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'desc-cirurgica': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #166534; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ”ª DescriÃ§Ã£o CirÃºrgica
                                </h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <input type="text" placeholder="Procedimento" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                    <input type="text" placeholder="DuraÃ§Ã£o" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                    <input type="text" placeholder="Anestesia" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                </div>
                                <textarea rows="6" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="1. Paciente em DDH, sob anestesia geral..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // PLANEJAMENTO CIRÃšRGICO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'planejamento': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fdf4ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #86198f; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ“… Planejamento CirÃºrgico
                                </h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <input type="text" placeholder="Procedimento planejado" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                    <input type="date" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                </div>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="TÃ©cnica, materiais, preparo prÃ©-operatÃ³rio, exames necessÃ¡rios..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ESCALA DE GLASGOW
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'glasgow': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px;">Escala de Coma de Glasgow</h4>
                                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">PontuaÃ§Ã£o: 3 (mÃ­nimo) a 15 (mÃ¡ximo)</p>
                                
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px;">
                                    <!-- Abertura Ocular -->
                                    <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 12px; font-weight: 600; color: #333; display: block; margin-bottom: 8px;">Abertura Ocular (AO)</label>
                                        <select id="glasgow-ao" onchange="ProntuarioModular.calcularGlasgow && ProntuarioModular.calcularGlasgow()" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                            <option value="4">4 - EspontÃ¢nea</option>
                                            <option value="3">3 - Ao comando verbal</option>
                                            <option value="2">2 - Ã€ dor</option>
                                            <option value="1">1 - Ausente</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Resposta Verbal -->
                                    <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 12px; font-weight: 600; color: #333; display: block; margin-bottom: 8px;">Resposta Verbal (RV)</label>
                                        <select id="glasgow-rv" onchange="ProntuarioModular.calcularGlasgow && ProntuarioModular.calcularGlasgow()" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                            <option value="5">5 - Orientada</option>
                                            <option value="4">4 - Confusa</option>
                                            <option value="3">3 - Palavras inapropriadas</option>
                                            <option value="2">2 - Sons incompreensÃ­veis</option>
                                            <option value="1">1 - Ausente</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Resposta Motora -->
                                    <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 12px; font-weight: 600; color: #333; display: block; margin-bottom: 8px;">Resposta Motora (RM)</label>
                                        <select id="glasgow-rm" onchange="ProntuarioModular.calcularGlasgow && ProntuarioModular.calcularGlasgow()" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                            <option value="6">6 - Obedece comandos</option>
                                            <option value="5">5 - Localiza dor</option>
                                            <option value="4">4 - Retirada Ã  dor</option>
                                            <option value="3">3 - FlexÃ£o anormal (decorticaÃ§Ã£o)</option>
                                            <option value="2">2 - ExtensÃ£o anormal (descerebraÃ§Ã£o)</option>
                                            <option value="1">1 - Ausente</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Resultado -->
                                <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <span style="font-size: 13px; color: #666;">PontuaÃ§Ã£o Total:</span>
                                        <span id="glasgow-total" style="font-size: 24px; font-weight: bold; color: #333; margin-left: 10px;">15</span>
                                        <span style="font-size: 13px; color: #666;">/15</span>
                                    </div>
                                    <div id="glasgow-classificacao" style="padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; background: #dcfce7; color: #166534;">
                                        TCE Leve
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ESCALA DE BRADEN
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'braden': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px;">Escala de Braden - Risco de LesÃ£o por PressÃ£o</h4>
                                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">PontuaÃ§Ã£o: 6-23 (menor = maior risco)</p>
                                
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 15px;">
                                    <!-- PercepÃ§Ã£o Sensorial -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">PercepÃ§Ã£o Sensorial</label>
                                        <select id="braden-sensorial" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Nenhuma limitaÃ§Ã£o</option>
                                            <option value="3">3 - Levemente limitada</option>
                                            <option value="2">2 - Muito limitada</option>
                                            <option value="1">1 - Totalmente limitada</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Umidade -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">Umidade</label>
                                        <select id="braden-umidade" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Raramente molhada</option>
                                            <option value="3">3 - Ocasionalmente molhada</option>
                                            <option value="2">2 - Muito molhada</option>
                                            <option value="1">1 - Constantemente molhada</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Atividade -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">Atividade</label>
                                        <select id="braden-atividade" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Deambula frequentemente</option>
                                            <option value="3">3 - Deambula ocasionalmente</option>
                                            <option value="2">2 - Confinado Ã  cadeira</option>
                                            <option value="1">1 - Acamado</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Mobilidade -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">Mobilidade</label>
                                        <select id="braden-mobilidade" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Nenhuma limitaÃ§Ã£o</option>
                                            <option value="3">3 - Levemente limitada</option>
                                            <option value="2">2 - Muito limitada</option>
                                            <option value="1">1 - Totalmente imÃ³vel</option>
                                        </select>
                                    </div>
                                    
                                    <!-- NutriÃ§Ã£o -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">NutriÃ§Ã£o</label>
                                        <select id="braden-nutricao" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Excelente</option>
                                            <option value="3">3 - Adequada</option>
                                            <option value="2">2 - Provavelmente inadequada</option>
                                            <option value="1">1 - Muito pobre</option>
                                        </select>
                                    </div>
                                    
                                    <!-- FricÃ§Ã£o e Cisalhamento -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">FricÃ§Ã£o e Cisalhamento</label>
                                        <select id="braden-friccao" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="3">3 - Nenhum problema</option>
                                            <option value="2">2 - Problema potencial</option>
                                            <option value="1">1 - Problema</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Resultado -->
                                <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <span style="font-size: 13px; color: #666;">PontuaÃ§Ã£o Total:</span>
                                        <span id="braden-total" style="font-size: 24px; font-weight: bold; color: #333; margin-left: 10px;">23</span>
                                        <span style="font-size: 13px; color: #666;">/23</span>
                                    </div>
                                    <div id="braden-risco" style="padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; background: #dcfce7; color: #166534;">
                                        Sem Risco
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // AVALIAÃ‡ÃƒO ABCDE (TRAUMA)
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'abcde': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px;">AvaliaÃ§Ã£o PrimÃ¡ria - ABCDE</h4>
                                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">AvaliaÃ§Ã£o sistemÃ¡tica do paciente traumatizado (ATLS)</p>
                                
                                <!-- A - Airway -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 10px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #ef4444; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">A</span>
                                        <span style="font-weight: 600; color: #333;">Airway - Via AÃ©rea (com proteÃ§Ã£o cervical)</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                        <select id="abcde-a-status" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="pervia">Via aÃ©rea pÃ©rvia</option>
                                            <option value="obstruida-parcial">ObstruÃ§Ã£o parcial</option>
                                            <option value="obstruida-total">ObstruÃ§Ã£o total</option>
                                            <option value="iot">IOT realizada</option>
                                        </select>
                                        <input type="text" placeholder="ObservaÃ§Ãµes..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                                
                                <!-- B - Breathing -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 10px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #f97316; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">B</span>
                                        <span style="font-weight: 600; color: #333;">Breathing - VentilaÃ§Ã£o</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="normal">VentilaÃ§Ã£o normal</option>
                                            <option value="taquipneia">Taquipneia</option>
                                            <option value="bradipneia">Bradipneia</option>
                                            <option value="dispneia">Dispneia</option>
                                            <option value="apneia">Apneia</option>
                                        </select>
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="mv-bilateral">MV bilateral presente</option>
                                            <option value="mv-diminuido-d">MV diminuÃ­do D</option>
                                            <option value="mv-diminuido-e">MV diminuÃ­do E</option>
                                            <option value="mv-ausente-d">MV ausente D</option>
                                            <option value="mv-ausente-e">MV ausente E</option>
                                        </select>
                                        <input type="text" placeholder="SpOâ‚‚, FR..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                                
                                <!-- C - Circulation -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 10px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #eab308; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">C</span>
                                        <span style="font-weight: 600; color: #333;">Circulation - CirculaÃ§Ã£o (com controle de hemorragia)</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="estavel">Hemodinamicamente estÃ¡vel</option>
                                            <option value="instavel">Instabilidade hemodinÃ¢mica</option>
                                            <option value="choque">Choque</option>
                                        </select>
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="pulso-cheio">Pulso cheio e regular</option>
                                            <option value="pulso-filiforme">Pulso filiforme</option>
                                            <option value="pulso-irregular">Pulso irregular</option>
                                            <option value="pulso-ausente">Pulso ausente</option>
                                        </select>
                                        <input type="text" placeholder="PA, FC, Hemorragias..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                                
                                <!-- D - Disability -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 10px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #22c55e; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">D</span>
                                        <span style="font-weight: 600; color: #333;">Disability - AvaliaÃ§Ã£o NeurolÃ³gica</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="a">A - Alerta</option>
                                            <option value="v">V - Responde a estÃ­mulo verbal</option>
                                            <option value="p">P - Responde a dor</option>
                                            <option value="u">U - NÃ£o responsivo</option>
                                        </select>
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="pupilas-isocoricas">Pupilas isocÃ³ricas</option>
                                            <option value="pupilas-anisocoricas">Pupilas anisocÃ³ricas</option>
                                            <option value="pupilas-midriaticas">MidrÃ­ase bilateral</option>
                                            <option value="pupilas-mioticas">Miose bilateral</option>
                                        </select>
                                        <input type="text" placeholder="Glasgow, Glicemia..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                                
                                <!-- E - Exposure -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #3b82f6; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">E</span>
                                        <span style="font-weight: 600; color: #333;">Exposure - ExposiÃ§Ã£o (com prevenÃ§Ã£o de hipotermia)</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="sem-lesoes">Sem lesÃµes aparentes</option>
                                            <option value="escoriacoes">EscoriaÃ§Ãµes</option>
                                            <option value="contusoes">ContusÃµes</option>
                                            <option value="lac-simples">LaceraÃ§Ãµes simples</option>
                                            <option value="lac-complexas">LaceraÃ§Ãµes complexas</option>
                                            <option value="fraturas">Fraturas expostas</option>
                                        </select>
                                        <input type="text" placeholder="Temperatura, LesÃµes identificadas..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ESCALA RASS (Richmond Agitation-Sedation)
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'rass': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px;">Escala RASS - Richmond Agitation-Sedation</h4>
                                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">AvaliaÃ§Ã£o do nÃ­vel de sedaÃ§Ã£o/agitaÃ§Ã£o</p>
                                
                                <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                    <select id="rass-valor" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                        <option value="+4">+4 Combativo - Violento, perigo imediato para a equipe</option>
                                        <option value="+3">+3 Muito agitado - Puxa ou remove tubos, agressivo</option>
                                        <option value="+2">+2 Agitado - Movimentos frequentes sem propÃ³sito, briga com o ventilador</option>
                                        <option value="+1">+1 Inquieto - Ansioso, mas sem movimentos agressivos</option>
                                        <option value="0" selected>0 Alerta e calmo</option>
                                        <option value="-1">-1 Sonolento - NÃ£o totalmente alerta, mas mantÃ©m olhos abertos >10s</option>
                                        <option value="-2">-2 SedaÃ§Ã£o leve - Desperta brevemente, contato visual <10s</option>
                                        <option value="-3">-3 SedaÃ§Ã£o moderada - Movimento ou abertura ocular ao estÃ­mulo verbal, sem contato visual</option>
                                        <option value="-4">-4 SedaÃ§Ã£o profunda - Sem resposta ao estÃ­mulo verbal, movimento ao estÃ­mulo fÃ­sico</option>
                                        <option value="-5">-5 NÃ£o despertÃ¡vel - Sem resposta ao estÃ­mulo verbal ou fÃ­sico</option>
                                    </select>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // MÃ“DULOS CIRÃšRGICOS - v10.358
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'consentimento': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fefce8; border-radius: 8px; border-left: 4px solid #eab308;">
                                <h4 style="margin: 0 0 12px 0; color: #854d0e; font-size: 14px;">âœï¸ Termo de Consentimento</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Procedimento proposto:</label>
                                        <input type="text" style="width: 100%; padding: 10px; border: 1px solid #fde047; border-radius: 6px; margin-top: 4px;" placeholder="Nome do procedimento">
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Data assinatura:</label>
                                            <input type="date" style="width: 100%; padding: 10px; border: 1px solid #fde047; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">ResponsÃ¡vel (se menor):</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #fde047; border-radius: 6px; margin-top: 4px;" placeholder="Nome do responsÃ¡vel">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Riscos informados:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fde047; border-radius: 6px; margin-top: 4px;" placeholder="Riscos explicados ao paciente..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'anestesia': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #faf5ff; border-radius: 8px; border-left: 4px solid #a855f7;">
                                <h4 style="margin: 0 0 12px 0; color: #7e22ce; font-size: 14px;">ğŸ’‰ Ficha de Anestesia</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Tipo de anestesia:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                                <option value="">Selecione...</option>
                                                <option>Geral</option><option>Raquianestesia</option><option>Peridural</option>
                                                <option>Bloqueio de plexo</option><option>Local</option><option>SedaÃ§Ã£o</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">ASA:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                                <option>ASA I</option><option>ASA II</option><option>ASA III</option>
                                                <option>ASA IV</option><option>ASA V</option><option>ASA VI</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Drogas utilizadas:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;" placeholder="MedicaÃ§Ãµes, doses..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'pos-op': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f0fdf4; border-radius: 8px; border-left: 4px solid #22c55e;">
                                <h4 style="margin: 0 0 12px 0; color: #15803d; font-size: 14px;">ğŸ¥ PÃ³s-OperatÃ³rio</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">DPO:</label>
                                            <input type="number" min="0" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Destino:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                                <option>Enfermaria</option><option>UTI</option><option>RPA</option><option>Alta</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Dieta:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                                <option>Zero</option><option>LÃ­quida</option><option>Pastosa</option><option>Branda</option><option>Livre</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">EvoluÃ§Ã£o pÃ³s-operatÃ³ria:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="Estado geral, ferida operatÃ³ria, drenos..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'drenos': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fff7ed; border-radius: 8px; border-left: 4px solid #f97316;">
                                <h4 style="margin: 0 0 12px 0; color: #c2410c; font-size: 14px;">ğŸ©¹ Drenos e Dispositivos</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Tipo:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #fdba74; border-radius: 6px; margin-top: 4px;">
                                                <option value="">Selecione...</option>
                                                <option>Penrose</option><option>Portovac</option><option>Blake</option>
                                                <option>Tubular</option><option>Sonda vesical</option><option>SNG</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">LocalizaÃ§Ã£o:</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #fdba74; border-radius: 6px; margin-top: 4px;" placeholder="Ex: FID, subcutÃ¢neo">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">DÃ©bito (ml/24h):</label>
                                            <input type="number" style="width: 100%; padding: 10px; border: 1px solid #fdba74; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Aspecto/ObservaÃ§Ãµes:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fdba74; border-radius: 6px; margin-top: 4px;" placeholder="Aspecto do dÃ©bito, funcionamento..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // MÃ“DULOS DE INTERNAÃ‡ÃƒO - v10.358
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'evolucao-soap': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #1d4ed8; font-size: 14px;">ğŸ“‹ EvoluÃ§Ã£o SOAP</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div>
                                        <label style="font-size: 12px; color: #666; font-weight: 600;">S - Subjetivo (queixas do paciente):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 4px;" placeholder="O que o paciente refere..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666; font-weight: 600;">O - Objetivo (exame fÃ­sico):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 4px;" placeholder="Achados ao exame..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666; font-weight: 600;">A - AvaliaÃ§Ã£o (anÃ¡lise):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 4px;" placeholder="ImpressÃ£o diagnÃ³stica..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666; font-weight: 600;">P - Plano (conduta):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 4px;" placeholder="Conduta proposta..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'balanco-hidrico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #ecfeff; border-radius: 8px; border-left: 4px solid #06b6d4;">
                                <h4 style="margin: 0 0 12px 0; color: #0891b2; font-size: 14px;">ğŸ’§ BalanÃ§o HÃ­drico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div style="background: #cffafe; padding: 12px; border-radius: 6px;">
                                        <h5 style="margin: 0 0 8px 0; font-size: 12px; color: #0891b2;">ENTRADAS</h5>
                                        <div style="display: grid; gap: 8px;">
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Dieta VO:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #67e8f9; border-radius: 4px;" placeholder="ml">
                                            </div>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Soro IV:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #67e8f9; border-radius: 4px;" placeholder="ml">
                                            </div>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Hemoderivados:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #67e8f9; border-radius: 4px;" placeholder="ml">
                                            </div>
                                        </div>
                                    </div>
                                    <div style="background: #fef3c7; padding: 12px; border-radius: 6px;">
                                        <h5 style="margin: 0 0 8px 0; font-size: 12px; color: #d97706;">SAÃDAS</h5>
                                        <div style="display: grid; gap: 8px;">
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Diurese:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #fde047; border-radius: 4px;" placeholder="ml">
                                            </div>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Drenos:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #fde047; border-radius: 4px;" placeholder="ml">
                                            </div>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Perdas GI:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #fde047; border-radius: 4px;" placeholder="ml">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-top: 12px; padding: 10px; background: white; border-radius: 6px; text-align: center;">
                                    <span style="font-size: 12px; color: #666;">BALANÃ‡O: </span>
                                    <span style="font-size: 14px; font-weight: bold; color: #0891b2;">Calcular automaticamente</span>
                                </div>
                            </div>
                        `,
                        
                        'alta': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f0fdf4; border-radius: 8px; border-left: 4px solid #22c55e;">
                                <h4 style="margin: 0 0 12px 0; color: #15803d; font-size: 14px;">ğŸ“¤ SumÃ¡rio de Alta</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Data de internaÃ§Ã£o:</label>
                                            <input type="date" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Data de alta:</label>
                                            <input type="date" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">DiagnÃ³stico(s) final(is):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="CID-10 e descriÃ§Ã£o..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Procedimento(s) realizado(s):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="Cirurgias, procedimentos..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">OrientaÃ§Ãµes de alta:</label>
                                        <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="MedicaÃ§Ãµes, cuidados, retorno..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'intercorrencias': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #ef4444;">
                                <h4 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">âš ï¸ IntercorrÃªncias</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Data/Hora:</label>
                                            <input type="datetime-local" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Gravidade:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                                <option>Leve</option><option>Moderada</option><option>Grave</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">DescriÃ§Ã£o da intercorrÃªncia:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;" placeholder="O que aconteceu..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Conduta tomada:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;" placeholder="Medidas adotadas..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'enfermagem': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fdf4ff; border-radius: 8px; border-left: 4px solid #d946ef;">
                                <h4 style="margin: 0 0 12px 0; color: #a21caf; font-size: 14px;">ğŸ‘©â€âš•ï¸ AnotaÃ§Ãµes de Enfermagem</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Turno:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #f0abfc; border-radius: 6px; margin-top: 4px;">
                                                <option>ManhÃ£ (07-13h)</option><option>Tarde (13-19h)</option><option>Noite (19-07h)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Enfermeiro(a):</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #f0abfc; border-radius: 6px; margin-top: 4px;" placeholder="Nome">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">COREN:</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #f0abfc; border-radius: 6px; margin-top: 4px;" placeholder="NÃºmero">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">AnotaÃ§Ãµes:</label>
                                        <textarea rows="4" style="width: 100%; padding: 10px; border: 1px solid #f0abfc; border-radius: 6px; margin-top: 4px;" placeholder="EvoluÃ§Ã£o do paciente, cuidados realizados, intercorrÃªncias..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'parecer': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f5f3ff; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                                <h4 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ‘¨â€âš•ï¸ Parecer Especialista</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Especialidade:</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;" placeholder="Ex: Cardiologia">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">MÃ©dico/CRM:</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;" placeholder="Nome - CRM">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Motivo da solicitaÃ§Ã£o:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;" placeholder="Por que foi solicitado o parecer..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Parecer:</label>
                                        <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;" placeholder="AvaliaÃ§Ã£o e recomendaÃ§Ãµes do especialista..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ALIASES PARA IDs ANTIGOS/ALTERNATIVOS - v10.358
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'h-ginecologica': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fdf2f8; border-radius: 8px; border-left: 4px solid #ec4899;">
                                <h4 style="margin: 0 0 12px 0; color: #be185d; font-size: 14px;">ğŸ‘© HistÃ³ria GinecolÃ³gica</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                                        <div>
                                            <label style="font-size: 11px; color: #666;">Menarca:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="anos">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">DUM:</label>
                                            <input type="date" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">Ciclos:</label>
                                            <input type="text" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="28/5 dias">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">Menopausa:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="anos">
                                        </div>
                                    </div>
                                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px;">
                                        <div>
                                            <label style="font-size: 11px; color: #666;">G:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">P:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">C:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">A:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">E:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'cirurgias-previas': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef3c7; border-radius: 8px; border-left: 4px solid #f59e0b;">
                                <h4 style="margin: 0 0 12px 0; color: #d97706; font-size: 14px;">ğŸ”ª Cirurgias PrÃ©vias</h4>
                                <div id="lista-cirurgias-previas"></div>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 8px;" placeholder="Liste as cirurgias anteriores com ano aproximado...&#10;Ex: Apendicectomia (2015), Colecistectomia (2018)"></textarea>
                            </div>
                        `,
                        
                        'medicacoes': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #dbeafe; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #1d4ed8; font-size: 14px;">ğŸ’Š MedicaÃ§Ãµes em Uso</h4>
                                <div id="lista-medicacoes-uso"></div>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 8px;" placeholder="Liste as medicaÃ§Ãµes de uso contÃ­nuo...&#10;Ex: Losartana 50mg 1x/dia, Metformina 850mg 2x/dia"></textarea>
                            </div>
                        `,
                        
                        'alergias': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #ef4444;">
                                <h4 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸš« Alergias</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div>
                                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                            <input type="checkbox" id="nega-alergias" onchange="document.getElementById('campo-alergias').disabled = this.checked">
                                            <span style="font-size: 13px;">Nega alergias conhecidas</span>
                                        </label>
                                    </div>
                                    <textarea id="campo-alergias" rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px;" placeholder="Liste alergias medicamentosas, alimentares, de contato..."></textarea>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ğŸ“· FOTOS + EDITOR - v10.463
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'fotos': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fefce8; border-radius: 8px; border-left: 4px solid #eab308;">
                                <h4 style="margin: 0 0 12px 0; color: #a16207; font-size: 14px; display: flex; align-items: center; justify-content: space-between;">
                                    <span>ğŸ“· Fotos + Editor</span>
                                    <div style="display: flex; gap: 8px;">
                                        <button onclick="ModuloFotos.adicionar()" style="background: #eab308; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;">+ Adicionar</button>
                                        <button onclick="SimuladorCirurgico.abrir()" style="background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;">ğŸ”¬ Simulador</button>
                                    </div>
                                </h4>
                                <div id="modulo-fotos-galeria" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 12px; min-height: 60px;">
                                    <div style="text-align: center; padding: 20px; color: #9ca3af; grid-column: 1/-1;">
                                        Nenhuma foto adicionada
                                    </div>
                                </div>
                                <input type="file" id="modulo-fotos-input" accept="image/*" multiple style="display: none;" onchange="ModuloFotos.processar(event)">
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ğŸ“ ANEXOS - PDF, DOC, etc - v10.463
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'anexos': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #1d4ed8; font-size: 14px; display: flex; align-items: center; justify-content: space-between;">
                                    <span>ğŸ“ Anexos (PDF, DOC, XLS...)</span>
                                    <button onclick="ModuloAnexos.adicionar()" style="background: #3b82f6; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;">+ Adicionar Arquivo</button>
                                </h4>
                                <div id="modulo-anexos-lista" style="min-height: 60px;">
                                    <div style="text-align: center; padding: 20px; color: #9ca3af;">
                                        Nenhum anexo adicionado
                                    </div>
                                </div>
                                <input type="file" id="modulo-anexos-input" accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.csv,.xml,.zip,.rar,.jpg,.jpeg,.png,.gif,.mp3,.mp4" multiple style="display: none;" onchange="ModuloAnexos.processar(event)">
                                <div style="margin-top: 12px; padding: 10px; background: #dbeafe; border-radius: 6px; font-size: 11px; color: #1e40af;">
                                    ğŸ’¡ <strong>Formatos aceitos:</strong> PDF, DOC, XLS, PPT, TXT, CSV, XML, ZIP, imagens, Ã¡udio, vÃ­deo (mÃ¡x 10MB por arquivo)
                                </div>
                            </div>
                        `
                    };
                    console.log('âœ… [Sandbox] window.TEMPLATES_MODULOS definido com', Object.keys(window.TEMPLATES_MODULOS).length, 'mÃ³dulos');
                } else {
                    console.log('â„¹ï¸ [Sandbox] window.TEMPLATES_MODULOS jÃ¡ estava definido');
                }
            },

            // v10.346: BUSCAR PACIENTE
                    
            buscarPaciente(termo) {
                const lista = document.getElementById('sandbox-lista-pacientes');
                if (!lista) return;
                
                if (!termo || termo.length < 2) {
                    lista.style.display = 'none';
                    return;
                }
                
                const termoLower = termo.toLowerCase();
                const pacientes = SistemaCore.dados.pacientes || [];
                
                const resultados = pacientes.filter(p => {
                    return p.nome?.toLowerCase().includes(termoLower) ||
                           p.cpf?.includes(termo) ||
                           p.prontuario?.toLowerCase().includes(termoLower);
                }).slice(0, 10); // Limitar a 10 resultados
                
                if (resultados.length === 0) {
                    lista.innerHTML = '<div style="padding: 12px; text-align: center; color: #999;">Nenhum paciente encontrado</div>';
                } else {
                    lista.innerHTML = resultados.map(p => `
                        <div onclick="Sandbox.selecionarPaciente(${p.id})" 
                             style="padding: 10px 12px; cursor: pointer; border-bottom: 1px solid #eee; transition: background 0.2s;"
                             onmouseover="this.style.background='#f0f7ff'" 
                             onmouseout="this.style.background='white'">
                            <div style="font-weight: 600; color: #333;">${p.nome}</div>
                            <div style="font-size: 11px; color: #666;">
                                CPF: ${p.cpf || '-'} | ProntuÃ¡rio: ${p.prontuario || '-'}
                            </div>
                        </div>
                    `).join('');
                }
                
                lista.style.display = 'block';
            },
            
            // v10.346: SELECIONAR PACIENTE
            selecionarPaciente(id) {
                const pacientes = SistemaCore.dados.pacientes || [];
                const paciente = pacientes.find(p => p.id === id);
                
                if (!paciente) {
                    Sistema.notificar('âŒ Paciente nÃ£o encontrado', 'erro');
                    return;
                }
                
                this.pacienteSelecionado = paciente;
                
                // Atualizar campo de busca
                document.getElementById('sandbox-busca-paciente').value = paciente.nome;
                
                // Esconder lista
                document.getElementById('sandbox-lista-pacientes').style.display = 'none';
                
                // Mostrar dados do paciente
                document.getElementById('sandbox-sem-paciente').style.display = 'none';
                document.getElementById('sandbox-dados-paciente').style.display = 'block';
                
                // Preencher dados
                document.getElementById('sandbox-pac-nome').textContent = paciente.nome || '-';
                document.getElementById('sandbox-pac-cpf').textContent = paciente.cpf || '-';
                document.getElementById('sandbox-pac-prontuario').textContent = paciente.prontuario || '-';
                document.getElementById('sandbox-pac-nascimento').textContent = paciente.nascimento ? 
                    new Date(paciente.nascimento).toLocaleDateString('pt-BR') + ' (' + this.calcularIdade(paciente.nascimento) + ')' : '-';
                document.getElementById('sandbox-pac-sexo').textContent = paciente.sexo === 'M' ? 'Masculino' : 
                    paciente.sexo === 'F' ? 'Feminino' : paciente.sexo || '-';
                document.getElementById('sandbox-pac-convenio').textContent = paciente.convenio || 'SUS';
                
                console.log('âœ… [Sandbox] Paciente selecionado:', paciente.nome);
                
                // Se jÃ¡ houver modelo selecionado, re-renderizar
                const selectModelo = document.getElementById('sandbox-tipo-doc');
                if (selectModelo?.value) {
                    this.trocarTipo();
                }
            },
            
            // v10.346: LIMPAR SELEÃ‡ÃƒO
            limparPaciente() {
                this.pacienteSelecionado = null;
                
                document.getElementById('sandbox-busca-paciente').value = '';
                document.getElementById('sandbox-lista-pacientes').style.display = 'none';
                document.getElementById('sandbox-dados-paciente').style.display = 'none';
                document.getElementById('sandbox-sem-paciente').style.display = 'block';
                
                // Limpar preview
                document.getElementById('sandbox-preview-area').style.display = 'none';
                document.getElementById('sandbox-tipo-doc').value = '';
            },

            carregarLayoutsCabecalho() {
                // v10.346: Removido - cabeÃ§alho agora faz parte do modelo
                console.log('ğŸ¨ [Sandbox] CabeÃ§alhos sÃ£o carregados via modelo');
            },

            renderizarCabecalhoLayout(layout) {
                console.log('ğŸš€ [v10.423] renderizarCabecalhoLayout CHAMADA!');
                console.log('ğŸš€ [v10.423] Layout:', layout?.nome);
                console.log('ğŸš€ [v10.423] this.pacienteSelecionado:', this.pacienteSelecionado?.nome);
                
                // v10.346: Usar dados reais do estabelecimento
                const estabReal = SistemaCore.dados.estabelecimento || {};
                console.log('ğŸš€ [v10.423] Estabelecimento carregado');
                
                const estab = {
                    razao_social: estabReal.razao_social || 'FUNDAÃ‡ÃƒO HOSPITALAR DO ESTADO DE MINAS GERAIS',
                    nome_fantasia: estabReal.nome_fantasia || 'Hospital JoÃ£o XXIII - FHEMIG',
                    cnpj: estabReal.cnpj || '17.071.143/0001-29',
                    cnes: estabReal.cnes || '2693356',
                    endereco: estabReal.logradouro ? 
                        `${estabReal.logradouro}, ${estabReal.numero || 'S/N'}${estabReal.complemento ? ' - ' + estabReal.complemento : ''} - ${estabReal.bairro || ''} - ${estabReal.cidade || ''}/${estabReal.uf || ''}` :
                        'Av. Professor Alfredo Balena, 400 - Santa EfigÃªnia - Belo Horizonte/MG',
                    telefone: estabReal.telefone || estabReal.celular || '(31) 3239-9200',
                    email: estabReal.email || 'contato@fhemig.mg.gov.br',
                    tipo: estabReal.tipo || 'hospital',
                    especialidades: estabReal.especialidades || [],
                    responsavel_tecnico: estabReal.responsavel_tecnico || '',
                    crm_responsavel: estabReal.crm_responsavel || ''
                };
                
                console.log('ğŸš€ [v10.423] Objeto estab criado');

                // v10.346: Usar paciente SELECIONADO (nÃ£o mais paciente teste fixo)
                const pt = this.pacienteSelecionado;
                
                console.log('ğŸš€ [v10.423] Paciente pt:', pt?.nome);
                
                if (!pt) {
                    console.log('âŒ [v10.423] Paciente NÃƒO selecionado!');
                    return `<div style="padding: 40px; text-align: center; color: var(--text-light);">
                        <div style="font-size: 48px; margin-bottom: 12px;">ğŸ‘†</div>
                        <p>Selecione um paciente acima para visualizar o cabeÃ§alho</p>
                    </div>`;
                }
                
                console.log('âœ… [v10.423] Paciente OK, continuando...');
                
                // Debug
                console.log('ğŸ” [Sandbox] Paciente selecionado:', pt?.nome, '| ProntuÃ¡rio:', pt?.prontuario);
                console.log('ğŸ” [Sandbox] Logo do estabelecimento:', SistemaCore.dados.configuracao?.logo ? 'SIM' : 'NÃƒO');
                console.log('ğŸ” [Sandbox] Logo do layout:', layout.logo);
                
                // v10.346: SEPARAR DADOS DO CADASTRO vs DADOS DO ATENDIMENTO
                const pac = {
                    // === DADOS DO CADASTRO (jÃ¡ existem no paciente) ===
                    nome: pt?.nome || 'PACIENTE TESTE',
                    nome_social: pt?.nome_social || '',
                    prontuario: pt?.prontuario || 'TESTE-000000',
                    nascimento: pt?.nascimento ? new Date(pt.nascimento).toLocaleDateString('pt-BR') : '',
                    idade: pt ? this.calcularIdade(pt.nascimento) : '',
                    sexo: pt?.sexo?.toUpperCase() || '',
                    estado_civil: pt?.estado_civil || '',
                    cor_raca: pt?.cor_raca || '',
                    tipo_documento: pt?.tipo_documento || '',
                    rg: pt?.rg || '',
                    cns: pt?.cns || '',
                    cpf: pt?.cpf || '',
                    naturalidade: pt?.naturalidade || '',
                    nacionalidade: pt?.nacionalidade || '',
                    nome_mae: pt?.nome_mae || '',
                    nome_pai: pt?.nome_pai || '',
                    profissao: pt?.profissao || '',
                    vinculo: pt?.situacao_vinculo || '',
                    
                    // === ENDEREÃ‡O (cadastro) ===
                    cep: pt?.cep || '',
                    estado: pt?.estado || '',
                    cidade: pt?.cidade || '',
                    bairro: pt?.bairro || '',
                    regional: pt?.regional_saude || '',
                    tipo_logradouro: pt?.tipo_logradouro || '',
                    logradouro: pt?.logradouro || '',
                    numero: pt?.numero || '',
                    complemento: pt?.complemento || '',
                    pais: pt?.pais || 'Brasil',
                    
                    // === CONTATO (cadastro) ===
                    telefone: pt?.telefone || pt?.celular || '',
                    tipo_contato: pt?.tipo_contato?.toUpperCase() || 'DIRETO',
                    comentario_contato: pt?.comentario_contato || '',
                    email: pt?.email || '',
                    
                    // === INFORMAÃ‡Ã•ES CLÃNICAS ===
                    alergias: pt?.alergias || '', // v10.388: Alergias
                    
                    // === DADOS DO ATENDIMENTO (preenchidos NA HORA, nÃ£o no cadastro) ===
                    data: new Date().toLocaleDateString('pt-BR'),
                    hora: new Date().toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'}),
                    numero_registro: '', // SerÃ¡ preenchido abaixo se houver entrada
                    local_admissao: '',  // Preenchido no atendimento
                    motivo_atendimento: '', // Preenchido no atendimento
                    nome_acompanhante: '', // Preenchido no atendimento
                    telefone_acompanhante: '', // Preenchido no atendimento
                    convenio: pt?.convenio || 'SUS',
                    leito: '', // SÃ³ apÃ³s internaÃ§Ã£o
                    setor: '', // SÃ³ apÃ³s internaÃ§Ã£o
                    medico_responsavel: '', // Definido no atendimento
                    atendimento: '' // NÃºmero do atendimento
                };
                
                // v10.463: PUXAR DADOS DA ENTRADA ATUAL (se existir)
                const entrada = typeof Atendimentos !== 'undefined' ? Atendimentos.entradaAtual : null;
                if (entrada) {
                    console.log('[v10.463] Entrada atual encontrada:', entrada.id, '| Registro:', entrada.numero_registro);
                    pac.numero_registro = entrada.numero_registro || entrada.id || '';
                    pac.local_admissao = entrada.local || entrada.reparticao_nome || '';
                    pac.motivo_atendimento = entrada.tipo_atendimento || entrada.tipo || '';
                    pac.atendimento = entrada.numero_registro || `AT-${entrada.id}`;
                    
                    // Data/hora da entrada (se disponÃ­vel)
                    if (entrada.data_entrada) {
                        pac.data = new Date(entrada.data_entrada + 'T00:00:00').toLocaleDateString('pt-BR');
                    }
                    if (entrada.hora_entrada) {
                        pac.hora = entrada.hora_entrada;
                    }
                } else {
                    // v10.463: PREVIEW MODE - Mostrar dados de EXEMPLO para visualizaÃ§Ã£o
                    // Isso permite que o usuÃ¡rio veja como o documento vai ficar
                    const hoje = new Date();
                    const ano = hoje.getFullYear();
                    const mes = String(hoje.getMonth() + 1).padStart(2, '0');
                    const dia = String(hoje.getDate()).padStart(2, '0');
                    
                    pac.numero_registro = `${ano}${mes}${dia}-0001`;
                    pac.local_admissao = 'ConsultÃ³rio 01';
                    pac.motivo_atendimento = 'Consulta';
                    pac.atendimento = pac.numero_registro;
                    pac.nome_acompanhante = '';
                    pac.telefone_acompanhante = '';
                    
                    console.log('[v10.463] Preview mode - dados de exemplo gerados');
                }

                const cp = layout.camposPaciente || [];
                const ce = layout.camposEstab || [];

                // FunÃ§Ã£o auxiliar para campo
                const campo = (label, valor, show) => {
                    if (!show) return '';
                    return `<div style="padding: 6px 8px; border-bottom: 1px solid #e5e7eb;"><strong>${label}:</strong> ${valor || '---'}</div>`;
                };

                // Renderizar baseado no tipo
                if (layout.tipoBase === 'folha-rosto') {
                    return this.renderFolhaRostoSandbox(layout, estab, pac, cp, ce, campo);
                } else if (layout.tipoBase === 'minimalista') {
                    return this.renderMinimalistaSandbox(layout, estab, pac, cp, ce);
                } else if (layout.tipoBase === 'compacto') {
                    return this.renderCompactoSandbox(layout, estab, pac, cp, ce);
                } else if (layout.tipoBase === 'completo') {
                    return this.renderCompletoSandbox(layout, estab, pac, cp, ce);
                } else {
                    return this.renderPadraoSandbox(layout, estab, pac, cp, ce);
                }
            },

            calcularIdade(nascimento) {
                if (!nascimento) return 'N/A';
                const hoje = new Date();
                const nasc = new Date(nascimento);
                let idade = hoje.getFullYear() - nasc.getFullYear();
                const m = hoje.getMonth() - nasc.getMonth();
                if (m < 0 || (m === 0 && hoje.getDate() < nasc.getDate())) {
                    idade--;
                }
                return idade + ' anos';
            },

            renderFolhaRostoSandbox(layout, estab, pac, cp, ce, campo) {
                // v10.346: Layout simples - dados completos FHEMIG
                // v10.388: QR Code/Barcode no topo + Alergias
                const config = SistemaCore.dados.configuracao || {};
                const logoUrl = layout.logo?.url || config.logo || null;
                
                // Determinar posiÃ§Ã£o de QR/Barcode
                const qrPosicao = layout.qrcodeConfig?.posicao || 'topo-direita';
                const barPosicao = layout.barcodeConfig?.posicao || 'topo-direita';
                const temCodigosNoTopo = (layout.qrcode && qrPosicao.startsWith('topo')) || 
                                         (layout.barcode && barPosicao.startsWith('topo'));
                
                // HTML para cÃ³digos no topo
                const codigosTopoHTML = temCodigosNoTopo ? `
                    <div style="position: absolute; top: 8px; ${qrPosicao === 'topo-esquerda' || barPosicao === 'topo-esquerda' ? 'left' : 'right'}: 8px; display: flex; gap: 8px; align-items: start;">
                        ${layout.barcode && barPosicao.startsWith('topo') ? `<div style="padding: 4px 8px; background: white; border-radius: 4px;"><div style="width: 80px; height: 25px; background: repeating-linear-gradient(90deg, #000 0px, #000 2px, #fff 2px, #fff 4px);"></div></div>` : ''}
                        ${layout.qrcode && qrPosicao.startsWith('topo') ? `<div style="width: 45px; height: 45px; background: white; border: 1px solid #999; font-size: 9px; display: flex; align-items: center; justify-content: center; border-radius: 4px;">[QR]</div>` : ''}
                    </div>
                ` : '';
                
                // v10.429: MERGE INTELIGENTE DE ALERGIAS
                // Buscar de 2 fontes: cadastro + prontuÃ¡rio atual
                const alergiasCadastro = pac.alergias || '';
                const alergiasHPP = this.buscarAlergiasPaciente(pac) || '';
                
                // Fazer merge sem duplicatas
                const alergiasPaciente = this.mergeAlergias(alergiasCadastro, alergiasHPP);
                
                console.log('ğŸ” [v10.429] Alergias Cadastro:', alergiasCadastro);
                console.log('ğŸ” [v10.429] Alergias HPP:', alergiasHPP);
                console.log('âœ… [v10.429] Alergias Merged:', alergiasPaciente);
                
                return `
                    <div style="border: 2px solid #1f2937; background: white; font-family: Arial, sans-serif; font-size: 11px;">
                        <!-- CABEÃ‡ALHO -->
                        <div style="background: #1e40af; color: white; padding: 16px; text-align: center; position: relative;">
                            ${codigosTopoHTML}
                            ${layout.logo?.ativo && logoUrl ? `<div style="margin-bottom: 8px;"><img src="${logoUrl}" style="max-height: 60px; max-width: 200px;" onerror="this.style.display='none'"></div>` : layout.logo?.ativo ? '<div style="margin-bottom: 8px; font-size: 10px; opacity: 0.7;">[Logo nÃ£o configurada]</div>' : ''}
                            ${ce.includes('razao_social') ? `<div style="font-size: 13px; font-weight: bold;">${estab.razao_social || ''}</div>` : ''}
                            ${ce.includes('nome') ? `<div style="font-size: 11px;">${estab.nome_fantasia || estab.razao_social || ''}</div>` : ''}
                        </div>
                        
                        <div style="background: #f3f4f6; padding: 8px; text-align: center; font-weight: bold; border-bottom: 1px solid #ddd;">
                            FOLHA DE ROSTO DE PRONTUÃRIO
                        </div>

                        <!-- PRONTUÃRIO -->
                        ${cp.includes('prontuario') ? `
                        <div style="padding: 8px; background: #dbeafe; border-bottom: 1px solid #ddd;">
                            <strong>PRONTUÃRIO:</strong> <span style="font-size: 14px; font-weight: bold;">${pac.prontuario}</span>
                        </div>` : ''}

                        <!-- ALERGIAS - v10.388 -->
                        ${cp.includes('alergias') ? `
                        <div style="padding: 10px; background: #fef2f2; border-bottom: 2px solid #fecaca;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 16px;">âš ï¸</span>
                                <span style="color: #dc2626; font-weight: bold; font-size: 12px;">ALERGIAS:</span>
                                <span style="color: #991b1b; font-size: 12px;">${alergiasPaciente || '[Verificar com paciente]'}</span>
                            </div>
                        </div>` : ''}

                        <!-- IDENTIFICAÃ‡ÃƒO -->
                        <div style="padding: 8px; border-bottom: 1px solid #ddd;">
                            <div style="font-weight: bold; background: #e5e7eb; padding: 4px; margin: -8px -8px 8px -8px;">IDENTIFICAÃ‡ÃƒO DO PACIENTE</div>
                            ${cp.includes('nome_social') && pac.nome_social ? `<div><strong>USUÃRIO:</strong> ${pac.nome_social}</div>` : ''}
                            ${cp.includes('nome') ? `<div><strong>NOME CIVIL:</strong> ${pac.nome}</div>` : ''}
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; margin-top: 4px;">
                                ${cp.includes('nascimento') ? `<div><strong>NASCIMENTO:</strong> ${pac.nascimento}</div>` : ''}
                                ${cp.includes('cns') ? `<div><strong>CNS:</strong> ${pac.cns}</div>` : ''}
                                ${cp.includes('idade') ? `<div><strong>IDADE:</strong> ${pac.idade}</div>` : ''}
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 4px; margin-top: 4px;">
                                ${cp.includes('sexo') ? `<div><strong>SEXO:</strong> ${pac.sexo}</div>` : ''}
                                ${cp.includes('estado_civil') ? `<div><strong>ESTADO CIVIL:</strong> ${pac.estado_civil}</div>` : ''}
                            </div>
                            ${cp.includes('cor_raca') ? `<div><strong>COR/RAÃ‡A:</strong> ${pac.cor_raca}</div>` : ''}
                            ${cp.includes('rg') ? `<div><strong>DOCUMENTO:</strong> ${pac.tipo_documento || 'RG'} - ${pac.rg}</div>` : ''}
                            ${cp.includes('naturalidade') ? `<div><strong>NATURALIDADE:</strong> ${pac.naturalidade}</div>` : ''}
                            ${cp.includes('nome_mae') ? `<div><strong>NOME DA MÃƒE:</strong> ${pac.nome_mae}</div>` : ''}
                            ${cp.includes('nome_pai') ? `<div><strong>NOME DO PAI:</strong> ${pac.nome_pai}</div>` : ''}
                            ${cp.includes('profissao') ? `<div><strong>PROFISSÃƒO:</strong> ${pac.profissao}</div>` : ''}
                        </div>

                        <!-- ENDEREÃ‡O -->
                        ${cp.includes('endereco') ? `
                        <div style="padding: 8px; border-bottom: 1px solid #ddd;">
                            <div style="font-weight: bold; background: #e5e7eb; padding: 4px; margin: -8px -8px 8px -8px;">ENDEREÃ‡O DO PACIENTE</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 4px;">
                                <div><strong>CEP:</strong> ${pac.cep || ''}</div>
                                <div><strong>ESTADO:</strong> ${pac.estado || ''}</div>
                            </div>
                            <div><strong>MUNICÃPIO:</strong> ${pac.cidade || ''}</div>
                            <div><strong>BAIRRO:</strong> ${pac.bairro || ''}</div>
                            <div><strong>LOGRADOURO:</strong> ${pac.logradouro || ''}, ${pac.numero || ''} ${pac.complemento || ''}</div>
                        </div>` : ''}

                        <!-- CONTATO -->
                        ${cp.includes('telefone') ? `
                        <div style="padding: 8px; border-bottom: 1px solid #ddd;">
                            <div style="font-weight: bold; background: #e5e7eb; padding: 4px; margin: -8px -8px 8px -8px;">CONTATO DO PACIENTE</div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px;">
                                <div><strong>TELEFONE:</strong> ${pac.telefone || ''}</div>
                                <div><strong>TIPO:</strong> ${pac.tipo_contato || 'DIRETO'}</div>
                                <div>${pac.comentario_contato || ''}</div>
                            </div>
                        </div>` : ''}

                        <!-- DADOS DO ATENDIMENTO - sÃ³ mostra se tiver dados reais -->
                        ${(cp.includes('numero_registro') || cp.includes('local_admissao') || cp.includes('motivo_atendimento')) && 
                          (pac.numero_registro || pac.local_admissao || pac.motivo_atendimento) ? `
                        <div style="padding: 8px; border-bottom: 1px solid #ddd;">
                            <div style="font-weight: bold; background: #e5e7eb; padding: 4px; margin: -8px -8px 8px -8px;">DADOS DO ATENDIMENTO</div>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 4px;">
                                ${cp.includes('numero_registro') && pac.numero_registro ? `<div><strong>NÂº REGISTRO:</strong> ${pac.numero_registro}</div>` : ''}
                                ${cp.includes('data') ? `<div><strong>DATA/HORA:</strong> ${pac.data} ${pac.hora}</div>` : ''}
                                ${cp.includes('local_admissao') && pac.local_admissao ? `<div><strong>LOCAL:</strong> ${pac.local_admissao}</div>` : ''}
                            </div>
                            ${cp.includes('motivo_atendimento') && pac.motivo_atendimento ? `<div><strong>MOTIVO:</strong> ${pac.motivo_atendimento}</div>` : ''}
                        </div>` : (cp.includes('numero_registro') || cp.includes('local_admissao') || cp.includes('motivo_atendimento') || cp.includes('nome_acompanhante')) ? `
                        <div style="padding: 8px; background: #f9fafb; border: 1px dashed #f59e0b; margin: 8px 0; font-size: 10px; color: #92400e;">
                            âš ï¸ <strong>Campos de Triagem/RecepÃ§Ã£o</strong> (NÂº Registro, Local, Motivo, Acompanhante) sÃ£o preenchidos na triagem, antes do atendimento mÃ©dico.
                        </div>` : ''}

                        <!-- ACOMPANHANTE - sÃ³ mostra se tiver dados -->
                        ${cp.includes('nome_acompanhante') && pac.nome_acompanhante ? `
                        <div style="padding: 8px;">
                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 4px;">
                                <div><strong>ACOMPANHANTE:</strong> ${pac.nome_acompanhante}</div>
                                ${cp.includes('telefone_acompanhante') && pac.telefone_acompanhante ? `<div><strong>TEL:</strong> ${pac.telefone_acompanhante}</div>` : ''}
                            </div>
                        </div>` : ''}

                        <!-- CÃ“DIGOS NO RODAPÃ‰ (se posiÃ§Ã£o for abaixo-dados) -->
                        ${(layout.barcode && barPosicao === 'abaixo-dados') || (layout.qrcode && !qrPosicao.startsWith('topo')) ? `
                        <div style="padding: 8px; display: flex; justify-content: flex-end; gap: 8px; border-top: 1px solid #ddd;">
                            ${layout.barcode && barPosicao === 'abaixo-dados' ? `<div style="width: 100px; height: 30px; background: repeating-linear-gradient(90deg, #000 0px, #000 2px, #fff 2px, #fff 4px);"></div>` : ''}
                            ${layout.qrcode && !qrPosicao.startsWith('topo') ? `<div style="width: 40px; height: 40px; background: #e5e7eb; border: 1px solid #999; font-size: 8px; display: flex; align-items: center; justify-content: center;">[QR]</div>` : ''}
                        </div>` : ''}
                    </div>
                `;
            },
            
            // v10.389: Buscar alergias da AVALIAÃ‡ÃƒO CLÃNICA (HPP do atendimento)
            // v10.439: LER ALERGIAS DA TELA ATUAL (em tempo real!)
            lerAlergiasDaTela() {
                try {
                    const alergias = [];
                    
                    // Procurar cards de alergias no prontuÃ¡rio
                    const cards = document.querySelectorAll('[id^="pront-alergia-"]');
                    
                    cards.forEach(card => {
                        // Pegar select dentro do card
                        const select = card.querySelector('select[id^="pront-select-alergia-"]');
                        if (select && select.value) {
                            alergias.push(select.value);
                        }
                    });
                    
                    if (alergias.length > 0) {
                        console.log('âœ… [v10.439] Alergias lidas da TELA:', alergias.join(', '));
                        return alergias.join(', ');
                    }
                    
                    return '';
                } catch (e) {
                    console.warn('[v10.439] Erro ao ler alergias da tela:', e);
                    return '';
                }
            },
            
            buscarAlergiasPaciente(pac) {
                try {
                    // v10.439: PRIORIDADE 1 - Alergias digitadas AGORA na tela!
                    const alergiasTelaAtual = this.lerAlergiasDaTela();
                    if (alergiasTelaAtual) {
                        console.log('âœ… [v10.439] Alergias encontradas na TELA ATUAL (tempo real)');
                        return alergiasTelaAtual;
                    }
                    
                    // 2. Buscar no atendimento ATUAL salvo (se houver)
                    const atendimentoAtual = SistemaCore.dados.atendimentos?.find(a => 
                        a.paciente?.prontuario === pac.prontuario && 
                        a.status !== 'finalizado'
                    );
                    if (atendimentoAtual?.anamnese?.hpp?.alergias) {
                        console.log('âœ… Alergias encontradas no atendimento atual salvo');
                        return atendimentoAtual.anamnese.hpp.alergias;
                    }
                    
                    // 3. Buscar no ÃšLTIMO atendimento finalizado do paciente
                    const atendimentos = SistemaCore.dados.atendimentos?.filter(a => 
                        a.paciente?.prontuario === pac.prontuario
                    ).sort((a, b) => new Date(b.criado_em || 0) - new Date(a.criado_em || 0)) || [];
                    
                    for (const at of atendimentos) {
                        // HPP com alergias
                        if (at.anamnese?.hpp?.alergias) {
                            console.log('âœ… Alergias encontradas em atendimento anterior (HPP)');
                            return at.anamnese.hpp.alergias;
                        }
                        // Campo alergias direto
                        if (at.alergias) {
                            console.log('âœ… Alergias encontradas em atendimento anterior');
                            return at.alergias;
                        }
                    }
                    
                    console.log('â„¹ï¸ Nenhuma alergia registrada em avaliaÃ§Ãµes clÃ­nicas');
                    return '';
                } catch (e) {
                    console.warn('Erro ao buscar alergias:', e);
                    return '';
                }
            },
            
            // v10.429: MERGE INTELIGENTE DE ALERGIAS
            mergeAlergias(alergiasCadastro, alergiasHPP) {
                // Se uma fonte estiver vazia, retorna a outra
                if (!alergiasCadastro && !alergiasHPP) return '';
                if (!alergiasCadastro) return alergiasHPP;
                if (!alergiasHPP) return alergiasCadastro;
                
                // Separar por vÃ­rgula e limpar espaÃ§os
                const listaCadastro = alergiasCadastro.split(',').map(a => a.trim().toLowerCase()).filter(a => a);
                const listaHPP = alergiasHPP.split(',').map(a => a.trim().toLowerCase()).filter(a => a);
                
                // Criar Set para remover duplicatas (case-insensitive)
                const setAlergias = new Set([...listaCadastro, ...listaHPP]);
                
                // Converter de volta para array e capitalizar primeira letra
                const merged = Array.from(setAlergias).map(a => 
                    a.charAt(0).toUpperCase() + a.slice(1)
                );
                
                // Retornar string separada por vÃ­rgula
                return merged.join(', ');
            },

            renderMinimalistaSandbox(layout, estab, pac, cp, ce) {
                const config = SistemaCore.dados.configuracao || {};
                const logoUrl = layout.logo?.url || config.logo || null;
                return `
                    <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; background: white; border: 2px solid #ddd;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            ${layout.logo?.ativo && logoUrl ? `<img src="${logoUrl}" style="max-height: 40px; max-width: 80px;" onerror="this.style.display='none'">` : ''}
                            <strong style="font-size: 12px;">${ce.includes('nome') ? (estab.nome_fantasia || estab.razao_social || '') : ''}</strong>
                        </div>
                        <div style="display: flex; gap: 16px; font-size: 11px;">
                            ${cp.includes('nome') ? `<span><strong>Pac:</strong> ${pac.nome.split(' ')[0]}</span>` : ''}
                            ${cp.includes('prontuario') ? `<span><strong>Pront:</strong> ${pac.prontuario}</span>` : ''}
                            ${cp.includes('data') ? `<span><strong>Data:</strong> ${pac.data}</span>` : ''}
                        </div>
                    </div>
                `;
            },

            renderCompactoSandbox(layout, estab, pac, cp, ce) {
                const config = SistemaCore.dados.configuracao || {};
                const logoUrl = layout.logo?.url || config.logo || null;
                return `
                    <div style="background: white; border: 2px solid #ddd; padding: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                            <div style="display: flex; gap: 12px; align-items: center;">
                                ${layout.logo?.ativo && logoUrl ? `<img src="${logoUrl}" style="max-height: 60px; max-width: 120px;" onerror="this.style.display='none'">` : ''}
                                <div>
                                    <div style="font-weight: bold; font-size: 13px;">${ce.includes('nome') ? (estab.nome_fantasia || estab.razao_social || '') : ''}</div>
                                    ${ce.includes('cnpj') ? `<div style="font-size: 10px; color: #666;">CNPJ: ${estab.cnpj}</div>` : ''}
                                </div>
                            </div>
                            ${layout.qrcode ? '<div style="width: 50px; height: 50px; background: #e5e7eb; border: 1px solid #999; display: flex; align-items: center; justify-content: center; font-size: 8px;">[QR]</div>' : ''}
                        </div>
                        <div style="border-top: 1px solid #ddd; padding-top: 8px; font-size: 11px; display: flex; justify-content: space-between;">
                            ${cp.includes('nome') ? `<span><strong>Paciente:</strong> ${pac.nome}</span>` : ''}
                            ${cp.includes('prontuario') ? `<span><strong>ProntuÃ¡rio:</strong> ${pac.prontuario}</span>` : ''}
                            ${cp.includes('data') ? `<span><strong>Data:</strong> ${pac.data}</span>` : ''}
                        </div>
                    </div>
                `;
            },

            renderCompletoSandbox(layout, estab, pac, cp, ce) {
                const config = SistemaCore.dados.configuracao || {};
                const logoUrl = layout.logo?.url || config.logo || null;
                return `
                    <div style="background: white; border: 2px solid #ddd; padding: 16px;">
                        <table style="width: 100%; font-size: 11px; border-collapse: collapse;">
                            <tr>
                                ${layout.logo?.ativo && logoUrl ? `<td rowspan="3" style="width: 80px; text-align: center; border-right: 1px solid #ddd; padding-right: 12px;"><img src="${logoUrl}" style="max-height: 70px; max-width: 70px;" onerror="this.style.display='none'"></td>` : ''}
                                <td colspan="2" style="padding: 4px; border-bottom: 1px solid #ddd;"><strong style="font-size: 13px;">${ce.includes('nome') ? (estab.nome_fantasia || estab.razao_social || '') : ''}</strong></td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; width: 50%;">${ce.includes('cnpj') ? `<strong>CNPJ:</strong> ${estab.cnpj}` : ''}</td>
                                <td style="padding: 4px;">${ce.includes('cnes') ? `<strong>CNES:</strong> ${estab.cnes}` : ''}</td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 4px;">${ce.includes('endereco') ? `<strong>EndereÃ§o:</strong> ${estab.endereco}` : ''}</td>
                            </tr>
                        </table>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 2px solid #ddd; display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; font-size: 11px;">
                            ${cp.includes('nome') ? `<div><strong>Paciente:</strong> ${pac.nome}</div>` : ''}
                            ${cp.includes('prontuario') ? `<div><strong>ProntuÃ¡rio:</strong> ${pac.prontuario}</div>` : ''}
                            ${cp.includes('data') ? `<div><strong>Data:</strong> ${pac.data}</div>` : ''}
                            ${cp.includes('idade') ? `<div><strong>Idade:</strong> ${pac.idade}</div>` : ''}
                            ${cp.includes('cpf') ? `<div><strong>CPF:</strong> ${pac.cpf}</div>` : ''}
                            ${cp.includes('convenio') ? `<div><strong>ConvÃªnio:</strong> ${pac.convenio}</div>` : ''}
                        </div>
                    </div>
                `;
            },

            renderPadraoSandbox(layout, estab, pac, cp, ce) {
                const config = SistemaCore.dados.configuracao || {};
                const logoUrl = layout.logo?.url || config.logo || null;
                return `
                    <div style="background: white; border: 2px solid #ddd; padding: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                            ${layout.logo?.ativo && logoUrl ? `<img src="${logoUrl}" style="max-height: 70px; max-width: 120px;" onerror="this.style.display='none'">` : ''}
                            <div style="flex: 1; margin-left: 16px;">
                                <div style="font-weight: bold; font-size: 14px; margin-bottom: 4px;">${ce.includes('nome') ? estab.nome : ''}</div>
                                ${ce.includes('cnpj') ? `<div style="font-size: 11px; color: #666;">CNPJ: ${estab.cnpj}</div>` : ''}
                                ${ce.includes('cnes') ? `<div style="font-size: 11px; color: #666;">CNES: ${estab.cnes}</div>` : ''}
                            </div>
                            ${layout.barcode ? '<div style="width: 80px; height: 35px; background: repeating-linear-gradient(90deg, #000 0px, #000 2px, #fff 2px, #fff 4px); border: 1px solid #999;"></div>' : ''}
                        </div>
                        <div style="border-top: 1px solid #ddd; padding-top: 12px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; font-size: 11px;">
                            ${cp.includes('nome') ? `<div><strong>Paciente:</strong> ${pac.nome}</div>` : ''}
                            ${cp.includes('prontuario') ? `<div><strong>ProntuÃ¡rio:</strong> ${pac.prontuario}</div>` : ''}
                            ${cp.includes('atendimento') ? `<div><strong>Atendimento:</strong> ${pac.atendimento}</div>` : ''}
                            ${cp.includes('data') ? `<div><strong>Data:</strong> ${pac.data}</div>` : ''}
                            ${cp.includes('idade') ? `<div><strong>Idade:</strong> ${pac.idade}</div>` : ''}
                            ${cp.includes('cpf') ? `<div><strong>CPF:</strong> ${pac.cpf}</div>` : ''}
                        </div>
                    </div>
                `;
            },

            definirDataAtual() {
                const hoje = new Date().toISOString().split('T')[0];
                const dataFormatada = new Date().toLocaleDateString('pt-BR');
                const prontuario = 'TESTE-' + Date.now().toString().slice(-6);
                
                // Tentar preencher elementos se existirem
                const elData = document.getElementById('sandbox-data-doc');
                const elPront = document.getElementById('sandbox-prontuario');
                const elProntDoc = document.getElementById('sandbox-prontuario-doc');
                
                if (elData) elData.textContent = dataFormatada;
                if (elPront) elPront.textContent = prontuario;
                if (elProntDoc) elProntDoc.textContent = prontuario;
                
                console.log('ğŸ“… [Sandbox] Data atual definida:', dataFormatada);
            },

            carregarModelos() {
                const select = document.getElementById('sandbox-tipo-doc');
                if (!select) return;

                const modelos = SistemaCore.dados.modelos_atendimento || [];
                
                // Limpar optgroup de modelos se existir
                let optgroupModelos = document.getElementById('sandbox-modelos-group');
                if (optgroupModelos) {
                    optgroupModelos.remove();
                }

                // Criar novo optgroup para modelos
                if (modelos.length > 0) {
                    optgroupModelos = document.createElement('optgroup');
                    optgroupModelos.id = 'sandbox-modelos-group';
                    optgroupModelos.label = 'ğŸ“‹ Modelos de ProntuÃ¡rio';

                    modelos.forEach(modelo => {
                        if (modelo.ativo) {
                            const option = document.createElement('option');
                            option.value = 'modelo-' + modelo.id;
                            
                            const icones = {
                                'consulta': 'ğŸ©º',
                                'emergencia': 'ğŸš¨',
                                'cirurgia': 'âš•ï¸',
                                'internacao': 'ğŸ›ï¸',
                                'exame': 'ğŸ”¬',
                                'procedimento': 'ğŸ¥'
                            };
                            
                            const icone = icones[modelo.tipo] || 'ğŸ“‹';
                            const especialidade = modelo.especialidade ? ` - ${modelo.especialidade}` : ' (Geral)';
                            option.textContent = `${icone} ${modelo.nome}${especialidade}`;
                            
                            optgroupModelos.appendChild(option);
                        }
                    });

                    // Adicionar ao final do select
                    select.appendChild(optgroupModelos);
                    
                    console.log(`ğŸ“‹ [Sandbox] ${modelos.filter(m => m.ativo).length} modelos de prontuÃ¡rio carregados`);
                } else {
                    console.log('âš ï¸ [Sandbox] Nenhum modelo de prontuÃ¡rio encontrado');
                }
            },

            trocarTipo() {
                const select = document.getElementById('sandbox-tipo-doc');
                const valor = select.value;

                const previewArea = document.getElementById('sandbox-preview-area');
                const mensagemInicial = document.getElementById('sandbox-mensagem-inicial');

                if (!valor) {
                    previewArea.style.display = 'none';
                    if (mensagemInicial) mensagemInicial.style.display = 'block';
                    return;
                }

                // Mostrar Ã¡rea de preview
                previewArea.style.display = 'block';
                if (mensagemInicial) mensagemInicial.style.display = 'none';

                // v10.346: SÃ³ temos modelos agora - cabeÃ§alho faz parte do modelo
                if (valor.startsWith('modelo-')) {
                    const modeloId = parseInt(valor.replace('modelo-', ''));
                    this.renderizarModelo(modeloId);
                }
            },

            renderizarModelo(modeloId) {
                // v10.346: Verificar se tem paciente selecionado
                if (!this.pacienteSelecionado) {
                    const container = document.getElementById('sandbox-cabecalho');
                    if (container) {
                        container.innerHTML = `<div style="padding: 40px; text-align: center; color: var(--text-light); background: #f9fafb; border: 1px dashed #ddd; border-radius: 8px;">
                            <div style="font-size: 48px; margin-bottom: 12px;">âš ï¸</div>
                            <p style="margin: 0; font-weight: 600; color: #856404;">Selecione um paciente acima para visualizar o modelo</p>
                        </div>`;
                    }
                    document.getElementById('sandbox-conteudo').innerHTML = '';
                    return;
                }
                
                const modelo = SistemaCore.dados.modelos_atendimento.find(m => m.id === modeloId);
                if (!modelo) {
                    Sistema.notificar('âŒ Modelo nÃ£o encontrado', 'erro');
                    console.error('âŒ [Sandbox] Modelo nÃ£o encontrado. ID:', modeloId);
                    console.log('ğŸ“‹ [Sandbox] Modelos disponÃ­veis:', SistemaCore.dados.modelos_atendimento);
                    return;
                }
                
                // v10.442: Guardar ID do modelo atual
                this.modeloAtualId = modeloId;
                console.log('ğŸ’¾ [v10.442] GUARDANDO modeloAtualId:', this.modeloAtualId);
                console.log('   Tipo:', typeof this.modeloAtualId);
                console.log('   Modelo nome:', modelo.nome);
                
                console.log('âœ… [Sandbox] Modelo encontrado:', modelo.nome);
                console.log('ğŸ“‹ [Sandbox] CabeÃ§alho ID:', modelo.cabecalho_id);
                console.log('ğŸ” [Sandbox] Exame especÃ­fico:', modelo.exame_especifico);

                // v10.346: RENDERIZAR CABEÃ‡ALHO DO MODELO
                const container = document.getElementById('sandbox-cabecalho');
                if (container && modelo.cabecalho_id) {
                    const layouts = SistemaCore.dados.cabecalhos || [];
                    const layout = layouts.find(l => l.id == modelo.cabecalho_id);
                    if (layout) {
                        container.innerHTML = this.renderizarCabecalhoLayout(layout);
                    } else {
                        container.innerHTML = '<div style="padding: 20px; text-align: center; color: #999;">CabeÃ§alho nÃ£o encontrado</div>';
                    }
                } else if (container) {
                    container.innerHTML = '<div style="padding: 20px; text-align: center; color: #999;">Nenhum cabeÃ§alho vinculado a este modelo</div>';
                }

                // Atualizar tÃ­tulo do documento
                document.getElementById('sandbox-doc-titulo').textContent = modelo.nome.toUpperCase();

                // Renderizar formulÃ¡rio
                let html = '';

                // CABEÃ‡ALHO DO ATENDIMENTO
                html += `
                    <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin-bottom: 24px; border: 1px solid #e0e0e0;">
                        <h4 style="margin: 0 0 16px 0; color: #333; font-size: 15px;">Dados do Atendimento</h4>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                            <div>
                                <label style="font-size: 12px; font-weight: 600; color: #666; display: block; margin-bottom: 4px;">Data</label>
                                <input type="date" value="${new Date().toISOString().split('T')[0]}" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px;">
                            </div>
                            <div>
                                <label style="font-size: 12px; font-weight: 600; color: #666; display: block; margin-bottom: 4px;">Hora InÃ­cio</label>
                                <input type="time" value="${new Date().toTimeString().slice(0,5)}" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px;">
                            </div>
                            ${modelo.timer ? `
                            <div>
                                <label style="font-size: 12px; font-weight: 600; color: #666; display: block; margin-bottom: 4px;">â±ï¸ DuraÃ§Ã£o</label>
                                <input type="text" value="0:00" readonly style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; background: #f0f0f0; text-align: center; font-weight: bold;">
                            </div>
                            ` : ''}
                        </div>
                    </div>
                `;


                // ===== v10.346: RENDERIZAR ELEMENTOS DO MODELO =====
                // Se o modelo tem mÃ³dulos de prontuÃ¡rio selecionados, buscar e renderizar cada elemento
                if (modelo.modulos_prontuario && modelo.modulos_prontuario.length > 0) {
                    console.log('ğŸ“‹ [Sandbox] Modelo possui mÃ³dulos:', modelo.modulos_prontuario);
                    
                    const elementosDisponiveis = SistemaCore.dados.elementos || [];
                    console.log('ğŸ“‹ [Sandbox] Elementos no sistema:', elementosDisponiveis.length);
                    
                    // Flag para saber se precisa inicializar mapa anatÃ´mico
                    let renderizarMapaAnatomico = false;
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // TEMPLATES PADRÃƒO PARA TODOS OS MÃ“DULOS - v10.354
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // TEMPLATES RICOS PARA MÃ“DULOS DE PRONTUÃRIO - v10.354
                    // Baseado no ProntuÃ¡rio EletrÃ´nico Modular standalone
                    // v10.396: Tornado global (window.TEMPLATES_MODULOS) para acesso em Atendimentos
                    // v10.405: Movido para Sandbox.carregarTemplatesGlobais() - inicializado no DOMContentLoaded
                    // Este bloco agora Ã© fallback caso nÃ£o tenha sido carregado antes
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    
                    if (typeof window.TEMPLATES_MODULOS === 'undefined') {
                        console.log('âš ï¸ [Sandbox] window.TEMPLATES_MODULOS nÃ£o foi inicializado! Criando agora...');
                    window.TEMPLATES_MODULOS = {
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // QUEIXA PRINCIPAL
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'queixa': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #555; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    Queixa Principal (QP)
                                </h4>
                                <textarea id="campo-queixa-principal" rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Ex: InsatisfaÃ§Ã£o com aparÃªncia abdominal pÃ³s-gestacional"></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HDA - HISTÃ“RIA DA DOENÃ‡A ATUAL
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'hda': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #555; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    HistÃ³ria da DoenÃ§a Atual (HDA)
                                </h4>
                                <textarea id="campo-hda" rows="4" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Detalhe a evoluÃ§Ã£o da queixa, fatores relacionados, tentativas prÃ©vias..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HPP - HISTÃ“RIA PATOLÃ“GICA PREGRESSA COM CARDS DINÃ‚MICOS
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'hpp': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 20px 0; color: #333; font-size: 15px; display: flex; align-items: center; gap: 10px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                                    HistÃ³ria Pregressa
                                    <span style="font-size: 12px; color: #666; font-weight: normal;">Antecedentes pessoais e cirÃºrgicos</span>
                                </h4>
                                
                                <!-- CONTAINER ALERGIAS -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #ef4444; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <div>
                                            <h3 style="font-size: 14px; color: #333; margin: 0;">Alergias</h3>
                                            <p style="color: #c62828; font-size: 11px; margin: 4px 0 0 0;"><strong>IMPORTANTE:</strong> Registrar todas as alergias conhecidas</p>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="prontuario-btn-adicionar" style="background: #ef4444; padding: 8px 16px; font-size: 12px;" onclick="ProntuarioModular.adicionarAlergia()">+ Adicionar</button>
                                            <button class="prontuario-btn-gerenciar" style="padding: 8px 12px; font-size: 11px;" onclick="ProntuarioModular.gerenciarAlergias()">Pool</button>
                                        </div>
                                    </div>
                                    <div id="pront-listaAlergias" style="min-height: 30px;"></div>
                                </div>
                                
                                <!-- CONTAINER CIRURGIAS PRÃ‰VIAS -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #8b5cf6; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #333; margin: 0;">Cirurgias PrÃ©vias</h3>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="prontuario-btn-adicionar" style="background: #8b5cf6; padding: 8px 16px; font-size: 12px;" onclick="ProntuarioModular.adicionarCirurgia()">+ Adicionar</button>
                                            <button class="prontuario-btn-gerenciar" style="padding: 8px 12px; font-size: 11px;" onclick="ProntuarioModular.gerenciarCirurgias()">Pool</button>
                                        </div>
                                    </div>
                                    <div id="pront-listaCirurgias" style="min-height: 30px;"></div>
                                </div>
                                
                                <!-- CONTAINER MEDICAÃ‡Ã•ES EM USO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #10b981; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #333; margin: 0;">MedicaÃ§Ãµes em Uso</h3>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="prontuario-btn-adicionar" style="background: #10b981; padding: 8px 16px; font-size: 12px;" onclick="ProntuarioModular.adicionarMedicacao()">+ Adicionar</button>
                                            <button class="prontuario-btn-gerenciar" style="padding: 8px 12px; font-size: 11px;" onclick="ProntuarioModular.gerenciarMedicacoes()">Pool</button>
                                        </div>
                                    </div>
                                    <div id="pront-listaMedicacoes" style="min-height: 30px;"></div>
                                </div>
                                
                                <!-- CONTAINER DOENÃ‡AS PRÃ‰VIAS / COMORBIDADES -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #3b82f6; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #333; margin: 0;">DoenÃ§as PrÃ©vias / Comorbidades</h3>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="prontuario-btn-adicionar" style="background: #3b82f6; padding: 8px 16px; font-size: 12px;" onclick="ProntuarioModular.adicionarDoenca()">+ Adicionar</button>
                                            <button class="prontuario-btn-gerenciar" style="padding: 8px 12px; font-size: 11px;" onclick="ProntuarioModular.gerenciarDoencas()">Pool</button>
                                        </div>
                                    </div>
                                    <div id="pront-listaDoencas" style="min-height: 30px;"></div>
                                </div>
                                
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <!-- HISTÃ“RIA GINECO-OBSTÃ‰TRICA (apenas para pacientes femininas) -->
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <div style="margin-top: 20px; background: #fce4ec; border-radius: 6px; border-left: 4px solid #ec407a; overflow: hidden;">
                                    <div onclick="const c = document.getElementById('pront-expand-gineco'); const i = this.querySelector('.toggle-icon'); const t = this.querySelector('.toggle-text'); c.style.display = c.style.display === 'none' ? 'block' : 'none'; i.textContent = c.style.display === 'none' ? 'â–¶' : 'â–¼'; t.textContent = c.style.display === 'none' ? 'Clique para expandir' : 'Clique para fechar';" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; cursor: pointer; background: #f8bbd0;">
                                        <div style="display: flex; align-items: center; gap: 10px;">
                                            <span class="toggle-icon" style="font-size: 12px; color: #c2185b;">â–¶</span>
                                            <h3 style="font-size: 14px; color: #c2185b; margin: 0;">ğŸ‘© HistÃ³ria Gineco-ObstÃ©trica</h3>
                                            <span style="font-size: 11px; color: #880e4f; font-style: italic;">Apenas para pacientes do sexo feminino</span>
                                        </div>
                                        <span class="toggle-text" style="font-size: 11px; color: #880e4f; background: white; padding: 4px 8px; border-radius: 4px;">Clique para expandir</span>
                                    </div>
                                    
                                    <div id="pront-expand-gineco" style="display: none; padding: 15px;">
                                        <!-- CONTAINER GESTAÃ‡Ã•ES -->
                                        <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #ec407a; margin-bottom: 15px;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                                <h3 style="font-size: 14px; color: #c2185b; margin: 0;">ğŸ¤° GestaÃ§Ãµes</h3>
                                                <select id="pront-gineco-gestacoes" onchange="ProntuarioModular.toggleGestacao(this.value)" style="padding: 8px 12px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="nao">NulÃ­para (nunca engravidou)</option>
                                                    <option value="sim">JÃ¡ teve gestaÃ§Ã£o(Ãµes)</option>
                                                </select>
                                            </div>
                                            
                                            <div id="pront-texto-nulipara" style="padding: 10px; background: #fce4ec; border-radius: 6px; text-align: center; color: #666; font-size: 13px;">
                                                Paciente nulÃ­para - sem histÃ³rico gestacional
                                            </div>
                                            
                                            <div id="pront-campos-gpa" style="display: none;">
                                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 12px;">
                                                <div style="background: #fce4ec; padding: 12px; border-radius: 6px; text-align: center;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">GestaÃ§Ãµes (G)</label>
                                                    <input type="number" id="pront-gineco-g" min="0" max="20" value="0" style="width: 60px; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 18px; font-weight: bold; text-align: center; color: #c2185b;">
                                                </div>
                                                <div style="background: #fce4ec; padding: 12px; border-radius: 6px; text-align: center;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Partos (P)</label>
                                                    <input type="number" id="pront-gineco-p" min="0" max="20" value="0" style="width: 60px; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 18px; font-weight: bold; text-align: center; color: #c2185b;">
                                                </div>
                                                <div style="background: #fce4ec; padding: 12px; border-radius: 6px; text-align: center;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Abortos (A)</label>
                                                    <input type="number" id="pront-gineco-a" min="0" max="20" value="0" style="width: 60px; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 18px; font-weight: bold; text-align: center; color: #c2185b;">
                                                </div>
                                            </div>
                                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                                <div style="background: #fce4ec; padding: 10px; border-radius: 6px;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Partos Vaginais</label>
                                                    <input type="number" id="pront-gineco-pv" min="0" max="20" value="0" style="width: 100%; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 14px; text-align: center;">
                                                </div>
                                                <div style="background: #fce4ec; padding: 10px; border-radius: 6px;">
                                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">CesÃ¡reas</label>
                                                    <input type="number" id="pront-gineco-c" min="0" max="20" value="0" style="width: 100%; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 14px; text-align: center;">
                                                </div>
                                            </div>
                                            <div style="background: #fce4ec; padding: 10px; border-radius: 6px;">
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre gestaÃ§Ãµes</label>
                                                <textarea id="pront-gineco-obs-gest" rows="2" style="width: 100%; padding: 8px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 13px;" placeholder="Ex: 1 aborto espontÃ¢neo no 1Âº trimestre, cesÃ¡rea por sofrimento fetal..."></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- CONTAINER ANTICONCEPCIONAL -->
                                    <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #9c27b0; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #7b1fa2; margin: 0 0 15px 0;">ğŸ’Š Anticoncepcional</h3>
                                        
                                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Usa anticoncepcional?</label>
                                                <select id="pront-gineco-anticonc" onchange="document.getElementById('pront-anticonc-detalhes').style.display = this.value === 'sim' ? 'block' : 'none'" style="width: 100%; padding: 10px; border: 1px solid #ce93d8; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="nao">NÃ£o</option>
                                                    <option value="sim">Sim</option>
                                                </select>
                                            </div>
                                            <div id="pront-anticonc-detalhes" style="display: none;">
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">MÃ©todo utilizado</label>
                                                <select id="pront-gineco-metodo" style="width: 100%; padding: 10px; border: 1px solid #ce93d8; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="">Selecione...</option>
                                                    <option value="pÃ­lula">PÃ­lula anticoncepcional</option>
                                                    <option value="diu-cobre">DIU de cobre</option>
                                                    <option value="diu-mirena">DIU Mirena (hormonal)</option>
                                                    <option value="implante">Implante subdÃ©rmico</option>
                                                    <option value="injetavel-mensal">InjetÃ¡vel mensal</option>
                                                    <option value="injetavel-trimestral">InjetÃ¡vel trimestral</option>
                                                    <option value="adesivo">Adesivo</option>
                                                    <option value="anel">Anel vaginal</option>
                                                    <option value="laqueadura">Laqueadura tubÃ¡ria</option>
                                                    <option value="preservativo">Preservativo</option>
                                                    <option value="outro">Outro</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div style="margin-top: 12px;">
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre anticoncepÃ§Ã£o</label>
                                            <textarea id="pront-gineco-obs-anticonc" rows="1" style="width: 100%; padding: 8px; border: 1px solid #ce93d8; border-radius: 6px; font-size: 13px;" placeholder="Ex: Usa hÃ¡ 5 anos, sem intercorrÃªncias..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- CONTAINER CICLO MENSTRUAL -->
                                    <div style="background: white; padding: 15px; border-radius: 6px; border-left: 4px solid #ff9800;">
                                        <h3 style="font-size: 14px; color: #e65100; margin: 0 0 15px 0;">ğŸ©¸ Ciclo Menstrual</h3>
                                        
                                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Menarca (1Âª menstruaÃ§Ã£o)</label>
                                                <div style="display: flex; gap: 6px; align-items: center;">
                                                    <input type="number" id="pront-gineco-menarca" min="8" max="20" placeholder="12" style="width: 70px; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; text-align: center;">
                                                    <span style="font-size: 13px; color: #666;">anos</span>
                                                </div>
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Menopausa</label>
                                                <select id="pront-gineco-menopausa" onchange="document.getElementById('pront-menopausa-idade').style.display = this.value === 'sim' ? 'flex' : 'none'" style="padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="nao">NÃ£o</option>
                                                    <option value="sim">Sim</option>
                                                </select>
                                                <div id="pront-menopausa-idade" style="display: none; gap: 6px; align-items: center; margin-top: 6px;">
                                                    <input type="number" id="pront-gineco-idade-menopausa" min="35" max="65" placeholder="50" style="width: 70px; padding: 8px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; text-align: center;">
                                                    <span style="font-size: 12px; color: #666;">anos</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Ciclo</label>
                                                <select id="pront-gineco-ciclo" style="width: 100%; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="">Selecione...</option>
                                                    <option value="regular">Regular</option>
                                                    <option value="irregular">Irregular</option>
                                                    <option value="amenorreia">Amenorreia</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Intervalo (dias)</label>
                                                <input type="text" id="pront-gineco-intervalo" placeholder="28-30" style="width: 100%; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">DuraÃ§Ã£o fluxo</label>
                                                <div style="display: flex; gap: 6px; align-items: center;">
                                                    <input type="number" id="pront-gineco-duracao" min="1" max="15" placeholder="5" style="width: 60px; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; text-align: center;">
                                                    <span style="font-size: 12px; color: #666;">dias</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">DUM (Ãšltima MenstruaÃ§Ã£o)</label>
                                                <input type="date" id="pront-gineco-dum" style="width: 100%; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Intensidade do fluxo</label>
                                                <select id="pront-gineco-fluxo" style="width: 100%; padding: 10px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px; background: white;">
                                                    <option value="">Selecione...</option>
                                                    <option value="leve">Leve</option>
                                                    <option value="moderado">Moderado</option>
                                                    <option value="intenso">Intenso</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre ciclo menstrual</label>
                                            <textarea id="pront-gineco-obs-ciclo" rows="2" style="width: 100%; padding: 8px; border: 1px solid #ffcc80; border-radius: 6px; font-size: 13px;" placeholder="Ex: Dismenorreia, TPM intensa, sangramento intermenstrual, uso de medicaÃ§Ã£o para cÃ³lica..."></textarea>
                                        </div>
                                    </div>
                                    </div><!-- Fim pront-expand-gineco -->
                                </div><!-- Fim container gineco colapsÃ¡vel -->
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HISTÃ“RIA FAMILIAR - EXATAMENTE COMO NO ARQUIVO CORRETO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'h-familiar': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 15px 0; color: #333; font-size: 15px;">HistÃ³ria Familiar</h4>
                                <p style="color: #666; font-size: 13px; margin-bottom: 20px;">Antecedentes familiares relevantes</p>
                                
                                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                                    <button onclick="ProntuarioModular.adicionarFamiliar()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; flex: 1;">
                                        Adicionar Familiar
                                    </button>
                                    <button onclick="ProntuarioModular.gerenciarParentescos()" style="padding: 10px 20px; background: #ff9800; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                        Gerenciar Parentescos
                                    </button>
                                    <button onclick="ProntuarioModular.gerenciarDoencasFamiliares()" style="padding: 10px 20px; background: #ff9800; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                        Gerenciar DoenÃ§as
                                    </button>
                                </div>
                                
                                <div id="pront-listaFamiliares"></div>
                                
                                <div class="prontuario-form-grid" style="margin-top: 20px;">
                                    <div class="prontuario-form-group full">
                                        <label>ObservaÃ§Ãµes Gerais sobre HistÃ³ria Familiar</label>
                                        <textarea style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 60px;" placeholder="InformaÃ§Ãµes adicionais relevantes sobre a famÃ­lia..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HISTÃ“RIA SOCIAL - EXATAMENTE COMO NO ARQUIVO CORRETO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'h-social': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 20px 0; color: #333; font-size: 15px; display: flex; align-items: center; gap: 10px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                                    HistÃ³ria Social e HÃ¡bitos de Vida
                                    <span style="font-size: 12px; color: #666; font-weight: normal;">Estilo de vida, hÃ¡bitos e contexto social</span>
                                </h4>
                                
                                <!-- CONTAINER ESTADO CIVIL -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #e91e63; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #c2185b; margin: 0;">ğŸ’ Estado Civil</h3>
                                        <select id="pront-social-estadocivil" style="padding: 8px 12px; border: 1px solid #f8bbd0; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="solteiro">Solteiro(a)</option>
                                            <option value="casado">Casado(a)</option>
                                            <option value="uniao">UniÃ£o estÃ¡vel</option>
                                            <option value="divorciado">Divorciado(a)</option>
                                            <option value="separado">Separado(a)</option>
                                            <option value="viuvo">ViÃºvo(a)</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER FILHOS -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #00bcd4; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #0097a7; margin: 0;">ğŸ‘¶ Filhos</h3>
                                        <select id="pront-social-filhos" onchange="document.getElementById('pront-expand-filhos').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #b2ebf2; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">NÃ£o tem filhos</option>
                                            <option value="sim">Tem filhos</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-filhos" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 12px; margin-bottom: 12px;">
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Quantos filhos?</label>
                                                <input type="number" id="pront-filhos-qtd" min="1" max="20" placeholder="2" style="width: 100%; padding: 10px; border: 1px solid #b2ebf2; border-radius: 6px; text-align: center; font-size: 16px; font-weight: bold;">
                                            </div>
                                            <div>
                                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Idades (anos)</label>
                                                <input type="text" id="pront-filhos-idades" placeholder="Ex: 5, 12, 18" style="width: 100%; padding: 10px; border: 1px solid #b2ebf2; border-radius: 6px;">
                                            </div>
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes</label>
                                            <textarea id="pront-filhos-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #b2ebf2; border-radius: 6px; font-size: 13px;" placeholder="Ex: Moram com o paciente, dependentes, etc..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER TABAGISMO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #795548; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #5d4037; margin: 0;">ğŸš¬ Tabagismo</h3>
                                        <select id="pront-social-tabaco" onchange="document.getElementById('pront-expand-tabaco').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #d7ccc8; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">NÃ£o fuma / Nunca fumou</option>
                                            <option value="ativo">Fumante ativo</option>
                                            <option value="passivo">Fumante passivo</option>
                                            <option value="ex">Ex-fumante</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-tabaco" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <button onclick="ProntuarioModular.adicionarTabaco()" style="padding: 8px 16px; background: #795548; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; margin-bottom: 12px;">
                                            + Adicionar Tipo de Fumo
                                        </button>
                                        <div id="pront-listaTabaco" style="min-height: 30px;"></div>
                                        <div style="margin-top: 12px;">
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes gerais</label>
                                            <textarea id="pront-tabaco-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #d7ccc8; border-radius: 6px; font-size: 13px;" placeholder="Ex: Tentativas de parar, carga tabÃ¡gica calculada..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER ETILISMO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #f59e0b; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #b45309; margin: 0;">ğŸº Etilismo</h3>
                                        <select id="pront-social-alcool" onchange="document.getElementById('pront-expand-alcool').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #fcd34d; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">NÃ£o bebe / Nunca bebeu</option>
                                            <option value="esporadico">EsporÃ¡dico (1-2x/ano)</option>
                                            <option value="social">Social (ocasiÃµes)</option>
                                            <option value="moderado">Moderado (semanal)</option>
                                            <option value="frequente">Frequente (diÃ¡rio)</option>
                                            <option value="ex">Ex-etilista</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-alcool" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <button onclick="ProntuarioModular.adicionarAlcool()" style="padding: 8px 16px; background: #f59e0b; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; margin-bottom: 12px;">
                                            + Adicionar Tipo de Bebida
                                        </button>
                                        <div id="pront-listaAlcool" style="min-height: 30px;"></div>
                                        <div style="margin-top: 12px;">
                                            <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes gerais</label>
                                            <textarea id="pront-alcool-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; font-size: 13px;" placeholder="Ex: Finais de semana, histÃ³rico de problemas relacionados ao Ã¡lcool..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER OUTRAS DROGAS -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #9333ea; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #7e22ce; margin: 0;">ğŸ’Š Outras Drogas/SubstÃ¢ncias</h3>
                                        <select id="pront-social-drogas" onchange="document.getElementById('pront-expand-drogas').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #c4b5fd; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">Nega uso</option>
                                            <option value="atual">Uso atual</option>
                                            <option value="pregresso">Uso pregresso</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-drogas" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <button onclick="ProntuarioModular.adicionarDroga()" style="padding: 8px 16px; background: #9333ea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; margin-bottom: 12px;">
                                            + Adicionar SubstÃ¢ncia
                                        </button>
                                        <div id="pront-listaDrogas" style="min-height: 30px;"></div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER ATIVIDADE FÃSICA -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #22c55e; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #16a34a; margin: 0;">ğŸƒ Atividade FÃ­sica</h3>
                                        <select id="pront-social-exercicio" onchange="document.getElementById('pront-expand-exercicio').style.display = (this.value !== '' && this.value !== 'nao') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #86efac; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="nao">SedentÃ¡rio</option>
                                            <option value="leve">Leve (1-2x/semana)</option>
                                            <option value="moderado">Moderado (3-4x/semana)</option>
                                            <option value="intenso">Intenso (5+x/semana)</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-exercicio" style="display: none; background: white; padding: 15px; border-radius: 6px; margin-top: 15px;">
                                        <button onclick="ProntuarioModular.adicionarAtividade()" style="padding: 8px 16px; background: #22c55e; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px; margin-bottom: 12px;">
                                            + Adicionar Atividade
                                        </button>
                                        <div id="pront-listaAtividades" style="min-height: 30px;"></div>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER ALIMENTAÃ‡ÃƒO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #ef4444; margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #dc2626; margin: 0;">ğŸ AlimentaÃ§Ã£o</h3>
                                        <select id="pront-social-alimentacao" onchange="document.getElementById('pront-expand-alimentacao').style.display = (this.value !== '' && this.value !== 'equilibrada') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #fca5a5; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="equilibrada">Equilibrada/SaudÃ¡vel</option>
                                            <option value="irregular">Irregular</option>
                                            <option value="restritiva">Restritiva/Dieta</option>
                                            <option value="vegetariana">Vegetariana</option>
                                            <option value="vegana">Vegana</option>
                                            <option value="hipossodica">HipossÃ³dica</option>
                                            <option value="diabetico">Para diabÃ©tico</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-alimentacao" style="display: none; background: white; padding: 12px; border-radius: 6px; margin-top: 15px;">
                                        <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre alimentaÃ§Ã£o</label>
                                        <textarea id="pront-alimentacao-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; font-size: 13px;" placeholder="Ex: RestriÃ§Ãµes alimentares, nÃºmero de refeiÃ§Ãµes/dia, preferÃªncias..."></textarea>
                                    </div>
                                </div>
                                
                                <!-- CONTAINER SONO -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border-left: 4px solid #6366f1;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h3 style="font-size: 14px; color: #4f46e5; margin: 0;">ğŸ˜´ Sono e Rotina</h3>
                                        <select id="pront-social-sono" onchange="document.getElementById('pront-expand-sono').style.display = (this.value !== '' && this.value !== 'bom') ? 'block' : 'none'" style="padding: 8px 12px; border: 1px solid #a5b4fc; border-radius: 6px; font-size: 13px; background: white; min-width: 200px;">
                                            <option value="">Selecione...</option>
                                            <option value="bom">Bom (7-8h, reparador)</option>
                                            <option value="regular">Regular (5-6h)</option>
                                            <option value="ruim">Ruim (insÃ´nia, fragmentado)</option>
                                            <option value="irregular">Irregular (horÃ¡rios variados)</option>
                                        </select>
                                    </div>
                                    <div id="pront-expand-sono" style="display: none; background: white; padding: 12px; border-radius: 6px; margin-top: 15px;">
                                        <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes sobre sono e rotina</label>
                                        <textarea id="pront-sono-obs" rows="2" style="width: 100%; padding: 8px; border: 1px solid #a5b4fc; border-radius: 6px; font-size: 13px;" placeholder="Ex: Horas de sono, qualidade, uso de medicaÃ§Ãµes para dormir, trabalho noturno..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // CONTROLE HOSPITALAR (DPO, ATB) - ABAIXO DO CABEÃ‡ALHO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'controle-hospitalar': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 15px 0; color: #333; font-size: 15px;">Controle Hospitalar</h4>
                                <p style="color: #666; font-size: 13px; margin-bottom: 20px;">InformaÃ§Ãµes de acompanhamento pÃ³s-operatÃ³rio e antibioticoterapia</p>
                                
                                <!-- CONTAINER DPO -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #0ea5e9; margin-bottom: 15px; padding: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <h3 style="font-size: 14px; color: #0ea5e9; margin: 0;">ğŸ“… DPO - Dia PÃ³s-OperatÃ³rio</h3>
                                        <button onclick="ProntuarioModular.adicionarDPO()" style="padding: 8px 16px; background: #0ea5e9; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;">+ Adicionar DPO</button>
                                    </div>
                                    <div id="pront-listaDPO" style="min-height: 30px;"></div>
                                    <label style="display: flex; align-items: center; gap: 8px; padding: 10px; background: #dbeafe; border-radius: 6px; cursor: pointer; font-size: 12px; margin-top: 10px;">
                                        <input type="checkbox" id="pront-dpo-manter" onchange="ProntuarioModular.salvarControleHospitalar()">
                                        <span style="color: #1e40af;">ğŸ“Œ Manter na prÃ³xima evoluÃ§Ã£o (atualiza DPO automaticamente)</span>
                                    </label>
                                </div>
                                
                                <!-- CONTAINER ATB EM USO -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #22c55e; margin-bottom: 15px; padding: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <div style="display: flex; align-items: center; gap: 10px;">
                                            <h3 style="font-size: 14px; color: #22c55e; margin: 0;">ğŸ’Š AntibiÃ³tico em Uso</h3>
                                            <button onclick="ProntuarioModular.gerenciarAntibioticos()" style="padding: 4px 10px; background: #ff9800; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;">Pool</button>
                                        </div>
                                        <button onclick="ProntuarioModular.adicionarATB()" style="padding: 8px 16px; background: #22c55e; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;">+ Adicionar ATB</button>
                                    </div>
                                    <div id="pront-listaATB" style="min-height: 30px;"></div>
                                    <label style="display: flex; align-items: center; gap: 8px; padding: 10px; background: #dcfce7; border-radius: 6px; cursor: pointer; font-size: 12px; margin-top: 10px;">
                                        <input type="checkbox" id="pront-atb-manter" onchange="ProntuarioModular.salvarControleHospitalar()">
                                        <span style="color: #166534;">ğŸ“Œ Manter na prÃ³xima evoluÃ§Ã£o (atualiza dia de uso automaticamente)</span>
                                    </label>
                                </div>
                                
                                <!-- CONTAINER ATB SUSPENSO -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #f59e0b; padding: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                        <div style="display: flex; align-items: center; gap: 10px;">
                                            <h3 style="font-size: 14px; color: #f59e0b; margin: 0;">ğŸ”¶ AntibiÃ³tico Suspenso</h3>
                                            <button onclick="ProntuarioModular.gerenciarAntibioticos()" style="padding: 4px 10px; background: #ff9800; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;">Pool</button>
                                        </div>
                                        <button onclick="ProntuarioModular.adicionarATBSuspenso()" style="padding: 8px 16px; background: #f59e0b; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;">+ Adicionar ATB Suspenso</button>
                                    </div>
                                    <div id="pront-listaATBSusp" style="min-height: 30px;"></div>
                                    <label style="display: flex; align-items: center; gap: 8px; padding: 10px; background: #fef3c7; border-radius: 6px; cursor: pointer; font-size: 12px; margin-top: 10px;">
                                        <input type="checkbox" id="pront-atb-susp-manter" onchange="ProntuarioModular.salvarControleHospitalar()">
                                        <span style="color: #92400e;">ğŸ“Œ Manter na prÃ³xima evoluÃ§Ã£o (histÃ³rico de antibiÃ³ticos)</span>
                                    </label>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // EVOLUÃ‡ÃƒO - CAMPO ABERTO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'evolucao': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 15px 0; color: #333; font-size: 15px;">EvoluÃ§Ã£o</h4>
                                <p style="color: #666; font-size: 13px; margin-bottom: 15px;">EvoluÃ§Ã£o clÃ­nica do paciente</p>
                                <textarea style="width: 100%; padding: 15px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 150px; font-size: 14px; line-height: 1.6;" placeholder="Descreva a evoluÃ§Ã£o do paciente, intercorrÃªncias, exames, condutas tomadas..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // EXAME FÃSICO GERAL - CORRIGIDO IGUAL AO ARQUIVO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'exame-geral': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 15px 0; color: #333; font-size: 15px;">Exame FÃ­sico Geral</h4>
                                <p style="color: #666; font-size: 13px; margin-bottom: 20px;">AvaliaÃ§Ã£o clÃ­nica comum a todas as especialidades</p>
                                
                                <!-- SINAIS VITAIS - COLAPSÃVEL -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #ef4444; margin-bottom: 15px; overflow: hidden;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; cursor: pointer;" onclick="const c = document.getElementById('pront-expand-sv'); const i = this.querySelector('.toggle-icon'); c.style.display = c.style.display === 'none' ? 'block' : 'none'; i.textContent = c.style.display === 'none' ? 'â–¶' : 'â–¼';">
                                        <h3 style="font-size: 14px; color: #333; margin: 0; display: flex; align-items: center; gap: 8px;">
                                            <span class="toggle-icon" style="font-size: 10px; color: #666;">â–¼</span>
                                            Sinais Vitais
                                        </h3>
                                    </div>
                                    <div id="pront-expand-sv" style="padding: 0 15px 15px 15px; border-top: 1px solid #e0e0e0;">
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">PA (mmHg)</label>
                                                <div style="display: flex; gap: 6px; align-items: center;">
                                                    <input type="number" id="pront-pa-sistolica" placeholder="120" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                                    <span style="font-weight: bold; font-size: 12px;">/</span>
                                                    <input type="number" id="pront-pa-diastolica" placeholder="80" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                                </div>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">FC (bpm)</label>
                                                <input type="number" id="pront-fc" placeholder="72" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">FR (irpm)</label>
                                                <input type="number" id="pront-fr" placeholder="16" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Temp (Â°C)</label>
                                                <input type="number" step="0.1" id="pront-temp" placeholder="36.5" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">SpOâ‚‚ (%)</label>
                                                <input type="number" id="pront-spo2" placeholder="98" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">GC (mg/dL)</label>
                                                <input type="number" id="pront-glicemia" placeholder="105" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ANTROPOMETRIA - COLAPSÃVEL -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #22c55e; margin-bottom: 15px; overflow: hidden;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; cursor: pointer;" onclick="const c = document.getElementById('pront-expand-antrop'); const i = this.querySelector('.toggle-icon'); c.style.display = c.style.display === 'none' ? 'block' : 'none'; i.textContent = c.style.display === 'none' ? 'â–¶' : 'â–¼';">
                                        <h3 style="font-size: 14px; color: #333; margin: 0; display: flex; align-items: center; gap: 8px;">
                                            <span class="toggle-icon" style="font-size: 10px; color: #666;">â–¼</span>
                                            Antropometria
                                        </h3>
                                    </div>
                                    <div id="pront-expand-antrop" style="padding: 0 15px 15px 15px; border-top: 1px solid #e0e0e0;">
                                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Peso (kg)</label>
                                                <input type="text" id="pront-peso" placeholder="65,5" oninput="this.value = this.value.replace(',', '.'); ProntuarioModular.calcularIMCAutomatic && ProntuarioModular.calcularIMCAutomatic()" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Altura (cm)</label>
                                                <input type="text" id="pront-altura" placeholder="165" oninput="this.value = this.value.replace(',', '.'); ProntuarioModular.calcularIMCAutomatic && ProntuarioModular.calcularIMCAutomatic()" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">IMC</label>
                                                <input type="text" id="pront-imc" readonly style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f0f0f0; font-weight: bold;">
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">ClassificaÃ§Ã£o</label>
                                                <input type="text" id="pront-imc-class" readonly style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f0f0f0; font-weight: bold;">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ECTOSCOPIA - COLAPSÃVEL -->
                                <div style="background: #f8f9fa; border-radius: 6px; border-left: 4px solid #3b82f6; overflow: hidden;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 15px; cursor: pointer;" onclick="const c = document.getElementById('pront-expand-ecto'); const i = this.querySelector('.toggle-icon'); c.style.display = c.style.display === 'none' ? 'block' : 'none'; i.textContent = c.style.display === 'none' ? 'â–¶' : 'â–¼';">
                                        <h3 style="font-size: 14px; color: #333; margin: 0; display: flex; align-items: center; gap: 8px;">
                                            <span class="toggle-icon" style="font-size: 10px; color: #666;">â–¼</span>
                                            Ectoscopia (InspeÃ§Ã£o Geral)
                                        </h3>
                                    </div>
                                    <div id="pront-expand-ecto" style="padding: 0 15px 15px 15px; border-top: 1px solid #e0e0e0;">
                                
                                        <!-- Linha 1: Estado Geral, ConsciÃªncia, Estado Nutricional -->
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 15px; margin-bottom: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Estado Geral</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="bom">Bom</option>
                                                    <option value="regular">Regular</option>
                                                    <option value="comprometido">Comprometido</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">ConsciÃªncia</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="lucido">LÃºcido(a) e orientado(a)</option>
                                                    <option value="confuso">Confuso(a)</option>
                                                    <option value="sonolento">Sonolento(a)</option>
                                                    <option value="torporoso">Torporoso(a)</option>
                                                    <option value="comatoso">Comatoso(a)</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Estado Nutricional</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="desnutrido">Desnutrido(a)</option>
                                                    <option value="eutrofico" selected>EutrÃ³fico(a)</option>
                                                    <option value="sobrepeso">Sobrepeso</option>
                                                    <option value="obeso">Obeso(a)</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <!-- Linha 2: ColoraÃ§Ã£o, HidrataÃ§Ã£o, Cianose, IcterÃ­cia -->
                                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">ColoraÃ§Ã£o</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="hipocorado4">Hipocorado(a) ++++/4+</option>
                                                    <option value="hipocorado3">Hipocorado(a) +++/4+</option>
                                                    <option value="hipocorado2">Hipocorado(a) ++/4+</option>
                                                    <option value="hipocorado1">Hipocorado(a) +/4+</option>
                                                    <option value="normocorado" selected>Normocorado(a)</option>
                                                    <option value="hipercorado1">Hipercorado(a) +/4+</option>
                                                    <option value="hipercorado2">Hipercorado(a) ++/4+</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">HidrataÃ§Ã£o</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="desidratado4">Desidratado(a) ++++/4+</option>
                                                    <option value="desidratado3">Desidratado(a) +++/4+</option>
                                                    <option value="desidratado2">Desidratado(a) ++/4+</option>
                                                    <option value="desidratado1">Desidratado(a) +/4+</option>
                                                    <option value="limiar">Hidratado(a) no limiar</option>
                                                    <option value="hidratado" selected>Hidratado(a)</option>
                                                    <option value="hipervolemico">HipervolÃªmico(a)</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Cianose</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="acianotico" selected>AcianÃ³tico(a)</option>
                                                    <option value="periferico1">CianÃ³tico(a) perifÃ©rico +/4+</option>
                                                    <option value="periferico2">CianÃ³tico(a) perifÃ©rico ++/4+</option>
                                                    <option value="periferico3">CianÃ³tico(a) perifÃ©rico +++/4+</option>
                                                    <option value="periferico4">CianÃ³tico(a) perifÃ©rico ++++/4+</option>
                                                    <option value="central1">CianÃ³tico(a) central +/4+</option>
                                                    <option value="central2">CianÃ³tico(a) central ++/4+</option>
                                                    <option value="central3">CianÃ³tico(a) central +++/4+</option>
                                                    <option value="central4">CianÃ³tico(a) central ++++/4+</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">IcterÃ­cia</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="anict" selected>AnictÃ©rico(a)</option>
                                                    <option value="leve">IctÃ©rico(a) +/4+</option>
                                                    <option value="moderado">IctÃ©rico(a) ++/4+</option>
                                                    <option value="grave">IctÃ©rico(a) +++/4+</option>
                                                    <option value="intenso">IctÃ©rico(a) ++++/4+</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <!-- Linha 3: Temperatura, Batimentos, RespiraÃ§Ã£o -->
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 15px;">
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Temperatura</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="afebril" selected>Afebril</option>
                                                    <option value="subfebril">Subfebril</option>
                                                    <option value="febril">Febril</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">Batimentos CardÃ­acos</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="bradicardico">BradicÃ¡rdico(a)</option>
                                                    <option value="normocardico" selected>NormocÃ¡rdico(a)</option>
                                                    <option value="taquicardico">TaquicÃ¡rdico(a)</option>
                                                </select>
                                            </div>
                                            <div class="prontuario-form-group">
                                                <label style="font-size: 12px;">RespiraÃ§Ã£o</label>
                                                <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                                    <option value="bradipneico">Bradipneico(a)</option>
                                                    <option value="eupneico" selected>Eupneico(a)</option>
                                                    <option value="taquipneico">Taquipneico(a)</option>
                                                    <option value="dispneico">Dispneico(a)</option>
                                                </select>
                                            </div>
                                        </div>
                                
                                        <!-- Campo de descriÃ§Ã£o por Ãºltimo -->
                                        <div class="prontuario-form-group full">
                                            <label style="font-size: 12px;">DescriÃ§Ã£o da Ectoscopia</label>
                                            <textarea placeholder="ObservaÃ§Ãµes adicionais sobre a inspeÃ§Ã£o geral..." rows="2" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // EXAME FÃSICO ESPECÃFICO - ESTRUTURA ESCALÃVEL v10.356
                        // Taxonomia: Mapeamento â†’ Sistemas â†’ Especialidades
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'exame-especifico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 10px; border: 1px solid #e0e0e0; border-left: 4px solid #8b5cf6;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid #ddd;">
                                    <h4 style="margin: 0; color: #333; font-size: 15px;">ğŸ¯ Exame FÃ­sico EspecÃ­fico</h4>
                                </div>
                                
                                <!-- BOTÃ•ES DE CATEGORIA -->
                                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                                    <button onclick="
                                        const painel = document.getElementById('sandbox-painel-mapeamento');
                                        const isOpen = painel.style.display !== 'none';
                                        painel.style.display = isOpen ? 'none' : 'block';
                                        this.style.background = isOpen ? 'white' : '#8b5cf6';
                                        this.style.color = isOpen ? '#8b5cf6' : 'white';
                                    " style="flex: 1; padding: 12px 16px; background: white; border: 2px solid #8b5cf6; color: #8b5cf6; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px;">
                                        ğŸ“ Mapa do Corpo
                                    </button>
                                    <button onclick="
                                        const painel = document.getElementById('sandbox-painel-sistemas');
                                        const isOpen = painel.style.display !== 'none';
                                        painel.style.display = isOpen ? 'none' : 'block';
                                        this.style.background = isOpen ? 'white' : '#3b82f6';
                                        this.style.color = isOpen ? '#3b82f6' : 'white';
                                    " style="flex: 1; padding: 12px 16px; background: white; border: 2px solid #3b82f6; color: #3b82f6; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px;">
                                        ğŸ”„ Sistemas
                                    </button>
                                    <button onclick="
                                        const painel = document.getElementById('sandbox-painel-especialidades');
                                        const isOpen = painel.style.display !== 'none';
                                        painel.style.display = isOpen ? 'none' : 'block';
                                        this.style.background = isOpen ? 'white' : '#22c55e';
                                        this.style.color = isOpen ? '#22c55e' : 'white';
                                    " style="flex: 1; padding: 12px 16px; background: white; border: 2px solid #22c55e; color: #22c55e; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 13px;">
                                        ğŸ¥ Especialidades
                                    </button>
                                </div>
                                
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <!-- PAINEL: MAPEAMENTO CORPORAL -->
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <div id="sandbox-painel-mapeamento" style="display: none; background: #f5f3ff; padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid #c4b5fd;">
                                    <div style="font-size: 12px; color: #6d28d9; font-weight: 600; margin-bottom: 12px;">ğŸ“ MAPEAMENTO CORPORAL</div>
                                    
                                    <!-- Exame por RegiÃµes -->
                                    <div style="margin-bottom: 12px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #d8b4fe; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="
                                                const container = document.getElementById('sandbox-container-map-lesoes');
                                                if (this.checked) {
                                                    container.style.display = 'block';
                                                    if (typeof AnatomiaAtendimento !== 'undefined') {
                                                        AnatomiaAtendimento.renderizar('sandbox-container-map-lesoes', {
                                                            visualizacao: 'frente',
                                                            template: '',
                                                            permitirEdicao: true,
                                                            modoSimplificado: true,
                                                            contextoInicial: 'anatomico'
                                                        });
                                                    }
                                                } else {
                                                    container.style.display = 'none';
                                                }
                                            "> 
                                            ğŸ—ºï¸ Exame por RegiÃµes
                                        </label>
                                        <div id="sandbox-container-map-lesoes" style="display: none; margin-top: 10px; min-height: 400px;"></div>
                                    </div>
                                    
                                    <!-- Queimaduras -->
                                    <div style="margin-bottom: 12px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #d8b4fe; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="
                                                const container = document.getElementById('sandbox-container-map-queimaduras');
                                                if (this.checked) {
                                                    container.style.display = 'block';
                                                    if (typeof AnatomiaAtendimento !== 'undefined') {
                                                        AnatomiaAtendimento.renderizar('sandbox-container-map-queimaduras', {
                                                            visualizacao: 'frente',
                                                            template: '',
                                                            permitirEdicao: true,
                                                            modoSimplificado: true,
                                                            contextoInicial: 'queimados'
                                                        });
                                                    }
                                                } else {
                                                    container.style.display = 'none';
                                                }
                                            "> 
                                            ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras
                                        </label>
                                        <div id="sandbox-container-map-queimaduras" style="display: none; margin-top: 10px; min-height: 400px;"></div>
                                    </div>
                                    
                                    <p style="margin: 10px 0 0 0; font-size: 10px; color: #888;">ğŸ’¡ Clique nas regiÃµes da silhueta para marcar achados</p>
                                </div>
                                
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <!-- PAINEL: SISTEMAS ORGÃ‚NICOS -->
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <div id="sandbox-painel-sistemas" style="display: none; background: #eff6ff; padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid #93c5fd;">
                                    <div style="font-size: 12px; color: #1d4ed8; font-weight: 600; margin-bottom: 12px;">ğŸ”„ SISTEMAS ORGÃ‚NICOS</div>
                                    
                                    <!-- Cardiovascular -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-cardio').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ«€ Cardiovascular
                                        </label>
                                        <div id="sandbox-sis-cardio" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                                <div><label style="font-size: 10px; color: #666;">FC:</label><input type="text" placeholder="bpm" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">Ritmo:</label><input type="text" placeholder="Regular/Irregular" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">Bulhas:</label><input type="text" placeholder="B1/B2 normofonÃ©ticas" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                            </div>
                                            <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="Sopros, estase jugular, edema, pulsos perifÃ©ricos..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- RespiratÃ³rio -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-resp').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ« RespiratÃ³rio
                                        </label>
                                        <div id="sandbox-sis-resp" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                                <div><label style="font-size: 10px; color: #666;">FR:</label><input type="text" placeholder="irpm" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">SpO2:</label><input type="text" placeholder="%" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">PadrÃ£o:</label><input type="text" placeholder="Eupneico" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                            </div>
                                            <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="MV presente bilateralmente, ruÃ­dos adventÃ­cios..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- DigestÃ³rio -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-digest').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ©º DigestÃ³rio
                                        </label>
                                        <div id="sandbox-sis-digest" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="Abdome: inspeÃ§Ã£o, ausculta, percussÃ£o, palpaÃ§Ã£o. RHA, dor, massas, visceromegalias..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Nervoso -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-neuro').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ§  Nervoso
                                        </label>
                                        <div id="sandbox-sis-neuro" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                                <div><label style="font-size: 10px; color: #666;">Glasgow:</label><input type="text" placeholder="AO+RV+RM" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">Pupilas:</label><input type="text" placeholder="IsocÃ³ricas/Fotorreagentes" style="width: 100%; padding: 6px; border: 1px solid #93c5fd; border-radius: 4px; font-size: 12px;"></div>
                                            </div>
                                            <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="ForÃ§a motora, sensibilidade, reflexos, coordenaÃ§Ã£o, marcha..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Tegumentar -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-tegum').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ”¬ Tegumentar
                                        </label>
                                        <div id="sandbox-sis-tegum" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="Pele, mucosas, anexos. ColoraÃ§Ã£o, turgor, lesÃµes elementares..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Vascular -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #93c5fd; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-sis-vasc').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ©¸ Vascular PerifÃ©rico
                                        </label>
                                        <div id="sandbox-sis-vasc" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #93c5fd; border-radius: 6px; font-size: 12px;" placeholder="Pulsos perifÃ©ricos, enchimento capilar, varizes, edema, sinais de TVP..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <!-- PAINEL: ESPECIALIDADES -->
                                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                                <div id="sandbox-painel-especialidades" style="display: none; background: #f0fdf4; padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid #86efac;">
                                    <div style="font-size: 12px; color: #15803d; font-weight: 600; margin-bottom: 12px;">ğŸ¥ ESPECIALIDADES</div>
                                    
                                    <!-- Bucomaxilofacial -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-bmf').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ¦· Bucomaxilofacial
                                        </label>
                                        <div id="sandbox-esp-bmf" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="OclusÃ£o, abertura bucal, ATM, dentiÃ§Ã£o, mucosa oral, terÃ§os faciais..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Oftalmologia -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-oftalmo').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ‘ï¸ Oftalmologia
                                        </label>
                                        <div id="sandbox-esp-oftalmo" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                                <div><label style="font-size: 10px; color: #666;">AV OD:</label><input type="text" placeholder="20/20" style="width: 100%; padding: 6px; border: 1px solid #86efac; border-radius: 4px; font-size: 12px;"></div>
                                                <div><label style="font-size: 10px; color: #666;">AV OE:</label><input type="text" placeholder="20/20" style="width: 100%; padding: 6px; border: 1px solid #86efac; border-radius: 4px; font-size: 12px;"></div>
                                            </div>
                                            <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="Biomicroscopia, fundoscopia, motilidade ocular extrÃ­nseca, PIO..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Ortopedia -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-orto').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ¦´ Ortopedia
                                        </label>
                                        <div id="sandbox-esp-orto" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="InspeÃ§Ã£o, palpaÃ§Ã£o, ADM, forÃ§a muscular, testes especiais..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Otorrinolaringologia -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-orl').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ‘‚ Otorrinolaringologia
                                        </label>
                                        <div id="sandbox-esp-orl" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="Otoscopia, rinoscopia, oroscopia, laringoscopia..."></textarea>
                                        </div>
                                    </div>
                                    
                                    <!-- Cirurgia Vascular -->
                                    <div style="margin-bottom: 10px;">
                                        <label style="display: flex; align-items: center; gap: 6px; padding: 8px 12px; background: white; border: 1px solid #86efac; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                            <input type="checkbox" onchange="document.getElementById('sandbox-esp-vascular').style.display = this.checked ? 'block' : 'none'"> 
                                            ğŸ©¸ Cirurgia Vascular
                                        </label>
                                        <div id="sandbox-esp-vascular" style="display: none; margin-top: 8px; padding: 12px; background: white; border-radius: 6px;">
                                            <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; font-size: 12px;" placeholder="Ãndice tornozelo-braquial, varizes (CEAP), Ãºlceras..."></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ObservaÃ§Ãµes gerais -->
                                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px dashed #ddd;">
                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">ObservaÃ§Ãµes adicionais</label>
                                    <textarea id="pront-exame-especifico-obs" rows="2" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Outras observaÃ§Ãµes..."></textarea>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // MÃ“DULOS INDIVIDUAIS DE EXAME ESPECÃFICO (para seleÃ§Ã£o avulsa)
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'mapa-anatomico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f5f3ff; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                                <h4 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ—ºï¸ Exame por RegiÃµes</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 12px;">
                                    <div style="background: white; padding: 15px; border-radius: 6px; text-align: center;">
                                        <p style="font-size: 11px; color: #666; margin: 0 0 10px 0;">Vista Anterior</p>
                                        <div style="width: 150px; height: 200px; background: #f0f0f0; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #999;">[Silhueta Anterior]</div>
                                    </div>
                                    <div style="background: white; padding: 15px; border-radius: 6px; text-align: center;">
                                        <p style="font-size: 11px; color: #666; margin: 0 0 10px 0;">Vista Posterior</p>
                                        <div style="width: 150px; height: 200px; background: #f0f0f0; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #999;">[Silhueta Posterior]</div>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; font-size: 13px;" placeholder="Descreva localizaÃ§Ã£o e caracterÃ­sticas das lesÃµes..."></textarea>
                            </div>
                        `,
                        'avaliacao-queimaduras': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #ef4444;">
                                <h4 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">MÃ©todo de CÃ¡lculo:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                            <option>Regra dos 9 (Wallace)</option>
                                            <option>Lund-Browder (pediÃ¡trico)</option>
                                            <option>Palma da mÃ£o (1%)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">SCQ Total (%):</label>
                                        <input type="number" min="0" max="100" placeholder="%" style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px; font-size: 16px; font-weight: bold; text-align: center;">
                                    </div>
                                </div>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                                    <div style="background: white; padding: 10px; border-radius: 6px; text-align: center;">
                                        <div style="font-size: 11px; color: #666;">1Âº Grau</div>
                                        <input type="number" min="0" max="100" placeholder="%" style="width: 60px; padding: 6px; border: 1px solid #fca5a5; border-radius: 4px; text-align: center; margin-top: 4px;">
                                    </div>
                                    <div style="background: white; padding: 10px; border-radius: 6px; text-align: center;">
                                        <div style="font-size: 11px; color: #666;">2Âº Grau</div>
                                        <input type="number" min="0" max="100" placeholder="%" style="width: 60px; padding: 6px; border: 1px solid #fca5a5; border-radius: 4px; text-align: center; margin-top: 4px;">
                                    </div>
                                    <div style="background: white; padding: 10px; border-radius: 6px; text-align: center;">
                                        <div style="font-size: 11px; color: #666;">3Âº Grau</div>
                                        <input type="number" min="0" max="100" placeholder="%" style="width: 60px; padding: 6px; border: 1px solid #fca5a5; border-radius: 4px; text-align: center; margin-top: 4px;">
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; font-size: 13px;" placeholder="Ex: Escaldadura por Ã¡gua quente, acometendo face anterior de tÃ³rax e MMSS..."></textarea>
                            </div>
                        `,
                        'avaliacao-feridas': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fffbeb; border-radius: 8px; border-left: 4px solid #f59e0b;">
                                <h4 style="margin: 0 0 12px 0; color: #d97706; font-size: 14px;">ğŸ©¹ AvaliaÃ§Ã£o de Feridas</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Tipo:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px;">
                                            <option>Incisa</option><option>Contusa</option><option>Lacerada</option><option>Perfurante</option><option>AvulsÃ£o</option><option>AbrasÃ£o</option><option>Ãšlcera</option><option>DeiscÃªncia</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">DimensÃµes (cm):</label>
                                        <input type="text" placeholder="Ex: 5x3x1" style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Leito:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px;">
                                            <option>GranulaÃ§Ã£o</option><option>EpitelizaÃ§Ã£o</option><option>Necrose</option><option>Esfacelo</option><option>Misto</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fcd34d; border-radius: 6px; font-size: 13px;" placeholder="LocalizaÃ§Ã£o, bordas, exsudato, sinais de infecÃ§Ã£o..."></textarea>
                            </div>
                        `,
                        'exame-cardiovascular': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #dc2626;">
                                <h4 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸ«€ Exame Cardiovascular</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Ritmo:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                            <option>Regular, 2 tempos</option><option>Regular, 3 tempos (B3)</option><option>Regular, 3 tempos (B4)</option><option>Irregular</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Bulhas:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                            <option>NormofonÃ©ticas</option><option>HipofonÃ©ticas</option><option>HiperfonÃ©ticas</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; font-size: 13px;" placeholder="Sopros, pulsos perifÃ©ricos, estase jugular, edema..."></textarea>
                            </div>
                        `,
                        'exame-respiratorio': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f0f9ff; border-radius: 8px; border-left: 4px solid #0ea5e9;">
                                <h4 style="margin: 0 0 12px 0; color: #0284c7; font-size: 14px;">ğŸ« Exame RespiratÃ³rio</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">MurmÃºrio Vesicular:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px;">
                                            <option>Presente bilateral, simÃ©trico</option><option>DiminuÃ­do Ã  direita</option><option>DiminuÃ­do Ã  esquerda</option><option>DiminuÃ­do bilateral</option><option>Abolido Ã  direita</option><option>Abolido Ã  esquerda</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">RuÃ­dos AdventÃ­cios:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px;">
                                            <option>Ausentes</option><option>Estertores crepitantes</option><option>Estertores bolhosos</option><option>Sibilos</option><option>Roncos</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #7dd3fc; border-radius: 6px; font-size: 13px;" placeholder="Expansibilidade, percussÃ£o, tiragem, uso de musculatura acessÃ³ria..."></textarea>
                            </div>
                        `,
                        'exame-abdominal': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f0fdf4; border-radius: 8px; border-left: 4px solid #22c55e;">
                                <h4 style="margin: 0 0 12px 0; color: #16a34a; font-size: 14px;">ğŸ©º Exame Abdominal</h4>
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">InspeÃ§Ã£o:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                            <option>Plano</option><option>Globoso</option><option>Escavado</option><option>Distendido</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">RHA:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                            <option>Presentes</option><option>Aumentados</option><option>DiminuÃ­dos</option><option>Ausentes</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">PalpaÃ§Ã£o:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                            <option>FlÃ¡cido, indolor</option><option>Tenso</option><option>Doloroso difuso</option><option>Doloroso localizado</option><option>Defesa</option><option>DescompressÃ£o +</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Visceromegalias:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                            <option>Ausentes</option><option>Hepatomegalia</option><option>Esplenomegalia</option><option>Ambas</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; font-size: 13px;" placeholder="Massas, hÃ©rnias, cicatrizes, sinais de irritaÃ§Ã£o peritoneal..."></textarea>
                            </div>
                        `,
                        'exame-neurologico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #faf5ff; border-radius: 8px; border-left: 4px solid #a855f7;">
                                <h4 style="margin: 0 0 12px 0; color: #9333ea; font-size: 14px;">ğŸ§  Exame NeurolÃ³gico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">NÃ­vel de consciÃªncia:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                            <option>Alerta, orientado</option><option>Sonolento</option><option>Torporoso</option><option>Comatoso</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Pupilas:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                            <option>IsocÃ³ricas, fotorreagentes</option><option>AnisocÃ³ricas</option><option>MidrÃ­ase bilateral</option><option>Miose bilateral</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">ForÃ§a muscular:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                            <option>Preservada (grau V)</option><option>DiminuÃ­da</option><option>Hemiparesia D</option><option>Hemiparesia E</option><option>Paraparesia</option><option>Tetraparesia</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; font-size: 13px;" placeholder="Reflexos, sensibilidade, coordenaÃ§Ã£o, marcha, sinais menÃ­ngeos..."></textarea>
                            </div>
                        `,
                        'exame-ortopedico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fafaf9; border-radius: 8px; border-left: 4px solid #78716c;">
                                <h4 style="margin: 0 0 12px 0; color: #57534e; font-size: 14px;">ğŸ¦´ Exame OrtopÃ©dico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">RegiÃ£o acometida:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px;">
                                            <option>Coluna cervical</option><option>Coluna torÃ¡cica</option><option>Coluna lombar</option><option>Ombro</option><option>Cotovelo</option><option>Punho/MÃ£o</option><option>Quadril</option><option>Joelho</option><option>Tornozelo/PÃ©</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Lateralidade:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px;">
                                            <option>Direito</option><option>Esquerdo</option><option>Bilateral</option><option>Linha mÃ©dia</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #d6d3d1; border-radius: 6px; font-size: 13px;" placeholder="InspeÃ§Ã£o (edema, deformidade, equimose), palpaÃ§Ã£o, amplitude de movimento, testes especiais, avaliaÃ§Ã£o neurovascular distal..."></textarea>
                            </div>
                        `,
                        'exame-vascular': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fff1f2; border-radius: 8px; border-left: 4px solid #be123c;">
                                <h4 style="margin: 0 0 12px 0; color: #be123c; font-size: 14px;">ğŸ©¸ Exame Vascular PerifÃ©rico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Pulsos perifÃ©ricos:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                            <option>Presentes e simÃ©tricos</option><option>DiminuÃ­dos</option><option>Ausentes Ã  direita</option><option>Ausentes Ã  esquerda</option><option>Ausentes bilateral</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">PerfusÃ£o:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                            <option>Adequada (TEC < 3s)</option><option>Lentificada (TEC 3-5s)</option><option>Muito lenta (TEC > 5s)</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fda4af; border-radius: 6px; font-size: 13px;" placeholder="Edema, varizes, Ãºlceras, alteraÃ§Ãµes de cor/temperatura, ITB..."></textarea>
                            </div>
                        `,
                        'exame-dermatologico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fdf2f8; border-radius: 8px; border-left: 4px solid #ec4899;">
                                <h4 style="margin: 0 0 12px 0; color: #db2777; font-size: 14px;">ğŸ”¬ Exame DermatolÃ³gico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">LesÃ£o elementar:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                            <option>MÃ¡cula</option><option>PÃ¡pula</option><option>Placa</option><option>NÃ³dulo</option><option>VesÃ­cula</option><option>Bolha</option><option>PÃºstula</option><option>Ãšlcera</option><option>ErosÃ£o</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">DistribuiÃ§Ã£o:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                            <option>Localizada</option><option>Disseminada</option><option>Generalizada</option><option>Ãreas fotoexpostas</option><option>Ãreas intertriginosas</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #f9a8d4; border-radius: 6px; font-size: 13px;" placeholder="Cor, tamanho, bordas, superfÃ­cie, anexos cutÃ¢neos..."></textarea>
                            </div>
                        `,
                        'exame-oftalmologico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #ecfeff; border-radius: 8px; border-left: 4px solid #0891b2;">
                                <h4 style="margin: 0 0 12px 0; color: #0e7490; font-size: 14px;">ğŸ‘ï¸ Exame OftalmolÃ³gico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">AV OD:</label>
                                        <input type="text" placeholder="20/20" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">AV OE:</label>
                                        <input type="text" placeholder="20/20" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Reflexos pupilares:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                            <option>Preservados</option><option>Alterados</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #67e8f9; border-radius: 6px; font-size: 13px;" placeholder="Biomicroscopia, fundoscopia, motilidade ocular extrÃ­nseca..."></textarea>
                            </div>
                        `,
                        'exame-otorrino': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f5f3ff; border-radius: 8px; border-left: 4px solid #7c3aed;">
                                <h4 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ‘‚ Exame OtorrinolaringolÃ³gico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Otoscopia:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                            <option>Normal bilateral</option><option>Hiperemia OD</option><option>Hiperemia OE</option><option>Cerume</option><option>PerfuraÃ§Ã£o</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Rinoscopia:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                            <option>Normal</option><option>Hiperemia</option><option>Edema</option><option>Desvio septal</option><option>PÃ³lipos</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Orofaringe:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                            <option>Normal</option><option>Hiperemia</option><option>Hipertrofia amÃ­gdalas</option><option>Exsudato</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; font-size: 13px;" placeholder="Acumetria, palpaÃ§Ã£o cervical, laringoscopia..."></textarea>
                            </div>
                        `,
                        'exame-bucomaxilo': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #ecfdf5; border-radius: 8px; border-left: 4px solid #059669;">
                                <h4 style="margin: 0 0 12px 0; color: #047857; font-size: 14px;">ğŸ¦· Exame Bucomaxilofacial</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="font-size: 11px; color: #666;">Abertura bucal:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px;">
                                            <option>Normal (> 40mm)</option><option>Limitada (20-40mm)</option><option>Muito limitada (< 20mm)</option><option>Trismo</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label style="font-size: 11px; color: #666;">ATM:</label>
                                        <select style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px;">
                                            <option>Sem alteraÃ§Ãµes</option><option>Estalido</option><option>CrepitaÃ§Ã£o</option><option>Dor Ã  palpaÃ§Ã£o</option><option>LuxaÃ§Ã£o</option>
                                        </select>
                                    </div>
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #6ee7b7; border-radius: 6px; font-size: 13px;" placeholder="Face, oclusÃ£o dentÃ¡ria, mucosa oral, glÃ¢ndulas salivares, fraturas..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // HIPÃ“TESE DIAGNÃ“STICA
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'hipotese': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #92400e; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ¯ HipÃ³tese DiagnÃ³stica
                                </h4>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="DiagnÃ³stico principal e diagnÃ³sticos diferenciais..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // CID-10
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'cid10': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8fafc; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #4338ca; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ·ï¸ CID-10
                                </h4>
                                <div style="display: flex; gap: 12px;">
                                    <input type="text" placeholder="CÃ³digo (ex: J18.9)" style="width: 150px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; font-weight: 600;">
                                    <input type="text" placeholder="DescriÃ§Ã£o" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // CONDUTA
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'conduta': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #ecfdf5; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #065f46; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    Conduta
                                </h4>
                                <textarea rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Plano terapÃªutico, orientaÃ§Ãµes, retorno..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // PRESCRIÃ‡ÃƒO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'prescricao': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #555; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ’‰ PrescriÃ§Ã£o
                                </h4>
                                <textarea rows="5" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="1) Medicamento - dose - via - frequÃªncia - duraÃ§Ã£o"></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // EXAMES A SOLICITAR
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'exames-solicitar': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #6b21a8; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ”¬ Exames a Solicitar
                                </h4>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Hemograma completo, Glicemia jejum, ECG, RX tÃ³rax..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ENCAMINHAMENTO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'encaminhamento': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #c2410c; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    â¡ï¸ Encaminhamento
                                </h4>
                                <div style="margin-bottom: 12px;">
                                    <input type="text" placeholder="Especialidade" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                </div>
                                <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="Motivo do encaminhamento, informaÃ§Ãµes relevantes..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // DESCRIÃ‡ÃƒO CIRÃšRGICA
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'desc-cirurgica': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #166534; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ”ª DescriÃ§Ã£o CirÃºrgica
                                </h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <input type="text" placeholder="Procedimento" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                    <input type="text" placeholder="DuraÃ§Ã£o" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                    <input type="text" placeholder="Anestesia" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                </div>
                                <textarea rows="6" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="1. Paciente em DDH, sob anestesia geral..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // PLANEJAMENTO CIRÃšRGICO
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'planejamento': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fdf4ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #86198f; font-size: 14px; display: flex; align-items: center; gap: 8px;">
                                    ğŸ“… Planejamento CirÃºrgico
                                </h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <input type="text" placeholder="Procedimento planejado" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                    <input type="date" style="padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px;">
                                </div>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-family: inherit; font-size: 13px; resize: vertical;" placeholder="TÃ©cnica, materiais, preparo prÃ©-operatÃ³rio, exames necessÃ¡rios..."></textarea>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ESCALA DE GLASGOW
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'glasgow': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px;">Escala de Coma de Glasgow</h4>
                                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">PontuaÃ§Ã£o: 3 (mÃ­nimo) a 15 (mÃ¡ximo)</p>
                                
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 15px;">
                                    <!-- Abertura Ocular -->
                                    <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 12px; font-weight: 600; color: #333; display: block; margin-bottom: 8px;">Abertura Ocular (AO)</label>
                                        <select id="glasgow-ao" onchange="ProntuarioModular.calcularGlasgow && ProntuarioModular.calcularGlasgow()" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                            <option value="4">4 - EspontÃ¢nea</option>
                                            <option value="3">3 - Ao comando verbal</option>
                                            <option value="2">2 - Ã€ dor</option>
                                            <option value="1">1 - Ausente</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Resposta Verbal -->
                                    <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 12px; font-weight: 600; color: #333; display: block; margin-bottom: 8px;">Resposta Verbal (RV)</label>
                                        <select id="glasgow-rv" onchange="ProntuarioModular.calcularGlasgow && ProntuarioModular.calcularGlasgow()" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                            <option value="5">5 - Orientada</option>
                                            <option value="4">4 - Confusa</option>
                                            <option value="3">3 - Palavras inapropriadas</option>
                                            <option value="2">2 - Sons incompreensÃ­veis</option>
                                            <option value="1">1 - Ausente</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Resposta Motora -->
                                    <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 12px; font-weight: 600; color: #333; display: block; margin-bottom: 8px;">Resposta Motora (RM)</label>
                                        <select id="glasgow-rm" onchange="ProntuarioModular.calcularGlasgow && ProntuarioModular.calcularGlasgow()" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px;">
                                            <option value="6">6 - Obedece comandos</option>
                                            <option value="5">5 - Localiza dor</option>
                                            <option value="4">4 - Retirada Ã  dor</option>
                                            <option value="3">3 - FlexÃ£o anormal (decorticaÃ§Ã£o)</option>
                                            <option value="2">2 - ExtensÃ£o anormal (descerebraÃ§Ã£o)</option>
                                            <option value="1">1 - Ausente</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Resultado -->
                                <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <span style="font-size: 13px; color: #666;">PontuaÃ§Ã£o Total:</span>
                                        <span id="glasgow-total" style="font-size: 24px; font-weight: bold; color: #333; margin-left: 10px;">15</span>
                                        <span style="font-size: 13px; color: #666;">/15</span>
                                    </div>
                                    <div id="glasgow-classificacao" style="padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; background: #dcfce7; color: #166534;">
                                        TCE Leve
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ESCALA DE BRADEN
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'braden': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px;">Escala de Braden - Risco de LesÃ£o por PressÃ£o</h4>
                                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">PontuaÃ§Ã£o: 6-23 (menor = maior risco)</p>
                                
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 15px;">
                                    <!-- PercepÃ§Ã£o Sensorial -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">PercepÃ§Ã£o Sensorial</label>
                                        <select id="braden-sensorial" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Nenhuma limitaÃ§Ã£o</option>
                                            <option value="3">3 - Levemente limitada</option>
                                            <option value="2">2 - Muito limitada</option>
                                            <option value="1">1 - Totalmente limitada</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Umidade -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">Umidade</label>
                                        <select id="braden-umidade" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Raramente molhada</option>
                                            <option value="3">3 - Ocasionalmente molhada</option>
                                            <option value="2">2 - Muito molhada</option>
                                            <option value="1">1 - Constantemente molhada</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Atividade -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">Atividade</label>
                                        <select id="braden-atividade" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Deambula frequentemente</option>
                                            <option value="3">3 - Deambula ocasionalmente</option>
                                            <option value="2">2 - Confinado Ã  cadeira</option>
                                            <option value="1">1 - Acamado</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Mobilidade -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">Mobilidade</label>
                                        <select id="braden-mobilidade" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Nenhuma limitaÃ§Ã£o</option>
                                            <option value="3">3 - Levemente limitada</option>
                                            <option value="2">2 - Muito limitada</option>
                                            <option value="1">1 - Totalmente imÃ³vel</option>
                                        </select>
                                    </div>
                                    
                                    <!-- NutriÃ§Ã£o -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">NutriÃ§Ã£o</label>
                                        <select id="braden-nutricao" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="4">4 - Excelente</option>
                                            <option value="3">3 - Adequada</option>
                                            <option value="2">2 - Provavelmente inadequada</option>
                                            <option value="1">1 - Muito pobre</option>
                                        </select>
                                    </div>
                                    
                                    <!-- FricÃ§Ã£o e Cisalhamento -->
                                    <div style="background: white; padding: 10px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                        <label style="font-size: 11px; font-weight: 600; color: #333; display: block; margin-bottom: 6px;">FricÃ§Ã£o e Cisalhamento</label>
                                        <select id="braden-friccao" onchange="ProntuarioModular.calcularBraden && ProntuarioModular.calcularBraden()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 11px;">
                                            <option value="3">3 - Nenhum problema</option>
                                            <option value="2">2 - Problema potencial</option>
                                            <option value="1">1 - Problema</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Resultado -->
                                <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <span style="font-size: 13px; color: #666;">PontuaÃ§Ã£o Total:</span>
                                        <span id="braden-total" style="font-size: 24px; font-weight: bold; color: #333; margin-left: 10px;">23</span>
                                        <span style="font-size: 13px; color: #666;">/23</span>
                                    </div>
                                    <div id="braden-risco" style="padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; background: #dcfce7; color: #166534;">
                                        Sem Risco
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // AVALIAÃ‡ÃƒO ABCDE (TRAUMA)
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'abcde': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px;">AvaliaÃ§Ã£o PrimÃ¡ria - ABCDE</h4>
                                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">AvaliaÃ§Ã£o sistemÃ¡tica do paciente traumatizado (ATLS)</p>
                                
                                <!-- A - Airway -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 10px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #ef4444; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">A</span>
                                        <span style="font-weight: 600; color: #333;">Airway - Via AÃ©rea (com proteÃ§Ã£o cervical)</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                        <select id="abcde-a-status" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="pervia">Via aÃ©rea pÃ©rvia</option>
                                            <option value="obstruida-parcial">ObstruÃ§Ã£o parcial</option>
                                            <option value="obstruida-total">ObstruÃ§Ã£o total</option>
                                            <option value="iot">IOT realizada</option>
                                        </select>
                                        <input type="text" placeholder="ObservaÃ§Ãµes..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                                
                                <!-- B - Breathing -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 10px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #f97316; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">B</span>
                                        <span style="font-weight: 600; color: #333;">Breathing - VentilaÃ§Ã£o</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="normal">VentilaÃ§Ã£o normal</option>
                                            <option value="taquipneia">Taquipneia</option>
                                            <option value="bradipneia">Bradipneia</option>
                                            <option value="dispneia">Dispneia</option>
                                            <option value="apneia">Apneia</option>
                                        </select>
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="mv-bilateral">MV bilateral presente</option>
                                            <option value="mv-diminuido-d">MV diminuÃ­do D</option>
                                            <option value="mv-diminuido-e">MV diminuÃ­do E</option>
                                            <option value="mv-ausente-d">MV ausente D</option>
                                            <option value="mv-ausente-e">MV ausente E</option>
                                        </select>
                                        <input type="text" placeholder="SpOâ‚‚, FR..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                                
                                <!-- C - Circulation -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 10px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #eab308; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">C</span>
                                        <span style="font-weight: 600; color: #333;">Circulation - CirculaÃ§Ã£o (com controle de hemorragia)</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="estavel">Hemodinamicamente estÃ¡vel</option>
                                            <option value="instavel">Instabilidade hemodinÃ¢mica</option>
                                            <option value="choque">Choque</option>
                                        </select>
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="pulso-cheio">Pulso cheio e regular</option>
                                            <option value="pulso-filiforme">Pulso filiforme</option>
                                            <option value="pulso-irregular">Pulso irregular</option>
                                            <option value="pulso-ausente">Pulso ausente</option>
                                        </select>
                                        <input type="text" placeholder="PA, FC, Hemorragias..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                                
                                <!-- D - Disability -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0; margin-bottom: 10px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #22c55e; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">D</span>
                                        <span style="font-weight: 600; color: #333;">Disability - AvaliaÃ§Ã£o NeurolÃ³gica</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="a">A - Alerta</option>
                                            <option value="v">V - Responde a estÃ­mulo verbal</option>
                                            <option value="p">P - Responde a dor</option>
                                            <option value="u">U - NÃ£o responsivo</option>
                                        </select>
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="pupilas-isocoricas">Pupilas isocÃ³ricas</option>
                                            <option value="pupilas-anisocoricas">Pupilas anisocÃ³ricas</option>
                                            <option value="pupilas-midriaticas">MidrÃ­ase bilateral</option>
                                            <option value="pupilas-mioticas">Miose bilateral</option>
                                        </select>
                                        <input type="text" placeholder="Glasgow, Glicemia..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                                
                                <!-- E - Exposure -->
                                <div style="background: white; padding: 12px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                        <span style="background: #3b82f6; color: white; padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 13px;">E</span>
                                        <span style="font-weight: 600; color: #333;">Exposure - ExposiÃ§Ã£o (com prevenÃ§Ã£o de hipotermia)</span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                        <select style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                            <option value="sem-lesoes">Sem lesÃµes aparentes</option>
                                            <option value="escoriacoes">EscoriaÃ§Ãµes</option>
                                            <option value="contusoes">ContusÃµes</option>
                                            <option value="lac-simples">LaceraÃ§Ãµes simples</option>
                                            <option value="lac-complexas">LaceraÃ§Ãµes complexas</option>
                                            <option value="fraturas">Fraturas expostas</option>
                                        </select>
                                        <input type="text" placeholder="Temperatura, LesÃµes identificadas..." style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; font-size: 12px;">
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ESCALA RASS (Richmond Agitation-Sedation)
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'rass': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px;">Escala RASS - Richmond Agitation-Sedation</h4>
                                <p style="color: #666; font-size: 12px; margin-bottom: 15px;">AvaliaÃ§Ã£o do nÃ­vel de sedaÃ§Ã£o/agitaÃ§Ã£o</p>
                                
                                <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                    <select id="rass-valor" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                        <option value="+4">+4 Combativo - Violento, perigo imediato para a equipe</option>
                                        <option value="+3">+3 Muito agitado - Puxa ou remove tubos, agressivo</option>
                                        <option value="+2">+2 Agitado - Movimentos frequentes sem propÃ³sito, briga com o ventilador</option>
                                        <option value="+1">+1 Inquieto - Ansioso, mas sem movimentos agressivos</option>
                                        <option value="0" selected>0 Alerta e calmo</option>
                                        <option value="-1">-1 Sonolento - NÃ£o totalmente alerta, mas mantÃ©m olhos abertos >10s</option>
                                        <option value="-2">-2 SedaÃ§Ã£o leve - Desperta brevemente, contato visual <10s</option>
                                        <option value="-3">-3 SedaÃ§Ã£o moderada - Movimento ou abertura ocular ao estÃ­mulo verbal, sem contato visual</option>
                                        <option value="-4">-4 SedaÃ§Ã£o profunda - Sem resposta ao estÃ­mulo verbal, movimento ao estÃ­mulo fÃ­sico</option>
                                        <option value="-5">-5 NÃ£o despertÃ¡vel - Sem resposta ao estÃ­mulo verbal ou fÃ­sico</option>
                                    </select>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // MÃ“DULOS CIRÃšRGICOS - v10.358
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'consentimento': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fefce8; border-radius: 8px; border-left: 4px solid #eab308;">
                                <h4 style="margin: 0 0 12px 0; color: #854d0e; font-size: 14px;">âœï¸ Termo de Consentimento</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Procedimento proposto:</label>
                                        <input type="text" style="width: 100%; padding: 10px; border: 1px solid #fde047; border-radius: 6px; margin-top: 4px;" placeholder="Nome do procedimento">
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Data assinatura:</label>
                                            <input type="date" style="width: 100%; padding: 10px; border: 1px solid #fde047; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">ResponsÃ¡vel (se menor):</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #fde047; border-radius: 6px; margin-top: 4px;" placeholder="Nome do responsÃ¡vel">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Riscos informados:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fde047; border-radius: 6px; margin-top: 4px;" placeholder="Riscos explicados ao paciente..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'anestesia': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #faf5ff; border-radius: 8px; border-left: 4px solid #a855f7;">
                                <h4 style="margin: 0 0 12px 0; color: #7e22ce; font-size: 14px;">ğŸ’‰ Ficha de Anestesia</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Tipo de anestesia:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                                <option value="">Selecione...</option>
                                                <option>Geral</option><option>Raquianestesia</option><option>Peridural</option>
                                                <option>Bloqueio de plexo</option><option>Local</option><option>SedaÃ§Ã£o</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">ASA:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                                <option>ASA I</option><option>ASA II</option><option>ASA III</option>
                                                <option>ASA IV</option><option>ASA V</option><option>ASA VI</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Drogas utilizadas:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;" placeholder="MedicaÃ§Ãµes, doses..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'pos-op': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f0fdf4; border-radius: 8px; border-left: 4px solid #22c55e;">
                                <h4 style="margin: 0 0 12px 0; color: #15803d; font-size: 14px;">ğŸ¥ PÃ³s-OperatÃ³rio</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">DPO:</label>
                                            <input type="number" min="0" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Destino:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                                <option>Enfermaria</option><option>UTI</option><option>RPA</option><option>Alta</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Dieta:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                                <option>Zero</option><option>LÃ­quida</option><option>Pastosa</option><option>Branda</option><option>Livre</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">EvoluÃ§Ã£o pÃ³s-operatÃ³ria:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="Estado geral, ferida operatÃ³ria, drenos..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'drenos': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fff7ed; border-radius: 8px; border-left: 4px solid #f97316;">
                                <h4 style="margin: 0 0 12px 0; color: #c2410c; font-size: 14px;">ğŸ©¹ Drenos e Dispositivos</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Tipo:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #fdba74; border-radius: 6px; margin-top: 4px;">
                                                <option value="">Selecione...</option>
                                                <option>Penrose</option><option>Portovac</option><option>Blake</option>
                                                <option>Tubular</option><option>Sonda vesical</option><option>SNG</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">LocalizaÃ§Ã£o:</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #fdba74; border-radius: 6px; margin-top: 4px;" placeholder="Ex: FID, subcutÃ¢neo">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">DÃ©bito (ml/24h):</label>
                                            <input type="number" style="width: 100%; padding: 10px; border: 1px solid #fdba74; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Aspecto/ObservaÃ§Ãµes:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fdba74; border-radius: 6px; margin-top: 4px;" placeholder="Aspecto do dÃ©bito, funcionamento..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // MÃ“DULOS DE INTERNAÃ‡ÃƒO - v10.358
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'evolucao-soap': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #eff6ff; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #1d4ed8; font-size: 14px;">ğŸ“‹ EvoluÃ§Ã£o SOAP</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div>
                                        <label style="font-size: 12px; color: #666; font-weight: 600;">S - Subjetivo (queixas do paciente):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 4px;" placeholder="O que o paciente refere..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666; font-weight: 600;">O - Objetivo (exame fÃ­sico):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 4px;" placeholder="Achados ao exame..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666; font-weight: 600;">A - AvaliaÃ§Ã£o (anÃ¡lise):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 4px;" placeholder="ImpressÃ£o diagnÃ³stica..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666; font-weight: 600;">P - Plano (conduta):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 4px;" placeholder="Conduta proposta..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'balanco-hidrico': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #ecfeff; border-radius: 8px; border-left: 4px solid #06b6d4;">
                                <h4 style="margin: 0 0 12px 0; color: #0891b2; font-size: 14px;">ğŸ’§ BalanÃ§o HÃ­drico</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div style="background: #cffafe; padding: 12px; border-radius: 6px;">
                                        <h5 style="margin: 0 0 8px 0; font-size: 12px; color: #0891b2;">ENTRADAS</h5>
                                        <div style="display: grid; gap: 8px;">
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Dieta VO:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #67e8f9; border-radius: 4px;" placeholder="ml">
                                            </div>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Soro IV:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #67e8f9; border-radius: 4px;" placeholder="ml">
                                            </div>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Hemoderivados:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #67e8f9; border-radius: 4px;" placeholder="ml">
                                            </div>
                                        </div>
                                    </div>
                                    <div style="background: #fef3c7; padding: 12px; border-radius: 6px;">
                                        <h5 style="margin: 0 0 8px 0; font-size: 12px; color: #d97706;">SAÃDAS</h5>
                                        <div style="display: grid; gap: 8px;">
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Diurese:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #fde047; border-radius: 4px;" placeholder="ml">
                                            </div>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Drenos:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #fde047; border-radius: 4px;" placeholder="ml">
                                            </div>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                <label style="font-size: 11px; width: 80px;">Perdas GI:</label>
                                                <input type="number" style="flex: 1; padding: 6px; border: 1px solid #fde047; border-radius: 4px;" placeholder="ml">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-top: 12px; padding: 10px; background: white; border-radius: 6px; text-align: center;">
                                    <span style="font-size: 12px; color: #666;">BALANÃ‡O: </span>
                                    <span style="font-size: 14px; font-weight: bold; color: #0891b2;">Calcular automaticamente</span>
                                </div>
                            </div>
                        `,
                        
                        'alta': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f0fdf4; border-radius: 8px; border-left: 4px solid #22c55e;">
                                <h4 style="margin: 0 0 12px 0; color: #15803d; font-size: 14px;">ğŸ“¤ SumÃ¡rio de Alta</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Data de internaÃ§Ã£o:</label>
                                            <input type="date" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Data de alta:</label>
                                            <input type="date" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">DiagnÃ³stico(s) final(is):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="CID-10 e descriÃ§Ã£o..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Procedimento(s) realizado(s):</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="Cirurgias, procedimentos..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">OrientaÃ§Ãµes de alta:</label>
                                        <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;" placeholder="MedicaÃ§Ãµes, cuidados, retorno..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'intercorrencias': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #ef4444;">
                                <h4 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">âš ï¸ IntercorrÃªncias</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Data/Hora:</label>
                                            <input type="datetime-local" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Gravidade:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                                <option>Leve</option><option>Moderada</option><option>Grave</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">DescriÃ§Ã£o da intercorrÃªncia:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;" placeholder="O que aconteceu..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Conduta tomada:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;" placeholder="Medidas adotadas..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'enfermagem': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fdf4ff; border-radius: 8px; border-left: 4px solid #d946ef;">
                                <h4 style="margin: 0 0 12px 0; color: #a21caf; font-size: 14px;">ğŸ‘©â€âš•ï¸ AnotaÃ§Ãµes de Enfermagem</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Turno:</label>
                                            <select style="width: 100%; padding: 10px; border: 1px solid #f0abfc; border-radius: 6px; margin-top: 4px;">
                                                <option>ManhÃ£ (07-13h)</option><option>Tarde (13-19h)</option><option>Noite (19-07h)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Enfermeiro(a):</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #f0abfc; border-radius: 6px; margin-top: 4px;" placeholder="Nome">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">COREN:</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #f0abfc; border-radius: 6px; margin-top: 4px;" placeholder="NÃºmero">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">AnotaÃ§Ãµes:</label>
                                        <textarea rows="4" style="width: 100%; padding: 10px; border: 1px solid #f0abfc; border-radius: 6px; margin-top: 4px;" placeholder="EvoluÃ§Ã£o do paciente, cuidados realizados, intercorrÃªncias..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'parecer': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #f5f3ff; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                                <h4 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ‘¨â€âš•ï¸ Parecer Especialista</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                        <div>
                                            <label style="font-size: 12px; color: #666;">Especialidade:</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;" placeholder="Ex: Cardiologia">
                                        </div>
                                        <div>
                                            <label style="font-size: 12px; color: #666;">MÃ©dico/CRM:</label>
                                            <input type="text" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;" placeholder="Nome - CRM">
                                        </div>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Motivo da solicitaÃ§Ã£o:</label>
                                        <textarea rows="2" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;" placeholder="Por que foi solicitado o parecer..."></textarea>
                                    </div>
                                    <div>
                                        <label style="font-size: 12px; color: #666;">Parecer:</label>
                                        <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;" placeholder="AvaliaÃ§Ã£o e recomendaÃ§Ãµes do especialista..."></textarea>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ALIASES PARA IDs ANTIGOS/ALTERNATIVOS - v10.358
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        'h-ginecologica': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fdf2f8; border-radius: 8px; border-left: 4px solid #ec4899;">
                                <h4 style="margin: 0 0 12px 0; color: #be185d; font-size: 14px;">ğŸ‘© HistÃ³ria GinecolÃ³gica</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                                        <div>
                                            <label style="font-size: 11px; color: #666;">Menarca:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="anos">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">DUM:</label>
                                            <input type="date" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">Ciclos:</label>
                                            <input type="text" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="28/5 dias">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">Menopausa:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="anos">
                                        </div>
                                    </div>
                                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px;">
                                        <div>
                                            <label style="font-size: 11px; color: #666;">G:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">P:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">C:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">A:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                        <div>
                                            <label style="font-size: 11px; color: #666;">E:</label>
                                            <input type="number" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;" placeholder="0">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `,
                        
                        'cirurgias-previas': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef3c7; border-radius: 8px; border-left: 4px solid #f59e0b;">
                                <h4 style="margin: 0 0 12px 0; color: #d97706; font-size: 14px;">ğŸ”ª Cirurgias PrÃ©vias</h4>
                                <div id="lista-cirurgias-previas"></div>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 8px;" placeholder="Liste as cirurgias anteriores com ano aproximado...&#10;Ex: Apendicectomia (2015), Colecistectomia (2018)"></textarea>
                            </div>
                        `,
                        
                        'medicacoes': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #dbeafe; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                <h4 style="margin: 0 0 12px 0; color: #1d4ed8; font-size: 14px;">ğŸ’Š MedicaÃ§Ãµes em Uso</h4>
                                <div id="lista-medicacoes-uso"></div>
                                <textarea rows="3" style="width: 100%; padding: 10px; border: 1px solid #93c5fd; border-radius: 6px; margin-top: 8px;" placeholder="Liste as medicaÃ§Ãµes de uso contÃ­nuo...&#10;Ex: Losartana 50mg 1x/dia, Metformina 850mg 2x/dia"></textarea>
                            </div>
                        `,
                        
                        'alergias': `
                            <div class="secao-prontuario" style="margin-bottom: 20px; padding: 16px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #ef4444;">
                                <h4 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸš« Alergias</h4>
                                <div style="display: grid; gap: 12px;">
                                    <div>
                                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                            <input type="checkbox" id="nega-alergias" onchange="document.getElementById('campo-alergias').disabled = this.checked">
                                            <span style="font-size: 13px;">Nega alergias conhecidas</span>
                                        </label>
                                    </div>
                                    <textarea id="campo-alergias" rows="2" style="width: 100%; padding: 10px; border: 1px solid #fca5a5; border-radius: 6px;" placeholder="Liste alergias medicamentosas, alimentares, de contato..."></textarea>
                                </div>
                            </div>
                        `
                    };
                    } else {
                        console.log('âœ… [Sandbox] window.TEMPLATES_MODULOS jÃ¡ foi inicializado anteriormente');
                    }
                    
                    // Renderizar cada elemento na ordem definida no modelo
                    modelo.modulos_prontuario.forEach(codigo => {
                        // TRATAMENTO ESPECIAL: mapa-anatomico (precisa inicializaÃ§Ã£o JS)
                        if (codigo === 'mapa-anatomico') {
                            console.log('ğŸ—ºï¸ [Sandbox] Renderizando Mapa AnatÃ´mico como elemento');
                            html += `
                                <div style="margin-bottom: 24px;">
                                    <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px; padding-bottom: 8px; border-bottom: 1px solid #ddd;">
                                        ğŸ—ºï¸ Mapa AnatÃ´mico Interativo
                                    </h4>
                                    <div id="sandbox-mapa-anatomico-elemento" style="background: #f8fafc; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                        <!-- AnatomiaAtendimento serÃ¡ renderizado aqui -->
                                    </div>
                                </div>
                            `;
                            renderizarMapaAnatomico = true;
                            return; // prÃ³ximo item
                        }
                        
                        // Primeiro: tentar template padrÃ£o
                        if (TEMPLATES_MODULOS[codigo]) {
                            console.log(`âœ… [Sandbox] Renderizando mÃ³dulo padrÃ£o: ${codigo}`);
                            html += TEMPLATES_MODULOS[codigo];
                            return;
                        }
                        
                        // Segundo: tentar elemento customizado do usuÃ¡rio
                        const elemento = elementosDisponiveis.find(e => e.codigo === codigo);
                        if (elemento && elemento.htmlTemplate) {
                            console.log(`âœ… [Sandbox] Renderizando elemento customizado: ${elemento.nome} (${codigo})`);
                            html += elemento.htmlTemplate;
                            return;
                        }
                        
                        // NÃ£o encontrado
                        console.warn(`âš ï¸ [Sandbox] MÃ³dulo nÃ£o encontrado: ${codigo}`);
                    });
                    
                    // Guardar flag para usar apÃ³s inserir HTML
                    window._renderizarMapaAnatomico = renderizarMapaAnatomico;
                    
                    console.log('ğŸ“‹ [Sandbox] Elementos renderizados com sucesso');
                } else {
                    console.log('â„¹ï¸ [Sandbox] Modelo sem mÃ³dulos de prontuÃ¡rio personalizados');
                }

                // EXAME FÃSICO ESPECÃFICO
                // Debug do modelo
                console.log('ğŸ” [Sandbox] Modelo:', modelo.nome);
                console.log('ğŸ” [Sandbox] exame_especifico:', modelo.exame_especifico);
                
                if (modelo.exame_especifico?.tipo === 'iframe' && modelo.exame_especifico?.iframe_url) {
                    // IFRAME EXTERNO
                    html += `
                        <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px; padding-bottom: 8px; border-bottom: 1px solid #ddd;">
                                ğŸ¯ Exame FÃ­sico EspecÃ­fico - ${modelo.especialidade || 'Especializado'}
                            </h4>
                            <iframe src="${modelo.exame_especifico.iframe_url}" 
                                    style="width: 100%; height: ${modelo.exame_especifico.iframe_altura}px; 
                                    border: 1px solid #e0e0e0; border-radius: 8px; background: white;">
                            </iframe>
                        </div>
                    `;
                } else if (modelo.exame_especifico?.tipo === 'corpo') {
                    // CORPO CLICÃVEL (ANATOMIA) - v10.346: Simplificado, nÃ£o exige corpo preenchido
                    html += `
                        <div style="margin-bottom: 24px;">
                            <h4 style="margin: 0 0 12px 0; color: #333; font-size: 15px; padding-bottom: 8px; border-bottom: 1px solid #ddd;">
                                ğŸ‘¤ Exame FÃ­sico EspecÃ­fico - Mapa AnatÃ´mico
                            </h4>
                            <div id="sandbox-container-anatomia" style="background: #f8fafc; padding: 20px; border-radius: 8px; border: 1px solid #e0e0e0; border-left: 4px solid #3b82f6;">
                                <!-- AnatomiaAtendimento serÃ¡ renderizado aqui -->
                            </div>
                        </div>
                    `;
                }
                // v10.382: REMOVIDO - campos fixos (Exame FÃ­sico genÃ©rico, HipÃ³tese DiagnÃ³stica, Conduta)
                // Agora sÃ³ renderiza o que vem dos mÃ³dulos selecionados no modelo

                // Inserir no container
                document.getElementById('sandbox-conteudo').innerHTML = html;

                // Se modelo tem corpo clicÃ¡vel, renderizar apÃ³s inserir HTML
                if (modelo.exame_especifico?.tipo === 'corpo') {
                    setTimeout(() => {
                        const config = modelo.exame_especifico?.corpo || {
                            visualizacao: 'frente',
                            template: '',
                            permitirEdicao: true
                        };
                        AnatomiaAtendimento.renderizar('sandbox-container-anatomia', config);
                        console.log('ğŸ‘¤ [Sandbox] Mapa anatÃ´mico renderizado com config:', config);
                    }, 100);
                }
                
                // v10.354: Se mapa anatÃ´mico foi adicionado como elemento, inicializar
                if (window._renderizarMapaAnatomico) {
                    setTimeout(() => {
                        const container = document.getElementById('sandbox-mapa-anatomico-elemento');
                        if (container) {
                            console.log('ğŸ—ºï¸ [Sandbox] Inicializando Mapa AnatÃ´mico (elemento)...');
                            AnatomiaAtendimento.renderizar('sandbox-mapa-anatomico-elemento', {
                                visualizacao: 'frente',
                                template: '',
                                permitirEdicao: true
                            });
                            console.log('âœ… [Sandbox] Mapa AnatÃ´mico (elemento) renderizado!');
                        }
                        window._renderizarMapaAnatomico = false; // Reset flag
                    }, 150);
                }
            },

            renderizarFolhaRosto() {
                // v10.346: Usar layouts de cabeÃ§alho salvos
                document.getElementById('sandbox-doc-titulo').textContent = 'VISUALIZAÃ‡ÃƒO DE CABEÃ‡ALHO';
                
                // Verificar se hÃ¡ layout selecionado
                const selectCab = document.getElementById('sandbox-layout-cabecalho');
                const layoutId = selectCab?.value;
                
                if (!layoutId) {
                    document.getElementById('sandbox-conteudo').innerHTML = `
                        <div style="text-align: center; padding: 40px; background: #f9fafb; border: 1px dashed #ddd; border-radius: 8px;">
                            <div style="font-size: 48px; margin-bottom: 12px;">ğŸ‘†</div>
                            <p style="color: #92400e; font-weight: 600; margin-bottom: 8px;">Selecione um Layout de CabeÃ§alho</p>
                            <p style="font-size: 12px; color: #a16207;">
                                Use o seletor "ğŸ¨ Layout de CabeÃ§alho" acima para visualizar seus layouts salvos.
                            </p>
                        </div>
                    `;
                } else {
                    // Mostrar info do layout selecionado
                    const layouts = SistemaCore.dados.cabecalhos || [];
                    const layout = layouts.find(l => l.id == layoutId);
                    
                    if (layout) {
                        document.getElementById('sandbox-conteudo').innerHTML = `
                            <div style="text-align: center; padding: 30px; background: #f9fafb; border: 1px solid #ddd; border-radius: 8px;">
                                <div style="font-size: 32px; margin-bottom: 12px;">âœ…</div>
                                <p style="color: #166534; font-weight: 600; margin-bottom: 8px;">
                                    Layout "${layout.nome}" carregado!
                                </p>
                                <p style="font-size: 12px; color: #15803d; margin-bottom: 16px;">
                                    Tipo: ${layout.tipoBase} â€¢ ${layout.camposEstab?.length || 0} campos do estabelecimento â€¢ ${layout.camposPaciente?.length || 0} campos do paciente
                                </p>
                                <p style="font-size: 11px; color: #64748b;">
                                    O cabeÃ§alho estÃ¡ sendo exibido acima â†‘
                                </p>
                            </div>
                        `;
                    }
                }
            },

            renderizarTemplate(templateId) {
                // Manter comportamento existente para templates
                document.getElementById('sandbox-doc-titulo').textContent = 'TEMPLATE';
                document.getElementById('sandbox-conteudo').innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <p>ğŸ“„ Preview do Template</p>
                        <p style="font-size: 12px; margin-top: 8px;">Funcionalidade existente mantida</p>
                    </div>
                `;
            },

            limpar() {
                // Limpar todos os campos do formulÃ¡rio
                const inputs = document.querySelectorAll('#sandbox-conteudo input, #sandbox-conteudo textarea');
                inputs.forEach(input => {
                    if (!input.readOnly) {
                        input.value = '';
                    }
                });
                
                // Limpar mapa anatÃ´mico se existir
                if (AnatomiaAtendimento.instancias && AnatomiaAtendimento.instancias['sandbox-container-anatomia']) {
                    AnatomiaAtendimento.instancias['sandbox-container-anatomia'].regioes = [];
                    AnatomiaAtendimento.redesenhar('sandbox-container-anatomia');
                    AnatomiaAtendimento.atualizarLista('sandbox-container-anatomia');
                }
                
                Sistema.notificar('âœ… Campos limpos', 'sucesso');
            },

            salvarAtendimento() {
                // Verificar se tem modelo selecionado
                const selectTipo = document.getElementById('sandbox-tipo-doc');
                const valor = selectTipo.value;
                
                if (!valor || !valor.startsWith('modelo-')) {
                    Sistema.notificar('âŒ Selecione um modelo de atendimento!', 'erro');
                    return;
                }
                
                const modeloId = parseInt(valor.replace('modelo-', ''));
                const modelo = SistemaCore.dados.modelos_atendimento?.find(m => m.id === modeloId);
                
                if (!modelo) {
                    Sistema.notificar('âŒ Modelo nÃ£o encontrado!', 'erro');
                    return;
                }
                
                // COLETAR DADOS DO FORMULÃRIO
                const atendimento = {
                    id: Date.now(),
                    modelo_id: modeloId,
                    modelo_nome: modelo.nome,
                    modelo_tipo: modelo.tipo,
                    paciente: {
                        nome: 'JoÃ£o da Silva Teste',
                        prontuario: document.getElementById('sandbox-prontuario').textContent
                    },
                    data_atendimento: document.querySelectorAll('#sandbox-conteudo input[type="date"]')[0]?.value || new Date().toISOString().split('T')[0],
                    hora_inicio: document.querySelectorAll('#sandbox-conteudo input[type="time"]')[0]?.value || new Date().toTimeString().slice(0,5),
                    duracao: document.querySelectorAll('#sandbox-conteudo input[value*=":"]')[0]?.value || '0:00',
                    
                    anamnese: {
                        queixa_principal: '',
                        hda: ''
                    },
                    
                    exame_fisico: {
                        sinais_vitais: {},
                        antropometria: {},
                        escalas: {},
                        anatomia: null,
                        descricao: '',
                        // Novos mÃ³dulos do Exame EspecÃ­fico
                        exame_especifico: {
                            modulos_ativos: [],
                            mapeamento: {},      // map-lesoes, map-queimaduras, etc
                            sistemas: {},        // sis-cardiovascular, etc
                            especialidades: {}   // esp-ortopedia, etc
                        }
                    },
                    
                    hipotese_diagnostica: {
                        cid10: '',
                        descricao: ''
                    },
                    
                    conduta: '',
                    
                    criado_em: new Date().toISOString()
                };
                
                // COLETAR ANAMNESE
                const textareas = document.querySelectorAll('#sandbox-conteudo textarea');
                if (textareas.length >= 2) {
                    atendimento.anamnese.queixa_principal = textareas[0].value;
                    atendimento.anamnese.hda = textareas[1].value;
                }
                
                // COLETAR SINAIS VITAIS
                if (modelo.sinais_vitais && modelo.sinais_vitais.length > 0) {
                    const inputsSinais = document.querySelectorAll('#sandbox-conteudo input[type="text"]');
                    let idx = 0;
                    modelo.sinais_vitais.forEach(sinal => {
                        if (inputsSinais[idx]) {
                            atendimento.exame_fisico.sinais_vitais[sinal] = inputsSinais[idx].value;
                            idx++;
                        }
                    });
                }
                
                // COLETAR ANTROPOMETRIA
                if (modelo.antropometria && modelo.antropometria.length > 0) {
                    modelo.antropometria.forEach(campo => {
                        const input = Array.from(document.querySelectorAll('#sandbox-conteudo input')).find(
                            el => el.placeholder && el.placeholder.includes(campo === 'peso' ? 'kg' : campo === 'altura' ? 'cm' : 'IMC')
                        );
                        if (input) {
                            atendimento.exame_fisico.antropometria[campo] = input.value;
                        }
                    });
                }
                
                // COLETAR ESCALAS
                if (modelo.escalas && modelo.escalas.length > 0) {
                    modelo.escalas.forEach(escala => {
                        const input = Array.from(document.querySelectorAll('#sandbox-conteudo input')).find(
                            el => el.placeholder && el.placeholder.includes('PontuaÃ§Ã£o')
                        );
                        if (input) {
                            atendimento.exame_fisico.escalas[escala] = input.value;
                        }
                    });
                }
                
                // COLETAR MAPA ANATÃ”MICO (se tiver)
                if (modelo.exame_especifico?.tipo === 'corpo') {
                    // Validar se obrigatÃ³rio
                    const validacao = AnatomiaAtendimento.validar('sandbox-container-anatomia');
                    if (!validacao.valido) {
                        Sistema.notificar(`âŒ ${validacao.mensagem}`, 'erro');
                        return;
                    }
                    
                    // Obter regiÃµes marcadas
                    const dadosAnatomia = AnatomiaAtendimento.obterDados('sandbox-container-anatomia');
                    atendimento.exame_fisico.anatomia = dadosAnatomia;
                    console.log('ğŸ“ Dados anatÃ´micos coletados:', JSON.stringify(dadosAnatomia, null, 2));
                    console.log('ğŸ“ Total regiÃµes:', dadosAnatomia?.regioesMarcadas?.length || 0);
                } else {
                    // Coletar descriÃ§Ã£o do exame fÃ­sico especÃ­fico
                    const textareaExame = Array.from(textareas).find(ta => ta.placeholder && ta.placeholder.includes('exame fÃ­sico especÃ­fico'));
                    if (textareaExame) {
                        atendimento.exame_fisico.descricao = textareaExame.value;
                    }
                }
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // COLETAR MÃ“DULOS DO EXAME ESPECÃFICO (Mapeamento, Sistemas, Esp.)
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                if (typeof ProntuarioModular !== 'undefined' && ProntuarioModular.modulosExameAtivos.length > 0) {
                    atendimento.exame_fisico.exame_especifico.modulos_ativos = [...ProntuarioModular.modulosExameAtivos];
                    
                    // Coletar MAPEAMENTO CORPORAL
                    if (ProntuarioModular.modulosExameAtivos.includes('map-lesoes')) {
                        const dados = AnatomiaAtendimento.obterDados('pront-container-map-lesoes');
                        const desc = document.getElementById('pront-map-lesoes-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.mapeamento['lesoes'] = { regioes: dados, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('map-queimaduras')) {
                        const dados = AnatomiaAtendimento.obterDados('pront-container-map-queimaduras');
                        const desc = document.getElementById('pront-map-queimaduras-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.mapeamento['queimaduras'] = { regioes: dados, descricao: desc };
                    }
                    // map-feridas DEPRECIADO v10.357 - Feridas registradas como achados no "Exame por RegiÃµes"
                    
                    // Coletar SISTEMAS ORGÃ‚NICOS
                    if (ProntuarioModular.modulosExameAtivos.includes('sis-cardiovascular')) {
                        const fc = document.getElementById('pront-sis-cardio-fc')?.value || '';
                        const ritmo = document.getElementById('pront-sis-cardio-ritmo')?.value || '';
                        const bulhas = document.getElementById('pront-sis-cardio-bulhas')?.value || '';
                        const sopros = document.getElementById('pront-sis-cardio-sopros')?.value || '';
                        const pulsos = document.getElementById('pront-sis-cardio-pulsos')?.value || '';
                        const desc = document.getElementById('pront-sis-cardio-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.sistemas['cardiovascular'] = { fc, ritmo, bulhas, sopros, pulsos, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('sis-respiratorio')) {
                        const fr = document.getElementById('pront-sis-resp-fr')?.value || '';
                        const padrao = document.getElementById('pront-sis-resp-padrao')?.value || '';
                        const mv = document.getElementById('pront-sis-resp-mv')?.value || '';
                        const ra = document.getElementById('pront-sis-resp-ra')?.value || '';
                        const desc = document.getElementById('pront-sis-resp-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.sistemas['respiratorio'] = { fr, padrao, mv, ra, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('sis-nervoso')) {
                        const glasgow = document.getElementById('pront-sis-neuro-glasgow')?.value || '';
                        const pupilas = document.getElementById('pront-sis-neuro-pupilas')?.value || '';
                        const motor = document.getElementById('pront-sis-neuro-motor')?.value || '';
                        const sensib = document.getElementById('pront-sis-neuro-sensibilidade')?.value || '';
                        const desc = document.getElementById('pront-sis-neuro-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.sistemas['nervoso'] = { glasgow, pupilas, motor, sensibilidade: sensib, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('sis-digestorio')) {
                        const abdome = document.getElementById('pront-sis-dig-abdome')?.value || '';
                        const rha = document.getElementById('pront-sis-dig-rha')?.value || '';
                        const dor = document.getElementById('pront-sis-dig-dor')?.value || '';
                        const massas = document.getElementById('pront-sis-dig-massas')?.value || '';
                        const desc = document.getElementById('pront-sis-dig-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.sistemas['digestorio'] = { abdome, rha, dor, massas, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('sis-tegumentar')) {
                        const pele = document.getElementById('pront-sis-teg-pele')?.value || '';
                        const cor = document.getElementById('pront-sis-teg-cor')?.value || '';
                        const turgor = document.getElementById('pront-sis-teg-turgor')?.value || '';
                        const lesoes = document.getElementById('pront-sis-teg-lesoes')?.value || '';
                        const desc = document.getElementById('pront-sis-teg-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.sistemas['tegumentar'] = { pele, cor, turgor, lesoes, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('sis-vascular')) {
                        const pulsos = document.getElementById('pront-sis-vasc-pulsos')?.value || '';
                        const perfusao = document.getElementById('pront-sis-vasc-perfusao')?.value || '';
                        const edema = document.getElementById('pront-sis-vasc-edema')?.value || '';
                        const varizes = document.getElementById('pront-sis-vasc-varizes')?.value || '';
                        const desc = document.getElementById('pront-sis-vasc-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.sistemas['vascular'] = { pulsos, perfusao, edema, varizes, descricao: desc };
                    }
                    
                    // Coletar ESPECIALIDADES
                    if (ProntuarioModular.modulosExameAtivos.includes('esp-ortopedia')) {
                        const articulacao = document.getElementById('pront-esp-orto-articulacao')?.value || '';
                        const adm = document.getElementById('pront-esp-orto-adm')?.value || '';
                        const forca = document.getElementById('pront-esp-orto-forca')?.value || '';
                        const testes = document.getElementById('pront-esp-orto-testes')?.value || '';
                        const desc = document.getElementById('pront-esp-orto-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.especialidades['ortopedia'] = { articulacao, adm, forca, testes, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('esp-oftalmologia')) {
                        const av = document.getElementById('pront-esp-oftalmo-av')?.value || '';
                        const pupilas = document.getElementById('pront-esp-oftalmo-pupilas')?.value || '';
                        const mov = document.getElementById('pront-esp-oftalmo-mov')?.value || '';
                        const fundoscopia = document.getElementById('pront-esp-oftalmo-fundoscopia')?.value || '';
                        const desc = document.getElementById('pront-esp-oftalmo-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.especialidades['oftalmologia'] = { av, pupilas, mov, fundoscopia, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('esp-otorrinolaringologia')) {
                        const ouvido = document.getElementById('pront-esp-orl-ouvido')?.value || '';
                        const nariz = document.getElementById('pront-esp-orl-nariz')?.value || '';
                        const garganta = document.getElementById('pront-esp-orl-garganta')?.value || '';
                        const desc = document.getElementById('pront-esp-orl-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.especialidades['otorrino'] = { ouvido, nariz, garganta, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('esp-bucomaxilofacial')) {
                        const atm = document.getElementById('pront-esp-buco-atm')?.value || '';
                        const denticao = document.getElementById('pront-esp-buco-denticao')?.value || '';
                        const oclusao = document.getElementById('pront-esp-buco-oclusao')?.value || '';
                        const desc = document.getElementById('pront-esp-buco-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.especialidades['bucomaxilofacial'] = { atm, denticao, oclusao, descricao: desc };
                    }
                    if (ProntuarioModular.modulosExameAtivos.includes('esp-cirurgia-vascular')) {
                        const pulsos = document.getElementById('pront-esp-cvasc-pulsos')?.value || '';
                        const itb = document.getElementById('pront-esp-cvasc-itb')?.value || '';
                        const varizes = document.getElementById('pront-esp-cvasc-varizes')?.value || '';
                        const ulceras = document.getElementById('pront-esp-cvasc-ulceras')?.value || '';
                        const desc = document.getElementById('pront-esp-cvasc-desc')?.value || '';
                        atendimento.exame_fisico.exame_especifico.especialidades['cirurgia_vascular'] = { pulsos, itb, varizes, ulceras, descricao: desc };
                    }
                    
                    console.log('ğŸ“‹ MÃ³dulos de exame especÃ­fico coletados:', atendimento.exame_fisico.exame_especifico.modulos_ativos);
                }
                
                // COLETAR HIPÃ“TESE DIAGNÃ“STICA
                const inputCID = Array.from(document.querySelectorAll('#sandbox-conteudo input')).find(
                    el => el.placeholder && el.placeholder.includes('CID')
                );
                if (inputCID) {
                    atendimento.hipotese_diagnostica.cid10 = inputCID.value;
                }
                
                const textareaDiag = Array.from(textareas).find(ta => ta.placeholder && ta.placeholder.includes('hipÃ³tese diagnÃ³stica'));
                if (textareaDiag) {
                    atendimento.hipotese_diagnostica.descricao = textareaDiag.value;
                }
                
                // COLETAR CONDUTA
                const textareaConduta = Array.from(textareas).find(ta => ta.placeholder && ta.placeholder.includes('conduta'));
                if (textareaConduta) {
                    atendimento.conduta = textareaConduta.value;
                }
                
                // VALIDAÃ‡Ã•ES BÃSICAS
                if (!atendimento.anamnese.queixa_principal && !atendimento.anamnese.hda) {
                    if (!confirm('Anamnese estÃ¡ vazia. Deseja salvar mesmo assim?')) {
                        return;
                    }
                }
                
                // INICIALIZAR ARRAY SE NÃƒO EXISTIR
                if (!SistemaCore.dados.atendimentos) {
                    SistemaCore.dados.atendimentos = [];
                }
                
                // SALVAR
                SistemaCore.dados.atendimentos.push(atendimento);
                SistemaCore.salvar();
                
                console.log('ğŸ’¾ Atendimento salvo:', atendimento);
                
                Sistema.notificar('âœ… Atendimento salvo com sucesso!', 'sucesso');
                
                // Limpar formulÃ¡rio
                setTimeout(() => {
                    this.limpar();
                }, 500);
            },
            
            verAtendimentosSalvos() {
                // Esconder formulÃ¡rio
                document.getElementById('sandbox-preview-area').style.display = 'none';
                document.getElementById('sandbox-mensagem-inicial').style.display = 'none';
                
                // Mostrar lista
                document.getElementById('sandbox-lista-atendimentos').style.display = 'block';
                
                // Renderizar lista
                this.renderizarListaAtendimentos();
            },
            
            voltarParaFormulario() {
                // Esconder lista
                document.getElementById('sandbox-lista-atendimentos').style.display = 'none';
                
                // Mostrar formulÃ¡rio ou mensagem inicial
                const select = document.getElementById('sandbox-tipo-doc');
                if (select.value) {
                    document.getElementById('sandbox-preview-area').style.display = 'block';
                } else {
                    document.getElementById('sandbox-mensagem-inicial').style.display = 'block';
                }
            },
            
            renderizarListaAtendimentos() {
                const container = document.getElementById('sandbox-atendimentos-container');
                const atendimentos = SistemaCore.dados.atendimentos || [];
                
                if (atendimentos.length === 0) {
                    container.innerHTML = `
                        <div style="background: white; padding: 40px; border-radius: 8px; border: 1px dashed #ddd; text-align: center;">
                            <div style="font-size: 64px; margin-bottom: 16px;">ğŸ“‹</div>
                            <h3 style="color: var(--text-light); margin-bottom: 12px;">Nenhum atendimento salvo</h3>
                            <p style="color: var(--text-light);">
                                Crie um atendimento no formulÃ¡rio acima e salve para vÃª-lo aqui.
                            </p>
                        </div>
                    `;
                    return;
                }
                
                // Ordenar por data (mais recente primeiro)
                const atendimentosOrdenados = [...atendimentos].sort((a, b) => b.id - a.id);
                
                let html = `
                    <div style="margin-bottom: 20px; padding: 16px; background: #f9fafb; border-radius: 8px; border-left: 4px solid #3b82f6;">
                        <strong>ğŸ“Š Total de atendimentos salvos:</strong> ${atendimentos.length}
                    </div>
                `;
                
                atendimentosOrdenados.forEach(atend => {
                    const icones = {
                        'consulta': 'ğŸ©º',
                        'emergencia': 'ğŸš¨',
                        'cirurgia': 'âš•ï¸',
                        'internacao': 'ğŸ›ï¸',
                        'exame': 'ğŸ”¬',
                        'procedimento': 'ğŸ¥'
                    };
                    
                    const icone = icones[atend.modelo_tipo] || 'ğŸ“‹';
                    const dataFormatada = new Date(atend.criado_em).toLocaleString('pt-BR');
                    
                    // Verificar se tem mapa anatÃ´mico
                    const temAnatomia = atend.exame_fisico?.anatomia && atend.exame_fisico.anatomia.length > 0;
                    
                    html += `
                        <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin-bottom: 16px;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;">
                                <div>
                                    <h4 style="margin: 0 0 8px 0; color: var(--primary); font-size: 16px;">
                                        ${icone} ${atend.modelo_nome}
                                    </h4>
                                    <div style="font-size: 13px; color: #666;">
                                        <div><strong>Paciente:</strong> ${atend.paciente.nome}</div>
                                        <div><strong>ProntuÃ¡rio:</strong> ${atend.paciente.prontuario}</div>
                                        <div><strong>Data/Hora:</strong> ${atend.data_atendimento} Ã s ${atend.hora_inicio}</div>
                                        <div><strong>Salvo em:</strong> ${dataFormatada}</div>
                                    </div>
                                </div>
                                <div style="display: flex; gap: 8px;">
                                    ${temAnatomia ? '<span style="background: #10b981; color: white; padding: 6px 12px; border-radius: 4px; font-size: 11px; font-weight: bold;">ğŸ‘¤ MAPA ANATÃ”MICO</span>' : ''}
                                    <button class="btn btn-primary" onclick="Sandbox.visualizarAtendimento(${atend.id})" style="padding: 8px 16px; font-size: 13px;">
                                        ğŸ‘ï¸ Ver
                                    </button>
                                    <button class="btn btn-danger" onclick="Sandbox.excluirAtendimento(${atend.id})" style="padding: 8px 16px; font-size: 13px;">
                                        ğŸ—‘ï¸
                                    </button>
                                </div>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border);">
                                <div style="font-size: 12px;">
                                    <strong>Queixa Principal:</strong><br>
                                    ${atend.anamnese.queixa_principal ? atend.anamnese.queixa_principal.substring(0, 80) + (atend.anamnese.queixa_principal.length > 80 ? '...' : '') : '<em style="color: #999;">NÃ£o informado</em>'}
                                </div>
                                <div style="font-size: 12px;">
                                    <strong>CID-10:</strong><br>
                                    ${atend.hipotese_diagnostica.cid10 || '<em style="color: #999;">NÃ£o informado</em>'}
                                </div>
                            </div>
                            
                            ${temAnatomia ? `
                                <div style="margin-top: 12px; padding: 12px; background: #f9fafb; border-radius: 4px; border-left: 4px solid #3b82f6;">
                                    <strong style="font-size: 12px; color: #166534;">ğŸ“ RegiÃµes AnatÃ´micas Marcadas: ${atend.exame_fisico.anatomia.length}</strong>
                                    <div style="font-size: 11px; color: #666; margin-top: 4px;">
                                        ${atend.exame_fisico.anatomia.slice(0, 3).map(r => r.nome).join(', ')}
                                        ${atend.exame_fisico.anatomia.length > 3 ? ` e mais ${atend.exame_fisico.anatomia.length - 3}...` : ''}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },
            
            visualizarAtendimento(id) {
                const atendimento = SistemaCore.dados.atendimentos?.find(a => a.id === id);
                if (!atendimento) {
                    Sistema.notificar('âŒ Atendimento nÃ£o encontrado!', 'erro');
                    return;
                }
                
                // Criar modal de visualizaÃ§Ã£o
                const modal = document.createElement('div');
                modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center; padding: 20px;';
                
                const temAnatomia = atendimento.exame_fisico?.anatomia && atendimento.exame_fisico.anatomia.length > 0;
                
                modal.innerHTML = `
                    <div style="background: white; border-radius: 12px; max-width: 900px; width: 100%; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        <div style="padding: 24px; border-bottom: 2px solid var(--border); display: flex; justify-content: space-between; align-items: center; background: var(--primary); color: white;">
                            <h3 style="margin: 0;">${atendimento.modelo_nome}</h3>
                            <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="background: white; color: var(--primary); border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: bold;">
                                âœ• Fechar
                            </button>
                        </div>
                        
                        <div style="padding: 24px;">
                            <!-- DADOS DO PACIENTE -->
                            <div style="background: #f8fafc; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                                <h4 style="margin: 0 0 12px 0; color: #333;">Dados do Paciente</h4>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; font-size: 13px;">
                                    <div><strong>Nome:</strong> ${atendimento.paciente.nome}</div>
                                    <div><strong>ProntuÃ¡rio:</strong> ${atendimento.paciente.prontuario}</div>
                                    <div><strong>Data:</strong> ${atendimento.data_atendimento}</div>
                                </div>
                            </div>
                            
                            <!-- ANAMNESE -->
                            <div style="margin-bottom: 20px;">
                                <h4 style="margin: 0 0 12px 0; color: #333; border-bottom: 1px solid #ddd; padding-bottom: 8px;">Anamnese</h4>
                                <div style="margin-bottom: 12px;">
                                    <strong style="font-size: 13px;">Queixa Principal:</strong>
                                    <p style="margin: 4px 0 0 0; font-size: 13px; color: #333;">${atendimento.anamnese.queixa_principal || '<em style="color: #999;">NÃ£o informado</em>'}</p>
                                </div>
                                <div>
                                    <strong style="font-size: 13px;">HDA:</strong>
                                    <p style="margin: 4px 0 0 0; font-size: 13px; color: #333; white-space: pre-wrap;">${atendimento.anamnese.hda || '<em style="color: #999;">NÃ£o informado</em>'}</p>
                                </div>
                            </div>
                            
                            <!-- EXAME FÃSICO -->
                            <div style="margin-bottom: 20px;">
                                <h4 style="margin: 0 0 12px 0; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">Exame FÃ­sico</h4>
                                
                                ${Object.keys(atendimento.exame_fisico.sinais_vitais || {}).length > 0 ? `
                                    <div style="margin-bottom: 12px;">
                                        <strong style="font-size: 13px;">Sinais Vitais:</strong>
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 8px; font-size: 12px;">
                                            ${Object.entries(atendimento.exame_fisico.sinais_vitais).map(([chave, valor]) => 
                                                valor ? `<div><strong>${chave.toUpperCase()}:</strong> ${valor}</div>` : ''
                                            ).join('')}
                                        </div>
                                    </div>
                                ` : ''}
                                
                                ${temAnatomia ? `
                                    <div style="margin-top: 16px; padding: 16px; background: #f9fafb; border-radius: 8px; border: 1px solid #ddd;">
                                        <h5 style="margin: 0 0 12px 0; color: #166534;">ğŸ‘¤ Mapa AnatÃ´mico (${atendimento.exame_fisico.anatomia.length} regiÃµes)</h5>
                                        <div id="modal-anatomia-preview-${id}" style="background: white; padding: 16px; border-radius: 6px;"></div>
                                    </div>
                                ` : ''}
                                
                                ${atendimento.exame_fisico.descricao ? `
                                    <div style="margin-top: 12px;">
                                        <strong style="font-size: 13px;">DescriÃ§Ã£o:</strong>
                                        <p style="margin: 4px 0 0 0; font-size: 13px; color: #333; white-space: pre-wrap;">${atendimento.exame_fisico.descricao}</p>
                                    </div>
                                ` : ''}
                            </div>
                            
                            <!-- DIAGNÃ“STICO -->
                            <div style="margin-bottom: 20px;">
                                <h4 style="margin: 0 0 12px 0; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">HipÃ³tese DiagnÃ³stica</h4>
                                <div style="margin-bottom: 8px;">
                                    <strong style="font-size: 13px;">CID-10:</strong> ${atendimento.hipotese_diagnostica.cid10 || '<em style="color: #999;">NÃ£o informado</em>'}
                                </div>
                                <div>
                                    <strong style="font-size: 13px;">DescriÃ§Ã£o:</strong>
                                    <p style="margin: 4px 0 0 0; font-size: 13px; color: #333; white-space: pre-wrap;">${atendimento.hipotese_diagnostica.descricao || '<em style="color: #999;">NÃ£o informado</em>'}</p>
                                </div>
                            </div>
                            
                            <!-- CONDUTA -->
                            <div>
                                <h4 style="margin: 0 0 12px 0; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 8px;">Conduta</h4>
                                <p style="margin: 0; font-size: 13px; color: #333; white-space: pre-wrap;">${atendimento.conduta || '<em style="color: #999;">NÃ£o informado</em>'}</p>
                            </div>
                            
                            <!-- v10.463: FOTOS -->
                            ${atendimento.fotos && atendimento.fotos.length > 0 ? `
                                <div style="margin-top: 20px;">
                                    <h4 style="margin: 0 0 12px 0; color: #a16207; border-bottom: 2px solid #eab308; padding-bottom: 8px;">ğŸ“· Fotos do Atendimento (${atendimento.fotos.length})</h4>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 12px;">
                                        ${atendimento.fotos.map((f, i) => `
                                            <div style="position: relative; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden;">
                                                <img src="${f.base64}" style="width: 100%; height: 100px; object-fit: cover; cursor: pointer;" 
                                                     onclick="window.open('${f.base64}', '_blank')" title="Clique para ampliar">
                                                ${f.editada ? '<span style="position: absolute; top: 4px; left: 4px; background: #3b82f6; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">âœï¸ Editada</span>' : ''}
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // Renderizar mapa anatÃ´mico se existir
                if (temAnatomia) {
                    setTimeout(() => {
                        const previewContainer = document.getElementById(`modal-anatomia-preview-${id}`);
                        if (previewContainer) {
                            // Criar SVG simplificado para visualizaÃ§Ã£o
                            let svgHtml = `
                                <svg viewBox="0 0 700 1200" style="width: 100%; max-width: 400px; height: auto; border: 1px solid #e0e0e0; border-radius: 8px; display: block; margin: 0 auto;">
                                    <image x="0" y="0" width="700" height="1200" href="data:image/jpeg;base64,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" preserveAspectRatio="xMidYMid meet" />
                                    <g>
                            `;
                            
                            atendimento.exame_fisico.anatomia.forEach(regiao => {
                                // âœ… AJUSTAR Y: subtrair 290 para alinhar com viewBox da silhueta
                                const pontos = regiao.pontos.map(p => `${p[0]},${p[1] - 290}`).join(' ');
                                svgHtml += `
                                    <polygon points="${pontos}" fill="${regiao.cor}" fill-opacity="0.3" stroke="${regiao.cor}" stroke-width="2" />
                                `;
                            });
                            
                            svgHtml += `
                                    </g>
                                </svg>
                                <div style="margin-top: 12px;">
                                    <strong style="font-size: 12px; color: #166534;">RegiÃµes marcadas:</strong>
                                    <ul style="margin: 8px 0 0 0; padding-left: 20px; font-size: 12px; color: #333;">
                                        ${atendimento.exame_fisico.anatomia.map(r => `
                                            <li style="margin-bottom: 4px;">
                                                <span style="display: inline-block; width: 12px; height: 12px; background: ${r.cor}; border-radius: 2px; margin-right: 6px;"></span>
                                                ${r.nome}
                                            </li>
                                        `).join('')}
                                    </ul>
                                </div>
                            `;
                            
                            previewContainer.innerHTML = svgHtml;
                        }
                    }, 100);
                }
            },
            
            excluirAtendimento(id) {
                if (!confirm('âš ï¸ Tem certeza que deseja excluir este atendimento?\n\nEsta aÃ§Ã£o nÃ£o pode ser desfeita!')) {
                    return;
                }
                
                const index = SistemaCore.dados.atendimentos?.findIndex(a => a.id === id);
                if (index !== -1) {
                    SistemaCore.dados.atendimentos.splice(index, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… Atendimento excluÃ­do!', 'sucesso');
                    this.renderizarListaAtendimentos();
                } else {
                    Sistema.notificar('âŒ Atendimento nÃ£o encontrado!', 'erro');
                }
            },
            
            // v10.440: COPIAR FUNÃ‡Ã•ES DO CABECALHOS PARA SANDBOX TAMBÃ‰M!
            // (Sandbox tem sua prÃ³pria cÃ³pia de renderizarCabecalhoLayout)
            
            lerAlergiasDaTela() {
                try {
                    const alergias = [];
                    
                    // Procurar cards de alergias no prontuÃ¡rio
                    const cards = document.querySelectorAll('[id^="pront-alergia-"]');
                    
                    cards.forEach(card => {
                        // Pegar select dentro do card
                        const select = card.querySelector('select[id^="pront-select-alergia-"]');
                        if (select && select.value) {
                            alergias.push(select.value);
                        }
                    });
                    
                    if (alergias.length > 0) {
                        console.log('âœ… [v10.440 Sandbox] Alergias lidas da TELA:', alergias.join(', '));
                        return alergias.join(', ');
                    }
                    
                    return '';
                } catch (e) {
                    console.warn('[v10.440 Sandbox] Erro ao ler alergias da tela:', e);
                    return '';
                }
            },
            
            buscarAlergiasPaciente(pac) {
                try {
                    // v10.440: PRIORIDADE 1 - Alergias digitadas AGORA na tela!
                    const alergiasTelaAtual = this.lerAlergiasDaTela();
                    if (alergiasTelaAtual) {
                        console.log('âœ… [v10.440 Sandbox] Alergias encontradas na TELA ATUAL (tempo real)');
                        return alergiasTelaAtual;
                    }
                    
                    // 2. Buscar no atendimento ATUAL salvo (se houver)
                    const atendimentoAtual = SistemaCore.dados.atendimentos?.find(a => 
                        a.paciente?.prontuario === pac.prontuario && 
                        a.status !== 'finalizado'
                    );
                    if (atendimentoAtual?.anamnese?.hpp?.alergias) {
                        console.log('âœ… [Sandbox] Alergias encontradas no atendimento atual salvo');
                        return atendimentoAtual.anamnese.hpp.alergias;
                    }
                    
                    // 3. Buscar no ÃšLTIMO atendimento finalizado do paciente
                    const atendimentos = SistemaCore.dados.atendimentos?.filter(a => 
                        a.paciente?.prontuario === pac.prontuario
                    ).sort((a, b) => new Date(b.criado_em || 0) - new Date(a.criado_em || 0)) || [];
                    
                    for (const at of atendimentos) {
                        // HPP com alergias
                        if (at.anamnese?.hpp?.alergias) {
                            console.log('âœ… [Sandbox] Alergias encontradas em atendimento anterior (HPP)');
                            return at.anamnese.hpp.alergias;
                        }
                        // Campo alergias direto
                        if (at.alergias) {
                            console.log('âœ… [Sandbox] Alergias encontradas em atendimento anterior');
                            return at.alergias;
                        }
                    }
                    
                    console.log('â„¹ï¸ [Sandbox] Nenhuma alergia registrada em avaliaÃ§Ãµes clÃ­nicas');
                    return '';
                } catch (e) {
                    console.warn('[Sandbox] Erro ao buscar alergias:', e);
                    return '';
                }
            },
            
            mergeAlergias(alergiasCadastro, alergiasHPP) {
                // Se uma fonte estiver vazia, retorna a outra
                if (!alergiasCadastro && !alergiasHPP) return '';
                if (!alergiasCadastro) return alergiasHPP;
                if (!alergiasHPP) return alergiasCadastro;
                
                // Separar por vÃ­rgula e limpar espaÃ§os
                const listaCadastro = alergiasCadastro.split(',').map(a => a.trim().toLowerCase()).filter(a => a);
                const listaHPP = alergiasHPP.split(',').map(a => a.trim().toLowerCase()).filter(a => a);
                
                // Criar Set para remover duplicatas (case-insensitive)
                const setAlergias = new Set([...listaCadastro, ...listaHPP]);
                
                // Converter de volta para array e capitalizar primeira letra
                const merged = Array.from(setAlergias).map(a => 
                    a.charAt(0).toUpperCase() + a.slice(1)
                );
                
                // Retornar string separada por vÃ­rgula
                return merged.join(', ');
            },
            
            // v10.442: ATUALIZAR CABEÃ‡ALHO DO SANDBOX (tempo real!)
            atualizarCabecalho() {
                console.log('');
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                console.log('ğŸ”„ [v10.442] Sandbox.atualizarCabecalho() CHAMADO!');
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                
                try {
                    // 1. Verificar modelo atual
                    console.log('ğŸ“‹ [1/6] Verificando modeloAtualId:', this.modeloAtualId);
                    if (!this.modeloAtualId) {
                        console.warn('âŒ [FALHOU] Nenhum modelo sendo visualizado!');
                        return;
                    }
                    console.log('âœ… [1/6] Modelo atual ID:', this.modeloAtualId);
                    
                    // 2. Buscar modelo
                    console.log('ğŸ“‹ [2/6] Buscando modelo...');
                    const modelo = SistemaCore.dados.modelos_atendimento?.find(m => m.id === this.modeloAtualId);
                    if (!modelo) {
                        console.warn('âŒ [FALHOU] Modelo nÃ£o encontrado!');
                        return;
                    }
                    console.log('âœ… [2/6] Modelo encontrado:', modelo.nome);
                    console.log('   - cabecalho_id:', modelo.cabecalho_id);
                    
                    // 3. Verificar cabeÃ§alho
                    if (!modelo.cabecalho_id) {
                        console.warn('âŒ [FALHOU] Modelo sem cabeÃ§alho!');
                        return;
                    }
                    console.log('âœ… [3/6] Modelo tem cabeÃ§alho_id:', modelo.cabecalho_id);
                    
                    // 4. Buscar layout
                    console.log('ğŸ“‹ [4/6] Buscando layout...');
                    const layout = SistemaCore.dados.cabecalhos?.find(l => l.id == modelo.cabecalho_id);
                    if (!layout) {
                        console.warn('âŒ [FALHOU] Layout nÃ£o encontrado!');
                        console.log('   Layouts disponÃ­veis:', SistemaCore.dados.cabecalhos?.map(l => `${l.id}: ${l.nome}`));
                        return;
                    }
                    console.log('âœ… [4/6] Layout encontrado:', layout.nome);
                    
                    // 5. Verificar container
                    console.log('ğŸ“‹ [5/6] Buscando container sandbox-cabecalho...');
                    const container = document.getElementById('sandbox-cabecalho');
                    if (!container) {
                        console.warn('âŒ [FALHOU] Container nÃ£o encontrado no DOM!');
                        return;
                    }
                    console.log('âœ… [5/6] Container encontrado');
                    
                    // 6. Re-renderizar
                    console.log('ğŸ“‹ [6/6] Re-renderizando cabeÃ§alho...');
                    const novoHTML = this.renderizarCabecalhoLayout(layout);
                    console.log('   HTML gerado (length):', novoHTML?.length || 0);
                    container.innerHTML = novoHTML;
                    console.log('âœ… [6/6] innerHTML atualizado!');
                    
                    console.log('');
                    console.log('ğŸ‰ğŸ‰ğŸ‰ CABEÃ‡ALHO SANDBOX ATUALIZADO COM SUCESSO! ğŸ‰ğŸ‰ğŸ‰');
                    console.log('');
                } catch (erro) {
                    console.error('');
                    console.error('âŒâŒâŒ ERRO CRÃTICO em Sandbox.atualizarCabecalho():');
                    console.error(erro);
                    console.error('Stack:', erro.stack);
                    console.error('');
                }
            }
        };

        /* ============================================================
           [DADOS CLÃNICOS] MÃ³dulo de Cadastro - v10.12.0
           ============================================================ */
        
        const DadosClinicos = {
            proximoId: {
                cirurgia: 1,
                antibiotico: 1
            },

            init() {
                console.log('ğŸ’Š [DadosClinicos] MÃ³dulo inicializado');
                this.carregarPools();
                this.renderizar();
                this.definirDataHoje();
            },

            definirDataHoje() {
                const hoje = new Date().toISOString().split('T')[0];
                
                // Se nÃ£o tem data de internaÃ§Ã£o, definir hoje
                if (!SistemaCore.dados.dadosClinicosExemplo ||!SistemaCore.dados.dadosClinicosExemplo.internacao) {
                    const el = document.getElementById('internacao-data');
                    if (el) el.value = hoje;
                }
                
                // Definir hoje para novos cadastros
                const elCir = document.getElementById('cirurgia-data');
                const elAtb = document.getElementById('atb-data-inicio');
                if (elCir) elCir.value = hoje;
                if (elAtb) elAtb.value = hoje;
            },

            carregarPools() {
                const pools = SistemaCore.dados.pools;
                
                // Pool de procedimentos
                const selectProc = document.getElementById('cirurgia-procedimento');
                if (selectProc) {
                    selectProc.innerHTML = '<option value="">Selecione...</option>';
                    pools.tratamentos.procedimentos.forEach(proc => {
                        selectProc.innerHTML += `<option value="${proc}">${proc}</option>`;
                    });
                }

                // Pool de antibiÃ³ticos
                const selectAtb = document.getElementById('atb-nome');
                if (selectAtb) {
                    selectAtb.innerHTML = '<option value="">Selecione...</option>';
                    pools.tratamentos.antibioticos.forEach(atb => {
                        selectAtb.innerHTML += `<option value="${atb}">${atb}</option>`;
                    });
                }
            },

            adicionarAoPool(tipo) {
                const input = document.getElementById(`pool-${tipo === 'procedimentos' ? 'procedimento' : 'antibiotico'}`);
                const valor = input.value.trim();

                if (!valor) {
                    alert('Digite um nome para adicionar ao pool');
                    return;
                }

                const pool = SistemaCore.dados.pools[tipo];
                if (pool.includes(valor)) {
                    alert('Este item jÃ¡ existe no pool!');
                    return;
                }

                pool.push(valor);
                SistemaCore.salvar();
                this.carregarPools();
                input.value = '';
                Sistema.notificar(`âœ… "${valor}" adicionado ao pool!`);
            },

            // ========== INTERNAÃ‡ÃƒO ==========
            
            salvarInternacao() {
                const data = document.getElementById('internacao-data');
                const local = document.getElementById('internacao-local');
                const motivo = document.getElementById('internacao-motivo');
                
                if (!data || !data.value) {
                    if (SistemaCore.dados.dadosClinicosExemplo) {
                        SistemaCore.dados.dadosClinicosExemplo.internacao = null;
                    }
                } else {
                    if (!SistemaCore.dados.dadosClinicosExemplo) {
                        SistemaCore.dados.dadosClinicosExemplo = { internacao: null, cirurgias: [], antibioticos: { emUso: [], suspensos: [] } };
                    }
                    SistemaCore.dados.dadosClinicosExemplo.internacao = {
                        dataAdmissao: data.value,
                        local: local ? local.value : '',
                        motivo: motivo ? motivo.value : ''
                    };
                }

                SistemaCore.salvar();
                this.atualizarDiasInternacao();
                this.atualizarPreview();
            },

            atualizarDiasInternacao() {
                const el = document.getElementById('internacao-dias-valor');
                if (!el) return;
                
                const internacao = SistemaCore.dados.dadosClinicosExemplo?.internacao;
                if (!internacao || !internacao.dataAdmissao) {
                    el.textContent = '0';
                    return;
                }

                const dias = this.calcularDias(internacao.dataAdmissao);
                el.textContent = dias;
            },

            // ========== CIRURGIAS ==========
            
            adicionarCirurgia() {
                const procedimento = document.getElementById('cirurgia-procedimento')?.value;
                const data = document.getElementById('cirurgia-data')?.value;
                const cirurgiao = document.getElementById('cirurgia-cirurgiao')?.value;
                const obs = document.getElementById('cirurgia-obs')?.value;

                if (!procedimento || !data) {
                    alert('Preencha procedimento e data!');
                    return;
                }

                if (!SistemaCore.dados.dadosClinicosExemplo) {
                    SistemaCore.dados.dadosClinicosExemplo = { internacao: null, cirurgias: [], antibioticos: { emUso: [], suspensos: [] } };
                }

                const cirurgia = {
                    id: this.proximoId.cirurgia++,
                    procedimento: procedimento,
                    data: data,
                    cirurgiao: cirurgiao || '',
                    observacoes: obs || ''
                };

                SistemaCore.dados.dadosClinicosExemplo.cirurgias.push(cirurgia);
                SistemaCore.salvar();
                
                // Limpar formulÃ¡rio
                const procEl = document.getElementById('cirurgia-procedimento');
                const obsEl = document.getElementById('cirurgia-obs');
                if (procEl) procEl.value = '';
                if (obsEl) obsEl.value = '';
                
                this.renderizarCirurgias();
                this.atualizarPreview();
                Sistema.notificar('âœ… Cirurgia adicionada!');
            },

            excluirCirurgia(id) {
                if (!confirm('Excluir esta cirurgia?')) return;
                
                if (SistemaCore.dados.dadosClinicosExemplo?.cirurgias) {
                    SistemaCore.dados.dadosClinicosExemplo.cirurgias = 
                        SistemaCore.dados.dadosClinicosExemplo.cirurgias.filter(c => c.id !== id);
                }
                
                SistemaCore.salvar();
                this.renderizarCirurgias();
                this.atualizarPreview();
                Sistema.notificar('ğŸ—‘ï¸ Cirurgia excluÃ­da!');
            },

            renderizarCirurgias() {
                const lista = document.getElementById('lista-cirurgias');
                if (!lista) return;
                
                const cirurgias = SistemaCore.dados.dadosClinicosExemplo?.cirurgias || [];

                if (cirurgias.length === 0) {
                    lista.innerHTML = '<p style="font-size: 11px; text-align: center; padding: 12px; color: var(--text-light);">Nenhuma cirurgia</p>';
                    return;
                }

                lista.innerHTML = cirurgias.map(cir => {
                    const po = this.calcularDias(cir.data);
                    return `
                        <div style="background: #f9fafb; padding: 10px; border-radius: 6px; border: 1px solid var(--border); margin-bottom: 8px; font-size: 11px;">
                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; margin-bottom: 4px;">
                                        ${cir.procedimento} - D${po}
                                    </div>
                                    <div style="color: var(--text-light); line-height: 1.4;">
                                        ğŸ“… ${this.formatarData(cir.data)}<br>
                                        ğŸ‘¨â€âš•ï¸ ${cir.cirurgiao || 'NÃ£o informado'}
                                        ${cir.observacoes ? `<br>ğŸ“ ${cir.observacoes}` : ''}
                                    </div>
                                </div>
                                <button onclick="DadosClinicos.excluirCirurgia(${cir.id})" style="padding: 4px 8px; background: var(--danger); color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 10px;">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                }).join('');
            },

            // ========== ANTIBIÃ“TICOS ==========
            
            adicionarATB() {
                const nome = document.getElementById('atb-nome')?.value;
                const dose = document.getElementById('atb-dose')?.value;
                const via = document.getElementById('atb-via')?.value;
                const dataInicio = document.getElementById('atb-data-inicio')?.value;
                const duracao = parseInt(document.getElementById('atb-duracao')?.value);

                if (!nome || !dose || !dataInicio) {
                    alert('Preencha nome, dose e data de inÃ­cio!');
                    return;
                }

                if (!SistemaCore.dados.dadosClinicosExemplo) {
                    SistemaCore.dados.dadosClinicosExemplo = { internacao: null, cirurgias: [], antibioticos: { emUso: [], suspensos: [] } };
                }

                const atb = {
                    id: this.proximoId.antibiotico++,
                    nome: nome,
                    dose: dose,
                    via: via,
                    dataInicio: dataInicio,
                    duracaoPrevista: duracao || null
                };

                SistemaCore.dados.dadosClinicosExemplo.antibioticos.emUso.push(atb);
                SistemaCore.salvar();
                
                // Limpar formulÃ¡rio
                const nomeEl = document.getElementById('atb-nome');
                const doseEl = document.getElementById('atb-dose');
                const duracaoEl = document.getElementById('atb-duracao');
                if (nomeEl) nomeEl.value = '';
                if (doseEl) doseEl.value = '';
                if (duracaoEl) duracaoEl.value = '';
                
                this.renderizarATBs();
                this.atualizarPreview();
                Sistema.notificar('âœ… AntibiÃ³tico adicionado!');
            },

            suspenderATB(id) {
                if (!SistemaCore.dados.dadosClinicosExemplo?.antibioticos) return;
                
                const atb = SistemaCore.dados.dadosClinicosExemplo.antibioticos.emUso.find(a => a.id === id);
                if (!atb) return;

                // Adicionar data de fim
                atb.dataFim = new Date().toISOString().split('T')[0];

                // Mover para suspensos
                SistemaCore.dados.dadosClinicosExemplo.antibioticos.suspensos.push(atb);
                SistemaCore.dados.dadosClinicosExemplo.antibioticos.emUso = 
                    SistemaCore.dados.dadosClinicosExemplo.antibioticos.emUso.filter(a => a.id !== id);

                SistemaCore.salvar();
                this.renderizarATBs();
                this.atualizarPreview();
                Sistema.notificar('ğŸ”´ AntibiÃ³tico suspenso!');
            },

            renderizarATBs() {
                const atbs = SistemaCore.dados.dadosClinicosExemplo?.antibioticos || { emUso: [], suspensos: [] };

                // Contador e lista - EM USO
                const contadorUso = document.getElementById('contador-atb-uso');
                if (contadorUso) contadorUso.textContent = atbs.emUso.length;
                
                const listaUso = document.getElementById('lista-atb-uso');
                if (listaUso) {
                    if (atbs.emUso.length === 0) {
                        listaUso.innerHTML = '<p style="font-size: 10px; text-align: center; padding: 8px; color: var(--text-light);">Nenhum ATB em uso</p>';
                    } else {
                        listaUso.innerHTML = atbs.emUso.map(atb => {
                            const dias = this.calcularDias(atb.dataInicio);
                            return `
                                <div style="background: #f9fafb; padding: 8px; border-radius: 6px; border: 1px solid var(--border); margin-bottom: 6px; font-size: 10px;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div style="flex: 1;">
                                            <div style="font-weight: 600; margin-bottom: 3px;">
                                                ${atb.nome} ${atb.dose} - D${dias}
                                            </div>
                                            <div style="color: var(--text-light); line-height: 1.3;">
                                                ${atb.via} â€¢ ${this.formatarData(atb.dataInicio)}
                                                ${atb.duracaoPrevista ? ` â€¢ ${atb.duracaoPrevista}d` : ''}
                                            </div>
                                        </div>
                                        <button onclick="DadosClinicos.suspenderATB(${atb.id})" title="Suspender" style="padding: 3px 6px; background: var(--danger); color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 9px;">ğŸ”´</button>
                                    </div>
                                </div>
                            `;
                        }).join('');
                    }
                }

                // Contador e lista - SUSPENSOS
                const contadorSusp = document.getElementById('contador-atb-suspensos');
                if (contadorSusp) contadorSusp.textContent = atbs.suspensos.length;
                
                const listaSusp = document.getElementById('lista-atb-suspensos');
                if (listaSusp) {
                    if (atbs.suspensos.length === 0) {
                        listaSusp.innerHTML = '<p style="font-size: 10px; text-align: center; padding: 8px; color: var(--text-light);">Nenhum ATB suspenso</p>';
                    } else {
                        listaSusp.innerHTML = atbs.suspensos.map(atb => {
                            const diasUso = this.calcularDiasEntre(atb.dataInicio, atb.dataFim);
                            return `
                                <div style="background: #f9fafb; padding: 8px; border-radius: 6px; border: 1px solid var(--border); margin-bottom: 6px; font-size: 10px; opacity: 0.7;">
                                    <div style="font-weight: 600; margin-bottom: 3px;">
                                        ${atb.nome} ${atb.dose}
                                    </div>
                                    <div style="color: var(--text-light); line-height: 1.3;">
                                        ${this.formatarData(atb.dataInicio)} a ${this.formatarData(atb.dataFim)} (${diasUso}d)
                                    </div>
                                </div>
                            `;
                        }).join('');
                    }
                }
            },

            // ========== PREVIEW ==========
            
            atualizarPreview() {
                const preview = document.getElementById('preview-dados-clinicos');
                if (!preview) return;
                
                const dados = SistemaCore.dados.dadosClinicosExemplo;
                if (!dados) {
                    preview.innerHTML = '<p style="text-align: center; color: #9ca3af; padding: 40px 20px;">Nenhum dado cadastrado.</p>';
                    return;
                }
                
                let html = '';

                // Dias de internaÃ§Ã£o
                if (dados.internacao && dados.internacao.dataAdmissao) {
                    const dias = this.calcularDias(dados.internacao.dataAdmissao);
                    html += `
                        <div style="margin-bottom: 16px;">
                            <div style="font-weight: bold; margin-bottom: 4px;">DIA DE INTERNAÃ‡ÃƒO: ${dias} ${dias === 1 ? 'dia' : 'dias'}</div>
                            <div style="color: #6b7280; font-size: 10px;">Local: ${dados.internacao.local || 'NÃ£o informado'}</div>
                        </div>
                    `;
                }

                // Cirurgias
                if (dados.cirurgias && dados.cirurgias.length > 0) {
                    html += `
                        <div style="margin-bottom: 16px;">
                            <div style="font-weight: bold; margin-bottom: 8px;">CIRURGIAS REALIZADAS: ${dados.cirurgias.length}</div>
                            <div style="padding-left: 12px; line-height: 1.6;">
                                ${dados.cirurgias.map(cir => {
                                    const po = this.calcularDias(cir.data);
                                    return `â€¢ <strong>D${po}</strong> - ${cir.procedimento} (${this.formatarData(cir.data)})`;
                                }).join('<br>')}
                            </div>
                        </div>
                    `;
                }

                // ATBs em uso
                if (dados.antibioticos && dados.antibioticos.emUso && dados.antibioticos.emUso.length > 0) {
                    html += `
                        <div style="margin-bottom: 16px;">
                            <div style="font-weight: bold; margin-bottom: 8px;">ANTIBIÃ“TICOS EM USO: ${dados.antibioticos.emUso.length}</div>
                            <div style="padding-left: 12px; line-height: 1.6;">
                                ${dados.antibioticos.emUso.map(atb => {
                                    const dias = this.calcularDias(atb.dataInicio);
                                    return `â€¢ <strong>D${dias}</strong> - ${atb.nome} ${atb.dose} (${this.formatarData(atb.dataInicio)})${atb.duracaoPrevista ? ` [${atb.duracaoPrevista}d]` : ''}`;
                                }).join('<br>')}
                            </div>
                        </div>
                    `;
                }

                // ATBs suspensos
                if (dados.antibioticos && dados.antibioticos.suspensos && dados.antibioticos.suspensos.length > 0) {
                    html += `
                        <div style="margin-bottom: 16px;">
                            <div style="font-weight: bold; margin-bottom: 8px;">ANTIBIÃ“TICOS SUSPENSOS: ${dados.antibioticos.suspensos.length}</div>
                            <div style="padding-left: 12px; line-height: 1.6; color: #6b7280;">
                                ${dados.antibioticos.suspensos.map(atb => {
                                    const diasUso = this.calcularDiasEntre(atb.dataInicio, atb.dataFim);
                                    return `â€¢ ${atb.nome} - ${this.formatarData(atb.dataInicio)} a ${this.formatarData(atb.dataFim)} (${diasUso}d)`;
                                }).join('<br>')}
                            </div>
                        </div>
                    `;
                }

                if (!html) {
                    html = '<p style="text-align: center; color: #9ca3af; padding: 40px 20px;">Nenhum dado cadastrado.<br>Preencha os campos ao lado.</p>';
                }

                preview.innerHTML = html;
            },

            // ========== UTILITÃRIOS ==========
            
            calcularDias(dataInicio) {
                const hoje = new Date();
                const inicio = new Date(dataInicio + 'T00:00:00');
                const diff = hoje - inicio;
                return Math.floor(diff / (1000 * 60 * 60 * 24)) + 1;
            },

            calcularDiasEntre(dataInicio, dataFim) {
                const inicio = new Date(dataInicio + 'T00:00:00');
                const fim = new Date(dataFim + 'T00:00:00');
                const diff = fim - inicio;
                return Math.floor(diff / (1000 * 60 * 60 * 24)) + 1;
            },

            formatarData(data) {
                const [ano, mes, dia] = data.split('-');
                return `${dia}/${mes}/${ano}`;
            },

            renderizar() {
                // Carregar dados de internaÃ§Ã£o
                const internacao = SistemaCore.dados.dadosClinicosExemplo?.internacao;
                if (internacao) {
                    const elData = document.getElementById('internacao-data');
                    const elLocal = document.getElementById('internacao-local');
                    const elMotivo = document.getElementById('internacao-motivo');
                    if (elData) elData.value = internacao.dataAdmissao || '';
                    if (elLocal) elLocal.value = internacao.local || '';
                    if (elMotivo) elMotivo.value = internacao.motivo || '';
                    this.atualizarDiasInternacao();
                }

                this.renderizarCirurgias();
                this.renderizarATBs();
                this.atualizarPreview();
            }
        };

        /* ============================================================
           [EVENTOS CLÃNICOS] MÃ³dulo para Registro de Eventos no Atendimento - v10.13.0
           ============================================================ */

        const EventosClÃ­nicos = {
            atendimentoAtualId: null,
            proximoId: { cirurgia: 1, antibiotico: 1 },

            init(atendimentoId) {
                this.atendimentoAtualId = atendimentoId;
                this.garantirEstrutura();
                this.carregarPools();
                this.renderizar();
                this.definirDataHoje();
            },

            garantirEstrutura() {
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento) return;
                
                if (!atendimento.eventosClÃ­nicos) {
                    atendimento.eventosClÃ­nicos = {
                        internacao: null,
                        cirurgias: [],
                        antibioticos: { emUso: [], suspensos: [] }
                    };
                }
            },

            definirDataHoje() {
                const hoje = new Date().toISOString().split('T')[0];
                const elCir = document.getElementById('evento-cirurgia-data');
                const elAtb = document.getElementById('evento-atb-data-inicio');
                if (elCir) elCir.value = hoje;
                if (elAtb) elAtb.value = hoje;
            },

            carregarPools() {
                const pools = SistemaCore.dados.pools;
                
                // Pool de locais de internaÃ§Ã£o
                const selectLocal = document.getElementById('evento-internacao-local');
                if (selectLocal) {
                    selectLocal.innerHTML = '<option value="">Selecione...</option>';
                    pools.tratamentos.locaisInternacao.forEach(local => {
                        selectLocal.innerHTML += `<option value="${local}">${local}</option>`;
                    });
                }

                // Pool de procedimentos
                const selectProc = document.getElementById('evento-cirurgia-procedimento');
                if (selectProc) {
                    selectProc.innerHTML = '<option value="">Selecione...</option>';
                    pools.tratamentos.procedimentos.forEach(proc => {
                        selectProc.innerHTML += `<option value="${proc}">${proc}</option>`;
                    });
                }

                // Pool de antibiÃ³ticos
                const selectAtb = document.getElementById('evento-atb-nome');
                if (selectAtb) {
                    selectAtb.innerHTML = '<option value="">Selecione...</option>';
                    pools.tratamentos.antibioticos.forEach(atb => {
                        selectAtb.innerHTML += `<option value="${atb}">${atb}</option>`;
                    });
                }
            },

            // ===== INTERNAÃ‡ÃƒO =====
            
            salvarInternacao() {
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento) return;

                const data = document.getElementById('evento-internacao-data');
                const local = document.getElementById('evento-internacao-local');
                
                if (!data || !data.value) {
                    atendimento.eventosClÃ­nicos.internacao = null;
                } else {
                    atendimento.eventosClÃ­nicos.internacao = {
                        dataAdmissao: data.value,
                        local: local ? local.value : ''
                    };
                }

                SistemaCore.salvar();
                this.atualizarBanner();
            },

            // ===== CIRURGIAS =====
            
            adicionarCirurgia() {
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento) return;

                const procedimento = document.getElementById('evento-cirurgia-procedimento')?.value;
                const data = document.getElementById('evento-cirurgia-data')?.value;
                const cirurgiao = document.getElementById('evento-cirurgia-cirurgiao')?.value;

                if (!procedimento || !data) {
                    alert('Preencha procedimento e data!');
                    return;
                }

                const cirurgia = {
                    id: this.proximoId.cirurgia++,
                    procedimento: procedimento,
                    data: data,
                    cirurgiao: cirurgiao || ''
                };

                atendimento.eventosClÃ­nicos.cirurgias.push(cirurgia);
                SistemaCore.salvar();
                
                // Limpar formulÃ¡rio
                document.getElementById('evento-cirurgia-procedimento').value = '';
                if (document.getElementById('evento-cirurgia-cirurgiao')) {
                    document.getElementById('evento-cirurgia-cirurgiao').value = '';
                }
                
                this.renderizarCirurgias();
                this.atualizarBanner();
                Sistema.notificar('âœ… Cirurgia/Procedimento registrado!');
            },

            excluirCirurgia(id) {
                if (!confirm('Excluir este registro?')) return;
                
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento) return;
                
                atendimento.eventosClÃ­nicos.cirurgias = atendimento.eventosClÃ­nicos.cirurgias.filter(c => c.id !== id);
                
                SistemaCore.salvar();
                this.renderizarCirurgias();
                this.atualizarBanner();
                Sistema.notificar('ğŸ—‘ï¸ Registro excluÃ­do!');
            },

            renderizarCirurgias() {
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento) return;

                const lista = document.getElementById('evento-lista-cirurgias');
                if (!lista) return;

                const cirurgias = atendimento.eventosClÃ­nicos.cirurgias || [];

                if (cirurgias.length === 0) {
                    lista.innerHTML = '<p style="font-size: 11px; text-align: center; padding: 12px; color: var(--text-light);">Nenhuma cirurgia/procedimento registrado</p>';
                    return;
                }

                lista.innerHTML = cirurgias.map(cir => {
                    const po = this.calcularDias(cir.data);
                    return `
                        <div style="background: #f9fafb; padding: 10px; border-radius: 6px; border: 1px solid var(--border); margin-bottom: 8px; font-size: 11px;">
                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; margin-bottom: 4px;">
                                        ${cir.procedimento} - D${po}
                                    </div>
                                    <div style="color: var(--text-light); line-height: 1.4;">
                                        ğŸ“… ${this.formatarData(cir.data)}<br>
                                        ğŸ‘¨â€âš•ï¸ ${cir.cirurgiao || 'NÃ£o informado'}
                                    </div>
                                </div>
                                <button onclick="EventosClÃ­nicos.excluirCirurgia(${cir.id})" style="padding: 4px 8px; background: var(--danger); color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 10px;">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                }).join('');
            },

            // ===== ANTIBIÃ“TICOS =====
            
            adicionarATB() {
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento) return;

                const nome = document.getElementById('evento-atb-nome')?.value;
                const dose = document.getElementById('evento-atb-dose')?.value;
                const via = document.getElementById('evento-atb-via')?.value;
                const dataInicio = document.getElementById('evento-atb-data-inicio')?.value;

                if (!nome || !dose || !dataInicio) {
                    alert('Preencha nome, dose e data de inÃ­cio!');
                    return;
                }

                const atb = {
                    id: this.proximoId.antibiotico++,
                    nome: nome,
                    dose: dose,
                    via: via,
                    dataInicio: dataInicio
                };

                atendimento.eventosClÃ­nicos.antibioticos.emUso.push(atb);
                SistemaCore.salvar();
                
                // Limpar formulÃ¡rio
                document.getElementById('evento-atb-nome').value = '';
                document.getElementById('evento-atb-dose').value = '';
                
                this.renderizarATBs();
                this.atualizarBanner();
                Sistema.notificar('âœ… AntibiÃ³tico registrado!');
            },

            suspenderATB(id) {
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento) return;

                const atb = atendimento.eventosClÃ­nicos.antibioticos.emUso.find(a => a.id === id);
                if (!atb) return;

                const dataFim = prompt('Data de suspensÃ£o (AAAA-MM-DD):', new Date().toISOString().split('T')[0]);
                if (!dataFim) return;

                atb.dataFim = dataFim;
                atendimento.eventosClÃ­nicos.antibioticos.suspensos.push(atb);
                atendimento.eventosClÃ­nicos.antibioticos.emUso = atendimento.eventosClÃ­nicos.antibioticos.emUso.filter(a => a.id !== id);

                SistemaCore.salvar();
                this.renderizarATBs();
                this.atualizarBanner();
                Sistema.notificar('âšª AntibiÃ³tico suspenso!');
            },

            renderizarATBs() {
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento) return;

                const atbs = atendimento.eventosClÃ­nicos.antibioticos || { emUso: [], suspensos: [] };

                // EM USO
                const listaUso = document.getElementById('evento-lista-atb-uso');
                if (listaUso) {
                    if (atbs.emUso.length === 0) {
                        listaUso.innerHTML = '<p style="font-size: 10px; text-align: center; padding: 8px; color: var(--text-light);">Nenhum ATB em uso</p>';
                    } else {
                        listaUso.innerHTML = atbs.emUso.map(atb => {
                            const dias = this.calcularDias(atb.dataInicio);
                            return `
                                <div style="background: #f9fafb; padding: 8px; border-radius: 6px; border: 1px solid #86efac; margin-bottom: 6px; font-size: 10px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div style="flex: 1;">
                                            <div style="font-weight: 600; margin-bottom: 3px;">
                                                ${atb.nome} ${atb.dose} - D${dias}
                                            </div>
                                            <div style="color: var(--text-light); line-height: 1.3;">
                                                ${atb.via} â€¢ ${this.formatarData(atb.dataInicio)}
                                            </div>
                                        </div>
                                        <button onclick="EventosClÃ­nicos.suspenderATB(${atb.id})" title="Suspender" style="padding: 3px 6px; background: var(--danger); color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 9px;">ğŸ”´</button>
                                    </div>
                                </div>
                            `;
                        }).join('');
                    }
                }

                // SUSPENSOS
                const listaSusp = document.getElementById('evento-lista-atb-suspensos');
                if (listaSusp) {
                    if (atbs.suspensos.length === 0) {
                        listaSusp.innerHTML = '<p style="font-size: 10px; text-align: center; padding: 8px; color: var(--text-light);">Nenhum ATB suspenso</p>';
                    } else {
                        listaSusp.innerHTML = atbs.suspensos.map(atb => {
                            const diasUso = this.calcularDiasEntre(atb.dataInicio, atb.dataFim);
                            return `
                                <div style="background: #f9fafb; padding: 8px; border-radius: 6px; border: 1px solid var(--border); margin-bottom: 6px; font-size: 10px; opacity: 0.7;">
                                    <div style="font-weight: 600; margin-bottom: 3px;">
                                        ${atb.nome} ${atb.dose}
                                    </div>
                                    <div style="color: var(--text-light); line-height: 1.3;">
                                        ${this.formatarData(atb.dataInicio)} a ${this.formatarData(atb.dataFim)} (${diasUso}d)
                                    </div>
                                </div>
                            `;
                        }).join('');
                    }
                }
            },

            // ===== GERENCIAR POOLS =====
            
            gerenciarPool(tipo) {
                const nomePool = {
                    'procedimentos': 'Procedimentos/Cirurgias',
                    'antibioticos': 'AntibiÃ³ticos',
                    'locaisInternacao': 'Locais de InternaÃ§Ã£o'
                }[tipo];

                const pool = SistemaCore.dados.pools[tipo];
                
                if (pool.length === 0) {
                    alert(`Nenhum ${nomePool.toLowerCase()} cadastrado.`);
                    return;
                }
                
                let lista = `GERENCIAR ${nomePool.toUpperCase()}\n\n`;
                lista += pool.map((item, i) => `${i+1}. ${item}`).join('\n');
                alert(lista);
                
                const acao = prompt('Digite:\n"E [nÃºmero]" para editar\n"D [nÃºmero]" para deletar\nou ENTER para cancelar');
                if (!acao) return;
                
                const match = acao.match(/^([ED])\s*(\d+)$/i);
                if (!match) return;
                
                const tipoAcao = match[1].toUpperCase();
                const index = parseInt(match[2]) - 1;
                
                if (index < 0 || index >= pool.length) {
                    alert('NÃºmero invÃ¡lido!');
                    return;
                }
                
                if (tipoAcao === 'E') {
                    const novoNome = prompt(`Editar "${pool[index]}".\n\nNovo nome:`, pool[index]);
                    if (novoNome && novoNome.trim() && novoNome.trim() !== pool[index]) {
                        pool[index] = novoNome.trim();
                        pool.sort();
                        SistemaCore.salvar();
                        this.carregarPools();
                        alert('Editado com sucesso!');
                    }
                } else if (tipoAcao === 'D') {
                    if (confirm(`Deletar "${pool[index]}" permanentemente?`)) {
                        pool.splice(index, 1);
                        SistemaCore.salvar();
                        this.carregarPools();
                        alert('Deletado com sucesso!');
                    }
                }
            },

            criarNovo(tipo) {
                const nomeItem = {
                    'procedimentos': 'procedimento/cirurgia',
                    'antibioticos': 'antibiÃ³tico',
                    'locaisInternacao': 'local de internaÃ§Ã£o'
                }[tipo];

                const nome = prompt(`Digite o nome do novo ${nomeItem}:`);
                if (!nome || !nome.trim()) return;
                
                const nomeTrim = nome.trim();
                const pool = SistemaCore.dados.pools[tipo];
                
                if (pool.includes(nomeTrim)) {
                    alert('Este item jÃ¡ existe no pool!');
                    return;
                }
                
                pool.push(nomeTrim);
                pool.sort();
                SistemaCore.salvar();
                this.carregarPools();
                alert(`âœ… "${nomeTrim}" adicionado ao pool!`);
            },

            // ===== UTILITÃRIOS =====
            
            calcularDias(dataInicio) {
                const hoje = new Date();
                const inicio = new Date(dataInicio + 'T00:00:00');
                const diff = hoje - inicio;
                return Math.floor(diff / (1000 * 60 * 60 * 24));
            },

            calcularDiasEntre(dataInicio, dataFim) {
                const inicio = new Date(dataInicio + 'T00:00:00');
                const fim = new Date(dataFim + 'T00:00:00');
                const diff = fim - inicio;
                return Math.floor(diff / (1000 * 60 * 60 * 24)) + 1;
            },

            formatarData(data) {
                const [ano, mes, dia] = data.split('-');
                return `${dia}/${mes}/${ano}`;
            },

            // ===== BANNER AUTOMÃTICO =====
            
            atualizarBanner() {
                const banner = document.getElementById('banner-eventos-clinicos');
                if (!banner) return;
                
                banner.innerHTML = this.gerarBannerAutomatico();
            },

            gerarBannerAutomatico() {
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento || !atendimento.eventosClÃ­nicos) {
                    return '<div style="text-align: center; color: #999; padding: 12px;">Nenhum evento clÃ­nico registrado</div>';
                }

                const dados = atendimento.eventosClÃ­nicos;
                let itens = [];

                // InternaÃ§Ã£o
                if (dados.internacao && dados.internacao.dataAdmissao) {
                    const dias = this.calcularDias(dados.internacao.dataAdmissao);
                    const local = dados.internacao.local ? ` (${dados.internacao.local})` : '';
                    itens.push(`D${dias} internaÃ§Ã£o${local}`);
                }

                // Cirurgias
                if (dados.cirurgias && dados.cirurgias.length > 0) {
                    dados.cirurgias.forEach(cir => {
                        const po = this.calcularDias(cir.data);
                        itens.push(`D${po} PO ${cir.procedimento}`);
                    });
                }

                // ATBs em uso
                if (dados.antibioticos && dados.antibioticos.emUso && dados.antibioticos.emUso.length > 0) {
                    dados.antibioticos.emUso.forEach(atb => {
                        const dias = this.calcularDias(atb.dataInicio);
                        itens.push(`D${dias} ATB: ${atb.nome}`);
                    });
                }

                if (itens.length === 0) {
                    return '<div style="text-align: center; color: #999; padding: 12px;">Nenhum evento clÃ­nico registrado</div>';
                }

                return `
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 14px 20px; border-radius: 8px; font-size: 13px; font-weight: 600;">
                        ğŸ“Š ${itens.join(' | ')}
                    </div>
                `;
            },

            renderizar() {
                const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === this.atendimentoAtualId);
                if (!atendimento || !atendimento.eventosClÃ­nicos) return;

                // Carregar internaÃ§Ã£o
                const internacao = atendimento.eventosClÃ­nicos.internacao;
                if (internacao) {
                    const elData = document.getElementById('evento-internacao-data');
                    const elLocal = document.getElementById('evento-internacao-local');
                    if (elData) elData.value = internacao.dataAdmissao || '';
                    if (elLocal) elLocal.value = internacao.local || '';
                }

                this.renderizarCirurgias();
                this.renderizarATBs();
                this.atualizarBanner();
            }
        };

        /* ============================================================
           [TEMPLATES] MÃ³dulo ConfigurÃ¡vel de Templates - v10.12.4
           ============================================================ */
        
        /* ============================================================
           [TEMPLATES] MÃ³dulo de Gerenciamento de Templates - v10.15.0
           ============================================================ */
        
        const Templates = {
            // Array de templates salvos
            templates: [],
            
            // Template sendo editado (null para novo)
            templateAtual: null,
            
            // MÃ³dulos selecionados no template atual
            modulosSelecionados: [],
            
            // DefiniÃ§Ã£o completa de mÃ³dulos disponÃ­veis
            MODULOS_DISPONIVEIS: {
                anamnese: [
                    { id: 'queixa', nome: 'Queixa Principal', icone: 'ğŸ—£ï¸', submodulos: [] },
                    { id: 'historia-atual', nome: 'HistÃ³ria Atual (HDA)', icone: 'ğŸ“–', submodulos: [] },
                    { id: 'expectativas', nome: 'Expectativas', icone: 'ğŸ¯', submodulos: [] },
                    
                    // MÃ“DULOS GRANULARES - HistÃ³ria Pregressa (podem ser usados isoladamente)
                    { id: 'doencas-previas', nome: 'DoenÃ§as PrÃ©vias', icone: 'ğŸ¥', submodulos: [] },
                    
                    // AGRUPADOR (opÃ§Ã£o de usar todos juntos) - hpp jÃ¡ inclui alergias, cirurgias, medicaÃ§Ãµes, doenÃ§as e gineco-obstÃ©trica
                    
                    { id: 'h-familiar', nome: 'HistÃ³ria Familiar', icone: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§', submodulos: [] },
                    
                    // MÃ“DULOS GRANULARES - HistÃ³ria Social (podem ser usados isoladamente)
                    { id: 'tabagismo', nome: 'Tabagismo', icone: 'ğŸš¬', submodulos: [] },
                    { id: 'etilismo', nome: 'Etilismo', icone: 'ğŸº', submodulos: [] },
                    { id: 'drogas-ilicitas', nome: 'Drogas IlÃ­citas', icone: 'ğŸ’‰', submodulos: [] },
                    { id: 'atividade-fisica', nome: 'Atividade FÃ­sica', icone: 'ğŸƒ', submodulos: [] },
                    { id: 'alimentacao', nome: 'AlimentaÃ§Ã£o', icone: 'ğŸ', submodulos: [] },
                    { id: 'sono-rotina', nome: 'Sono e Rotina', icone: 'ğŸ˜´', submodulos: [] },
                    
                    // AGRUPADOR (opÃ§Ã£o de usar todos juntos)
                    { 
                        id: 'h-social-completa', 
                        nome: 'HistÃ³ria Social Completa', 
                        icone: 'ğŸ ', 
                        submodulos: [
                            { id: 'tabagismo', nome: 'Tabagismo' },
                            { id: 'etilismo', nome: 'Etilismo' },
                            { id: 'drogas-ilicitas', nome: 'Drogas IlÃ­citas' },
                            { id: 'atividade-fisica', nome: 'Atividade FÃ­sica' },
                            { id: 'alimentacao', nome: 'AlimentaÃ§Ã£o' },
                            { id: 'sono-rotina', nome: 'Sono e Rotina' }
                        ]
                    }
                ],
                exame: [
                    { id: 'exame-geral', nome: 'Exame Geral', icone: 'âš•ï¸', submodulos: [] },
                    { 
                        id: 'exame-especifico', 
                        nome: 'Exame EspecÃ­fico', 
                        icone: 'ğŸ¯', 
                        submodulos: [
                            { id: 'mapa-anatomico', nome: 'ğŸ—ºï¸ Mapa AnatÃ´mico' },
                            { id: 'avaliacao-queimaduras', nome: 'ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras' },
                            { id: 'avaliacao-feridas', nome: 'ğŸ©¹ AvaliaÃ§Ã£o de Feridas' },
                            { id: 'exame-cardiovascular', nome: 'ğŸ«€ Cardiovascular' },
                            { id: 'exame-respiratorio', nome: 'ğŸ« RespiratÃ³rio' },
                            { id: 'exame-abdominal', nome: 'ğŸ©º Abdominal' },
                            { id: 'exame-neurologico', nome: 'ğŸ§  NeurolÃ³gico' },
                            { id: 'exame-ortopedico', nome: 'ğŸ¦´ OrtopÃ©dico' },
                            { id: 'exame-vascular', nome: 'ğŸ©¸ Vascular PerifÃ©rico' },
                            { id: 'exame-dermatologico', nome: 'ğŸ”¬ DermatolÃ³gico' },
                            { id: 'exame-oftalmologico', nome: 'ğŸ‘ï¸ OftalmolÃ³gico' },
                            { id: 'exame-otorrino', nome: 'ğŸ‘‚ OtorrinolaringolÃ³gico' },
                            { id: 'exame-bucomaxilo', nome: 'ğŸ¦· Bucomaxilofacial' }
                        ]
                    }
                ],
                escalas: [
                    { id: 'glasgow', nome: 'Escala de Glasgow', icone: 'ğŸ§ ', submodulos: [] },
                    { id: 'braden', nome: 'Escala de Braden (LesÃ£o por PressÃ£o)', icone: 'ğŸ›ï¸', submodulos: [] },
                    { id: 'abcde', nome: 'AvaliaÃ§Ã£o ABCDE (Trauma)', icone: 'ğŸš‘', submodulos: [] },
                    { id: 'rass', nome: 'Escala RASS (SedaÃ§Ã£o)', icone: 'ğŸ’¤', submodulos: [] }
                ],
                diagnostico: [
                    { id: 'hipotese-diagnostica', nome: 'HipÃ³tese DiagnÃ³stica', icone: 'ğŸ”', submodulos: [] },
                    { id: 'conduta', nome: 'Conduta', icone: 'ğŸ“', submodulos: [] },
                    { id: 'prescricao', nome: 'PrescriÃ§Ã£o/Receita', icone: 'ğŸ’Š', submodulos: [] }
                ],
                cirurgico: [
                    { id: 'eventos-cirurgicos', nome: 'Eventos CirÃºrgicos', icone: 'ğŸ“…', submodulos: [] },
                    { id: 'planejamento-cirurgico', nome: 'Planejamento CirÃºrgico', icone: 'ğŸ“‹', submodulos: [] },
                    { id: 'descricao-cirurgica', nome: 'DescriÃ§Ã£o CirÃºrgica Simples', icone: 'ğŸ“„', submodulos: [] },
                    { 
                        id: 'descricao-operatoria', 
                        nome: 'DescriÃ§Ã£o OperatÃ³ria Detalhada', 
                        icone: 'ğŸ”¬', 
                        submodulos: [
                            { id: 'incisao-acesso', nome: 'IncisÃ£o e Via de Acesso' },
                            { id: 'achados-intra', nome: 'Achados IntraoperatÃ³rios' },
                            { id: 'tecnica-operatoria', nome: 'TÃ©cnica OperatÃ³ria' },
                            { id: 'quantificacao', nome: 'QuantificaÃ§Ã£o (ml/gramas)' },
                            { id: 'material-retirado', nome: 'Material Retirado/Ressecado' },
                            { id: 'sintese', nome: 'SÃ­ntese e Fechamento' }
                        ]
                    },
                    { id: 'anatomopatologico', nome: 'Material para AnatomopatolÃ³gico', icone: 'ğŸ§ª', submodulos: [] },
                    { id: 'intercorrencias', nome: 'IntercorrÃªncias IntraoperatÃ³rias', icone: 'âš ï¸', submodulos: [] },
                    { 
                        id: 'dados-cirurgicos', 
                        nome: 'Dados Quantitativos da Cirurgia', 
                        icone: 'ğŸ“Š', 
                        submodulos: [
                            { id: 'tempo-cirurgico', nome: 'Tempos CirÃºrgicos' },
                            { id: 'tempo-anestesico', nome: 'Tempo AnestÃ©sico' },
                            { id: 'perdas-sanguineas', nome: 'Perdas SanguÃ­neas Estimadas' },
                            { id: 'volume-infundido', nome: 'Volume Infundido' },
                            { id: 'diurese', nome: 'Diurese IntraoperatÃ³ria' }
                        ]
                    },
                    { 
                        id: 'drenos-curativos', 
                        nome: 'Drenos e Curativos', 
                        icone: 'ğŸ©¹', 
                        submodulos: [
                            { id: 'drenos-tipo', nome: 'Tipo de Drenos' },
                            { id: 'drenos-localizacao', nome: 'LocalizaÃ§Ã£o dos Drenos' },
                            { id: 'curativo-tipo', nome: 'Tipo de Curativo' }
                        ]
                    },
                    { id: 'orcamento-honorarios', nome: 'OrÃ§amento e HonorÃ¡rios', icone: 'ğŸ’°', submodulos: [] },
                    { id: 'evolucao-pos-op', nome: 'EvoluÃ§Ã£o PÃ³s-OperatÃ³ria', icone: 'ğŸ“ˆ', submodulos: [] },
                    { id: 'evolucao-pos-imediato', nome: 'PÃ³s-OperatÃ³rio Imediato (RPA)', icone: 'ğŸ¥', submodulos: [] },
                    { id: 'alta-cirurgica', nome: 'CritÃ©rios de Alta CirÃºrgica', icone: 'âœ…', submodulos: [] },
                    { id: 'equipe-cirurgica', nome: 'Equipe CirÃºrgica', icone: 'ğŸ‘¥', submodulos: [] },
                    { id: 'detalhes-cirurgia', nome: 'Resumo da Cirurgia Realizada', icone: 'ğŸ“‹', submodulos: [] }
                ],
                'pre-operatorio': [
                    { id: 'retorno-pre-op', nome: 'Retorno PrÃ©-OperatÃ³rio', icone: 'ğŸ¥', submodulos: [] }
                ],
                procedimentos: [
                    { id: 'procedimentos-indicados', nome: 'Procedimentos Indicados', icone: 'ğŸ”§', submodulos: [] },
                    { id: 'anotacoes-procedimento', nome: 'AnotaÃ§Ãµes EspecÃ­ficas do Procedimento', icone: 'ğŸ“', submodulos: [] },
                    { id: 'descricao-ambulatorial', nome: 'DescriÃ§Ã£o de Procedimento Ambulatorial', icone: 'ğŸª', submodulos: [] },
                    { id: 'evolucao-ambulatorial', nome: 'EvoluÃ§Ã£o de Procedimento Ambulatorial', icone: 'ğŸ“Š', submodulos: [] }
                ],
                emergencia: [
                    { 
                        id: 'atendimento-trauma', 
                        nome: 'Atendimento de Trauma (ATLS)', 
                        icone: 'ğŸš‘', 
                        submodulos: [
                            { id: 'via-aerea', nome: 'Via AÃ©rea e Coluna Cervical' },
                            { id: 'ventilacao', nome: 'VentilaÃ§Ã£o' },
                            { id: 'circulacao', nome: 'CirculaÃ§Ã£o e Controle HemorrÃ¡gico' },
                            { id: 'deficit-neuro', nome: 'DÃ©ficit NeurolÃ³gico' },
                            { id: 'exposicao', nome: 'ExposiÃ§Ã£o e Controle TÃ©rmico' }
                        ]
                    },
                    { id: 'mecanismo-trauma', nome: 'Mecanismo de Trauma', icone: 'ğŸ’¥', submodulos: [] },
                    { id: 'escala-coma-glasgow', nome: 'Escala de Coma de Glasgow', icone: 'ğŸ§ ', submodulos: [] },
                    { id: 'fast-protocol', nome: 'FAST Protocol', icone: 'ğŸ”', submodulos: [] },
                    { id: 'reanim-cardiopulmonar', nome: 'ReanimaÃ§Ã£o Cardiopulmonar', icone: 'â¤ï¸', submodulos: [] },
                    { id: 'acesso-vascular', nome: 'Acessos Vasculares', icone: 'ğŸ’‰', submodulos: [] },
                    { id: 'reposicao-volemica', nome: 'ReposiÃ§Ã£o VolÃªmica', icone: 'ğŸ’§', submodulos: [] },
                    { id: 'estabilizacao-emergencia', nome: 'EstabilizaÃ§Ã£o e Medidas de UrgÃªncia', icone: 'âš¡', submodulos: [] }
                ],
                complementar: [
                    { id: 'exames-realizados', nome: 'Exames Realizados/Solicitados', icone: 'ğŸ”¬', submodulos: [] },
                    { id: 'fotos-paciente', nome: 'Fotos do Paciente', icone: 'ğŸ“¸', submodulos: [] },
                    { id: 'anexos', nome: 'Anexos', icone: 'ğŸ“', submodulos: [] }
                ],
                informacoes: [
                    { id: 'info-cirurgia', nome: 'InformaÃ§Ã£o da Cirurgia Realizada', icone: 'â„¹ï¸', submodulos: [] },
                    { id: 'info-atendimento', nome: 'InformaÃ§Ã£o do Atendimento', icone: 'â„¹ï¸', submodulos: [] },
                    { id: 'marcacao-cirurgia', nome: 'MarcaÃ§Ã£o de Cirurgia', icone: 'ğŸ“…', submodulos: [] }
                ],
                internacao: [
                    { id: 'admissao-hospitalar', nome: 'AdmissÃ£o Hospitalar', icone: 'ğŸ¥', submodulos: [] },
                    { 
                        id: 'evolucao-diaria', 
                        nome: 'EvoluÃ§Ã£o MÃ©dica DiÃ¡ria', 
                        icone: 'ğŸ“‹', 
                        submodulos: [
                            { id: 'subjetivo', nome: 'Subjetivo (Queixas)' },
                            { id: 'objetivo', nome: 'Objetivo (Exame FÃ­sico + Dados Vitais)' },
                            { id: 'avaliacao', nome: 'AvaliaÃ§Ã£o (ImpressÃ£o)' },
                            { id: 'plano', nome: 'Plano (Conduta)' }
                        ]
                    },
                    { 
                        id: 'controle-pos-operatorio', 
                        nome: 'Controle PÃ³s-OperatÃ³rio (DPO)', 
                        icone: 'ğŸ“…', 
                        submodulos: [] 
                    },
                    { 
                        id: 'controle-antibioticos', 
                        nome: 'Controle de Antibioticoterapia', 
                        icone: 'ğŸ’Š', 
                        submodulos: [
                            { id: 'atb-em-uso', nome: 'AntibiÃ³ticos em Uso' },
                            { id: 'atb-suspensos', nome: 'AntibiÃ³ticos Suspensos' }
                        ]
                    },
                    { id: 'prescricao-hospitalar', nome: 'PrescriÃ§Ã£o Hospitalar', icone: 'ğŸ’Š', submodulos: [] },
                    { id: 'sinais-vitais', nome: 'Sinais Vitais e BalanÃ§o HÃ­drico', icone: 'ğŸŒ¡ï¸', submodulos: [] },
                    { id: 'interconsulta', nome: 'SolicitaÃ§Ã£o de Interconsulta', icone: 'ğŸ‘¨â€âš•ï¸', submodulos: [] },
                    { id: 'transferencia-unidade', nome: 'TransferÃªncia de Unidade', icone: 'ğŸ”„', submodulos: [] },
                    { id: 'alta-hospitalar', nome: 'SumÃ¡rio de Alta Hospitalar', icone: 'ğŸ“¤', submodulos: [] },
                    { id: 'obito', nome: 'DeclaraÃ§Ã£o de Ã“bito', icone: 'ğŸ“‹', submodulos: [] }
                ],
                acompanhamento: [
                    { id: 'controle-hospitalar', nome: 'Controle Hospitalar (DPO/ATB)', icone: 'ğŸ¥', submodulos: [] },
                    { id: 'evolucao', nome: 'EvoluÃ§Ã£o', icone: 'ğŸ“', submodulos: [] }
                ]
            },

            // ========================================
            // INICIALIZAÃ‡ÃƒO
            // ========================================

            init() {
                console.log('ğŸ“‹ [Templates] Gerenciador de Templates v10.16.3 inicializado');
                this.carregarTemplates();
                this.renderizarTemplates();
            },

            carregarTemplates() {
                // Carregar do localStorage
                const templatesSalvos = localStorage.getItem('templates_v10_15');
                if (templatesSalvos) {
                    this.templates = JSON.parse(templatesSalvos);
                    console.log(`âœ… ${this.templates.length} template(s) carregado(s)`);
                } else {
                    // Templates de exemplo (primeira vez)
                    this.templates = [
                        {
                            id: 1, // v10.434: Template padrÃ£o
                            nome: 'Primeira Consulta Completa',
                            descricao: 'Anamnese completa para primeira vez que atende o paciente',
                            modulos: ['queixa', 'historia-atual', 'expectativas', 'h-pregressa', 'h-familiar', 'h-social', 'exame-geral', 'exame-especifico', 'hipotese-diagnostica', 'conduta', 'prescricao', 'fotos-paciente'],
                            config: {},
                            dataCriacao: new Date().toISOString().split('T')[0],
                            dataEdicao: new Date().toISOString().split('T')[0]
                        },
                        {
                            id: 2, // v10.434: Template padrÃ£o
                            nome: 'Retorno PÃ³s-OperatÃ³rio',
                            descricao: 'Acompanhamento apÃ³s cirurgia, evoluÃ§Ã£o pÃ³s-op',
                            modulos: ['eventos-cirurgicos', 'evolucao-pos-op', 'exame-geral', 'fotos-paciente', 'conduta'],
                            config: {},
                            dataCriacao: new Date().toISOString().split('T')[0],
                            dataEdicao: new Date().toISOString().split('T')[0]
                        },
                        {
                            id: 2, // v10.434
                            nome: 'PrÃ©-OperatÃ³rio',
                            descricao: 'Ãšltima consulta antes da cirurgia, consolidaÃ§Ã£o de exames',
                            modulos: ['retorno-pre-op', 'exames-realizados', 'planejamento-cirurgico', 'orcamento-honorarios', 'conduta', 'fotos-paciente'],
                            config: {},
                            dataCriacao: new Date().toISOString().split('T')[0],
                            dataEdicao: new Date().toISOString().split('T')[0]
                        },
                        {
                            id: 3, // v10.434
                            nome: 'DescriÃ§Ã£o CirÃºrgica Completa',
                            descricao: 'DocumentaÃ§Ã£o completa do ato cirÃºrgico',
                            modulos: ['equipe-cirurgica', 'detalhes-cirurgia', 'descricao-cirurgica', 'anotacoes-procedimento', 'orcamento-honorarios', 'conduta', 'fotos-paciente'],
                            config: {},
                            dataCriacao: new Date().toISOString().split('T')[0],
                            dataEdicao: new Date().toISOString().split('T')[0]
                        },
                        {
                            id: 4, // v10.434
                            nome: 'Retorno Simples',
                            descricao: 'Retorno rÃ¡pido sem necessidade de anamnese completa',
                            modulos: ['queixa', 'historia-atual', 'exame-geral', 'conduta', 'prescricao'],
                            config: {},
                            dataCriacao: new Date().toISOString().split('T')[0],
                            dataEdicao: new Date().toISOString().split('T')[0]
                        }
                    ];
                    this.salvarTemplates();
                    console.log('âœ¨ Template de exemplo criado');
                }
            },

            salvarTemplates() {
                localStorage.setItem('templates_v10_15', JSON.stringify(this.templates));
                console.log('ğŸ’¾ Templates salvos no localStorage');
            },

            // ========================================
            // RENDERIZAÃ‡ÃƒO
            // ========================================

            renderizarTemplates() {
                const container = document.getElementById('templates-container');
                if (!container) {
                    console.error('âŒ Container de templates nÃ£o encontrado!');
                    return;
                }
                
                if (this.templates.length === 0) {
                    container.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px; color: #999;">
                            <p style="font-size: 18px; margin-bottom: 10px;">Nenhum template criado ainda</p>
                            <p style="font-size: 14px;">Clique no botÃ£o abaixo para criar seu primeiro template</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = this.templates.map(template => this.gerarCardTemplate(template)).join('');
            },

            gerarCardTemplate(template) {
                const modulosPreview = this.renderizarModulosPreview(template.modulos);
                
                return `
                    <div class="template-card" data-template-id="${template.id}" style="
                        background: white;
                        border: 1px solid #e0e0e0;
                        border-radius: 12px;
                        padding: 20px;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.borderColor='#667eea'; this.style.boxShadow='0 4px 12px rgba(102, 126, 234, 0.15)'; this.style.transform='translateY(-2px)';" 
                       onmouseout="this.style.borderColor='#e0e0e0'; this.style.boxShadow='none'; this.style.transform='translateY(0)';">
                        <div class="template-header" style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                            <div class="template-info">
                                <h4 style="color: #333; margin-bottom: 5px; font-size: 16px; margin: 0 0 5px 0;">ğŸ“‹ ${template.nome}</h4>
                                <p class="template-meta" style="color: #999; font-size: 11px; margin-bottom: 8px;">
                                    MÃ³dulos: ${template.modulos.length} | 
                                    Criado: ${this.formatarData(template.dataCriacao)} | 
                                    Ãšltima ediÃ§Ã£o: ${this.formatarData(template.dataEdicao)}
                                </p>
                                <p class="template-description" style="color: #666; font-size: 13px; line-height: 1.4; margin: 0;">
                                    ${template.descricao || 'Sem descriÃ§Ã£o'}
                                </p>
                            </div>
                            <div class="template-actions" style="display: flex; gap: 8px;">
                                <button class="btn-icon btn-preview" onclick="Templates.previewTemplate(${template.id})" title="Preview" style="
                                    width: 36px;
                                    height: 36px;
                                    border: none;
                                    border-radius: 8px;
                                    cursor: pointer;
                                    font-size: 16px;
                                    transition: all 0.2s ease;
                                    background: #f3e5f5;
                                " onmouseover="this.style.background='#9c27b0'; this.style.color='white'; this.style.transform='scale(1.1)';" 
                                   onmouseout="this.style.background='#f3e5f5'; this.style.color='inherit'; this.style.transform='scale(1)';">ğŸ‘ï¸</button>
                                <button class="btn-icon btn-edit" onclick="Templates.editarTemplate(${template.id})" title="Editar" style="
                                    width: 36px;
                                    height: 36px;
                                    border: none;
                                    border-radius: 8px;
                                    cursor: pointer;
                                    font-size: 16px;
                                    transition: all 0.2s ease;
                                    background: #e3f2fd;
                                " onmouseover="this.style.background='#2196f3'; this.style.transform='scale(1.1)';" 
                                   onmouseout="this.style.background='#e3f2fd'; this.style.transform='scale(1)';">âœï¸</button>
                                <button class="btn-icon btn-delete" onclick="Templates.deletarTemplate(${template.id})" title="Deletar" style="
                                    width: 36px;
                                    height: 36px;
                                    border: none;
                                    border-radius: 8px;
                                    cursor: pointer;
                                    font-size: 16px;
                                    transition: all 0.2s ease;
                                    background: #f9fafb;
                                " onmouseover="this.style.background='#f44336'; this.style.color='white'; this.style.transform='scale(1.1)';" 
                                   onmouseout="this.style.background='#ffebee'; this.style.color='inherit'; this.style.transform='scale(1)';">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                        <div class="template-modules-preview" style="display: flex; flex-wrap: wrap; gap: 6px;">
                            ${modulosPreview}
                        </div>
                    </div>
                `;
            },

            renderizarModulosPreview(modulosIds) {
                const MAX_TAGS = 3;
                let html = '';
                
                for (let i = 0; i < Math.min(modulosIds.length, MAX_TAGS); i++) {
                    const modulo = this.buscarModuloPorId(modulosIds[i]);
                    if (modulo) {
                        html += `<span class="module-tag" style="
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            padding: 4px 10px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 600;
                        ">${modulo.icone} ${modulo.nome}</span>`;
                    }
                }
                
                if (modulosIds.length > MAX_TAGS) {
                    html += `<span class="module-tag-more" style="
                        background: #e0e0e0;
                        color: #666;
                        padding: 4px 10px;
                        border-radius: 12px;
                        font-size: 11px;
                    ">+${modulosIds.length - MAX_TAGS} mÃ³dulos</span>`;
                }
                
                return html;
            },

            // ========================================
            // AÃ‡Ã•ES DE TEMPLATE
            // ========================================

            abrirCriarTemplate() {
                this.templateAtual = null;
                this.modulosSelecionados = [];
                
                document.getElementById('modal-title').textContent = 'âœ¨ Criar Novo Template';
                document.getElementById('template-nome').value = '';
                document.getElementById('template-descricao').value = '';
                
                this.renderizarModulosDisponiveis();
                this.renderizarModulosSelecionados();
                
                const modal = document.getElementById('modal-template');
                modal.style.display = 'flex';
                
                console.log('â• Modal de criar template aberto');
            },

            editarTemplate(templateId) {
                const template = this.templates.find(t => t.id === templateId);
                if (!template) {
                    console.error('âŒ Template nÃ£o encontrado:', templateId);
                    return;
                }
                
                this.templateAtual = template;
                this.modulosSelecionados = [...template.modulos];
                
                document.getElementById('modal-title').textContent = 'âœï¸ Editar Template';
                document.getElementById('template-nome').value = template.nome;
                document.getElementById('template-descricao').value = template.descricao || '';
                
                this.renderizarModulosDisponiveis();
                this.renderizarModulosSelecionados();
                
                const modal = document.getElementById('modal-template');
                modal.style.display = 'flex';
                
                console.log('âœï¸ Template aberto para ediÃ§Ã£o:', template.nome);
            },

            deletarTemplate(templateId) {
                const template = this.templates.find(t => t.id === templateId);
                if (!template) return;
                
                if (confirm(`ğŸ—‘ï¸ Tem certeza que deseja deletar o template "${template.nome}"?\n\nEsta aÃ§Ã£o nÃ£o pode ser desfeita!`)) {
                    this.templates = this.templates.filter(t => t.id !== templateId);
                    this.salvarTemplates();
                    this.renderizarTemplates();
                    Sistema.notificar('âœ… Template deletado com sucesso!');
                    console.log('ğŸ—‘ï¸ Template deletado:', template.nome);
                }
            },

            previewTemplate(templateId) {
                const template = this.templates.find(t => t.id === templateId);
                if (!template) {
                    console.error('âŒ Template nÃ£o encontrado:', templateId);
                    return;
                }
                
                // Gerar preview detalhado de mÃ³dulos COM CAMPOS
                let modulosHTML = '';
                let numeroModulo = 1; // Contador separado para mÃ³dulos (nÃ£o contar tÃ­tulos)
                
                template.modulos.forEach((item, index) => {
                    // Se for TÃTULO: renderizar como seÃ§Ã£o separadora
                    if (typeof item === 'object' && item.tipo === 'titulo') {
                        modulosHTML += `
                            <div style="
                                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                color: white;
                                padding: 16px 24px;
                                border-radius: 10px;
                                margin: ${index === 0 ? '0' : '30px'} 0 20px 0;
                                font-weight: 700;
                                font-size: 16px;
                                text-transform: uppercase;
                                letter-spacing: 1.8px;
                                box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
                                display: flex;
                                align-items: center;
                            ">
                                <span style="font-size: 22px; margin-right: 12px;">${item.icone}</span>
                                <span>${item.texto}</span>
                            </div>
                        `;
                    }
                    // Se for MÃ“DULO: renderizar normalmente
                    else {
                        const modulo = this.buscarModuloPorId(item);
                        if (modulo) {
                            modulosHTML += this.renderizarModuloPreviewDetalhado(modulo, numeroModulo);
                            numeroModulo++; // Incrementar apenas para mÃ³dulos
                        }
                    }
                });
                
                // Criar modal de preview COMPLETO
                const modalHTML = `
                    <div id="modal-preview" style="
                        display: flex;
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0, 0, 0, 0.5);
                        z-index: 1001;
                        align-items: center;
                        justify-content: center;
                    " onclick="if(event.target.id==='modal-preview') this.remove();">
                        <div style="
                            background: white;
                            border-radius: 16px;
                            max-height: 90vh;
                            overflow: hidden;
                            display: flex;
                            flex-direction: column;
                            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                            width: 95%;
                            max-width: 1000px;
                        " onclick="event.stopPropagation();">
                            <div style="
                                padding: 20px 30px;
                                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                color: white;
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                            ">
                                <div>
                                    <h3 style="margin: 0 0 5px 0;">ğŸ‘ï¸ Preview: ${template.nome}</h3>
                                    <p style="margin: 0; font-size: 12px; opacity: 0.9;">VisualizaÃ§Ã£o de como ficarÃ¡ no atendimento</p>
                                </div>
                                <button onclick="document.getElementById('modal-preview').remove();" style="
                                    background: none;
                                    border: none;
                                    color: white;
                                    font-size: 28px;
                                    cursor: pointer;
                                    padding: 0;
                                    width: 32px;
                                    height: 32px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    border-radius: 50%;
                                    transition: background 0.2s;
                                " onmouseover="this.style.background='rgba(255,255,255,0.2)';" 
                                   onmouseout="this.style.background='none';">&times;</button>
                            </div>
                            <div style="padding: 25px 30px; overflow-y: auto; flex: 1; background: #f8f9fa;">
                                <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; border-left: 4px solid #667eea;">
                                    <p style="color: #666; font-size: 14px; margin: 0 0 8px 0; line-height: 1.6;">${template.descricao || 'Sem descriÃ§Ã£o'}</p>
                                    <p style="color: #999; font-size: 12px; margin: 0;">
                                        ğŸ“Š ${template.modulos.length} mÃ³dulo(s) â€¢ 
                                        ğŸ“… Criado: ${this.formatarData(template.dataCriacao)} â€¢ 
                                        âœï¸ Editado: ${this.formatarData(template.dataEdicao)}
                                    </p>
                                </div>
                                <div style="background: #f9fafb; border-radius: 8px; padding: 12px 16px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
                                    <p style="margin: 0; font-size: 13px; color: #856404;">
                                        <strong>ğŸ’¡ AtenÃ§Ã£o:</strong> Esta Ã© uma <strong>visualizaÃ§Ã£o simulada</strong>. 
                                        Os campos nÃ£o sÃ£o funcionais neste preview, mas mostram exatamente como aparecerÃ£o no atendimento real.
                                    </p>
                                </div>
                                ${modulosHTML}
                            </div>
                            <div style="
                                padding: 20px 30px;
                                border-top: 1px solid #e0e0e0;
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                background: white;
                            ">
                                <div style="color: #666; font-size: 13px;">
                                    <strong>${template.modulos.length}</strong> mÃ³dulo(s) serÃ£o carregados no atendimento
                                </div>
                                <div style="display: flex; gap: 12px;">
                                    <button onclick="Templates.editarTemplate(${template.id}); document.getElementById('modal-preview').remove();" style="
                                        padding: 12px 24px;
                                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                        color: white;
                                        border: none;
                                        border-radius: 8px;
                                        font-size: 14px;
                                        font-weight: 600;
                                        cursor: pointer;
                                        transition: all 0.2s;
                                    " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(102, 126, 234, 0.3)';" 
                                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none';">âœï¸ Editar Template</button>
                                    <button onclick="document.getElementById('modal-preview').remove();" style="
                                        padding: 12px 24px;
                                        background: #e0e0e0;
                                        color: #333;
                                        border: none;
                                        border-radius: 8px;
                                        font-size: 14px;
                                        font-weight: 600;
                                        cursor: pointer;
                                        transition: all 0.2s;
                                    " onmouseover="this.style.background='#d0d0d0';" 
                                       onmouseout="this.style.background='#e0e0e0';">âŒ Fechar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Remover modal anterior se existir
                const modalAntigo = document.getElementById('modal-preview');
                if (modalAntigo) modalAntigo.remove();
                
                // Adicionar novo modal
                document.body.insertAdjacentHTML('beforeend', modalHTML);
                
                console.log('ğŸ‘ï¸ Preview detalhado aberto:', template.nome);
            },

            // Renderizar mÃ³dulo com campos detalhados para preview
            renderizarModuloPreviewDetalhado(modulo, numero) {
                let submdulosHTML = '';
                
                // Se mÃ³dulo tem submÃ³dulos, renderizar cada um
                if (modulo.submodulos && modulo.submodulos.length > 0) {
                    submdulosHTML = modulo.submodulos.map(sub => `
                        <div style="margin-left: 20px; margin-top: 15px; padding-left: 15px; border-left: 3px solid #e0e0e0;">
                            <h5 style="font-size: 13px; color: #667eea; margin: 0 0 10px 0; font-weight: 600;">
                                â–¸ ${sub.nome}
                            </h5>
                            ${this.renderizarCamposExemplo(sub.id)}
                        </div>
                    `).join('');
                }
                
                return `
                    <div style="
                        background: white;
                        border-radius: 12px;
                        padding: 20px;
                        margin-bottom: 16px;
                        border: 1px solid #e0e0e0;
                        transition: all 0.3s ease;
                    ">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <div style="
                                width: 32px;
                                height: 32px;
                                border-radius: 8px;
                                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                color: white;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-weight: 700;
                                margin-right: 12px;
                                font-size: 14px;
                            ">${numero}</div>
                            <span style="font-size: 20px; margin-right: 10px;">${modulo.icone}</span>
                            <h4 style="margin: 0; font-size: 16px; color: #333; font-weight: 600;">${modulo.nome}</h4>
                            ${modulo.submodulos && modulo.submodulos.length > 0 ? 
                                `<span style="
                                    margin-left: 10px;
                                    background: #667eea;
                                    color: white;
                                    padding: 2px 8px;
                                    border-radius: 12px;
                                    font-size: 11px;
                                    font-weight: 600;
                                ">${modulo.submodulos.length} submÃ³dulos</span>` 
                                : ''}
                        </div>
                        
                        ${!modulo.submodulos || modulo.submodulos.length === 0 ? this.renderizarCamposExemplo(modulo.id) : ''}
                        ${submdulosHTML}
                    </div>
                `;
            },

            // Renderizar campos de exemplo baseado no tipo de mÃ³dulo
            renderizarCamposExemplo(moduloId) {
                // Campos especÃ­ficos por tipo de mÃ³dulo
                const camposPorModulo = {
                    // ANAMNESE
                    'queixa': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Queixa Principal:</label>
                        <textarea disabled placeholder="Ex: Dor abdominal hÃ¡ 3 dias..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'historia-atual': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">HistÃ³ria da DoenÃ§a Atual (HDA):</label>
                        <textarea disabled placeholder="Narrativa cronolÃ³gica dos sintomas..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 120px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'expectativas': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Expectativas do Paciente:</label>
                        <textarea disabled placeholder="O que o paciente espera deste atendimento..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 60px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    
                    // QUANTIFICAÃ‡ÃƒO - O QUE VOCÃŠ PEDIU!
                    'quantificacao': `
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Volume (ml):</label>
                                <input type="number" disabled placeholder="Ex: 450" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                            </div>
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Peso (gramas):</label>
                                <input type="number" disabled placeholder="Ex: 350" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                            </div>
                        </div>
                        <div style="margin-top: 10px;">
                            <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">ObservaÃ§Ãµes sobre quantificaÃ§Ã£o:</label>
                            <textarea disabled placeholder="Detalhes adicionais sobre medidas..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 60px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                        </div>
                    `,
                    'material-retirado': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Material Retirado/Ressecado:</label>
                        <textarea disabled placeholder="Descreva o material cirÃºrgico retirado..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                        <div style="margin-top: 10px;">
                            <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Peso do espÃ©cime (g):</label>
                            <input type="number" disabled placeholder="Ex: 450" style="width: 200px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                        </div>
                    `,
                    'perdas-sanguineas': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Perdas SanguÃ­neas Estimadas (ml):</label>
                        <input type="number" disabled placeholder="Ex: 350" style="width: 200px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                    `,
                    'volume-infundido': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Volume Total Infundido (ml):</label>
                        <input type="number" disabled placeholder="Ex: 2000" style="width: 200px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                        <div style="margin-top: 10px;">
                            <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Especificar fluidos:</label>
                            <textarea disabled placeholder="Ex: Ringer Lactato 1500ml, SF 0.9% 500ml" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 60px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                        </div>
                    `,
                    'diurese': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Diurese IntraoperatÃ³ria (ml):</label>
                        <input type="number" disabled placeholder="Ex: 400" style="width: 200px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                    `,
                    'tempo-cirurgico': `
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">InÃ­cio:</label>
                                <input type="time" disabled style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                            </div>
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">TÃ©rmino:</label>
                                <input type="time" disabled style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                            </div>
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">DuraÃ§Ã£o:</label>
                                <input type="text" disabled placeholder="Ex: 3h30min" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                            </div>
                        </div>
                    `,
                    
                    // EXAMES
                    'exame-geral': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Exame FÃ­sico Geral:</label>
                        <textarea disabled placeholder="Estado geral, consciÃªncia, hidrataÃ§Ã£o, coloraÃ§Ã£o..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'exame-especifico': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Exame EspecÃ­fico da Especialidade:</label>
                        <textarea disabled placeholder="Exame dirigido ao sistema/regiÃ£o..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 100px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'mapa-anatomico': `
                        <div style="background: #f5f3ff; padding: 12px; border-radius: 6px; border-left: 3px solid #8b5cf6;">
                            <label style="display: block; font-size: 13px; color: #6d28d9; font-weight: 600; margin-bottom: 6px;">ğŸ—ºï¸ Mapa AnatÃ´mico:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 8px;">
                                <div style="background: #e9e4f5; height: 80px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #888; font-size: 11px;">[Silhueta Anterior]</div>
                                <div style="background: #e9e4f5; height: 80px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #888; font-size: 11px;">[Silhueta Posterior]</div>
                            </div>
                            <textarea disabled placeholder="DescriÃ§Ã£o das lesÃµes marcadas..." style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 4px; font-size: 12px; min-height: 40px; background: #faf8ff; color: #999;"></textarea>
                        </div>
                    `,
                    'avaliacao-queimaduras': `
                        <div style="background: #fef2f2; padding: 12px; border-radius: 6px; border-left: 3px solid #ef4444;">
                            <label style="display: block; font-size: 13px; color: #dc2626; font-weight: 600; margin-bottom: 6px;">ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                <div style="text-align: center;"><div style="font-size: 10px; color: #888;">SCQ Total</div><div style="background: #fee2e2; padding: 6px; border-radius: 4px; font-weight: bold; color: #999;">__%</div></div>
                                <div style="text-align: center;"><div style="font-size: 10px; color: #888;">1Âº Grau</div><div style="background: #fee2e2; padding: 6px; border-radius: 4px; color: #999;">__%</div></div>
                                <div style="text-align: center;"><div style="font-size: 10px; color: #888;">2Âº Grau</div><div style="background: #fee2e2; padding: 6px; border-radius: 4px; color: #999;">__%</div></div>
                                <div style="text-align: center;"><div style="font-size: 10px; color: #888;">3Âº Grau</div><div style="background: #fee2e2; padding: 6px; border-radius: 4px; color: #999;">__%</div></div>
                            </div>
                            <textarea disabled placeholder="Agente causador, Ã¡reas acometidas..." style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 4px; font-size: 12px; min-height: 40px; background: #fff5f5; color: #999;"></textarea>
                        </div>
                    `,
                    'avaliacao-feridas': `
                        <div style="background: #fffbeb; padding: 12px; border-radius: 6px; border-left: 3px solid #f59e0b;">
                            <label style="display: block; font-size: 13px; color: #d97706; font-weight: 600; margin-bottom: 6px;">ğŸ©¹ AvaliaÃ§Ã£o de Feridas:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                <div><div style="font-size: 10px; color: #888;">Tipo</div><div style="background: #fef3c7; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Selecione...</div></div>
                                <div><div style="font-size: 10px; color: #888;">DimensÃµes</div><div style="background: #fef3c7; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">__x__x__ cm</div></div>
                                <div><div style="font-size: 10px; color: #888;">Leito</div><div style="background: #fef3c7; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Selecione...</div></div>
                            </div>
                            <textarea disabled placeholder="LocalizaÃ§Ã£o, bordas, exsudato..." style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 4px; font-size: 12px; min-height: 40px; background: #fffef5; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-cardiovascular': `
                        <div style="background: #fef2f2; padding: 12px; border-radius: 6px; border-left: 3px solid #dc2626;">
                            <label style="display: block; font-size: 13px; color: #dc2626; font-weight: 600; margin-bottom: 6px;">ğŸ«€ Exame Cardiovascular:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                <div><div style="font-size: 10px; color: #888;">Ritmo</div><div style="background: #fee2e2; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Regular, 2T</div></div>
                                <div><div style="font-size: 10px; color: #888;">Bulhas</div><div style="background: #fee2e2; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">NormofonÃ©ticas</div></div>
                            </div>
                            <textarea disabled placeholder="Sopros, pulsos, edema..." style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 4px; font-size: 12px; min-height: 40px; background: #fff5f5; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-respiratorio': `
                        <div style="background: #f0f9ff; padding: 12px; border-radius: 6px; border-left: 3px solid #0ea5e9;">
                            <label style="display: block; font-size: 13px; color: #0284c7; font-weight: 600; margin-bottom: 6px;">ğŸ« Exame RespiratÃ³rio:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                <div><div style="font-size: 10px; color: #888;">MV</div><div style="background: #e0f2fe; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Presente bilateral</div></div>
                                <div><div style="font-size: 10px; color: #888;">RA</div><div style="background: #e0f2fe; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Ausentes</div></div>
                            </div>
                            <textarea disabled placeholder="Expansibilidade, percussÃ£o..." style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 4px; font-size: 12px; min-height: 40px; background: #f5fbff; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-abdominal': `
                        <div style="background: #f0fdf4; padding: 12px; border-radius: 6px; border-left: 3px solid #22c55e;">
                            <label style="display: block; font-size: 13px; color: #16a34a; font-weight: 600; margin-bottom: 6px;">ğŸ©º Exame Abdominal:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 6px; margin-bottom: 8px;">
                                <div><div style="font-size: 9px; color: #888;">InspeÃ§Ã£o</div><div style="background: #dcfce7; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">Plano</div></div>
                                <div><div style="font-size: 9px; color: #888;">RHA</div><div style="background: #dcfce7; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">+</div></div>
                                <div><div style="font-size: 9px; color: #888;">PalpaÃ§Ã£o</div><div style="background: #dcfce7; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">Indolor</div></div>
                                <div><div style="font-size: 9px; color: #888;">Viscero</div><div style="background: #dcfce7; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">Ausente</div></div>
                            </div>
                            <textarea disabled placeholder="Massas, hÃ©rnias, sinais..." style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 4px; font-size: 12px; min-height: 40px; background: #f5fff8; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-neurologico': `
                        <div style="background: #faf5ff; padding: 12px; border-radius: 6px; border-left: 3px solid #a855f7;">
                            <label style="display: block; font-size: 13px; color: #9333ea; font-weight: 600; margin-bottom: 6px;">ğŸ§  Exame NeurolÃ³gico:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 6px; margin-bottom: 8px;">
                                <div><div style="font-size: 9px; color: #888;">ConsciÃªncia</div><div style="background: #f3e8ff; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">Alerta</div></div>
                                <div><div style="font-size: 9px; color: #888;">Pupilas</div><div style="background: #f3e8ff; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">IsocÃ³ricas</div></div>
                                <div><div style="font-size: 9px; color: #888;">ForÃ§a</div><div style="background: #f3e8ff; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">Grau V</div></div>
                            </div>
                            <textarea disabled placeholder="Reflexos, sensibilidade, marcha..." style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 4px; font-size: 12px; min-height: 40px; background: #fdfaff; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-ortopedico': `
                        <div style="background: #fafaf9; padding: 12px; border-radius: 6px; border-left: 3px solid #78716c;">
                            <label style="display: block; font-size: 13px; color: #57534e; font-weight: 600; margin-bottom: 6px;">ğŸ¦´ Exame OrtopÃ©dico:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                <div><div style="font-size: 10px; color: #888;">RegiÃ£o</div><div style="background: #f5f5f4; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Selecione...</div></div>
                                <div><div style="font-size: 10px; color: #888;">Lateralidade</div><div style="background: #f5f5f4; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">D / E / Bilateral</div></div>
                            </div>
                            <textarea disabled placeholder="InspeÃ§Ã£o, palpaÃ§Ã£o, ADM, testes especiais..." style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 4px; font-size: 12px; min-height: 40px; background: #fdfdfb; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-vascular': `
                        <div style="background: #fff1f2; padding: 12px; border-radius: 6px; border-left: 3px solid #be123c;">
                            <label style="display: block; font-size: 13px; color: #be123c; font-weight: 600; margin-bottom: 6px;">ğŸ©¸ Exame Vascular PerifÃ©rico:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                <div><div style="font-size: 10px; color: #888;">Pulsos</div><div style="background: #ffe4e6; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Presentes</div></div>
                                <div><div style="font-size: 10px; color: #888;">PerfusÃ£o</div><div style="background: #ffe4e6; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">TEC < 3s</div></div>
                            </div>
                            <textarea disabled placeholder="Edema, varizes, Ãºlceras, ITB..." style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 4px; font-size: 12px; min-height: 40px; background: #fff8f8; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-dermatologico': `
                        <div style="background: #fdf2f8; padding: 12px; border-radius: 6px; border-left: 3px solid #ec4899;">
                            <label style="display: block; font-size: 13px; color: #db2777; font-weight: 600; margin-bottom: 6px;">ğŸ”¬ Exame DermatolÃ³gico:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                <div><div style="font-size: 10px; color: #888;">LesÃ£o elementar</div><div style="background: #fce7f3; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Selecione...</div></div>
                                <div><div style="font-size: 10px; color: #888;">DistribuiÃ§Ã£o</div><div style="background: #fce7f3; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Localizada</div></div>
                            </div>
                            <textarea disabled placeholder="Cor, tamanho, bordas, superfÃ­cie..." style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 4px; font-size: 12px; min-height: 40px; background: #fefafc; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-oftalmologico': `
                        <div style="background: #ecfeff; padding: 12px; border-radius: 6px; border-left: 3px solid #0891b2;">
                            <label style="display: block; font-size: 13px; color: #0e7490; font-weight: 600; margin-bottom: 6px;">ğŸ‘ï¸ Exame OftalmolÃ³gico:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 6px; margin-bottom: 8px;">
                                <div><div style="font-size: 9px; color: #888;">AV OD</div><div style="background: #cffafe; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">20/__</div></div>
                                <div><div style="font-size: 9px; color: #888;">AV OE</div><div style="background: #cffafe; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">20/__</div></div>
                                <div><div style="font-size: 9px; color: #888;">Reflexos</div><div style="background: #cffafe; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">+</div></div>
                            </div>
                            <textarea disabled placeholder="Biomicroscopia, fundoscopia..." style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 4px; font-size: 12px; min-height: 40px; background: #f5feff; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-otorrino': `
                        <div style="background: #f5f3ff; padding: 12px; border-radius: 6px; border-left: 3px solid #7c3aed;">
                            <label style="display: block; font-size: 13px; color: #6d28d9; font-weight: 600; margin-bottom: 6px;">ğŸ‘‚ Exame OtorrinolaringolÃ³gico:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 6px; margin-bottom: 8px;">
                                <div><div style="font-size: 9px; color: #888;">Otoscopia</div><div style="background: #ede9fe; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">Normal</div></div>
                                <div><div style="font-size: 9px; color: #888;">Rinoscopia</div><div style="background: #ede9fe; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">Normal</div></div>
                                <div><div style="font-size: 9px; color: #888;">Orofaringe</div><div style="background: #ede9fe; padding: 4px; border-radius: 4px; color: #999; font-size: 10px;">Normal</div></div>
                            </div>
                            <textarea disabled placeholder="Acumetria, palpaÃ§Ã£o cervical..." style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 4px; font-size: 12px; min-height: 40px; background: #fdfcff; color: #999;"></textarea>
                        </div>
                    `,
                    'exame-bucomaxilo': `
                        <div style="background: #ecfdf5; padding: 12px; border-radius: 6px; border-left: 3px solid #059669;">
                            <label style="display: block; font-size: 13px; color: #047857; font-weight: 600; margin-bottom: 6px;">ğŸ¦· Exame Bucomaxilofacial:</label>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                                <div><div style="font-size: 10px; color: #888;">Abertura bucal</div><div style="background: #d1fae5; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Normal >40mm</div></div>
                                <div><div style="font-size: 10px; color: #888;">ATM</div><div style="background: #d1fae5; padding: 6px; border-radius: 4px; color: #999; font-size: 11px;">Sem alteraÃ§Ãµes</div></div>
                            </div>
                            <textarea disabled placeholder="Face, oclusÃ£o, mucosa oral..." style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 4px; font-size: 12px; min-height: 40px; background: #f5fffa; color: #999;"></textarea>
                        </div>
                    `,
                    
                    // DIAGNÃ“STICO
                    'hipotese-diagnostica': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">HipÃ³tese(s) DiagnÃ³stica(s):</label>
                        <textarea disabled placeholder="Ex: 1. Apendicite aguda (CID K35)\n2. Gastroenterite..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'conduta': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Conduta:</label>
                        <textarea disabled placeholder="Plano terapÃªutico, orientaÃ§Ãµes, retorno..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 100px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'prescricao': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">PrescriÃ§Ã£o/Receita:</label>
                        <textarea disabled placeholder="1. Medicamento - dose - via - frequÃªncia\n2. ..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 120px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    
                    // CIRÃšRGICO
                    'descricao-operatoria': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">DescriÃ§Ã£o OperatÃ³ria Detalhada:</label>
                        <textarea disabled placeholder="DescriÃ§Ã£o completa do ato cirÃºrgico..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 150px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'incisao-acesso': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">IncisÃ£o e Via de Acesso:</label>
                        <textarea disabled placeholder="Tipo de incisÃ£o, localizaÃ§Ã£o, extensÃ£o..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'achados-intra': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Achados IntraoperatÃ³rios:</label>
                        <textarea disabled placeholder="DescriÃ§Ã£o dos achados durante a cirurgia..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 100px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'tecnica-operatoria': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">TÃ©cnica OperatÃ³ria:</label>
                        <textarea disabled placeholder="Passo a passo do procedimento cirÃºrgico..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 120px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'sintese': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">SÃ­ntese e Fechamento:</label>
                        <textarea disabled placeholder="Planos de fechamento, fios utilizados..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'anatomopatologico': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Material Enviado para AnatomopatolÃ³gico:</label>
                        <textarea disabled placeholder="DescriÃ§Ã£o dos espÃ©cimes enviados..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'intercorrencias': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">IntercorrÃªncias IntraoperatÃ³rias:</label>
                        <textarea disabled placeholder="Eventos adversos ou complicaÃ§Ãµes durante a cirurgia..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'drenos-tipo': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Tipo de Drenos:</label>
                        <input type="text" disabled placeholder="Ex: Portovac, Penrose, Blake..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                    `,
                    'drenos-localizacao': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">LocalizaÃ§Ã£o dos Drenos:</label>
                        <textarea disabled placeholder="Onde foram posicionados os drenos..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 60px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    
                    // EMERGÃŠNCIA
                    'mecanismo-trauma': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Mecanismo de Trauma:</label>
                        <textarea disabled placeholder="Como ocorreu o trauma, cinemÃ¡tica..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'escala-coma-glasgow': `
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Abertura Ocular:</label>
                                <input type="number" disabled placeholder="1-4" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                            </div>
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Resposta Verbal:</label>
                                <input type="number" disabled placeholder="1-5" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                            </div>
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Resposta Motora:</label>
                                <input type="number" disabled placeholder="1-6" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999;">
                            </div>
                            <div>
                                <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Total:</label>
                                <input type="number" disabled placeholder="3-15" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; background: #f8f9fa; color: #999; font-weight: 600;">
                            </div>
                        </div>
                    `,
                    'via-aerea': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Via AÃ©rea e Coluna Cervical:</label>
                        <textarea disabled placeholder="AvaliaÃ§Ã£o e manejo da via aÃ©rea..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    
                    // INTERNAÃ‡ÃƒO
                    'subjetivo': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Subjetivo (Queixas do Paciente):</label>
                        <textarea disabled placeholder="Relato do paciente, sintomas..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'objetivo': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Objetivo (Exame FÃ­sico e Dados):</label>
                        <textarea disabled placeholder="Sinais vitais, exame fÃ­sico..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'avaliacao': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">AvaliaÃ§Ã£o (ImpressÃ£o ClÃ­nica):</label>
                        <textarea disabled placeholder="AnÃ¡lise e diagnÃ³stico..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 60px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    'plano': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Plano (Conduta):</label>
                        <textarea disabled placeholder="Plano terapÃªutico e acompanhamento..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    
                    // COMPLEMENTAR
                    'fotos-paciente': `
                        <div style="border: 2px dashed #e0e0e0; border-radius: 8px; padding: 30px; text-align: center; background: #f8f9fa;">
                            <span style="font-size: 48px; opacity: 0.3;">ğŸ“¸</span>
                            <p style="margin: 10px 0 0 0; color: #999; font-size: 13px;">Ãrea para upload de fotos</p>
                        </div>
                    `,
                    'exames-realizados': `
                        <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Exames Realizados/Solicitados:</label>
                        <textarea disabled placeholder="Lista de exames, resultados..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 100px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                    `,
                    
                    // CONTROLE PÃ“S-OPERATÃ“RIO (DPO)
                    'controle-pos-operatorio': `
                        <div style="background: #f8f9fa; border: 2px solid #667eea; border-radius: 8px; padding: 16px; margin-bottom: 12px;">
                            <h6 style="margin: 0 0 12px 0; color: #667eea; font-size: 13px; font-weight: 600;">ğŸ“… Cirurgias Realizadas</h6>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border-left: 4px solid #667eea;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <strong style="color: #333; font-size: 13px;">Apendicectomia VideolaparoscÃ³pica</strong>
                                    <span style="background: #667eea; color: white; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">D6</span>
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 12px; color: #666;">
                                    <div>ğŸ“… Data: 02/11/2025</div>
                                    <div>ğŸ‘¨â€âš•ï¸ CirurgiÃ£o: Dr. Fernando</div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; border-left: 4px solid #4caf50;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <strong style="color: #333; font-size: 13px;">Drenagem de Abscesso</strong>
                                    <span style="background: #4caf50; color: white; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">D1</span>
                                </div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 12px; color: #666;">
                                    <div>ğŸ“… Data: 07/11/2025</div>
                                    <div>ğŸ‘¨â€âš•ï¸ CirurgiÃ£o: Dr. Fernando</div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 12px; padding: 10px; background: #f9fafb; border-radius: 6px; border-left: 3px solid #ffc107;">
                                <p style="margin: 0; font-size: 12px; color: #856404;">
                                    ğŸ’¡ <strong>CÃ¡lculo automÃ¡tico:</strong> O sistema calcula automaticamente D0, D1, D2... baseado na data atual vs data da cirurgia
                                </p>
                            </div>
                            
                            <button disabled style="width: 100%; margin-top: 10px; padding: 8px; background: #e0e0e0; border: none; border-radius: 6px; font-size: 12px; color: #999; cursor: not-allowed;">
                                Adicionar Cirurgia (funcional no atendimento)
                            </button>
                        </div>
                    `,
                    
                    // CONTROLE DE ANTIBIOTICOTERAPIA
                    'controle-antibioticos': `
                        <div style="background: #f8f9fa; border: 2px solid #9c27b0; border-radius: 8px; padding: 16px;">
                            <h6 style="margin: 0 0 12px 0; color: #9c27b0; font-size: 13px; font-weight: 600;">ğŸ’Š Controle de AntibiÃ³ticos</h6>
                            
                            <div style="background: #e8f5e9; border-radius: 6px; padding: 12px; margin-bottom: 12px; border-left: 4px solid #4caf50;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                    <strong style="color: #2e7d32; font-size: 13px;">ğŸŸ¢ EM USO</strong>
                                    <span style="background: #4caf50; color: white; padding: 2px 8px; border-radius: 10px; font-size: 10px; font-weight: 600;">1 ATB</span>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border-left: 4px solid #4caf50;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <strong style="color: #333; font-size: 13px;">Ceftriaxone</strong>
                                    <span style="background: #4caf50; color: white; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">D6</span>
                                </div>
                                <div style="font-size: 12px; color: #666; margin-bottom: 6px;">
                                    <div>ğŸ’Š Dose: 1g de 12/12h</div>
                                    <div>ğŸ’‰ Via: Endovenosa</div>
                                    <div>ğŸ“… InÃ­cio: 02/11/2025</div>
                                </div>
                            </div>
                            
                            <div style="background: #f9fafb; border-radius: 6px; padding: 12px; margin-bottom: 12px; border-left: 4px solid #f44336;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                                    <strong style="color: #c62828; font-size: 13px;">ğŸ”´ SUSPENSOS</strong>
                                    <span style="background: #f44336; color: white; padding: 2px 8px; border-radius: 10px; font-size: 10px; font-weight: 600;">1 ATB</span>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border-left: 4px solid #f44336; opacity: 0.7;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <strong style="color: #333; font-size: 13px; text-decoration: line-through;">Meropenem</strong>
                                    <span style="background: #999; color: white; padding: 3px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">2 dias</span>
                                </div>
                                <div style="font-size: 12px; color: #666;">
                                    <div>ğŸ“… PerÃ­odo: 05/11/2025 a 07/11/2025</div>
                                    <div>â±ï¸ DuraÃ§Ã£o total: 2 dias</div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 12px; padding: 10px; background: #f9fafb; border-radius: 6px; border-left: 3px solid #ffc107;">
                                <p style="margin: 0; font-size: 12px; color: #856404;">
                                    ğŸ’¡ <strong>CÃ¡lculo automÃ¡tico:</strong> O sistema calcula D0, D1, D2... para cada antibiÃ³tico baseado na data de inÃ­cio
                                </p>
                            </div>
                            
                            <button disabled style="width: 100%; margin-top: 10px; padding: 8px; background: #e0e0e0; border: none; border-radius: 6px; font-size: 12px; color: #999; cursor: not-allowed;">
                                â• Adicionar AntibiÃ³tico (funcional no atendimento)
                            </button>
                        </div>
                    `,
                    
                    // SUBMÃ“DULOS DE ANTIBIÃ“TICOS
                    'atb-em-uso': `
                        <div style="background: #e8f5e9; border-radius: 6px; padding: 12px; border-left: 4px solid #4caf50;">
                            <h6 style="margin: 0 0 10px 0; color: #2e7d32; font-size: 13px; font-weight: 600;">ğŸŸ¢ AntibiÃ³ticos em Uso</h6>
                            
                            <div style="background: white; border-radius: 4px; padding: 10px; margin-bottom: 8px;">
                                <div style="font-size: 12px; color: #666;">
                                    <div style="margin-bottom: 4px;"><strong>Ceftriaxone 1g 12/12h</strong> - D6</div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px; font-size: 11px;">
                                        <div>ğŸ’‰ Via: EV</div>
                                        <div>ğŸ“… Desde: 02/11/2025</div>
                                    </div>
                                </div>
                            </div>
                            
                            <p style="margin: 8px 0 0 0; font-size: 11px; color: #666; font-style: italic;">
                                Lista de antibiÃ³ticos atualmente em uso pelo paciente
                            </p>
                        </div>
                    `,
                    'atb-suspensos': `
                        <div style="background: #f9fafb; border-radius: 6px; padding: 12px; border-left: 4px solid #f44336;">
                            <h6 style="margin: 0 0 10px 0; color: #c62828; font-size: 13px; font-weight: 600;">ğŸ”´ AntibiÃ³ticos Suspensos</h6>
                            
                            <div style="background: white; border-radius: 4px; padding: 10px; margin-bottom: 8px; opacity: 0.7;">
                                <div style="font-size: 12px; color: #666;">
                                    <div style="margin-bottom: 4px;"><strong style="text-decoration: line-through;">Meropenem 1g 12/12h</strong></div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px; font-size: 11px;">
                                        <div>ğŸ“… 05/11 a 07/11</div>
                                        <div>â±ï¸ 2 dias de uso</div>
                                    </div>
                                </div>
                            </div>
                            
                            <p style="margin: 8px 0 0 0; font-size: 11px; color: #666; font-style: italic;">
                                HistÃ³rico de antibiÃ³ticos jÃ¡ suspensos
                            </p>
                        </div>
                    `,
                    
                    // ========================================
                    // MÃ“DULOS GRANULARES - HISTÃ“RIA PREGRESSA
                    // ========================================
                    
                    'alergias': `
                        <div style="background: #fff3e0; border-radius: 8px; padding: 15px; border-left: 4px solid #ff9800;">
                            <h5 style="margin: 0 0 12px 0; color: #e65100; font-size: 14px; font-weight: 600;">ğŸ©º Alergias</h5>
                            
                            <div style="background: #fffbf5; border-radius: 6px; padding: 10px; margin-bottom: 12px; border: 1px solid #ffe0b2;">
                                <label style="display: block; font-size: 12px; color: #555; font-weight: 600; margin-bottom: 8px;">
                                    Possui alergias? <span style="color: #ff9800; font-weight: 700;">âœ“ Sim</span>
                                </label>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #ffe0b2;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ’Š</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Penicilina</div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Tipo:</strong> CutÃ¢nea (urticÃ¡ria)</div>
                                            <div><strong>Gravidade:</strong> <span style="color: #d32f2f; font-weight: 600;">Grave</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #ffe0b2;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ’Š</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Dipirona</div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Tipo:</strong> Anafilaxia</div>
                                            <div><strong>Gravidade:</strong> <span style="color: #d32f2f; font-weight: 600;">Grave</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; border: 1px solid #ffe0b2;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ¦</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Frutos do Mar</div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Tipo:</strong> Gastrointestinal</div>
                                            <div><strong>Gravidade:</strong> <span style="color: #f57c00; font-weight: 600;">Moderada</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button disabled style="width: 100%; margin-top: 12px; padding: 10px; background: #ff9800; color: white; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: not-allowed; opacity: 0.6;">
                                â• Adicionar Nova Alergia
                            </button>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos serÃ£o funcionais e editÃ¡veis
                            </p>
                        </div>
                    `,
                    
                    'doencas-previas': `
                        <div style="background: #e3f2fd; border-radius: 8px; padding: 15px; border-left: 4px solid #2196f3;">
                            <h5 style="margin: 0 0 12px 0; color: #0d47a1; font-size: 14px; font-weight: 600;">ğŸ¥ DoenÃ§as PrÃ©vias / Comorbidades</h5>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #bbdefb;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">â¤ï¸</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">HipertensÃ£o Arterial SistÃªmica</div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Desde:</strong> 2018 (7 anos)</div>
                                            <div><strong>Controlada:</strong> <span style="color: #4caf50; font-weight: 600;">âœ“ Sim</span></div>
                                        </div>
                                        <div style="margin-top: 6px; font-size: 11px; color: #666;">
                                            <strong>Tratamento:</strong> Losartana 50mg + Hidroclorotiazida 25mg
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #bbdefb;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ©¸</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Diabetes Mellitus tipo 2</div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Desde:</strong> 2020 (5 anos)</div>
                                            <div><strong>Controlada:</strong> <span style="color: #ff9800; font-weight: 600;">âš ï¸ Parcial</span></div>
                                        </div>
                                        <div style="margin-top: 6px; font-size: 11px; color: #666;">
                                            <strong>Tratamento:</strong> Metformina 850mg + Insulina NPH
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; border: 1px solid #bbdefb;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ«</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Asma BrÃ´nquica</div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Desde:</strong> InfÃ¢ncia</div>
                                            <div><strong>Controlada:</strong> <span style="color: #4caf50; font-weight: 600;">âœ“ Sim</span></div>
                                        </div>
                                        <div style="margin-top: 6px; font-size: 11px; color: #666;">
                                            <strong>Tratamento:</strong> Bombinha (Salbutamol) SOS
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button disabled style="width: 100%; margin-top: 12px; padding: 10px; background: #2196f3; color: white; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: not-allowed; opacity: 0.6;">
                                â• Adicionar DoenÃ§a/Comorbidade
                            </button>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos serÃ£o funcionais e editÃ¡veis
                            </p>
                        </div>
                    `,
                    
                    'cirurgias-previas': `
                        <div style="background: #f3e5f5; border-radius: 8px; padding: 15px; border-left: 4px solid #9c27b0;">
                            <h5 style="margin: 0 0 12px 0; color: #6a1b9a; font-size: 14px; font-weight: 600;">Cirurgias PrÃ©vias</h5>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #e1bee7;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ¥</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Apendicectomia</div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Data:</strong> MarÃ§o/2015</div>
                                            <div><strong>Local:</strong> Hospital Santa Casa</div>
                                        </div>
                                        <div style="margin-top: 6px; font-size: 11px; color: #666;">
                                            <strong>TÃ©cnica:</strong> VideolaparoscÃ³pica | <strong>EvoluÃ§Ã£o:</strong> Sem intercorrÃªncias
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #e1bee7;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ‘¶</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">CesÃ¡rea</div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Data:</strong> Janeiro/2019</div>
                                            <div><strong>Local:</strong> Maternidade Sofia Feldman</div>
                                        </div>
                                        <div style="margin-top: 6px; font-size: 11px; color: #666;">
                                            <strong>IndicaÃ§Ã£o:</strong> Sofrimento fetal | <strong>EvoluÃ§Ã£o:</strong> Boa recuperaÃ§Ã£o
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; border: 1px solid #e1bee7;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ¦·</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">ExtraÃ§Ã£o de Siso (4 elementos)</div>
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Data:</strong> Julho/2022</div>
                                            <div><strong>Local:</strong> ConsultÃ³rio OdontolÃ³gico</div>
                                        </div>
                                        <div style="margin-top: 6px; font-size: 11px; color: #666;">
                                            <strong>Anestesia:</strong> Local | <strong>EvoluÃ§Ã£o:</strong> Sem complicaÃ§Ãµes
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button disabled style="width: 100%; margin-top: 12px; padding: 10px; background: #9c27b0; color: white; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: not-allowed; opacity: 0.6;">
                                Adicionar Cirurgia PrÃ©via
                            </button>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos serÃ£o funcionais e editÃ¡veis
                            </p>
                        </div>
                    `,
                    
                    'medicacoes-uso': `
                        <div style="background: #e8f5e9; border-radius: 8px; padding: 15px; border-left: 4px solid #4caf50;">
                            <h5 style="margin: 0 0 12px 0; color: #2e7d32; font-size: 14px; font-weight: 600;">MedicaÃ§Ãµes em Uso ContÃ­nuo</h5>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #c8e6c9;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ’Š</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Losartana PotÃ¡ssica 50mg</div>
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Dose:</strong> 1 comprimido</div>
                                            <div><strong>Via:</strong> Oral</div>
                                            <div><strong>Freq:</strong> 12/12h</div>
                                        </div>
                                        <div style="margin-top: 6px; font-size: 11px; color: #666;">
                                            <strong>IndicaÃ§Ã£o:</strong> HipertensÃ£o Arterial | <strong>Desde:</strong> 2018
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #c8e6c9;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ’Š</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Metformina 850mg</div>
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Dose:</strong> 1 comprimido</div>
                                            <div><strong>Via:</strong> Oral</div>
                                            <div><strong>Freq:</strong> 8/8h</div>
                                        </div>
                                        <div style="margin-top: 6px; font-size: 11px; color: #666;">
                                            <strong>IndicaÃ§Ã£o:</strong> Diabetes Mellitus tipo 2 | <strong>Desde:</strong> 2020
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; border: 1px solid #c8e6c9;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ’‰</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Insulina NPH 100 UI/mL</div>
                                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; font-size: 11px; color: #666;">
                                            <div><strong>Dose:</strong> 20 UI</div>
                                            <div><strong>Via:</strong> SubcutÃ¢nea</div>
                                            <div><strong>Freq:</strong> 1x/dia (manhÃ£)</div>
                                        </div>
                                        <div style="margin-top: 6px; font-size: 11px; color: #666;">
                                            <strong>IndicaÃ§Ã£o:</strong> Diabetes Mellitus tipo 2 | <strong>Desde:</strong> 2023
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button disabled style="width: 100%; margin-top: 12px; padding: 10px; background: #667eea; color: white; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: not-allowed; opacity: 0.6;">
                                Adicionar MedicaÃ§Ã£o
                            </button>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos serÃ£o funcionais e editÃ¡veis
                            </p>
                        </div>
                    `,
                    
                    // ========================================
                    // MÃ“DULOS GRANULARES - HISTÃ“RIA SOCIAL
                    // ========================================
                    
                    'tabagismo': `
                        <div style="background: #efebe9; border-radius: 8px; padding: 15px; border-left: 4px solid #795548;">
                            <h5 style="margin: 0 0 12px 0; color: #3e2723; font-size: 14px; font-weight: 600;">ğŸš¬ Tabagismo</h5>
                            
                            <div style="background: #fff8f5; border-radius: 6px; padding: 12px; margin-bottom: 12px; border: 1px solid #d7ccc8;">
                                <label style="display: block; font-size: 12px; color: #555; font-weight: 600; margin-bottom: 8px;">
                                    Status: <span style="color: #d32f2f; font-weight: 700;">Fumante Atual</span>
                                </label>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 15px; border: 1px solid #d7ccc8;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">Cigarros/dia:</label>
                                        <div style="font-size: 20px; color: #d32f2f; font-weight: 700;">20</div>
                                    </div>
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">Anos fumando:</label>
                                        <div style="font-size: 20px; color: #d32f2f; font-weight: 700;">15</div>
                                    </div>
                                </div>
                                
                                <div style="background: #fff3e0; border-radius: 6px; padding: 12px; border-left: 4px solid #3b82f6;">
                                    <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">Carga TabÃ¡gica (calculado):</label>
                                    <div style="font-size: 24px; color: #e65100; font-weight: 700;">15 anos-maÃ§o</div>
                                    <p style="margin: 6px 0 0 0; font-size: 10px; color: #999; font-style: italic;">
                                        CÃ¡lculo: (20 cigarros/dia Ã— 15 anos) Ã· 20 = 15 anos-maÃ§o
                                    </p>
                                </div>
                                
                                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #d7ccc8;">
                                    <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 6px;">Tipo de cigarro:</label>
                                    <div style="font-size: 12px; color: #333;">Industrializado (com filtro)</div>
                                </div>
                                
                                <div style="margin-top: 8px;">
                                    <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 6px;">Tentativas prÃ©vias de parar:</label>
                                    <div style="font-size: 12px; color: #333;">Sim, 2 tentativas sem sucesso (2020 e 2023)</div>
                                </div>
                            </div>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos condicionais aparecem baseados no status (Nunca/Ex/Atual)
                            </p>
                        </div>
                    `,
                    
                    'etilismo': `
                        <div style="background: #fff3e0; border-radius: 8px; padding: 15px; border-left: 4px solid #ff9800;">
                            <h5 style="margin: 0 0 12px 0; color: #e65100; font-size: 14px; font-weight: 600;">ğŸº Etilismo</h5>
                            
                            <div style="background: #fffbf5; border-radius: 6px; padding: 12px; margin-bottom: 12px; border: 1px solid #ffe0b2;">
                                <label style="display: block; font-size: 12px; color: #555; font-weight: 600; margin-bottom: 8px;">
                                    Status: <span style="color: #f57c00; font-weight: 700;">Social</span>
                                </label>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 15px; border: 1px solid #ffe0b2;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">FrequÃªncia:</label>
                                        <div style="font-size: 13px; color: #333; font-weight: 600;">Semanal (fins de semana)</div>
                                    </div>
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">Quantidade:</label>
                                        <div style="font-size: 13px; color: #333; font-weight: 600;">4-6 doses/semana</div>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #ffe0b2;">
                                    <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 8px;">Tipo de bebida:</label>
                                    <div style="display: flex; flex-wrap: wrap; gap: 6px;">
                                        <span style="background: #fff3e0; padding: 4px 10px; border-radius: 12px; font-size: 11px; border: 1px solid #ffe0b2;">ğŸº Cerveja</span>
                                        <span style="background: #fff3e0; padding: 4px 10px; border-radius: 12px; font-size: 11px; border: 1px solid #ffe0b2;">ğŸ· Vinho</span>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 12px;">
                                    <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 6px;">ObservaÃ§Ãµes:</label>
                                    <div style="font-size: 12px; color: #666;">Consumo recreativo em eventos sociais</div>
                                </div>
                            </div>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos condicionais aparecem baseados no status
                            </p>
                        </div>
                    `,
                    
                    'drogas-ilicitas': `
                        <div style="background: #fbe9e7; border-radius: 8px; padding: 15px; border-left: 4px solid #d32f2f;">
                            <h5 style="margin: 0 0 12px 0; color: #b71c1c; font-size: 14px; font-weight: 600;">ğŸ’‰ Drogas IlÃ­citas</h5>
                            
                            <div style="background: white; border-radius: 6px; padding: 15px; border: 1px solid #ffccbc;">
                                <div style="text-align: center; padding: 20px;">
                                    <span style="font-size: 48px; opacity: 0.3;">âœ—</span>
                                    <p style="margin: 10px 0 0 0; font-size: 13px; color: #666; font-weight: 600;">
                                        Nega uso de drogas ilÃ­citas
                                    </p>
                                </div>
                            </div>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, se houver uso, campos de detalhamento aparecerÃ£o
                            </p>
                        </div>
                    `,
                    
                    'atividade-fisica': `
                        <div style="background: #e8f5e9; border-radius: 8px; padding: 15px; border-left: 4px solid #4caf50;">
                            <h5 style="margin: 0 0 12px 0; color: #2e7d32; font-size: 14px; font-weight: 600;">ğŸƒ Atividade FÃ­sica</h5>
                            
                            <div style="background: white; border-radius: 6px; padding: 15px; border: 1px solid #c8e6c9;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">Pratica exercÃ­cios:</label>
                                        <div style="font-size: 13px; color: #4caf50; font-weight: 700;">âœ“ Sim</div>
                                    </div>
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">FrequÃªncia:</label>
                                        <div style="font-size: 13px; color: #333; font-weight: 600;">3x/semana</div>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #c8e6c9;">
                                    <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 8px;">Tipos de atividade:</label>
                                    <div style="display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 10px;">
                                        <span style="background: #e8f5e9; padding: 4px 10px; border-radius: 12px; font-size: 11px; border: 1px solid #c8e6c9;">ğŸƒ Caminhada</span>
                                        <span style="background: #e8f5e9; padding: 4px 10px; border-radius: 12px; font-size: 11px; border: 1px solid #c8e6c9;">ğŸ‹ï¸ MusculaÃ§Ã£o</span>
                                    </div>
                                    <div style="font-size: 12px; color: #666;">
                                        <strong>DuraÃ§Ã£o:</strong> 45-60 minutos por sessÃ£o
                                    </div>
                                </div>
                            </div>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos serÃ£o funcionais
                            </p>
                        </div>
                    `,
                    
                    'alimentacao': `
                        <div style="background: #fff9c4; border-radius: 8px; padding: 15px; border-left: 4px solid #fbc02d;">
                            <h5 style="margin: 0 0 12px 0; color: #f57f17; font-size: 14px; font-weight: 600;">ğŸ AlimentaÃ§Ã£o</h5>
                            
                            <div style="background: white; border-radius: 6px; padding: 15px; border: 1px solid #fff59d;">
                                <div style="margin-bottom: 12px;">
                                    <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 6px;">PadrÃ£o alimentar:</label>
                                    <div style="font-size: 13px; color: #333;">Balanceada, com restriÃ§Ã£o de aÃ§Ãºcar</div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">RefeiÃ§Ãµes/dia:</label>
                                        <div style="font-size: 13px; color: #333; font-weight: 600;">5 refeiÃ§Ãµes</div>
                                    </div>
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">HidrataÃ§Ã£o:</label>
                                        <div style="font-size: 13px; color: #333; font-weight: 600;">2L Ã¡gua/dia</div>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #fff59d;">
                                    <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 6px;">RestriÃ§Ãµes/PreferÃªncias:</label>
                                    <div style="font-size: 12px; color: #666;">DiabÃ©tico - dieta com baixo Ã­ndice glicÃªmico</div>
                                </div>
                            </div>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos serÃ£o funcionais
                            </p>
                        </div>
                    `,
                    
                    'sono-rotina': `
                        <div style="background: #e1f5fe; border-radius: 8px; padding: 15px; border-left: 4px solid #03a9f4;">
                            <h5 style="margin: 0 0 12px 0; color: #01579b; font-size: 14px; font-weight: 600;">ğŸ˜´ Sono e Rotina</h5>
                            
                            <div style="background: white; border-radius: 6px; padding: 15px; border: 1px solid #b3e5fc;">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">Horas de sono:</label>
                                        <div style="font-size: 20px; color: #0277bd; font-weight: 700;">7-8h</div>
                                    </div>
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">Qualidade:</label>
                                        <div style="font-size: 13px; color: #4caf50; font-weight: 600;">Boa</div>
                                    </div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">HorÃ¡rio de dormir:</label>
                                        <div style="font-size: 13px; color: #333;">22:00 - 23:45</div>
                                    </div>
                                    <div>
                                        <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 4px;">HorÃ¡rio de acordar:</label>
                                        <div style="font-size: 13px; color: #333;">06:00 - 07:00</div>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #b3e5fc;">
                                    <label style="display: block; font-size: 11px; color: #666; font-weight: 600; margin-bottom: 6px;">Problemas de sono:</label>
                                    <div style="font-size: 12px; color: #666;">Nega insÃ´nia, ronco ou apneia</div>
                                </div>
                            </div>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos serÃ£o funcionais
                            </p>
                        </div>
                    `,
                    
                    'h-familiar': `
                        <div style="background: #f3e5f5; border-radius: 8px; padding: 15px; border-left: 4px solid #9c27b0;">
                            <h5 style="margin: 0 0 12px 0; color: #6a1b9a; font-size: 14px; font-weight: 600;">HistÃ³ria Familiar</h5>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #e1bee7;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ‘¨</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">Pai - HipertensÃ£o + IAM</div>
                                        <div style="font-size: 11px; color: #666;">
                                            HipertensÃ£o desde os 45 anos, IAM aos 62 anos
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; margin-bottom: 10px; border: 1px solid #e1bee7;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ‘©</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">MÃ£e - Diabetes tipo 2</div>
                                        <div style="font-size: 11px; color: #666;">
                                            DiagnÃ³stico aos 55 anos, em uso de insulina
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: white; border-radius: 6px; padding: 12px; border: 1px solid #e1bee7;">
                                <div style="display: flex; align-items: flex-start; gap: 10px;">
                                    <span style="font-size: 20px;">ğŸ‘´</span>
                                    <div style="flex: 1;">
                                        <div style="font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">AvÃ´ Paterno - CÃ¢ncer de PrÃ³stata</div>
                                        <div style="font-size: 11px; color: #666;">
                                            DiagnÃ³stico aos 70 anos, tratamento cirÃºrgico
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button disabled style="width: 100%; margin-top: 12px; padding: 10px; background: #9c27b0; color: white; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: not-allowed; opacity: 0.6;">
                                Adicionar Familiar
                            </button>
                            
                            <p style="margin: 10px 0 0 0; font-size: 11px; color: #999; font-style: italic; text-align: center;">
                                Preview - No atendimento, campos serÃ£o funcionais
                            </p>
                        </div>
                    `
                };
                
                // Retornar campo especÃ­fico ou genÃ©rico
                return camposPorModulo[moduloId] || `
                    <label style="display: block; font-size: 13px; color: #555; font-weight: 600; margin-bottom: 6px;">Campo de ${moduloId}:</label>
                    <textarea disabled placeholder="Campo de texto para este mÃ³dulo..." style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; min-height: 80px; resize: vertical; background: #f8f9fa; color: #999;"></textarea>
                `;
            },

            fecharModal() {
                const modal = document.getElementById('modal-template');
                modal.style.display = 'none';
                console.log('âŒ Modal fechado');
            },

            // ========================================
            // GERENCIAMENTO DE MÃ“DULOS
            // ========================================

            renderizarModulosDisponiveis() {
                const container = document.getElementById('modules-available-list');
                if (!container) return;
                
                let html = '';
                
                for (const [categoria, modulos] of Object.entries(this.MODULOS_DISPONIVEIS)) {
                    html += `
                        <div class="module-category" style="margin-bottom: 20px;">
                            <h5 class="category-title" style="
                                font-size: 11px;
                                color: #999;
                                font-weight: 600;
                                margin-bottom: 10px;
                                padding-bottom: 5px;
                                border-bottom: 1px solid #e0e0e0;
                                text-transform: uppercase;
                            ">${categoria}</h5>
                    `;
                    
                    modulos.forEach(modulo => {
                        const jaAdicionado = this.modulosSelecionados.includes(modulo.id);
                        html += `
                            <div class="module-item" style="
                                display: flex;
                                align-items: center;
                                padding: 10px;
                                background: white;
                                border-radius: 8px;
                                margin-bottom: 8px;
                                transition: all 0.2s;
                                ${jaAdicionado ? 'opacity: 0.5;' : ''}
                            " onmouseover="if(!${jaAdicionado}) { this.style.background='#f0f4ff'; this.style.transform='translateX(4px)'; }" 
                               onmouseout="this.style.background='white'; this.style.transform='translateX(0)';">
                                <span class="module-icon" style="font-size: 18px; margin-right: 10px;">${modulo.icone}</span>
                                <span class="module-name" style="flex: 1; font-size: 13px; color: #333; font-weight: 500;">${modulo.nome}</span>
                                <button class="btn-add-module" onclick="Templates.adicionarModulo('${modulo.id}')" 
                                    ${jaAdicionado ? 'disabled' : ''}
                                    style="
                                        width: 28px;
                                        height: 28px;
                                        background: ${jaAdicionado ? '#ccc' : '#667eea'};
                                        color: white;
                                        border: none;
                                        border-radius: 50%;
                                        cursor: ${jaAdicionado ? 'not-allowed' : 'pointer'};
                                        font-size: 16px;
                                        font-weight: 600;
                                        transition: all 0.2s;
                                    " ${!jaAdicionado ? "onmouseover=\"this.style.background='#5568d3'; this.style.transform='scale(1.1)';\" onmouseout=\"this.style.background='#667eea'; this.style.transform='scale(1)';\"" : ''}>
                                    +
                                </button>
                            </div>
                        `;
                    });
                    
                    html += `</div>`;
                }
                
                container.innerHTML = html;
            },

            adicionarModulo(moduloId) {
                if (this.modulosSelecionados.includes(moduloId)) {
                    Sistema.notificar('âš ï¸ Este mÃ³dulo jÃ¡ foi adicionado!', 'warning');
                    return;
                }
                
                this.modulosSelecionados.push(moduloId);
                this.renderizarModulosDisponiveis();
                this.renderizarModulosSelecionados();
                
                const modulo = this.buscarModuloPorId(moduloId);
                console.log('â• MÃ³dulo adicionado:', modulo.nome);
            },

            removerModulo(ordem) {
                const item = this.modulosSelecionados[ordem - 1];
                
                // Mensagem diferente para tÃ­tulo vs mÃ³dulo
                let mensagem = 'Remover este ';
                if (typeof item === 'object' && item.tipo === 'titulo') {
                    mensagem += `tÃ­tulo "${item.texto}"?`;
                } else {
                    const modulo = this.buscarModuloPorId(item);
                    mensagem += `mÃ³dulo "${modulo.nome}"?`;
                }
                
                if (confirm(mensagem)) {
                    this.modulosSelecionados.splice(ordem - 1, 1);
                    this.renderizarModulosDisponiveis();
                    this.renderizarModulosSelecionados();
                    
                    // Log apropriado
                    if (typeof item === 'object' && item.tipo === 'titulo') {
                        console.log('ğŸ—‘ï¸ TÃ­tulo removido:', item.texto);
                    } else {
                        const modulo = this.buscarModuloPorId(item);
                        console.log('ğŸ—‘ï¸ MÃ³dulo removido:', modulo.nome);
                    }
                }
            },

            // ========================================
            // ADICIONAR TÃTULO/SEÃ‡ÃƒO
            // ========================================
            
            adicionarTitulo() {
                // Prompt para escolher Ã­cone
                const icone = prompt(
                    'ğŸ“ Digite o emoji/Ã­cone para o tÃ­tulo:\n\n' +
                    'SugestÃµes:\n' +
                    'ğŸ“‹ Anamnese\n' +
                    'ğŸ©º Antecedentes\n' +
                    'âš•ï¸ Exame FÃ­sico\n' +
                    'ğŸ” DiagnÃ³stico\n' +
                    'ğŸ’Š Conduta\n' +
                    'ğŸ¥ InternaÃ§Ã£o\n' +
                    'âš¡ EmergÃªncia\n' +
                    'ğŸ”ª CirÃºrgico',
                    'ğŸ“‹'
                );
                
                if (!icone) return; // UsuÃ¡rio cancelou
                
                // Prompt para o texto do tÃ­tulo
                const texto = prompt(
                    'ğŸ“ Digite o texto do tÃ­tulo:\n\n' +
                    'SerÃ¡ exibido em MAIÃšSCULAS automaticamente.',
                    'SEÃ‡ÃƒO'
                );
                
                if (!texto || texto.trim() === '') return; // UsuÃ¡rio cancelou ou texto vazio
                
                // Criar objeto de tÃ­tulo
                const titulo = {
                    tipo: 'titulo',
                    icone: icone.trim(),
                    texto: texto.trim().toUpperCase(),
                    id: 'titulo-' + Date.now()
                };
                
                // Adicionar ao array de mÃ³dulos selecionados
                this.modulosSelecionados.push(titulo);
                
                // Atualizar interface
                this.renderizarModulosSelecionados();
                
                Sistema.notificar(`âœ… TÃ­tulo "${titulo.icone} ${titulo.texto}" adicionado!`);
                console.log('ğŸ“ TÃ­tulo adicionado:', titulo);
            },

            moverModuloCima(ordem) {
                if (ordem === 1) return;
                
                const index = ordem - 1;
                [this.modulosSelecionados[index], this.modulosSelecionados[index - 1]] = 
                [this.modulosSelecionados[index - 1], this.modulosSelecionados[index]];
                
                this.renderizarModulosSelecionados();
                console.log('â†‘ MÃ³dulo movido para cima');
            },

            moverModuloBaixo(ordem) {
                if (ordem === this.modulosSelecionados.length) return;
                
                const index = ordem - 1;
                [this.modulosSelecionados[index], this.modulosSelecionados[index + 1]] = 
                [this.modulosSelecionados[index + 1], this.modulosSelecionados[index]];
                
                this.renderizarModulosSelecionados();
                console.log('â†“ MÃ³dulo movido para baixo');
            },

            renderizarModulosSelecionados() {
                const container = document.getElementById('selected-modules-list');
                if (!container) return;
                
                if (this.modulosSelecionados.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state" style="text-align: center; padding: 60px 20px; color: #999;">
                            <p style="margin: 0 0 8px 0;">Nenhum mÃ³dulo selecionado ainda</p>
                            <p class="small" style="font-size: 12px; margin: 0;">Use os botÃµes + ao lado para adicionar mÃ³dulos</p>
                        </div>
                    `;
                    return;
                }
                
                let html = '';
                this.modulosSelecionados.forEach((item, index) => {
                    const ordem = index + 1;
                    const isFirst = ordem === 1;
                    const isLast = ordem === this.modulosSelecionados.length;
                    
                    // ========================================
                    // SE FOR TÃTULO: Renderizar como tÃ­tulo
                    // ========================================
                    if (typeof item === 'object' && item.tipo === 'titulo') {
                        html += `
                            <div class="selected-module-item titulo-item" data-order="${ordem}" style="
                                display: flex;
                                align-items: center;
                                padding: 15px 18px;
                                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                                color: white;
                                border-radius: 10px;
                                margin-bottom: 10px;
                                box-shadow: 0 4px 6px rgba(102, 126, 234, 0.3);
                                transition: all 0.2s;
                            " onmouseover="this.style.boxShadow='0 6px 12px rgba(102, 126, 234, 0.4)'; this.style.transform='translateY(-1px)';" 
                               onmouseout="this.style.boxShadow='0 4px 6px rgba(102, 126, 234, 0.3)'; this.style.transform='translateY(0)';">
                                <div class="module-handle" style="cursor: grab; font-size: 18px; color: rgba(255,255,255,0.7); margin-right: 12px;">â˜°</div>
                                <div class="module-icon" style="font-size: 20px; margin-right: 12px;">${item.icone}</div>
                                <div class="module-info" style="flex: 1;">
                                    <span style="font-size: 14px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px;">${item.texto}</span>
                                    <span style="
                                        margin-left: 10px;
                                        background: rgba(255,255,255,0.25);
                                        padding: 2px 8px;
                                        border-radius: 10px;
                                        font-size: 10px;
                                        font-weight: 600;
                                    ">TÃTULO</span>
                                </div>
                                <div class="module-actions" style="display: flex; gap: 6px;">
                                    <button class="btn-move-up" onclick="Templates.moverModuloCima(${ordem})" title="Mover para cima" 
                                        ${isFirst ? 'disabled' : ''}
                                        style="
                                            width: 30px;
                                            height: 30px;
                                            border: none;
                                            border-radius: 6px;
                                            cursor: ${isFirst ? 'not-allowed' : 'pointer'};
                                            font-size: 14px;
                                            transition: all 0.2s;
                                            background: ${isFirst ? 'rgba(255,255,255,0.15)' : 'rgba(255,255,255,0.25)'};
                                            color: white;
                                            opacity: ${isFirst ? '0.5' : '1'};
                                        " ${!isFirst ? "onmouseover=\"this.style.background='rgba(255,255,255,0.4)';\" onmouseout=\"this.style.background='rgba(255,255,255,0.25)';\"" : ''}>
                                        â†‘
                                    </button>
                                    <button class="btn-move-down" onclick="Templates.moverModuloBaixo(${ordem})" title="Mover para baixo"
                                        ${isLast ? 'disabled' : ''}
                                        style="
                                            width: 30px;
                                            height: 30px;
                                            border: none;
                                            border-radius: 6px;
                                            cursor: ${isLast ? 'not-allowed' : 'pointer'};
                                            font-size: 14px;
                                            transition: all 0.2s;
                                            background: ${isLast ? 'rgba(255,255,255,0.15)' : 'rgba(255,255,255,0.25)'};
                                            color: white;
                                            opacity: ${isLast ? '0.5' : '1'};
                                        " ${!isLast ? "onmouseover=\"this.style.background='rgba(255,255,255,0.4)';\" onmouseout=\"this.style.background='rgba(255,255,255,0.25)';\"" : ''}>
                                        â†“
                                    </button>
                                    <button class="btn-remove" onclick="Templates.removerModulo(${ordem})" title="Remover tÃ­tulo" style="
                                        width: 30px;
                                        height: 30px;
                                        border: none;
                                        border-radius: 6px;
                                        cursor: pointer;
                                        font-size: 14px;
                                        transition: all 0.2s;
                                        background: rgba(255,255,255,0.25);
                                        color: white;
                                    " onmouseover="this.style.background='rgba(244,67,54,0.8)';" 
                                       onmouseout="this.style.background='rgba(255,255,255,0.25)';">
                                        ğŸ—‘ï¸
                                    </button>
                                </div>
                            </div>
                        `;
                        return; // NÃ£o processar como mÃ³dulo normal
                    }
                    
                    // ========================================
                    // SE FOR MÃ“DULO: Renderizar normalmente
                    // ========================================
                    const moduloId = item;
                    const modulo = this.buscarModuloPorId(moduloId);
                    
                    html += `
                        <div class="selected-module-item" data-module-id="${moduloId}" data-order="${ordem}" style="
                            display: flex;
                            align-items: center;
                            padding: 12px;
                            background: white;
                            border: 1px solid #e0e0e0;
                            border-radius: 8px;
                            margin-bottom: 10px;
                            transition: all 0.2s;
                        " onmouseover="this.style.borderColor='#667eea'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.15)';" 
                           onmouseout="this.style.borderColor='#e0e0e0'; this.style.boxShadow='none';">
                            <div class="module-handle" style="cursor: grab; font-size: 18px; color: #999; margin-right: 12px;">â˜°</div>
                            <div class="module-number" style="font-weight: 600; color: #667eea; margin-right: 12px; min-width: 24px;">${ordem}.</div>
                            <div class="module-info" style="flex: 1; display: flex; align-items: center;">
                                <span class="module-icon" style="font-size: 16px; margin-right: 8px;">${modulo.icone}</span>
                                <span class="module-name" style="font-size: 14px; color: #333; font-weight: 500;">${modulo.nome}</span>
                            </div>
                            <div class="module-actions" style="display: flex; gap: 6px;">
                                <button class="btn-move-up" onclick="Templates.moverModuloCima(${ordem})" title="Mover para cima" 
                                    ${isFirst ? 'disabled' : ''}
                                    style="
                                        width: 30px;
                                        height: 30px;
                                        border: none;
                                        border-radius: 6px;
                                        cursor: ${isFirst ? 'not-allowed' : 'pointer'};
                                        font-size: 14px;
                                        transition: all 0.2s;
                                        background: ${isFirst ? '#f0f0f0' : '#e3f2fd'};
                                        color: ${isFirst ? '#999' : '#333'};
                                    " ${!isFirst ? "onmouseover=\"this.style.background='#2196f3'; this.style.color='white';\" onmouseout=\"this.style.background='#e3f2fd'; this.style.color='#333';\"" : ''}>
                                    â†‘
                                </button>
                                <button class="btn-move-down" onclick="Templates.moverModuloBaixo(${ordem})" title="Mover para baixo"
                                    ${isLast ? 'disabled' : ''}
                                    style="
                                        width: 30px;
                                        height: 30px;
                                        border: none;
                                        border-radius: 6px;
                                        cursor: ${isLast ? 'not-allowed' : 'pointer'};
                                        font-size: 14px;
                                        transition: all 0.2s;
                                        background: ${isLast ? '#f0f0f0' : '#e3f2fd'};
                                        color: ${isLast ? '#999' : '#333'};
                                    " ${!isLast ? "onmouseover=\"this.style.background='#2196f3'; this.style.color='white';\" onmouseout=\"this.style.background='#e3f2fd'; this.style.color='#333';\"" : ''}>
                                    â†“
                                </button>
                                <button class="btn-remove" onclick="Templates.removerModulo(${ordem})" title="Remover" style="
                                    width: 30px;
                                    height: 30px;
                                    border: none;
                                    border-radius: 6px;
                                    cursor: pointer;
                                    font-size: 14px;
                                    transition: all 0.2s;
                                    background: #f9fafb;
                                " onmouseover="this.style.background='#f44336'; this.style.color='white';" 
                                   onmouseout="this.style.background='#ffebee'; this.style.color='inherit';">
                                    ğŸ—‘ï¸
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },

            // ========================================
            // SALVAR TEMPLATE
            // ========================================

            salvarTemplate() {
                // ValidaÃ§Ãµes
                const nome = document.getElementById('template-nome').value.trim();
                if (!nome) {
                    alert('âŒ Por favor, informe o nome do template!');
                    document.getElementById('template-nome').focus();
                    return;
                }
                
                if (this.modulosSelecionados.length === 0) {
                    alert('âŒ Selecione pelo menos um mÃ³dulo!');
                    return;
                }
                
                const descricao = document.getElementById('template-descricao').value.trim();
                
                if (this.templateAtual) {
                    // Editando template existente
                    this.templateAtual.nome = nome;
                    this.templateAtual.descricao = descricao;
                    this.templateAtual.modulos = [...this.modulosSelecionados];
                    this.templateAtual.dataEdicao = new Date().toISOString().split('T')[0];
                    console.log('âœï¸ Template editado:', nome);
                } else {
                    // Criando novo template - v10.434: usar proximoId
                    const novoTemplate = {
                        id: SistemaCore.proximoId(this.templates),
                        nome,
                        descricao,
                        modulos: [...this.modulosSelecionados],
                        config: {},
                        dataCriacao: new Date().toISOString().split('T')[0],
                        dataEdicao: new Date().toISOString().split('T')[0]
                    };
                    this.templates.push(novoTemplate);
                    console.log('âœ¨ Novo template criado:', nome);
                }
                
                this.salvarTemplates();
                this.renderizarTemplates();
                this.fecharModal();
                
                Sistema.notificar('âœ… Template salvo com sucesso!');
            },

            // ========================================
            // UTILITÃRIOS
            // ========================================

            buscarModuloPorId(moduloId) {
                for (const categoria in this.MODULOS_DISPONIVEIS) {
                    const modulo = this.MODULOS_DISPONIVEIS[categoria].find(m => m.id === moduloId);
                    if (modulo) return modulo;
                }
                return null;
            },

            filtrarModulos(termo) {
                termo = termo.toLowerCase().trim();
                const container = document.getElementById('modules-available-list');
                if (!container) return;
                
                // Se termo vazio, mostra tudo normalmente
                if (!termo) {
                    this.renderizarModulosDisponiveis();
                    return;
                }
                
                let html = '';
                let encontrouAlgum = false;
                
                for (const [categoria, modulos] of Object.entries(this.MODULOS_DISPONIVEIS)) {
                    // Filtrar mÃ³dulos que contÃªm o termo
                    const modulosFiltrados = modulos.filter(m => 
                        m.nome.toLowerCase().includes(termo) || 
                        m.id.toLowerCase().includes(termo)
                    );
                    
                    if (modulosFiltrados.length > 0) {
                        encontrouAlgum = true;
                        html += `
                            <div class="module-category" style="margin-bottom: 20px;">
                                <h5 class="category-title" style="
                                    font-size: 11px;
                                    color: #999;
                                    font-weight: 600;
                                    margin-bottom: 10px;
                                    padding-bottom: 5px;
                                    border-bottom: 1px solid #e0e0e0;
                                    text-transform: uppercase;
                                ">${categoria}</h5>
                        `;
                        
                        modulosFiltrados.forEach(modulo => {
                            const jaAdicionado = this.modulosSelecionados.includes(modulo.id);
                            html += `
                                <div class="module-item" style="
                                    display: flex;
                                    align-items: center;
                                    padding: 10px;
                                    background: white;
                                    border-radius: 8px;
                                    margin-bottom: 8px;
                                    transition: all 0.2s;
                                    ${jaAdicionado ? 'opacity: 0.5;' : ''}
                                " onmouseover="if(!${jaAdicionado}) { this.style.background='#f0f4ff'; this.style.transform='translateX(4px)'; }" 
                                   onmouseout="this.style.background='white'; this.style.transform='translateX(0)';">
                                    <span class="module-icon" style="font-size: 18px; margin-right: 10px;">${modulo.icone}</span>
                                    <span class="module-name" style="flex: 1; font-size: 13px; color: #333; font-weight: 500;">${modulo.nome}</span>
                                    <button class="btn-add-module" onclick="Templates.adicionarModulo('${modulo.id}')" 
                                        ${jaAdicionado ? 'disabled' : ''}
                                        style="
                                            width: 28px;
                                            height: 28px;
                                            background: ${jaAdicionado ? '#ccc' : '#667eea'};
                                            color: white;
                                            border: none;
                                            border-radius: 50%;
                                            cursor: ${jaAdicionado ? 'not-allowed' : 'pointer'};
                                            font-size: 16px;
                                            font-weight: 600;
                                            transition: all 0.2s;
                                        " ${!jaAdicionado ? "onmouseover=\"this.style.background='#5568d3'; this.style.transform='scale(1.1)';\" onmouseout=\"this.style.background='#667eea'; this.style.transform='scale(1)';\"" : ''}>
                                        +
                                    </button>
                                </div>
                            `;
                        });
                        
                        html += `</div>`;
                    }
                }
                
                if (!encontrouAlgum) {
                    html = `
                        <div style="text-align: center; padding: 40px 20px; color: #999;">
                            <p style="font-size: 14px; margin: 0;">ğŸ” Nenhum mÃ³dulo encontrado</p>
                            <p style="font-size: 12px; margin-top: 8px;">Tente outro termo de busca</p>
                        </div>
                    `;
                }
                
                container.innerHTML = html;
            },

            formatarData(dataISO) {
                const [ano, mes, dia] = dataISO.split('-');
                return `${dia}/${mes}/${ano}`;
            }
        };

        /* ============================================================
           [TIPOS DOCUMENTO] MÃ³dulo de ConfiguraÃ§Ã£o - v10.12.0
           ============================================================ */
        
        const TiposDocumento = {
            tipoAtual: 'folha-rosto-emergencia',

            init() {
                console.log('ğŸ“‹ [TiposDocumento] MÃ³dulo inicializado');
                this.carregarConfig();
            },

            carregarConfig() {
                const select = document.getElementById('tipo-documento-select');
                if (!select) return;
                
                this.tipoAtual = select.value;

                const config = SistemaCore.dados.tiposDocumento?.[this.tipoAtual] || {};
                
                // Carregar checkboxes
                const elDias = document.getElementById('tipo-dias-internacao');
                const elCir = document.getElementById('tipo-cirurgias');
                const elAtbUso = document.getElementById('tipo-atb-uso');
                const elAtbSusp = document.getElementById('tipo-atb-suspensos');
                
                if (elDias) elDias.checked = config.mostrarDiasInternacao || false;
                if (elCir) elCir.checked = config.mostrarCirurgias || false;
                if (elAtbUso) elAtbUso.checked = config.mostrarAtbUso || false;
                if (elAtbSusp) elAtbSusp.checked = config.mostrarAtbSuspensos || false;

                // Carregar formatos
                const elCirFormato = document.getElementById('tipo-cirurgias-formato');
                const elAtbFormato = document.getElementById('tipo-atb-uso-formato');
                if (elCirFormato) elCirFormato.value = config.cirurgiasFormato || 'lista';
                if (elAtbFormato) elAtbFormato.value = config.atbUsoFormato || 'lista';

                // Mostrar/ocultar opÃ§Ãµes
                this.toggleSecao('cirurgias');
                this.toggleSecao('atb-uso');

                // Atualizar nome do tipo no preview
                const nomes = {
                    'folha-rosto-emergencia': 'ğŸš¨ Folha de Rosto - EmergÃªncia',
                    'cabecalho-consultorio': 'ğŸ©º CabeÃ§alho - ConsultÃ³rio',
                    'cabecalho-internacao': 'ğŸ›ï¸ CabeÃ§alho - InternaÃ§Ã£o',
                    'cabecalho-cirurgico': 'âš•ï¸ CabeÃ§alho - Bloco CirÃºrgico',
                    'folha-sala': 'ğŸ“ Folha de Sala'
                };
                const elNome = document.getElementById('preview-tipo-nome');
                if (elNome) elNome.textContent = nomes[this.tipoAtual];

                this.atualizarPreview();
            },

            toggleSecao(secao) {
                const checkbox = document.getElementById(`tipo-${secao}`);
                const opcoes = document.getElementById(`tipo-${secao}-opcoes`);
                
                if (opcoes && checkbox) {
                    opcoes.style.display = checkbox.checked ? 'block' : 'none';
                }

                this.salvarConfig();
            },

            salvarConfig() {
                const elDias = document.getElementById('tipo-dias-internacao');
                const elCir = document.getElementById('tipo-cirurgias');
                const elCirFormato = document.getElementById('tipo-cirurgias-formato');
                const elAtbUso = document.getElementById('tipo-atb-uso');
                const elAtbFormato = document.getElementById('tipo-atb-uso-formato');
                const elAtbSusp = document.getElementById('tipo-atb-suspensos');
                
                if (!SistemaCore.dados.tiposDocumento) {
                    SistemaCore.dados.tiposDocumento = {};
                }
                
                const config = {
                    mostrarDiasInternacao: elDias ? elDias.checked : false,
                    mostrarCirurgias: elCir ? elCir.checked : false,
                    cirurgiasFormato: elCirFormato ? elCirFormato.value : 'lista',
                    mostrarAtbUso: elAtbUso ? elAtbUso.checked : false,
                    atbUsoFormato: elAtbFormato ? elAtbFormato.value : 'lista',
                    mostrarAtbSuspensos: elAtbSusp ? elAtbSusp.checked : false
                };

                SistemaCore.dados.tiposDocumento[this.tipoAtual] = config;
                SistemaCore.salvar();
                
                this.atualizarPreview();
            },

            atualizarPreview() {
                const preview = document.getElementById('preview-tipo-documento');
                if (!preview) return;
                
                const config = SistemaCore.dados.tiposDocumento?.[this.tipoAtual] || {};
                const dados = SistemaCore.dados.dadosClinicosExemplo;
                
                if (!dados) {
                    preview.innerHTML = '<div style="text-align: center; padding: 60px 20px; color: #9ca3af;"><div style="font-size: 48px; margin-bottom: 12px;">ğŸ“‹</div><p>Nenhum dado clÃ­nico cadastrado ainda.</p></div>';
                    return;
                }
                
                let html = '';

                // Dias de internaÃ§Ã£o
                if (config.mostrarDiasInternacao && dados.internacao && dados.internacao.dataAdmissao) {
                    const dias = DadosClinicos.calcularDias(dados.internacao.dataAdmissao);
                    html += `
                        <div style="margin-bottom: 16px;">
                            <div style="font-weight: bold; margin-bottom: 4px;">DIA DE INTERNAÃ‡ÃƒO: ${dias} ${dias === 1 ? 'dia' : 'dias'}</div>
                        </div>
                    `;
                }

                // Cirurgias
                if (config.mostrarCirurgias && dados.cirurgias && dados.cirurgias.length > 0) {
                    html += `<div style="margin-bottom: 16px;">`;
                    html += `<div style="font-weight: bold; margin-bottom: 8px;">CIRURGIAS REALIZADAS: ${dados.cirurgias.length}</div>`;
                    
                    if (config.cirurgiasFormato === 'lista') {
                        html += '<div style="padding-left: 12px; line-height: 1.6;">';
                        dados.cirurgias.forEach(cir => {
                            const po = DadosClinicos.calcularDias(cir.data);
                            html += `â€¢ <strong>D${po}</strong> - ${cir.procedimento} (${DadosClinicos.formatarData(cir.data)})<br>`;
                        });
                        html += '</div>';
                    } else {
                        const resumo = dados.cirurgias.map(c => `${c.procedimento} (D${DadosClinicos.calcularDias(c.data)})`).join(', ');
                        html += `<div style="padding-left: 12px;">${resumo}</div>`;
                    }
                    
                    html += `</div>`;
                }

                // ATBs em uso
                if (config.mostrarAtbUso && dados.antibioticos && dados.antibioticos.emUso && dados.antibioticos.emUso.length > 0) {
                    html += `<div style="margin-bottom: 16px;">`;
                    html += `<div style="font-weight: bold; margin-bottom: 8px;">ANTIBIÃ“TICOS EM USO: ${dados.antibioticos.emUso.length}</div>`;
                    
                    if (config.atbUsoFormato === 'lista') {
                        html += '<div style="padding-left: 12px; line-height: 1.6;">';
                        dados.antibioticos.emUso.forEach(atb => {
                            const dias = DadosClinicos.calcularDias(atb.dataInicio);
                            html += `â€¢ <strong>D${dias}</strong> - ${atb.nome} ${atb.dose} (${DadosClinicos.formatarData(atb.dataInicio)})${atb.duracaoPrevista ? ` [${atb.duracaoPrevista}d]` : ''}<br>`;
                        });
                        html += '</div>';
                    } else {
                        const resumo = dados.antibioticos.emUso.map(a => `${a.nome} (D${DadosClinicos.calcularDias(a.dataInicio)})`).join(', ');
                        html += `<div style="padding-left: 12px;">${resumo}</div>`;
                    }
                    
                    html += `</div>`;
                }

                // ATBs suspensos
                if (config.mostrarAtbSuspensos && dados.antibioticos && dados.antibioticos.suspensos && dados.antibioticos.suspensos.length > 0) {
                    html += `
                        <div style="margin-bottom: 16px;">
                            <div style="font-weight: bold; margin-bottom: 8px;">ANTIBIÃ“TICOS SUSPENSOS: ${dados.antibioticos.suspensos.length}</div>
                            <div style="padding-left: 12px; line-height: 1.6; color: #6b7280;">
                                ${dados.antibioticos.suspensos.map(atb => {
                                    const diasUso = DadosClinicos.calcularDiasEntre(atb.dataInicio, atb.dataFim);
                                    return `â€¢ ${atb.nome} - ${DadosClinicos.formatarData(atb.dataInicio)} a ${DadosClinicos.formatarData(atb.dataFim)} (${diasUso}d)`;
                                }).join('<br>')}
                            </div>
                        </div>
                    `;
                }

                if (!html) {
                    html = `
                        <div style="text-align: center; padding: 40px 20px; color: #9ca3af;">
                            <div style="font-size: 48px; margin-bottom: 12px;">ğŸ“‹</div>
                            <p>Nenhum dado serÃ¡ exibido neste tipo de documento.</p>
                            <p style="font-size: 10px; margin-top: 8px;">Marque os checkboxes ao lado para incluir informaÃ§Ãµes.</p>
                        </div>
                    `;
                }

                preview.innerHTML = html;
            }
        };

        /* ============================================================
           [REPARTICOES] MÃ³dulo RepartiÃ§Ãµes
           ============================================================ */
        
        const Reparticoes = {
            // DEFINIÃ‡ÃƒO DOS 6 TIPOS (v6.8.0)
            tipos: {
                'consultorio': {
                    icone: 'ğŸ©º',
                    nome: 'ğŸ©º ConsultÃ³rio(s)',
                    descricao: 'Salas de Consulta',
                    unidade: 'consultÃ³rio',
                    cor: '#3b82f6'
                },
                'procedimento': {
                    icone: 'ğŸ¥',
                    nome: 'ğŸ¥ AmbulatÃ³rio(s)',
                    descricao: 'Procedimentos Ambulatoriais',
                    unidade: 'sala',
                    cor: '#10b981'
                },
                'emergencia': {
                    icone: 'ğŸš¨',
                    nome: 'ğŸš¨ Pronto-Socorro (EmergÃªncia)',
                    descricao: 'Atendimento de EmergÃªncia',
                    unidade: 'leito',
                    cor: '#ef4444'
                },
                'internacao': {
                    icone: 'ğŸ›ï¸',
                    nome: 'ğŸ›ï¸ InternaÃ§Ã£o',
                    descricao: 'Leitos/Enfermarias',
                    unidade: 'leito',
                    cor: '#f59e0b'
                },
                'bloco_cirurgico': {
                    icone: 'âš•ï¸',
                    nome: 'âš•ï¸ Bloco CirÃºrgico',
                    descricao: 'Centro CirÃºrgico',
                    unidade: 'sala',
                    cor: '#8b5cf6'
                },
                'cirurgia': {
                    icone: 'âš•ï¸',
                    nome: 'âš•ï¸ Cirurgia',
                    descricao: 'Centro CirÃºrgico',
                    unidade: 'sala',
                    cor: '#8b5cf6'
                },
                'exames_laboratorio': {
                    icone: 'ğŸ”¬',
                    nome: 'ğŸ”¬ Exames de LaboratÃ³rio',
                    descricao: 'AnÃ¡lises ClÃ­nicas',
                    unidade: 'sala',
                    cor: '#ec4899'
                },
                'exames_imagem': {
                    icone: 'ğŸ©»',
                    nome: 'ğŸ©» Exames de Imagem',
                    descricao: 'Radiologia e DiagnÃ³stico',
                    unidade: 'sala',
                    cor: '#ec4899'  // v10.93: Rosa como laboratÃ³rio
                },
                'exames': {
                    icone: 'ğŸ”¬',
                    nome: 'ğŸ”¬ Exames',
                    descricao: 'Imagem/LaboratÃ³rio',
                    unidade: 'sala',
                    cor: '#fbcfe8'
                }
            },

            // v8.9: FunÃ§Ãµes de customizaÃ§Ã£o (visibilidade apenas - favoritos removidos)
            carregarPreferencias() {
                const prefs = localStorage.getItem('reparticoes_preferencias');
                return prefs ? JSON.parse(prefs) : { ocultas: [] };
            },

            salvarPreferencias(prefs) {
                localStorage.setItem('reparticoes_preferencias', JSON.stringify(prefs));
            },

            ehOculta(repId) {
                const prefs = this.carregarPreferencias();
                return prefs.ocultas.includes(repId);
            },

            toggleVisibilidade(repId) {
                const prefs = this.carregarPreferencias();
                const index = prefs.ocultas.indexOf(repId);
                
                if (index > -1) {
                    prefs.ocultas.splice(index, 1);
                    Sistema.notificar('ğŸ‘ï¸ Unidade visÃ­vel novamente');
                } else {
                    prefs.ocultas.push(repId);
                    Sistema.notificar('ğŸ‘ï¸ Unidade ocultada');
                }
                
                this.salvarPreferencias(prefs);
                this.listar();
            },

            mostrarOcultas() {
                const prefs = this.carregarPreferencias();
                prefs.ocultas = [];
                this.salvarPreferencias(prefs);
                Sistema.notificar('ğŸ‘ï¸ Todas as unidades visÃ­veis novamente');
                this.listar();
            },

            toggleDisponibilidadeLeito(leitoId) {
                // v10.38: Mantida para compatibilidade, chama toggleBloqueio
                this.toggleBloqueio(leitoId);
            },
            
            toggleDisponibilidadeUnidade(unidadeId) {
                // v10.38: Mantida para compatibilidade, chama toggleBloqueio
                this.toggleBloqueio(unidadeId);
            },

            toggleBloqueio(unidadeId) {
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                console.log('ğŸ” [DEBUG BLOQUEIO] toggleBloqueio() chamado');
                console.log('ğŸ” [DEBUG BLOQUEIO] ID da unidade:', unidadeId);
                
                const unidade = SistemaCore.dados.reparticoes.find(r => r.id === unidadeId);
                if (!unidade) {
                    console.log('âŒ [DEBUG BLOQUEIO] Unidade nÃ£o encontrada!');
                    console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                    return;
                }
                
                const estadoAnterior = unidade.bloqueado ? 'BLOQUEADO' : 'DESBLOQUEADO';
                console.log('ğŸ” [DEBUG BLOQUEIO] Unidade encontrada:', unidade.nome);
                console.log('ğŸ” [DEBUG BLOQUEIO] Estado anterior:', estadoAnterior);
                console.log('ğŸ” [DEBUG BLOQUEIO] Tipo:', unidade.tipo_reparticao || 'consultorio');
                
                // Inverter bloqueio (default = false se nÃ£o existir)
                unidade.bloqueado = !unidade.bloqueado;
                
                const novoEstado = unidade.bloqueado ? 'BLOQUEADO' : 'DESBLOQUEADO';
                console.log('ğŸ” [DEBUG BLOQUEIO] Novo estado:', novoEstado);
                
                SistemaCore.salvar();
                
                // Mensagens inteligentes por tipo
                const tipoUnidade = unidade.tipo_reparticao || 'consultorio';
                const nomeAmigavel = {
                    'consultorio': 'ConsultÃ³rio',
                    'procedimento': 'Sala de Procedimento',
                    'exames': 'Sala de Exames',
                    'bloco_cirurgico': 'Sala CirÃºrgica',
                    'internacao': 'Leito',
                    'emergencia': 'Leito de EmergÃªncia'
                }[tipoUnidade] || 'Unidade';
                
                const acaoAmigavel = {
                    'consultorio': 'agendamento',
                    'procedimento': 'agendamento',
                    'exames': 'agendamento',
                    'bloco_cirurgico': 'cirurgia',
                    'internacao': 'internaÃ§Ã£o',
                    'emergencia': 'internaÃ§Ã£o'
                }[tipoUnidade] || 'uso';
                
                const statusMsg = unidade.bloqueado
                    ? `â›” ${nomeAmigavel} "${unidade.nome}" BLOQUEADO (nÃ£o permite ${acaoAmigavel})`
                    : `âœ… ${nomeAmigavel} "${unidade.nome}" DESBLOQUEADO (permite ${acaoAmigavel})`;
                
                console.log('ğŸ” [DEBUG BLOQUEIO] Mensagem ao usuÃ¡rio:', statusMsg);
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                
                Sistema.notificar(statusMsg, unidade.bloqueado ? 'warning' : 'success');
                
                // Atualizar visualizaÃ§Ã£o
                this.listar();
                
                // Atualizar agenda se estiver visÃ­vel
                if (typeof Agenda !== 'undefined' && Agenda.listar) {
                    Agenda.listar();
                }
            },

            listar() {
                const container = document.getElementById('listaReparticoes');
                const filtroCategoria = document.getElementById('filtro-categoria')?.value || '';
                const filtroBusca = document.getElementById('filtro-busca-rep')?.value.toLowerCase() || '';
                const filtroTipoUso = document.getElementById('filtro-tipo-uso')?.value || '';
                const filtroStatus = document.getElementById('filtro-status-reparticao')?.value || '';

                let reps = SistemaCore.dados.reparticoes;

                // v6.8.2: Filtrar sub-repartiÃ§Ãµes (serÃ£o mostradas dentro do grupo pai)
                reps = reps.filter(r => !r.eh_subreparticao);

                // Carregar preferÃªncias para ocultas
                const prefs = this.carregarPreferencias();

                // v8.6: FILTRO DE TIPO DE REPARTIÃ‡ÃƒO SIMPLIFICADO
                if (filtroCategoria) {
                    reps = reps.filter(r => {
                        const tipoRep = r.tipo_reparticao || 'consultorio';
                        // v10.114: Filtro 'exames' inclui laboratorio e imagem
                        if (filtroCategoria === 'exames') {
                            return tipoRep === 'exames' || tipoRep === 'exames_laboratorio' || tipoRep === 'exames_imagem';
                        }
                        return tipoRep === filtroCategoria;
                    });
                }

                // v8.0.26: CORRIGIR FILTRO DE BUSCA
                // Buscar por nome, pavilhÃ£o, andar, setor
                if (filtroBusca) {
                    reps = reps.filter(r => 
                        (r.nome && r.nome.toLowerCase().includes(filtroBusca)) ||
                        (r.pavilhao && r.pavilhao.toLowerCase().includes(filtroBusca)) ||
                        (r.andar && r.andar.toLowerCase().includes(filtroBusca)) ||
                        (r.setor && r.setor.toLowerCase().includes(filtroBusca))
                    );
                }

                // v8.8: FILTRO DE TIPO DE USO
                if (filtroTipoUso) {
                    reps = reps.filter(r => r.tipo_uso === filtroTipoUso);
                }

                // v10.87: FILTRO DE STATUS - Para todas as unidades (nÃ£o sÃ³ leitos)
                // Filtra por status de ocupaÃ§Ã£o (livre/ocupado/reservado) e bloqueio
                if (filtroStatus) {
                    reps = reps.filter(r => {
                        // Se Ã© um GRUPO, verificar se alguma sub-repartiÃ§Ã£o tem o status filtrado
                        if (r.eh_grupo && r.subreparticoes_ids && r.subreparticoes_ids.length > 0) {
                            const subs = SistemaCore.dados.reparticoes.filter(sub => 
                                r.subreparticoes_ids.includes(sub.id)
                            );
                            // Retornar true se ALGUMA sub tem o status filtrado
                            return subs.some(sub => {
                                if (filtroStatus === 'bloqueado') {
                                    return sub.bloqueado === true;
                                }
                                return sub.status === filtroStatus;
                            });
                        }
                        
                        // Para repartiÃ§Ãµes normais, verificar status ou bloqueio
                        if (filtroStatus === 'bloqueado') {
                            return r.bloqueado === true;
                        }
                        return r.status === filtroStatus;
                    });
                }

                // Separar unidades ocultas
                const repsVisiveis = reps.filter(r => !prefs.ocultas.includes(r.id));
                const repsOcultas = reps.filter(r => prefs.ocultas.includes(r.id));

                // Atualizar botÃ£o de mostrar ocultas
                const btnMostrarOcultas = document.getElementById('btn-mostrar-ocultas-container');
                const contadorOcultas = document.getElementById('contador-ocultas');
                if (repsOcultas.length > 0) {
                    btnMostrarOcultas.style.display = 'block';
                    contadorOcultas.textContent = repsOcultas.length;
                } else {
                    btnMostrarOcultas.style.display = 'none';
                }

                // Usar apenas as visÃ­veis
                reps = repsVisiveis;

                if (reps.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--text-light);">
                            <div style="font-size: 48px; margin-bottom: 16px;">ğŸšª</div>
                            <p style="font-size: 18px; margin-bottom: 8px;">Nenhuma repartiÃ§Ã£o encontrada</p>
                            <p>Ajuste os filtros ou cadastre uma nova repartiÃ§Ã£o</p>
                        </div>
                    `;
                    return;
                }


                const pacientes = SistemaCore.dados.pacientes;
                let html = '<div class="reparticoes-grid">';

                reps.forEach(rep => {
                    // Determinar tipo da repartiÃ§Ã£o (v6.8.0)
                    const tipoRep = rep.tipo_reparticao || 'consultorio';
                    const infoTipo = this.tipos[tipoRep] || this.tipos['consultorio'];
                    
                    // v7.5.1 / v10.58: Se tem sub-repartiÃ§Ãµes, renderizar APENAS o cabeÃ§alho + cards individuais
                    // IGNORA eh_grupo e verifica apenas se TEM sub-repartiÃ§Ãµes
                    if (rep.subreparticoes_ids && rep.subreparticoes_ids.length > 0) {
                        // CABEÃ‡ALHO DO GRUPO
                        html += `
                            <div style="grid-column: 1 / -1; background: linear-gradient(135deg, ${infoTipo.cor}15 0%, ${infoTipo.cor}05 100%); 
                                        border-left: 4px solid ${infoTipo.cor}; padding: 16px; border-radius: 8px; margin-top: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h3 style="margin: 0; font-size: 20px; color: var(--text);">
                                            ${infoTipo.nome.split(' ')[0]} ${rep.nome}
                                        </h3>
                                        <div style="display: flex; gap: 12px; margin-top: 8px; font-size: 14px; color: var(--text-light);">
                                            ${rep.pavilhao ? `<span>ğŸ“ ${rep.andar} - ${rep.pavilhao}</span>` : ''}
                                            ${rep.setor ? `<span>ğŸ“ ${rep.setor}</span>` : ''}
                                            <span style="font-weight: 600; color: ${infoTipo.cor};">
                                                ${rep.capacidade} ${Sistema.pluralizar(rep.capacidade, rep.padrao_nome || 'unidade')}
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: flex; gap: 8px;">
                                        <button class="btn btn-primary btn-icon" onclick="Reparticoes.editar(${rep.id})" title="Editar Grupo">
                                            âœï¸
                                        </button>
                                        <button class="btn btn-danger btn-icon" onclick="Reparticoes.excluir(${rep.id})" title="Excluir Grupo">
                                            ğŸ—‘ï¸
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        // RENDERIZAR CADA SUB-REPARTIÃ‡ÃƒO COMO CARD COMPLETO
                        rep.subreparticoes_ids.forEach(subId => {
                            const sub = SistemaCore.dados.reparticoes.find(r => r.id === subId);
                            if (!sub) return;
                            
                            // Para CONSULTÃ“RIOS e similares: mostrar agendamentos
                            // v8.0.18: Adicionar bloco_cirurgico
                            // v10.93: Adicionar exames_laboratorio e exames_imagem
                            // v10.99: CORREÃ‡ÃƒO - Usar tipo da SUB, nÃ£o do grupo
                            // v10.101: Adicionar emergencia e internacao para unificar renderizaÃ§Ã£o
                            const ehConsultorio = ['consultorio', 'procedimento', 'exames', 'exames_laboratorio', 'exames_imagem', 'bloco_cirurgico', 'emergencia', 'internacao'].includes(sub.tipo_reparticao || tipoRep);
                            
                            if (ehConsultorio) {
                                // CONSULTÃ“RIO: Mostrar TODOS os agendamentos (nÃ£o apenas hoje)
                                // v8.0.20: Corrigido para mostrar todos os agendamentos
                                // v8.7: DATA ATUAL NO TOPO
                                const agendamentosHoje = SistemaCore.dados.agendamentos.filter(a => 
                                    a.reparticao_id === sub.id
                                ).sort((a, b) => {
                                    // v8.7: Priorizar data atual no topo
                                    const hoje = new Date().toISOString().split('T')[0];
                                    const dataA = a.data;
                                    const dataB = b.data;
                                    
                                    // Se A Ã© hoje e B nÃ£o, A vem primeiro
                                    if (dataA === hoje && dataB !== hoje) return -1;
                                    // Se B Ã© hoje e A nÃ£o, B vem primeiro
                                    if (dataB === hoje && dataA !== hoje) return 1;
                                    
                                    // Caso contrÃ¡rio, ordenar normalmente por data e depois por hora
                                    if (dataA !== dataB) return dataA.localeCompare(dataB);
                                    return (a.hora || '00:00').localeCompare(b.hora || '00:00');
                                });
                                
                                const temAgendamentos = agendamentosHoje.length > 0;
                                const tipoSub = sub.tipo_reparticao || tipoRep;
                                
                                // v10.344: CORREÃ‡ÃƒO - Mostrar status correto para internaÃ§Ã£o/emergÃªncia
                                let subStatusClass, subStatusLabel;
                                if (tipoSub === 'emergencia' || tipoSub === 'internacao') {
                                    // Para internaÃ§Ã£o/emergÃªncia, mostrar status real do leito
                                    if (sub.status === 'ocupado') {
                                        subStatusClass = 'ocupado';
                                        subStatusLabel = 'ğŸ”´ OCUPADO';
                                    } else if (sub.status === 'reservado') {
                                        subStatusClass = 'reservado';
                                        subStatusLabel = 'ğŸŸ¡ RESERVADO';
                                    } else {
                                        subStatusClass = 'livre';
                                        subStatusLabel = 'ğŸŸ¢ LIVRE';
                                    }
                                } else {
                                    // Para outros tipos, usar lÃ³gica de agendamentos
                                    subStatusClass = temAgendamentos ? 'ocupado' : 'livre';
                                    subStatusLabel = temAgendamentos ? `ğŸ“… ${agendamentosHoje.length} agendamento(s)` : 'ğŸŸ¢ SEM AGENDAMENTOS';
                                }
                                
                                // v10.38: Indicador de bloqueio simplificado
                                const unidadeBloqueada = sub.bloqueado === true;
                                const estiloBloqueado = unidadeBloqueada ? 'opacity: 0.6; background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(220, 38, 38, 0.05) 10px, rgba(220, 38, 38, 0.05) 20px);' : '';
                                
                                html += `
                                    <div class="reparticao-card ${subStatusClass}" style="border-left: 4px solid ${infoTipo.cor}; ${estiloBloqueado}">
                                        <div class="reparticao-header">
                                            <h3 class="reparticao-nome">${sub.nome}${sub.campos_especificos?.precaucoes?.length > 0 ? ` <span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; display: inline-block; white-space: nowrap; max-width: 200px; overflow: hidden; text-overflow: ellipsis;">ğŸ”’ ${sub.campos_especificos.precaucoes.map(p => p.charAt(0).toUpperCase() + p.slice(1)).join(', ')}</span>` : ''}</h3>
                                            <div style="display: flex; align-items: center; gap: 8px;">
                                                ${subStatusLabel ? `<span class="reparticao-status ${subStatusClass}">${subStatusLabel}</span>` : ''}
                                                ${unidadeBloqueada ? `<span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">â›” BLOQUEADO</span>` : ''}
                                            </div>
                                        </div>
                                        
                                        ${temAgendamentos ? `
                                        <div id="agendamentos-${sub.id}" style="margin-top: 16px; display: flex; flex-direction: column; gap: 12px; max-height: 200px; overflow-y: auto;">
                                            ${agendamentosHoje.map(ag => {
                                                const pac = pacientes.find(p => p.id === ag.paciente_id);
                                                const prof = SistemaCore.dados.profissionais.find(p => p.id === ag.profissional_id);
                                                
                                                // Formatar data compacta (DD/MM/AA)
                                                const dataCompacta = ag.data ? new Date(ag.data + 'T00:00:00').toLocaleDateString('pt-BR', {
                                                    day: '2-digit',
                                                    month: '2-digit',
                                                    year: '2-digit'
                                                }) : '';
                                                
                                                // Verificar se Ã© hoje
                                                const hoje = new Date().toISOString().split('T')[0];
                                                const ehHoje = ag.data === hoje;
                                                
                                                // v9.0: Calcular duraÃ§Ãµes
                                                const duracao = ag.duracao || 30;
                                                const tipoUnidade = sub.tipo_reparticao || 'consultorio';
                                                // v9.0: Usar tempo_preparo salvo OU padrÃ£o
                                                const tempoPreparo = ag.tempo_preparo !== undefined 
                                                    ? ag.tempo_preparo 
                                                    : ((SistemaCore.dados.tempos_preparo && SistemaCore.dados.tempos_preparo[tipoUnidade]) || 10);
                                                const duracaoTotal = duracao + tempoPreparo;
                                                
                                                return `
                                                    <div class="agendamento-item-${sub.id}" style="width: 100%; box-sizing: border-box; padding: 16px; background: rgba(0,0,0,0.03); border-radius: 8px; border-left: 3px solid ${infoTipo.cor};">
                                                        <div style="display: flex; justify-content: space-between; align-items: start;">
                                                            <div style="flex: 1;">
                                                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                                                    <strong style="font-size: 16px; color: ${ehHoje ? '#ef4444' : 'var(--text)'};">â° ${ag.hora || 'Sem horÃ¡rio'}</strong>
                                                                    <span style="background: ${ehHoje ? '#ef4444' : '#3b82f6'}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                                                                        ${ehHoje ? 'HOJE' : dataCompacta}
                                                                    </span>
                                                                </div>
                                                                <div style="display: flex; gap: 12px; font-size: 12px; color: var(--text-light); margin-bottom: 8px; flex-wrap: nowrap;">
                                                                    <span style="white-space: nowrap;">â±ï¸ ${duracao}min</span>
                                                                    <span style="white-space: nowrap;">ğŸ”§ +${tempoPreparo}min</span>
                                                                    <span style="font-weight: 600; color: var(--text); white-space: nowrap;">ğŸ“Š ${duracaoTotal}min</span>
                                                                </div>
                                                                <div style="margin-top: 4px;">
                                                                    <span style="color: var(--text); font-size: 15px; font-weight: 600;">ğŸ‘¤ ${pac ? pac.nome : 'Paciente nÃ£o encontrado'}</span>
                                                                </div>
                                                                ${prof ? `<div style="font-size: 11px; color: var(--text-light); margin-top: 2px;">ğŸ‘¨â€âš•ï¸ ${prof.nome}</div>` : ''}
                                                            </div>
                                                            <button class="btn btn-info btn-icon" onclick="Atendimentos.verProntuario(${ag.paciente_id})" title="Ver ProntuÃ¡rio">
                                                                ğŸ“‹
                                                            </button>
                                                        </div>
                                                    </div>
                                                `;
                                            }).join('')}
                                        </div>
                                        ` : ((sub.tipo_reparticao || tipoRep) === 'emergencia' || (sub.tipo_reparticao || tipoRep) === 'internacao') ? `
                                        <!-- v10.344: InformaÃ§Ãµes de paciente para leitos de internaÃ§Ã£o/emergÃªncia -->
                                        ${sub.status === 'ocupado' && sub.paciente_id ? `
                                        <div class="reparticao-paciente" style="margin-top: 16px;">
                                            <div class="reparticao-paciente-nome">
                                                ğŸ‘¤ ${this.getNomePaciente(sub.paciente_id, pacientes)}
                                            </div>
                                            <div class="reparticao-paciente-info">
                                                ğŸ“… Internado: ${new Date(sub.data_ocupacao).toLocaleDateString('pt-BR', {day: '2-digit', month: '2-digit', year: '2-digit'})}
                                                <span style="font-weight: 600; color: var(--text);">(${this.getDiasInternacao(sub.data_ocupacao)} dias)</span>
                                            </div>
                                            ${sub.motivo_internacao ? `
                                            <div class="reparticao-paciente-info" style="margin-top: 4px;">
                                                Motivo: ${sub.motivo_internacao}
                                            </div>
                                            ` : ''}
                                        </div>
                                        ` : ''}
                                        ${sub.status === 'reservado' && sub.reservado_para_paciente_id ? `
                                        <div class="reparticao-paciente" style="margin-top: 16px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #ffc107;">
                                            <div class="reparticao-paciente-nome">
                                                ğŸ“… Reservado para: ${this.getNomePaciente(sub.reservado_para_paciente_id, pacientes)}
                                            </div>
                                            <div class="reparticao-paciente-info">
                                                ğŸ—“ï¸ ${new Date(sub.reservado_em).toLocaleDateString('pt-BR', {day: '2-digit', month: '2-digit', year: '2-digit'})} Ã s ${new Date(sub.reservado_em).toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'})}
                                            </div>
                                            ${sub.data_prevista_entrada ? `
                                            <div class="reparticao-paciente-info" style="margin-top: 4px;">
                                                ğŸ“† PrevisÃ£o de entrada: ${new Date(sub.data_prevista_entrada + 'T00:00:00').toLocaleDateString('pt-BR')}
                                            </div>
                                            ` : ''}
                                            ${sub.tipo_reserva ? `
                                            <div class="reparticao-paciente-info" style="margin-top: 4px;">
                                                Tipo: ${sub.tipo_reserva === 'matriciamento' ? 'ğŸ”„ Matriciamento' : 'ğŸ“… Agendamento'}
                                            </div>
                                            ` : ''}
                                        </div>
                                        ` : ''}
                                        ` : `
                                        <div style="text-align: center; padding: 20px; color: var(--text-light);">
                                            <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“…</div>
                                            <div>Nenhum agendamento</div>
                                        </div>
                                        `}

                                        <div class="reparticao-actions" style="margin-top: 16px;">
                                            ${unidadeBloqueada ? `
                                                <!-- BLOQUEADO: Apenas desbloquear -->
                                                <button class="btn btn-success btn-icon" onclick="Reparticoes.toggleBloqueio(${sub.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Desbloquear unidade">
                                                    ğŸ”“ Desbloquear
                                                </button>
                                            ` : sub.status === 'reservado' ? `
                                                <!-- v10.344: RESERVADO - Ver e Cancelar -->
                                                <button class="btn btn-info btn-icon" onclick="Reparticoes.verDetalhesReserva(${sub.id})" title="Ver Detalhes da Reserva">
                                                    ğŸ‘ï¸ Ver Reserva
                                                </button>
                                                <button class="btn btn-danger btn-icon" onclick="Reparticoes.cancelarReserva(${sub.id})" title="Cancelar Reserva">
                                                    âŒ Cancelar
                                                </button>
                                            ` : sub.status === 'ocupado' ? `
                                                <!-- v10.344: OCUPADO - ProntuÃ¡rio -->
                                                <button class="btn btn-info btn-icon" onclick="Atendimentos.verProntuario(${sub.paciente_id})" title="Ver ProntuÃ¡rio">
                                                    ğŸ“‹ ProntuÃ¡rio
                                                </button>
                                            ` : `
                                                <!-- v10.344: LIVRE - BotÃµes por tipo -->
                                                ${(sub.tipo_reparticao === 'consultorio' || sub.tipo_reparticao === 'procedimento' || sub.tipo_reparticao === 'exames' || sub.tipo_reparticao === 'exames_laboratorio' || sub.tipo_reparticao === 'exames_imagem' || sub.tipo_reparticao === 'bloco_cirurgico' || (sub.tipo_reparticao || tipoRep) === 'consultorio' || (sub.tipo_reparticao || tipoRep) === 'procedimento' || (sub.tipo_reparticao || tipoRep) === 'bloco_cirurgico') ? `
                                                <button class="btn btn-success btn-icon" onclick="Agenda.abrirModal(null, ${sub.id});" title="Novo Agendamento">
                                                    â• Agendar
                                                </button>
                                                ` : ''}
                                                ${((sub.tipo_reparticao === 'internacao' || (sub.tipo_reparticao || tipoRep) === 'internacao') && PermissoesReserva.usuarioPodeReservar()) ? `
                                                <button class="btn btn-warning btn-icon" onclick="Reparticoes.abrirModalReservar(${sub.id})" title="Reservar Leito (Matriciamento)">
                                                    âš¡ Reservar
                                                </button>
                                                ` : ''}
                                                <button class="btn btn-danger btn-icon" onclick="Reparticoes.toggleBloqueio(${sub.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Bloquear unidade">
                                                    â›” Bloquear
                                                </button>
                                            `}
                                        </div>
                                    </div>
                                `;
                            }
                            // v10.101: Bloco else removido - todos os tipos agora sÃ£o tratados no IF acima
                        });
                    } else {
                        // NÃƒO Ã© grupo - renderizar como card normal Ãºnico
                        // v8.0.20: Verificar se Ã© consultÃ³rio/procedimento/exame/bloco_cirurgico para mostrar agendamentos
                        // v10.93: Adicionar exames_laboratorio e exames_imagem
                        const ehConsultorio = ['consultorio', 'procedimento', 'exames', 'exames_laboratorio', 'exames_imagem', 'bloco_cirurgico'].includes(tipoRep);
                        
                        if (ehConsultorio) {
                            // v10.63: CABEÃ‡ALHO para consultÃ³rios/salas individuais (nÃ£o-grupo)
                            html += `
                                <div style="grid-column: 1 / -1; background: linear-gradient(135deg, ${infoTipo.cor}15 0%, ${infoTipo.cor}05 100%); 
                                            border-left: 4px solid ${infoTipo.cor}; padding: 16px; border-radius: 8px; margin-top: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <h3 style="margin: 0; color: ${infoTipo.cor}; font-size: 18px;">
                                                ${infoTipo.icone} ${rep.nome}
                                            </h3>
                                            ${rep.pavilhao || rep.setor ? `
                                            <p style="margin: 4px 0 0 0; color: var(--text-light); font-size: 14px;">
                                                ${rep.pavilhao ? `ğŸ“ ${rep.andar} - ${rep.pavilhao}` : ''}
                                                ${rep.setor ? `ğŸ“ ${rep.setor}` : ''}
                                            </p>
                                            ` : ''}
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-primary btn-icon" onclick="Reparticoes.editar(${rep.id})" title="Editar">
                                                âœï¸
                                            </button>
                                            <button class="btn btn-danger btn-icon" onclick="Reparticoes.excluir(${rep.id})" title="Excluir">
                                                ğŸ—‘ï¸
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `;
                            
                            // CONSULTÃ“RIO INDIVIDUAL: Mostrar TODOS os agendamentos
                            // v8.7: DATA ATUAL NO TOPO
                            const agendamentosRep = SistemaCore.dados.agendamentos.filter(a => 
                                a.reparticao_id === rep.id
                            ).sort((a, b) => {
                                // v8.7: Priorizar data atual no topo
                                const hoje = new Date().toISOString().split('T')[0];
                                const dataA = a.data;
                                const dataB = b.data;
                                
                                // Se A Ã© hoje e B nÃ£o, A vem primeiro
                                if (dataA === hoje && dataB !== hoje) return -1;
                                // Se B Ã© hoje e A nÃ£o, B vem primeiro
                                if (dataB === hoje && dataA !== hoje) return 1;
                                
                                // Caso contrÃ¡rio, ordenar normalmente por data e depois por hora
                                if (dataA !== dataB) return dataA.localeCompare(dataB);
                                return (a.hora || '00:00').localeCompare(b.hora || '00:00');
                            });
                            
                            const temAgendamentos = agendamentosRep.length > 0;
                            const statusClass = temAgendamentos ? 'ocupado' : 'livre';
                            const statusLabel = temAgendamentos ? `ğŸ“… ${agendamentosRep.length} agendamento(s)` : 'ğŸŸ¢ SEM AGENDAMENTOS';
                            
                            // v10.60: Indicador de bloqueio
                            const unidadeBloqueada = rep.bloqueado === true;
                            const estiloBloqueado = unidadeBloqueada ? 'opacity: 0.6; background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(220, 38, 38, 0.05) 10px, rgba(220, 38, 38, 0.05) 20px);' : '';
                            
                            html += `
                                <div class="reparticao-card ${statusClass}" style="border-left: 4px solid ${infoTipo.cor}; ${estiloBloqueado}">
                                    <div class="reparticao-header">
                                        <h3 class="reparticao-nome">${rep.nome}</h3>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span class="reparticao-status ${statusClass}">${statusLabel}</span>
                                            ${unidadeBloqueada ? `<span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">â›” BLOQUEADO</span>` : ''}
                                        </div>
                                    </div>

                                    ${rep.pavilhao || rep.setor || this.renderizarCamposEspecificos(rep, tipoRep) ? `
                                    <div class="reparticao-info">
                                        ${rep.pavilhao ? `
                                        <div class="reparticao-info-item">
                                            <strong>ğŸ“ LocalizaÃ§Ã£o:</strong> <span>${rep.andar} - ${rep.pavilhao}</span>
                                        </div>
                                        ` : ''}
                                        ${rep.setor ? `
                                        <div class="reparticao-info-item">
                                            <strong>ğŸ“ Setor:</strong> <span>${rep.setor}</span>
                                        </div>
                                        ` : ''}
                                        ${this.renderizarCamposEspecificos(rep, tipoRep)}
                                    </div>
                                    ` : ''}

                                    ${temAgendamentos ? `
                                    <div id="agendamentos-rep-${rep.id}" style="margin-top: 16px; display: flex; flex-direction: column; gap: 12px; max-height: 200px; overflow-y: auto;">
                                        ${agendamentosRep.map(ag => {
                                            const pac = pacientes.find(p => p.id === ag.paciente_id);
                                            const prof = SistemaCore.dados.profissionais.find(p => p.id === ag.profissional_id);
                                            
                                            // Formatar data compacta (DD/MM/AA)
                                            const dataCompacta = ag.data ? new Date(ag.data + 'T00:00:00').toLocaleDateString('pt-BR', {
                                                day: '2-digit',
                                                month: '2-digit',
                                                year: '2-digit'
                                            }) : '';
                                            
                                            // Verificar se Ã© hoje
                                            const hoje = new Date().toISOString().split('T')[0];
                                            const ehHoje = ag.data === hoje;
                                            
                                            // v9.0: Calcular duraÃ§Ãµes
                                            const duracao = ag.duracao || 30;
                                            const tipoUnidade = rep.tipo_reparticao || 'consultorio';
                                            // v9.0: Usar tempo_preparo salvo OU padrÃ£o
                                            const tempoPreparo = ag.tempo_preparo !== undefined 
                                                ? ag.tempo_preparo 
                                                : ((SistemaCore.dados.tempos_preparo && SistemaCore.dados.tempos_preparo[tipoUnidade]) || 10);
                                            const duracaoTotal = duracao + tempoPreparo;
                                            
                                            return `
                                                <div style="width: 100%; box-sizing: border-box; padding: 16px; background: rgba(0,0,0,0.03); border-radius: 8px; border-left: 3px solid ${infoTipo.cor};">
                                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                                        <div style="flex: 1;">
                                                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                                                <strong style="font-size: 16px; color: ${ehHoje ? '#ef4444' : 'var(--text)'};">â° ${ag.hora || 'Sem horÃ¡rio'}</strong>
                                                                <span style="background: ${ehHoje ? '#ef4444' : '#3b82f6'}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                                                                    ${ehHoje ? 'HOJE' : dataCompacta}
                                                                </span>
                                                            </div>
                                                            <div style="display: flex; gap: 12px; font-size: 12px; color: var(--text-light); margin-bottom: 8px; flex-wrap: nowrap;">
                                                                <span style="white-space: nowrap;">â±ï¸ ${duracao}min</span>
                                                                <span style="white-space: nowrap;">ğŸ”§ +${tempoPreparo}min</span>
                                                                <span style="font-weight: 600; color: var(--text); white-space: nowrap;">ğŸ“Š ${duracaoTotal}min</span>
                                                            </div>
                                                            <div style="margin-top: 4px;">
                                                                <span style="color: var(--text); font-size: 15px; font-weight: 600;">ğŸ‘¤ ${pac ? pac.nome : 'Paciente nÃ£o encontrado'}</span>
                                                            </div>
                                                            ${prof ? `<div style="font-size: 11px; color: var(--text-light); margin-top: 2px;">ğŸ‘¨â€âš•ï¸ ${prof.nome}</div>` : ''}
                                                        </div>
                                                        <button class="btn btn-info btn-icon" onclick="Atendimentos.verProntuario(${ag.paciente_id})" title="Ver ProntuÃ¡rio">
                                                            ğŸ“‹
                                                        </button>
                                                    </div>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                    ` : `
                                    <div style="text-align: center; padding: 20px; color: var(--text-light);">
                                        <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“…</div>
                                        <div>Nenhum agendamento</div>
                                    </div>
                                    `}

                                    <div class="reparticao-actions" style="margin-top: 16px;">
                                        ${rep.bloqueado ? `
                                            <!-- BLOQUEADO -->
                                            <button class="btn btn-success btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Desbloquear">
                                                ğŸ”“ Desbloquear
                                            </button>
                                        ` : `
                                            <!-- LIVRE -->
                                            <button class="btn btn-success btn-icon" onclick="Agenda.abrirModal(null, ${rep.id});" title="Novo Agendamento">
                                                â• Agendar
                                            </button>
                                            <button class="btn btn-danger btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Bloquear">
                                                â›” Bloquear
                                            </button>
                                        `}
                                    </div>
                                </div>
                            `;
                        } else {
                            // INTERNAÃ‡ÃƒO/EMERGÃŠNCIA: Status fixo
                            const statusClass = rep.status || 'livre';
                            const statusLabel = {
                                'livre': 'ğŸŸ¢ LIVRE',
                                'reservado': 'ğŸŸ¡ RESERVADO',
                                'ocupado': 'ğŸ”´ OCUPADO',
                                'em_cirurgia': 'ğŸ”´ EM CIRURGIA',
                                'desativado': 'âš« DESATIVADO'
                            }[statusClass] || 'ğŸŸ¢ LIVRE';
                            
                            // v10.60: Indicador de bloqueio
                            const leitoBloqueado = rep.bloqueado === true;
                            const estiloBloqueado = leitoBloqueado ? 'opacity: 0.6; background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(220, 38, 38, 0.05) 10px, rgba(220, 38, 38, 0.05) 20px);' : '';
                        
                            // v10.62: CABEÃ‡ALHO para leitos individuais (nÃ£o-grupo)
                            html += `
                                <div style="grid-column: 1 / -1; background: linear-gradient(135deg, ${infoTipo.cor}15 0%, ${infoTipo.cor}05 100%); 
                                            border-left: 4px solid ${infoTipo.cor}; padding: 16px; border-radius: 8px; margin-top: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <h3 style="margin: 0; color: ${infoTipo.cor}; font-size: 18px;">
                                                ${infoTipo.icone} ${rep.nome}
                                            </h3>
                                            ${rep.pavilhao || rep.setor ? `
                                            <p style="margin: 4px 0 0 0; color: var(--text-light); font-size: 14px;">
                                                ${rep.pavilhao ? `ğŸ“ ${rep.andar} - ${rep.pavilhao}` : ''}
                                                ${rep.setor ? `ğŸ“ ${rep.setor}` : ''}
                                            </p>
                                            ` : ''}
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-primary btn-icon" onclick="Reparticoes.editar(${rep.id})" title="Editar">
                                                âœï¸
                                            </button>
                                            <button class="btn btn-danger btn-icon" onclick="Reparticoes.excluir(${rep.id})" title="Excluir">
                                                ğŸ—‘ï¸
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `;
                            
                            html += `
                                <div class="reparticao-card ${statusClass}" style="border-left: 4px solid ${infoTipo.cor}; ${estiloBloqueado}">
                                    <div class="reparticao-header">
                                        <h3 class="reparticao-nome">${rep.nome}${rep.campos_especificos?.precaucoes?.length > 0 ? ` <span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; display: inline-block; white-space: nowrap; max-width: 200px; overflow: hidden; text-overflow: ellipsis;">ğŸ”’ ${rep.campos_especificos.precaucoes.map(p => p.charAt(0).toUpperCase() + p.slice(1)).join(', ')}</span>` : ''}</h3>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span class="reparticao-status ${statusClass}">${statusLabel}</span>
                                            ${leitoBloqueado ? `<span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">â›” BLOQUEADO</span>` : ''}
                                        </div>
                                    </div>

                                ${rep.pavilhao || rep.setor || this.renderizarCamposEspecificos(rep, tipoRep) ? `
                                <div class="reparticao-info">
                                    ${rep.pavilhao ? `
                                    <div class="reparticao-info-item">
                                        <strong>ğŸ“ LocalizaÃ§Ã£o:</strong> <span>${rep.andar} - ${rep.pavilhao}</span>
                                    </div>
                                    ` : ''}
                                    ${rep.setor ? `
                                    <div class="reparticao-info-item">
                                        <strong>ğŸ“ Setor:</strong> <span>${rep.setor}</span>
                                    </div>
                                    ` : ''}
                                    ${this.renderizarCamposEspecificos(rep, tipoRep)}
                                </div>
                                ` : ''}

                                ${rep.status === 'ocupado' && rep.paciente_id ? `
                                <div class="reparticao-paciente">
                                    <div class="reparticao-paciente-nome">
                                        ğŸ‘¤ ${this.getNomePaciente(rep.paciente_id, pacientes)}
                                    </div>
                                    <div class="reparticao-paciente-info">
                                        ğŸ“… Internado: ${new Date(rep.data_ocupacao).toLocaleDateString('pt-BR', {day: '2-digit', month: '2-digit', year: '2-digit'})}
                                        <span style="font-weight: 600; color: var(--text);">(${this.getDiasInternacao(rep.data_ocupacao)} dias)</span>
                                    </div>
                                    ${rep.motivo_internacao ? `
                                    <div class="reparticao-paciente-info" style="margin-top: 4px;">
                                        Motivo: ${rep.motivo_internacao}
                                    </div>
                                    ` : ''}
                                </div>
                                ` : ''}

                                ${rep.status === 'reservado' && rep.reservado_para_paciente_id ? `
                                <div class="reparticao-paciente" style="background: rgba(255, 193, 7, 0.1); border-left: 3px solid #ffc107;">
                                    <div class="reparticao-paciente-nome">
                                        ğŸ“… Reservado para: ${this.getNomePaciente(rep.reservado_para_paciente_id, pacientes)}
                                    </div>
                                    <div class="reparticao-paciente-info">
                                        ğŸ—“ï¸ ${new Date(rep.reservado_em).toLocaleDateString('pt-BR', {day: '2-digit', month: '2-digit', year: '2-digit'})} Ã s ${new Date(rep.reservado_em).toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'})}
                                    </div>
                                    ${rep.tipo_reserva ? `
                                    <div class="reparticao-paciente-info" style="margin-top: 4px;">
                                        Tipo: ${rep.tipo_reserva === 'matriciamento' ? 'ğŸ”„ Matriciamento' : 'ğŸ“… Agendamento'}
                                    </div>
                                    ` : ''}
                                </div>
                                ` : ''}

                                <div class="reparticao-actions">
                                    ${rep.bloqueado ? `
                                        <!-- BLOQUEADO: Apenas desbloquear -->
                                        <button class="btn btn-success btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id})" title="Desbloquear">
                                            ğŸ”“ Desbloquear
                                        </button>
                                    ` : rep.status === 'livre' ? `
                                        <!-- v10.100: LIVRE - BotÃµes por tipo -->
                                        ${(tipoRep === 'internacao' || tipoRep === 'emergencia') && PermissoesReserva.usuarioPodeReservar() ? `
                                        <button class="btn btn-warning btn-icon" onclick="Reparticoes.abrirModalReservar(${rep.id})" title="Reservar Leito (Matriciamento)">
                                            âš¡ Reservar
                                        </button>
                                        ` : ''}
                                        <button class="btn btn-danger btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id})" title="Bloquear ${tipoRep === 'emergencia' ? 'leito' : 'unidade'}">
                                            â›” Bloquear
                                        </button>
                                    ` : rep.status === 'reservado' && tipoRep !== 'emergencia' ? `
                                        <!-- RESERVADO: Ver + Cancelar (NÃƒO para emergÃªncia) -->
                                        <button class="btn btn-info btn-icon" onclick="Reparticoes.verDetalhesReserva(${rep.id})" title="Ver Detalhes da Reserva">
                                            ğŸ‘ï¸ Ver Reserva
                                        </button>
                                        <button class="btn btn-danger btn-icon" onclick="Reparticoes.cancelarReserva(${rep.id})" title="Cancelar Reserva">
                                            âŒ Cancelar
                                        </button>
                                    ` : rep.status === 'ocupado' ? `
                                        <!-- OCUPADO: Apenas prontuÃ¡rio (alta Ã© via prontuÃ¡rio) -->
                                        <button class="btn btn-info btn-icon" onclick="Atendimentos.verProntuario(${rep.paciente_id})" title="Ver ProntuÃ¡rio">
                                            ğŸ“‹ ProntuÃ¡rio
                                        </button>
                                    ` : ''}
                                </div>
                            </div>
                        `;
                        } // Fecha o else de internaÃ§Ã£o/emergÃªncia
                    }
                });

                html += '</div>';
                container.innerHTML = html;
            },

            renderizarCamposEspecificos(rep, tipo) {
                if (!rep.campos_especificos) return '';
                
                const campos = rep.campos_especificos;
                let html = '';

                switch(tipo) {
                    case 'consultorio':
                        if (campos.horario) html += `<div class="reparticao-info-item"><strong>ğŸ• HorÃ¡rio:</strong> ${campos.horario}</div>`;
                        break;
                    case 'procedimento':
                        if (campos.tipos_procedimentos) html += `<div class="reparticao-info-item"><strong>ğŸ”§ Procedimentos:</strong> ${campos.tipos_procedimentos.substring(0, 50)}...</div>`;
                        break;
                    case 'emergencia':
                        if (campos.nivel) html += `<div class="reparticao-info-item"><strong>ğŸ“Š NÃ­vel:</strong> ${campos.nivel.replace('_', ' ')}</div>`;
                        break;
                    case 'internacao':
                        if (campos.numero_leito) html += `<div class="reparticao-info-item"><strong>ğŸ›ï¸ Leito:</strong> ${campos.numero_leito}</div>`;
                        if (campos.tipo_acomodacao) html += `<div class="reparticao-info-item"><strong>ğŸ  Tipo:</strong> ${campos.tipo_acomodacao}</div>`;
                        break;
                    case 'bloco_cirurgico':
                        if (campos.numero_sala) html += `<div class="reparticao-info-item"><strong>âš•ï¸ Sala:</strong> ${campos.numero_sala}</div>`;
                        if (campos.tipos_cirurgia) html += `<div class="reparticao-info-item"><strong>ğŸ”ª Cirurgias:</strong> ${campos.tipos_cirurgia.substring(0, 40)}...</div>`;
                        break;
                    case 'exames':
                        if (campos.tipo_exame) html += `<div class="reparticao-info-item"><strong>ğŸ”¬ Tipo:</strong> ${campos.tipo_exame}</div>`;
                        break;
                }

                return html;
            },

            // v6.8.2: Renderizar sub-repartiÃ§Ãµes (leitos, salas, etc)
            renderizarSubreparticoes(ids, pacientes) {
                if (!ids || ids.length === 0) return '';
                
                let html = '';
                ids.forEach(id => {
                    const sub = SistemaCore.dados.reparticoes.find(r => r.id === id);
                    if (!sub) return;
                    
                    const statusIcon = {
                        'livre': 'ğŸŸ¢',
                        'ocupado': 'ğŸ”´',
                        'em_cirurgia': 'ğŸ”´',
                        'desativado': 'âš«',
                        'reservado': 'ğŸŸ¡'
                    }[sub.status] || 'ğŸŸ¢';
                    
                    const pacienteInfo = sub.status === 'ocupado' && sub.paciente_id ? 
                        `<br><small style="font-size: 0.85em;">${this.getNomePaciente(sub.paciente_id, pacientes)}</small>` : '';
                    
                    html += `
                        <div style="padding: 6px; border: 1px solid var(--border); border-radius: 4px; font-size: 0.9em; cursor: pointer; transition: all 0.2s;" 
                             onclick="Reparticoes.abrirDetalhesSubreparticao(${sub.id})"
                             title="Clique para detalhes">
                            ${statusIcon} ${sub.nome}${pacienteInfo}
                        </div>
                    `;
                });
                
                return html;
            },

            // v6.8.2: Detalhes de sub-repartiÃ§Ã£o
            abrirDetalhesSubreparticao(id) {
                const sub = SistemaCore.dados.reparticoes.find(r => r.id === id);
                if (!sub) return;
                
                const statusLabel = {
                    'livre': 'ğŸŸ¢ Livre',
                    'ocupado': 'ğŸ”´ Ocupado',
                    'reservado': 'ğŸŸ¡ Reservado',
                    'desativado': 'âš« Desativado'
                }[sub.status] || 'ğŸŸ¢ Livre';
                
                let msg = `${sub.nome}\n\nStatus: ${statusLabel}\n`;
                
                if (sub.status === 'ocupado' && sub.paciente_id) {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === sub.paciente_id);
                    msg += `\nPaciente: ${paciente ? paciente.nome : 'NÃ£o encontrado'}`;
                    if (sub.data_ocupacao) {
                        msg += `\nInternado hÃ¡: ${this.getDiasInternacao(sub.data_ocupacao)} dias`;
                    }
                }
                
                msg += '\n\nAÃ§Ãµes disponÃ­veis:';
                if (sub.status === 'livre') {
                    msg += '\nâ€¢ Internar paciente';
                } else if (sub.status === 'ocupado') {
                    msg += '\nâ€¢ Ver prontuÃ¡rio';
                    msg += '\nâ€¢ Dar alta';
                }
                
                // Por enquanto sÃ³ alerta. Depois pode abrir modal especÃ­fico
                alert(msg);
            },

            trocarTipoReparticao() {
                const tipo = document.getElementById('rep-tipo-reparticao').value;
                console.log('ğŸ”„ [DEBUG] Tipo de repartiÃ§Ã£o selecionado:', tipo);
                
                // Esconder todos os campos especÃ­ficos
                document.querySelectorAll('.campos-tipo').forEach(div => {
                    div.style.display = 'none';
                });
                
                // Mostrar campos do tipo selecionado
                if (tipo) {
                    const camposDiv = document.getElementById(`campos-tipo-${tipo}`);
                    if (camposDiv) {
                        camposDiv.style.display = 'block';
                    }
                }
                
                // v7.9.9: Marcar/Desmarcar "Aceita todas especialidades" automaticamente
                const checkboxAceitaTodas = document.getElementById('rep-aceita-todas-esp');
                if (tipo) {
                    // âœ… v10.76: TODOS os tipos aceitam todas especialidades por padrÃ£o
                    console.log('âœ… [DEBUG] Marcando checkbox automaticamente para:', tipo);
                    checkboxAceitaTodas.checked = true;
                    this.toggleEspecialidades();
                }
                
                // v6.8.2: Mostrar campo de capacidade para tipos especÃ­ficos
                this.mostrarCampoCapacidade(tipo);
            },

            // v6.8.2: Mostrar campo de capacidade conforme tipo
            mostrarCampoCapacidade(tipo) {
                const campoCapacidade = document.getElementById('campo-capacidade');
                const labelCapacidade = document.getElementById('label-capacidade');
                const hintCapacidade = document.getElementById('hint-capacidade');
                const padraoNome = document.getElementById('rep-padrao-nome');
                
                const config = {
                    'internacao': {
                        mostrar: true,
                        label: 'Quantidade de Leitos',
                        hint: 'â„¹ï¸ Sistema criarÃ¡ os leitos automaticamente (Leito 1, Leito 2...)',
                        padrao: 'Leito'
                    },
                    'bloco_cirurgico': {
                        mostrar: true,
                        label: 'Quantidade de Salas',
                        hint: 'â„¹ï¸ Sistema criarÃ¡ as salas automaticamente (Sala 1, Sala 2...)',
                        padrao: 'Sala'
                    },
                    'consultorio': {
                        mostrar: true,
                        label: 'Quantidade de ConsultÃ³rios',
                        hint: 'â„¹ï¸ Sistema criarÃ¡ os consultÃ³rios automaticamente',
                        padrao: 'ConsultÃ³rio'
                    },
                    'procedimento': {
                        mostrar: true,
                        label: 'Quantidade de Salas',
                        hint: 'â„¹ï¸ Sistema criarÃ¡ as salas automaticamente (Sala 1, Sala 2...)',
                        padrao: 'Sala'
                    },
                    'exames': {
                        mostrar: true,
                        label: 'Quantidade de Salas',
                        hint: 'â„¹ï¸ Sistema criarÃ¡ as salas automaticamente',
                        padrao: 'Sala'
                    },
                    'exames_laboratorio': {
                        mostrar: true,
                        label: 'Quantidade de Salas',
                        hint: 'â„¹ï¸ Sistema criarÃ¡ as salas automaticamente',
                        padrao: 'Sala'
                    },
                    'exames_imagem': {
                        mostrar: true,
                        label: 'Quantidade de Salas',
                        hint: 'â„¹ï¸ Sistema criarÃ¡ as salas automaticamente',
                        padrao: 'Sala'
                    },
                    'emergencia': {
                        mostrar: true,
                        label: 'Quantidade de Leitos / Boxes',
                        hint: 'â„¹ï¸ Sistema criarÃ¡ os leitos / boxes automaticamente',
                        padrao: 'Leito'
                    }
                };
                
                const conf = config[tipo];
                if (conf && conf.mostrar) {
                    campoCapacidade.style.display = 'block';
                    labelCapacidade.textContent = conf.label;
                    hintCapacidade.textContent = conf.hint;
                    // SÃ³ define o padrÃ£o se o campo estiver vazio (nova repartiÃ§Ã£o)
                    if (!padraoNome.value) {
                        padraoNome.value = conf.padrao;
                    }
                } else {
                    campoCapacidade.style.display = 'none';
                }
            },

            // v6.8.2: Carregar pools nos selects
            // v10.60.7: MELHORADO - OrdenaÃ§Ã£o alfabÃ©tica
            carregarPools() {
                // PavilhÃµes (v10.78: mudado para datalist)
                const datalistPavilhao = document.getElementById('pavilhoes-list');
                if (datalistPavilhao && SistemaCore.dados.estabelecimento.pavilhoes) {
                    // âœ… v10.60.7: Ordenar alfabeticamente com localeCompare para portuguÃªs
                    const pavilhoesOrdenados = [...SistemaCore.dados.estabelecimento.pavilhoes]
                        .sort((a, b) => a.localeCompare(b, 'pt-BR'));
                    
                    datalistPavilhao.innerHTML = '';
                    pavilhoesOrdenados.forEach(p => {
                        const option = document.createElement('option');
                        option.value = p;
                        datalistPavilhao.appendChild(option);
                    });
                }
                
                // Andares (v10.78: mudado para datalist)
                const datalistAndar = document.getElementById('andares-list');
                if (datalistAndar && SistemaCore.dados.estabelecimento.andares) {
                    // âœ… v10.60.7: Ordenar alfabeticamente
                    const andaresOrdenados = [...SistemaCore.dados.estabelecimento.andares]
                        .sort((a, b) => a.localeCompare(b, 'pt-BR'));
                    
                    datalistAndar.innerHTML = '';
                    andaresOrdenados.forEach(a => {
                        const option = document.createElement('option');
                        option.value = a;
                        datalistAndar.appendChild(option);
                    });
                }
                
                // Setores (v10.78: mudado para datalist)
                const datalistSetor = document.getElementById('setores-list');
                if (datalistSetor && SistemaCore.dados.estabelecimento.setores) {
                    // âœ… v10.60.7: Ordenar alfabeticamente
                    const setoresOrdenados = [...SistemaCore.dados.estabelecimento.setores]
                        .sort((a, b) => a.localeCompare(b, 'pt-BR'));
                    
                    datalistSetor.innerHTML = '';
                    setoresOrdenados.forEach(s => {
                        const option = document.createElement('option');
                        option.value = s;
                        datalistSetor.appendChild(option);
                    });
                }
                
                // v9.7.4: Nomes sugeridos (v10.78: mudado para datalist)
                const datalistNomes = document.getElementById('nomes-sugeridos-list');
                if (datalistNomes) {
                    if (!SistemaCore.dados.pools.nomes_sugeridos) {
                        SistemaCore.dados.pools.nomes_sugeridos = [
                            'ConsultÃ³rio', 'Sala', 'Leito', 'Box', 'Quarto',
                            'Enfermaria', 'Ala', 'Posto'
                        ];
                    }
                    
                    // Ordenar alfabeticamente
                    const nomesOrdenados = [...SistemaCore.dados.pools.nomes_sugeridos]
                        .sort((a, b) => a.localeCompare(b, 'pt-BR'));
                    
                    datalistNomes.innerHTML = '';
                    nomesOrdenados.forEach(n => {
                        const option = document.createElement('option');
                        option.value = n;
                        datalistNomes.appendChild(option);
                    });
                }
            },

            // v9.7.4: Adicionar nome Ã  lista de sugestÃµes
            adicionarNomeSugerido() {
                const input = document.getElementById('rep-nome');
                const valor = input.value.trim();
                
                if (!valor) {
                    alert('âš ï¸ Digite um nome primeiro!');
                    return;
                }
                
                if (!SistemaCore.dados.pools.nomes_sugeridos) {
                    SistemaCore.dados.pools.nomes_sugeridos = [];
                }
                
                // Verificar se jÃ¡ existe
                if (SistemaCore.dados.pools.nomes_sugeridos.includes(valor)) {
                    Sistema.notificar(`"${valor}" jÃ¡ estÃ¡ na lista!`, 'warning');
                    return;
                }
                
                // Adicionar
                SistemaCore.dados.pools.nomes_sugeridos.push(valor);
                SistemaCore.dados.pools.nomes_sugeridos.sort();
                SistemaCore.salvar();
                
                // Recarregar
                this.carregarPools();
                
                Sistema.notificar(`âœ… "${valor}" adicionado Ã s sugestÃµes!`);
            },
            
            // v9.7.4: Deletar nome da lista de sugestÃµes
            deletarNomeSugerido() {
                const input = document.getElementById('rep-nome');
                const valor = input.value.trim();
                
                if (!valor) {
                    alert('âš ï¸ Digite ou selecione o nome que deseja remover!');
                    return;
                }
                
                if (!SistemaCore.dados.pools.nomes_sugeridos) {
                    SistemaCore.dados.pools.nomes_sugeridos = [];
                }
                
                const index = SistemaCore.dados.pools.nomes_sugeridos.indexOf(valor);
                
                if (index === -1) {
                    alert(`âš ï¸ "${valor}" nÃ£o estÃ¡ na lista de sugestÃµes!`);
                    return;
                }
                
                if (confirm(`âš ï¸ Remover "${valor}" da lista de sugestÃµes?\n\n(Isso nÃ£o afeta repartiÃ§Ãµes jÃ¡ criadas)`)) {
                    SistemaCore.dados.pools.nomes_sugeridos.splice(index, 1);
                    SistemaCore.salvar();
                    
                    // Recarregar
                    this.carregarPools();
                    
                    // Limpar campo
                    input.value = '';
                    
                    Sistema.notificar('âœ… SugestÃ£o removida!');
                }
            },

            // v9.7.3: Contar uso de um item do pool
            contarUsoPool(chave, valor) {
                let contador = 0;
                if (SistemaCore.dados.reparticoes) {
                    SistemaCore.dados.reparticoes.forEach(r => {
                        if (chave === 'pavilhoes' && r.pavilhao === valor) contador++;
                        if (chave === 'andares' && r.andar === valor) contador++;
                        if (chave === 'setores' && r.setor === valor) contador++;
                    });
                }
                return contador;
            },

            // v9.7.2: Deletar item selecionado no select
            deletarDoSelect(tipo) {
                const labels = {
                    'pavilhao': 'PavilhÃ£o/Ala/Bloco',
                    'andar': 'Andar',
                    'setor': 'Setor'
                };
                
                const selectId = 'rep-' + tipo;
                const select = document.getElementById(selectId);
                const valor = select.value;
                
                if (!valor || valor === '') {
                    alert(`âš ï¸ Selecione um ${labels[tipo]} para deletar!`);
                    return;
                }
                
                // Contar uso
                const pool = tipo === 'pavilhao' ? SistemaCore.dados.estabelecimento.pavilhoes :
                            tipo === 'andar' ? SistemaCore.dados.estabelecimento.andares :
                            SistemaCore.dados.estabelecimento.setores;
                
                const chavePool = tipo === 'pavilhao' ? 'pavilhoes' :
                                 tipo === 'andar' ? 'andares' : 'setores';
                
                const uso = this.contarUsoPool(chavePool, valor);
                
                // Se estÃ¡ em uso, bloquear
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL REMOVER!\n\nEste item estÃ¡ sendo usado em ${uso} registro(s).\n\nPara remover:\n1. Primeiro edite os registros que usam "${valor}"\n2. Depois volte aqui para remover`);
                    return;
                }
                
                // Confirmar deleÃ§Ã£o
                if (confirm(`âš ï¸ Tem certeza que deseja remover?\n\n"${valor}"`)) {
                    const index = pool.indexOf(valor);
                    if (index > -1) {
                        pool.splice(index, 1);
                        SistemaCore.salvar();
                        Sistema.notificar('âœ… Item removido com sucesso!');
                        
                        // Recarregar selects
                        this.carregarPools();
                    }
                }
            },

            // v6.8.2: Adicionar novo item ao pool
            adicionarAoPool(tipo) {
                const labels = {
                    'pavilhao': 'PavilhÃ£o/Ala/Bloco',
                    'andar': 'Andar',
                    'setor': 'Setor'
                };
                
                const valor = prompt(`Digite o novo ${labels[tipo]}:`);
                if (!valor || !valor.trim()) return;
                
                const valorTrim = valor.trim();
                
                // Verificar se jÃ¡ existe
                const pool = tipo === 'pavilhao' ? SistemaCore.dados.estabelecimento.pavilhoes :
                            tipo === 'andar' ? SistemaCore.dados.estabelecimento.andares :
                            SistemaCore.dados.estabelecimento.setores;
                
                if (pool.includes(valorTrim)) {
                    Sistema.notificar(`"${valorTrim}" jÃ¡ existe!`, 'error');
                    return;
                }
                
                // Adicionar ao pool
                pool.push(valorTrim);
                pool.sort();
                SistemaCore.salvar();
                
                // Recarregar selects
                this.carregarPools();
                
                // Selecionar o novo item
                const selectId = 'rep-' + tipo;
                document.getElementById(selectId).value = valorTrim;
                
                Sistema.notificar(`âœ… "${valorTrim}" adicionado!`);
            },

            // v6.8.2: Criar sub-repartiÃ§Ãµes automaticamente
            criarSubreparticoes(reparticaoPai, quantidade, padraoNome) {
                console.log('ğŸ¯ğŸ¯ğŸ¯ DENTRO DE criarSubreparticoes! ğŸ¯ğŸ¯ğŸ¯');
                
                const subreparticoes = [];
                
                // ğŸ”´ FASE 2 - OpÃ§Ã£o A: Pegar configuraÃ§Ãµes avanÃ§adas
                const prefixo = document.getElementById('rep-prefixo')?.value.trim() || '';
                const numeroInicial = parseInt(document.getElementById('rep-numeracao-inicial')?.value) || 1;
                const leitosIsoladosStr = document.getElementById('rep-leitos-isolados')?.value.trim() || '';
                const numerosIsolados = this.parsearNumerosIsolados(leitosIsoladosStr);
                
                const precaucoesPai = reparticaoPai.campos_especificos?.precaucoes || [];
                console.log('Prefixo:', prefixo, '| NÃºmero inicial:', numeroInicial, '| Leitos isolados:', leitosIsoladosStr);
                console.log('PrecauÃ§Ãµes do PAI:', JSON.stringify(precaucoesPai));
                console.log('NÃºmeros isolados PARSED:', JSON.stringify(numerosIsolados));
                
                console.log('ğŸ—ï¸ [CRIAR LEITOS] Criando', quantidade, 'sub-repartiÃ§Ãµes');
                console.log('ğŸ—ï¸ [CRIAR LEITOS] Prefixo:', prefixo || 'nenhum');
                console.log('ğŸ—ï¸ [CRIAR LEITOS] NÃºmero inicial:', numeroInicial);
                console.log('ğŸ—ï¸ [CRIAR LEITOS] Leitos isolados STRING:', leitosIsoladosStr);
                console.log('ğŸ—ï¸ [CRIAR LEITOS] NÃºmeros isolados PARSED:', numerosIsolados);
                console.log('ğŸ—ï¸ [CRIAR LEITOS] reparticaoPai completo:', reparticaoPai);
                console.log('ğŸ—ï¸ [CRIAR LEITOS] ConfiguraÃ§Ãµes do pai:', {
                    aceita_todas: reparticaoPai.aceita_todas_especialidades,
                    especialidades: reparticaoPai.especialidades_permitidas,
                    precaucoes: reparticaoPai.campos_especificos?.precaucoes
                });
                
                for (let i = 0; i < quantidade; i++) {
                    const numeroLeito = numeroInicial + i;
                    const ehIsolado = numerosIsolados.includes(numeroLeito);
                    const subId = SistemaCore.proximoId(SistemaCore.dados.reparticoes);
                    
                    console.log(`ğŸ” [UNIDADE ${numeroLeito}] Criando... Ã© isolado? ${ehIsolado}`);
                    console.log(`ğŸ” [UNIDADE ${numeroLeito}] nÃºmeros isolados contÃ©m ${numeroLeito}?`, numerosIsolados.includes(numeroLeito));
                    
                    // âœ… v10.76: Copiar campos do pai MAS EXCLUIR precauÃ§Ãµes
                    const { precaucoes, ...camposSemPrecaucoes } = reparticaoPai.campos_especificos || {};
                    const camposEspecificos = { ...camposSemPrecaucoes };
                    
                    console.log(`ğŸ” [UNIDADE ${numeroLeito}] Campos copiados do pai (SEM precauÃ§Ãµes):`, camposEspecificos);
                    
                    // âœ… v10.76: Adicionar precauÃ§Ãµes APENAS se for isolado
                    if (ehIsolado) {
                        // Unidade isolada recebe as precauÃ§Ãµes do grupo
                        camposEspecificos.precaucoes = [...(precaucoes || [])];
                        console.log(`ğŸ”’ [UNIDADE ${numeroLeito}] ISOLADA! Aplicando precauÃ§Ãµes:`, camposEspecificos.precaucoes);
                    } else {
                        // Unidade normal NÃƒO tem precauÃ§Ãµes (campo nem existe)
                        console.log(`âœ… [UNIDADE ${numeroLeito}] NORMAL - SEM precauÃ§Ãµes (campo nÃ£o existe)`);
                    }
                    
                    const sub = {
                        id: subId,
                        nome: prefixo ? `${padraoNome} ${prefixo}${numeroLeito}` : `${padraoNome} ${numeroLeito}`,
                        tipo_reparticao: reparticaoPai.tipo_reparticao,
                        pavilhao: reparticaoPai.pavilhao,
                        andar: reparticaoPai.andar,
                        setor: reparticaoPai.setor,
                        status: reparticaoPai.status || 'livre',
                        eh_subreparticao: true,
                        reparticao_pai_id: reparticaoPai.id,
                        observacoes: `Sub-repartiÃ§Ã£o de: ${reparticaoPai.nome}`,
                        campos_especificos: camposEspecificos,
                        aceita_todas_especialidades: reparticaoPai.aceita_todas_especialidades || false,
                        especialidades_permitidas: reparticaoPai.especialidades_permitidas ? [...reparticaoPai.especialidades_permitidas] : []
                    };
                    
                    console.log(`ğŸ“‹ [UNIDADE ${numeroLeito}] Objeto criado:`, {
                        nome: sub.nome,
                        campos_especificos: sub.campos_especificos,
                        tem_precaucoes: !!sub.campos_especificos.precaucoes
                    });
                    
                    const precaucoesLog = ehIsolado && camposEspecificos.precaucoes && camposEspecificos.precaucoes.length > 0
                        ? `ğŸ”’ ISOLADA [${camposEspecificos.precaucoes.join(', ')}]` 
                        : 'âœ… NORMAL';
                    
                    console.log(`âœ… [CRIAR] ${sub.nome} â†’ ${precaucoesLog}`);
                    
                    SistemaCore.dados.reparticoes.push(sub);
                    subreparticoes.push(subId);
                }
                
                const qtdIsolados = numerosIsolados.filter(n => n >= numeroInicial && n < numeroInicial + quantidade).length;
                console.log(`âœ… [CRIAR LEITOS] ${quantidade} leitos criados (${qtdIsolados} isolados)!`);
                return subreparticoes;
            },

            // ğŸ”´ FASE 2 - Parsear string de nÃºmeros isolados (ex: "8", "8,9", "8-10")
            parsearNumerosIsolados(str) {
                if (!str || str.trim() === '') return [];
                
                const numeros = new Set();
                const partes = str.split(',').map(p => p.trim());
                
                partes.forEach(parte => {
                    if (parte.includes('-')) {
                        // Intervalo: "8-10" = [8, 9, 10]
                        const [inicio, fim] = parte.split('-').map(n => parseInt(n.trim()));
                        if (!isNaN(inicio) && !isNaN(fim)) {
                            for (let i = inicio; i <= fim; i++) {
                                numeros.add(i);
                            }
                        }
                    } else {
                        // NÃºmero Ãºnico: "8" = [8]
                        const num = parseInt(parte);
                        if (!isNaN(num)) {
                            numeros.add(num);
                        }
                    }
                });
                
                return Array.from(numeros).sort((a, b) => a - b);
            },

            getNomePaciente(id, pacientes) {
                const paciente = pacientes.find(p => p.id === id);
                return paciente ? paciente.nome : 'Paciente nÃ£o encontrado';
            },

            getDiasInternacao(dataOcupacao) {
                const agora = new Date();
                const inicio = new Date(dataOcupacao);
                const diff = Math.floor((agora - inicio) / (1000 * 60 * 60 * 24));
                return diff;
            },

            calcularDiasInternado(dataInternacao, dataAlta) {
                const inicio = new Date(dataInternacao);
                const fim = new Date(dataAlta);
                const diff = Math.floor((fim - inicio) / (1000 * 60 * 60 * 24));
                return diff > 0 ? diff : 1;
            },

            abrirModal(id = null) {
                // v6.8.2: Carregar pools primeiro
                this.carregarPools();
                
                // v10.5: Carregar selects de deletar
                this.carregarNomesDatalist();
                this.carregarSelectDeletarNomes();
                this.carregarSelectDeletarPavilhoes();
                this.carregarSelectDeletarAndares();
                this.carregarSelectDeletarSetores();
                
                if (id) {
                    const rep = SistemaCore.dados.reparticoes.find(r => r.id === id);
                    if (!rep) return;
                    
                    document.getElementById('tituloModalReparticao').textContent = 'âœï¸ Editar RepartiÃ§Ã£o';
                    document.getElementById('edit-reparticao-id').value = rep.id;
                    document.getElementById('rep-nome').value = rep.nome;
                    document.getElementById('rep-tipo-reparticao').value = rep.tipo_reparticao || 'consultorio';
                    document.getElementById('rep-pavilhao').value = rep.pavilhao || '';
                    document.getElementById('rep-andar').value = rep.andar || '';
                    document.getElementById('rep-setor').value = rep.setor || '';
                    document.getElementById('rep-observacoes').value = rep.observacoes || '';
                    
                    // Mostrar campos do tipo PRIMEIRO
                    this.trocarTipoReparticao();
                    
                    // DEPOIS carregar valores salvos (que sobrescrevem os padrÃµes se necessÃ¡rio)
                    // v6.8.2: Capacidade
                    if (rep.eh_grupo && rep.capacidade) {
                        document.getElementById('rep-capacidade').value = rep.capacidade;
                        document.getElementById('rep-padrao-nome').value = rep.padrao_nome || '';
                        
                        // âœ… v10.78: Carregar campos de configuraÃ§Ã£o avanÃ§ada
                        // Tentar identificar prefixo, numeraÃ§Ã£o inicial e isolamento das sub-repartiÃ§Ãµes existentes
                        
                        let prefixoIdentificado = '';
                        let numeracaoInicialIdentificada = 1;
                        
                        // ğŸ” Analisar sub-repartiÃ§Ãµes para identificar padrÃµes
                        if (rep.subreparticoes_ids && rep.subreparticoes_ids.length > 0) {
                            const numerosIsolados = [];
                            
                            // Pegar a primeira sub-repartiÃ§Ã£o para anÃ¡lise de padrÃ£o
                            const primeiraSub = SistemaCore.dados.reparticoes.find(r => r.id === rep.subreparticoes_ids[0]);
                            
                            if (primeiraSub) {
                                // Remover o padrÃ£o de nome do inÃ­cio
                                const padrao = rep.padrao_nome || '';
                                let restante = primeiraSub.nome;
                                
                                if (padrao && restante.startsWith(padrao)) {
                                    restante = restante.substring(padrao.length).trim();
                                }
                                
                                // Tentar extrair prefixo e nÃºmero
                                // PadrÃµes possÃ­veis: "801-5", "5", "A-5", etc
                                const match = restante.match(/^([^\d]*)(\d+)$/);
                                if (match) {
                                    prefixoIdentificado = match[1]; // Tudo antes do nÃºmero
                                    numeracaoInicialIdentificada = parseInt(match[2]); // O nÃºmero
                                    
                                    console.log('ğŸ” [EDITAR] PadrÃ£o identificado:', {
                                        nome_completo: primeiraSub.nome,
                                        padrao: padrao,
                                        prefixo: prefixoIdentificado || '(nenhum)',
                                        numeracao_inicial: numeracaoInicialIdentificada
                                    });
                                }
                            }
                            
                            // Identificar quais sub-repartiÃ§Ãµes sÃ£o isoladas
                            rep.subreparticoes_ids.forEach(subId => {
                                const sub = SistemaCore.dados.reparticoes.find(r => r.id === subId);
                                if (sub && sub.campos_especificos?.precaucoes && sub.campos_especificos.precaucoes.length > 0) {
                                    // Extrair o nÃºmero da sub-repartiÃ§Ã£o (Ãºltimo nÃºmero do nome)
                                    const match = sub.nome.match(/(\d+)$/);
                                    if (match) {
                                        numerosIsolados.push(parseInt(match[1]));
                                    }
                                }
                            });
                            
                            // Preencher campos identificados
                            document.getElementById('rep-prefixo').value = prefixoIdentificado;
                            document.getElementById('rep-numeracao-inicial').value = numeracaoInicialIdentificada;
                            
                            if (numerosIsolados.length > 0) {
                                document.getElementById('rep-leitos-isolados').value = numerosIsolados.sort((a, b) => a - b).join(',');
                                console.log('ğŸ“‹ [EDITAR] NÃºmeros isolados identificados:', numerosIsolados);
                            } else {
                                document.getElementById('rep-leitos-isolados').value = '';
                            }
                        } else {
                            // Sem sub-repartiÃ§Ãµes, usar valores padrÃ£o
                            document.getElementById('rep-prefixo').value = '';
                            document.getElementById('rep-numeracao-inicial').value = '1';
                            document.getElementById('rep-leitos-isolados').value = '';
                        }
                        
                        // âœ… v10.78: Campos TOTALMENTE LIBERADOS para ediÃ§Ã£o
                        // Agora o usuÃ¡rio pode: diminuir capacidade, mudar padrÃ£o, alterar prefixo, mudar numeraÃ§Ã£o inicial
                        document.getElementById('rep-capacidade').min = 1;
                        document.getElementById('rep-padrao-nome').disabled = false;
                        document.getElementById('rep-capacidade').title = '';
                        document.getElementById('rep-padrao-nome').title = '';
                        
                        console.log('âœ… [EDITAR] Todos os campos de capacidade liberados para ediÃ§Ã£o');
                        console.log('ğŸ“Š [EDITAR] Capacidade atual:', rep.capacidade, '| Sub-repartiÃ§Ãµes:', rep.subreparticoes_ids?.length || 0);
                    }
                    
                    // Carregar campos especÃ­ficos (ou deixar vazios se nÃ£o existirem)
                    if (rep.campos_especificos) {
                        this.carregarCamposEspecificos(rep.tipo_reparticao, rep.campos_especificos);
                    } else {
                        // FALLBACK: Se nÃ£o hÃ¡ campos salvos, deixar vazios mas visÃ­veis
                        console.log('âš ï¸ RepartiÃ§Ã£o sem campos_especificos salvos. Deixando campos vazios.');
                    }
                    
                    // v7.8: Carregar especialidades
                    const aceitaTodas = rep.aceita_todas_especialidades || false;
                    document.getElementById('rep-aceita-todas-esp').checked = aceitaTodas;
                    
                    if (!aceitaTodas && rep.especialidades_permitidas && rep.especialidades_permitidas.length > 0) {
                        document.getElementById('rep-especialidades-hidden').value = rep.especialidades_permitidas.join('|');
                    } else {
                        document.getElementById('rep-especialidades-hidden').value = '';
                    }
                    
                    this.toggleEspecialidades();
                    this.renderizarEspecialidades();
                } else {
                    document.getElementById('tituloModalReparticao').textContent = 'â• Nova RepartiÃ§Ã£o';
                    document.getElementById('edit-reparticao-id').value = '';
                    document.getElementById('rep-nome').value = '';
                    document.getElementById('rep-tipo-reparticao').value = '';
                    document.getElementById('rep-pavilhao').value = '';
                    document.getElementById('rep-andar').value = '';
                    document.getElementById('rep-setor').value = '';
                    document.getElementById('rep-observacoes').value = '';
                    document.getElementById('rep-capacidade').value = '1';
                    document.getElementById('rep-padrao-nome').value = '';
                    
                    // ğŸ”´ FASE 2 - Limpar novos campos de configuraÃ§Ã£o avanÃ§ada
                    document.getElementById('rep-prefixo').value = '';
                    document.getElementById('rep-numeracao-inicial').value = '1';
                    document.getElementById('rep-leitos-isolados').value = '';
                    
                    // Habilitar campos de capacidade (podem ter sido desabilitados na ediÃ§Ã£o)
                    document.getElementById('rep-capacidade').disabled = false;
                    document.getElementById('rep-capacidade').min = 1;
                    document.getElementById('rep-padrao-nome').disabled = false;
                    document.getElementById('rep-capacidade').title = '';
                    document.getElementById('rep-padrao-nome').title = '';
                    
                    // Limpar todos os campos especÃ­ficos
                    document.querySelectorAll('.campos-tipo').forEach(div => {
                        div.style.display = 'none';
                        div.querySelectorAll('input, select, textarea').forEach(input => {
                            if (input.type === 'checkbox') {
                                input.checked = false;
                            } else {
                                input.value = '';
                            }
                        });
                    });
                    
                    // v7.8: Limpar especialidades
                    document.getElementById('rep-aceita-todas-esp').checked = false;
                    document.getElementById('rep-especialidades-hidden').value = '';
                    this.toggleEspecialidades();
                    this.renderizarEspecialidades();
                    
                    // v7.9.8: NÃ£o marcar ainda - serÃ¡ marcado quando selecionar o tipo
                }
                
                document.getElementById('modalReparticao').classList.add('active');
                
                // v7.9.8: Se jÃ¡ tem tipo selecionado, aplicar lÃ³gica de especialidades
                const tipoAtual = document.getElementById('rep-tipo-reparticao').value;
                if (tipoAtual === 'internacao' || tipoAtual === 'emergencia') {
                    document.getElementById('rep-aceita-todas-esp').checked = true;
                    this.toggleEspecialidades();
                }
            },

            carregarCamposEspecificos(tipo, campos) {
                // ğŸ”´ v10.76: Carregar precauÃ§Ãµes para TODOS os tipos (nÃ£o sÃ³ internaÃ§Ã£o)
                const precaucoes = campos.precaucoes || [];
                console.log('ğŸ“‹ [EDITAR] Carregando precauÃ§Ãµes:', precaucoes, 'para tipo:', tipo);
                
                const checkContato = document.getElementById('int-precaucao-contato');
                const checkAerossol = document.getElementById('int-precaucao-aerossol');
                const checkGoticulas = document.getElementById('int-precaucao-goticulas');
                
                if (checkContato) checkContato.checked = precaucoes.includes('contato');
                if (checkAerossol) checkAerossol.checked = precaucoes.includes('aerossol');
                if (checkGoticulas) checkGoticulas.checked = precaucoes.includes('goticulas');
                
                console.log('ğŸ“‹ [EDITAR] Checkboxes configurados:', {
                    contato: checkContato?.checked,
                    aerossol: checkAerossol?.checked,
                    goticulas: checkGoticulas?.checked
                });
                
                switch(tipo) {
                    case 'consultorio':
                        document.getElementById('cons-horario').value = campos.horario || '';
                        document.getElementById('cons-agenda-habilitada').checked = campos.agenda_habilitada !== false;
                        break;
                    case 'procedimento':
                        document.getElementById('proc-tipos').value = campos.tipos_procedimentos || '';
                        document.getElementById('proc-preparacao').value = campos.preparacao || 'nenhuma';
                        document.getElementById('proc-equipamentos').value = campos.equipamentos || '';
                        break;
                    case 'emergencia':
                        const nivelField = document.getElementById('emerg-nivel');
                        if (nivelField) nivelField.value = campos.nivel || 'media_complexidade';
                        document.getElementById('emerg-classificacao').value = campos.classificacao || 'manchester';
                        document.getElementById('emerg-equipamentos').value = campos.equipamentos || '';
                        document.getElementById('emerg-equipe').value = campos.equipe_plantao || '';
                        break;
                    case 'internacao':
                        document.getElementById('int-numero').value = campos.numero_leito || '';
                        document.getElementById('int-tipo-acomodacao').value = campos.tipo_acomodacao || 'enfermaria';
                        document.getElementById('int-status').value = campos.status_inicial || 'livre';
                        document.getElementById('int-equipamentos').value = campos.equipamentos || '';
                        break;
                    case 'bloco_cirurgico':
                        document.getElementById('bc-numero').value = campos.numero_sala || '';
                        document.getElementById('bc-tipos-cirurgia').value = campos.tipos_cirurgia || '';
                        document.getElementById('bc-equipamentos').value = campos.equipamentos || '';
                        document.getElementById('bc-status').value = campos.status_inicial || 'livre';
                        break;
                    case 'exames':
                    case 'exames_laboratorio':
                    case 'exames_imagem':
                        const tipoExameField = document.getElementById('exa-tipo');
                        if (tipoExameField) tipoExameField.value = campos.tipo_exame || 'raio-x';
                        const preparacaoField = document.getElementById('exa-preparacao');
                        if (preparacaoField) preparacaoField.value = campos.preparacao || 'nenhuma';
                        const equipamentoField = document.getElementById('exa-equipamento');
                        if (equipamentoField) equipamentoField.value = campos.equipamento || '';
                        break;
                }
            },

            fecharModal() {
                document.getElementById('modalReparticao').classList.remove('active');
            },

            // v7.8: Mostrar/esconder campos de especialidades
            toggleEspecialidades() {
                const aceitaTodas = document.getElementById('rep-aceita-todas-esp').checked;
                const secao = document.getElementById('rep-secao-especialidades');
                
                if (aceitaTodas) {
                    secao.style.display = 'none';
                } else {
                    secao.style.display = 'block';
                    this.carregarEspecialidadesDisponiveis();
                }
            },

            // v9.8.1: Carregar especialidades disponÃ­veis (AMBOS OS SELECTS)
            carregarEspecialidadesDisponiveis() {
                const selectAdicionar = document.getElementById('rep-especialidade-select');
                const selectDeletar = document.getElementById('rep-especialidade-deletar-select');
                
                if (!selectAdicionar) return;
                
                // Coletar todas as especialidades Ãºnicas
                const especialidadesSet = new Set();
                
                // 1. Do pool de especialidades (v7.9.2)
                if (SistemaCore.dados.pools && SistemaCore.dados.estabelecimento.especialidades) {
                    SistemaCore.dados.estabelecimento.especialidades.forEach(esp => {
                        especialidadesSet.add(esp);
                    });
                }
                
                // 2. Dos profissionais cadastrados
                SistemaCore.dados.profissionais.forEach(prof => {
                    if (prof.especialidade_principal) {
                        especialidadesSet.add(prof.especialidade_principal);
                    }
                    if (prof.especialidades && Array.isArray(prof.especialidades)) {
                        prof.especialidades.forEach(esp => especialidadesSet.add(esp));
                    }
                });
                
                // Ordenar alfabeticamente
                const especialidadesOrdenadas = Array.from(especialidadesSet).sort();
                
                // Preencher SELECT DE ADICIONAR (sem contador)
                selectAdicionar.innerHTML = '<option value="">Selecione do pool...</option>';
                especialidadesOrdenadas.forEach(esp => {
                    selectAdicionar.innerHTML += `<option value="${esp}">${esp}</option>`;
                });
                
                // Preencher SELECT DE DELETAR (com contador de uso)
                if (selectDeletar) {
                    selectDeletar.innerHTML = '<option value="">Selecione para deletar...</option>';
                    especialidadesOrdenadas.forEach(esp => {
                        const uso = this.contarUsoEspecialidade(esp);
                        const label = uso > 0 ? `${esp} (usado em ${uso})` : esp;
                        selectDeletar.innerHTML += `<option value="${esp}">${label}</option>`;
                    });
                }
            },
            
            // v9.7.5: Contar uso de especialidade
            contarUsoEspecialidade(especialidade) {
                let contador = 0;
                
                // Contar em profissionais
                if (SistemaCore.dados.profissionais) {
                    SistemaCore.dados.profissionais.forEach(p => {
                        if (p.especialidade === especialidade) contador++;
                        if (p.especialidade_principal === especialidade) contador++;
                        if (p.especialidades && Array.isArray(p.especialidades) && p.especialidades.includes(especialidade)) {
                            contador++;
                        }
                    });
                }
                
                return contador;
            },
            
            // v9.8.1: Deletar especialidade do pool (REDESENHADO)
            deletarEspecialidadeDoPool() {
                const select = document.getElementById('rep-especialidade-deletar-select');
                const especialidade = select.value;
                
                if (!especialidade) {
                    alert('âš ï¸ Selecione uma especialidade para deletar!');
                    return;
                }
                
                const uso = this.contarUsoEspecialidade(especialidade);
                
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL DELETAR!\n\n"${especialidade}" estÃ¡ sendo usada em ${uso} unidade(s).\n\nâœ… COMO RESOLVER:\n1. Edite cada unidade que usa "${especialidade}"\n2. Remova a especialidade delas\n3. Depois volte aqui para deletar do pool`);
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.especialidades) {
                    SistemaCore.dados.estabelecimento.especialidades = [];
                }
                
                const index = SistemaCore.dados.estabelecimento.especialidades.indexOf(especialidade);
                
                if (index === -1) {
                    alert(`âš ï¸ "${especialidade}" nÃ£o estÃ¡ no pool!\n\n(Pode ter sido importada de profissionais cadastrados)`);
                    return;
                }
                
                if (confirm(`ğŸ—‘ï¸ DELETAR DO POOL?\n\n"${especialidade}"\n\nIsso removerÃ¡ permanentemente esta especialidade do sistema.`)) {
                    SistemaCore.dados.estabelecimento.especialidades.splice(index, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… Especialidade removida do pool!');
                    
                    // Recarregar AMBOS os selects
                    this.carregarEspecialidadesDisponiveis();
                }
            },

            // v7.8: Adicionar especialidade Ã  lista permitida
            adicionarEspecialidade() {
                const select = document.getElementById('rep-especialidade-select');
                const especialidade = select.value;
                
                if (!especialidade) {
                    Sistema.notificar('Selecione uma especialidade!', 'error');
                    return;
                }
                
                // Pegar lista atual
                const hidden = document.getElementById('rep-especialidades-hidden');
                const especialidades = hidden.value ? hidden.value.split('|') : [];
                
                // Verificar se jÃ¡ existe
                if (especialidades.includes(especialidade)) {
                    Sistema.notificar('Especialidade jÃ¡ adicionada!', 'error');
                    return;
                }
                
                // v10.3: ALIMENTAÃ‡ÃƒO BIDIRECIONAL - Garantir que estÃ¡ no pool
                // (pode ser uma especialidade digitada que nÃ£o estava no pool antes)
                if (!SistemaCore.dados.estabelecimento.especialidades) {
                    SistemaCore.dados.estabelecimento.especialidades = [];
                }
                if (!SistemaCore.dados.estabelecimento.especialidades.includes(especialidade)) {
                    SistemaCore.dados.estabelecimento.especialidades.push(especialidade);
                    SistemaCore.salvar();
                    console.log(`âœ… Especialidade "${especialidade}" adicionada ao pool`);
                }
                
                // Adicionar
                especialidades.push(especialidade);
                hidden.value = especialidades.join('|');
                
                // Renderizar
                this.renderizarEspecialidades();
                
                // Limpar select
                select.value = '';
            },

            // v7.9.2: Adicionar especialidade via texto livre
            adicionarEspecialidadeTexto() {
                const input = document.getElementById('rep-especialidade-texto');
                const especialidade = input.value.trim();
                
                if (!especialidade) {
                    Sistema.notificar('Digite uma especialidade!', 'error');
                    return;
                }
                
                // Pegar lista atual
                const hidden = document.getElementById('rep-especialidades-hidden');
                const especialidades = hidden.value ? hidden.value.split('|') : [];
                
                // Verificar se jÃ¡ existe na lista
                if (especialidades.includes(especialidade)) {
                    Sistema.notificar('Especialidade jÃ¡ adicionada!', 'error');
                    return;
                }
                
                // Adicionar ao pool de especialidades se nÃ£o existir
                if (!SistemaCore.dados.estabelecimento.especialidades) {
                    SistemaCore.dados.estabelecimento.especialidades = [];
                }
                
                if (!SistemaCore.dados.estabelecimento.especialidades.includes(especialidade)) {
                    SistemaCore.dados.estabelecimento.especialidades.push(especialidade);
                    SistemaCore.salvar();
                    console.log('âœ… Nova especialidade adicionada ao pool:', especialidade);
                }
                
                // Adicionar Ã  lista da unidade
                especialidades.push(especialidade);
                hidden.value = especialidades.join('|');
                
                // Renderizar
                this.renderizarEspecialidades();
                
                // Recarregar select para incluir a nova especialidade
                this.carregarEspecialidadesDisponiveis();
                
                // Limpar input
                input.value = '';
                
                Sistema.notificar(`âœ… "${especialidade}" adicionada!`);
            },

            // v7.8: Remover especialidade da lista
            removerEspecialidade(especialidade) {
                const hidden = document.getElementById('rep-especialidades-hidden');
                let especialidades = hidden.value.split('|');
                
                especialidades = especialidades.filter(e => e !== especialidade);
                hidden.value = especialidades.join('|');
                
                this.renderizarEspecialidades();
            },

            // v9.8.1: Renderizar chips de especialidades (MELHORADO)
            renderizarEspecialidades() {
                const container = document.getElementById('rep-especialidades-lista');
                const hidden = document.getElementById('rep-especialidades-hidden');
                
                if (!hidden.value) {
                    container.innerHTML = '<p style="color: var(--text-light); margin: 0; font-style: italic;">Nenhuma especialidade adicionada ainda</p>';
                    return;
                }
                
                const especialidades = hidden.value.split('|');
                let html = '';
                
                especialidades.forEach(esp => {
                    html += `
                        <div class="especialidade-chip" style="display: inline-flex; align-items: center; 
                             gap: 8px; padding: 8px 14px; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); 
                             color: white; border: 1px solid #1d4ed8; border-radius: 20px; font-size: 13px; 
                             font-weight: 500; box-shadow: 0 2px 4px rgba(59, 130, 246, 0.2);">
                            <span>ğŸ©º ${esp}</span>
                            <button type="button" 
                                    onclick="Reparticoes.removerEspecialidade('${esp}')" 
                                    title="Remover ${esp} desta unidade"
                                    style="border: none; background: rgba(255,255,255,0.2); cursor: pointer; 
                                           color: white; font-weight: bold; padding: 2px; margin: 0; 
                                           font-size: 16px; line-height: 1; width: 22px; height: 22px; 
                                           border-radius: 50%; display: flex; align-items: center; 
                                           justify-content: center; transition: all 0.2s;"
                                    onmouseover="this.style.background='rgba(255,255,255,0.3)'"
                                    onmouseout="this.style.background='rgba(255,255,255,0.2)'">Ã—</button>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },

            coletarCamposEspecificos(tipo) {
                let campos = {};
                
                // ğŸ”´ v10.76: Coletar precauÃ§Ãµes para TODOS os tipos (nÃ£o sÃ³ internaÃ§Ã£o)
                const precaucoes = [];
                
                const checkContato = document.getElementById('int-precaucao-contato');
                const checkAerossol = document.getElementById('int-precaucao-aerossol');
                const checkGoticulas = document.getElementById('int-precaucao-goticulas');
                
                console.log('ğŸ“‹ [COLETA PRECAUÃ‡Ã•ES] Tipo:', tipo, '| Checkboxes encontrados:', {
                    contato: checkContato ? 'SIM' : 'NÃƒO',
                    aerossol: checkAerossol ? 'SIM' : 'NÃƒO',
                    goticulas: checkGoticulas ? 'SIM' : 'NÃƒO'
                });
                
                console.log('ğŸ“‹ [COLETA PRECAUÃ‡Ã•ES] Estados dos checkboxes:', {
                    contato: checkContato?.checked,
                    aerossol: checkAerossol?.checked,
                    goticulas: checkGoticulas?.checked
                });
                
                if (checkContato && checkContato.checked) {
                    precaucoes.push('contato');
                    console.log('âœ… [COLETA PRECAUÃ‡Ã•ES] CONTATO marcado');
                }
                if (checkAerossol && checkAerossol.checked) {
                    precaucoes.push('aerossol');
                    console.log('âœ… [COLETA PRECAUÃ‡Ã•ES] AEROSSOL marcado');
                }
                if (checkGoticulas && checkGoticulas.checked) {
                    precaucoes.push('goticulas');
                    console.log('âœ… [COLETA PRECAUÃ‡Ã•ES] GOTÃCULAS marcado');
                }
                
                console.log('ğŸ“‹ [COLETA PRECAUÃ‡Ã•ES] Array final:', precaucoes);
                
                switch(tipo) {
                    case 'consultorio':
                        campos = {
                            horario: document.getElementById('cons-horario').value.trim(),
                            agenda_habilitada: document.getElementById('cons-agenda-habilitada').checked,
                            precaucoes: precaucoes // âœ… Adicionado
                        };
                        break;
                    case 'procedimento':
                        campos = {
                            tipos_procedimentos: document.getElementById('proc-tipos').value.trim(),
                            preparacao: document.getElementById('proc-preparacao').value,
                            equipamentos: document.getElementById('proc-equipamentos').value.trim(),
                            precaucoes: precaucoes // âœ… Adicionado
                        };
                        break;
                    case 'emergencia':
                        campos = {
                            classificacao: document.getElementById('emerg-classificacao').value,
                            equipamentos: document.getElementById('emerg-equipamentos').value.trim(),
                            equipe_plantao: document.getElementById('emerg-equipe').value.trim(),
                            precaucoes: precaucoes // âœ… Adicionado
                        };
                        break;
                    case 'internacao':
                        campos = {
                            numero_leito: document.getElementById('int-numero').value.trim(),
                            tipo_acomodacao: document.getElementById('int-tipo-acomodacao').value,
                            status_inicial: document.getElementById('int-status').value,
                            precaucoes: precaucoes, // Array de precauÃ§Ãµes
                            equipamentos: document.getElementById('int-equipamentos').value.trim()
                        };
                        break;
                    case 'bloco_cirurgico':
                        campos = {
                            numero_sala: document.getElementById('bc-numero').value.trim(),
                            tipos_cirurgia: document.getElementById('bc-tipos-cirurgia').value.trim(),
                            equipamentos: document.getElementById('bc-equipamentos').value.trim(),
                            status_inicial: document.getElementById('bc-status').value,
                            precaucoes: precaucoes // âœ… Adicionado
                        };
                        break;
                    case 'exames':
                    case 'exames_laboratorio':
                    case 'exames_imagem':
                        campos = {
                            tipo_exame: document.getElementById('exa-tipo')?.value || '',
                            preparacao: document.getElementById('exa-preparacao')?.value || '',
                            equipamento: document.getElementById('exa-equipamento')?.value.trim() || '',
                            precaucoes: precaucoes // âœ… Adicionado
                        };
                        break;
                }
                
                return campos;
            },

            salvar() {
                // ================================================================
                // ğŸ” DEBUG - SALVAR REPARTIÃ‡ÃƒO v10.76 FINAL
                // ================================================================
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                console.log('ğŸ” [v10.76 FINAL] FunÃ§Ã£o salvar() chamada - Arquivo correto!');
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                
                const nome = document.getElementById('rep-nome').value.trim();
                const tipoReparticao = document.getElementById('rep-tipo-reparticao').value;
                const pavilhao = document.getElementById('rep-pavilhao').value.trim();
                const andar = document.getElementById('rep-andar').value.trim();
                const setor = document.getElementById('rep-setor').value.trim();
                const observacoes = document.getElementById('rep-observacoes').value.trim();
                const editId = document.getElementById('edit-reparticao-id').value;
                
                // v6.8.2: Capacidade
                const capacidade = parseInt(document.getElementById('rep-capacidade').value) || 1;
                const padraoNome = document.getElementById('rep-padrao-nome').value.trim();
                
                // ğŸ” [DEBUG] Dados coletados do formulÃ¡rio
                console.log('ğŸ” [DEBUG REPARTIÃ‡ÃƒO] Dados coletados:');
                console.log('  ğŸ“ Nome:', nome);
                console.log('  ğŸ¥ Tipo:', tipoReparticao);
                console.log('  ğŸ“ PavilhÃ£o:', pavilhao);
                console.log('  ğŸ“Š Andar:', andar);
                console.log('  ğŸ¢ Setor:', setor || '(vazio)');
                console.log('  ğŸ“ ObservaÃ§Ãµes:', observacoes || '(vazio)');
                console.log('  âœï¸ ID ediÃ§Ã£o:', editId || '(nova repartiÃ§Ã£o)');
                console.log('  ğŸ“¦ Capacidade:', capacidade);
                console.log('  ğŸ·ï¸ PadrÃ£o nome:', padraoNome || '(nÃ£o definido)');
                console.log('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');

                // ValidaÃ§Ãµes
                if (!tipoReparticao) {
                    Sistema.notificar('Selecione o tipo de repartiÃ§Ã£o!', 'error');
                    return;
                }
                
                if (!nome) {
                    Sistema.notificar('Preencha o nome da repartiÃ§Ã£o!', 'error');
                    return;
                }

                // v7.8: Coletar especialidades
                const aceitaTodasEsp = document.getElementById('rep-aceita-todas-esp').checked;
                const especialidadesStr = document.getElementById('rep-especialidades-hidden').value;
                const especialidades = especialidadesStr ? especialidadesStr.split('|') : [];

                // ValidaÃ§Ã£o v7.8
                if (!aceitaTodasEsp && especialidades.length === 0) {
                    Sistema.notificar('Adicione pelo menos uma especialidade ou marque "Aceita todas"!', 'error');
                    return;
                }

                // Coletar campos especÃ­ficos do tipo
                const camposEspecificos = this.coletarCamposEspecificos(tipoReparticao);

                const dados = {
                    nome,
                    tipo_reparticao: tipoReparticao,
                    pavilhao,
                    andar,
                    setor,
                    observacoes,
                    campos_especificos: camposEspecificos,
                    status: tipoReparticao === 'internacao' ? (camposEspecificos.status_inicial || 'livre') : 
                            tipoReparticao === 'bloco_cirurgico' ? (camposEspecificos.status_inicial || 'livre') : 'disponivel',
                    // v6.8.2: Campos de grupo
                    // v10.57: SEMPRE criar grupo quando capacidade >= 1 (mesmo com 1 sala)
                    eh_grupo: capacidade >= 1,
                    capacidade: capacidade >= 1 ? capacidade : null,
                    padrao_nome: capacidade >= 1 ? padraoNome : null,
                    subreparticoes_ids: [],
                    // v7.8: Campos de especialidades
                    aceita_todas_especialidades: aceitaTodasEsp,
                    especialidades_permitidas: especialidades
                };

                // Se for internaÃ§Ã£o, adicionar campos de controle
                if (tipoReparticao === 'internacao') {
                    dados.paciente_id = null;
                    dados.data_ocupacao = null;
                    dados.motivo_internacao = null;
                }

                if (editId) {
                    const rep = SistemaCore.dados.reparticoes.find(r => r.id === parseInt(editId));
                    if (rep) {
                        // PRESERVAR sub-repartiÃ§Ãµes existentes ao editar
                        const subrepartioesExistentes = rep.subreparticoes_ids || [];
                        const capacidadeAntiga = subrepartioesExistentes.length;
                        
                        // v8.0.12: Verificar se tipo mudou ANTES de atualizar
                        const tipoAntigo = rep.tipo_reparticao;
                        const tipoNovo = dados.tipo_reparticao;
                        const tipoMudou = tipoAntigo !== tipoNovo;
                        
                        // ğŸ”´ FASE 2: Salvar estado antigo das precauÃ§Ãµes ANTES de atualizar
                        const precaucoesAntigas = rep.campos_especificos?.precaucoes || [];
                        
                        Object.assign(rep, dados);
                        
                        // âœ… v10.76: ATUALIZAR PRECAUÃ‡Ã•ES quando NÃšMEROS ISOLADOS ou PRECAUÃ‡Ã•ES mudaram
                        const precaucoesNovas = dados.campos_especificos?.precaucoes || [];
                        const precaucoesMudaram = JSON.stringify(precaucoesAntigas.sort()) !== JSON.stringify(precaucoesNovas.sort());
                        
                        // ğŸ”´ v10.76: Detectar mudanÃ§a nos NÃšMEROS isolados
                        const leitosIsoladosStr = document.getElementById('rep-leitos-isolados')?.value.trim() || '';
                        const numerosIsoladosNovos = this.parsearNumerosIsolados(leitosIsoladosStr);
                        
                        console.log('ğŸ” [EDITAR] NÃºmeros isolados no campo:', leitosIsoladosStr);
                        console.log('ğŸ” [EDITAR] NÃºmeros isolados parsed:', numerosIsoladosNovos);
                        
                        if (rep.eh_grupo && subrepartioesExistentes.length > 0 && (precaucoesMudaram || numerosIsoladosNovos.length > 0)) {
                            console.log(`ğŸ”„ [ATUALIZAR ISOLADOS] PrecauÃ§Ãµes: [${precaucoesAntigas.join(', ')}] â†’ [${precaucoesNovas.join(', ')}]`);
                            console.log(`ğŸ”„ [ATUALIZAR ISOLADOS] Atualizando ${subrepartioesExistentes.length} unidades...`);
                            
                            let atualizados = 0;
                            subrepartioesExistentes.forEach((subId, index) => {
                                const sub = SistemaCore.dados.reparticoes.find(r => r.id === subId);
                                if (sub) {
                                    // Extrair nÃºmero da sub-repartiÃ§Ã£o
                                    const match = sub.nome.match(/(\d+)$/);
                                    const numeroSub = match ? parseInt(match[1]) : (index + 1);
                                    
                                    const deveSerIsolada = numerosIsoladosNovos.includes(numeroSub);
                                    const estaIsolada = sub.campos_especificos?.precaucoes && sub.campos_especificos.precaucoes.length > 0;
                                    
                                    console.log(`   ğŸ” ${sub.nome} (${numeroSub}): deve ser isolada? ${deveSerIsolada} | estÃ¡ isolada? ${estaIsolada}`);
                                    
                                    if (deveSerIsolada) {
                                        // DEVE ter precauÃ§Ãµes
                                        sub.campos_especificos = sub.campos_especificos || {};
                                        sub.campos_especificos.precaucoes = [...precaucoesNovas];
                                        atualizados++;
                                        console.log(`   âœ… ${sub.nome}: ISOLADA [${precaucoesNovas.join(', ')}]`);
                                    } else if (estaIsolada) {
                                        // NÃƒO deve mais ter precauÃ§Ãµes (estava isolada mas foi removida)
                                        sub.campos_especificos.precaucoes = [];
                                        atualizados++;
                                        console.log(`   âœ… ${sub.nome}: DESINOLADA (precauÃ§Ãµes removidas)`);
                                    } else {
                                        console.log(`   â­ï¸ ${sub.nome}: mantÃ©m normal`);
                                    }
                                }
                            });
                            
                            const precaucoesTexto = precaucoesNovas.length > 0 
                                ? precaucoesNovas.map(p => p.toUpperCase()).join(', ')
                                : 'nenhuma';
                            Sistema.notificar(`ğŸ”’ ${atualizados} unidade(s) atualizada(s) | PrecauÃ§Ãµes: ${precaucoesTexto}`, 'success');
                        }
                        
                        // v8.0.12: Se tipo mudou E tem sub-repartiÃ§Ãµes, atualizar TODAS
                        if (tipoMudou && subrepartioesExistentes.length > 0) {
                            console.log(`ğŸ”„ [ATUALIZAR TIPO] Tipo mudou de "${tipoAntigo}" para "${tipoNovo}"`);
                            console.log(`ğŸ”„ [ATUALIZAR TIPO] Atualizando ${subrepartioesExistentes.length} sub-repartiÃ§Ãµes...`);
                            
                            subrepartioesExistentes.forEach(subId => {
                                const sub = SistemaCore.dados.reparticoes.find(r => r.id === subId);
                                if (sub) {
                                    const nomeAntigo = sub.nome;
                                    sub.tipo_reparticao = tipoNovo;
                                    console.log(`   âœ… ${nomeAntigo}: "${tipoAntigo}" â†’ "${tipoNovo}"`);
                                }
                            });
                            
                            Sistema.notificar(`âœ… Tipo atualizado! ${subrepartioesExistentes.length} sub-repartiÃ§Ãµes atualizadas!`, 'success');
                        }
                        
                        // Restaurar sub-repartiÃ§Ãµes existentes
                        if (subrepartioesExistentes.length > 0) {
                            rep.subreparticoes_ids = subrepartioesExistentes;
                            rep.eh_grupo = true;
                            
                            // âœ… v10.81: Ler configuraÃ§Ãµes ANTES de qualquer operaÃ§Ã£o
                            const prefixo = document.getElementById('rep-prefixo')?.value.trim() || '';
                            const numeroInicial = parseInt(document.getElementById('rep-numeracao-inicial')?.value) || 1;
                            const leitosIsoladosStr = document.getElementById('rep-leitos-isolados')?.value.trim() || '';
                            const numerosIsolados = this.parsearNumerosIsolados(leitosIsoladosStr);
                            
                            const padraoAtual = rep.padrao_nome || '';
                            const padraoNovo = padraoNome;
                            
                            // âœ… v10.81: IDENTIFICAR valores ATUAIS de prefixo e numeraÃ§Ã£o
                            let prefixoAtual = '';
                            let numeracaoAtual = 1;
                            
                            const primeiraSub = SistemaCore.dados.reparticoes.find(r => r.id === rep.subreparticoes_ids[0]);
                            if (primeiraSub) {
                                let restante = primeiraSub.nome;
                                
                                if (padraoAtual && restante.startsWith(padraoAtual)) {
                                    restante = restante.substring(padraoAtual.length).trim();
                                }
                                
                                const match = restante.match(/^([^\d]*)(\d+)$/);
                                if (match) {
                                    prefixoAtual = match[1];
                                    numeracaoAtual = parseInt(match[2]);
                                }
                            }
                            
                            // Detectar mudanÃ§as
                            const capacidadeMudou = (capacidade !== capacidadeAntiga);
                            const padraoMudou = (padraoNovo !== padraoAtual);
                            const prefixoMudou = (prefixo !== prefixoAtual);
                            const numeracaoMudou = (numeroInicial !== numeracaoAtual);
                            const nomenclaturaMudou = (padraoMudou || prefixoMudou || numeracaoMudou);
                            const diminuiu = (capacidade < capacidadeAntiga);
                            const aumentou = (capacidade > capacidadeAntiga);
                            
                            console.log('ğŸ” [EDITAR] Status das mudanÃ§as:');
                            console.log('  ğŸ“Š Capacidade:', capacidadeAntiga, 'â†’', capacidade);
                            console.log('  ğŸ“ PadrÃ£o:', padraoAtual, 'â†’', padraoNovo, '|', padraoMudou ? 'âœï¸ MUDOU' : '');
                            console.log('  ğŸ”¤ Prefixo:', `"${prefixoAtual}"`, 'â†’', `"${prefixo}"`, '|', prefixoMudou ? 'âœï¸ MUDOU' : '');
                            console.log('  ğŸ”¢ NumeraÃ§Ã£o inicial:', numeracaoAtual, 'â†’', numeroInicial, '|', numeracaoMudou ? 'âœï¸ MUDOU' : '');
                            console.log('  ğŸ”’ NÃºmeros isolados:', leitosIsoladosStr || '(nenhum)');
                            console.log('  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
                            console.log('  Diminuiu?', diminuiu);
                            console.log('  Aumentou?', aumentou);
                            console.log('  Nomenclatura mudou?', nomenclaturaMudou);
                            
                            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            // OPERAÃ‡ÃƒO 1: DIMINUIR CAPACIDADE (se necessÃ¡rio)
                            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            if (diminuiu) {
                                console.log(`ğŸ“‰ [OP 1/3] Diminuindo capacidade de ${capacidadeAntiga} para ${capacidade}`);
                                
                                const idsParaRemover = rep.subreparticoes_ids.slice(capacidade);
                                
                                // Verificar se pode remover
                                let podeRemover = true;
                                idsParaRemover.forEach(subId => {
                                    const sub = SistemaCore.dados.reparticoes.find(r => r.id === subId);
                                    if (sub && (sub.status === 'ocupado' || sub.status === 'reservado')) {
                                        Sistema.notificar(`âš ï¸ NÃ£o Ã© possÃ­vel excluir "${sub.nome}" pois estÃ¡ ${sub.status}!`, 'error');
                                        podeRemover = false;
                                    }
                                });
                                
                                if (!podeRemover) {
                                    return; // Cancela toda operaÃ§Ã£o
                                }
                                
                                // Excluir
                                idsParaRemover.forEach(subId => {
                                    const sub = SistemaCore.dados.reparticoes.find(r => r.id === subId);
                                    if (sub) {
                                        console.log(`  âŒ Excluindo: ${sub.nome}`);
                                    }
                                    SistemaCore.dados.reparticoes = SistemaCore.dados.reparticoes.filter(r => r.id !== subId);
                                });
                                
                                // Atualizar lista
                                rep.subreparticoes_ids = rep.subreparticoes_ids.slice(0, capacidade);
                                rep.capacidade = capacidade;
                                
                                console.log(`âœ… [OP 1/3] ${idsParaRemover.length} unidade(s) excluÃ­da(s)`);
                            }
                            
                            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            // OPERAÃ‡ÃƒO 2: RENOMEAR EXISTENTES (se nomenclatura mudou OU aumentou)
                            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            // IMPORTANTE: Renomear SEMPRE que nomenclatura mudou, mesmo ao aumentar
                            if (nomenclaturaMudou || aumentou) {
                                console.log(`âœï¸ [OP 2/3] Renomeando unidades existentes...`);
                                
                                // Renomear TODAS as que ainda existem
                                const quantidadeAtual = rep.subreparticoes_ids.length;
                                
                                rep.subreparticoes_ids.forEach((subId, index) => {
                                    const sub = SistemaCore.dados.reparticoes.find(r => r.id === subId);
                                    if (sub) {
                                        const numeroUnidade = numeroInicial + index;
                                        const nomeAntigo = sub.nome;
                                        const nomeNovo = prefixo ? `${padraoNovo} ${prefixo}${numeroUnidade}` : `${padraoNovo} ${numeroUnidade}`;
                                        
                                        if (nomeAntigo !== nomeNovo) {
                                            console.log(`  âœï¸ "${nomeAntigo}" â†’ "${nomeNovo}"`);
                                            sub.nome = nomeNovo;
                                        }
                                    }
                                });
                                
                                rep.padrao_nome = padraoNovo;
                                console.log(`âœ… [OP 2/3] ${quantidadeAtual} unidade(s) renomeada(s)`);
                            }
                            
                            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            // OPERAÃ‡ÃƒO 3: AUMENTAR CAPACIDADE (se necessÃ¡rio)
                            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            if (aumentou) {
                                console.log(`ğŸ“ˆ [OP 3/3] Aumentando capacidade de ${capacidadeAntiga} para ${capacidade}`);
                                
                                const quantidadeAtual = rep.subreparticoes_ids.length;
                                
                                // Criar novas unidades comeÃ§ando da prÃ³xima posiÃ§Ã£o
                                for (let i = quantidadeAtual + 1; i <= capacidade; i++) {
                                    // Calcular nÃºmero baseado na posiÃ§Ã£o (index comeÃ§a em 0)
                                    const numeroUnidade = numeroInicial + (i - 1);
                                    const ehIsolado = numerosIsolados.includes(numeroUnidade);
                                    
                                    console.log(`  ğŸ†• Criando unidade ${i}/${capacidade} - NÃºmero: ${numeroUnidade} - Isolado: ${ehIsolado}`);
                                    
                                    // Copiar campos do pai MAS EXCLUIR precauÃ§Ãµes
                                    const { precaucoes, ...camposSemPrecaucoes } = rep.campos_especificos || {};
                                    const camposEspecificos = { ...camposSemPrecaucoes };
                                    
                                    // Aplicar precauÃ§Ãµes APENAS se for isolado
                                    if (ehIsolado) {
                                        camposEspecificos.precaucoes = [...(precaucoes || [])];
                                        console.log(`     ğŸ”’ ISOLADA - PrecauÃ§Ãµes: [${camposEspecificos.precaucoes.join(', ')}]`);
                                    }
                                    
                                    const novaSub = {
                                        id: SistemaCore.proximoId(SistemaCore.dados.reparticoes),
                                        nome: prefixo ? `${padraoNovo} ${prefixo}${numeroUnidade}` : `${padraoNovo} ${numeroUnidade}`,
                                        tipo_reparticao: tipoReparticao,
                                        pavilhao: rep.pavilhao,
                                        andar: rep.andar,
                                        setor: rep.setor,
                                        status: tipoReparticao === 'internacao' || tipoReparticao === 'bloco_cirurgico' ? 'livre' : 'disponivel',
                                        eh_subreparticao: true,
                                        reparticao_pai_id: rep.id,
                                        observacoes: `Sub-repartiÃ§Ã£o de: ${rep.nome}`,
                                        campos_especificos: camposEspecificos,
                                        aceita_todas_especialidades: rep.aceita_todas_especialidades || false,
                                        especialidades_permitidas: rep.especialidades_permitidas ? [...rep.especialidades_permitidas] : []
                                    };
                                    
                                    if (tipoReparticao === 'internacao') {
                                        novaSub.paciente_id = null;
                                        novaSub.data_ocupacao = null;
                                        novaSub.motivo_internacao = null;
                                    }
                                    
                                    SistemaCore.dados.reparticoes.push(novaSub);
                                    rep.subreparticoes_ids.push(novaSub.id);
                                }
                                
                                rep.capacidade = capacidade;
                                console.log(`âœ… [OP 3/3] ${capacidade - quantidadeAtual} nova(s) unidade(s) criada(s)`);
                            }
                            
                            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            // NOTIFICAÃ‡ÃƒO FINAL
                            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            if (diminuiu && nomenclaturaMudou) {
                                Sistema.notificar(`âœ… Capacidade reduzida para ${capacidade} e ${rep.subreparticoes_ids.length} unidades renomeadas!`);
                            } else if (aumentou && nomenclaturaMudou) {
                                Sistema.notificar(`âœ… Capacidade aumentada para ${capacidade} e todas as unidades renomeadas!`);
                            } else if (diminuiu) {
                                Sistema.notificar(`âœ… Capacidade reduzida para ${capacidade}!`);
                            } else if (aumentou) {
                                Sistema.notificar(`âœ… Capacidade aumentada para ${capacidade}!`);
                            } else if (nomenclaturaMudou) {
                                Sistema.notificar(`âœ… Todas as ${rep.subreparticoes_ids.length} unidades foram renomeadas!`);
                            } else {
                                Sistema.notificar('âœ… RepartiÃ§Ã£o atualizada com sucesso!');
                            }
                        } else {
                            Sistema.notificar('âœ… RepartiÃ§Ã£o atualizada com sucesso!');
                        }
                    }
                } else {
                    console.log('ğŸ†• CRIANDO NOVA REPARTIÃ‡ÃƒO...');
                    dados.id = SistemaCore.proximoId(SistemaCore.dados.reparticoes);
                    SistemaCore.dados.reparticoes.push(dados);
                    
                    console.log('ğŸ“Š Capacidade:', capacidade);
                    console.log('ğŸ“Š PadrÃ£o nome:', padraoNome);
                    
                    // v6.8.2 / v10.70: Criar sub-repartiÃ§Ãµes se capacidade >= 1 (INCLUINDO capacidade = 1)
                    if (capacidade >= 1 && padraoNome) {
                        console.log('ğŸš€ğŸš€ğŸš€ VAI CHAMAR criarSubreparticoes! ğŸš€ğŸš€ğŸš€');
                        
                        const subreparticoesIds = this.criarSubreparticoes(dados, capacidade, padraoNome);
                        dados.subreparticoes_ids = subreparticoesIds;
                        Sistema.notificar(`âœ… RepartiÃ§Ã£o criada com ${capacidade} sub-repartiÃ§Ã£o(Ãµes)!`);
                    } else {
                        Sistema.notificar('âœ… RepartiÃ§Ã£o salva com sucesso!');
                    }
                }

                // ================================================================
                // v10.4 + v10.60.7: FLUXO UNIDIRECIONAL DO POOL
                // ================================================================
                // REGRA: Pool â†’ Estabelecimento â†’ RepartiÃ§Ã£o (NUNCA o contrÃ¡rio diretamente)
                // 
                // Quando uma repartiÃ§Ã£o Ã© salva:
                // 1. RepartiÃ§Ã£o LEVA dados do pool (leitura)
                // 2. Se usar valor NOVO, adiciona AO POOL primeiro (bidirecional controlado)
                // 3. Pool Ã© a ÃšNICA fonte da verdade para dropdowns
                // ================================================================
                
                console.log('ğŸ”„ [FLUXO POOL] Verificando alimentaÃ§Ã£o bidirecional...');
                
                // 1. Nome sugerido
                if (nome) {
                    if (!SistemaCore.dados.pools.nomes_sugeridos) {
                        SistemaCore.dados.pools.nomes_sugeridos = [];
                    }
                    // Extrair palavra base (ex: "ConsultÃ³rio 1" -> "ConsultÃ³rio")
                    const nomeBase = nome.replace(/\s+\d+$/, '').trim();
                    if (!SistemaCore.dados.pools.nomes_sugeridos.includes(nomeBase)) {
                        SistemaCore.dados.pools.nomes_sugeridos.push(nomeBase);
                        console.log(`  âœ… [POOLâ†’NOMES] "${nomeBase}" adicionado ao pool de nomes`);
                    } else {
                        console.log(`  â„¹ï¸ [POOLâ†’NOMES] "${nomeBase}" jÃ¡ existe no pool`);
                    }
                }
                
                // 2. PavilhÃ£o
                if (pavilhao) {
                    if (!SistemaCore.dados.estabelecimento.pavilhoes) {
                        SistemaCore.dados.estabelecimento.pavilhoes = [];
                    }
                    if (!SistemaCore.dados.estabelecimento.pavilhoes.includes(pavilhao)) {
                        SistemaCore.dados.estabelecimento.pavilhoes.push(pavilhao);
                        console.log(`  âœ… [POOLâ†’PAVILHÃ•ES] "${pavilhao}" adicionado ao pool`);
                    } else {
                        console.log(`  â„¹ï¸ [POOLâ†’PAVILHÃ•ES] "${pavilhao}" jÃ¡ existe no pool`);
                    }
                }
                
                // 3. Andar
                if (andar) {
                    if (!SistemaCore.dados.estabelecimento.andares) {
                        SistemaCore.dados.estabelecimento.andares = [];
                    }
                    if (!SistemaCore.dados.estabelecimento.andares.includes(andar)) {
                        SistemaCore.dados.estabelecimento.andares.push(andar);
                        console.log(`  âœ… [POOLâ†’ANDARES] "${andar}" adicionado ao pool`);
                    } else {
                        console.log(`  â„¹ï¸ [POOLâ†’ANDARES] "${andar}" jÃ¡ existe no pool`);
                    }
                }
                
                // 4. Setor
                if (setor) {
                    if (!SistemaCore.dados.estabelecimento.setores) {
                        SistemaCore.dados.estabelecimento.setores = [];
                    }
                    if (!SistemaCore.dados.estabelecimento.setores.includes(setor)) {
                        SistemaCore.dados.estabelecimento.setores.push(setor);
                        console.log(`  âœ… [POOLâ†’SETORES] "${setor}" adicionado ao pool`);
                    } else {
                        console.log(`  â„¹ï¸ [POOLâ†’SETORES] "${setor}" jÃ¡ existe no pool`);
                    }
                }
                
                console.log('ğŸ”„ [FLUXO POOL] VerificaÃ§Ã£o completa!');
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');

                SistemaCore.salvar();
                this.listar();
                Agenda.renderizarCards(); // v10.73: Sincronizar Mapa + Agenda
                this.fecharModal();
            },

            editar(id) {
                this.abrirModal(id);
            },

            excluir(id) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === id);
                if (rep && rep.status === 'ocupado') {
                    Sistema.notificar('NÃ£o Ã© possÃ­vel excluir uma repartiÃ§Ã£o ocupada!', 'error');
                    return;
                }
                if (!confirm('Deseja excluir esta repartiÃ§Ã£o?')) return;
                SistemaCore.dados.reparticoes = SistemaCore.dados.reparticoes.filter(r => r.id !== id);
                SistemaCore.salvar();
                this.listar();
                Agenda.renderizarCards(); // v10.73: Sincronizar Mapa + Agenda
                Sistema.notificar('RepartiÃ§Ã£o excluÃ­da!');
            },

            // GESTÃƒO DE LEITOS (mantido para internaÃ§Ã£o)

            abrirModalInternar(repId) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === repId);
                if (!rep || (rep.status !== 'livre' && rep.status !== 'reservado')) {
                    Sistema.notificar('Esta repartiÃ§Ã£o nÃ£o estÃ¡ disponÃ­vel!', 'error');
                    return;
                }
                
                // v10.38: Verificar se leito estÃ¡ bloqueado
                if (rep.bloqueado) {
                    Sistema.notificar('â›” Este leito estÃ¡ BLOQUEADO e nÃ£o pode ser usado para internaÃ§Ã£o!', 'error');
                    return;
                }

                document.getElementById('internar-reparticao-id').value = repId;
                
                // Popular lista de pacientes
                const select = document.getElementById('internar-paciente');
                const pacientes = SistemaCore.dados.pacientes;
                let html = '<option value="">Selecione...</option>';
                pacientes.forEach(p => {
                    html += `<option value="${p.id}">${p.nome}</option>`;
                });
                select.innerHTML = html;
                
                // Se o leito estÃ¡ RESERVADO, prÃ©-selecionar o paciente reservado
                if (rep.status === 'reservado' && rep.reservado_para_paciente_id) {
                    document.getElementById('internar-paciente').value = rep.reservado_para_paciente_id;
                }

                // v7.8: Popular lista de profissionais
                const selectProf = document.getElementById('internar-profissional');
                const profissionais = SistemaCore.dados.profissionais;
                let htmlProf = '<option value="">Selecione...</option>';
                profissionais.forEach(prof => {
                    const especialidade = prof.especialidade_principal || prof.especialidade || '';
                    htmlProf += `<option value="${prof.id}">${prof.nome}${especialidade ? ' - ' + especialidade : ''}</option>`;
                });
                selectProf.innerHTML = htmlProf;

                // Data/hora atual
                const agora = new Date();
                agora.setMinutes(agora.getMinutes() - agora.getTimezoneOffset());
                document.getElementById('internar-data').value = agora.toISOString().slice(0,16);
                document.getElementById('internar-motivo').value = '';

                document.getElementById('modalInternar').classList.add('active');
            },

            fecharModalInternar() {
                document.getElementById('modalInternar').classList.remove('active');
            },

            // v8.0.3: NOVA FUNÃ‡ÃƒO - Abrir modal para reservar leito (matriciamento)
            // v8.0.6: ATUALIZADO - Abrir modal dedicado de reserva com controle de permissÃµes
            abrirModalReservar(repId) {
                console.log('ğŸ“… [RESERVA] abrirModalReservar chamado para repartiÃ§Ã£o:', repId);
                
                // v8.0.6: VERIFICAR PERMISSÃ•ES PRIMEIRO
                if (!PermissoesReserva.usuarioPodeReservar()) {
                    Sistema.notificar(
                        PermissoesReserva.getMensagemNegacao(),
                        'error'
                    );
                    return;
                }
                
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === repId);
                if (!rep || rep.status !== 'livre') {
                    Sistema.notificar('Esta repartiÃ§Ã£o nÃ£o estÃ¡ disponÃ­vel!', 'error');
                    return;
                }
                
                // v10.38: Verificar se leito estÃ¡ bloqueado
                if (rep.bloqueado) {
                    Sistema.notificar('â›” Este leito estÃ¡ BLOQUEADO e nÃ£o pode ser reservado!', 'error');
                    return;
                }

                // Usar modal dedicado de reserva
                document.getElementById('reservar-reparticao-id').value = repId;
                
                // Popular lista de pacientes (INCLUIR PRÃ‰-CADASTROS para reserva)
                const select = document.getElementById('reservar-paciente');
                const pacientes = SistemaCore.dados.pacientes;
                let html = '<option value="">Selecione...</option>';
                pacientes.forEach(p => {
                    const status = p.cadastro_completo === false ? ' [PRÃ‰-CADASTRO]' : '';
                    html += `<option value="${p.id}">${p.nome}${status} - CPF: ${p.cpf || 'nÃ£o informado'}</option>`;
                });
                select.innerHTML = html;

                // Popular lista de profissionais
                const selectProf = document.getElementById('reservar-profissional');
                const profissionais = SistemaCore.dados.profissionais;
                let htmlProf = '<option value="">Selecione...</option>';
                profissionais.forEach(prof => {
                    const especialidade = prof.especialidade_principal || prof.especialidade || '';
                    htmlProf += `<option value="${prof.id}">${prof.nome}${especialidade ? ' - ' + especialidade : ''}</option>`;
                });
                selectProf.innerHTML = htmlProf;

                // Limpar campos
                document.getElementById('reservar-tipo').value = 'matriciamento';
                document.getElementById('reservar-observacoes').value = '';
                document.getElementById('reservar-data').value = ''; // v9.0

                // Abrir modal de reserva
                const modal = document.getElementById('modalReservar');
                modal.classList.add('active');
                
                console.log('âœ… [RESERVA] Modal de reserva aberto com sucesso');
            },
            
            // v8.0.6: NOVO - Fechar modal de reserva
            fecharModalReservar() {
                const modal = document.getElementById('modalReservar');
                modal.classList.remove('active');
                
                // Limpar campos
                document.getElementById('reservar-reparticao-id').value = '';
                document.getElementById('reservar-paciente').value = '';
                document.getElementById('reservar-profissional').value = '';
                document.getElementById('reservar-tipo').value = 'matriciamento';
                document.getElementById('reservar-observacoes').value = '';
                document.getElementById('reservar-data').value = ''; // v9.0
            },

            // v10.66: PRÃ‰-CADASTRO RÃPIDO (usa objeto PreCadastro genÃ©rico)
            // v10.84: CORRIGIDO - NÃƒO fecha modal de reserva, apenas abre prÃ©-cadastro por cima
            abrirPreCadastroReserva() {
                const repId = parseInt(document.getElementById('reservar-reparticao-id').value);
                
                console.log('ğŸš€ [RESERVA] Abrindo prÃ©-cadastro (modal de reserva fica aberto)');
                
                // Abrir prÃ©-cadastro SEM fechar modal de reserva
                PreCadastro.abrir('reserva', repId);
            },

            // v8.0.6: ATUALIZADO - Confirmar reserva usando modal dedicado
            confirmarReserva() {
                console.log('ğŸ“… [RESERVA] confirmarReserva() chamada');
                
                // v8.0.6: Verificar permissÃµes novamente
                if (!PermissoesReserva.usuarioPodeReservar()) {
                    Sistema.notificar(
                        'VocÃª nÃ£o tem permissÃ£o para reservar leitos!',
                        'error'
                    );
                    this.fecharModalReservar();
                    return;
                }
                
                const repId = parseInt(document.getElementById('reservar-reparticao-id').value);
                const pacienteId = parseInt(document.getElementById('reservar-paciente').value);
                const profissionalId = parseInt(document.getElementById('reservar-profissional').value);
                const tipoReserva = document.getElementById('reservar-tipo').value;
                const observacoes = document.getElementById('reservar-observacoes').value.trim();
                const dataPrevista = document.getElementById('reservar-data').value; // v9.0

                if (!pacienteId) {
                    Sistema.notificar('Selecione um paciente!', 'error');
                    return;
                }
                
                // v9.0: Validar data
                if (!dataPrevista) {
                    Sistema.notificar('Informe a data prevista de entrada!', 'error');
                    return;
                }

                const rep = SistemaCore.dados.reparticoes.find(r => r.id === repId);
                if (!rep) {
                    Sistema.notificar('RepartiÃ§Ã£o nÃ£o encontrada!', 'error');
                    return;
                }

                // Verificar se paciente jÃ¡ tem reserva em outro leito
                const outraReserva = SistemaCore.dados.reparticoes.find(r => 
                    r.status === 'reservado' && 
                    r.reservado_para_paciente_id === pacienteId && 
                    r.id !== repId
                );
                
                if (outraReserva) {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                    Sistema.notificar(
                        `âš ï¸ ${paciente.nome} jÃ¡ tem reserva em ${outraReserva.nome}! Cancele a reserva anterior primeiro.`, 
                        'error'
                    );
                    return;
                }

                // Atualizar status para RESERVADO
                rep.status = 'reservado';
                rep.reservado_para_paciente_id = pacienteId;
                rep.reservado_por_profissional_id = profissionalId || null;
                rep.reservado_em = new Date().toISOString();
                rep.data_prevista_entrada = dataPrevista; // v9.0
                rep.tipo_reserva = tipoReserva;
                rep.observacoes_reserva = observacoes;

                console.log('âœ… [RESERVA] Leito reservado:', rep);

                SistemaCore.salvar();
                this.fecharModalReservar();

                const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                Sistema.notificar(`âœ… ${rep.nome} reservado para ${paciente.nome}!`);
                
                // v10.86: Sincronizar todas as visualizaÃ§Ãµes
                SistemaCore.sincronizarVisualizacoes();
            },
            
            // v8.0.8: NOVA FUNÃ‡ÃƒO - Mostrar detalhes da reserva
            verDetalhesReserva(repId) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === repId);
                if (!rep || rep.status !== 'reservado') {
                    Sistema.notificar('Reserva nÃ£o encontrada!', 'error');
                    return;
                }
                
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === rep.reservado_para_paciente_id);
                const nomePaciente = paciente ? paciente.nome : 'Paciente nÃ£o encontrado';
                const dataReserva = new Date(rep.reservado_em).toLocaleString('pt-BR');
                const tipoReserva = rep.tipo_reserva || 'Matriciamento';
                const dataPrevista = rep.data_prevista_entrada ? new Date(rep.data_prevista_entrada + 'T00:00:00').toLocaleDateString('pt-BR') : 'NÃ£o informada'; // v9.0
                
                const mensagem = `ğŸ“‹ DETALHES DA RESERVA\n\n` +
                    `ğŸ‘¤ Paciente: ${nomePaciente}\n` +
                    `ğŸ—“ï¸ Reservado em: ${dataReserva}\n` +
                    `ğŸ“… PrevisÃ£o de entrada: ${dataPrevista}\n` + // v9.0
                    `ğŸ“Œ Tipo: ${tipoReserva}\n` +
                    `ğŸ“ Leito: ${rep.nome}\n\n` +
                    `ğŸ’¡ PARA INTERNAR:\n` +
                    `1. Acesse o ProntuÃ¡rio do paciente\n` +
                    `2. Emita a AIH (AutorizaÃ§Ã£o de InternaÃ§Ã£o)\n` +
                    `3. O leito serÃ¡ ocupado automaticamente`;
                
                alert(mensagem);
            },

            // v8.0.3: NOVA FUNÃ‡ÃƒO - Cancelar reserva
            cancelarReserva(repId) {
                if (!confirm('Deseja cancelar esta reserva?')) return;

                const rep = SistemaCore.dados.reparticoes.find(r => r.id === repId);
                if (!rep || rep.status !== 'reservado') {
                    Sistema.notificar('Esta repartiÃ§Ã£o nÃ£o estÃ¡ reservada!', 'error');
                    return;
                }

                console.log('âŒ [RESERVA] Cancelando reserva do leito:', rep.nome);

                // Limpar campos de reserva
                rep.status = 'livre';
                rep.reservado_para_paciente_id = null;
                rep.reservado_por_profissional_id = null;
                rep.reservado_em = null;
                rep.data_prevista_entrada = null; // v9.0
                rep.tipo_reserva = null;

                SistemaCore.salvar();

                Sistema.notificar(`âœ… Reserva de ${rep.nome} cancelada!`);
                
                // v10.86: Sincronizar todas as visualizaÃ§Ãµes
                SistemaCore.sincronizarVisualizacoes();
            },


            confirmarInternacao() {
                console.log('ğŸ” [DEBUG] confirmarInternacao() chamada');
                
                const repId = parseInt(document.getElementById('internar-reparticao-id').value);
                const pacienteId = parseInt(document.getElementById('internar-paciente').value);
                const motivo = document.getElementById('internar-motivo').value.trim();
                const data = document.getElementById('internar-data').value;

                console.log('ğŸ” [DEBUG] Valores coletados:', {
                    repId,
                    pacienteId,
                    motivo,
                    data
                });

                if (!pacienteId) {
                    console.log('âŒ [DEBUG] Paciente nÃ£o selecionado');
                    Sistema.notificar('Selecione um paciente!', 'error');
                    return;
                }
                if (!motivo) {
                    console.log('âŒ [DEBUG] Motivo nÃ£o informado');
                    Sistema.notificar('Informe o motivo da internaÃ§Ã£o!', 'error');
                    return;
                }

                console.log('âœ… [DEBUG] ValidaÃ§Ãµes bÃ¡sicas OK');

                // VALIDAÃ‡ÃƒO CRÃTICA: Verificar se paciente jÃ¡ estÃ¡ internado em outro leito
                console.log('ğŸ” [DEBUG] Verificando se paciente jÃ¡ estÃ¡ internado...');
                
                const leitoOcupado = SistemaCore.dados.reparticoes.find(r => 
                    r.status === 'ocupado' && 
                    r.paciente_id === pacienteId && 
                    r.id !== repId
                );
                
                if (leitoOcupado) {
                    console.log('âš ï¸ [DEBUG] PACIENTE JÃ INTERNADO!', leitoOcupado);
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                    Sistema.notificar(
                        `âš ï¸ ERRO: ${paciente.nome} jÃ¡ estÃ¡ internado em ${leitoOcupado.nome}! Um paciente nÃ£o pode ocupar 2 leitos ao mesmo tempo.`, 
                        'error'
                    );
                    return;
                }

                console.log('âœ… [DEBUG] Paciente nÃ£o estÃ¡ internado em outro leito');

                const rep = SistemaCore.dados.reparticoes.find(r => r.id === repId);
                if (!rep) {
                    console.log('âŒ [DEBUG] RepartiÃ§Ã£o nÃ£o encontrada! ID:', repId);
                    Sistema.notificar('Erro: RepartiÃ§Ã£o nÃ£o encontrada!', 'error');
                    return;
                }

                console.log('âœ… [DEBUG] RepartiÃ§Ã£o encontrada:', rep.nome);

                // v7.8: VALIDAR ESPECIALIDADE DO PROFISSIONAL
                const profissionalId = parseInt(document.getElementById('internar-profissional').value);
                if (!profissionalId) {
                    Sistema.notificar('Selecione o profissional responsÃ¡vel!', 'error');
                    return;
                }

                const profissional = SistemaCore.dados.profissionais.find(p => p.id === profissionalId);
                if (!profissional) {
                    Sistema.notificar('Profissional nÃ£o encontrado!', 'error');
                    return;
                }

                // ğŸ” VALIDAÃ‡ÃƒO FUNDAMENTAL: SOMENTE MÃ‰DICOS PODEM INTERNAR
                console.log('ğŸ” [DEBUG] Validando categoria do profissional...');
                if (!profissional.categoria_profissional || profissional.categoria_profissional !== 'medico') {
                    const categoriaAtual = profissional.categoria_profissional || 'nÃ£o definida';
                    console.log('âŒ [DEBUG] Profissional NÃƒO Ã© mÃ©dico! Categoria:', categoriaAtual);
                    
                    const categoriaNome = profissional.categoria_profissional ? 
                        Prontuarios.getNomeCategoria(profissional.categoria_profissional) : 
                        'NÃ£o definida';
                    
                    Sistema.notificar(
                        `âš ï¸ APENAS MÃ‰DICOS PODEM INTERNAR PACIENTES!\n\n` +
                        `Profissional selecionado: ${profissional.nome}\n` +
                        `Categoria: ${categoriaNome}\n\n` +
                        `Por favor, selecione um profissional da categoria "MÃ©dico(a)" para realizar a internaÃ§Ã£o.`,
                        'error'
                    );
                    return;
                }
                console.log('âœ… [DEBUG] Profissional Ã© mÃ©dico! Pode internar em QUALQUER unidade.');

                // ğŸ¯ LÃ“GICA SIMPLIFICADA: MÃ©dico pode internar em qualquer lugar!
                // As especialidades das unidades sÃ£o apenas para ORGANIZAÃ‡ÃƒO dos pacientes
                console.log('ğŸ¥ ========== DEBUG INTERNAÃ‡ÃƒO ==========');
                console.log('ğŸ‘¤ MÃ©dico:', profissional.nome);
                console.log('â­ Especialidade do mÃ©dico:', profissional.especialidade_principal || profissional.especialidade || 'NÃ£o informada');
                console.log('ğŸ¢ Unidade:', rep.nome);
                console.log('ğŸ“‹ Tipo de unidade:', rep.especialidades_permitidas?.join(', ') || 'Geral');
                console.log('âœ… MÃ©dico pode internar em qualquer unidade!');
                console.log('ğŸ” ========================================');

                console.log('ğŸ” [DEBUG] Internando paciente...');

                // Obter dados do paciente
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);

                rep.status = 'ocupado';
                rep.paciente_id = pacienteId;
                rep.data_ocupacao = data;
                rep.motivo_internacao = motivo;
                rep.profissional_internacao_id = profissionalId; // Guardar quem internou
                
                // v10.446: VINCULAR INTERNAÃ‡ÃƒO Ã€ ENTRADA DO PACIENTE
                console.log('ğŸ”— [v10.446] Verificando entrada ativa do paciente...');
                const entradaAtiva = Atendimentos.buscarEntradaAtiva(pacienteId);
                if (entradaAtiva) {
                    console.log('âœ… [v10.446] Entrada ativa encontrada:', entradaAtiva.numero);
                    Atendimentos.vincularInternacao(entradaAtiva.id, {
                        leito_id: repId,
                        leito_nome: rep.nome,
                        setor: rep.setor || rep.pavilhao || '',
                        data_hora: data,
                        motivo: motivo,
                        medico_id: profissionalId,
                        medico_nome: profissional.nome
                    });
                } else {
                    console.log('â„¹ï¸ [v10.446] Paciente nÃ£o tem entrada ativa - internaÃ§Ã£o direta');
                }
                
                // v8.0.3: LIMPAR CAMPOS DE RESERVA (se estava reservado)
                if (rep.reservado_para_paciente_id) {
                    console.log('ğŸ”„ [AUTO-LIBERAÃ‡ÃƒO] Leito estava reservado, limpando campos de reserva...');
                    rep.reservado_para_paciente_id = null;
                    rep.reservado_por_profissional_id = null;
                    rep.reservado_em = null;
                    rep.tipo_reserva = null;
                }
                
                // v8.0.3: AUTO-LIBERAÃ‡ÃƒO - Verificar se paciente tinha OUTRO leito reservado
                console.log('ğŸ” [AUTO-LIBERAÃ‡ÃƒO] Verificando se paciente tinha leito reservado em outro local...');
                const leitoReservado = SistemaCore.dados.reparticoes.find(r => 
                    r.status === 'reservado' && 
                    r.reservado_para_paciente_id === pacienteId &&
                    r.id !== repId  // NÃ£o o leito atual
                );
                
                if (leitoReservado) {
                    console.log(`âœ… [AUTO-LIBERAÃ‡ÃƒO] Paciente tinha ${leitoReservado.nome} reservado. Liberando automaticamente...`);
                    
                    leitoReservado.status = 'livre';
                    leitoReservado.reservado_para_paciente_id = null;
                    leitoReservado.reservado_por_profissional_id = null;
                    leitoReservado.reservado_em = null;
                    leitoReservado.tipo_reserva = null;
                    
                    console.log(`âœ… [AUTO-LIBERAÃ‡ÃƒO] ${leitoReservado.nome} liberado automaticamente!`);
                } else {
                    console.log('â„¹ï¸ [AUTO-LIBERAÃ‡ÃƒO] Paciente nÃ£o tinha nenhum leito reservado.');
                }

                // ğŸ“… CRIAR AGENDAMENTO DA INTERNAÃ‡ÃƒO
                console.log('ğŸ“… [DEBUG] Criando agendamento de internaÃ§Ã£o...');
                console.log('ğŸ“… [DEBUG] Data original do input:', data);
                const dataInternacao = new Date(data);
                console.log('ğŸ“… [DEBUG] Data como objeto:', dataInternacao);
                const dataFormatada = dataInternacao.toISOString().split('T')[0];
                console.log('ğŸ“… [DEBUG] Data formatada (YYYY-MM-DD):', dataFormatada);
                const horaFormatada = dataInternacao.toTimeString().slice(0,5);
                console.log('ğŸ“… [DEBUG] Hora formatada (HH:MM):', horaFormatada);
                
                // Inicializar arrays se nÃ£o existirem
                if (!SistemaCore.dados.agendamentos) {
                    SistemaCore.dados.agendamentos = [];
                }
                if (!SistemaCore.dados.atendimentos) {
                    SistemaCore.dados.atendimentos = [];
                }
                
                const agendamento = {
                    id: SistemaCore.proximoId(SistemaCore.dados.agendamentos),
                    paciente_id: pacienteId,
                    paciente_nome: paciente ? paciente.nome : 'Paciente',
                    profissional_id: profissionalId,
                    profissional_nome: profissional.nome,
                    reparticao_id: repId,
                    reparticao_nome: rep.nome,
                    data: dataFormatada,
                    hora: horaFormatada,
                    tipo: 'ğŸŸ¢ InternaÃ§Ã£o',
                    motivo: motivo,
                    status: 'realizado', // InternaÃ§Ã£o Ã© um evento que jÃ¡ aconteceu
                    observacoes: `InternaÃ§Ã£o em ${rep.nome}`
                };
                
                SistemaCore.dados.agendamentos.push(agendamento);
                console.log('âœ… [DEBUG] Agendamento criado:', agendamento);

                // ğŸ“‹ CRIAR EVOLUÃ‡ÃƒO NO PRONTUÃRIO
                console.log('ğŸ“‹ [DEBUG] Criando evoluÃ§Ã£o de internaÃ§Ã£o no prontuÃ¡rio...');
                const evolucaoInternacao = {
                    id: SistemaCore.proximoId(SistemaCore.dados.atendimentos),
                    agendamento_id: agendamento.id,
                    paciente_id: pacienteId,
                    profissional_id: profissionalId,
                    data_atendimento: dataInternacao.toISOString(),
                    tipo_evolucao: 'internacao',
                    queixa: `InternaÃ§Ã£o em ${rep.nome}`,
                    conduta: `Paciente internado em ${rep.nome} por ${motivo}`,
                    diagnostico: motivo,
                    observacoes: `Internado por: ${profissional.nome}`
                };
                
                SistemaCore.dados.atendimentos.push(evolucaoInternacao);
                console.log('âœ… [DEBUG] EvoluÃ§Ã£o de internaÃ§Ã£o criada:', evolucaoInternacao);

                console.log('âœ… [DEBUG] Dados atualizados. Salvando...');
                SistemaCore.salvar();
                console.log('âœ… [DEBUG] Salvo! Atualizando lista...');
                this.listar();
                this.fecharModalInternar();
                
                // Atualizar calendÃ¡rio se estiver visÃ­vel
                if (typeof Calendario !== 'undefined' && Calendario.renderizar) {
                    Calendario.renderizar();
                    console.log('âœ… [DEBUG] CalendÃ¡rio atualizado!');
                }
                
                Sistema.notificar('Paciente internado com sucesso! Registro criado no prontuÃ¡rio.');
                console.log('âœ… [DEBUG] InternaÃ§Ã£o concluÃ­da!');
                
                // v10.86: Sincronizar todas as visualizaÃ§Ãµes
                SistemaCore.sincronizarVisualizacoes();
            },

            abrirModalAlta(repId) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === repId);
                if (!rep || !rep.paciente_id) {
                    Sistema.notificar('NÃ£o hÃ¡ paciente internado nesta repartiÃ§Ã£o!', 'error');
                    return;
                }

                const paciente = SistemaCore.dados.pacientes.find(p => p.id === rep.paciente_id);
                
                document.getElementById('alta-reparticao-id').value = repId;
                document.getElementById('alta-paciente-nome').value = paciente ? paciente.nome : 'Desconhecido';
                
                const agora = new Date();
                agora.setMinutes(agora.getMinutes() - agora.getTimezoneOffset());
                document.getElementById('alta-data').value = agora.toISOString().slice(0,16);
                document.getElementById('alta-tipo').value = 'clinica';
                document.getElementById('alta-observacoes').value = '';

                document.getElementById('modalAlta').classList.add('active');
            },

            fecharModalAlta() {
                document.getElementById('modalAlta').classList.remove('active');
            },

            confirmarAlta() {
                const repId = parseInt(document.getElementById('alta-reparticao-id').value);
                const tipoAlta = document.getElementById('alta-tipo').value;
                const dataAlta = document.getElementById('alta-data').value;
                const observacoes = document.getElementById('alta-observacoes').value.trim();

                const rep = SistemaCore.dados.reparticoes.find(r => r.id === repId);
                if (!rep) return;

                // Registrar no SAME
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === rep.paciente_id);
                if (paciente) {
                    const registroSAME = {
                        id: SistemaCore.proximoId(SistemaCore.dados.same),
                        paciente_nome: paciente.nome,
                        paciente_cpf: paciente.cpf,
                        leito: rep.nome,
                        data_internacao: rep.data_ocupacao,
                        data_alta: dataAlta,
                        dias_internado: this.calcularDiasInternado(rep.data_ocupacao, dataAlta),
                        motivo_internacao: rep.motivo_internacao,
                        tipo_alta: tipoAlta,
                        observacoes: observacoes
                    };
                    SistemaCore.dados.same.push(registroSAME);
                }
                
                // v10.446: REGISTRAR ALTA NA ENTRADA DO PACIENTE
                console.log('ğŸ”— [v10.446] Verificando entrada ativa do paciente para alta...');
                const entradaAtiva = Atendimentos.buscarEntradaAtiva(rep.paciente_id);
                if (entradaAtiva) {
                    console.log('âœ… [v10.446] Entrada ativa encontrada:', entradaAtiva.numero);
                    
                    const tiposAltaMapeados = {
                        'clinica': 'alta',
                        'hospitalar': 'alta',
                        'evasao': 'evasao',
                        'obito': 'obito',
                        'transferencia': 'transferencia'
                    };
                    
                    Atendimentos.registrarAlta(entradaAtiva.id, {
                        data_hora: dataAlta,
                        medico_id: rep.profissional_internacao_id,
                        medico_nome: SistemaCore.dados.profissionais.find(p => p.id === rep.profissional_internacao_id)?.nome || '',
                        tipo: tiposAltaMapeados[tipoAlta] || 'alta',
                        destino: tipoAlta === 'transferencia' ? 'outro_hospital' : 'domicilio',
                        sumario: observacoes || '',
                        orientacoes: observacoes || ''
                    });
                } else {
                    console.log('â„¹ï¸ [v10.446] Paciente nÃ£o tem entrada ativa - liberaÃ§Ã£o direta do leito');
                }

                // ğŸ“… CRIAR AGENDAMENTO DA ALTA
                console.log('ğŸ“… [DEBUG] Criando agendamento de alta...');
                const dataAltaObj = new Date(dataAlta);
                const dataAltaFormatada = dataAltaObj.toISOString().split('T')[0];
                const horaAltaFormatada = dataAltaObj.toTimeString().slice(0,5);
                
                const profissionalInternacao = SistemaCore.dados.profissionais.find(p => p.id === rep.profissional_internacao_id);
                
                const tiposAlta = {
                    'clinica': 'Alta ClÃ­nica',
                    'hospitalar': 'Alta Hospitalar',
                    'evasao': 'EvasÃ£o',
                    'obito': 'Ã“bito',
                    'transferencia': 'TransferÃªncia'
                };
                
                const agendamentoAlta = {
                    id: SistemaCore.proximoId(SistemaCore.dados.agendamentos),
                    paciente_id: paciente.id,
                    paciente_nome: paciente.nome,
                    profissional_id: rep.profissional_internacao_id || null,
                    profissional_nome: profissionalInternacao ? profissionalInternacao.nome : 'N/A',
                    reparticao_id: repId,
                    reparticao_nome: rep.nome,
                    data: dataAltaFormatada,
                    hora: horaAltaFormatada,
                    tipo: `ğŸ“¤ ${tiposAlta[tipoAlta] || 'Alta'}`,
                    motivo: `Alta do tipo: ${tiposAlta[tipoAlta] || tipoAlta}`,
                    status: 'realizado',
                    observacoes: observacoes || `Alta de ${rep.nome}`
                };
                
                SistemaCore.dados.agendamentos.push(agendamentoAlta);
                console.log('âœ… [DEBUG] Agendamento de alta criado:', agendamentoAlta);

                // ğŸ“‹ CRIAR EVOLUÃ‡ÃƒO DE ALTA NO PRONTUÃRIO
                console.log('ğŸ“‹ [DEBUG] Criando evoluÃ§Ã£o de alta no prontuÃ¡rio...');
                const evolucaoAlta = {
                    id: SistemaCore.proximoId(SistemaCore.dados.atendimentos),
                    agendamento_id: agendamentoAlta.id,
                    paciente_id: paciente.id,
                    profissional_id: rep.profissional_internacao_id || null,
                    data_atendimento: dataAltaObj.toISOString(),
                    tipo_evolucao: 'alta',
                    queixa: `Alta de ${rep.nome}`,
                    conduta: `${tiposAlta[tipoAlta] || 'Alta'}: ${observacoes || 'Sem observaÃ§Ãµes'}`,
                    diagnostico: `Dias internado: ${this.calcularDiasInternado(rep.data_ocupacao, dataAlta)}`,
                    observacoes: `Tipo de alta: ${tiposAlta[tipoAlta] || tipoAlta}`
                };
                
                SistemaCore.dados.atendimentos.push(evolucaoAlta);
                console.log('âœ… [DEBUG] EvoluÃ§Ã£o de alta criada:', evolucaoAlta);

                // Liberar leito (v10.446: Se tinha entrada, jÃ¡ foi liberado pela funÃ§Ã£o registrarAlta)
                // Mas mantemos aqui como fallback para entradas sem vÃ­nculo
                rep.status = 'livre';
                rep.paciente_id = null;
                rep.data_ocupacao = null;
                rep.motivo_internacao = null;
                rep.profissional_internacao_id = null;

                SistemaCore.salvar();
                this.listar();
                this.fecharModalAlta();
                
                // Atualizar calendÃ¡rio se estiver visÃ­vel
                if (typeof Calendario !== 'undefined' && Calendario.renderizar) {
                    Calendario.renderizar();
                    console.log('âœ… [DEBUG] CalendÃ¡rio atualizado apÃ³s alta!');
                }
                
                Sistema.notificar('Alta registrada! Enviada para SAME e prontuÃ¡rio atualizado.', 'success');
                
                // v10.86: Sincronizar todas as visualizaÃ§Ãµes
                SistemaCore.sincronizarVisualizacoes();
            },

            reativar(id) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === id);
                if (!rep) return;
                
                rep.status = 'livre';
                SistemaCore.salvar();
                this.listar();
                Sistema.notificar('ğŸŸ¢ Unidade reativada!');
            },

            desativar(id) {
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === id);
                if (!rep) return;
                
                // v9.0: ConfirmaÃ§Ã£o especial se estiver OCUPADO
                if (rep.status === 'ocupado') {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === rep.paciente_id);
                    const nomePaciente = paciente ? paciente.nome : 'paciente';
                    
                    if (!confirm(
                        `âš ï¸ ATENÃ‡ÃƒO: LEITO OCUPADO!\n\n` +
                        `Este leito estÃ¡ com ${nomePaciente} internado(a)!\n\n` +
                        `Desativar marca o leito com problema estrutural, mas o paciente ainda permanece nele.\n\n` +
                        `Use apenas para sinalizar problemas urgentes:\n` +
                        `â€¢ InfiltraÃ§Ã£o\n` +
                        `â€¢ Equipamento quebrado\n` +
                        `â€¢ Risco estrutural\n\n` +
                        `O leito ficarÃ¡ bloqueado para novas internaÃ§Ãµes apÃ³s a alta deste paciente.\n\n` +
                        `Deseja REALMENTE desativar este leito ocupado?`
                    )) {
                        return;
                    }
                } else {
                    // ConfirmaÃ§Ã£o normal para leitos livres/reservados
                    if (!confirm('âš« Desativar esta unidade?\n\nEla nÃ£o poderÃ¡ ser usada atÃ© ser reativada.')) return;
                }
                
                rep.status = 'desativado';
                SistemaCore.salvar();
                this.listar();
                Sistema.notificar('âš« Unidade desativada!');
            },

            // ğŸ” DIAGNÃ“STICO v7.5.4: Encontrar e limpar repartiÃ§Ãµes "fantasmas"
            diagnosticarProblemas() {
                console.log('ğŸ” ========== DIAGNÃ“STICO DE REPARTIÃ‡Ã•ES ==========');
                
                const reps = SistemaCore.dados.reparticoes;
                const pacientes = SistemaCore.dados.pacientes;
                
                // 1. Todas as repartiÃ§Ãµes
                console.log(`ğŸ“Š Total de repartiÃ§Ãµes: ${reps.length}`);
                
                // 2. RepartiÃ§Ãµes VISÃVEIS (que aparecem na tela)
                const visiveis = reps.filter(r => !r.eh_subreparticao);
                console.log(`ğŸ‘ï¸ RepartiÃ§Ãµes VISÃVEIS na tela: ${visiveis.length}`);
                
                // 3. RepartiÃ§Ãµes INVISÃVEIS (fantasmas)
                const fantasmas = reps.filter(r => r.eh_subreparticao && !reps.some(p => p.subreparticoes_ids?.includes(r.id)));
                console.log(`ğŸ‘» RepartiÃ§Ãµes FANTASMAS (invisÃ­veis): ${fantasmas.length}`);
                
                // 4. TODAS as repartiÃ§Ãµes (tabela completa)
                console.log('\nğŸ“‹ LISTA COMPLETA DE TODAS AS REPARTIÃ‡Ã•ES:');
                console.table(reps.map(r => ({
                    ID: r.id,
                    Nome: r.nome,
                    Tipo: r.tipo_reparticao || 'consultorio',
                    Categoria: r.categoria,
                    Status: r.status,
                    VisÃ­vel: !r.eh_subreparticao ? 'âœ… SIM' : 'âŒ NÃƒO',
                    Ã“rfÃ£: (r.eh_subreparticao && !reps.some(p => p.subreparticoes_ids?.includes(r.id))) ? 'ğŸ‘» SIM' : 'ğŸŸ¢ NÃƒO',
                    Ocupada: r.status === 'ocupado' ? 'ğŸ”´ SIM' : 'ğŸŸ¢ NÃƒO',
                    Paciente: r.paciente_id || '-'
                })));
                
                // 5. Se hÃ¡ diferenÃ§a entre total e visÃ­veis
                if (reps.length !== visiveis.length) {
                    console.log('\nâš ï¸ DIFERENÃ‡A DETECTADA!');
                    console.log(`ğŸ“Š Total no banco: ${reps.length}`);
                    console.log(`ğŸ‘ï¸ Aparecem na tela: ${visiveis.length}`);
                    console.log(`ğŸ‘» Fantasmas: ${reps.length - visiveis.length}`);
                    
                    const todasFantasmas = reps.filter(r => r.eh_subreparticao);
                    if (todasFantasmas.length > 0) {
                        console.log('\nğŸ‘» LISTA DE FANTASMAS:');
                        console.table(todasFantasmas.map(r => ({
                            ID: r.id,
                            Nome: r.nome,
                            Status: r.status,
                            Paciente: r.paciente_id || '-',
                            eh_subreparticao: r.eh_subreparticao ? 'SIM' : 'NÃƒO'
                        })));
                    }
                }
                
                // 6. Pacientes "presos" em leitos invisÃ­veis
                const pacientesPresos = [];
                fantasmas.forEach(r => {
                    if (r.paciente_id) {
                        const pac = pacientes.find(p => p.id === r.paciente_id);
                        if (pac) {
                            pacientesPresos.push({
                                Leito: r.nome,
                                Paciente: pac.nome,
                                ID_Leito: r.id,
                                ID_Paciente: r.paciente_id
                            });
                        }
                    }
                });
                
                if (pacientesPresos.length > 0) {
                    console.log('ğŸš¨ PACIENTES PRESOS EM LEITOS INVISÃVEIS:');
                    console.table(pacientesPresos);
                }
                
                // 7. Mostrar resultado
                let mensagem = `ğŸ“Š DiagnÃ³stico:\n\n`;
                mensagem += `âœ… Total de repartiÃ§Ãµes: ${reps.length}\n`;
                mensagem += `ğŸ‘ï¸ VisÃ­veis na tela: ${visiveis.length}\n`;
                mensagem += `ğŸ‘» Fantasmas (invisÃ­veis): ${reps.length - visiveis.length}\n`;
                mensagem += `âš ï¸ Ocupadas invisÃ­veis: ${fantasmas.filter(r => r.status === 'ocupado').length}\n`;
                mensagem += `ğŸš¨ Pacientes presos: ${pacientesPresos.length}\n\n`;
                
                if (reps.length > visiveis.length) {
                    const numFantasmas = reps.length - visiveis.length;
                    mensagem += `âš ï¸ HÃ¡ ${numFantasmas} repartiÃ§Ãµes invisÃ­veis!\n\n`;
                    
                    // Se tem MUITAS fantasmas (>50% do total), provavelmente sÃ£o repartiÃ§Ãµes legÃ­timas marcadas errado
                    if (numFantasmas > visiveis.length) {
                        mensagem += `ğŸ’¡ DICA: VocÃª tem MAIS invisÃ­veis do que visÃ­veis!\n`;
                        mensagem += `Provavelmente essas sÃ£o repartiÃ§Ãµes LEGÃTIMAS marcadas incorretamente.\n\n`;
                        mensagem += `ğŸ”§ SoluÃ§Ã£o recomendada:\n`;
                        mensagem += `â€¢ Reparticoes.tornarFantasmasVisiveis() - TORNAR VISÃVEIS\n\n`;
                        mensagem += `Outras opÃ§Ãµes:\n`;
                        mensagem += `â€¢ Reparticoes.verFantasmas() - Ver lista detalhada\n`;
                        mensagem += `â€¢ Reparticoes.deletarFantasmas() - DELETAR (cuidado!)`;
                    } else {
                        mensagem += `ğŸ”§ OpÃ§Ãµes:\n`;
                        mensagem += `â€¢ Reparticoes.verFantasmas() - Ver lista detalhada\n`;
                        mensagem += `â€¢ Reparticoes.tornarFantasmasVisiveis() - Tornar visÃ­veis\n`;
                        mensagem += `â€¢ Reparticoes.deletarFantasmas() - DELETAR as invisÃ­veis`;
                    }
                    alert(mensagem);
                } else {
                    mensagem += `âœ… Nenhum problema encontrado!`;
                    alert(mensagem);
                }
                
                console.log('ğŸ” ========== FIM DO DIAGNÃ“STICO ==========');
            },

            // ğŸ‘ï¸ VER FANTASMAS v7.5.4: Listar apenas as invisÃ­veis
            verFantasmas() {
                const reps = SistemaCore.dados.reparticoes;
                const fantasmas = reps.filter(r => r.eh_subreparticao);
                
                console.log('ğŸ‘» ========== REPARTIÃ‡Ã•ES FANTASMAS ==========');
                console.log(`Total: ${fantasmas.length}`);
                console.table(fantasmas.map(r => ({
                    ID: r.id,
                    Nome: r.nome,
                    Tipo: r.tipo_reparticao,
                    Status: r.status,
                    Paciente_ID: r.paciente_id || '-',
                    eh_subreparticao: r.eh_subreparticao
                })));
                
                alert(`ğŸ‘» ${fantasmas.length} fantasmas encontrados!\n\nVeja a lista completa no Console (F12)`);
            },

            // âœ¨ TORNAR VISÃVEIS v7.5.4: Converter fantasmas em repartiÃ§Ãµes normais
            tornarFantasmasVisiveis() {
                const reps = SistemaCore.dados.reparticoes;
                const fantasmas = reps.filter(r => r.eh_subreparticao);
                
                if (fantasmas.length === 0) {
                    alert('âœ… NÃ£o hÃ¡ fantasmas para tornar visÃ­veis!');
                    return;
                }
                
                let mensagem = `âœ¨ TORNAR VISÃVEIS\n\n`;
                mensagem += `Isso vai tornar ${fantasmas.length} repartiÃ§Ãµes VISÃVEIS novamente!\n\n`;
                mensagem += `Elas vÃ£o aparecer normalmente na lista de Unidades.\n\n`;
                mensagem += `Deseja continuar?`;
                
                if (!confirm(mensagem)) {
                    return;
                }
                
                console.log('âœ¨ Tornando fantasmas visÃ­veis...');
                fantasmas.forEach(r => {
                    console.log(`âœ¨ Tornando visÃ­vel: ${r.nome}`);
                    r.eh_subreparticao = false;
                    r.eh_grupo = false;
                    // Limpar vÃ­nculos antigos
                    delete r.subreparticoes_ids;
                    delete r.grupo_pai_id;
                });
                
                SistemaCore.salvar();
                this.listar();
                
                Sistema.notificar(`âœ… ${fantasmas.length} repartiÃ§Ãµes agora estÃ£o VISÃVEIS!`, 'success');
                console.log(`âœ… ConversÃ£o concluÃ­da: ${fantasmas.length} repartiÃ§Ãµes visÃ­veis`);
                
                alert(`âœ… Sucesso!\n\n${fantasmas.length} repartiÃ§Ãµes agora estÃ£o VISÃVEIS na lista!`);
            },

            // ğŸ—‘ï¸ DELETAR FANTASMAS v7.5.4: Remover completamente do banco
            deletarFantasmas() {
                const reps = SistemaCore.dados.reparticoes;
                const fantasmas = reps.filter(r => r.eh_subreparticao);
                
                if (fantasmas.length === 0) {
                    alert('âœ… NÃ£o hÃ¡ fantasmas para deletar!');
                    return;
                }
                
                // Verificar se algum estÃ¡ ocupado
                const ocupados = fantasmas.filter(r => r.status === 'ocupado');
                
                let mensagem = `âš ï¸ ATENÃ‡ÃƒO: Isso vai DELETAR ${fantasmas.length} repartiÃ§Ãµes invisÃ­veis!\n\n`;
                
                if (ocupados.length > 0) {
                    mensagem += `ğŸš¨ ${ocupados.length} estÃ£o OCUPADAS!\n`;
                    mensagem += `Os pacientes serÃ£o LIBERADOS (nÃ£o deletados).\n\n`;
                }
                
                mensagem += `Esta aÃ§Ã£o Ã© IRREVERSÃVEL!\n\nDeseja continuar?`;
                
                if (!confirm(mensagem)) {
                    return;
                }
                
                // Segundo aviso para ocupados
                if (ocupados.length > 0 && !confirm(`ğŸš¨ ÃšLTIMA CONFIRMAÃ‡ÃƒO:\n\n${ocupados.length} leitos ocupados serÃ£o deletados!\n\nTEM CERTEZA?`)) {
                    return;
                }
                
                // Deletar fantasmas
                console.log('ğŸ—‘ï¸ Iniciando deleÃ§Ã£o de fantasmas...');
                fantasmas.forEach(r => {
                    console.log(`ğŸ—‘ï¸ Deletando: ID ${r.id} - ${r.nome}`);
                });
                
                SistemaCore.dados.reparticoes = reps.filter(r => !r.eh_subreparticao);
                
                SistemaCore.salvar();
                this.listar();
                
                Sistema.notificar(`âœ… ${fantasmas.length} fantasmas foram DELETADOS!`, 'success');
                console.log(`âœ… DeleÃ§Ã£o concluÃ­da: ${fantasmas.length} repartiÃ§Ãµes removidas`);
                
                // Mostrar resultado
                const total = SistemaCore.dados.reparticoes.length;
                alert(`âœ… Limpeza concluÃ­da!\n\nğŸ“Š RepartiÃ§Ãµes restantes: ${total}\nğŸ‘» Fantasmas deletados: ${fantasmas.length}`);
            },

            // ğŸ§¹ LIMPEZA v7.5.4: Limpar repartiÃ§Ãµes fantasmas (antiga - mantida por compatibilidade)
            limparFantasmas() {
                if (!confirm('âš ï¸ Isso vai LIBERAR todos os leitos invisÃ­veis ocupados.\n\nOs pacientes NÃƒO serÃ£o deletados, apenas liberados.\n\nContinuar?')) {
                    return;
                }
                
                const reps = SistemaCore.dados.reparticoes;
                
                // Sub-repartiÃ§Ãµes Ã³rfÃ£s ocupadas
                const fantasmas = reps.filter(r => 
                    r.eh_subreparticao && 
                    !reps.some(p => p.subreparticoes_ids?.includes(r.id))
                );
                
                let liberados = 0;
                fantasmas.forEach(r => {
                    if (r.status === 'ocupado') {
                        console.log(`ğŸ§¹ Liberando: ${r.nome} (Paciente ID: ${r.paciente_id})`);
                        r.status = 'livre';
                        r.paciente_id = null;
                        r.data_ocupacao = null;
                        r.motivo_internacao = null;
                        liberados++;
                    }
                });
                
                SistemaCore.salvar();
                this.listar();
                
                Sistema.notificar(`âœ… ${liberados} leitos fantasmas foram liberados!`, 'success');
                console.log(`âœ… Limpeza concluÃ­da: ${liberados} leitos liberados`);
            },
            
            // v10.5: Adicionar nome ao pool
            adicionarNomeAoPool() {
                const input = document.getElementById('rep-nome-novo');
                const nome = input.value.trim();
                
                if (!nome) {
                    alert('âŒ Digite o nome!');
                    return;
                }
                
                if (!SistemaCore.dados.pools.nomes_sugeridos) {
                    SistemaCore.dados.pools.nomes_sugeridos = [];
                }
                
                // Verificar se jÃ¡ existe
                const jÃ¡Existe = SistemaCore.dados.pools.nomes_sugeridos
                    .some(n => n.toLowerCase() === nome.toLowerCase());
                
                if (jÃ¡Existe) {
                    alert('âš ï¸ Este nome jÃ¡ existe no pool!');
                    return;
                }
                
                // Adicionar
                SistemaCore.dados.pools.nomes_sugeridos.push(nome);
                SistemaCore.salvar();
                
                // Recarregar datalist e select de deletar
                this.carregarNomesDatalist();
                this.carregarSelectDeletarNomes();
                
                // Limpar input
                input.value = '';
                
                Sistema.notificar(`âœ… Nome "${nome}" adicionado ao pool!`);
            },
            
            // v10.5: Deletar nome do pool
            deletarNomeDoPool() {
                const select = document.getElementById('rep-nome-deletar-select');
                const nome = select.value;
                
                if (!nome) {
                    alert('âš ï¸ Selecione um nome para deletar!');
                    return;
                }
                
                // Verificar uso
                const uso = this.contarUsoNome(nome);
                
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL DELETAR!\n\n"${nome}" estÃ¡ sendo usado em ${uso} unidade(s).\n\nâœ… COMO RESOLVER:\n1. Edite cada unidade que usa "${nome}"\n2. Altere o nome delas\n3. Depois volte aqui para deletar do pool`);
                    return;
                }
                
                if (!SistemaCore.dados.pools.nomes_sugeridos) {
                    SistemaCore.dados.pools.nomes_sugeridos = [];
                }
                
                const index = SistemaCore.dados.pools.nomes_sugeridos.indexOf(nome);
                
                if (index === -1) {
                    alert(`âš ï¸ "${nome}" nÃ£o estÃ¡ no pool!`);
                    return;
                }
                
                if (confirm(`ğŸ—‘ï¸ DELETAR DO POOL?\n\n"${nome}"\n\nIsso removerÃ¡ permanentemente este nome do sistema.`)) {
                    SistemaCore.dados.pools.nomes_sugeridos.splice(index, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… Nome removido do pool!');
                    
                    // Recarregar datalist e select de deletar
                    this.carregarNomesDatalist();
                    this.carregarSelectDeletarNomes();
                }
            },
            
            // v10.5: Adicionar pavilhÃ£o ao pool
            adicionarPavilhaoAoPool() {
                const input = document.getElementById('rep-pavilhao-novo');
                const pavilhao = input.value.trim();
                
                if (!pavilhao) {
                    alert('âŒ Digite o nome do pavilhÃ£o!');
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.pavilhoes) {
                    SistemaCore.dados.estabelecimento.pavilhoes = [];
                }
                
                // Verificar se jÃ¡ existe
                const jÃ¡Existe = SistemaCore.dados.estabelecimento.pavilhoes
                    .some(p => p.toLowerCase() === pavilhao.toLowerCase());
                
                if (jÃ¡Existe) {
                    alert('âš ï¸ Este pavilhÃ£o jÃ¡ existe no pool!');
                    return;
                }
                
                // Adicionar
                SistemaCore.dados.estabelecimento.pavilhoes.push(pavilhao);
                SistemaCore.salvar();
                
                // Recarregar select e select de deletar
                this.carregarPools();
                this.carregarSelectDeletarPavilhoes();
                
                // Limpar input
                input.value = '';
                
                Sistema.notificar(`âœ… PavilhÃ£o "${pavilhao}" adicionado ao pool!`);
            },
            
            // v10.5: Deletar pavilhÃ£o do pool
            deletarPavilhaoDoPool() {
                const select = document.getElementById('rep-pavilhao-deletar-select');
                const pavilhao = select.value;
                
                if (!pavilhao) {
                    alert('âš ï¸ Selecione um pavilhÃ£o para deletar!');
                    return;
                }
                
                // Verificar uso
                const uso = Pools.contarUso('pavilhoes', pavilhao);
                
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL DELETAR!\n\n"${pavilhao}" estÃ¡ sendo usado em ${uso} unidade(s).\n\nâœ… COMO RESOLVER:\n1. Edite cada unidade que usa "${pavilhao}"\n2. Altere o pavilhÃ£o delas\n3. Depois volte aqui para deletar do pool`);
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.pavilhoes) {
                    SistemaCore.dados.estabelecimento.pavilhoes = [];
                }
                
                const index = SistemaCore.dados.estabelecimento.pavilhoes.indexOf(pavilhao);
                
                if (index === -1) {
                    alert(`âš ï¸ "${pavilhao}" nÃ£o estÃ¡ no pool!`);
                    return;
                }
                
                if (confirm(`ğŸ—‘ï¸ DELETAR DO POOL?\n\n"${pavilhao}"\n\nIsso removerÃ¡ permanentemente este pavilhÃ£o do sistema.`)) {
                    SistemaCore.dados.estabelecimento.pavilhoes.splice(index, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… PavilhÃ£o removido do pool!');
                    
                    // Recarregar select e select de deletar
                    this.carregarPools();
                    this.carregarSelectDeletarPavilhoes();
                }
            },
            
            // v10.5: Adicionar andar ao pool
            adicionarAndarAoPool() {
                const input = document.getElementById('rep-andar-novo');
                const andar = input.value.trim();
                
                if (!andar) {
                    alert('âŒ Digite o nome do andar!');
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.andares) {
                    SistemaCore.dados.estabelecimento.andares = [];
                }
                
                // Verificar se jÃ¡ existe
                const jÃ¡Existe = SistemaCore.dados.estabelecimento.andares
                    .some(a => a.toLowerCase() === andar.toLowerCase());
                
                if (jÃ¡Existe) {
                    alert('âš ï¸ Este andar jÃ¡ existe no pool!');
                    return;
                }
                
                // Adicionar
                SistemaCore.dados.estabelecimento.andares.push(andar);
                SistemaCore.salvar();
                
                // Recarregar select e select de deletar
                this.carregarPools();
                this.carregarSelectDeletarAndares();
                
                // Limpar input
                input.value = '';
                
                Sistema.notificar(`âœ… Andar "${andar}" adicionado ao pool!`);
            },
            
            // v10.5: Deletar andar do pool
            deletarAndarDoPool() {
                const select = document.getElementById('rep-andar-deletar-select');
                const andar = select.value;
                
                if (!andar) {
                    alert('âš ï¸ Selecione um andar para deletar!');
                    return;
                }
                
                // Verificar uso
                const uso = Pools.contarUso('andares', andar);
                
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL DELETAR!\n\n"${andar}" estÃ¡ sendo usado em ${uso} unidade(s).\n\nâœ… COMO RESOLVER:\n1. Edite cada unidade que usa "${andar}"\n2. Altere o andar delas\n3. Depois volte aqui para deletar do pool`);
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.andares) {
                    SistemaCore.dados.estabelecimento.andares = [];
                }
                
                const index = SistemaCore.dados.estabelecimento.andares.indexOf(andar);
                
                if (index === -1) {
                    alert(`âš ï¸ "${andar}" nÃ£o estÃ¡ no pool!`);
                    return;
                }
                
                if (confirm(`ğŸ—‘ï¸ DELETAR DO POOL?\n\n"${andar}"\n\nIsso removerÃ¡ permanentemente este andar do sistema.`)) {
                    SistemaCore.dados.estabelecimento.andares.splice(index, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… Andar removido do pool!');
                    
                    // Recarregar select e select de deletar
                    this.carregarPools();
                    this.carregarSelectDeletarAndares();
                }
            },
            
            // v10.5: Adicionar setor ao pool
            adicionarSetorAoPool() {
                const input = document.getElementById('rep-setor-novo');
                const setor = input.value.trim();
                
                if (!setor) {
                    alert('âŒ Digite o nome do setor!');
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.setores) {
                    SistemaCore.dados.estabelecimento.setores = [];
                }
                
                // Verificar se jÃ¡ existe
                const jÃ¡Existe = SistemaCore.dados.estabelecimento.setores
                    .some(s => s.toLowerCase() === setor.toLowerCase());
                
                if (jÃ¡Existe) {
                    alert('âš ï¸ Este setor jÃ¡ existe no pool!');
                    return;
                }
                
                // Adicionar
                SistemaCore.dados.estabelecimento.setores.push(setor);
                SistemaCore.salvar();
                
                // Recarregar select e select de deletar
                this.carregarPools();
                this.carregarSelectDeletarSetores();
                
                // Limpar input
                input.value = '';
                
                Sistema.notificar(`âœ… Setor "${setor}" adicionado ao pool!`);
            },
            
            // v10.5: Deletar setor do pool
            deletarSetorDoPool() {
                const select = document.getElementById('rep-setor-deletar-select');
                const setor = select.value;
                
                if (!setor) {
                    alert('âš ï¸ Selecione um setor para deletar!');
                    return;
                }
                
                // Verificar uso
                const uso = Pools.contarUso('setores', setor);
                
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL DELETAR!\n\n"${setor}" estÃ¡ sendo usado em ${uso} unidade(s).\n\nâœ… COMO RESOLVER:\n1. Edite cada unidade que usa "${setor}"\n2. Altere o setor delas\n3. Depois volte aqui para deletar do pool`);
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.setores) {
                    SistemaCore.dados.estabelecimento.setores = [];
                }
                
                const index = SistemaCore.dados.estabelecimento.setores.indexOf(setor);
                
                if (index === -1) {
                    alert(`âš ï¸ "${setor}" nÃ£o estÃ¡ no pool!`);
                    return;
                }
                
                if (confirm(`ğŸ—‘ï¸ DELETAR DO POOL?\n\n"${setor}"\n\nIsso removerÃ¡ permanentemente este setor do sistema.`)) {
                    SistemaCore.dados.estabelecimento.setores.splice(index, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… Setor removido do pool!');
                    
                    // Recarregar select e select de deletar
                    this.carregarPools();
                    this.carregarSelectDeletarSetores();
                }
            },
            
            // v10.5: Contar uso de nome
            contarUsoNome(nome) {
                let contador = 0;
                if (SistemaCore.dados.reparticoes) {
                    SistemaCore.dados.reparticoes.forEach(r => {
                        // Extrair base do nome (sem nÃºmero) para comparar
                        const nomeBase = r.nome ? r.nome.replace(/\s+\d+$/, '').trim() : '';
                        if (nomeBase.toLowerCase() === nome.toLowerCase()) contador++;
                    });
                }
                return contador;
            },
            
            // v10.5: Carregar datalist de nomes
            // v10.60.8: Modificado para popular select ao invÃ©s de datalist
            carregarNomesDatalist() {
                const select = document.getElementById('rep-nome');
                if (!select) return;
                
                const nomes = SistemaCore.dados.pools.nomes_sugeridos || [];
                
                // Preservar valor selecionado atual
                const valorAtual = select.value;
                
                select.innerHTML = '<option value="">Selecione...</option>';
                
                const nomesOrdenados = [...nomes].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                
                nomesOrdenados.forEach(nome => {
                    const option = document.createElement('option');
                    option.value = nome;
                    option.textContent = nome;
                    select.appendChild(option);
                });
                
                // Restaurar valor se ainda existir no pool
                if (valorAtual && nomes.includes(valorAtual)) {
                    select.value = valorAtual;
                }
            },
            
            // v10.5: Carregar selects de deletar
            carregarSelectDeletarNomes() {
                const select = document.getElementById('rep-nome-deletar-select');
                if (!select) return; // SeguranÃ§a: se o select nÃ£o existe, sair
                
                const nomes = SistemaCore.dados.pools.nomes_sugeridos || [];
                
                select.innerHTML = '<option value="">Selecione para deletar...</option>';
                
                const nomesOrdenados = [...nomes].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                
                nomesOrdenados.forEach(nome => {
                    const uso = this.contarUsoNome(nome);
                    const option = document.createElement('option');
                    option.value = nome;
                    option.textContent = uso > 0 ? `${nome} (${uso})` : nome;
                    select.appendChild(option);
                });
            },
            
            carregarSelectDeletarPavilhoes() {
                const select = document.getElementById('rep-pavilhao-deletar-select');
                if (!select) return; // SeguranÃ§a: se o select nÃ£o existe, sair
                
                const pavilhoes = SistemaCore.dados.estabelecimento.pavilhoes || [];
                
                select.innerHTML = '<option value="">Selecione para deletar...</option>';
                
                const pavilhoesOrdenados = [...pavilhoes].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                
                pavilhoesOrdenados.forEach(pavilhao => {
                    const uso = Pools.contarUso('pavilhoes', pavilhao);
                    const option = document.createElement('option');
                    option.value = pavilhao;
                    option.textContent = uso > 0 ? `${pavilhao} (${uso})` : pavilhao;
                    select.appendChild(option);
                });
            },
            
            carregarSelectDeletarAndares() {
                const select = document.getElementById('rep-andar-deletar-select');
                if (!select) return; // SeguranÃ§a: se o select nÃ£o existe, sair
                
                const andares = SistemaCore.dados.estabelecimento.andares || [];
                
                select.innerHTML = '<option value="">Selecione para deletar...</option>';
                
                const andaresOrdenados = [...andares].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                
                andaresOrdenados.forEach(andar => {
                    const uso = Pools.contarUso('andares', andar);
                    const option = document.createElement('option');
                    option.value = andar;
                    option.textContent = uso > 0 ? `${andar} (${uso})` : andar;
                    select.appendChild(option);
                });
            },
            
            carregarSelectDeletarSetores() {
                const select = document.getElementById('rep-setor-deletar-select');
                if (!select) return; // SeguranÃ§a: se o select nÃ£o existe, sair
                
                const setores = SistemaCore.dados.estabelecimento.setores || [];
                
                select.innerHTML = '<option value="">Selecione para deletar...</option>';
                
                const setoresOrdenados = [...setores].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                
                setoresOrdenados.forEach(setor => {
                    const uso = Pools.contarUso('setores', setor);
                    const option = document.createElement('option');
                    option.value = setor;
                    option.textContent = uso > 0 ? `${setor} (${uso})` : setor;
                    select.appendChild(option);
                });
            }
        }


        const Profissionais = {
            // v10.89: listar() simplificada - apenas chama renderizarLista()
            listar() {
                const profs = SistemaCore.dados.profissionais;
                this.renderizarLista(profs);
            },

            // v10.89: NOVA - Filtrar listagem em tempo real
            filtrarListagem() {
                const busca = document.getElementById('busca-profissionais').value.trim();
                
                if (busca.length === 0) {
                    this.listar();
                    return;
                }
                
                const buscaNormalizada = this.normalizarTexto(busca);
                const palavrasBusca = buscaNormalizada.split(/\s+/).filter(p => p.length > 0);
                
                const profsFiltrados = SistemaCore.dados.profissionais.filter(prof => {
                    // BUSCA POR NOME
                    const nomeNormalizado = this.normalizarTexto(prof.nome || '');
                    const nomeMatch = palavrasBusca.every(palavra => nomeNormalizado.includes(palavra));
                    
                    // BUSCA POR REGISTRO (CRM/COREN/CRO)
                    const registroNormalizado = this.normalizarTexto(prof.registro || '');
                    const registroMatch = registroNormalizado.includes(buscaNormalizada);
                    
                    // BUSCA POR CATEGORIA
                    const categoriaNormalizada = this.normalizarTexto(prof.categoria || '');
                    const categoriaMatch = categoriaNormalizada.includes(buscaNormalizada);
                    
                    // BUSCA POR ESPECIALIDADE PRINCIPAL
                    const especialidadePrincipalNormalizada = this.normalizarTexto(prof.especialidade_principal || prof.especialidade || '');
                    const especialidadePrincipalMatch = especialidadePrincipalNormalizada.includes(buscaNormalizada);
                    
                    // BUSCA EM TODAS AS ESPECIALIDADES
                    const especialidades = prof.especialidades || (prof.especialidade ? [prof.especialidade] : []);
                    const especialidadesMatch = especialidades.some(esp => 
                        this.normalizarTexto(esp).includes(buscaNormalizada)
                    );
                    
                    return nomeMatch || registroMatch || categoriaMatch || 
                           especialidadePrincipalMatch || especialidadesMatch;
                });
                
                this.renderizarLista(profsFiltrados);
            },
            
            // v10.89: NOVA - Normalizar texto (remove acentos e minÃºsculas)
            normalizarTexto(texto) {
                if (!texto) return '';
                return texto
                    .toLowerCase()
                    .normalize('NFD')
                    .replace(/[\u0300-\u036f]/g, '');
            },
            
            // v10.89: NOVA - Renderizar lista (separada de listar())
            renderizarLista(profissionais) {
                const container = document.getElementById('listaProfissionais');
                
                if (profissionais.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light); padding: 20px; text-align: center;">Nenhum profissional encontrado.</p>';
                    return;
                }

                // Ordenar por ID decrescente (mais recentes primeiro)
                const profsOrdenados = [...profissionais].sort((a, b) => b.id - a.id);

                let html = '<div class="item-list">';
                profsOrdenados.forEach(prof => {
                    const rep = SistemaCore.dados.reparticoes.find(r => r.id === prof.reparticao_id);
                    
                    // v10.55.5: Especialidades - mostrar TODAS como badges
                    const especialidades = prof.especialidades || (prof.especialidade ? [prof.especialidade] : []);
                    const especialidadePrincipal = prof.especialidade_principal || especialidades[0] || prof.especialidade || 'NÃ£o informada';
                    
                    // Badge principal (verde)
                    let especialidadesHtml = `<span class="badge badge-success">${especialidadePrincipal}</span>`;
                    
                    // Badges das outras especialidades (cinza)
                    if (especialidades.length > 1) {
                        const outrasEspecialidades = especialidades.filter(e => e !== especialidadePrincipal);
                        outrasEspecialidades.forEach(esp => {
                            especialidadesHtml += ` <span class="badge badge-secondary">${esp}</span>`;
                        });
                    }
                    
                    html += `
                        <div class="item-card">
                            <div>
                                <strong>${prof.nome}</strong>
                                ${especialidadesHtml}
                                <br>
                                <small style="color: var(--text-light);">
                                    ${prof.registro} | ${rep ? rep.nome : 'Sem repartiÃ§Ã£o'}
                                </small>
                            </div>
                            <div class="action-buttons">
                                <button class="btn btn-icon btn-primary" onclick="Profissionais.editar(${prof.id})">âœï¸</button>
                                <button class="btn btn-icon btn-danger" onclick="Profissionais.excluir(${prof.id})">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;
            },

            trocarAba(event, abaId) {
                // Remove active de todas as abas e conteÃºdos
                document.querySelectorAll('#modalProfissional .form-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('#modalProfissional .form-tab-content').forEach(c => c.classList.remove('active'));
                
                // Ativa a aba clicada
                event.target.classList.add('active');
                document.getElementById('prof-aba-' + abaId).classList.add('active');
            },

            // FunÃ§Ãµes de especialidades (v6.8.1)
            adicionarEspecialidade() {
                // Pegar especialidade selecionada no dropdown
                const select = document.getElementById('prof-especialidade-select');
                
                // VerificaÃ§Ã£o de seguranÃ§a
                if (!select) {
                    console.error('Elemento de especialidade nÃ£o encontrado');
                    Sistema.notificar('Erro ao adicionar especialidade!', 'error');
                    return;
                }
                
                const especialidade = select.value.trim();
                
                if (!especialidade) {
                    Sistema.notificar('Selecione uma especialidade do pool!', 'error');
                    return;
                }

                // Pegar especialidades atuais
                const hidden = document.getElementById('prof-especialidades-hidden');
                const especialidades = hidden.value ? hidden.value.split(',') : [];
                
                // Verificar se jÃ¡ existe
                if (especialidades.includes(especialidade)) {
                    Sistema.notificar('Esta especialidade jÃ¡ foi adicionada!', 'error');
                    return;
                }

                // Adicionar aos chips
                especialidades.push(especialidade);
                hidden.value = especialidades.join(',');
                
                // Limpar seleÃ§Ã£o
                select.value = '';
                
                // Renderizar chips
                this.renderizarEspecialidades();
            },

            removerEspecialidade(especialidade) {
                const hidden = document.getElementById('prof-especialidades-hidden');
                let especialidades = hidden.value.split(',');
                
                if (especialidades.length === 1) {
                    Sistema.notificar('O profissional deve ter pelo menos uma especialidade!', 'error');
                    return;
                }
                
                especialidades = especialidades.filter(e => e !== especialidade);
                hidden.value = especialidades.join(',');
                
                this.renderizarEspecialidades();
            },

            renderizarEspecialidades() {
                const hidden = document.getElementById('prof-especialidades-hidden');
                const container = document.getElementById('prof-especialidades-lista');
                
                if (!hidden.value) {
                    container.innerHTML = '<p style="color: var(--text-light); margin: 0;">Nenhuma especialidade adicionada</p>';
                    return;
                }

                const especialidades = hidden.value.split(',');
                let html = '';
                
                especialidades.forEach((esp, index) => {
                    const isPrincipal = index === 0;
                    html += `
                        <div class="especialidade-chip ${isPrincipal ? 'principal' : ''}">
                            ${isPrincipal ? 'â­ ' : ''}${esp}
                            <button type="button" onclick="Profissionais.removerEspecialidade('${esp}')" title="Remover">Ã—</button>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },

            // Gerenciar RepartiÃ§Ãµes MÃºltiplas
            adicionarReparticao() {
                const select = document.getElementById('prof-reparticao-select');
                const reparticaoId = parseInt(select.value);
                
                if (!reparticaoId) {
                    Sistema.notificar('Selecione uma repartiÃ§Ã£o!', 'error');
                    return;
                }

                // Pegar repartiÃ§Ãµes atuais
                const hidden = document.getElementById('prof-reparticoes-hidden');
                const reparticoes = hidden.value ? hidden.value.split(',').map(id => parseInt(id)) : [];
                
                // Verificar se jÃ¡ existe
                if (reparticoes.includes(reparticaoId)) {
                    Sistema.notificar('Esta repartiÃ§Ã£o jÃ¡ foi adicionada!', 'error');
                    return;
                }

                // Adicionar
                reparticoes.push(reparticaoId);
                hidden.value = reparticoes.join(',');
                
                // Resetar select
                select.value = '';
                
                // Renderizar
                this.renderizarReparticoes();
            },

            removerReparticao(reparticaoId) {
                const hidden = document.getElementById('prof-reparticoes-hidden');
                let reparticoes = hidden.value.split(',').map(id => parseInt(id));
                
                reparticoes = reparticoes.filter(id => id !== reparticaoId);
                hidden.value = reparticoes.join(',');
                
                this.renderizarReparticoes();
            },

            renderizarReparticoes() {
                const hidden = document.getElementById('prof-reparticoes-hidden');
                const container = document.getElementById('prof-reparticoes-lista');
                
                if (!hidden.value) {
                    container.innerHTML = '<p style="color: var(--text-light); margin: 0;">Nenhuma repartiÃ§Ã£o adicionada</p>';
                    return;
                }

                const reparticoesIds = hidden.value.split(',').map(id => parseInt(id));
                const todasReps = SistemaCore.dados.reparticoes;
                let html = '';
                
                reparticoesIds.forEach(repId => {
                    const rep = todasReps.find(r => r.id === repId);
                    if (rep) {
                        html += `
                            <div class="especialidade-chip">
                                ${rep.nome}
                                <button type="button" onclick="Profissionais.removerReparticao(${repId})" title="Remover">Ã—</button>
                            </div>
                        `;
                    }
                });
                
                container.innerHTML = html;
            },

            // v10: Carregar categorias profissionais do pool
            carregarCategorias() {
                const select = document.getElementById('prof-categoria');
                
                // VerificaÃ§Ã£o de seguranÃ§a
                if (!select) {
                    console.warn('Elemento prof-categoria nÃ£o encontrado');
                    return;
                }
                
                const categorias = SistemaCore.dados.estabelecimento.categoriasProfissionais || [];
                
                // v10.2: ORDENAR ALFABETICAMENTE
                const categoriasOrdenadas = [...categorias].sort((a, b) => {
                    const valorA = a.split('|')[0];
                    const valorB = b.split('|')[0];
                    return valorA.localeCompare(valorB, 'pt-BR');
                });
                
                // Manter apenas a opÃ§Ã£o padrÃ£o
                select.innerHTML = '<option value="">Selecione...</option>';
                
                // Adicionar categorias do pool (jÃ¡ ordenadas)
                categoriasOrdenadas.forEach(cat => {
                    // Formato: "valor|emoji" ou apenas "valor"
                    const partes = cat.split('|');
                    const valor = partes[0];
                    const emoji = partes[1] || ''; // Se nÃ£o tiver emoji, usa string vazia
                    
                    const option = document.createElement('option');
                    option.value = valor;
                    
                    // Monta o texto: se tiver emoji, mostra "emoji nome", senÃ£o sÃ³ "nome"
                    const nomeFormatado = this.formatarNomeCategoria(valor);
                    option.textContent = emoji ? `${emoji} ${nomeFormatado}` : nomeFormatado;
                    
                    select.appendChild(option);
                });
            },
            
            // v10: Formatar nome da categoria para exibiÃ§Ã£o
            formatarNomeCategoria(valor) {
                if (!valor) return '';
                
                const nomes = {
                    'medico': 'MÃ©dico(a)',
                    'enfermeiro': 'Enfermeiro(a)',
                    'assistente_social': 'Assistente Social',
                    'fisioterapeuta': 'Fisioterapeuta',
                    'psicologo': 'PsicÃ³logo(a)',
                    'nutricionista': 'Nutricionista',
                    'farmaceutico': 'FarmacÃªutico(a)',
                    'administrativo': 'Administrativo',
                    'recepcionista': 'Recepcionista'
                };
                
                // Se encontrar no dicionÃ¡rio, usa. SenÃ£o, formata automaticamente
                return nomes[valor] || valor.charAt(0).toUpperCase() + valor.slice(1).replace(/_/g, ' ');
            },
            
            // v10: Carregar cargos do pool
            carregarCargos() {
                const select = document.getElementById('prof-cargo-select');
                
                // VerificaÃ§Ã£o de seguranÃ§a
                if (!select) {
                    console.warn('Elemento prof-cargo-select nÃ£o encontrado');
                    return;
                }
                
                const cargos = SistemaCore.dados.estabelecimento.cargos || [];
                
                // v10.2: ORDENAR ALFABETICAMENTE
                const cargosOrdenados = [...cargos].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                
                // Limpar select (manter apenas o "Selecione...")
                select.innerHTML = '<option value="">Selecione um cargo...</option>';
                
                // Adicionar cargos do pool (jÃ¡ ordenados)
                cargosOrdenados.forEach(cargo => {
                    const option = document.createElement('option');
                    option.value = cargo;
                    option.textContent = cargo;
                    select.appendChild(option);
                });
            },
            
            // v10.60: Carregar especialidades no dropdown (UNIDIRECIONAL - sÃ³ leitura)
            carregarEspecialidadesDropdown() {
                const select = document.getElementById('prof-especialidade-select');
                
                // VerificaÃ§Ã£o de seguranÃ§a: se elemento nÃ£o existe, sair silenciosamente
                if (!select) {
                    console.warn('Elemento prof-especialidade-select nÃ£o encontrado');
                    return;
                }
                
                const especialidades = SistemaCore.dados.estabelecimento.especialidades || [];
                
                // Ordenar alfabeticamente
                const especialidadesOrdenadas = [...especialidades].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                
                // Limpar e reconstruir select
                select.innerHTML = '<option value="">Selecione uma especialidade...</option>';
                
                // Adicionar especialidades do pool
                especialidadesOrdenadas.forEach(especialidade => {
                    const option = document.createElement('option');
                    option.value = especialidade;
                    option.textContent = especialidade;
                    select.appendChild(option);
                });
            },
            
            // v10.55: Gerenciar Cargos MÃºltiplos
            adicionarCargo() {
                // Pegar cargo selecionado no dropdown
                const select = document.getElementById('prof-cargo-select');
                
                // VerificaÃ§Ã£o de seguranÃ§a
                if (!select) {
                    console.error('Elemento de cargo nÃ£o encontrado');
                    Sistema.notificar('Erro ao adicionar cargo!', 'error');
                    return;
                }
                
                const cargo = select.value.trim();
                
                if (!cargo) {
                    Sistema.notificar('Selecione um cargo do pool!', 'error');
                    return;
                }

                // Pegar cargos atuais
                const hidden = document.getElementById('prof-cargos-hidden');
                const cargos = hidden.value ? hidden.value.split(',') : [];
                
                // Verificar se jÃ¡ existe
                if (cargos.includes(cargo)) {
                    Sistema.notificar('Este cargo jÃ¡ foi adicionado!', 'error');
                    return;
                }

                // Adicionar aos chips
                cargos.push(cargo);
                hidden.value = cargos.join(',');
                
                // Limpar seleÃ§Ã£o
                select.value = '';
                
                // Renderizar chips
                this.renderizarCargosLista();
            },

            removerCargo(cargo) {
                const hidden = document.getElementById('prof-cargos-hidden');
                let cargos = hidden.value.split(',');
                
                if (cargos.length === 1) {
                    Sistema.notificar('O profissional deve ter pelo menos um cargo!', 'error');
                    return;
                }
                
                cargos = cargos.filter(c => c !== cargo);
                hidden.value = cargos.join(',');
                
                this.renderizarCargosLista();
            },

            renderizarCargosLista() {
                const hidden = document.getElementById('prof-cargos-hidden');
                const container = document.getElementById('prof-cargos-lista');
                
                if (!hidden.value) {
                    container.innerHTML = '<p style="color: var(--text-light); margin: 0;">Nenhum cargo adicionado</p>';
                    return;
                }

                const cargos = hidden.value.split(',');
                let html = '';
                
                cargos.forEach((cargo, index) => {
                    const isPrincipal = index === 0;
                    html += `
                        <div class="especialidade-chip ${isPrincipal ? 'principal' : ''}">
                            ${isPrincipal ? 'â­ ' : ''}${cargo}
                            <button type="button" onclick="Profissionais.removerCargo('${cargo.replace(/'/g, "\\'")}')" title="Remover">Ã—</button>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },

            abrirModal(id = null) {
                // v10: Carregar categorias e cargos do pool (UNIDIRECIONAL - sÃ³ leitura)
                this.carregarCategorias();
                this.carregarCargos();
                // v10.60: Carregar especialidades no dropdown (UNIDIRECIONAL - sÃ³ leitura)
                this.carregarEspecialidadesDropdown();
                
                // Voltar para primeira aba
                document.querySelectorAll('#modalProfissional .form-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('#modalProfissional .form-tab-content').forEach(c => c.classList.remove('active'));
                document.querySelector('#modalProfissional .form-tab').classList.add('active');
                document.getElementById('prof-aba-dados-pessoais').classList.add('active');

                // Popular select de repartiÃ§Ãµes (v10.60.4: com verificaÃ§Ãµes de seguranÃ§a)
                const selectRep = document.getElementById('prof-reparticao-select');
                if (selectRep) {
                    let optionsHTML = '<option value="">Selecione uma repartiÃ§Ã£o...</option>';
                    
                    if (SistemaCore.dados && SistemaCore.dados.reparticoes) {
                        SistemaCore.dados.reparticoes
                            .filter(rep => !rep.eh_subreparticao) // v7.10.1: NÃ£o mostrar leitos individuais
                            .forEach(rep => {
                                optionsHTML += `<option value="${rep.id}">${rep.nome}</option>`;
                            });
                    }
                    
                    selectRep.innerHTML = optionsHTML;
                } else {
                    console.warn('Elemento prof-reparticao-select nÃ£o encontrado');
                }

                if (id) {
                    const prof = SistemaCore.dados.profissionais.find(p => p.id === id);
                    if (!prof) return;
                    document.getElementById('tituloModalProfissional').textContent = 'âœï¸ Editar Profissional';
                    document.getElementById('edit-profissional-id').value = prof.id;
                    
                    // Dados Pessoais
                    document.getElementById('prof-nome').value = prof.nome || '';
                    document.getElementById('prof-cpf').value = prof.cpf || '';
                    document.getElementById('prof-rg').value = prof.rg || '';
                    document.getElementById('prof-nascimento').value = prof.nascimento || '';
                    document.getElementById('prof-sexo').value = prof.sexo || '';
                    document.getElementById('prof-estado-civil').value = prof.estado_civil || '';
                    document.getElementById('prof-naturalidade').value = prof.naturalidade || '';
                    document.getElementById('prof-cor-raca').value = prof.cor_raca || ''; // âœ… v10.6
                    document.getElementById('prof-tipo-sanguineo').value = prof.tipo_sanguineo || '';
                    document.getElementById('prof-fator-rh').value = prof.fator_rh || '';
                    document.getElementById('prof-alergias').value = prof.alergias || '';
                    
                    // Contato
                    document.getElementById('prof-telefone').value = prof.telefone || '';
                    document.getElementById('prof-celular').value = prof.celular || '';
                    document.getElementById('prof-email').value = prof.email || '';
                    
                    // EndereÃ§o
                    document.getElementById('prof-cep').value = prof.cep || '';
                    document.getElementById('prof-logradouro').value = prof.logradouro || '';
                    document.getElementById('prof-numero').value = prof.numero || '';
                    document.getElementById('prof-complemento').value = prof.complemento || '';
                    document.getElementById('prof-bairro').value = prof.bairro || '';
                    document.getElementById('prof-cidade').value = prof.cidade || '';
                    document.getElementById('prof-uf').value = prof.uf || '';
                    
                    // Dados Profissionais
                    document.getElementById('prof-registro').value = prof.registro || '';
                    document.getElementById('prof-categoria').value = prof.categoria_profissional || '';
                    
                    // Cargos mÃºltiplos (v10.55) - migraÃ§Ã£o automÃ¡tica de cargo Ãºnico para array
                    const cargos = prof.cargos || (prof.cargo ? [prof.cargo] : []);
                    document.getElementById('prof-cargos-hidden').value = cargos.join(',');
                    this.renderizarCargosLista();
                    
                    // RepartiÃ§Ãµes mÃºltiplas (v7.9.5)
                    const reparticoes = prof.reparticoes_ids || (prof.reparticao_id ? [prof.reparticao_id] : []);
                    document.getElementById('prof-reparticoes-hidden').value = reparticoes.join(',');
                    this.renderizarReparticoes();
                    
                    // Especialidades (v6.8.1)
                    const especialidades = prof.especialidades || (prof.especialidade ? [prof.especialidade] : []);
                    document.getElementById('prof-especialidades-hidden').value = especialidades.join(',');
                    this.renderizarEspecialidades();
                } else {
                    document.getElementById('tituloModalProfissional').textContent = 'â• Novo Profissional';
                    document.getElementById('edit-profissional-id').value = '';
                    
                    // Limpar todos os campos
                    document.getElementById('prof-nome').value = '';
                    document.getElementById('prof-cpf').value = '';
                    document.getElementById('prof-rg').value = '';
                    document.getElementById('prof-nascimento').value = '';
                    document.getElementById('prof-sexo').value = '';
                    document.getElementById('prof-estado-civil').value = '';
                    document.getElementById('prof-naturalidade').value = '';
                    document.getElementById('prof-cor-raca').value = ''; // âœ… v10.6
                    document.getElementById('prof-tipo-sanguineo').value = '';
                    document.getElementById('prof-fator-rh').value = '';
                    document.getElementById('prof-alergias').value = '';
                    document.getElementById('prof-telefone').value = '';
                    document.getElementById('prof-celular').value = '';
                    document.getElementById('prof-email').value = '';
                    document.getElementById('prof-cep').value = '';
                    document.getElementById('prof-logradouro').value = '';
                    document.getElementById('prof-numero').value = '';
                    document.getElementById('prof-complemento').value = '';
                    document.getElementById('prof-bairro').value = '';
                    document.getElementById('prof-cidade').value = '';
                    document.getElementById('prof-uf').value = '';
                    document.getElementById('prof-registro').value = '';
                    document.getElementById('prof-categoria').value = '';
                    
                    // Limpar cargos (v10.55)
                    document.getElementById('prof-cargos-hidden').value = '';
                    this.renderizarCargosLista();
                    
                    // Limpar repartiÃ§Ãµes (v7.9.5)
                    document.getElementById('prof-reparticoes-hidden').value = '';
                    this.renderizarReparticoes();
                    
                    // Limpar especialidades (v10.60.4: removido prof-especialidade-input que nÃ£o existe mais)
                    document.getElementById('prof-especialidades-hidden').value = '';
                    this.renderizarEspecialidades();
                }
                document.getElementById('modalProfissional').classList.add('active');
            },

            fecharModal() {
                document.getElementById('modalProfissional').classList.remove('active');
            },

            buscarCEP() {
                const cep = document.getElementById('prof-cep').value.replace(/\D/g, '');
                
                if (cep.length !== 8) {
                    return;
                }
                
                Sistema.notificar('Buscando CEP...', 'info');
                
                fetch(`https://viacep.com.br/ws/${cep}/json/`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.erro) {
                            Sistema.notificar('CEP nÃ£o encontrado!', 'error');
                            return;
                        }
                        
                        document.getElementById('prof-logradouro').value = data.logradouro || '';
                        document.getElementById('prof-bairro').value = data.bairro || '';
                        document.getElementById('prof-cidade').value = data.localidade || '';
                        document.getElementById('prof-uf').value = data.uf || '';
                        
                        Sistema.notificar('âœ… CEP encontrado!', 'success');
                        document.getElementById('prof-numero').focus();
                    })
                    .catch(error => {
                        console.error('Erro ao buscar CEP:', error);
                        Sistema.notificar('Erro ao buscar CEP. Verifique sua conexÃ£o.', 'error');
                    });
            },

            salvar() {
                const nome = document.getElementById('prof-nome').value.trim();
                const registro = document.getElementById('prof-registro').value.trim();
                const categoria_profissional = document.getElementById('prof-categoria').value;
                
                // Cargos mÃºltiplos (v10.55)
                const cargosStr = document.getElementById('prof-cargos-hidden').value;
                if (!cargosStr) {
                    Sistema.notificar('Adicione pelo menos um cargo!', 'error');
                    return;
                }
                const cargos = cargosStr.split(',');
                const cargo_principal = cargos[0];
                
                // RepartiÃ§Ãµes mÃºltiplas (v7.9.5)
                const reparticoesStr = document.getElementById('prof-reparticoes-hidden').value;
                const reparticoes_ids = reparticoesStr ? reparticoesStr.split(',').map(id => parseInt(id)) : [];
                const reparticao_id = reparticoes_ids[0] || null; // Compatibilidade com cÃ³digo antigo
                
                const editId = document.getElementById('edit-profissional-id').value;
                
                // Especialidades (v6.8.1)
                const especialidadesStr = document.getElementById('prof-especialidades-hidden').value;
                if (!especialidadesStr) {
                    Sistema.notificar('Adicione pelo menos uma especialidade!', 'error');
                    return;
                }
                const especialidades = especialidadesStr.split(',');
                const especialidade_principal = especialidades[0];

                if (!nome || !registro) {
                    Sistema.notificar('Preencha todos os campos obrigatÃ³rios!', 'error');
                    return;
                }

                if (!categoria_profissional) {
                    Sistema.notificar('Selecione a categoria profissional!', 'error');
                    return;
                }
                
                // ğŸ”´ VALIDAÃ‡ÃƒO CRÃTICA: CRM/COREN Ãºnico
                const registroExiste = SistemaCore.dados.profissionais.find(p => {
                    // Se estÃ¡ editando, ignorar o prÃ³prio profissional
                    if (editId && p.id === parseInt(editId)) return false;
                    return p.registro === registro;
                });
                if (registroExiste) {
                    Sistema.notificar(`âŒ CRM/COREN jÃ¡ cadastrado para: ${registroExiste.nome}`, 'error');
                    return;
                }

                const dados = {
                    nome,
                    registro,
                    cargo: cargo_principal, // MantÃ©m compatibilidade com campo Ãºnico
                    cargo_principal, // v10.55
                    cargos, // v10.55 - Array de mÃºltiplos cargos
                    especialidade: especialidade_principal, // MantÃ©m compatibilidade
                    especialidade_principal, // v6.8.1
                    especialidades, // v6.8.1
                    categoria_profissional,
                    reparticao_id, // MantÃ©m compatibilidade
                    reparticoes_ids, // v7.9.5 - MÃºltiplas repartiÃ§Ãµes
                    // Dados Pessoais
                    cpf: document.getElementById('prof-cpf').value.trim(),
                    rg: document.getElementById('prof-rg').value.trim(),
                    nascimento: document.getElementById('prof-nascimento').value,
                    sexo: document.getElementById('prof-sexo').value,
                    estado_civil: document.getElementById('prof-estado-civil').value,
                    naturalidade: document.getElementById('prof-naturalidade').value.trim(),
                    cor_raca: document.getElementById('prof-cor-raca').value, // âœ… v10.6
                    tipo_sanguineo: document.getElementById('prof-tipo-sanguineo').value,
                    fator_rh: document.getElementById('prof-fator-rh').value,
                    alergias: document.getElementById('prof-alergias').value.trim(),
                    // Contato
                    telefone: document.getElementById('prof-telefone').value.trim(),
                    celular: document.getElementById('prof-celular').value.trim(),
                    email: document.getElementById('prof-email').value.trim(),
                    // EndereÃ§o
                    cep: document.getElementById('prof-cep').value.trim(),
                    logradouro: document.getElementById('prof-logradouro').value.trim(),
                    numero: document.getElementById('prof-numero').value.trim(),
                    complemento: document.getElementById('prof-complemento').value.trim(),
                    bairro: document.getElementById('prof-bairro').value.trim(),
                    cidade: document.getElementById('prof-cidade').value.trim(),
                    uf: document.getElementById('prof-uf').value
                };

                if (editId) {
                    const prof = SistemaCore.dados.profissionais.find(p => p.id === parseInt(editId));
                    if (prof) {
                        Object.assign(prof, dados);
                    }
                } else {
                    dados.id = SistemaCore.proximoId(SistemaCore.dados.profissionais);
                    SistemaCore.dados.profissionais.push(dados);
                }

                // v10.55: ALIMENTAÃ‡ÃƒO BIDIRECIONAL - Adicionar cargos ao pool se nÃ£o existirem
                cargos.forEach(cargo => {
                    if (cargo) {
                        if (!SistemaCore.dados.estabelecimento.cargos) {
                            SistemaCore.dados.estabelecimento.cargos = [];
                        }
                        
                        // Verifica se o cargo jÃ¡ existe no pool
                        if (!SistemaCore.dados.estabelecimento.cargos.includes(cargo)) {
                            SistemaCore.dados.estabelecimento.cargos.push(cargo);
                            console.log(`âœ… Cargo "${cargo}" adicionado automaticamente ao pool`);
                        }
                    }
                });
                
                // v10.4: ALIMENTAÃ‡ÃƒO BIDIRECIONAL - Adicionar categoria ao pool se nÃ£o existir
                if (categoria_profissional) {
                    if (!SistemaCore.dados.estabelecimento.categoriasProfissionais) {
                        SistemaCore.dados.estabelecimento.categoriasProfissionais = [];
                    }
                    
                    // Verifica se a categoria jÃ¡ existe (valor ou valor|emoji)
                    const categoriaExiste = SistemaCore.dados.estabelecimento.categoriasProfissionais.some(cat => {
                        const valor = cat.split('|')[0];
                        return valor === categoria_profissional;
                    });
                    
                    if (!categoriaExiste) {
                        // Adiciona sem emoji (usuÃ¡rio pode adicionar depois no pool)
                        SistemaCore.dados.estabelecimento.categoriasProfissionais.push(categoria_profissional);
                        console.log(`âœ… Categoria "${categoria_profissional}" adicionada ao pool (adicione emoji no Pool se quiser)`);
                    }
                }

                SistemaCore.salvar();
                this.listar();
                this.fecharModal();
                Sistema.notificar('Profissional salvo!');
            },

            editar(id) {
                this.abrirModal(id);
            },

            excluir(id) {
                if (!confirm('Deseja excluir este profissional?')) return;
                SistemaCore.dados.profissionais = SistemaCore.dados.profissionais.filter(p => p.id !== id);
                SistemaCore.salvar();
                this.listar();
                Sistema.notificar('Profissional excluÃ­do!');
            },
            
            // v10.5: Adicionar categoria ao pool
            adicionarCategoriaAoPool() {
                const inputValor = document.getElementById('prof-categoria-nova-valor');
                const inputEmoji = document.getElementById('prof-categoria-nova-emoji');
                const valor = inputValor.value.trim();
                const emoji = inputEmoji.value.trim();
                
                if (!valor) {
                    alert('âŒ Digite o valor da categoria!');
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.categoriasProfissionais) {
                    SistemaCore.dados.estabelecimento.categoriasProfissionais = [];
                }
                
                // Verificar se jÃ¡ existe
                const jÃ¡Existe = SistemaCore.dados.estabelecimento.categoriasProfissionais
                    .some(cat => cat.split('|')[0].toLowerCase() === valor.toLowerCase());
                
                if (jÃ¡Existe) {
                    alert('âš ï¸ Esta categoria jÃ¡ existe no pool!');
                    return;
                }
                
                // Adicionar (com ou sem emoji)
                const categoria = emoji ? `${valor}|${emoji}` : valor;
                SistemaCore.dados.estabelecimento.categoriasProfissionais.push(categoria);
                SistemaCore.salvar();
                
                // Recarregar selects
                this.carregarCategorias();
                this.carregarSelectDeletar('categorias');
                
                // Limpar inputs
                inputValor.value = '';
                inputEmoji.value = '';
                
                Sistema.notificar(`âœ… Categoria "${valor}" adicionada ao pool!`);
            },
            
            // v10.5: Deletar categoria do pool
            deletarCategoriaDoPool() {
                const select = document.getElementById('prof-categoria-deletar-select');
                const valor = select.value;
                
                if (!valor) {
                    alert('âš ï¸ Selecione uma categoria para deletar!');
                    return;
                }
                
                // Verificar uso
                const uso = this.contarUsoCategoria(valor);
                
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL DELETAR!\n\n"${valor}" estÃ¡ sendo usada em ${uso} profissional(is).\n\nâœ… COMO RESOLVER:\n1. Edite cada profissional que usa "${valor}"\n2. Altere a categoria deles\n3. Depois volte aqui para deletar do pool`);
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.categoriasProfissionais) {
                    SistemaCore.dados.estabelecimento.categoriasProfissionais = [];
                }
                
                // Encontrar Ã­ndice (considerando formato "valor|emoji" ou apenas "valor")
                const index = SistemaCore.dados.estabelecimento.categoriasProfissionais
                    .findIndex(cat => cat.split('|')[0] === valor);
                
                if (index === -1) {
                    alert(`âš ï¸ "${valor}" nÃ£o estÃ¡ no pool!`);
                    return;
                }
                
                const categoriaCompleta = SistemaCore.dados.estabelecimento.categoriasProfissionais[index];
                
                if (confirm(`ğŸ—‘ï¸ DELETAR DO POOL?\n\n"${categoriaCompleta}"\n\nIsso removerÃ¡ permanentemente esta categoria do sistema.`)) {
                    SistemaCore.dados.estabelecimento.categoriasProfissionais.splice(index, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… Categoria removida do pool!');
                    
                    // Recarregar selects
                    this.carregarCategorias();
                    this.carregarSelectDeletar('categorias');
                }
            },
            
            // v10.5: Contar uso de categoria
            contarUsoCategoria(valor) {
                let contador = 0;
                if (SistemaCore.dados.profissionais) {
                    SistemaCore.dados.profissionais.forEach(p => {
                        if (p.categoria_profissional === valor) contador++;
                    });
                }
                return contador;
            },
            
            // v10.5: Adicionar cargo ao pool
            // v10.5: Deletar cargo do pool
            deletarCargoDoPool() {
                const select = document.getElementById('prof-cargo-deletar-select');
                const cargo = select.value;
                
                if (!cargo) {
                    alert('âš ï¸ Selecione um cargo para deletar!');
                    return;
                }
                
                // Verificar uso
                const uso = this.contarUsoCargo(cargo);
                
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL DELETAR!\n\n"${cargo}" estÃ¡ sendo usado em ${uso} profissional(is).\n\nâœ… COMO RESOLVER:\n1. Edite cada profissional que usa "${cargo}"\n2. Altere o cargo deles\n3. Depois volte aqui para deletar do pool`);
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.cargos) {
                    SistemaCore.dados.estabelecimento.cargos = [];
                }
                
                const index = SistemaCore.dados.estabelecimento.cargos.indexOf(cargo);
                
                if (index === -1) {
                    alert(`âš ï¸ "${cargo}" nÃ£o estÃ¡ no pool!`);
                    return;
                }
                
                if (confirm(`ğŸ—‘ï¸ DELETAR DO POOL?\n\n"${cargo}"\n\nIsso removerÃ¡ permanentemente este cargo do sistema.`)) {
                    SistemaCore.dados.estabelecimento.cargos.splice(index, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… Cargo removido do pool!');
                    
                    // Recarregar datalist e select
                    this.carregarCargos();
                    this.carregarSelectDeletar('cargos');
                }
            },
            
            // v10.5: Contar uso de cargo
            contarUsoCargo(cargo) {
                let contador = 0;
                if (SistemaCore.dados.profissionais) {
                    SistemaCore.dados.profissionais.forEach(p => {
                        if (p.cargo === cargo) contador++;
                    });
                }
                return contador;
            },
            
            // v10.5: Carregar select de deletar (categorias ou cargos)
            carregarSelectDeletar(tipo) {
                if (tipo === 'categorias') {
                    const select = document.getElementById('prof-categoria-deletar-select');
                    const categorias = SistemaCore.dados.estabelecimento.categoriasProfissionais || [];
                    
                    select.innerHTML = '<option value="">Selecione para deletar...</option>';
                    
                    const categoriasOrdenadas = [...categorias].sort((a, b) => {
                        const valorA = a.split('|')[0];
                        const valorB = b.split('|')[0];
                        return valorA.localeCompare(valorB, 'pt-BR');
                    });
                    
                    categoriasOrdenadas.forEach(cat => {
                        const valor = cat.split('|')[0];
                        const uso = this.contarUsoCategoria(valor);
                        const option = document.createElement('option');
                        option.value = valor;
                        option.textContent = uso > 0 ? `${cat} (${uso})` : cat;
                        select.appendChild(option);
                    });
                }
                else if (tipo === 'cargos') {
                    const select = document.getElementById('prof-cargo-deletar-select');
                    const cargos = SistemaCore.dados.estabelecimento.cargos || [];
                    
                    select.innerHTML = '<option value="">Selecione para deletar...</option>';
                    
                    const cargosOrdenados = [...cargos].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                    
                    cargosOrdenados.forEach(cargo => {
                        const uso = this.contarUsoCargo(cargo);
                        const option = document.createElement('option');
                        option.value = cargo;
                        option.textContent = uso > 0 ? `${cargo} (${uso})` : cargo;
                        select.appendChild(option);
                    });
                }
            }
        };

        /* ============================================================
           [ESCALAS] MÃ³dulo de GestÃ£o de Escalas
           ============================================================ */
        
        const Escalas = {
            listar() {
                const container = document.getElementById('listaEscalas');
                const escalas = SistemaCore.dados.escalas;

                if (escalas.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light);">Nenhuma escala cadastrada.</p>';
                    return;
                }

                // Aplicar filtros
                const filtros = this.obterFiltros();
                const escalas_filtradas = escalas.filter(e => {
                    if (!e.ativo) return false;
                    if (filtros.profissional && e.profissional_id !== parseInt(filtros.profissional)) return false;
                    if (filtros.especialidade && e.especialidade !== filtros.especialidade) return false;
                    if (filtros.reparticao && e.reparticao_id !== parseInt(filtros.reparticao)) return false;
                    if (filtros.tipo && e.tipo !== filtros.tipo) return false;
                    return true;
                });

                if (escalas_filtradas.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light);">Nenhuma escala encontrada com os filtros selecionados.</p>';
                    return;
                }

                // Ordenar por profissional e horÃ¡rio
                const escalas_ordenadas = [...escalas_filtradas].sort((a, b) => {
                    if (a.profissional_nome !== b.profissional_nome) {
                        return a.profissional_nome.localeCompare(b.profissional_nome);
                    }
                    return a.horario_inicio.localeCompare(b.horario_inicio);
                });

                let html = '<div class="item-list">';
                escalas_ordenadas.forEach(escala => {
                    const tipoIcon = {
                        'fixa': 'ğŸ“…',
                        'plantao': 'ğŸš¨',
                        'eventual': 'ğŸ“Œ'
                    }[escala.tipo] || 'ğŸ“‹';

                    const tipoLabel = {
                        'fixa': 'Fixa',
                        'plantao': 'PlantÃ£o',
                        'eventual': 'Eventual'
                    }[escala.tipo] || escala.tipo;

                    const diasMap = {
                        'seg': 'Seg', 'ter': 'Ter', 'qua': 'Qua', 
                        'qui': 'Qui', 'sex': 'Sex', 'sab': 'SÃ¡b', 'dom': 'Dom'
                    };
                    
                    const diasTexto = escala.dias_semana.map(d => diasMap[d] || d).join(', ');

                    const dataFim = escala.data_fim ? 
                        ` atÃ© ${new Date(escala.data_fim + 'T00:00').toLocaleDateString('pt-BR')}` : 
                        ' (indeterminado)';

                    html += `
                        <div class="item-card">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                    <strong>${tipoIcon} ${escala.profissional_nome}</strong>
                                    <span class="badge badge-primary">${escala.especialidade}</span>
                                    <span class="badge badge-info">${tipoLabel}</span>
                                </div>
                                <div style="color: var(--text-light); font-size: 0.9em; line-height: 1.6;">
                                    ğŸ“ ${escala.reparticao_nome}<br>
                                    ğŸ“… ${diasTexto}<br>
                                    ğŸ• ${escala.horario_inicio} Ã s ${escala.horario_fim}<br>
                                    ğŸ“† Desde ${new Date(escala.data_inicio + 'T00:00').toLocaleDateString('pt-BR')}${dataFim}
                                    ${escala.observacoes ? `<br>ğŸ’¬ ${escala.observacoes}` : ''}
                                </div>
                            </div>
                            <div class="action-buttons">
                                <button class="btn btn-icon btn-primary" onclick="Escalas.editar(${escala.id})" title="Editar">âœï¸</button>
                                <button class="btn btn-icon btn-danger" onclick="Escalas.desativar(${escala.id})" title="Desativar">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;
            },

            obterFiltros() {
                return {
                    profissional: document.getElementById('filtro-escala-profissional').value,
                    especialidade: document.getElementById('filtro-escala-especialidade').value,
                    reparticao: document.getElementById('filtro-escala-reparticao').value,
                    tipo: document.getElementById('filtro-escala-tipo').value
                };
            },

            aplicarFiltros() {
                this.listar();
            },

            carregarFiltros() {
                // Profissionais
                const selectProf = document.getElementById('filtro-escala-profissional');
                selectProf.innerHTML = '<option value="">Todos os profissionais</option>';
                SistemaCore.dados.profissionais.forEach(prof => {
                    selectProf.innerHTML += `<option value="${prof.id}">${prof.nome}</option>`;
                });

                // Especialidades Ãºnicas
                const especialidades = new Set();
                SistemaCore.dados.escalas.forEach(e => {
                    if (e.ativo) especialidades.add(e.especialidade);
                });
                const selectEsp = document.getElementById('filtro-escala-especialidade');
                selectEsp.innerHTML = '<option value="">Todas as especialidades</option>';
                [...especialidades].sort().forEach(esp => {
                    selectEsp.innerHTML += `<option value="${esp}">${esp}</option>`;
                });

                // RepartiÃ§Ãµes
                const selectRep = document.getElementById('filtro-escala-reparticao');
                selectRep.innerHTML = '<option value="">Todas as repartiÃ§Ãµes</option>';
                SistemaCore.dados.reparticoes.forEach(rep => {
                    selectRep.innerHTML += `<option value="${rep.id}">${rep.nome}</option>`;
                });
            },

            abrirModal(id = null) {
                // Carregar profissionais
                const selectProf = document.getElementById('escala-profissional');
                selectProf.innerHTML = '<option value="">Selecione o profissional...</option>';
                SistemaCore.dados.profissionais.forEach(prof => {
                    const especialidades = prof.especialidades || [prof.especialidade];
                    const espTexto = especialidades.join(', ');
                    selectProf.innerHTML += `<option value="${prof.id}">${prof.nome} (${espTexto})</option>`;
                });

                // Carregar repartiÃ§Ãµes
                const selectRep = document.getElementById('escala-reparticao');
                selectRep.innerHTML = '<option value="">Selecione a repartiÃ§Ã£o...</option>';
                SistemaCore.dados.reparticoes.forEach(rep => {
                    selectRep.innerHTML += `<option value="${rep.id}">${rep.nome}</option>`;
                });

                if (id) {
                    const escala = SistemaCore.dados.escalas.find(e => e.id === id);
                    if (!escala) return;
                    
                    document.getElementById('tituloModalEscala').textContent = 'âœï¸ Editar Escala';
                    document.getElementById('edit-escala-id').value = escala.id;
                    
                    document.getElementById('escala-profissional').value = escala.profissional_id;
                    this.atualizarEspecialidades();
                    document.getElementById('escala-especialidade').value = escala.especialidade;
                    document.getElementById('escala-reparticao').value = escala.reparticao_id;
                    document.getElementById('escala-tipo').value = escala.tipo;
                    document.getElementById('escala-horario-inicio').value = escala.horario_inicio;
                    document.getElementById('escala-horario-fim').value = escala.horario_fim;
                    document.getElementById('escala-data-inicio').value = escala.data_inicio;
                    document.getElementById('escala-data-fim').value = escala.data_fim || '';
                    document.getElementById('escala-observacoes').value = escala.observacoes || '';
                    
                    // Marcar dias da semana
                    document.querySelectorAll('.dia-semana').forEach(cb => {
                        cb.checked = escala.dias_semana.includes(cb.value);
                    });
                } else {
                    document.getElementById('tituloModalEscala').textContent = 'â• Nova Escala';
                    document.getElementById('edit-escala-id').value = '';
                    
                    document.getElementById('escala-profissional').value = '';
                    document.getElementById('escala-especialidade').innerHTML = '<option value="">Selecione o profissional primeiro...</option>';
                    document.getElementById('escala-reparticao').value = '';
                    document.getElementById('escala-tipo').value = '';
                    document.getElementById('escala-horario-inicio').value = '';
                    document.getElementById('escala-horario-fim').value = '';
                    document.getElementById('escala-data-inicio').value = new Date().toISOString().split('T')[0];
                    document.getElementById('escala-data-fim').value = '';
                    document.getElementById('escala-observacoes').value = '';
                    
                    document.querySelectorAll('.dia-semana').forEach(cb => cb.checked = false);
                }
                
                document.getElementById('modalEscala').classList.add('active');
            },

            atualizarEspecialidades() {
                const profId = parseInt(document.getElementById('escala-profissional').value);
                const selectEsp = document.getElementById('escala-especialidade');
                
                if (!profId) {
                    selectEsp.innerHTML = '<option value="">Selecione o profissional primeiro...</option>';
                    return;
                }

                const prof = SistemaCore.dados.profissionais.find(p => p.id === profId);
                if (!prof) return;

                // Pegar especialidades do profissional
                const especialidades = prof.especialidades || [prof.especialidade];
                
                selectEsp.innerHTML = '<option value="">Selecione a especialidade...</option>';
                especialidades.forEach(esp => {
                    selectEsp.innerHTML += `<option value="${esp}">${esp}</option>`;
                });
            },

            fecharModal() {
                document.getElementById('modalEscala').classList.remove('active');
            },

            validarConflito(dados, editId = null) {
                // Verificar se jÃ¡ existe escala conflitante
                const conflitos = SistemaCore.dados.escalas.filter(e => {
                    if (!e.ativo) return false;
                    if (editId && e.id === editId) return false; // Ignorar a prÃ³pria escala ao editar
                    if (e.profissional_id !== dados.profissional_id) return false;
                    
                    // Verificar sobreposiÃ§Ã£o de datas
                    const inicio1 = new Date(dados.data_inicio);
                    const fim1 = dados.data_fim ? new Date(dados.data_fim) : null;
                    const inicio2 = new Date(e.data_inicio);
                    const fim2 = e.data_fim ? new Date(e.data_fim) : null;
                    
                    // Se nÃ£o hÃ¡ sobreposiÃ§Ã£o de perÃ­odo, nÃ£o hÃ¡ conflito
                    if (fim1 && inicio2 > fim1) return false;
                    if (fim2 && inicio1 > fim2) return false;
                    
                    // Verificar se hÃ¡ dias da semana em comum
                    const diasComum = dados.dias_semana.filter(d => e.dias_semana.includes(d));
                    if (diasComum.length === 0) return false;
                    
                    // Verificar sobreposiÃ§Ã£o de horÃ¡rios
                    const h1_inicio = dados.horario_inicio;
                    const h1_fim = dados.horario_fim;
                    const h2_inicio = e.horario_inicio;
                    const h2_fim = e.horario_fim;
                    
                    // Se hÃ¡ sobreposiÃ§Ã£o de horÃ¡rios, Ã© conflito
                    if (h1_inicio < h2_fim && h1_fim > h2_inicio) {
                        return true;
                    }
                    
                    return false;
                });
                
                return conflitos.length > 0 ? conflitos[0] : null;
            },

            salvar() {
                const profId = parseInt(document.getElementById('escala-profissional').value);
                const especialidade = document.getElementById('escala-especialidade').value;
                const reparticaoId = parseInt(document.getElementById('escala-reparticao').value);
                const tipo = document.getElementById('escala-tipo').value;
                const horarioInicio = document.getElementById('escala-horario-inicio').value;
                const horarioFim = document.getElementById('escala-horario-fim').value;
                const dataInicio = document.getElementById('escala-data-inicio').value;
                const dataFim = document.getElementById('escala-data-fim').value || null;
                const observacoes = document.getElementById('escala-observacoes').value.trim();
                const editId = parseInt(document.getElementById('edit-escala-id').value) || null;

                // ValidaÃ§Ãµes
                if (!profId || !especialidade || !reparticaoId || !tipo) {
                    Sistema.notificar('Preencha todos os campos obrigatÃ³rios!', 'error');
                    return;
                }

                if (!horarioInicio || !horarioFim) {
                    Sistema.notificar('Informe os horÃ¡rios de inÃ­cio e fim!', 'error');
                    return;
                }

                if (horarioInicio >= horarioFim) {
                    Sistema.notificar('HorÃ¡rio de inÃ­cio deve ser menor que o fim!', 'error');
                    return;
                }

                if (!dataInicio) {
                    Sistema.notificar('Informe a data de inÃ­cio!', 'error');
                    return;
                }

                if (dataFim && dataFim < dataInicio) {
                    Sistema.notificar('Data de fim deve ser maior ou igual Ã  data de inÃ­cio!', 'error');
                    return;
                }

                // Pegar dias selecionados
                const diasSemana = [];
                document.querySelectorAll('.dia-semana:checked').forEach(cb => {
                    diasSemana.push(cb.value);
                });

                if (diasSemana.length === 0) {
                    Sistema.notificar('Selecione pelo menos um dia da semana!', 'error');
                    return;
                }

                const prof = SistemaCore.dados.profissionais.find(p => p.id === profId);
                const rep = SistemaCore.dados.reparticoes.find(r => r.id === reparticaoId);

                const dados = {
                    profissional_id: profId,
                    profissional_nome: prof.nome,
                    especialidade,
                    reparticao_id: reparticaoId,
                    reparticao_nome: rep.nome,
                    tipo,
                    dias_semana: diasSemana,
                    horario_inicio: horarioInicio,
                    horario_fim: horarioFim,
                    data_inicio: dataInicio,
                    data_fim: dataFim,
                    ativo: true,
                    observacoes,
                    criado_em: new Date().toISOString(),
                    criado_por: Auth.usuarioAtual ? Auth.usuarioAtual.nome : 'Sistema'
                };

                // Verificar conflitos
                const conflito = this.validarConflito(dados, editId);
                if (conflito) {
                    const diasMap = {
                        'seg': 'Seg', 'ter': 'Ter', 'qua': 'Qua', 
                        'qui': 'Qui', 'sex': 'Sex', 'sab': 'SÃ¡b', 'dom': 'Dom'
                    };
                    const diasTexto = conflito.dias_semana.map(d => diasMap[d]).join(', ');
                    Sistema.notificar(
                        `âš ï¸ Conflito de horÃ¡rio!\n\nJÃ¡ existe escala para este profissional:\n` +
                        `${conflito.reparticao_nome}\n` +
                        `${diasTexto} | ${conflito.horario_inicio}-${conflito.horario_fim}`,
                        'error'
                    );
                    return;
                }

                if (editId) {
                    const escala = SistemaCore.dados.escalas.find(e => e.id === editId);
                    if (escala) {
                        Object.assign(escala, dados);
                    }
                } else {
                    dados.id = SistemaCore.proximoId(SistemaCore.dados.escalas);
                    SistemaCore.dados.escalas.push(dados);
                }

                SistemaCore.salvar();
                this.listar();
                this.carregarFiltros();
                this.fecharModal();
                Sistema.notificar('âœ… Escala salva com sucesso!');
            },

            editar(id) {
                this.abrirModal(id);
            },

            desativar(id) {
                if (!confirm('Deseja realmente desativar esta escala?')) return;
                
                const escala = SistemaCore.dados.escalas.find(e => e.id === id);
                if (escala) {
                    escala.ativo = false;
                    SistemaCore.salvar();
                    this.listar();
                    Sistema.notificar('âœ… Escala desativada!');
                }
            }
        };

        /* ============================================================
           [PACIENTES] MÃ³dulo Pacientes
           ============================================================ */
        
        // ============================================================
        // EXAME FÃSICO - FunÃ§Ãµes auxiliares
        // ============================================================
        const ExameFisico = {
            atendimentoAtualId: null, // SerÃ¡ preenchido quando abrir atendimento
            
            // Calcular IMC automaticamente
            calcularIMC() {
                const pesoInput = document.getElementById('antropometria-peso');
                const alturaInput = document.getElementById('antropometria-altura');
                const imcInput = document.getElementById('antropometria-imc');
                
                if (!pesoInput || !alturaInput || !imcInput) {
                    return; // Campos nÃ£o existem no template atual
                }
                
                const peso = parseFloat(pesoInput.value);
                const altura = parseFloat(alturaInput.value);
                
                if (isNaN(peso) || isNaN(altura) || peso <= 0 || altura <= 0) {
                    imcInput.value = '';
                    return;
                }
                
                // Converter altura de cm para metros
                const alturaMetros = altura / 100;
                const imc = peso / (alturaMetros * alturaMetros);
                
                // Mostrar IMC com 2 casas decimais
                imcInput.value = imc.toFixed(2);
                
                // Adicionar classificaÃ§Ã£o visual
                let classificacao = '';
                if (imc < 18.5) classificacao = '(Baixo peso)';
                else if (imc < 25) classificacao = '(Normal)';
                else if (imc < 30) classificacao = '(Sobrepeso)';
                else if (imc < 35) classificacao = '(Obesidade I)';
                else if (imc < 40) classificacao = '(Obesidade II)';
                else classificacao = '(Obesidade III)';
                
                imcInput.placeholder = classificacao;
            }
        };

        const Pacientes = {
            listar() {
                const pacs = SistemaCore.dados.pacientes;
                this.renderizarLista(pacs);
            },

            // v10.88: MELHORADA - Filtrar listagem em tempo real com busca inteligente
            filtrarListagem() {
                const busca = document.getElementById('busca-pacientes').value.trim();
                console.log('ğŸ” Busca de pacientes:', busca); // DEBUG
                
                // Se busca vazia, mostrar todos
                if (busca.length === 0) {
                    console.log('ğŸ“‹ Busca vazia, mostrando todos'); // DEBUG
                    this.listar();
                    return;
                }
                
                // Normalizar busca (remover acentos e converter para minÃºsculas)
                const buscaNormalizada = this.normalizarTexto(busca);
                console.log('âœ¨ Busca normalizada:', buscaNormalizada); // DEBUG
                
                // Separar palavras da busca
                const palavrasBusca = buscaNormalizada.split(/\s+/).filter(p => p.length > 0);
                console.log('ğŸ“ Palavras da busca:', palavrasBusca); // DEBUG
                
                // Filtrar pacientes
                const pacsFiltrados = SistemaCore.dados.pacientes.filter(pac => {
                    // BUSCA POR NOME (melhorada)
                    const nomeNormalizado = this.normalizarTexto(pac.nome || '');
                    
                    // Verificar se TODAS as palavras da busca estÃ£o no nome (em qualquer ordem)
                    const nomeMatch = palavrasBusca.every(palavra => nomeNormalizado.includes(palavra));
                    
                    // BUSCA POR CPF
                    const cpf = (pac.cpf || '').replace(/\D/g, '');
                    const termoBuscaNumeros = busca.replace(/\D/g, '');
                    const cpfMatch = cpf.includes(termoBuscaNumeros);
                    
                    // BUSCA POR PRONTUÃRIO
                    const prontuarioNormalizado = this.normalizarTexto(pac.prontuario || '');
                    const prontuarioMatch = prontuarioNormalizado.includes(buscaNormalizada);
                    
                    // BUSCA POR TELEFONE
                    const telefone = (pac.telefone || '').replace(/\D/g, '');
                    const telefoneMatch = telefone.includes(termoBuscaNumeros);
                    
                    return nomeMatch || cpfMatch || prontuarioMatch || telefoneMatch;
                });
                
                console.log(`âœ… Encontrados ${pacsFiltrados.length} pacientes`); // DEBUG
                
                // Renderizar apenas filtrados
                this.renderizarLista(pacsFiltrados);
            },
            
            // v10.88: NOVA - Normalizar texto (remove acentos e converte para minÃºsculas)
            normalizarTexto(texto) {
                if (!texto) return '';
                return texto
                    .toLowerCase()
                    .normalize('NFD')
                    .replace(/[\u0300-\u036f]/g, ''); // Remove acentos
            },

            // v10.86: NOVA - Renderizar lista de pacientes (separada de listar para permitir filtro)
            renderizarLista(pacientes) {
                const container = document.getElementById('listaPacientes');
                
                if (pacientes.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light); padding: 20px; text-align: center;">Nenhum paciente encontrado.</p>';
                    return;
                }

                // Ordenar por ID decrescente (mais recentes primeiro)
                const pacsOrdenados = [...pacientes].sort((a, b) => b.id - a.id);

                let html = '<div class="item-list">';
                pacsOrdenados.forEach(pac => {
                    const idadeDetalhada = pac.nascimento ? Pacientes.calcularIdadeDetalhada(pac.nascimento) : '';
                    const sexoIcon = pac.sexo === 'M' ? 'â™‚ï¸' : pac.sexo === 'F' ? 'â™€ï¸' : '';
                    const categoria = pac.nascimento ? Pacientes.obterCategoriaEtaria(pac.nascimento) : '';
                    
                    // v10.54: Indicador de cadastro incompleto
                    const ehCadastroIncompleto = pac.cadastro_completo === false;
                    const badgeCadastro = ehCadastroIncompleto ? `
                        <span style="background: #fbbf24; color: #78350f; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; margin-left: 8px;">
                            âš ï¸ CADASTRO INCOMPLETO
                        </span>
                    ` : '';
                    
                    html += `
                        <div class="item-card" style="${ehCadastroIncompleto ? 'border-left: 4px solid #fbbf24;' : ''}">
                            <div>
                                <strong>${pac.nome}</strong>
                                ${badgeCadastro}
                                ${sexoIcon} 
                                ${idadeDetalhada ? `<span class="idade-display">${idadeDetalhada}</span>` : ''}
                                ${categoria ? `<span class="categoria-etaria" style="background: ${categoria.cor}">${categoria.nome}</span>` : ''}
                                <br>
                                <small style="color: var(--text-light);">
                                    ğŸ“‹ ProntuÃ¡rio: ${pac.prontuario || 'NÃ£o gerado'} | 
                                    ${pac.tipo_documento === 'cpf' ? 'CPF: ' + (pac.cpf || '-') : 
                                      pac.tipo_documento === 'passaporte' ? 'Passaporte: ' + (pac.passaporte || '-') :
                                      pac.tipo_documento === 'rne' ? 'RNE: ' + (pac.rne || '-') :
                                      pac.tipo_documento === 'provisorio' ? 'ğŸ†” ' + (pac.numero_documento || 'NÃ£o identificado') :
                                      'CPF: ' + (pac.cpf || 'NÃ£o informado')} | 
                                    Tel: ${pac.telefone || 'NÃ£o informado'}
                                    ${ehCadastroIncompleto ? ` | <span style="color: #f59e0b; font-weight: 600;">Cadastrado em: ${pac.data_cadastro || 'N/D'}</span>` : ''}
                                </small>
                            </div>
                            <div class="action-buttons">
                                ${ehCadastroIncompleto ? `
                                    <button class="btn btn-primary" onclick="Pacientes.editar(${pac.id})" title="Completar cadastro">
                                        ğŸ”„ Completar Cadastro
                                    </button>
                                ` : ''}
                                <button class="btn btn-icon btn-primary" onclick="Pacientes.editar(${pac.id})">âœï¸</button>
                                <button class="btn btn-icon btn-danger" onclick="Pacientes.excluir(${pac.id})">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;
            },

            calcularIdade(nascimento) {
                const hoje = new Date();
                const nasc = new Date(nascimento + 'T00:00:00');
                let idade = hoje.getFullYear() - nasc.getFullYear();
                const m = hoje.getMonth() - nasc.getMonth();
                if (m < 0 || (m === 0 && hoje.getDate() < nasc.getDate())) {
                    idade--;
                }
                return idade;
            },
            
            // v10.85: NOVA - Calcular idade detalhada (anos, meses, dias)
            calcularIdadeDetalhada(nascimento) {
                if (!nascimento) return '';
                
                const hoje = new Date();
                const nasc = new Date(nascimento + 'T00:00:00');
                
                let anos = hoje.getFullYear() - nasc.getFullYear();
                let meses = hoje.getMonth() - nasc.getMonth();
                let dias = hoje.getDate() - nasc.getDate();
                
                // Ajustar se dias negativos
                if (dias < 0) {
                    meses--;
                    const ultimoDiaMesAnterior = new Date(hoje.getFullYear(), hoje.getMonth(), 0).getDate();
                    dias += ultimoDiaMesAnterior;
                }
                
                // Ajustar se meses negativos
                if (meses < 0) {
                    anos--;
                    meses += 12;
                }
                
                // Formatar texto
                let partes = [];
                if (anos > 0) partes.push(`${anos} ${anos === 1 ? 'ano' : 'anos'}`);
                if (meses > 0) partes.push(`${meses} ${meses === 1 ? 'mÃªs' : 'meses'}`);
                if (dias > 0 || partes.length === 0) partes.push(`${dias} ${dias === 1 ? 'dia' : 'dias'}`);
                
                return partes.join(', ');
            },

            obterCategoriaEtaria(nascimento) {
                const hoje = new Date();
                const nasc = new Date(nascimento + 'T00:00:00');
                const diffMs = hoje - nasc;
                const diffDias = Math.floor(diffMs / (1000 * 60 * 60 * 24));
                const anos = Math.floor(diffDias / 365.25);

                if (diffDias <= 28) return { nome: 'Neonato', cor: '#fcd34d' };
                if (anos < 2) return { nome: 'Lactente', cor: '#60a5fa' };
                if (anos < 6) return { nome: 'PrÃ©-escolar', cor: '#a78bfa' };
                if (anos < 13) return { nome: 'Escolar', cor: '#34d399' };
                if (anos < 18) return { nome: 'Adolescente', cor: '#f472b6' };
                if (anos < 60) return { nome: 'Adulto', cor: '#94a3b8' };
                return { nome: 'Idoso', cor: '#fb923c' };
            },

            getCorCategoria(categoria) {
                return categoria.cor;
            },

            trocarAba(event, abaId) {
                // Desativar todas as abas
                document.querySelectorAll('.form-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.form-tab-content').forEach(content => content.classList.remove('active'));

                // Ativar aba clicada
                event.target.classList.add('active');
                document.getElementById('aba-' + abaId).classList.add('active');
            },

            selecionarSexo(sexo) {
                console.log('[v10.463] selecionarSexo:', sexo);
                
                // Limpar seleÃ§Ã£o anterior
                document.querySelectorAll('.sexo-option').forEach(opt => opt.classList.remove('selected'));
                
                // Aplicar seleÃ§Ã£o visual
                if (sexo === 'M') {
                    document.querySelector('.sexo-option.masculino')?.classList.add('selected');
                } else if (sexo === 'F') {
                    document.querySelector('.sexo-option.feminino')?.classList.add('selected');
                } else if (sexo === 'I') {
                    document.querySelector('.sexo-option.intersexo')?.classList.add('selected');
                } else if (sexo === 'N') {
                    document.querySelector('.sexo-option.nao-informado')?.classList.add('selected');
                }
                
                // Definir valor no campo hidden
                const campo = document.getElementById('pac-sexo');
                if (campo) {
                    campo.value = sexo;
                    console.log('[v10.463] pac-sexo.value definido:', campo.value);
                }
            },

            // âœ… v10.7: Mostrar/ocultar comentÃ¡rio de contato indireto
            toggleComentarioContato() {
                const tipo = document.getElementById('pac-tipo-contato').value;
                const group = document.getElementById('pac-comentario-contato-group');
                if (tipo === 'indireto') {
                    group.style.display = 'block';
                } else {
                    group.style.display = 'none';
                    document.getElementById('pac-comentario-contato').value = '';
                }
            },

            // âœ… v10.7: Mostrar/ocultar campo PaÃ­s se estrangeiro
            togglePaisEstrangeiro() {
                const estrangeiro = document.getElementById('pac-estrangeiro').checked;
                const group = document.getElementById('pac-pais-group');
                if (estrangeiro) {
                    group.style.display = 'block';
                } else {
                    group.style.display = 'none';
                    document.getElementById('pac-pais').value = '';
                }
            },

            // âœ… v10.8: Controlar tipo de documento (CPF / Passaporte / ProvisÃ³rio)
            toggleTipoDocumento() {
                const estrangeiro = document.getElementById('pac-estrangeiro-doc').checked;
                const docProvisorio = document.getElementById('pac-doc-provisorio').checked;
                
                // Grupos de campos
                const cpfGroup = document.getElementById('pac-cpf-group');
                const passaporteGroup = document.getElementById('pac-passaporte-group');
                const rneGroup = document.getElementById('pac-rne-group');
                const rgGroup = document.getElementById('pac-rg-group');
                const provisorioContainer = document.getElementById('pac-id-provisorio-container');
                
                // Campos
                const cpfInput = document.getElementById('pac-cpf');
                const passaporteInput = document.getElementById('pac-passaporte');
                const rneInput = document.getElementById('pac-rne');
                const rgInput = document.getElementById('pac-rg');
                const cpfRequired = document.getElementById('pac-cpf-required');
                
                // NÃ£o permite marcar ambos
                if (estrangeiro && docProvisorio) {
                    if (event.target.id === 'pac-estrangeiro-doc') {
                        document.getElementById('pac-doc-provisorio').checked = false;
                    } else {
                        document.getElementById('pac-estrangeiro-doc').checked = false;
                        estrangeiro = false;
                    }
                }
                
                if (docProvisorio) {
                    // DOCUMENTO PROVISÃ“RIO (NÃƒO IDENTIFICADO)
                    cpfGroup.style.display = 'none';
                    passaporteGroup.style.display = 'none';
                    rneGroup.style.display = 'none';
                    rgGroup.style.display = 'none';
                    provisorioContainer.style.display = 'block';
                    
                    // Gerar ID temporÃ¡rio
                    const idTemp = this.gerarIdTemporario();
                    document.getElementById('pac-id-temp').textContent = idTemp;
                    
                    // Desabilitar campos
                    cpfInput.disabled = true;
                    passaporteInput.disabled = true;
                    rneInput.disabled = true;
                    rgInput.disabled = true;
                    
                    // Limpar valores
                    cpfInput.value = '';
                    passaporteInput.value = '';
                    rneInput.value = '';
                    
                } else if (estrangeiro) {
                    // ESTRANGEIRO
                    cpfGroup.style.display = 'none';
                    passaporteGroup.style.display = 'block';
                    rneGroup.style.display = 'block';
                    rgGroup.style.display = 'none';
                    provisorioContainer.style.display = 'none';
                    
                    // Habilitar campos estrangeiro
                    cpfInput.disabled = true;
                    passaporteInput.disabled = false;
                    rneInput.disabled = false;
                    rgInput.disabled = true;
                    
                    // Limpar CPF e RG
                    cpfInput.value = '';
                    rgInput.value = '';
                    
                } else {
                    // BRASILEIRO (PADRÃƒO)
                    cpfGroup.style.display = 'block';
                    passaporteGroup.style.display = 'none';
                    rneGroup.style.display = 'none';
                    rgGroup.style.display = 'block';
                    provisorioContainer.style.display = 'none';
                    
                    // Habilitar campos brasileiro
                    cpfInput.disabled = false;
                    passaporteInput.disabled = true;
                    rneInput.disabled = true;
                    rgInput.disabled = false;
                    
                    // Limpar passaporte e RNE
                    passaporteInput.value = '';
                    rneInput.value = '';
                }
            },

            // âœ… v10.8: Mostrar/ocultar CNS baseado no convÃªnio
            toggleCNS() {
                const convenio = document.getElementById('pac-convenio').value.toLowerCase();
                const cnsGroup = document.getElementById('pac-cns-group');
                const cnsInput = document.getElementById('pac-cns');
                
                if (convenio === 'sus') {
                    cnsGroup.style.display = 'block';
                } else {
                    cnsGroup.style.display = 'none';
                    cnsInput.value = ''; // Limpa o campo se nÃ£o for SUS
                }
            },

            // âœ… v10.58: Carregar modalidades disponÃ­veis baseado no estabelecimento
            carregarModalidades() {
                const container = document.getElementById('pac-modalidades-container');
                
                // v10.60.4: VerificaÃ§Ã£o de seguranÃ§a
                if (!container) {
                    console.warn('Elemento pac-modalidades-container nÃ£o encontrado');
                    return;
                }
                
                const modalidades = SistemaCore.dados.estabelecimento?.modalidades || {};
                
                // Contar quantas modalidades estÃ£o ativas
                const modAtivas = [];
                if (modalidades.particular) modAtivas.push({ valor: 'particular', icone: 'ğŸ’°', nome: 'Particular' });
                if (modalidades.convenio) modAtivas.push({ valor: 'convenio', icone: 'ğŸ¥', nome: 'ConvÃªnio' });
                if (modalidades.sus) modAtivas.push({ valor: 'sus', icone: 'ğŸ›ï¸', nome: 'SUS' });
                
                // Se nenhuma modalidade configurada, mostrar aviso
                if (modAtivas.length === 0) {
                    container.innerHTML = `
                        <div style="padding: 16px; background: #f9fafb; border: 1px solid #fbbf24; border-radius: 6px; text-align: center;">
                            <p style="margin: 0; color: #92400e; font-weight: 500;">
                                âš ï¸ Nenhuma modalidade configurada no estabelecimento
                            </p>
                            <small style="color: #92400e; display: block; margin-top: 4px;">
                                Configure em: Estabelecimento â†’ CaracterizaÃ§Ã£o â†’ Modalidades de Atendimento
                            </small>
                        </div>
                    `;
                    return;
                }
                
                // Se sÃ³ tem uma modalidade, jÃ¡ vem marcada
                if (modAtivas.length === 1) {
                    const mod = modAtivas[0];
                    container.innerHTML = `
                        <label style="display: flex; align-items: center; cursor: pointer; padding: 12px; background: white; border: 1px solid #e0e0e0; border-radius: 6px;">
                            <input type="radio" name="pac-modalidade" value="${mod.valor}" checked style="margin-right: 10px; width: 18px; height: 18px;">
                            <span>${mod.icone} ${mod.nome} (Ãºnica opÃ§Ã£o)</span>
                        </label>
                    `;
                    // v10.60.6: Controlar obrigatoriedade
                    this.toggleObrigatoriedadeConvenio();
                    return;
                }
                
                // Se tem mais de uma, mostrar todas
                let html = '';
                modAtivas.forEach((mod, index) => {
                    const checked = index === 0 ? 'checked' : ''; // Primeira opÃ§Ã£o marcada por padrÃ£o
                    html += `
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="radio" name="pac-modalidade" value="${mod.valor}" ${checked} style="margin-right: 10px; width: 18px; height: 18px;">
                            <span>${mod.icone} ${mod.nome}</span>
                        </label>
                    `;
                });
                container.innerHTML = html;
                
                // v10.60.6: Adicionar event listeners para controlar obrigatoriedade
                setTimeout(() => {
                    document.querySelectorAll('input[name="pac-modalidade"]').forEach(radio => {
                        radio.addEventListener('change', () => {
                            this.toggleObrigatoriedadeConvenio();
                        });
                    });
                    // Controlar obrigatoriedade inicial
                    this.toggleObrigatoriedadeConvenio();
                }, 100);
            },
            
            // v10.60.6: Controlar obrigatoriedade dos campos de convÃªnio baseado na modalidade
            toggleObrigatoriedadeConvenio() {
                const radioModalidade = document.querySelector('input[name="pac-modalidade"]:checked');
                const modalidade = radioModalidade ? radioModalidade.value : '';
                
                // Elementos de obrigatoriedade
                const convenioRequired = document.getElementById('pac-convenio-required');
                const carteirinhaRequired = document.getElementById('pac-carteirinha-required');
                const validadeRequired = document.getElementById('pac-validade-required');
                
                // Se modalidade = "convenio", campos sÃ£o obrigatÃ³rios
                if (modalidade === 'convenio') {
                    if (convenioRequired) convenioRequired.style.display = 'inline';
                    if (carteirinhaRequired) carteirinhaRequired.style.display = 'inline';
                    if (validadeRequired) validadeRequired.style.display = 'inline';
                } else {
                    // Para "particular" ou "sus", campos nÃ£o sÃ£o obrigatÃ³rios
                    if (convenioRequired) convenioRequired.style.display = 'none';
                    if (carteirinhaRequired) carteirinhaRequired.style.display = 'none';
                    if (validadeRequired) validadeRequired.style.display = 'none';
                }
            },

            // âœ… v10.8: Gerar ID TemporÃ¡rio para paciente nÃ£o identificado
            gerarIdTemporario() {
                // Usar o prÃ³ximo nÃºmero de registro de entrada
                const registroEntrada = this.gerarRegistroEntrada();
                return `NI-${registroEntrada}`;
            },

            // âœ… v10.8: Gerar Registro de Entrada (AAAAMMDDNNNNNN)
            gerarRegistroEntrada() {
                const agora = new Date();
                const ano = agora.getFullYear();
                const mes = String(agora.getMonth() + 1).padStart(2, '0');
                const dia = String(agora.getDate()).padStart(2, '0');
                
                // Contar entradas do mesmo dia
                const entradas = SistemaCore.dados.entradas || [];
                const inicioHoje = new Date(ano, agora.getMonth(), agora.getDate()).getTime();
                const fimHoje = inicioHoje + (24 * 60 * 60 * 1000);
                
                const entradasHoje = entradas.filter(e => {
                    const dataEntrada = new Date(e.data_entrada + 'T00:00:00').getTime();
                    return dataEntrada >= inicioHoje && dataEntrada < fimHoje;
                });
                
                const sequencial = String(entradasHoje.length + 1).padStart(6, '0');
                
                return `${ano}${mes}${dia}${sequencial}`;
            },

            // âœ… v10.8: Gerar NÃºmero de ProntuÃ¡rio (6 dÃ­gitos sequenciais)
            gerarNumeroProntuario() {
                const pacientes = SistemaCore.dados.pacientes || [];
                
                // Encontrar o maior prontuÃ¡rio existente
                let maiorProntuario = 0;
                pacientes.forEach(p => {
                    if (p.prontuario) {
                        const num = parseInt(p.prontuario);
                        if (num > maiorProntuario) {
                            maiorProntuario = num;
                        }
                    }
                });
                
                // PrÃ³ximo nÃºmero
                const proximo = maiorProntuario + 1;
                return String(proximo).padStart(6, '0');
            },
            
            // v10.39: Popular dropdown de Regionais de SaÃºde
            popularDropdownRegionais() {
                const select = document.getElementById('pac-regional-saude');
                if (!select) return;
                
                // Limpar e adicionar opÃ§Ã£o padrÃ£o
                select.innerHTML = '<option value="">Selecione...</option>';
                
                // Garantir que o pool existe
                if (!SistemaCore.dados.estabelecimento.regionaisSaude) {
                    SistemaCore.dados.estabelecimento.regionaisSaude = [];
                }
                
                // Popular com regionais
                SistemaCore.dados.estabelecimento.regionaisSaude.forEach(regional => {
                    const option = document.createElement('option');
                    option.value = regional;
                    option.textContent = regional;
                    select.appendChild(option);
                });
            },
            
            // v10.39: Abrir gerenciador de Regionais de SaÃºde
            abrirGerenciadorRegionais() {
                // Mostrar modal simples para gerenciar regionais
                const regionais = SistemaCore.dados.estabelecimento.regionaisSaude || [];
                
                const html = `
                    <div style="max-height: 400px; overflow-y: auto;">
                        <h4 style="margin-bottom: 16px;">ğŸ“ Gerenciar Regionais de SaÃºde</h4>
                        
                        <div style="margin-bottom: 20px;">
                            <input type="text" id="nova-regional" 
                                   placeholder="Digite a nova regional..." 
                                   style="width: 100%; padding: 8px; margin-bottom: 8px;">
                            <button onclick="Pacientes.adicionarRegional()" class="btn btn-primary" style="width: 100%;">
                                â• Adicionar Regional
                            </button>
                        </div>
                        
                        <div id="lista-regionais" style="margin-top: 16px;">
                            ${regionais.length === 0 ? '<p style="color: #999;">Nenhuma regional cadastrada</p>' : ''}
                            ${regionais.map(r => `
                                <div style="display: flex; justify-content: space-between; align-items: center; 
                                            padding: 8px; background: #f5f5f5; margin-bottom: 4px; border-radius: 4px;">
                                    <span>${r}</span>
                                    <button onclick="Pacientes.removerRegional('${r}')" 
                                            class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;">
                                        ğŸ—‘ï¸
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
                Sistema.mostrarModal('Regionais de SaÃºde', html);
            },
            
            // v10.39: Adicionar nova regional
            adicionarRegional() {
                const input = document.getElementById('nova-regional');
                const valor = input.value.trim();
                
                if (!valor) {
                    Sistema.notificar('Digite o nome da regional!', 'error');
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.regionaisSaude) {
                    SistemaCore.dados.estabelecimento.regionaisSaude = [];
                }
                
                if (SistemaCore.dados.estabelecimento.regionaisSaude.includes(valor)) {
                    Sistema.notificar('Regional jÃ¡ existe!', 'error');
                    return;
                }
                
                SistemaCore.dados.estabelecimento.regionaisSaude.push(valor);
                SistemaCore.dados.estabelecimento.regionaisSaude.sort();
                SistemaCore.salvar();
                
                input.value = '';
                this.abrirGerenciadorRegionais(); // Reabrir para atualizar lista
                this.popularDropdownRegionais(); // Atualizar dropdown
                Sistema.notificar('âœ… Regional adicionada!');
            },
            
            // v10.39: Remover regional
            removerRegional(regional) {
                // Verificar se estÃ¡ em uso
                const emUso = SistemaCore.dados.pacientes.some(p => p.regional_saude === regional);
                
                if (emUso) {
                    Sistema.notificar('âŒ Regional em uso! NÃ£o pode ser removida.', 'error');
                    return;
                }
                
                if (!confirm(`Remover "${regional}"?`)) return;
                
                const index = SistemaCore.dados.estabelecimento.regionaisSaude.indexOf(regional);
                if (index > -1) {
                    SistemaCore.dados.estabelecimento.regionaisSaude.splice(index, 1);
                    SistemaCore.salvar();
                    this.abrirGerenciadorRegionais(); // Reabrir para atualizar lista
                    this.popularDropdownRegionais(); // Atualizar dropdown
                    Sistema.notificar('âœ… Regional removida!');
                }
            },

            async buscarCEP() {
                const cep = document.getElementById('pac-cep').value.replace(/\D/g, '');
                
                if (cep.length !== 8) {
                    Sistema.notificar('CEP invÃ¡lido!', 'error');
                    return;
                }

                try {
                    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                    const data = await response.json();

                    if (data.erro) {
                        Sistema.notificar('CEP nÃ£o encontrado!', 'error');
                        return;
                    }

                    document.getElementById('pac-logradouro').value = data.logradouro || '';
                    document.getElementById('pac-bairro').value = data.bairro || '';
                    document.getElementById('pac-cidade').value = data.localidade || '';
                    document.getElementById('pac-estado').value = data.uf || '';
                    document.getElementById('pac-numero').focus();
                    
                    Sistema.notificar('CEP encontrado!');
                } catch (error) {
                    Sistema.notificar('Erro ao buscar CEP!', 'error');
                }
            },

            // âœ… v10.6: Validar CNS (CartÃ£o Nacional de SaÃºde)
            validarCNS() {
                const input = document.getElementById('pac-cns');
                const resultado = document.getElementById('pac-cns-validacao');
                const cns = input.value.replace(/\D/g, '');
                
                if (!cns) {
                    resultado.innerHTML = '';
                    return true;
                }
                
                if (cns.length !== 15) {
                    resultado.innerHTML = '<span style="color: #ef4444;">âŒ CNS deve ter 15 dÃ­gitos</span>';
                    return false;
                }
                
                // Algoritmo de validaÃ§Ã£o CNS
                const pis = cns.substring(0, 11);
                let soma = 0;
                
                for (let i = 0; i < 11; i++) {
                    soma += parseInt(pis[i]) * (15 - i);
                }
                
                const resto = soma % 11;
                const dv = resto === 0 ? 0 : 11 - resto;
                
                if (dv === 10) {
                    soma += 2;
                    const novoDv = 11 - (soma % 11);
                    const cnsCalculado = pis + '001' + novoDv;
                    
                    if (cns === cnsCalculado) {
                        resultado.innerHTML = '<span style="color: #10b981;">âœ… CNS vÃ¡lido</span>';
                        return true;
                    }
                } else {
                    const cnsCalculado = pis + '000' + dv;
                    
                    if (cns === cnsCalculado) {
                        resultado.innerHTML = '<span style="color: #10b981;">âœ… CNS vÃ¡lido</span>';
                        return true;
                    }
                }
                
                resultado.innerHTML = '<span style="color: #f59e0b;">âš ï¸ CNS pode estar incorreto</span>';
                return false;
            },

            // v10: Carregar convÃªnios do pool
            carregarConvenios() {
                const select = document.getElementById('pac-convenio');
                
                // v10.60.5: VerificaÃ§Ã£o de seguranÃ§a
                if (!select) {
                    console.warn('Elemento pac-convenio nÃ£o encontrado');
                    return;
                }
                
                const convenios = SistemaCore.dados.estabelecimento.convenios || [];
                
                // v10.2: ORDENAR ALFABETICAMENTE
                const conveniosOrdenados = [...convenios].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                
                // v10.60.6: APENAS opÃ§Ã£o vazia (sem "Particular" hardcoded)
                select.innerHTML = '<option value="">Selecione...</option>';
                
                // Adicionar convÃªnios do pool (jÃ¡ ordenados)
                conveniosOrdenados.forEach(convenio => {
                    const option = document.createElement('option');
                    option.value = convenio.toLowerCase().replace(/\s+/g, '_');
                    option.textContent = convenio;
                    select.appendChild(option);
                });
            },

            // v10.53: Completar cadastro de paciente prÃ©-cadastrado
            completarCadastro(id) {
                console.log('ğŸ”„ [COMPLETAR] Abrindo cadastro completo para paciente:', id);
                
                // Abrir modal de ediÃ§Ã£o completo
                this.abrirModal(id);
                
                // Remover flag de prÃ©-cadastro ao salvar
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === id);
                if (paciente) {
                    // Apenas sinalizar que o cadastro serÃ¡ completado
                    Sistema.notificar('ğŸ“ Complete os dados do paciente e salve', 'info');
                }
            },

            abrirModal(id = null) {
                // v10: Carregar convÃªnios do pool
                this.carregarConvenios();
                
                // v10.5: Carregar select de deletar
                this.carregarSelectDeletarConvenios();
                
                // âœ… v10.58: Carregar modalidades disponÃ­veis
                this.carregarModalidades();
                
                if (id) {
                    const pac = SistemaCore.dados.pacientes.find(p => p.id === id);
                    if (!pac) return;
                    
                    document.getElementById('tituloModalPaciente').textContent = 'âœï¸ Editar Paciente';
                    document.getElementById('edit-paciente-id').value = pac.id;
                    
                    // Dados Pessoais
                    document.getElementById('pac-nome').value = pac.nome;
                    if (document.getElementById('pac-nome-social')) {
                        document.getElementById('pac-nome-social').value = pac.nome_social || ''; // v10.346
                    }
                    // v10.463: Sempre chamar selecionarSexo, mesmo se vazio
                    this.selecionarSexo(pac.sexo || '');
                    document.getElementById('pac-cpf').value = pac.cpf || '';
                    document.getElementById('pac-rg').value = pac.rg || '';
                    document.getElementById('pac-nascimento').value = pac.nascimento || '';
                    if (pac.nascimento) this.atualizarDisplayIdade();
                    
                    // âœ… NOVOS CAMPOS v10.6:
                    document.getElementById('pac-cns').value = pac.cns || '';
                    document.getElementById('pac-cor-raca').value = pac.cor_raca || '';
                    document.getElementById('pac-estado-civil').value = pac.estado_civil || '';
                    document.getElementById('pac-naturalidade').value = pac.naturalidade || '';
                    document.getElementById('pac-nome-mae').value = pac.nome_mae || '';
                    document.getElementById('pac-nome-pai').value = pac.nome_pai || '';

                    // âœ… NOVOS CAMPOS v10.7:
                    document.getElementById('pac-profissao').value = pac.profissao || '';
                    document.getElementById('pac-situacao-vinculo').value = pac.situacao_vinculo || '';
                    document.getElementById('pac-dados-adicionais').value = pac.dados_adicionais || '';
                    document.getElementById('pac-tipo-contato').value = pac.tipo_contato || 'direto';
                    document.getElementById('pac-comentario-contato').value = pac.comentario_contato || '';
                    document.getElementById('pac-estrangeiro').checked = pac.estrangeiro || false;
                    document.getElementById('pac-sem-endereco-fixo').checked = pac.sem_endereco_fixo || false;
                    document.getElementById('pac-pais').value = pac.pais || '';
                    document.getElementById('pac-tipo-logradouro').value = pac.tipo_logradouro || '';
                    
                    // âœ… v10.8: NOVOS CAMPOS DE DOCUMENTOS
                    document.getElementById('pac-estrangeiro-doc').checked = pac.estrangeiro_doc || false;
                    document.getElementById('pac-doc-provisorio').checked = pac.documento_provisorio || false;
                    document.getElementById('pac-passaporte').value = pac.passaporte || '';
                    document.getElementById('pac-rne').value = pac.rne || '';
                    document.getElementById('pac-prontuario').value = pac.prontuario || '';
                    
                    // Carregar ID temporÃ¡rio se provisÃ³rio
                    if (pac.documento_provisorio && pac.numero_documento) {
                        document.getElementById('pac-id-temp').textContent = pac.numero_documento;
                    }
                    
                    // Atualizar toggles
                    this.toggleComentarioContato();
                    this.togglePaisEstrangeiro();
                    this.toggleTipoDocumento();  // âœ… v10.8
                    this.toggleCNS();  // âœ… v10.8

                    // Contato
                    document.getElementById('pac-telefone').value = pac.telefone || '';
                    document.getElementById('pac-celular').value = pac.celular || '';
                    document.getElementById('pac-email').value = pac.email || '';
                    document.getElementById('pac-contato-emergencia-nome').value = pac.contato_emergencia_nome || '';
                    document.getElementById('pac-contato-emergencia-parentesco').value = pac.contato_emergencia_parentesco || '';
                    document.getElementById('pac-telefone-emergencia').value = pac.telefone_emergencia || '';

                    // EndereÃ§o
                    document.getElementById('pac-cep').value = pac.cep || '';
                    document.getElementById('pac-logradouro').value = pac.logradouro || '';
                    document.getElementById('pac-numero').value = pac.numero || '';
                    document.getElementById('pac-complemento').value = pac.complemento || '';
                    document.getElementById('pac-bairro').value = pac.bairro || '';
                    document.getElementById('pac-cidade').value = pac.cidade || '';
                    document.getElementById('pac-estado').value = pac.estado || '';
                    
                    // v10.39: Popular dropdown de Regional de SaÃºde
                    this.popularDropdownRegionais();
                    document.getElementById('pac-regional-saude').value = pac.regional_saude || '';

                    // Dados MÃ©dicos
                    document.getElementById('pac-tipo-sanguineo').value = pac.tipo_sanguineo || '';
                    document.getElementById('pac-alergias').value = pac.alergias || '';
                    document.getElementById('pac-convenio').value = pac.convenio || '';
                    document.getElementById('pac-num-carteirinha').value = pac.num_carteirinha || '';
                    document.getElementById('pac-validade-plano').value = pac.validade_plano || '';
                    document.getElementById('pac-observacoes').value = pac.observacoes || '';
                    
                    // âœ… v10.58: Carregar modalidade principal
                    const modalidade = pac.modalidade_principal || 'particular';
                    const radioModalidade = document.querySelector(`input[name="pac-modalidade"][value="${modalidade}"]`);
                    if (radioModalidade) {
                        radioModalidade.checked = true;
                    }
                } else {
                    document.getElementById('tituloModalPaciente').textContent = 'â• Novo Paciente';
                    document.getElementById('edit-paciente-id').value = '';
                    
                    // v10.39: Popular dropdown de Regional de SaÃºde
                    this.popularDropdownRegionais();
                    
                    // Limpar todos os campos
                    document.querySelectorAll('#modalPaciente input, #modalPaciente select, #modalPaciente textarea').forEach(field => {
                        if (field.type !== 'hidden' && field.id !== 'pac-estado') {
                            field.value = '';
                        }
                        if (field.type === 'checkbox') {
                            field.checked = false;
                        }
                    });
                    document.querySelectorAll('.sexo-option').forEach(opt => opt.classList.remove('selected'));
                    document.getElementById('pac-idade-info').style.display = 'none';
                    document.getElementById('pac-estado').value = '';
                    
                    // âœ… v10.8: Resetar visualizaÃ§Ã£o de documentos
                    document.getElementById('pac-id-provisorio-container').style.display = 'none';
                    document.getElementById('pac-cns-group').style.display = 'none';
                }

                // Voltar para primeira aba
                document.querySelectorAll('.form-tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.form-tab-content').forEach(content => content.classList.remove('active'));
                document.querySelectorAll('.form-tab')[0].classList.add('active');
                document.getElementById('aba-dados-pessoais').classList.add('active');

                document.getElementById('modalPaciente').classList.add('active');
            },

            fecharModal() {
                document.getElementById('modalPaciente').classList.remove('active');
                
                // v10.99: CORREÃ‡ÃƒO - Recarregar calendÃ¡rio se estiver na Agenda
                // Isso garante que os botÃµes sejam atualizados apÃ³s completar cadastro
                const agendaAtiva = document.getElementById('telaAgenda')?.classList.contains('active');
                if (agendaAtiva && typeof Calendario !== 'undefined' && Calendario.renderizar) {
                    // Pequeno delay para garantir que o modal fechou completamente
                    setTimeout(() => {
                        Calendario.renderizar();
                    }, 100);
                }
            },

            atualizarDisplayIdade() {
                const nascimento = document.getElementById('pac-nascimento').value;
                if (!nascimento) {
                    document.getElementById('pac-idade-info').style.display = 'none';
                    return;
                }

                const idade = this.calcularIdade(nascimento);
                const categoria = this.obterCategoriaEtaria(nascimento);

                document.getElementById('pac-idade-display').textContent = `${idade} anos`;
                document.getElementById('pac-categoria-display').textContent = categoria.nome;
                document.getElementById('pac-categoria-display').style.background = categoria.cor;
                document.getElementById('pac-idade-info').style.display = 'block';
            },

            salvar() {
                console.log('ğŸ” [DEBUG] FunÃ§Ã£o salvar() chamada');
                
                // Dados Pessoais
                const nome = document.getElementById('pac-nome').value.trim();
                const nome_social = document.getElementById('pac-nome-social')?.value.trim() || ''; // v10.346
                const sexo = document.getElementById('pac-sexo').value;
                const nascimento = document.getElementById('pac-nascimento').value;
                
                // âœ… v10.8: NOVOS CAMPOS DE DOCUMENTOS
                const estrangeiroDoc = document.getElementById('pac-estrangeiro-doc').checked;
                const docProvisorio = document.getElementById('pac-doc-provisorio').checked;
                const cpf = document.getElementById('pac-cpf').value.trim();
                const passaporte = document.getElementById('pac-passaporte').value.trim();
                const rne = document.getElementById('pac-rne').value.trim();
                const rg = document.getElementById('pac-rg').value.trim();
                
                // âœ… NOVOS CAMPOS v10.6:
                const cns = document.getElementById('pac-cns').value.trim();
                const cor_raca = document.getElementById('pac-cor-raca').value;
                const estado_civil = document.getElementById('pac-estado-civil').value;
                const naturalidade = document.getElementById('pac-naturalidade').value.trim();
                const nome_mae = document.getElementById('pac-nome-mae').value.trim();
                const nome_pai = document.getElementById('pac-nome-pai').value.trim();

                // âœ… NOVOS CAMPOS v10.7:
                const profissao = document.getElementById('pac-profissao').value.trim();
                const situacao_vinculo = document.getElementById('pac-situacao-vinculo').value;
                const dados_adicionais = document.getElementById('pac-dados-adicionais').value.trim();
                const tipo_contato = document.getElementById('pac-tipo-contato').value;
                const comentario_contato = document.getElementById('pac-comentario-contato').value.trim();
                const estrangeiro = document.getElementById('pac-estrangeiro').checked;
                const sem_endereco_fixo = document.getElementById('pac-sem-endereco-fixo').checked;
                const pais = document.getElementById('pac-pais').value.trim();
                const tipo_logradouro = document.getElementById('pac-tipo-logradouro').value;

                console.log('ğŸ” [DEBUG] Dados coletados:', { nome, sexo, docProvisorio, estrangeiroDoc, cpf, passaporte, rne });

                // ValidaÃ§Ãµes BÃ¡sicas
                if (!nome) {
                    Sistema.notificar('Preencha o nome do paciente!', 'error');
                    return;
                }
                if (!sexo) {
                    Sistema.notificar('Selecione o sexo do paciente!', 'error');
                    return;
                }
                if (!nascimento) {
                    Sistema.notificar('Preencha a data de nascimento!', 'error');
                    return;
                }
                
                // âœ… v10.8: VALIDAÃ‡ÃƒO DE DOCUMENTOS
                let tipo_documento, numero_documento;
                const editId = document.getElementById('edit-paciente-id').value;
                
                if (docProvisorio) {
                    // DOCUMENTO PROVISÃ“RIO (NÃƒO IDENTIFICADO)
                    tipo_documento = 'provisorio';
                    numero_documento = document.getElementById('pac-id-temp').textContent;
                    
                    if (!numero_documento) {
                        // Gerar novo ID temporÃ¡rio se nÃ£o existe
                        numero_documento = this.gerarIdTemporario();
                    }
                    
                } else if (estrangeiroDoc) {
                    // ESTRANGEIRO - Precisa de Passaporte OU RNE
                    if (!passaporte && !rne) {
                        Sistema.notificar('Estrangeiros precisam informar Passaporte ou RNE!', 'error');
                        return;
                    }
                    
                    if (passaporte) {
                        tipo_documento = 'passaporte';
                        numero_documento = passaporte;
                    } else {
                        tipo_documento = 'rne';
                        numero_documento = rne;
                    }
                    
                    // Verificar duplicidade de passaporte/RNE
                    const docExiste = SistemaCore.dados.pacientes.find(p => {
                        if (editId && p.id === parseInt(editId)) return false;
                        return (p.passaporte === passaporte && passaporte) || 
                               (p.rne === rne && rne);
                    });
                    if (docExiste) {
                        Sistema.notificar(`âŒ Documento jÃ¡ cadastrado para: ${docExiste.nome}`, 'error');
                        return;
                    }
                    
                } else {
                    // BRASILEIRO - Precisa de CPF
                    if (!cpf) {
                        Sistema.notificar('CPF Ã© obrigatÃ³rio para brasileiros!', 'error');
                        return;
                    }
                    
                    tipo_documento = 'cpf';
                    numero_documento = cpf;
                    
                    // Verificar duplicidade de CPF
                    const cpfExiste = SistemaCore.dados.pacientes.find(p => {
                        if (editId && p.id === parseInt(editId)) return false;
                        return p.cpf === cpf;
                    });
                    if (cpfExiste) {
                        Sistema.notificar(`âŒ CPF jÃ¡ cadastrado para: ${cpfExiste.nome}`, 'error');
                        return;
                    }
                }

                console.log('ğŸ” [DEBUG] ValidaÃ§Ãµes de documento passaram:', { tipo_documento, numero_documento });

                // Contato
                const telefone = document.getElementById('pac-telefone').value.trim();
                const celular = document.getElementById('pac-celular').value.trim();
                const email = document.getElementById('pac-email').value.trim();
                const contato_emergencia_nome = document.getElementById('pac-contato-emergencia-nome').value.trim();
                const contato_emergencia_parentesco = document.getElementById('pac-contato-emergencia-parentesco').value.trim();
                const telefone_emergencia = document.getElementById('pac-telefone-emergencia').value.trim();

                if (!telefone) {
                    Sistema.notificar('Preencha o telefone principal!', 'error');
                    return;
                }

                // EndereÃ§o
                const cep = document.getElementById('pac-cep').value.trim();
                const logradouro = document.getElementById('pac-logradouro').value.trim();
                const numero = document.getElementById('pac-numero').value.trim();
                const complemento = document.getElementById('pac-complemento').value.trim();
                const bairro = document.getElementById('pac-bairro').value.trim();
                const cidade = document.getElementById('pac-cidade').value.trim();
                const estado = document.getElementById('pac-estado').value;
                const regional_saude = document.getElementById('pac-regional-saude').value;

                // Dados MÃ©dicos
                const tipo_sanguineo = document.getElementById('pac-tipo-sanguineo').value;
                const alergias = document.getElementById('pac-alergias').value.trim();
                const convenio = document.getElementById('pac-convenio').value;
                const num_carteirinha = document.getElementById('pac-num-carteirinha').value.trim();
                const validade_plano = document.getElementById('pac-validade-plano').value;
                const observacoes = document.getElementById('pac-observacoes').value.trim();
                
                // âœ… v10.58: MODALIDADE PRINCIPAL
                const radioModalidade = document.querySelector('input[name="pac-modalidade"]:checked');
                if (!radioModalidade) {
                    Sistema.notificar('Selecione a modalidade de atendimento!', 'error');
                    return;
                }
                const modalidade_principal = radioModalidade.value;
                
                // v10.60.6: VALIDAÃ‡ÃƒO CONDICIONAL - Campos obrigatÃ³rios somente se modalidade = "convenio"
                if (modalidade_principal === 'convenio') {
                    if (!convenio || convenio === '') {
                        Sistema.notificar('Selecione o convÃªnio! (obrigatÃ³rio para modalidade ConvÃªnio)', 'error');
                        return;
                    }
                    if (!num_carteirinha || num_carteirinha.trim() === '') {
                        Sistema.notificar('Informe o nÃºmero da carteirinha! (obrigatÃ³rio para modalidade ConvÃªnio)', 'error');
                        return;
                    }
                    if (!validade_plano || validade_plano === '') {
                        Sistema.notificar('Informe a validade do plano! (obrigatÃ³ria para modalidade ConvÃªnio)', 'error');
                        return;
                    }
                }
                
                // v10.60.6: DEBUG - Verificar modalidades configuradas
                const modalidadesEstab = SistemaCore.dados.estabelecimento?.modalidades || {};
                console.log('ğŸ” [DEBUG] Modalidade selecionada:', modalidade_principal);
                console.log('ğŸ” [DEBUG] Modalidades do estabelecimento:', modalidadesEstab);
                console.log('ğŸ” [DEBUG] Modalidade aceita?', modalidadesEstab[modalidade_principal]);
                
                // Validar se modalidade Ã© aceita pelo estabelecimento
                if (!modalidadesEstab[modalidade_principal] && modalidadesEstab[modalidade_principal] !== undefined) {
                    Sistema.notificar('âŒ Esta modalidade nÃ£o Ã© aceita pelo estabelecimento!', 'error');
                    console.error('âŒ Modalidade rejeitada:', modalidade_principal);
                    return;
                }
                
                // Se nÃ£o hÃ¡ modalidades configuradas, aceitar qualquer uma (modo legado)
                if (Object.keys(modalidadesEstab).length === 0) {
                    console.warn('âš ï¸ Nenhuma modalidade configurada - aceitando todas');
                }

                // âœ… v10.8: GERAR NÃšMERO DE PRONTUÃRIO
                let prontuario = '';
                if (!editId) {
                    // Novo paciente - gerar prontuÃ¡rio
                    prontuario = this.gerarNumeroProntuario();
                    console.log('âœ… [DEBUG] ProntuÃ¡rio gerado (novo):', prontuario);
                } else {
                    // Editando paciente existente
                    const pacExistente = SistemaCore.dados.pacientes.find(p => p.id === parseInt(editId));
                    
                    if (pacExistente) {
                        // v10.463: Se estÃ¡ completando um prÃ©-cadastro (PRE- ou sem prontuÃ¡rio), gerar prontuÃ¡rio definitivo
                        const prontuarioAtual = pacExistente.prontuario || '';
                        const ehPreCadastro = prontuarioAtual.startsWith('PRE-') || prontuarioAtual.startsWith('NI-') || !prontuarioAtual;
                        const eraIncompleto = pacExistente.cadastro_completo === false;
                        
                        if (ehPreCadastro && eraIncompleto) {
                            // Completando cadastro - gerar prontuÃ¡rio definitivo
                            prontuario = this.gerarNumeroProntuario();
                            console.log('âœ… [DEBUG] ProntuÃ¡rio definitivo gerado (completou cadastro):', prontuario, '(era:', prontuarioAtual, ')');
                        } else {
                            // Manter prontuÃ¡rio existente
                            prontuario = prontuarioAtual;
                            console.log('âœ… [DEBUG] ProntuÃ¡rio mantido:', prontuario);
                        }
                    }
                }

                const dadosPaciente = {
                    nome, sexo, nascimento,
                    nome_social: nome_social || '', // v10.346: Nome Social (FHEMIG)
                    // âœ… v10.8: DOCUMENTOS
                    tipo_documento,
                    numero_documento,
                    cpf: cpf || '',
                    passaporte: passaporte || '',
                    rne: rne || '',
                    rg: rg || '',
                    estrangeiro_doc: estrangeiroDoc || false,
                    documento_provisorio: docProvisorio || false,
                    prontuario: prontuario,
                    // âœ… NOVOS CAMPOS v10.6:
                    cns: cns || '',
                    cor_raca: cor_raca || '',
                    estado_civil: estado_civil || '',
                    naturalidade: naturalidade || '',
                    nome_mae: nome_mae || '',
                    nome_pai: nome_pai || '',
                    // âœ… NOVOS CAMPOS v10.7:
                    profissao: profissao || '',
                    situacao_vinculo: situacao_vinculo || '',
                    dados_adicionais: dados_adicionais || '',
                    tipo_contato: tipo_contato || 'direto',
                    comentario_contato: comentario_contato || '',
                    estrangeiro: estrangeiro || false,
                    sem_endereco_fixo: sem_endereco_fixo || false,
                    pais: pais || '',
                    tipo_logradouro: tipo_logradouro || '',
                    // âœ… v10.58: MODALIDADE PRINCIPAL
                    modalidade_principal: modalidade_principal,
                    // Campos existentes:
                    telefone, celular, email,
                    contato_emergencia_nome, contato_emergencia_parentesco, telefone_emergencia,
                    cep, logradouro, numero, complemento, bairro, cidade, estado,
                    regional_saude: regional_saude || '',
                    tipo_sanguineo, alergias, convenio, num_carteirinha, validade_plano, observacoes,
                    // v10.54: CADASTRO COMPLETO (pode atender)
                    cadastro_completo: true,
                    data_cadastro: new Date().toISOString().split('T')[0]
                };

                console.log('ğŸ” [DEBUG] Dados do paciente:', dadosPaciente);

                if (editId) {
                    console.log('ğŸ” [DEBUG] Modo EDIÃ‡ÃƒO, ID:', editId);
                    const pac = SistemaCore.dados.pacientes.find(p => p.id === parseInt(editId));
                    if (pac) {
                        // v10.54: Se estava com cadastro incompleto, notificar que foi completado
                        // v10.463: Guardar valor ANTES de sobrescrever
                        window._eraIncompleto = pac.cadastro_completo === false;
                        Object.assign(pac, dadosPaciente);
                        if (window._eraIncompleto) {
                            console.log('âœ… [CADASTRO] Cadastro completado para:', pac.nome);
                        }
                        console.log('âœ… [DEBUG] Paciente atualizado');
                    }
                } else {
                    console.log('ğŸ” [DEBUG] Modo NOVO paciente');
                    dadosPaciente.id = SistemaCore.proximoId(SistemaCore.dados.pacientes);
                    SistemaCore.dados.pacientes.push(dadosPaciente);
                    console.log('âœ… [DEBUG] Paciente adicionado com ID:', dadosPaciente.id);
                    window._eraIncompleto = false;
                }

                // v10.60.6: REMOVIDO - AlimentaÃ§Ã£o bidirecional causava adiÃ§Ã£o indevida de "Particular" ao pool
                // ConvÃªnios agora sÃ£o gerenciados SOMENTE no pool centralizado (Estabelecimento)

                console.log('ğŸ” [DEBUG] Salvando no LocalStorage...');
                SistemaCore.salvar();
                console.log('âœ… [DEBUG] Salvo com sucesso!');
                
                // v10.463: SINCRONIZAR NOME DO PACIENTE EM ENTRADAS E ATENDIMENTOS
                // Quando "NÃ£o Identificado" Ã© atualizado, refletir na fila, hoje e histÃ³rico
                const pacienteId = editId ? parseInt(editId) : dadosPaciente.id;
                this.sincronizarNomePaciente(pacienteId, nome);
                
                // v10.463: Usar valor calculado ANTES do Object.assign
                const eraIncompleto = window._eraIncompleto || false;
                
                // v10.99: DISPARAR EVENTO para sistemas que precisam reagir (Agenda/CalendÃ¡rio)
                const evento = new CustomEvent('pacienteSalvo', { 
                    detail: { 
                        pacienteId: editId ? parseInt(editId) : dadosPaciente.id,
                        eraIncompleto: eraIncompleto
                    } 
                });
                window.dispatchEvent(evento);
                console.log('âœ… [EVENTO] pacienteSalvo disparado, eraIncompleto:', eraIncompleto);
                
                // v10.58: Se veio de Atendimentos, selecionar paciente automaticamente
                if (window._cadastrandoPacienteDeAtendimentos) {
                    console.log('âœ… [ATENDIMENTO] Selecionando paciente automaticamente...');
                    
                    // Pegar o ID do paciente (se novo, pegar o que acabou de ser criado)
                    const pacienteId = editId ? parseInt(editId) : dadosPaciente.id;
                    
                    // Fechar modal
                    this.fecharModal();
                    
                    // Trocar para aba Atendimentos
                    Sistema.trocarTab('atendimentos');
                    
                    // Aguardar um momento para o DOM atualizar
                    setTimeout(() => {
                        // v10.448: Marcar que nÃ£o deve notificar na seleÃ§Ã£o (evita duplicata)
                        window._selecionandoSemNotificar = true;
                        // Selecionar o paciente em Atendimentos
                        Atendimentos.selecionarPaciente(pacienteId);
                        window._selecionandoSemNotificar = false;
                        Sistema.notificar(`âœ… Paciente cadastrado e selecionado: ${dadosPaciente.nome}`, 'success');
                    }, 100);
                    
                    // Limpar flag
                    window._cadastrandoPacienteDeAtendimentos = false;
                    
                // v10.463: Se veio da RecepÃ§Ã£o, selecionar paciente na recepÃ§Ã£o
                } else if (window._retornarParaRecepcao) {
                    console.log('âœ… [RECEPCAO] Retornando e selecionando paciente...');
                    
                    const pacienteId = editId ? parseInt(editId) : dadosPaciente.id;
                    
                    this.fecharModal();
                    Sistema.trocarTab('atendimentos');
                    
                    setTimeout(() => {
                        Atendimentos.trocarAba('recepcao');
                        setTimeout(() => {
                            Atendimentos.selecionarPacienteRecepcao(pacienteId);
                            Sistema.notificar(`âœ… Paciente cadastrado: ${dadosPaciente.nome}`, 'success');
                        }, 100);
                    }, 100);
                    
                    window._retornarParaRecepcao = false;
                    
                } else {
                    // Fluxo normal
                    Pacientes.listar();
                    this.fecharModal();
                    // v10.110: CORRIGIDO - NotificaÃ§Ã£o condicional (evita duplicaÃ§Ã£o)
                    if (eraIncompleto) {
                        Sistema.notificar('âœ… Cadastro completado! Paciente pode ser atendido.', 'success');
                    } else {
                        Sistema.notificar('Paciente salvo com sucesso!');
                    }
                }
                
                console.log('âœ… [DEBUG] Processo completo!');
            },

            editar(id) {
                this.abrirModal(id);
            },
            
            // v10.463: SINCRONIZAR NOME DO PACIENTE EM ENTRADAS E ATENDIMENTOS
            // Quando "NÃ£o Identificado" Ã© atualizado para nome real, refletir em todo o sistema
            sincronizarNomePaciente(pacienteId, novoNome) {
                if (!pacienteId || !novoNome) return;
                
                console.log(`[v10.463] Sincronizando nome para paciente ${pacienteId}: "${novoNome}"`);
                
                let entradasAtualizadas = 0;
                let atendimentosAtualizados = 0;
                
                // Atualizar ENTRADAS
                (SistemaCore.dados.entradas || []).forEach(entrada => {
                    if (entrada.paciente_id === pacienteId) {
                        // Atualizar nome no objeto paciente embutido
                        if (entrada.paciente) {
                            entrada.paciente.nome = novoNome;
                        }
                        // Atualizar paciente_nome (campo direto)
                        entrada.paciente_nome = novoNome;
                        entradasAtualizadas++;
                        console.log(`  â†’ Entrada ${entrada.id} atualizada`);
                    }
                });
                
                // Atualizar ATENDIMENTOS
                (SistemaCore.dados.atendimentos || []).forEach(atendimento => {
                    if (atendimento.paciente_id === pacienteId) {
                        atendimento.paciente_nome = novoNome;
                        atendimentosAtualizados++;
                        console.log(`  â†’ Atendimento ${atendimento.id} atualizado`);
                    }
                });
                
                // Salvar dados atualizados
                if (entradasAtualizadas > 0 || atendimentosAtualizados > 0) {
                    SistemaCore.salvar();
                    console.log(`âœ… [SYNC] Nome "${novoNome}" sincronizado: ${entradasAtualizadas} entradas, ${atendimentosAtualizados} atendimentos`);
                } else {
                    console.log(`â„¹ï¸ [SYNC] Nenhuma entrada/atendimento encontrado para paciente ${pacienteId}`);
                }
                
                // A interface serÃ¡ atualizada pelo evento pacienteSalvo (listener em Atendimentos.init)
            },

            excluir(id) {
                if (!confirm('Deseja excluir este paciente? Esta aÃ§Ã£o nÃ£o pode ser desfeita.')) return;
                SistemaCore.dados.pacientes = SistemaCore.dados.pacientes.filter(p => p.id !== id);
                SistemaCore.salvar();
                this.listar();
                Sistema.notificar('Paciente excluÃ­do!');
            },
            
            // v10.5: Adicionar convÃªnio ao pool
            adicionarConvenioAoPool() {
                const input = document.getElementById('pac-convenio-novo');
                const convenio = input.value.trim();
                
                if (!convenio) {
                    alert('âŒ Digite o nome do convÃªnio!');
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.convenios) {
                    SistemaCore.dados.estabelecimento.convenios = [];
                }
                
                // Verificar se jÃ¡ existe
                const jÃ¡Existe = SistemaCore.dados.estabelecimento.convenios
                    .some(c => c.toLowerCase() === convenio.toLowerCase());
                
                if (jÃ¡Existe) {
                    alert('âš ï¸ Este convÃªnio jÃ¡ existe no pool!');
                    return;
                }
                
                // Adicionar
                SistemaCore.dados.estabelecimento.convenios.push(convenio);
                SistemaCore.salvar();
                
                // Recarregar select e select de deletar
                this.carregarConvenios();
                this.carregarSelectDeletarConvenios();
                
                // Limpar input
                input.value = '';
                
                Sistema.notificar(`âœ… ConvÃªnio "${convenio}" adicionado ao pool!`);
            },
            
            // v10.5: Deletar convÃªnio do pool
            deletarConvenioDoPool() {
                const select = document.getElementById('pac-convenio-deletar-select');
                const convenio = select.value;
                
                if (!convenio) {
                    alert('âš ï¸ Selecione um convÃªnio para deletar!');
                    return;
                }
                
                // Verificar uso
                const uso = this.contarUsoConvenio(convenio);
                
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL DELETAR!\n\n"${convenio}" estÃ¡ sendo usado em ${uso} paciente(s).\n\nâœ… COMO RESOLVER:\n1. Edite cada paciente que usa "${convenio}"\n2. Altere o convÃªnio deles\n3. Depois volte aqui para deletar do pool`);
                    return;
                }
                
                if (!SistemaCore.dados.estabelecimento.convenios) {
                    SistemaCore.dados.estabelecimento.convenios = [];
                }
                
                const index = SistemaCore.dados.estabelecimento.convenios.indexOf(convenio);
                
                if (index === -1) {
                    alert(`âš ï¸ "${convenio}" nÃ£o estÃ¡ no pool!`);
                    return;
                }
                
                if (confirm(`ğŸ—‘ï¸ DELETAR DO POOL?\n\n"${convenio}"\n\nIsso removerÃ¡ permanentemente este convÃªnio do sistema.`)) {
                    SistemaCore.dados.estabelecimento.convenios.splice(index, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… ConvÃªnio removido do pool!');
                    
                    // Recarregar select e select de deletar
                    this.carregarConvenios();
                    this.carregarSelectDeletarConvenios();
                }
            },
            
            // v10.5: Contar uso de convÃªnio
            contarUsoConvenio(convenio) {
                let contador = 0;
                if (SistemaCore.dados.pacientes) {
                    SistemaCore.dados.pacientes.forEach(p => {
                        if (p.convenio === convenio) contador++;
                    });
                }
                return contador;
            },
            
            // v10.5: Carregar select de deletar convÃªnios
            carregarSelectDeletarConvenios() {
                const select = document.getElementById('pac-convenio-deletar-select');
                
                // v10.60.4: VerificaÃ§Ã£o de seguranÃ§a
                if (!select) {
                    console.warn('Elemento pac-convenio-deletar-select nÃ£o encontrado');
                    return;
                }
                
                const convenios = SistemaCore.dados.estabelecimento.convenios || [];
                
                select.innerHTML = '<option value="">Selecione para deletar...</option>';
                
                const conveniosOrdenados = [...convenios].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                
                conveniosOrdenados.forEach(convenio => {
                    const uso = this.contarUsoConvenio(convenio);
                    const option = document.createElement('option');
                    option.value = convenio;
                    option.textContent = uso > 0 ? `${convenio} (${uso})` : convenio;
                    select.appendChild(option);
                });
            },
            
            // v10.41: Criar paciente teste para desenvolvimento
            criarPacienteTeste() {
                // Verificar se jÃ¡ existe paciente teste
                const pacienteTeste = SistemaCore.dados.pacientes.find(p => p.cpf === '000.000.000-00');
                if (pacienteTeste) {
                    console.log('âœ… Paciente teste jÃ¡ existe (ID: ' + pacienteTeste.id + ')');
                    return;
                }
                
                // Criar paciente teste completo
                const dadosPacienteTeste = {
                    id: SistemaCore.proximoId(SistemaCore.dados.pacientes),
                    nome: 'JoÃ£o da Silva Teste',
                    sexo: 'M',
                    nascimento: '1985-03-15',
                    tipo_documento: 'cpf',
                    numero_documento: '000.000.000-00',
                    cpf: '000.000.000-00',
                    rg: '00.000.000-0',
                    passaporte: '',
                    rne: '',
                    estrangeiro_doc: false,
                    documento_provisorio: false,
                    prontuario: this.gerarNumeroProntuario(),
                    cns: '123 4567 8901 2345',
                    cor_raca: 'parda',
                    estado_civil: 'casado',
                    naturalidade: 'Belo Horizonte/MG',
                    nome_mae: 'Maria da Silva',
                    nome_pai: 'JosÃ© da Silva',
                    profissao: 'Engenheiro',
                    situacao_vinculo: 'empregado',
                    dados_adicionais: 'Paciente teste para desenvolvimento do sistema',
                    tipo_contato: 'direto',
                    comentario_contato: '',
                    estrangeiro: false,
                    sem_endereco_fixo: false,
                    pais: '',
                    tipo_logradouro: 'Rua',
                    telefone: '(31) 3333-4444',
                    celular: '(31) 98765-4321',
                    email: 'joao.teste@exemplo.com.br',
                    contato_emergencia_nome: 'Maria da Silva Teste',
                    contato_emergencia_parentesco: 'Esposa',
                    telefone_emergencia: '(31) 99999-8888',
                    cep: '30130-100',
                    logradouro: 'Avenida Afonso Pena',
                    numero: '1500',
                    complemento: 'Apto 101',
                    bairro: 'Centro',
                    cidade: 'Belo Horizonte',
                    estado: 'MG',
                    regional_saude: 'Regional Centro',
                    tipo_sanguineo: 'O+',
                    alergias: 'Dipirona, Penicilina',
                    convenio: 'SUS',
                    num_carteirinha: '123456789012345',
                    validade_plano: '2025-12-31',
                    observacoes: 'ğŸ§ª PACIENTE TESTE - Criado automaticamente para facilitar testes do sistema de prontuÃ¡rio. ContÃ©m dados fictÃ­cios completos para visualizaÃ§Ã£o de todas as funcionalidades.'
                };
                
                SistemaCore.dados.pacientes.push(dadosPacienteTeste);
                SistemaCore.salvar();
                
                console.log('âœ… Paciente teste criado com sucesso!');
                console.log('   Nome: JoÃ£o da Silva Teste');
                console.log('   CPF: 000.000.000-00');
                console.log('   ProntuÃ¡rio: ' + dadosPacienteTeste.prontuario);
                console.log('   ID: ' + dadosPacienteTeste.id);
            },
            
            // v10.85: NOVA - Excluir paciente com validaÃ§Ãµes
            excluir(id) {
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === id);
                if (!paciente) {
                    Sistema.notificar('âŒ Paciente nÃ£o encontrado!', 'error');
                    return;
                }
                
                console.log(`ğŸ—‘ï¸ [EXCLUIR] Verificando vÃ­nculos do paciente ${id} (${paciente.nome})`);
                
                // Verificar se paciente tem agendamentos
                const agendamentos = SistemaCore.dados.agendamentos?.filter(a => a.paciente_id === id) || [];
                if (agendamentos.length > 0) {
                    Sistema.notificar(
                        `âŒ NÃ£o Ã© possÃ­vel excluir!\n\n` +
                        `Este paciente possui ${agendamentos.length} agendamento(s).\n\n` +
                        `Para excluir, primeiro remova os agendamentos vinculados.`,
                        'error'
                    );
                    return;
                }
                
                // Verificar se paciente tem reservas ativas
                const reservas = SistemaCore.dados.reparticoes?.filter(r => 
                    r.status === 'reservado' && r.paciente_ocupante_id === id
                ) || [];
                if (reservas.length > 0) {
                    Sistema.notificar(
                        `âŒ NÃ£o Ã© possÃ­vel excluir!\n\n` +
                        `Este paciente possui ${reservas.length} reserva(s) ativa(s).\n\n` +
                        `Para excluir, primeiro cancele as reservas vinculadas.`,
                        'error'
                    );
                    return;
                }
                
                // Verificar se paciente estÃ¡ internado
                const internacoes = SistemaCore.dados.reparticoes?.filter(r => 
                    r.status === 'ocupado' && r.paciente_ocupante_id === id
                ) || [];
                if (internacoes.length > 0) {
                    Sistema.notificar(
                        `âŒ NÃ£o Ã© possÃ­vel excluir!\n\n` +
                        `Este paciente estÃ¡ INTERNADO em ${internacoes.length} unidade(s).\n\n` +
                        `Para excluir, primeiro finalize a(s) internaÃ§Ã£o(Ãµes).`,
                        'error'
                    );
                    return;
                }
                
                // Verificar se paciente tem folhas de rosto (entradas)
                const entradas = SistemaCore.dados.entradas?.filter(e => e.paciente_id === id) || [];
                if (entradas.length > 0) {
                    const msg = confirm(
                        `âš ï¸ ATENÃ‡ÃƒO!\n\n` +
                        `Este paciente possui ${entradas.length} entrada(s) registrada(s) (Folha de Rosto).\n\n` +
                        `Deseja excluir o paciente E todas as entradas vinculadas?\n\n` +
                        `Esta aÃ§Ã£o NÃƒO PODE ser desfeita!`
                    );
                    
                    if (!msg) return;
                    
                    // Excluir entradas vinculadas
                    SistemaCore.dados.entradas = SistemaCore.dados.entradas.filter(e => e.paciente_id !== id);
                    console.log(`ğŸ—‘ï¸ [EXCLUIR] ${entradas.length} entrada(s) removida(s)`);
                }
                
                // ConfirmaÃ§Ã£o final
                const confirmar = confirm(
                    `âš ï¸ Confirmar exclusÃ£o?\n\n` +
                    `Paciente: ${paciente.nome}\n` +
                    `CPF: ${paciente.cpf || 'NÃ£o informado'}\n` +
                    `ProntuÃ¡rio: ${paciente.prontuario || 'NÃ£o gerado'}\n\n` +
                    `Esta aÃ§Ã£o NÃƒO PODE ser desfeita!`
                );
                
                if (!confirmar) return;
                
                // Excluir paciente
                const index = SistemaCore.dados.pacientes.findIndex(p => p.id === id);
                SistemaCore.dados.pacientes.splice(index, 1);
                SistemaCore.salvar();
                
                console.log(`âœ… [EXCLUIR] Paciente ${id} excluÃ­do com sucesso`);
                Sistema.notificar('âœ… Paciente excluÃ­do com sucesso!', 'success');
                
                // Atualizar listagem
                this.listar();
            }
        };

        /* ============================================================
           [FOLHA DE ROSTO] MÃ³dulo Folha de Rosto - v10.6
           ============================================================ */
        
        const FolhaRosto = {
            init() {
                console.log('ğŸ“‹ [FR] MÃ³dulo Folha de Rosto inicializado');
            },
            
            abrirModal() {
                // Gerar nÃºmero de registro
                const numeroRegistro = SistemaCore.gerarNumeroRegistro();
                document.getElementById('fr-numero-registro').textContent = numeroRegistro;
                
                // Resetar campos
                document.getElementById('fr-id').value = '';
                document.getElementById('fr-nao-identificado').checked = false;
                document.getElementById('fr-foi-internado').checked = false;
                
                // Carregar pacientes
                this.carregarPacientes();
                
                // Carregar leitos disponÃ­veis
                this.carregarLeitos();
                
                // Resetar formulÃ¡rio
                document.getElementById('fr-local-entrada').value = '';
                document.getElementById('fr-tipo-entrada').value = '';
                document.getElementById('fr-meio-chegada').value = '';
                document.getElementById('fr-numero-senha').value = ''; // âœ… v10.7
                document.getElementById('fr-classificacao-risco').value = '';
                document.getElementById('fr-paciente-id').value = '';
                document.getElementById('fr-motivo').value = '';
                document.getElementById('fr-queixa').value = '';
                document.getElementById('fr-acompanhante-nome').value = '';
                document.getElementById('fr-acompanhante-parentesco').value = '';
                document.getElementById('fr-acompanhante-telefone').value = '';
                document.getElementById('fr-data-internacao').value = '';
                document.getElementById('fr-leito').value = '';
                document.getElementById('fr-motivo-internacao').value = '';
                
                // Mostrar campos
                document.getElementById('fr-campos-paciente').style.display = 'block';
                document.getElementById('fr-dados-paciente').style.display = 'none';
                document.getElementById('fr-campos-internacao').style.display = 'none';
                
                // Abrir modal
                document.getElementById('modalFolhaRosto').classList.add('active');
            },
            
            fecharModal() {
                document.getElementById('modalFolhaRosto').classList.remove('active');
            },
            
            carregarPacientes() {
                const select = document.getElementById('fr-paciente-select');
                const pacientes = SistemaCore.dados.pacientes || [];
                
                // Ordenar por nome
                const pacientesOrdenados = [...pacientes].sort((a, b) => 
                    a.nome.localeCompare(b.nome, 'pt-BR')
                );
                
                select.innerHTML = '<option value="">Selecione um paciente...</option>';
                
                pacientesOrdenados.forEach(pac => {
                    const option = document.createElement('option');
                    option.value = pac.id;
                    option.textContent = `${pac.nome} - CPF: ${pac.cpf || 'NÃ£o informado'}`;
                    select.appendChild(option);
                });
            },
            
            carregarLeitos() {
                const select = document.getElementById('fr-leito');
                const leitos = SistemaCore.dados.reparticoes.filter(r => 
                    r.eh_subreparticao && 
                    (r.status === 'livre' || r.status === 'reservado')
                );
                
                select.innerHTML = '<option value="">Selecione o leito...</option>';
                
                leitos.forEach(leito => {
                    const option = document.createElement('option');
                    option.value = leito.id;
                    option.textContent = leito.nome;
                    select.appendChild(option);
                });
            },
            
            selecionarPaciente() {
                const selectPaciente = document.getElementById('fr-paciente-select');
                const pacienteId = parseInt(selectPaciente.value);
                
                if (!pacienteId) {
                    document.getElementById('fr-dados-paciente').style.display = 'none';
                    document.getElementById('fr-paciente-id').value = '';
                    return;
                }
                
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                if (!paciente) return;
                
                // Armazenar ID
                document.getElementById('fr-paciente-id').value = pacienteId;
                
                // Mostrar dados do paciente
                document.getElementById('fr-paciente-cpf').textContent = paciente.cpf || 'NÃ£o informado';
                document.getElementById('fr-paciente-cns').textContent = 
                    paciente.cns ? this.formatarCNS(paciente.cns) : 'NÃ£o informado';
                document.getElementById('fr-paciente-nascimento').textContent = 
                    paciente.nascimento 
                        ? new Date(paciente.nascimento + 'T00:00:00').toLocaleDateString('pt-BR') + 
                          ` (${Pacientes.calcularIdadeDetalhada(paciente.nascimento)})`
                        : 'NÃ£o informado';
                document.getElementById('fr-paciente-sexo').textContent = this.formatarSexo(paciente.sexo);
                document.getElementById('fr-paciente-cor-raca').textContent = this.formatarCorRaca(paciente.cor_raca);
                document.getElementById('fr-paciente-estado-civil').textContent = 
                    paciente.estado_civil 
                        ? paciente.estado_civil.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())
                        : 'NÃ£o informado';
                document.getElementById('fr-paciente-telefone').textContent = paciente.telefone || 'NÃ£o informado';
                document.getElementById('fr-paciente-convenio').textContent = paciente.convenio || 'Particular';
                
                document.getElementById('fr-dados-paciente').style.display = 'block';
            },
            
            togglePacienteNaoIdentificado() {
                const checkbox = document.getElementById('fr-nao-identificado');
                const campos = document.getElementById('fr-campos-paciente');
                const select = document.getElementById('fr-paciente-select');
                
                if (checkbox.checked) {
                    campos.style.display = 'none';
                    select.required = false;
                } else {
                    campos.style.display = 'block';
                    select.required = true;
                }
            },
            
            toggleInternacao() {
                const checkbox = document.getElementById('fr-foi-internado');
                const campos = document.getElementById('fr-campos-internacao');
                
                campos.style.display = checkbox.checked ? 'block' : 'none';
            },
            
            salvar(event) {
                event.preventDefault();
                
                // ValidaÃ§Ãµes
                const naoIdentificado = document.getElementById('fr-nao-identificado').checked;
                const pacienteId = document.getElementById('fr-paciente-id').value;
                
                if (!naoIdentificado && !pacienteId) {
                    Sistema.notificar('âŒ Selecione um paciente ou marque como "NÃ£o Identificado"', 'error');
                    return;
                }
                
                const foiInternado = document.getElementById('fr-foi-internado').checked;
                if (foiInternado) {
                    const dataInternacao = document.getElementById('fr-data-internacao').value;
                    const leitoId = document.getElementById('fr-leito').value;
                    
                    if (!dataInternacao || !leitoId) {
                        Sistema.notificar('âŒ Preencha data/hora e leito da internaÃ§Ã£o', 'error');
                        return;
                    }
                }
                
                // Montar objeto
                const entrada = {
                    id: document.getElementById('fr-id').value 
                        ? parseInt(document.getElementById('fr-id').value)
                        : SistemaCore.proximoId(SistemaCore.dados.entradas),
                    
                    numero_registro: document.getElementById('fr-numero-registro').textContent,
                    
                    // Entrada
                    data_hora_entrada: new Date().toISOString(),
                    local_entrada: document.getElementById('fr-local-entrada').value,
                    tipo_entrada: document.getElementById('fr-tipo-entrada').value,
                    meio_chegada: document.getElementById('fr-meio-chegada').value,
                    numero_senha: document.getElementById('fr-numero-senha').value, // âœ… v10.7
                    classificacao_risco: document.getElementById('fr-classificacao-risco').value,
                    
                    // Paciente
                    paciente_id: naoIdentificado ? null : parseInt(pacienteId),
                    paciente_nao_identificado: naoIdentificado,
                    
                    // Motivo
                    motivo_atendimento: document.getElementById('fr-motivo').value,
                    queixa_principal: document.getElementById('fr-queixa').value,
                    
                    // Acompanhante
                    acompanhante_nome: document.getElementById('fr-acompanhante-nome').value,
                    acompanhante_parentesco: document.getElementById('fr-acompanhante-parentesco').value,
                    acompanhante_telefone: document.getElementById('fr-acompanhante-telefone').value,
                    
                    // InternaÃ§Ã£o
                    foi_internado: foiInternado,
                    data_hora_internacao: foiInternado 
                        ? document.getElementById('fr-data-internacao').value 
                        : null,
                    leito_id: foiInternado 
                        ? parseInt(document.getElementById('fr-leito').value) 
                        : null,
                    motivo_internacao: foiInternado 
                        ? document.getElementById('fr-motivo-internacao').value 
                        : '',
                    
                    // Metadados
                    criado_em: new Date().toISOString(),
                    criado_por: Auth.usuarioAtual ? Auth.usuarioAtual.nome : 'Sistema',
                    status: 'ativo'
                };
                
                // Salvar
                if (!SistemaCore.dados.entradas) {
                    SistemaCore.dados.entradas = [];
                }
                
                const index = SistemaCore.dados.entradas.findIndex(e => e.id === entrada.id);
                if (index >= 0) {
                    SistemaCore.dados.entradas[index] = entrada;
                } else {
                    SistemaCore.dados.entradas.push(entrada);
                }
                
                // Se foi internado, ocupar o leito
                if (foiInternado && entrada.leito_id && entrada.paciente_id) {
                    const leito = SistemaCore.dados.reparticoes.find(r => r.id === entrada.leito_id);
                    if (leito) {
                        leito.status = 'ocupado';
                        leito.paciente_id = entrada.paciente_id;
                        leito.data_ocupacao = entrada.data_hora_internacao;
                        leito.motivo_internacao = entrada.motivo_internacao;
                    }
                }
                
                SistemaCore.salvar();
                
                Sistema.notificar('âœ… Folha de Rosto salva com sucesso!');
                this.fecharModal();
                this.listar();
            },
            
            // FunÃ§Ãµes auxiliares
            calcularIdade(nascimento) {
                if (!nascimento) return '?';
                const hoje = new Date();
                const nasc = new Date(nascimento + 'T00:00:00');
                let idade = hoje.getFullYear() - nasc.getFullYear();
                const m = hoje.getMonth() - nasc.getMonth();
                if (m < 0 || (m === 0 && hoje.getDate() < nasc.getDate())) {
                    idade--;
                }
                return idade;
            },
            
            formatarCNS(cns) {
                if (!cns) return '';
                const limpo = cns.replace(/\D/g, '');
                return limpo.replace(/(\d{3})(\d{4})(\d{4})(\d{4})/, '$1 $2 $3 $4');
            },
            
            formatarSexo(sexo) {
                const mapa = {
                    'M': 'Masculino',
                    'F': 'Feminino',
                    'I': 'Intersexo',
                    'N': 'NÃ£o informado'
                };
                return mapa[sexo] || sexo || 'NÃ£o informado';
            },
            
            formatarCorRaca(cor) {
                if (!cor) return 'NÃ£o informado';
                const mapa = {
                    'branca': 'Branca',
                    'preta': 'Preta',
                    'parda': 'Parda',
                    'amarela': 'Amarela',
                    'indigena': 'IndÃ­gena',
                    'nao_informado': 'NÃ£o informado'
                };
                return mapa[cor] || cor;
            },
            
            listar() {
                // Implementar lista de folhas de rosto
                // Pode ser uma aba no sistema ou integrado com prontuÃ¡rios
                console.log('ğŸ“‹ [FR] Lista de Folhas de Rosto:', SistemaCore.dados.entradas);
            }
        };

        /* ============================================================
           [AGENDA] MÃ³dulo Agenda - Modelo Original
           ============================================================ */
        
        // v10.66: OBJETO PRÃ‰-CADASTRO GENÃ‰RICO
        // Gerencia prÃ©-cadastro tanto para Agenda quanto para Reserva
        const PreCadastro = {
            contexto: null, // 'agenda' ou 'reserva'
            reparticaoId: null, // Para contexto de reserva
            
            abrir(contexto, reparticaoId = null) {
                console.log(`ğŸš€ [PRÃ‰-CADASTRO] Abrindo modal (contexto: ${contexto})`);
                this.contexto = contexto;
                this.reparticaoId = reparticaoId;
                
                // Limpar campos
                document.getElementById('pre-nome').value = '';
                document.getElementById('pre-telefone').value = '';
                document.getElementById('pre-nascimento').value = '';
                
                // Abrir modal
                document.getElementById('modalPreCadastro').classList.add('active');
            },
            
            fechar() {
                document.getElementById('modalPreCadastro').classList.remove('active');
                this.contexto = null;
                this.reparticaoId = null;
            },
            
            salvar() {
                const nome = document.getElementById('pre-nome').value.trim();
                const telefone = document.getElementById('pre-telefone').value.trim();
                const nascimento = document.getElementById('pre-nascimento').value;

                // ValidaÃ§Ã£o
                if (!nome) {
                    Sistema.notificar('âš ï¸ Nome Ã© obrigatÃ³rio!', 'error');
                    return;
                }
                if (!telefone) {
                    Sistema.notificar('âš ï¸ Telefone Ã© obrigatÃ³rio!', 'error');
                    return;
                }

                // Criar paciente
                const novoId = SistemaCore.dados.pacientes.length > 0 
                    ? Math.max(...SistemaCore.dados.pacientes.map(p => p.id)) + 1 
                    : 1;

                const novoPaciente = {
                    id: novoId,
                    nome: nome,
                    telefone: telefone,
                    nascimento: nascimento || '',
                    cadastro_completo: false,
                    data_cadastro: new Date().toISOString().split('T')[0],
                    cpf: '',
                    rg: '',
                    sexo: 'N',
                    email: '',
                    celular: '',
                    endereco: '',
                    cidade: '',
                    estado: '',
                    cep: '',
                    convenio_id: null,
                    cor_raca: '',
                    estado_civil: '',
                    naturalidade: '',
                    profissao: '',
                    situacao_vinculo: '',
                    nome_mae: '',
                    nome_pai: '',
                    dados_adicionais: '',
                    tipo_contato: 'direto',
                    comentario_contato: '',
                    estrangeiro: false,
                    pais: '',
                    tipo_documento: 'provisorio',
                    numero_documento: `TEMP-${novoId}`,
                    prontuario: `PRE-${novoId.toString().padStart(6, '0')}`
                };

                // Adicionar ao sistema
                SistemaCore.dados.pacientes.push(novoPaciente);
                SistemaCore.salvar();

                console.log(`âœ… [PRÃ‰-CADASTRO] Paciente criado (contexto: ${this.contexto}):`, novoPaciente);
                Sistema.notificar('âœ… PrÃ©-cadastro realizado!', 'success');

                // v10.84: ATUALIZAR SELECT DIRETAMENTE (sem fechar/reabrir modal)
                if (this.contexto === 'agenda') {
                    // Adicionar novo paciente no select da agenda
                    const selectAgenda = document.getElementById('agend-paciente');
                    const indicador = 'âš ï¸ ';
                    const telInfo = ` (Tel: ${telefone})`;
                    const option = document.createElement('option');
                    option.value = novoId;
                    option.textContent = `${indicador}${nome}${telInfo}`;
                    selectAgenda.appendChild(option);
                    
                    // Selecionar o novo paciente
                    selectAgenda.value = novoId;
                    console.log(`âœ… [PRÃ‰-CADASTRO-AGENDA] Paciente ${novoId} adicionado e selecionado no select`);
                    
                } else if (this.contexto === 'reserva') {
                    // Adicionar novo paciente no select da reserva
                    const selectReserva = document.getElementById('reservar-paciente');
                    const option = document.createElement('option');
                    option.value = novoId;
                    option.textContent = `${nome} [PRÃ‰-CADASTRO] - CPF: nÃ£o informado`;
                    selectReserva.appendChild(option);
                    
                    // Selecionar o novo paciente
                    selectReserva.value = novoId;
                    console.log(`âœ… [PRÃ‰-CADASTRO-RESERVA] Paciente ${novoId} adicionado e selecionado no select`);
                    
                } else if (this.contexto === 'recepcao') {
                    // v10.463: Selecionar paciente na recepÃ§Ã£o automaticamente
                    console.log(`âœ… [PRÃ‰-CADASTRO-RECEPCAO] Paciente ${novoId} criado, selecionando na recepÃ§Ã£o...`);
                    setTimeout(() => {
                        if (typeof Atendimentos !== 'undefined') {
                            Atendimentos.selecionarPacienteRecepcao(novoId);
                        }
                    }, 200);
                }

                // Fechar APENAS modal de prÃ©-cadastro (modal original continua aberto)
                this.fechar();
            }
        };

        const Agenda = {
            dataSelecionada: new Date().toISOString().split('T')[0], // Data atual por padrÃ£o
            tipoSelecionado: 'todos', // v8.0.9: Filtro por tipo de serviÃ§o
            tipoExameSelecionado: 'todos', // v10.117: Filtro de sub-tipo de exame
            profissionalSelecionado: 0, // v10.117: Filtro de profissional (0 = todos)
            
            // v8.0.9: NOVO - Filtrar agenda por tipo de serviÃ§o
            // v10.117: Atualizada para esconder sub-abas e resetar filtros
            filtrarPorTipo(tipo) {
                console.log(`ğŸ“Š [AGENDA] Filtrando por tipo: ${tipo}`);
                this.tipoSelecionado = tipo;
                
                // v10.117: Resetar filtros de sub-abas quando trocar de tipo
                this.tipoExameSelecionado = 'todos';
                this.profissionalSelecionado = 0;
                
                // Esconder todas as sub-abas
                const subExames = document.getElementById('agenda-subfiltros-exames');
                const subProf = document.getElementById('agenda-subfiltros-profissionais');
                if (subExames) subExames.style.display = 'none';
                if (subProf) subProf.style.display = 'none';
                
                // v8.0.16: CORREÃ‡ÃƒO - Definir no Calendario tambÃ©m
                Calendario.tipoSelecionado = tipo;
                
                // Atualizar abas visuais
                document.querySelectorAll('[id^="aba-tipo-"]').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.getElementById(`aba-tipo-${tipo}`)?.classList.add('active');
                
                // Reenderizar calendÃ¡rio e lista
                Calendario.renderizar();
                this.listar();
            },

            // v7.6: Trocar entre visualizaÃ§Ãµes (cards, calendÃ¡rio, lista)
            trocarVisualizacao(tipo) {
                // Remover active de todas as abas
                document.querySelectorAll('#tab-agenda .form-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.agenda-visualizacao').forEach(v => v.style.display = 'none');

                // v8.0.15: Controlar visibilidade dos filtros de tipo
                const filtrosTipo = document.getElementById('agenda-filtros-tipo');

                // Ativar aba clicada
                const abas = document.querySelectorAll('#tab-agenda .form-tab');
                if (tipo === 'cards') {
                    abas[0].classList.add('active');
                    document.getElementById('agenda-vis-cards').style.display = 'block';
                    filtrosTipo.style.display = 'none'; // Esconder filtros
                    this.renderizarCards(); // v8.8: Renderizar cards com filtros corretos
                } else if (tipo === 'calendario') {
                    abas[1].classList.add('active');
                    document.getElementById('agenda-vis-calendario').style.display = 'block';
                    filtrosTipo.style.display = 'flex'; // Mostrar filtros
                    Calendario.renderizar();
                    this.listar();
                } else if (tipo === 'lista') {
                    abas[2].classList.add('active');
                    document.getElementById('agenda-vis-lista').style.display = 'block';
                    filtrosTipo.style.display = 'flex'; // Mostrar filtros na lista tambÃ©m
                    this.renderizarListaCompleta();
                }
            },

            // v10.117: Alternar exibiÃ§Ã£o de sub-abas de Exames
            toggleSubfiltroExames() {
                const subExames = document.getElementById('agenda-subfiltros-exames');
                const subProf = document.getElementById('agenda-subfiltros-profissionais');
                
                // Esconder sub-abas de profissionais se estiverem abertas
                if (subProf) subProf.style.display = 'none';
                
                // Alternar sub-abas de exames
                if (subExames) {
                    const estaVisivel = subExames.style.display === 'flex';
                    subExames.style.display = estaVisivel ? 'none' : 'flex';
                    
                    if (!estaVisivel) {
                        // Ativar primeira sub-aba (Todos os Exames)
                        this.filtrarPorTipoExame('todos');
                    }
                }
            },

            // v10.117: Alternar exibiÃ§Ã£o de sub-abas de Profissionais
            toggleSubfiltroProfissionais() {
                const subExames = document.getElementById('agenda-subfiltros-exames');
                const subProf = document.getElementById('agenda-subfiltros-profissionais');
                
                // Esconder sub-abas de exames se estiverem abertas
                if (subExames) subExames.style.display = 'none';
                
                // Preencher profissionais dinamicamente
                this.preencherSubfiltroProfissionais();
                
                // Alternar sub-abas de profissionais
                if (subProf) {
                    const estaVisivel = subProf.style.display === 'flex';
                    subProf.style.display = estaVisivel ? 'none' : 'flex';
                    
                    if (!estaVisivel) {
                        // Ativar primeira sub-aba (Todos)
                        this.filtrarPorProfissional(0);
                    }
                }
            },

            // v10.117: Preencher sub-abas de profissionais dinamicamente
            // v10.117: Preencher sub-abas de profissionais dinamicamente
            // v10.118: Atualizada - insere apenas na lista com scroll, ordem alfabÃ©tica garantida
            // v10.120: Debug adicionado
            preencherSubfiltroProfissionais() {
                const containerLista = document.getElementById('agenda-subfiltros-profissionais-lista');
                console.log('ğŸ” [DEBUG] Container lista:', containerLista);
                
                if (!containerLista) {
                    console.error('âŒ Container agenda-subfiltros-profissionais-lista nÃ£o encontrado!');
                    return;
                }
                
                const profissionais = SistemaCore.dados.profissionais || [];
                const profissionaisAtivos = profissionais.filter(p => p.ativo !== false);
                
                console.log('ğŸ” [DEBUG] Profissionais ativos:', profissionaisAtivos.length);
                
                // Limpar lista (botÃ£o "Todos" estÃ¡ fixo no HTML, nÃ£o precisa recriar)
                containerLista.innerHTML = '';
                
                // Adicionar profissionais ordenados alfabeticamente
                profissionaisAtivos
                    .sort((a, b) => (a.nome || '').localeCompare(b.nome || ''))
                    .forEach(prof => {
                        console.log('â• Adicionando profissional:', prof.nome);
                        const btn = document.createElement('button');
                        btn.className = 'form-tab';
                        btn.id = `aba-prof-${prof.id}`;
                        btn.onclick = () => this.filtrarPorProfissional(prof.id);
                        btn.textContent = `ğŸ‘¨â€âš•ï¸ ${prof.nome}`;
                        containerLista.appendChild(btn);
                    });
                    
                console.log('âœ… Profissionais adicionados ao container');
            },

            // v10.117: Filtrar por tipo de exame (todos, laboratorial, imagem)
            filtrarPorTipoExame(tipo) {
                console.log(`ğŸ”¬ [AGENDA] Filtrando exames por tipo: ${tipo}`);
                this.tipoExameSelecionado = tipo;
                
                // Atualizar abas visuais
                document.querySelectorAll('[id^="aba-exame-"]').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.getElementById(`aba-exame-${tipo}`)?.classList.add('active');
                
                // Aplicar filtro baseado no tipo
                if (tipo === 'todos') {
                    this.tipoSelecionado = 'exames'; // Todos os tipos de exame
                } else if (tipo === 'laboratorio') {
                    this.tipoSelecionado = 'exames_laboratorio';
                } else if (tipo === 'imagem') {
                    this.tipoSelecionado = 'exames_imagem';
                }
                
                Calendario.tipoSelecionado = this.tipoSelecionado;
                
                // Re-renderizar
                Calendario.renderizar();
                this.listar();
            },

            // v10.117: Filtrar por profissional especÃ­fico
            // v10.117: Filtrar por profissional especÃ­fico
            // v10.121: CORREÃ‡ÃƒO - Resetar tipo para 'todos' ao filtrar por profissional
            filtrarPorProfissional(profId) {
                console.log(`ğŸ‘¨â€âš•ï¸ [AGENDA] Filtrando por profissional: ${profId || 'Todos'}`);
                this.profissionalSelecionado = profId;
                
                // v10.121: IMPORTANTE - Resetar filtro de tipo quando filtrar por profissional
                // Queremos ver TUDO do profissional (consultas + cirurgias + exames + etc)
                if (profId !== 0) {
                    this.tipoSelecionado = 'todos';
                    Calendario.tipoSelecionado = 'todos';
                    
                    // Resetar abas de tipo
                    document.querySelectorAll('[id^="aba-tipo-"]').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    document.getElementById('aba-tipo-todos')?.classList.add('active');
                }
                
                // Atualizar abas visuais de profissionais
                document.querySelectorAll('[id^="aba-prof-"]').forEach(btn => {
                    btn.classList.remove('active');
                });
                if (profId === 0) {
                    document.getElementById('aba-prof-todos')?.classList.add('active');
                } else {
                    document.getElementById(`aba-prof-${profId}`)?.classList.add('active');
                }
                
                // Re-renderizar
                Calendario.renderizar();
                this.listar();
            },

            // v10.112: Preencher dropdown de profissionais
            preencherFiltroProfissionais() {
                const select = document.getElementById('agenda-filtro-profissional');
                if (!select) return;
                
                const profissionais = SistemaCore.dados.profissionais || [];
                const profissionaisAtivos = profissionais.filter(p => p.ativo !== false);
                
                // Guardar valor selecionado
                const valorAtual = select.value;
                
                // Limpar e adicionar opÃ§Ã£o padrÃ£o
                select.innerHTML = '<option value="">ğŸ‘¥ Todos os profissionais</option>';
                
                // Adicionar profissionais ordenados alfabeticamente
                profissionaisAtivos
                    .sort((a, b) => (a.nome || '').localeCompare(b.nome || ''))
                    .forEach(prof => {
                        const option = document.createElement('option');
                        option.value = prof.id;
                        option.textContent = prof.nome;
                        select.appendChild(option);
                    });
                
                // Restaurar valor selecionado
                select.value = valorAtual;
            },

            // v7.6: Renderizar cards das unidades (igual Reparticoes.listar())
            renderizarCards() {
                // v10.112: Preencher filtro de profissionais se ainda nÃ£o foi preenchido
                const select = document.getElementById('agenda-filtro-profissional');
                if (select && select.options.length === 1) {
                    this.preencherFiltroProfissionais();
                }
                
                const container = document.getElementById('agendaCardsContainer');
                const filtroCategoria = document.getElementById('agenda-filtro-categoria')?.value || '';
                const filtroData = document.getElementById('agenda-filtro-data')?.value || '';
                const filtroProfissional = parseInt(document.getElementById('agenda-filtro-profissional')?.value) || 0;
                const filtroBusca = document.getElementById('agenda-filtro-busca')?.value.toLowerCase() || '';

                let reps = SistemaCore.dados.reparticoes;
                const pacientes = SistemaCore.dados.pacientes;
                const agendamentos = SistemaCore.dados.agendamentos;

                // Filtrar sub-repartiÃ§Ãµes (serÃ£o mostradas dentro do grupo pai)
                reps = reps.filter(r => !r.eh_subreparticao);

                // FILTRO DE TIPO - DIRETO, SEM MAPEAMENTO
                if (filtroCategoria) {
                    reps = reps.filter(r => {
                        const tipoRep = r.tipo_reparticao || 'consultorio';
                        // v10.114: Filtro 'exames' inclui laboratorio e imagem
                        if (filtroCategoria === 'exames') {
                            return tipoRep === 'exames' || tipoRep === 'exames_laboratorio' || tipoRep === 'exames_imagem';
                        }
                        return tipoRep === filtroCategoria;
                    });
                }
                
                // FILTRO DE BUSCA
                if (filtroBusca) {
                    reps = reps.filter(r =>
                        (r.nome && r.nome.toLowerCase().includes(filtroBusca)) ||
                        (r.pavilhao && r.pavilhao.toLowerCase().includes(filtroBusca)) ||
                        (r.andar && r.andar.toLowerCase().includes(filtroBusca)) ||
                        (r.setor && r.setor.toLowerCase().includes(filtroBusca))
                    );
                }

                if (reps.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--text-light);">
                            <div style="font-size: 48px; margin-bottom: 16px;">ğŸšª</div>
                            <p style="font-size: 18px; margin-bottom: 8px;">Nenhuma unidade encontrada</p>
                            <p>Ajuste os filtros ou vÃ¡ em Estabelecimento para cadastrar unidades</p>
                        </div>
                    `;
                    return;
                }

                let html = '<div class="reparticoes-grid">';

                reps.forEach(rep => {
                    const tipoRep = rep.tipo_reparticao || 'consultorio';
                    const infoTipo = Reparticoes.tipos[tipoRep] || Reparticoes.tipos['consultorio'];
                    
                    // v10.69: CORREÃ‡ÃƒO - CabeÃ§alho idÃªntico ao Mapa
                    // Se tem sub-repartiÃ§Ãµes, renderizar como grupo
                    if (rep.subreparticoes_ids && rep.subreparticoes_ids.length > 0) {
                        // CABEÃ‡ALHO DO GRUPO - v10.69: IDÃŠNTICO AO MAPA
                        html += `
                            <div style="grid-column: 1 / -1; background: linear-gradient(135deg, ${infoTipo.cor}15 0%, ${infoTipo.cor}05 100%); 
                                        border-left: 4px solid ${infoTipo.cor}; padding: 16px; border-radius: 8px; margin-top: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h3 style="margin: 0; font-size: 20px; color: var(--text);">
                                            ${infoTipo.nome.split(' ')[0]} ${rep.nome}
                                        </h3>
                                        <div style="display: flex; gap: 12px; margin-top: 8px; font-size: 14px; color: var(--text-light);">
                                            ${rep.pavilhao ? `<span>ğŸ“ ${rep.andar} - ${rep.pavilhao}</span>` : ''}
                                            ${rep.setor ? `<span>ğŸ“ ${rep.setor}</span>` : ''}
                                            <span style="font-weight: 600; color: ${infoTipo.cor};">
                                                ${rep.capacidade} ${Sistema.pluralizar(rep.capacidade, rep.padrao_nome || 'unidade')}
                                            </span>
                                        </div>
                                    </div>
                                    <div style="display: flex; gap: 8px;">
                                        <button class="btn btn-primary btn-icon" onclick="Reparticoes.editar(${rep.id})" title="Editar Grupo">
                                            âœï¸
                                        </button>
                                        <button class="btn btn-danger btn-icon" onclick="Reparticoes.excluir(${rep.id})" title="Excluir Grupo">
                                            ğŸ—‘ï¸
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;

                        // CARDS INDIVIDUAIS
                        rep.subreparticoes_ids.forEach(subId => {
                            const sub = SistemaCore.dados.reparticoes.find(r => r.id === subId);
                            if (!sub) return;

                            // Para ATENDIMENTO: mostrar agendamentos
                            // v8.0.17: Adicionar bloco_cirurgico para mostrar cirurgias agendadas
                            // v10.93: Adicionar exames_laboratorio e exames_imagem
                            // v10.99: CORREÃ‡ÃƒO - Usar tipo da SUB, nÃ£o do grupo
                            // v10.101: Adicionar emergencia e internacao para unificar renderizaÃ§Ã£o
                            const tipoSub = sub.tipo_reparticao || tipoRep;
                            if (tipoSub === 'consultorio' || tipoSub === 'procedimento' || tipoSub === 'exames' || tipoSub === 'exames_laboratorio' || tipoSub === 'exames_imagem' || tipoSub === 'bloco_cirurgico' || tipoSub === 'emergencia' || tipoSub === 'internacao') {
                                // v10.38: Mostrar TODAS as unidades (inclusive bloqueadas) com indicadores visuais
                                const unidadeBloqueada = sub.bloqueado === true;
                                const estiloBloqueado = unidadeBloqueada ? 'opacity: 0.6; background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(220, 38, 38, 0.05) 10px, rgba(220, 38, 38, 0.05) 20px);' : '';
                                
                                // v10.344: Para internaÃ§Ã£o/emergÃªncia, usar STATUS do leito, nÃ£o agendamentos
                                const ehLeito = (tipoSub === 'emergencia' || tipoSub === 'internacao');
                                
                                let statusClass, statusLabel, temAgendamentos = false, agendsUnidade = [];
                                
                                if (ehLeito) {
                                    // LEITOS: Verificar status (livre/reservado/ocupado)
                                    statusClass = sub.status || 'livre';
                                    statusLabel = {
                                        'livre': 'ğŸŸ¢ LIVRE',
                                        'reservado': 'ğŸŸ¡ RESERVADO',
                                        'ocupado': 'ğŸ”´ OCUPADO',
                                        'em_cirurgia': 'ğŸ”´ EM CIRURGIA',
                                        'desativado': 'âš« DESATIVADO'
                                    }[statusClass] || 'ğŸŸ¢ LIVRE';
                                } else {
                                    // CONSULTÃ“RIOS/EXAMES: Verificar agendamentos
                                    // v10.345: Buscar TODOS os agendamentos para esta unidade
                                    agendsUnidade = agendamentos.filter(a => a.reparticao_id === sub.id);
                                    
                                    // v10.345: Aplicar filtro de data APENAS se selecionado
                                    if (filtroData) {
                                        agendsUnidade = agendsUnidade.filter(a => a.data === filtroData);
                                    }
                                    
                                    // v10.345: Ordenar por data e hora (hoje primeiro)
                                    agendsUnidade.sort((a, b) => {
                                        const hoje = new Date().toISOString().split('T')[0];
                                        if (a.data === hoje && b.data !== hoje) return -1;
                                        if (b.data === hoje && a.data !== hoje) return 1;
                                        if (a.data !== b.data) return a.data.localeCompare(b.data);
                                        return (a.hora || '00:00').localeCompare(b.hora || '00:00');
                                    });
                                    
                                    // Aplicar filtro de profissional
                                    if (filtroProfissional) {
                                        agendsUnidade = agendsUnidade.filter(a => a.profissional_id === filtroProfissional);
                                    }
                                    
                                    temAgendamentos = agendsUnidade.length > 0;
                                    statusClass = temAgendamentos ? 'ocupado' : 'livre';
                                    statusLabel = temAgendamentos ? `ğŸ“… ${agendsUnidade.length} agendamento(s)` : 'ğŸŸ¢ SEM AGENDAMENTOS';
                                }

                                html += `
                                    <div class="reparticao-card ${statusClass}" style="border-left: 4px solid ${infoTipo.cor}; ${estiloBloqueado}">
                                        <div class="reparticao-header">
                                            <h3 class="reparticao-nome">${sub.nome}${sub.campos_especificos?.precaucoes?.length > 0 ? ` <span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; display: inline-block; white-space: nowrap; max-width: 200px; overflow: hidden; text-overflow: ellipsis;">ğŸ”’ ${sub.campos_especificos.precaucoes.map(p => p.charAt(0).toUpperCase() + p.slice(1)).join(', ')}</span>` : ''}</h3>
                                            <div style="display: flex; align-items: center; gap: 8px;">
                                                <span class="reparticao-status ${statusClass}">${statusLabel}</span>
                                                ${unidadeBloqueada ? `<span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">â›” BLOQUEADO</span>` : ''}
                                            </div>
                                        </div>
                                        
                                        ${temAgendamentos ? `
                                        <div id="agendamentos-${sub.id}" style="margin-top: 16px; display: flex; flex-direction: column; gap: 12px; max-height: 200px; overflow-y: auto;">
                                            ${agendsUnidade.map(ag => {
                                                const pac = pacientes.find(p => p.id === ag.paciente_id);
                                                const prof = SistemaCore.dados.profissionais.find(p => p.id === ag.profissional_id);
                                                
                                                // Formatar data compacta (DD/MM/AA)
                                                const dataCompacta = ag.data ? new Date(ag.data + 'T00:00:00').toLocaleDateString('pt-BR', {
                                                    day: '2-digit',
                                                    month: '2-digit',
                                                    year: '2-digit'
                                                }) : '';
                                                
                                                // Verificar se Ã© hoje
                                                const hoje = new Date().toISOString().split('T')[0];
                                                const ehHoje = ag.data === hoje;
                                                
                                                // v9.0: Calcular duraÃ§Ãµes
                                                const duracao = ag.duracao || 30;
                                                const tipoUnidade = sub.tipo_reparticao || 'consultorio';
                                                // v9.0: Usar tempo_preparo salvo OU padrÃ£o
                                                const tempoPreparo = ag.tempo_preparo !== undefined 
                                                    ? ag.tempo_preparo 
                                                    : ((SistemaCore.dados.tempos_preparo && SistemaCore.dados.tempos_preparo[tipoUnidade]) || 10);
                                                const duracaoTotal = duracao + tempoPreparo;
                                                
                                                return `
                                                    <div class="agendamento-item-${sub.id}" style="width: 100%; box-sizing: border-box; padding: 16px; background: rgba(0,0,0,0.03); border-radius: 8px; border-left: 3px solid ${infoTipo.cor};">
                                                        <div style="display: flex; justify-content: space-between; align-items: start;">
                                                            <div style="flex: 1;">
                                                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                                                    <strong style="font-size: 16px; color: ${ehHoje ? '#ef4444' : 'var(--text)'};">â° ${ag.hora || 'Sem horÃ¡rio'}</strong>
                                                                    <span style="background: ${ehHoje ? '#ef4444' : '#3b82f6'}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                                                                        ${ehHoje ? 'HOJE' : dataCompacta}
                                                                    </span>
                                                                </div>
                                                                <div style="display: flex; gap: 12px; font-size: 12px; color: var(--text-light); margin-bottom: 8px; flex-wrap: nowrap;">
                                                                    <span style="white-space: nowrap;">â±ï¸ ${duracao}min</span>
                                                                    <span style="white-space: nowrap;">ğŸ”§ +${tempoPreparo}min</span>
                                                                    <span style="font-weight: 600; color: var(--text); white-space: nowrap;">ğŸ“Š ${duracaoTotal}min</span>
                                                                </div>
                                                                <div style="margin-top: 4px;">
                                                                    <span style="color: var(--text); font-size: 15px; font-weight: 600;">ğŸ‘¤ ${pac ? pac.nome : 'Paciente nÃ£o encontrado'}</span>
                                                                </div>
                                                                ${prof ? `<div style="font-size: 11px; color: var(--text-light); margin-top: 2px;">ğŸ‘¨â€âš•ï¸ ${prof.nome}</div>` : ''}
                                                            </div>
                                                            <button class="btn btn-info btn-icon" onclick="Atendimentos.verProntuario(${ag.paciente_id})" title="Ver ProntuÃ¡rio">
                                                                ğŸ“‹
                                                            </button>
                                                        </div>
                                                    </div>
                                                `;
                                            }).join('')}
                                        </div>
                                        ` : (tipoSub === 'emergencia' || tipoSub === 'internacao') ? '' : `
                                        <div style="text-align: center; padding: 20px; color: var(--text-light);">
                                            <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“…</div>
                                            <div>Nenhum agendamento</div>
                                        </div>
                                        `}

                                        ${/* v10.344: INFORMAÃ‡Ã•ES DE LEITO RESERVADO */ ''}
                                        ${ehLeito && sub.status === 'reservado' && sub.reservado_para_paciente_id ? `
                                        <div style="margin-top: 16px; padding: 16px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #ffc107; border-radius: 8px;">
                                            <div style="font-weight: 600; color: #f59e0b; margin-bottom: 8px;">
                                                ğŸ“… Leito Reservado
                                            </div>
                                            <div style="margin-bottom: 4px;">
                                                <strong>Paciente:</strong> ${(() => {
                                                    const pac = pacientes.find(p => p.id === sub.reservado_para_paciente_id);
                                                    return pac ? pac.nome : 'NÃ£o encontrado';
                                                })()}
                                            </div>
                                            <div style="font-size: 13px; color: var(--text-light); margin-bottom: 4px;">
                                                ğŸ—“ï¸ ${new Date(sub.reservado_em).toLocaleDateString('pt-BR', {day: '2-digit', month: '2-digit', year: '2-digit'})} Ã s ${new Date(sub.reservado_em).toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'})}
                                            </div>
                                            ${sub.data_prevista_entrada ? `
                                            <div style="font-size: 13px; color: var(--text-light); margin-bottom: 4px;">
                                                ğŸ“† Entrada prevista: ${new Date(sub.data_prevista_entrada + 'T00:00:00').toLocaleDateString('pt-BR')}
                                            </div>
                                            ` : ''}
                                            ${sub.tipo_reserva ? `
                                            <div style="font-size: 13px; color: var(--text-light);">
                                                Tipo: ${sub.tipo_reserva === 'matriciamento' ? 'ğŸ”„ Matriciamento' : 'ğŸ“… Agendamento'}
                                            </div>
                                            ` : ''}
                                        </div>
                                        ` : ''}

                                        ${/* v10.344: INFORMAÃ‡Ã•ES DE LEITO OCUPADO */ ''}
                                        ${ehLeito && sub.status === 'ocupado' && sub.paciente_id ? `
                                        <div style="margin-top: 16px; padding: 16px; background: rgba(239, 68, 68, 0.1); border-left: 3px solid #ef4444; border-radius: 8px;">
                                            <div style="font-weight: 600; color: #ef4444; margin-bottom: 8px;">
                                                ğŸ”´ Leito Ocupado
                                            </div>
                                            <div style="margin-bottom: 4px;">
                                                <strong>Paciente:</strong> ${(() => {
                                                    const pac = pacientes.find(p => p.id === sub.paciente_id);
                                                    return pac ? pac.nome : 'NÃ£o encontrado';
                                                })()}
                                            </div>
                                            <div style="font-size: 13px; color: var(--text-light); margin-bottom: 4px;">
                                                ğŸ“… Internado: ${new Date(sub.data_ocupacao).toLocaleDateString('pt-BR', {day: '2-digit', month: '2-digit', year: '2-digit'})}
                                                <span style="font-weight: 600; color: var(--text);">(${(() => {
                                                    const dias = Math.floor((new Date() - new Date(sub.data_ocupacao)) / (1000 * 60 * 60 * 24));
                                                    return dias;
                                                })()} dias)</span>
                                            </div>
                                            ${sub.motivo_internacao ? `
                                            <div style="font-size: 13px; color: var(--text-light);">
                                                Motivo: ${sub.motivo_internacao}
                                            </div>
                                            ` : ''}
                                        </div>
                                        ` : ''}

                                        <div class="reparticao-actions" style="margin-top: 16px;">
                                            ${unidadeBloqueada ? `
                                                <!-- BLOQUEADO: Apenas botÃ£o desbloquear -->
                                                <button class="btn btn-warning btn-icon" onclick="Reparticoes.toggleBloqueio(${sub.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Desbloquear unidade para permitir agendamentos">
                                                    ğŸ”“ Desbloquear
                                                </button>
                                            ` : ehLeito && sub.status === 'reservado' ? `
                                                <!-- v10.344: LEITO RESERVADO - BotÃµes de ver e cancelar -->
                                                <button class="btn btn-info btn-icon" onclick="Reparticoes.verDetalhesReserva(${sub.id})" title="Ver Detalhes da Reserva">
                                                    ğŸ‘ï¸ Ver Reserva
                                                </button>
                                                <button class="btn btn-danger btn-icon" onclick="Reparticoes.cancelarReserva(${sub.id})" title="Cancelar Reserva">
                                                    âŒ Cancelar
                                                </button>
                                            ` : ehLeito && sub.status === 'ocupado' ? `
                                                <!-- v10.344: LEITO OCUPADO - Ver ProntuÃ¡rio -->
                                                <button class="btn btn-info btn-icon" onclick="Atendimentos.verProntuario(${sub.paciente_id})" title="Ver ProntuÃ¡rio">
                                                    ğŸ“‹ ProntuÃ¡rio
                                                </button>
                                            ` : `
                                                <!-- v10.344: LIVRE ou NÃƒO-LEITO - BotÃµes dependem do tipo -->
                                                ${(tipoSub === 'consultorio' || tipoSub === 'procedimento' || tipoSub === 'exames' || tipoSub === 'exames_laboratorio' || tipoSub === 'exames_imagem' || tipoSub === 'bloco_cirurgico') ? `
                                                <button class="btn btn-success btn-icon" onclick="Agenda.abrirModal(null, ${sub.id});" title="Novo Agendamento">
                                                    â• Agendar
                                                </button>
                                                ` : ''}
                                                ${(tipoSub === 'internacao') && PermissoesReserva.usuarioPodeReservar() && sub.status === 'livre' ? `
                                                <button class="btn btn-warning btn-icon" onclick="Reparticoes.abrirModalReservar(${sub.id})" title="Reservar Leito">
                                                    âš¡ Reservar
                                                </button>
                                                ` : ''}
                                                <button class="btn btn-danger btn-icon" onclick="Reparticoes.toggleBloqueio(${sub.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Bloquear unidade">
                                                    â›” Bloquear
                                                </button>
                                            `}
                                        </div>
                                    </div>
                                `;
                            }
                            // v10.101: Bloco else removido - todos os tipos agora sÃ£o tratados no IF acima
                        });
                    } else {
                        // NÃƒO Ã© grupo - renderizar como card normal Ãºnico
                        // v10.93: Incluir exames_laboratorio e exames_imagem
                        const ehConsultorio = ['consultorio', 'procedimento', 'exames', 'exames_laboratorio', 'exames_imagem', 'bloco_cirurgico'].includes(tipoRep);
                        
                        if (ehConsultorio) {
                            // v10.345: Buscar TODOS os agendamentos para esta unidade
                            let agendsRep = agendamentos.filter(a => a.reparticao_id === rep.id);
                            
                            // v10.345: Aplicar filtro de data APENAS se selecionado
                            if (filtroData) {
                                agendsRep = agendsRep.filter(a => a.data === filtroData);
                            }
                            
                            // v10.345: Ordenar por data e hora (hoje primeiro)
                            agendsRep.sort((a, b) => {
                                const hoje = new Date().toISOString().split('T')[0];
                                if (a.data === hoje && b.data !== hoje) return -1;
                                if (b.data === hoje && a.data !== hoje) return 1;
                                if (a.data !== b.data) return a.data.localeCompare(b.data);
                                return (a.hora || '00:00').localeCompare(b.hora || '00:00');
                            });
                            
                            const temAgendamentos = agendsRep.length > 0;
                            
                            // v10.38: Indicador de bloqueio
                            const unidadeBloqueada = rep.bloqueado === true;
                            const estiloBloqueado = unidadeBloqueada ? 'opacity: 0.6; background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(220, 38, 38, 0.05) 10px, rgba(220, 38, 38, 0.05) 20px);' : '';
                            
                            // v10.95: CABEÃ‡ALHO para consultÃ³rios/salas individuais (nÃ£o-grupo)
                            html += `
                                <div style="grid-column: 1 / -1; background: linear-gradient(135deg, ${infoTipo.cor}15 0%, ${infoTipo.cor}05 100%); 
                                            border-left: 4px solid ${infoTipo.cor}; padding: 16px; border-radius: 8px; margin-top: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <h3 style="margin: 0; color: ${infoTipo.cor}; font-size: 18px;">
                                                ${infoTipo.icone} ${rep.nome}
                                            </h3>
                                            ${rep.pavilhao || rep.setor ? `
                                            <p style="margin: 4px 0 0 0; color: var(--text-light); font-size: 14px;">
                                                ${rep.pavilhao ? `ğŸ“ ${rep.andar} - ${rep.pavilhao}` : ''}
                                                ${rep.setor ? `ğŸ“ ${rep.setor}` : ''}
                                            </p>
                                            ` : ''}
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-primary btn-icon" onclick="Reparticoes.editar(${rep.id})" title="Editar">
                                                âœï¸
                                            </button>
                                            <button class="btn btn-danger btn-icon" onclick="Reparticoes.excluir(${rep.id})" title="Excluir">
                                                ğŸ—‘ï¸
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `;
                            
                            html += `
                                <div class="reparticao-card ${temAgendamentos ? 'ocupado' : 'livre'}" style="border-left: 4px solid ${infoTipo.cor}; ${estiloBloqueado}">
                                    <div class="reparticao-header">
                                        <h3 class="reparticao-nome">${infoTipo.nome.split(' ')[0]} ${rep.nome}</h3>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span class="reparticao-status ${temAgendamentos ? 'ocupado' : 'livre'}">${temAgendamentos ? `ğŸ“… ${agendsRep.length} agendamento(s)` : 'ğŸŸ¢ SEM AGENDAMENTOS'}</span>
                                            ${unidadeBloqueada ? `<span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">â›” BLOQUEADO</span>` : ''}
                                        </div>
                                    </div>

                                    <div class="reparticao-info">
                                        <div class="reparticao-info-item">
                                            <span class="badge" style="background: ${infoTipo.cor}; color: white;">${infoTipo.descricao}</span>
                                        </div>
                                        ${rep.pavilhao ? `
                                        <div class="reparticao-info-item">
                                            <strong>ğŸ“ LocalizaÃ§Ã£o:</strong> <span>${rep.andar} - ${rep.pavilhao}</span>
                                        </div>
                                        ` : ''}
                                        ${rep.setor ? `
                                        <div class="reparticao-info-item">
                                            <strong>ğŸ“ Setor:</strong> <span>${rep.setor}</span>
                                        </div>
                                        ` : ''}
                                    </div>

                                    ${temAgendamentos ? `
                                    <div id="agendamentos-rep-${rep.id}" style="margin-top: 16px; display: flex; flex-direction: column; gap: 12px; max-height: 200px; overflow-y: auto;">
                                        ${agendsRep.map(ag => {
                                            const pac = pacientes.find(p => p.id === ag.paciente_id);
                                            const prof = SistemaCore.dados.profissionais.find(p => p.id === ag.profissional_id);
                                            
                                            // Formatar data compacta
                                            const dataCompacta = ag.data ? new Date(ag.data + 'T00:00:00').toLocaleDateString('pt-BR', {
                                                day: '2-digit',
                                                month: '2-digit',
                                                year: '2-digit'
                                            }) : '';
                                            
                                            // Verificar se Ã© hoje
                                            const hoje = new Date().toISOString().split('T')[0];
                                            const ehHoje = ag.data === hoje;
                                            
                                            // v9.0: Calcular duraÃ§Ãµes
                                            const duracao = ag.duracao || 30;
                                            const tipoUnidade = rep.tipo_reparticao || 'consultorio';
                                            // v9.0: Usar tempo_preparo salvo OU padrÃ£o
                                            const tempoPreparo = ag.tempo_preparo !== undefined 
                                                ? ag.tempo_preparo 
                                                : ((SistemaCore.dados.tempos_preparo && SistemaCore.dados.tempos_preparo[tipoUnidade]) || 10);
                                            const duracaoTotal = duracao + tempoPreparo;
                                            
                                            return `
                                                <div style="width: 100%; box-sizing: border-box; padding: 16px; background: rgba(0,0,0,0.03); border-radius: 8px; border-left: 3px solid ${infoTipo.cor};">
                                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                                        <div style="flex: 1;">
                                                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                                                <strong style="font-size: 16px; color: ${ehHoje ? '#ef4444' : 'var(--text)'};">â° ${ag.hora || 'Sem horÃ¡rio'}</strong>
                                                                <span style="background: ${ehHoje ? '#ef4444' : '#3b82f6'}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 600;">
                                                                    ${ehHoje ? 'HOJE' : dataCompacta}
                                                                </span>
                                                            </div>
                                                            <div style="display: flex; gap: 12px; font-size: 12px; color: var(--text-light); margin-bottom: 8px; flex-wrap: nowrap;">
                                                                <span style="white-space: nowrap;">â±ï¸ ${duracao}min</span>
                                                                <span style="white-space: nowrap;">ğŸ”§ +${tempoPreparo}min</span>
                                                                <span style="font-weight: 600; color: var(--text); white-space: nowrap;">ğŸ“Š ${duracaoTotal}min</span>
                                                            </div>
                                                            <div style="margin-top: 4px;">
                                                                <span style="color: var(--text); font-size: 15px; font-weight: 600;">ğŸ‘¤ ${pac ? pac.nome : 'Paciente nÃ£o encontrado'}</span>
                                                            </div>
                                                            ${prof ? `<div style="font-size: 11px; color: var(--text-light); margin-top: 2px;">ğŸ‘¨â€âš•ï¸ ${prof.nome}</div>` : ''}
                                                        </div>
                                                        <button class="btn btn-info btn-icon" onclick="Atendimentos.verProntuario(${ag.paciente_id})" title="Ver ProntuÃ¡rio">
                                                            ğŸ“‹
                                                        </button>
                                                    </div>
                                                </div>
                                            `;
                                        }).join('')}
                                    </div>
                                    ` : `
                                    <div style="text-align: center; padding: 20px; color: var(--text-light);">
                                        <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“…</div>
                                        <div>Nenhum agendamento</div>
                                    </div>
                                    `}

                                    <div class="reparticao-actions" style="margin-top: 16px;">
                                        ${unidadeBloqueada ? `
                                            <!-- BLOQUEADO: Apenas botÃ£o desbloquear -->
                                            <button class="btn btn-warning btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Desbloquear unidade para permitir agendamentos">
                                                ğŸ”“ Desbloquear
                                            </button>
                                        ` : `
                                            <!-- LIVRE: BotÃµes normais -->
                                            <button class="btn btn-success btn-icon" onclick="Agenda.abrirModal(null, ${rep.id});" title="Novo Agendamento">
                                                â• Agendar
                                            </button>
                                            <button class="btn btn-danger btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Bloquear unidade">
                                                â›” Bloquear
                                            </button>
                                        `}
                                    </div>
                                </div>
                            `;
                        } else {
                            // InternaÃ§Ã£o/EmergÃªncia INDIVIDUAL - v10.62: COM BOTÃ•ES DE AÃ‡ÃƒO
                            const statusClass = rep.status || 'livre';
                            const statusLabel = {
                                'livre': 'ğŸŸ¢ LIVRE',
                                'reservado': 'ğŸŸ¡ RESERVADO',
                                'ocupado': 'ğŸ”´ OCUPADO',
                                'em_cirurgia': 'ğŸ”´ EM CIRURGIA',
                                'desativado': 'âš« DESATIVADO'
                            }[statusClass] || 'ğŸŸ¢ LIVRE';
                            
                            // v10.62: Indicador de bloqueio
                            const leitoBloqueado = rep.bloqueado === true;
                            const estiloBloqueado = leitoBloqueado ? 'opacity: 0.6; background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(220, 38, 38, 0.05) 10px, rgba(220, 38, 38, 0.05) 20px);' : '';
                            
                            // v10.95: CABEÃ‡ALHO para leitos individuais (nÃ£o-grupo)
                            html += `
                                <div style="grid-column: 1 / -1; background: linear-gradient(135deg, ${infoTipo.cor}15 0%, ${infoTipo.cor}05 100%); 
                                            border-left: 4px solid ${infoTipo.cor}; padding: 16px; border-radius: 8px; margin-top: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <h3 style="margin: 0; color: ${infoTipo.cor}; font-size: 18px;">
                                                ${infoTipo.icone} ${rep.nome}
                                            </h3>
                                            ${rep.pavilhao || rep.setor ? `
                                            <p style="margin: 4px 0 0 0; color: var(--text-light); font-size: 14px;">
                                                ${rep.pavilhao ? `ğŸ“ ${rep.andar} - ${rep.pavilhao}` : ''}
                                                ${rep.setor ? `ğŸ“ ${rep.setor}` : ''}
                                            </p>
                                            ` : ''}
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-primary btn-icon" onclick="Reparticoes.editar(${rep.id})" title="Editar">
                                                âœï¸
                                            </button>
                                            <button class="btn btn-danger btn-icon" onclick="Reparticoes.excluir(${rep.id})" title="Excluir">
                                                ğŸ—‘ï¸
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `;
                            
                            html += `
                                <div class="reparticao-card ${statusClass}" style="border-left: 4px solid ${infoTipo.cor}; ${estiloBloqueado}">
                                    <div class="reparticao-header">
                                        <h3 class="reparticao-nome">${infoTipo.nome.split(' ')[0]} ${rep.nome}${rep.campos_especificos?.isolado ? ' ğŸ”’' : ''}</h3>
                                        <div style="display: flex; align-items: center; gap: 8px;">
                                            <span class="reparticao-status ${statusClass}">${statusLabel}</span>
                                            ${leitoBloqueado ? `<span style="background: #dc2626; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">â›” BLOQUEADO</span>` : ''}
                                        </div>
                                    </div>

                                    ${rep.pavilhao || rep.setor ? `
                                    <div class="reparticao-info">
                                        ${rep.pavilhao ? `
                                        <div class="reparticao-info-item">
                                            <strong>ğŸ“ LocalizaÃ§Ã£o:</strong> <span>${rep.andar} - ${rep.pavilhao}</span>
                                        </div>
                                        ` : ''}
                                        ${rep.setor ? `
                                        <div class="reparticao-info-item">
                                            <strong>ğŸ“ Setor:</strong> <span>${rep.setor}</span>
                                        </div>
                                        ` : ''}
                                    </div>
                                    ` : ''}

                                    ${rep.status === 'ocupado' && rep.paciente_id ? `
                                    <div class="reparticao-paciente">
                                        <div class="reparticao-paciente-nome">
                                            ğŸ‘¤ ${Reparticoes.getNomePaciente(rep.paciente_id, pacientes)}
                                        </div>
                                        <div class="reparticao-paciente-info">
                                            ğŸ“… Internado: ${new Date(rep.data_ocupacao).toLocaleDateString('pt-BR', {day: '2-digit', month: '2-digit', year: '2-digit'})}
                                            <span style="font-weight: 600; color: var(--text);">(${Reparticoes.getDiasInternacao(rep.data_ocupacao)} dias)</span>
                                        </div>
                                        ${rep.motivo_internacao ? `
                                        <div class="reparticao-paciente-info" style="margin-top: 4px;">
                                            Motivo: ${rep.motivo_internacao}
                                        </div>
                                        ` : ''}
                                    </div>
                                    ` : ''}

                                    ${rep.status === 'reservado' && rep.reservado_para_paciente_id ? `
                                    <div class="reparticao-paciente" style="background: rgba(255, 193, 7, 0.1); border-left: 3px solid #ffc107;">
                                        <div class="reparticao-paciente-nome">
                                            ğŸ“… Reservado para: ${Reparticoes.getNomePaciente(rep.reservado_para_paciente_id, pacientes)}
                                        </div>
                                        <div class="reparticao-paciente-info">
                                            ğŸ—“ï¸ ${new Date(rep.reservado_em).toLocaleDateString('pt-BR', {day: '2-digit', month: '2-digit', year: '2-digit'})} Ã s ${new Date(rep.reservado_em).toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'})}
                                        </div>
                                        ${rep.tipo_reserva ? `
                                        <div class="reparticao-paciente-info" style="margin-top: 4px;">
                                            Tipo: ${rep.tipo_reserva === 'matriciamento' ? 'ğŸ”„ Matriciamento' : 'ğŸ“… Agendamento'}
                                        </div>
                                        ` : ''}
                                    </div>
                                    ` : ''}

                                    <div class="reparticao-actions" style="margin-top: 16px;">
                                        ${leitoBloqueado ? `
                                            <!-- v10.62: BLOQUEADO - Desbloquear -->
                                            <button class="btn btn-success btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Desbloquear leito">
                                                ğŸ”“ Desbloquear
                                            </button>
                                        ` : rep.status === 'livre' ? `
                                            <!-- v10.100: LIVRE - BotÃµes por tipo -->
                                            ${(tipoRep === 'internacao' || tipoRep === 'emergencia') && PermissoesReserva.usuarioPodeReservar() ? `
                                            <button class="btn btn-warning btn-icon" onclick="Reparticoes.abrirModalReservar(${rep.id})" title="Reservar Leito">
                                                âš¡ Reservar
                                            </button>
                                            ` : ''}
                                            <button class="btn btn-danger btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Bloquear ${tipoRep === 'emergencia' ? 'leito' : 'unidade'}">
                                                â›” Bloquear
                                            </button>
                                        ` : rep.status === 'reservado' && tipoRep !== 'emergencia' ? `
                                            <!-- v10.97: RESERVADO - Ver + Cancelar (NÃƒO para emergÃªncia) -->
                                            <button class="btn btn-info btn-icon" onclick="Reparticoes.verDetalhesReserva(${rep.id})" title="Ver Detalhes da Reserva">
                                                ğŸ‘ï¸ Ver
                                            </button>
                                            <button class="btn btn-danger btn-icon" onclick="Reparticoes.cancelarReserva(${rep.id})" title="Cancelar Reserva">
                                                âŒ Cancelar
                                            </button>
                                        ` : rep.status === 'ocupado' ? `
                                            <!-- v10.62: OCUPADO - Ver ProntuÃ¡rio -->
                                            <button class="btn btn-info btn-icon" onclick="Atendimentos.verProntuario(${rep.paciente_id})" title="Ver ProntuÃ¡rio">
                                                ğŸ“‹ ProntuÃ¡rio
                                            </button>
                                        ` : ''}
                                    </div>
                                </div>
                            `;
                        }
                    }
                });
                html += '</div>';
                container.innerHTML = html;
            },

            // v8.7: Renderizar unidades SIMPLIFICADO

            // v8.6: Mostrar unidades ocultas (idÃªntico a Reparticoes)
            mostrarOcultas() {
                const prefs = Reparticoes.carregarPreferencias();
                prefs.ocultas = [];
                Reparticoes.salvarPreferencias(prefs);
                Sistema.notificar('ğŸ‘ï¸ Todas as unidades visÃ­veis novamente');
                this.renderizarCards();
            },

            // v7.6: Renderizar lista completa de agendamentos
            renderizarListaCompleta() {
                // v10.112: Preencher filtro de profissionais se ainda nÃ£o foi preenchido
                const selectLista = document.getElementById('agenda-lista-profissional');
                if (selectLista && selectLista.options.length === 1) {
                    const profissionais = SistemaCore.dados.profissionais || [];
                    const profissionaisAtivos = profissionais.filter(p => p.ativo !== false);
                    
                    const valorAtual = selectLista.value;
                    selectLista.innerHTML = '<option value="">Todos</option>';
                    
                    profissionaisAtivos
                        .sort((a, b) => (a.nome || '').localeCompare(b.nome || ''))
                        .forEach(prof => {
                            const option = document.createElement('option');
                            option.value = prof.id;
                            option.textContent = prof.nome;
                            selectLista.appendChild(option);
                        });
                    
                    selectLista.value = valorAtual;
                }
                
                const container = document.getElementById('agendaListaCompleta');
                const dataInicio = document.getElementById('agenda-lista-data-inicio')?.value || '';
                const dataFim = document.getElementById('agenda-lista-data-fim')?.value || '';
                const profissionalId = parseInt(document.getElementById('agenda-lista-profissional')?.value) || 0;
                const status = document.getElementById('agenda-lista-status')?.value || '';

                let agends = SistemaCore.dados.agendamentos;

                // Aplicar filtros
                if (dataInicio) {
                    agends = agends.filter(a => a.data >= dataInicio);
                }
                if (dataFim) {
                    agends = agends.filter(a => a.data <= dataFim);
                }
                if (profissionalId) {
                    agends = agends.filter(a => a.profissional_id === profissionalId);
                }
                if (status) {
                    agends = agends.filter(a => a.status === status);
                }

                // Ordenar por data e hora
                agends.sort((a, b) => {
                    if (a.data !== b.data) return a.data.localeCompare(b.data);
                    return a.hora.localeCompare(b.hora);
                });

                if (agends.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 40px;">Nenhum agendamento encontrado</p>';
                    return;
                }

                let html = '<div class="item-list">';
                agends.forEach(ag => {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === ag.paciente_id);
                    const profissional = SistemaCore.dados.profissionais.find(p => p.id === ag.profissional_id);
                    const reparticao = SistemaCore.dados.reparticoes.find(r => r.id === ag.reparticao_id);

                    const statusClass = {
                        'agendado': 'badge-info',
                        'realizado': 'badge-success',
                        'cancelado': 'badge-danger'
                    }[ag.status] || 'badge-secondary';

                    html += `
                        <div class="item-card">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                    <strong>${new Date(ag.data + 'T00:00:00').toLocaleDateString('pt-BR')} - ${ag.hora}</strong>
                                    <span class="badge ${statusClass}">${ag.status}</span>
                                </div>
                                <div style="color: var(--text-light); font-size: 14px;">
                                    ğŸ‘¤ ${paciente ? paciente.nome : 'Paciente nÃ£o encontrado'}<br>
                                    ğŸ‘¨â€âš•ï¸ ${profissional ? profissional.nome : 'Profissional'}<br>
                                    ğŸ¥ ${reparticao ? reparticao.nome : 'Unidade'}
                                    ${ag.observacoes ? `<br>ğŸ“ ${ag.observacoes}` : ''}
                                </div>
                            </div>
                            <div class="action-buttons">
                                <button class="btn btn-icon btn-primary" onclick="Agenda.abrirModal(${ag.id})" title="Editar">âœï¸</button>
                                <button class="btn btn-icon btn-danger" onclick="Agenda.excluir(${ag.id})" title="Excluir">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;
            },

            // v7.6: Inicializar Agenda
            init() {
                this.carregarFiltros();
                // v10.345: NÃƒO definir data padrÃ£o - mostrar TODOS os agendamentos por padrÃ£o
                // O usuÃ¡rio pode filtrar por data se desejar
                // const hoje = new Date().toISOString().split('T')[0];
                // if (document.getElementById('agenda-filtro-data')) {
                //     document.getElementById('agenda-filtro-data').value = hoje;
                // }
                // Renderizar visualizaÃ§Ã£o de cards por padrÃ£o
                this.renderizarCards();
                Calendario.renderizar();
            },

            // v7.6: Carregar filtros de profissionais
            // v10.117: Simplificada - dropdown do CalendÃ¡rio removido
            carregarFiltros() {
                // Filtro de profissional na visualizaÃ§Ã£o de cards
                const selectProf1 = document.getElementById('agenda-filtro-profissional');
                if (selectProf1) {
                    selectProf1.innerHTML = '<option value="">Todos</option>';
                    SistemaCore.dados.profissionais.forEach(prof => {
                        selectProf1.innerHTML += `<option value="${prof.id}">${prof.nome}</option>`;
                    });
                }

                // Filtro de profissional na lista completa
                const selectProf3 = document.getElementById('agenda-lista-profissional');
                if (selectProf3) {
                    selectProf3.innerHTML = '<option value="">Todos</option>';
                    SistemaCore.dados.profissionais.forEach(prof => {
                        selectProf3.innerHTML += `<option value="${prof.id}">${prof.nome}</option>`;
                    });
                }

                // Definir datas padrÃ£o na lista completa
                const dataInicio = document.getElementById('agenda-lista-data-inicio');
                const dataFim = document.getElementById('agenda-lista-data-fim');
                if (dataInicio && dataFim) {
                    const hoje = new Date();
                    const umMesAtras = new Date(hoje);
                    umMesAtras.setMonth(hoje.getMonth() - 1);
                    dataInicio.value = umMesAtras.toISOString().split('T')[0];
                    dataFim.value = hoje.toISOString().split('T')[0];
                }
            },

            // v8.0.5: INTEGRAÃ‡ÃƒO AGENDA + MAPA - Lista TODOS os eventos do dia
            // v10.117: Simplificada - dropdowns removidos, usa apenas filtros de abas
            listar() {
                const container = document.getElementById('listaAgenda');
                
                // Buscar TODOS os eventos usando o mÃ©todo integrado do Calendario
                let eventos = Calendario.getEventosDia(this.dataSelecionada);
                
                // v10.117: Aplicar filtro de profissional (se selecionado via sub-abas)
                if (this.profissionalSelecionado && this.profissionalSelecionado !== 0) {
                    eventos = eventos.filter(e => {
                        if (e.tipo === 'agendamento' && e.dados.profissional_id) {
                            return e.dados.profissional_id === this.profissionalSelecionado;
                        }
                        return false; // Remover outros tipos quando filtro de profissional ativo
                    });
                }

                // Atualizar tÃ­tulo e contador
                const dataObj = new Date(this.dataSelecionada + 'T00:00:00');
                const hoje = new Date().toISOString().split('T')[0];
                let tituloData = '';
                
                if (this.dataSelecionada === hoje) {
                    tituloData = 'Eventos - Hoje';
                } else {
                    tituloData = `Eventos - ${dataObj.toLocaleDateString('pt-BR', { 
                        weekday: 'long', 
                        day: 'numeric', 
                        month: 'long',
                        year: 'numeric'
                    })}`;
                }
                
                document.getElementById('data-selecionada-titulo').textContent = tituloData;
                document.getElementById('contador-agendamentos').textContent = 
                    `${eventos.length} ${eventos.length === 1 ? 'evento' : 'eventos'}`;

                if (eventos.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 60px 20px; color: var(--text-light);">
                            <div style="font-size: 64px; margin-bottom: 16px;">ğŸ“…</div>
                            <p style="font-size: 18px; margin-bottom: 8px; color: var(--text);">Nenhum evento para este dia</p>
                            <p style="font-size: 14px;">Clique em "Novo Agendamento" ou gerencie internaÃ§Ãµes no Mapa das Unidades</p>
                        </div>
                    `;
                    return;
                }

                const pacientes = SistemaCore.dados.pacientes;
                const profissionais = SistemaCore.dados.profissionais;

                let html = '';
                eventos.forEach(ev => {
                    // Card diferente para cada tipo de evento
                    if (ev.tipo === 'agendamento') {
                        // AGENDAMENTO - Card completo original
                        const ag = ev.dados;
                        const paciente = pacientes.find(p => p.id === ag.paciente_id);
                        const profissional = profissionais.find(p => p.id === ag.profissional_id);
                        
                        let idadePaciente = '';
                        if (paciente && paciente.nascimento) {
                            const nascimento = new Date(paciente.nascimento + 'T00:00:00');
                            const hoje = new Date();
                            let idade = hoje.getFullYear() - nascimento.getFullYear();
                            const mes = hoje.getMonth() - nascimento.getMonth();
                            if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
                                idade--;
                            }
                            idadePaciente = `${idade} anos`;
                        }

                        // v10.55.2: Calcular tempo de preparo
                        const duracao = ag.duracao || 30;
                        const reparticao = SistemaCore.dados.reparticoes.find(r => r.id === ag.reparticao_id);
                        const tipoUnidade = reparticao ? reparticao.tipo_reparticao || 'consultorio' : 'consultorio';
                        // v9.0: Usar tempo_preparo salvo OU padrÃ£o
                        const tempoPreparo = ag.tempo_preparo !== undefined 
                            ? ag.tempo_preparo 
                            : ((SistemaCore.dados.tempos_preparo && SistemaCore.dados.tempos_preparo[tipoUnidade]) || 10);
                        
                        // v10.55.2: CORREÃ‡ÃƒO - Calcular horÃ¡rio fim com tempo TOTAL
                        const horarioFim = this.calcularHorarioFim(ag.hora, duracao, tempoPreparo);
                        const duracaoTotal = duracao + tempoPreparo;
                        
                        html += `
                            <div class="agendamento-card" style="border-left: 4px solid ${ev.cor}">
                                <div class="agendamento-card-header">
                                    <div>
                                        <div class="agendamento-titulo">
                                            ${ev.icone} ${paciente ? paciente.nome : 'Paciente nÃ£o encontrado'}
                                            ${paciente && paciente.cadastro_completo === false ? `
                                                <span style="background: #fbbf24; color: #78350f; padding: 3px 6px; border-radius: 4px; font-size: 10px; font-weight: 600; margin-left: 6px;">
                                                    âš ï¸ CADASTRO INCOMPLETO
                                                </span>
                                            ` : ''}
                                        </div>
                                        ${idadePaciente ? `<div style="font-size: 13px; color: var(--text-light);">${idadePaciente}</div>` : ''}
                                    </div>
                                    <span class="agendamento-badge ${ag.status || 'agendado'}">${this.getStatusLabel(ag.status)}</span>
                                </div>

                                <div class="agendamento-info">
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ• HorÃ¡rio:</span>
                                        <span class="agendamento-info-valor"><strong>${ag.hora}</strong> - ${horarioFim}</span>
                                    </div>
                                    
                                    <div style="grid-column: 1 / -1; background: #f9fafb; padding: 8px; border-radius: 4px; margin-top: 4px; margin-bottom: 8px;">
                                        <div style="display: flex; gap: 12px; font-size: 13px; flex-wrap: nowrap; align-items: center;">
                                            <span style="white-space: nowrap;">â±ï¸ DuraÃ§Ã£o: <strong>${duracao}min</strong></span>
                                            <span style="white-space: nowrap;">ğŸ”§ Preparo: <strong>+${tempoPreparo}min</strong></span>
                                            <span style="color: #0284c7; white-space: nowrap;">ğŸ“Š Total: <strong>${duracaoTotal}min</strong></span>
                                        </div>
                                    </div>
                                    
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ‘¨â€âš•ï¸ Profissional:</span>
                                        <span class="agendamento-info-valor">${profissional ? profissional.nome + ' - ' + (profissional.especialidade || '') : 'NÃ£o definido'}</span>
                                    </div>
                                    
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ“ Sala:</span>
                                        <span class="agendamento-info-valor">${ev.local}</span>
                                    </div>
                                    
                                    ${ag.tipo ? `
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ“‹ Tipo:</span>
                                        <span class="agendamento-info-valor">${ag.tipo}</span>
                                    </div>
                                    ` : ''}
                                    
                                    ${paciente && paciente.telefone ? `
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ“ Telefone:</span>
                                        <span class="agendamento-info-valor">${paciente.telefone}</span>
                                    </div>
                                    ` : ''}
                                    
                                    ${ag.observacoes ? `
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ“ Obs:</span>
                                        <span class="agendamento-info-valor">${ag.observacoes}</span>
                                    </div>
                                    ` : ''}
                                </div>

                                <div class="agendamento-acoes">
                                    ${ag.status !== 'realizado' && ag.status !== 'cancelado' ? (
                                        paciente && paciente.cadastro_completo === false ? `
                                            <button class="btn btn-warning" onclick="Pacientes.editar(${ag.paciente_id})" title="Complete o cadastro antes de atender">
                                                ğŸ”„ Completar Cadastro
                                            </button>
                                        ` : `
                                            <button class="btn btn-success" onclick="Atendimentos.atenderDaAgenda(${ag.id})" title="Iniciar atendimento">
                                                ğŸ©º Atender
                                            </button>
                                        `
                                    ) : ''}
                                    ${ag.status === 'realizado' ? `
                                        <button class="btn btn-info" onclick="Atendimentos.verProntuario(${ag.paciente_id})" title="Ver prontuÃ¡rio">
                                            ğŸ‘ï¸ Ver ProntuÃ¡rio
                                        </button>
                                    ` : ''}
                                    ${ag.status !== 'realizado' && ag.status !== 'cancelado' ? `
                                        <button class="btn btn-primary btn-icon" onclick="Agenda.editar(${ag.id})" title="Editar">âœï¸</button>
                                        <button class="btn btn-warning btn-icon" onclick="Agenda.cancelar(${ag.id})" title="Cancelar">âŒ</button>
                                    ` : ''}
                                    <button class="btn btn-danger btn-icon" onclick="Agenda.excluir(${ag.id})" title="Excluir">ğŸ—‘ï¸</button>
                                </div>
                            </div>
                        `;
                    } else {
                        // INTERNAÃ‡ÃƒO / EMERGÃŠNCIA / CIRURGIA / RESERVA - Card simplificado
                        const rep = ev.dados;
                        const tipoRep = rep.tipo_reparticao || 'internacao'; // v10.98
                        const paciente = pacientes.find(p => p.id === (rep.paciente_id || rep.reservado_para_paciente_id));
                        
                        let idadePaciente = '';
                        if (paciente && paciente.nascimento) {
                            const nascimento = new Date(paciente.nascimento + 'T00:00:00');
                            const hoje = new Date();
                            let idade = hoje.getFullYear() - nascimento.getFullYear();
                            const mes = hoje.getMonth() - nascimento.getMonth();
                            if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
                                idade--;
                            }
                            idadePaciente = `${idade} anos`;
                        }
                        
                        html += `
                            <div class="agendamento-card" style="border-left: 4px solid ${ev.cor}">
                                <div class="agendamento-card-header">
                                    <div>
                                        <div class="agendamento-titulo">${ev.icone} ${paciente ? paciente.nome : 'Paciente nÃ£o encontrado'}</div>
                                        ${idadePaciente ? `<div style="font-size: 13px; color: var(--text-light);">${idadePaciente}</div>` : ''}
                                    </div>
                                    <span class="agendamento-badge" style="background: ${ev.cor}20; color: ${ev.cor}; border: 1px solid ${ev.cor}">
                                        ${ev.tipo.charAt(0).toUpperCase() + ev.tipo.slice(1)}
                                    </span>
                                </div>

                                <div class="agendamento-info">
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ“ Leito:</span>
                                        <span class="agendamento-info-valor"><strong>${ev.local}</strong></span>
                                    </div>
                                    
                                    ${rep.data_ocupacao ? `
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ“… Desde:</span>
                                        <span class="agendamento-info-valor">${new Date(rep.data_ocupacao).toLocaleString('pt-BR')}</span>
                                    </div>
                                    ` : ''}
                                    
                                    ${rep.motivo_internacao ? `
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ“‹ Motivo:</span>
                                        <span class="agendamento-info-valor">${rep.motivo_internacao}</span>
                                    </div>
                                    ` : ''}
                                    
                                    ${paciente && paciente.telefone ? `
                                    <div class="agendamento-info-item">
                                        <span class="agendamento-info-label">ğŸ“ Telefone:</span>
                                        <span class="agendamento-info-valor">${paciente.telefone}</span>
                                    </div>
                                    ` : ''}
                                </div>

                                <div class="agendamento-acoes">
                                    ${rep.bloqueado ? `
                                        <!-- BLOQUEADO: Apenas desbloquear -->
                                        <button class="btn btn-success btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Desbloquear">
                                            ğŸ”“ Desbloquear
                                        </button>
                                    ` : rep.status === 'livre' ? `
                                        <!-- v10.98: LIVRE - BotÃµes por tipo (nÃ£o mostrar Agendar/Reservar para emergÃªncia) -->
                                        ${tipoRep !== 'emergencia' ? `
                                        <button class="btn btn-success btn-icon" onclick="Agenda.abrirModal(null, ${rep.id});" title="Agendar Procedimento/Cirurgia">
                                            â• Agendar
                                        </button>
                                        ` : ''}
                                        ${(tipoRep === 'internacao') && PermissoesReserva.usuarioPodeReservar() ? `
                                        <button class="btn btn-warning btn-icon" onclick="Reparticoes.abrirModalReservar(${rep.id})" title="Reservar Leito (Matriciamento)">
                                            ğŸ“… Reservar
                                        </button>
                                        ` : ''}
                                        <button class="btn btn-danger btn-icon" onclick="Reparticoes.toggleBloqueio(${rep.id}); setTimeout(() => { Reparticoes.listar(); Agenda.renderizarCards(); }, 300);" title="Bloquear ${tipoRep === 'emergencia' ? 'leito' : 'unidade'}">
                                            â›” Bloquear
                                        </button>
                                    ` : rep.status === 'ocupado' && rep.paciente_id ? `
                                        <!-- OCUPADO: Apenas prontuÃ¡rio (alta Ã© via prontuÃ¡rio) -->
                                        <button class="btn btn-info btn-icon" onclick="Atendimentos.verProntuario(${rep.paciente_id})" title="Ver ProntuÃ¡rio">
                                            ğŸ“‹ ProntuÃ¡rio
                                        </button>
                                    ` : rep.status === 'reservado' ? `
                                        <!-- RESERVADO: Ver + Cancelar -->
                                        <button class="btn btn-info btn-icon" onclick="Reparticoes.verDetalhesReserva(${rep.id})" title="Ver Detalhes da Reserva">
                                            ğŸ‘ï¸ Ver Reserva
                                        </button>
                                        <button class="btn btn-danger btn-icon" onclick="Reparticoes.cancelarReserva(${rep.id})" title="Cancelar Reserva">
                                            âŒ Cancelar
                                        </button>
                                    ` : ''}
                                    <button class="btn btn-primary btn-icon" onclick="Sistema.trocarTab('gestao'); setTimeout(() => Gestao.trocarAba('mapa'), 100);" title="Ver no Mapa das Unidades">ğŸ—ºï¸</button>
                                </div>
                            </div>
                        `;
                    }
                });
                
                container.innerHTML = html;
            },

            calcularHorarioFim(horaInicio, duracao, tempo_preparo = 0) {
                const [h, m] = horaInicio.split(':').map(Number);
                // v10.55.2: CORREÃ‡ÃƒO - Considerar tempo TOTAL (duraÃ§Ã£o + preparo)
                const totalMinutos = h * 60 + m + duracao + tempo_preparo;
                const hFim = Math.floor(totalMinutos / 60);
                const mFim = totalMinutos % 60;
                return `${String(hFim).padStart(2, '0')}:${String(mFim).padStart(2, '0')}`;
            },

            // v9.0: Calcular e exibir tempo total (duraÃ§Ã£o + preparo)
            calcularTempoTotal() {
                const repId = parseInt(document.getElementById('agend-reparticao').value);
                const duracao = parseInt(document.getElementById('agend-duracao').value) || 30;
                const tempoPreparo = parseInt(document.getElementById('agend-tempo-preparo').value) || 0;
                
                const duracaoTotal = duracao + tempoPreparo;
                
                // Atualizar display
                document.getElementById('agend-display-duracao').textContent = `${duracao}min`;
                document.getElementById('agend-display-preparo').textContent = `${tempoPreparo}min`;
                document.getElementById('agend-display-total').textContent = `${duracaoTotal}min`;
                document.getElementById('agend-info-preparo').style.display = 'block';
                
                // Se mudou a unidade, preencher com tempo padrÃ£o
                if (repId && event && event.target.id === 'agend-reparticao') {
                    const reparticao = SistemaCore.dados.reparticoes.find(r => r.id === repId);
                    const tipoUnidade = reparticao ? reparticao.tipo_reparticao || 'consultorio' : 'consultorio';
                    const tempoPreparoPadrao = (SistemaCore.dados.tempos_preparo && SistemaCore.dados.tempos_preparo[tipoUnidade]) || 10;
                    document.getElementById('agend-tempo-preparo').value = tempoPreparoPadrao;
                    // Recalcular com novo valor
                    this.calcularTempoTotal();
                }
            },

            getStatusLabel(status) {
                const labels = {
                    'agendado': 'Agendado',
                    'realizado': 'Realizado',
                    'cancelado': 'Cancelado'
                };
                return labels[status] || 'Agendado';
            },

            selecionarData(data) {
                this.dataSelecionada = data;
                this.listar();
                Calendario.renderizar(); // Atualizar destaque no calendÃ¡rio
            },

            carregarFiltros() {
                // Carregar profissionais no filtro
                const selectProf = document.getElementById('filtro-profissional-agenda');
                selectProf.innerHTML = '<option value="">Todos</option>';
                SistemaCore.dados.profissionais.forEach(prof => {
                    selectProf.innerHTML += `<option value="${prof.id}">${prof.nome} - ${prof.especialidade}</option>`;
                });

                // Definir data de hoje como padrÃ£o
                document.getElementById('filtro-data-agenda').value = new Date().toISOString().split('T')[0];
            },

            editar(id) {
                this.abrirModal(id);
            },

            cancelar(id) {
                if (!confirm('Deseja cancelar este agendamento?')) return;
                
                const agend = SistemaCore.dados.agendamentos.find(a => a.id === id);
                if (agend) {
                    agend.status = 'cancelado';
                    SistemaCore.salvar();
                    Sistema.notificar('Agendamento cancelado!');
                    Sistema.atualizarDashboard();
                    
                    // v10.86: Sincronizar todas as visualizaÃ§Ãµes
                    SistemaCore.sincronizarVisualizacoes();
                }
            },

            excluir(id) {
                if (!confirm('Deseja excluir permanentemente este agendamento?')) return;
                SistemaCore.dados.agendamentos = SistemaCore.dados.agendamentos.filter(a => a.id !== id);
                SistemaCore.salvar();
                Sistema.notificar('Agendamento excluÃ­do!');
                Sistema.atualizarDashboard();
                
                // v10.86: Sincronizar todas as visualizaÃ§Ãµes
                SistemaCore.sincronizarVisualizacoes();
            },

            abrirModal(id = null, reparticaoId = null) {
                // v10.53.2: CORREÃ‡ÃƒO - Recarregar dados do localStorage antes de popular
                console.log('ğŸ”„ [DEBUG] Recarregando dados do localStorage...');
                const dadosAntigos = SistemaCore.dados.pacientes.length;
                SistemaCore.carregar();
                const dadosNovos = SistemaCore.dados.pacientes.length;
                console.log(`ğŸ“Š [DEBUG] Pacientes antes: ${dadosAntigos}, depois: ${dadosNovos}`);
                
                const selectPac = document.getElementById('agend-paciente');
                const selectProf = document.getElementById('agend-profissional');
                const selectRep = document.getElementById('agend-reparticao');
                const selectTipo = document.getElementById('agend-tipo'); // v10.61
                
                // v10.61: Carregar tipos de atendimento do pool
                selectTipo.innerHTML = '';
                const tiposAtendimento = SistemaCore.dados.estabelecimento.tiposAtendimento || [];
                tiposAtendimento.forEach(tipo => {
                    const value = tipo.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '');
                    selectTipo.innerHTML += `<option value="${value}">${tipo}</option>`;
                });
                
                // v10.54: DEBUG - Verificar pacientes disponÃ­veis
                console.log('ğŸ“‹ [DEBUG AGENDA] Total de pacientes:', SistemaCore.dados.pacientes.length);
                console.log('ğŸ“‹ [DEBUG AGENDA] Pacientes:', SistemaCore.dados.pacientes.map(p => `${p.id}: ${p.nome} (completo: ${p.cadastro_completo})`));
                
                selectPac.innerHTML = '<option value="">Selecione um paciente...</option>';
                SistemaCore.dados.pacientes
                    .filter(pac => {
                        // v10.463: Excluir "NÃ£o Identificado" da lista de agendamento
                        const nome = (pac.nome || '').toUpperCase();
                        return !nome.includes('NÃƒO IDENTIFICADO') && !nome.includes('NAO IDENTIFICADO');
                    })
                    .forEach(pac => {
                        // v10.54: Indicador de cadastro incompleto
                        const cadastroIncompleto = pac.cadastro_completo === false;
                        const indicador = cadastroIncompleto ? 'âš ï¸ ' : '';
                        const telInfo = pac.telefone ? ` (Tel: ${pac.telefone})` : '';
                        selectPac.innerHTML += `<option value="${pac.id}">${indicador}${pac.nome}${cadastroIncompleto ? telInfo : ''}</option>`;
                        console.log(`  âœ… Adicionado ao select: ${pac.id} - ${pac.nome}`);
                    });

                selectProf.innerHTML = '<option value="">Selecione um profissional...</option>';
                SistemaCore.dados.profissionais.forEach(prof => {
                    selectProf.innerHTML += `<option value="${prof.id}">${prof.nome} - ${prof.especialidade}</option>`;
                });

                // Popular repartiÃ§Ãµes (v7.5.5) - FILTRAR FANTASMAS e INDISPONÃVEIS
                selectRep.innerHTML = '<option value="">Selecione uma unidade...</option>';
                
                // Filtrar apenas repartiÃ§Ãµes vÃ¡lidas (nÃ£o Ã³rfÃ£s) E DISPONÃVEIS
                const reparticoesValidas = SistemaCore.dados.reparticoes.filter(rep => {
                    // v10.38: Filtrar bloqueados
                    if (rep.bloqueado) {
                        console.log(`â›” [FILTRO] "${rep.nome}" bloqueado`);
                        return false;
                    }
                    
                    // Se nÃ£o Ã© sub-repartiÃ§Ã£o, Ã© vÃ¡lida (grupo principal)
                    if (!rep.eh_subreparticao) return true;
                    
                    // Se Ã© sub-repartiÃ§Ã£o, verificar se o pai existe
                    const temPai = SistemaCore.dados.reparticoes.some(r => 
                        r.subreparticoes_ids && r.subreparticoes_ids.includes(rep.id)
                    );
                    return temPai;
                });
                
                console.log(`ğŸ“‹ [AGENDAMENTO] Total de repartiÃ§Ãµes: ${SistemaCore.dados.reparticoes.length}`);
                console.log(`ğŸ“‹ [AGENDAMENTO] RepartiÃ§Ãµes vÃ¡lidas (sem fantasmas): ${reparticoesValidas.length}`);
                
                // v10.111: PADRONIZADO - Agrupar por grupo principal + sub-repartiÃ§Ãµes
                const gruposPrincipais = reparticoesValidas.filter(r => !r.eh_subreparticao);
                
                gruposPrincipais.forEach(grupo => {
                    // Adicionar grupo principal
                    selectRep.innerHTML += `<option value="${grupo.id}">${grupo.nome}</option>`;
                    
                    // Adicionar sub-repartiÃ§Ãµes do grupo
                    const subs = reparticoesValidas.filter(r => 
                        r.eh_subreparticao && 
                        grupo.subreparticoes_ids && 
                        grupo.subreparticoes_ids.includes(r.id)
                    );
                    
                    subs.forEach(sub => {
                        selectRep.innerHTML += `<option value="${sub.id}">    â†³ ${sub.nome}</option>`;
                    });
                });

                if (id) {
                    const agend = SistemaCore.dados.agendamentos.find(a => a.id === id);
                    if (!agend) return;
                    document.getElementById('tituloModalAgendamento').textContent = 'âœï¸ Editar Agendamento';
                    document.getElementById('edit-agendamento-id').value = agend.id;
                    document.getElementById('agend-paciente').value = agend.paciente_id;
                    document.getElementById('agend-profissional').value = agend.profissional_id;
                    document.getElementById('agend-reparticao').value = agend.reparticao_id || '';
                    document.getElementById('agend-data').value = agend.data;
                    document.getElementById('agend-hora').value = agend.hora;
                    document.getElementById('agend-duracao').value = agend.duracao || 30;
                    document.getElementById('agend-tempo-preparo').value = agend.tempo_preparo || 0; // v9.0.1: CORRIGIDO - Carregar tempo de preparo
                    document.getElementById('agend-tipo').value = agend.tipo || 'consulta';
                    document.getElementById('agend-obs').value = agend.observacoes || '';
                } else {
                    document.getElementById('tituloModalAgendamento').textContent = 'â• Novo Agendamento';
                    document.getElementById('edit-agendamento-id').value = '';
                    
                    // v10.53.4: CORRIGIDO - Usar data selecionada do calendÃ¡rio (se houver) ou data de hoje
                    const dataParaUsar = this.dataSelecionada || new Date().toISOString().split('T')[0];
                    console.log(`ğŸ“… [DEBUG] Preenchendo data do modal: ${dataParaUsar} (dataSelecionada: ${this.dataSelecionada})`);
                    document.getElementById('agend-data').value = dataParaUsar;
                    
                    if (!document.getElementById('agend-hora').value) {
                        document.getElementById('agend-hora').value = '08:00';
                    }
                    document.getElementById('agend-duracao').value = '30';
                    
                    // v10.65: PRÃ‰-CONFIGURAÃ‡ÃƒO BASEADA NA REPARTIÃ‡ÃƒO
                    if (reparticaoId) {
                        const reparticao = SistemaCore.dados.reparticoes.find(r => r.id === parseInt(reparticaoId));
                        if (reparticao) {
                            console.log(`ğŸ¯ [AGENDAMENTO] PrÃ©-configurando para repartiÃ§Ã£o:`, reparticao.nome, reparticao.tipo_reparticao);
                            
                            // Mapear tipo de repartiÃ§Ã£o â†’ tipo de atendimento
                            const mapaTipos = {
                                'consultorio': 'consulta',
                                'procedimento': 'procedimento',
                                'exames': 'exame',
                                'exames_laboratorio': 'exame',  // v10.105: NOVO
                                'exames_imagem': 'exame',        // v10.105: NOVO
                                'bloco_cirurgico': 'cirurgia',
                                'internacao': 'internacao',
                                'emergencia': 'emergencia'
                            };
                            
                            const tipoReparticao = reparticao.tipo_reparticao || 'consultorio';
                            const tipoAtendimento = mapaTipos[tipoReparticao] || 'consulta';
                            
                            document.getElementById('agend-tipo').value = tipoAtendimento;
                            console.log(`âœ… [AGENDAMENTO] Tipo prÃ©-selecionado: ${tipoAtendimento}`);
                        }
                    } else {
                        document.getElementById('agend-tipo').value = 'consulta';
                    }
                    
                    document.getElementById('agend-obs').value = '';
                }
                document.getElementById('modalAgendamento').classList.add('active');
                
                // v8.0.11: Filtrar unidades baseado no tipo inicial
                this.filtrarUnidadesPorTipo();
                
                // v10.65: PrÃ©-selecionar repartiÃ§Ã£o apÃ³s filtrar
                if (reparticaoId && !id) {
                    setTimeout(() => {
                        document.getElementById('agend-reparticao').value = reparticaoId;
                        console.log(`âœ… [AGENDAMENTO] RepartiÃ§Ã£o prÃ©-selecionada: ${reparticaoId}`);
                    }, 100);
                }
            },

            // v8.0.11: NOVO - Filtrar unidades baseado no tipo de agendamento
            // v10.61: Atualizado para incluir InternaÃ§Ã£o e EmergÃªncia
            filtrarUnidadesPorTipo() {
                const tipoAgendamento = document.getElementById('agend-tipo').value;
                const selectRep = document.getElementById('agend-reparticao');
                const valorAtual = selectRep.value; // Salvar seleÃ§Ã£o atual
                
                // v10.61: Mapear tipo de atendimento â†’ tipo de repartiÃ§Ã£o
                const mapaTipos = {
                    'consulta': 'consultorio',
                    'retorno': 'consultorio',
                    'procedimento': 'procedimento',
                    'exame': 'exames',
                    'cirurgia': 'bloco_cirurgico',
                    'internacao': 'internacao',      // v10.61: NOVO
                    'emergencia': 'emergencia'        // v10.61: NOVO
                };
                
                const tipoReparticao = mapaTipos[tipoAgendamento] || 'consultorio';
                
                console.log(`ğŸ” [FILTRO] Tipo agendamento: ${tipoAgendamento} â†’ Tipo repartiÃ§Ã£o: ${tipoReparticao}`);
                
                // Filtrar repartiÃ§Ãµes vÃ¡lidas
                const reparticoesValidas = SistemaCore.dados.reparticoes.filter(rep => {
                    // v10.38: Filtrar bloqueados
                    if (rep.bloqueado) {
                        console.log(`â›” [FILTRO-TIPO] "${rep.nome}" bloqueado`);
                        return false;
                    }
                    
                    // Se nÃ£o Ã© sub-repartiÃ§Ã£o, Ã© vÃ¡lida (grupo principal)
                    if (!rep.eh_subreparticao) return true;
                    
                    // Se Ã© sub-repartiÃ§Ã£o, verificar se o pai existe
                    const temPai = SistemaCore.dados.reparticoes.some(r => 
                        r.subreparticoes_ids && r.subreparticoes_ids.includes(rep.id)
                    );
                    return temPai;
                });
                
                // v8.0.11: FILTRAR POR TIPO
                // v10.99: CORRIGIDO - Aceitar variaÃ§Ãµes de exames
                let reparticoesFiltradas = reparticoesValidas.filter(rep => {
                    const tipo = rep.tipo_reparticao || 'consultorio';
                    
                    // Para exames: aceitar 'exames', 'exames_laboratorio', 'exames_imagem'
                    if (tipoReparticao === 'exames') {
                        return tipo === 'exames' || tipo === 'exames_laboratorio' || tipo === 'exames_imagem';
                    }
                    
                    return tipo === tipoReparticao;
                });
                
                // v8.0.12: PROTEÃ‡ÃƒO EXTRA - Remover proteÃ§Ã£o contra leitos para internaÃ§Ã£o/emergÃªncia
                // v10.61: Apenas bloquear leitos para consultas, procedimentos, exames e cirurgias
                if (!['internacao', 'emergencia'].includes(tipoAgendamento)) {
                    reparticoesFiltradas = reparticoesFiltradas.filter(rep => {
                        const nome = (rep.nome || '').toLowerCase();
                        const ehLeito = nome.includes('leito') || nome.includes('berÃ§o');
                        
                        if (ehLeito) {
                            console.log(`ğŸš« [PROTEÃ‡ÃƒO] "${rep.nome}" bloqueado - Ã© leito (tipo: ${tipoAgendamento})!`);
                            return false; // Bloquear leitos apenas para nÃ£o-internaÃ§Ãµes
                        }
                        return true;
                    });
                }
                
                console.log(`ğŸ“Š [FILTRO] Total vÃ¡lidas: ${reparticoesValidas.length}`);
                console.log(`ğŸ“Š [FILTRO] ApÃ³s filtrar por tipo "${tipoReparticao}": ${reparticoesFiltradas.length}`);
                
                // Recarregar select
                selectRep.innerHTML = '<option value="">Selecione uma unidade...</option>';
                
                if (reparticoesFiltradas.length === 0) {
                    selectRep.innerHTML += `<option value="" disabled style="color: #ef4444;">âŒ Nenhuma unidade do tipo "${tipoReparticao}" cadastrada</option>`;
                } else {
                    // v10.111: PADRONIZADO - Agrupado por tipo com separadores visuais
                    const gruposPrincipais = reparticoesFiltradas.filter(r => !r.eh_subreparticao);
                    
                    gruposPrincipais.forEach(grupo => {
                        // Adicionar grupo principal
                        selectRep.innerHTML += `<option value="${grupo.id}">${grupo.nome}</option>`;
                        
                        // Adicionar sub-repartiÃ§Ãµes do grupo
                        const subs = reparticoesFiltradas.filter(r => 
                            r.eh_subreparticao && 
                            grupo.subreparticoes_ids && 
                            grupo.subreparticoes_ids.includes(r.id)
                        );
                        
                        subs.forEach(sub => {
                            selectRep.innerHTML += `<option value="${sub.id}">    â†³ ${sub.nome}</option>`;
                        });
                    });
                    
                    // Adicionar sub-repartiÃ§Ãµes Ã³rfÃ£s (se houver)
                    const orfas = reparticoesFiltradas.filter(r => {
                        if (!r.eh_subreparticao) return false;
                        const temPai = gruposPrincipais.some(g => 
                            g.subreparticoes_ids && g.subreparticoes_ids.includes(r.id)
                        );
                        return !temPai;
                    });
                    
                    if (orfas.length > 0) {
                        orfas.forEach(orfa => {
                            selectRep.innerHTML += `<option value="${orfa.id}">    â†³ ${orfa.nome}</option>`;
                        });
                    }
                }
                
                // Restaurar seleÃ§Ã£o se ainda existe apÃ³s filtro
                if (valorAtual && reparticoesFiltradas.some(r => r.id === parseInt(valorAtual))) {
                    selectRep.value = valorAtual;
                }
            },

            fecharModal() {
                document.getElementById('modalAgendamento').classList.remove('active');
            },
            
            // v10.84: CORRIGIDO - NÃƒO fecha modal de agendamento, apenas abre prÃ©-cadastro por cima
            abrirPreCadastroAgenda() {
                console.log('ğŸš€ [AGENDA] Abrindo prÃ©-cadastro (modal de agenda fica aberto)');
                
                // Abrir prÃ©-cadastro SEM fechar modal de agendamento
                PreCadastro.abrir('agenda');
            },

            // v10.53: PRÃ‰-CADASTRO RÃPIDO
            abrirPreCadastro() {
                console.log('ğŸš€ [PRÃ‰-CADASTRO] Abrindo modal de prÃ©-cadastro');
                // Limpar campos
                document.getElementById('pre-nome').value = '';
                document.getElementById('pre-telefone').value = '';
                document.getElementById('pre-nascimento').value = '';
                // Abrir modal
                document.getElementById('modalPreCadastro').classList.add('active');
            },

            fecharPreCadastro() {
                document.getElementById('modalPreCadastro').classList.remove('active');
            },

            salvarPreCadastro() {
                const nome = document.getElementById('pre-nome').value.trim();
                const telefone = document.getElementById('pre-telefone').value.trim();
                const nascimento = document.getElementById('pre-nascimento').value;

                // ValidaÃ§Ã£o
                if (!nome) {
                    Sistema.notificar('âš ï¸ Nome Ã© obrigatÃ³rio!', 'error');
                    return;
                }
                if (!telefone) {
                    Sistema.notificar('âš ï¸ Telefone Ã© obrigatÃ³rio!', 'error');
                    return;
                }

                // Criar paciente com cadastro mÃ­nimo (pode agendar, mas nÃ£o pode atender)
                const novoId = SistemaCore.dados.pacientes.length > 0 
                    ? Math.max(...SistemaCore.dados.pacientes.map(p => p.id)) + 1 
                    : 1;

                const novoPaciente = {
                    id: novoId,
                    nome: nome,
                    telefone: telefone,
                    nascimento: nascimento || '',
                    
                    // v10.54: NOVO SISTEMA - Cadastro incompleto (precisa completar para atender)
                    cadastro_completo: false,
                    data_cadastro: new Date().toISOString().split('T')[0],
                    
                    // Campos padrÃ£o vazios
                    cpf: '',
                    rg: '',
                    sexo: 'N',
                    email: '',
                    celular: '',
                    endereco: '',
                    cidade: '',
                    estado: '',
                    cep: '',
                    convenio_id: null,
                    cor_raca: '',
                    estado_civil: '',
                    naturalidade: '',
                    profissao: '',
                    situacao_vinculo: '',
                    nome_mae: '',
                    nome_pai: '',
                    dados_adicionais: '',
                    tipo_contato: 'direto',
                    comentario_contato: '',
                    estrangeiro: false,
                    pais: '',
                    tipo_documento: 'provisorio',
                    numero_documento: `TEMP-${novoId}`,
                    prontuario: `PRE-${novoId.toString().padStart(6, '0')}`
                };

                // Adicionar ao sistema
                SistemaCore.dados.pacientes.push(novoPaciente);
                SistemaCore.salvar();

                console.log('âœ… [CADASTRO RÃPIDO] Paciente criado (cadastro_completo: false):', novoPaciente);
                Sistema.notificar('âœ… Cadastro rÃ¡pido realizado! Complete os dados antes de atender.', 'success');

                // Fechar modal de prÃ©-cadastro
                this.fecharPreCadastro();

                // Reabrir modal de agendamento com o paciente jÃ¡ selecionado
                this.abrirModal();
                
                // CORREÃ‡ÃƒO: Aguardar DOM atualizar antes de selecionar
                setTimeout(() => {
                    const select = document.getElementById('agend-paciente');
                    select.value = novoId;
                    console.log('âœ… [CADASTRO RÃPIDO] Paciente selecionado no select:', novoId);
                    
                    // Verificar se realmente selecionou
                    if (select.value != novoId) {
                        console.error('âŒ [CADASTRO RÃPIDO] Falha ao selecionar paciente. Tentando novamente...');
                        select.value = String(novoId); // Tentar como string
                    }
                }, 100);
            },

            salvar() {
                const paciente_id = parseInt(document.getElementById('agend-paciente').value);
                const profissional_id = parseInt(document.getElementById('agend-profissional').value);
                const reparticao_id = parseInt(document.getElementById('agend-reparticao').value);
                const data = document.getElementById('agend-data').value;
                const hora = document.getElementById('agend-hora').value;
                const duracao = parseInt(document.getElementById('agend-duracao').value) || 30;
                const tempo_preparo = parseInt(document.getElementById('agend-tempo-preparo').value) || 0; // v9.0
                const tipo = document.getElementById('agend-tipo').value;
                const observacoes = document.getElementById('agend-obs').value.trim();
                const editId = document.getElementById('edit-agendamento-id').value;

                if (!paciente_id || !profissional_id || !data || !hora) {
                    Sistema.notificar('Preencha todos os campos obrigatÃ³rios!', 'error');
                    return;
                }
                
                // v10.463: VALIDAÃ‡ÃƒO - Verificar cadastro completo
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === paciente_id);
                if (!paciente) {
                    Sistema.notificar('âŒ Paciente nÃ£o encontrado!', 'error');
                    return;
                }
                
                // Bloquear agendamento para "NÃ£o Identificado"
                const nomeUpper = (paciente.nome || '').toUpperCase();
                const ehNaoIdentificado = nomeUpper.includes('NÃƒO IDENTIFICADO') || nomeUpper.includes('NAO IDENTIFICADO');
                
                if (ehNaoIdentificado) {
                    Sistema.notificar('âŒ NÃ£o Ã© possÃ­vel agendar para paciente "NÃ£o Identificado".\n\nIdentifique o paciente primeiro.', 'error');
                    return;
                }
                
                // v10.463: PRÃ‰-CADASTRO PERMITIDO NA AGENDA (Ãºnico local)
                // Apenas mostra aviso, nÃ£o bloqueia
                if (paciente.cadastro_completo === false) {
                    console.log('[v10.463] Agendando paciente com prÃ©-cadastro:', paciente.nome);
                    // NÃ£o bloqueia - prÃ©-cadastro na agenda Ã© permitido
                }
                
                // ğŸ”´ FASE 1 - ETAPA 1.2: Validar agendamento no passado
                const hoje = new Date();
                hoje.setHours(0, 0, 0, 0);
                const dataAgendamento = new Date(data + 'T00:00:00');
                
                if (dataAgendamento < hoje) {
                    Sistema.notificar('âŒ NÃ£o Ã© possÃ­vel agendar em datas passadas!', 'error');
                    return;
                }
                
                // Se for hoje, verificar se hora jÃ¡ passou
                if (dataAgendamento.getTime() === hoje.getTime()) {
                    const agora = new Date();
                    const [horaAgend, minAgend] = hora.split(':').map(Number);
                    const horarioAgendamento = new Date();
                    horarioAgendamento.setHours(horaAgend, minAgend, 0, 0);
                    
                    if (horarioAgendamento < agora) {
                        Sistema.notificar('âŒ NÃ£o Ã© possÃ­vel agendar em horÃ¡rios que jÃ¡ passaram!', 'error');
                        return;
                    }
                }
                
                // v10.463: VALIDAÃ‡ÃƒO - Verificar agendamento duplicado (mesmo paciente, mesma data)
                const agendamentosDuplicados = (SistemaCore.dados.agendamentos || []).filter(ag => 
                    ag.paciente_id === paciente_id && 
                    ag.data === data &&
                    ag.status !== 'cancelado' &&
                    ag.id !== parseInt(editId) // Ignorar se estiver editando o mesmo
                );
                
                if (agendamentosDuplicados.length > 0) {
                    const agDup = agendamentosDuplicados[0];
                    const profDup = SistemaCore.dados.profissionais?.find(p => p.id === agDup.profissional_id);
                    
                    Sistema.notificar(
                        `âŒ PACIENTE JÃ AGENDADO NESTA DATA!\n\n` +
                        `${paciente.nome} jÃ¡ tem agendamento para ${new Date(data + 'T00:00:00').toLocaleDateString('pt-BR')}:\n\n` +
                        `ğŸ“… ${agDup.hora} - ${agDup.tipo || 'Consulta'}\n` +
                        `ğŸ‘¨â€âš•ï¸ ${profDup?.nome || 'Profissional nÃ£o informado'}\n\n` +
                        `Se precisar de outro horÃ¡rio, cancele o agendamento existente primeiro.`,
                        'error'
                    );
                    return;
                }
                
                // v10.38: VALIDAÃ‡ÃƒO - Verificar se repartiÃ§Ã£o estÃ¡ bloqueada
                if (reparticao_id) {
                    const reparticao = SistemaCore.dados.reparticoes.find(r => r.id === reparticao_id);
                    if (reparticao && reparticao.bloqueado) {
                        Sistema.notificar(
                            `â›” UNIDADE BLOQUEADA!\n\n` +
                            `A unidade "${reparticao.nome}" estÃ¡ BLOQUEADA.\n\n` +
                            `NÃ£o Ã© possÃ­vel criar agendamentos em unidades bloqueadas.\n\n` +
                            `Para agendar:\n` +
                            `1. VÃ¡ em GestÃ£o â†’ Mapa das Unidades\n` +
                            `2. Clique no botÃ£o ğŸŸ¢ para desbloquear\n` +
                            `3. Ou escolha outra unidade disponÃ­vel`,
                            'error'
                        );
                        return;
                    }
                }
                
                // v9.2: NOVA VALIDAÃ‡ÃƒO - Verificar se paciente estÃ¡ internado ou reservado
                const pacienteInternado = SistemaCore.dados.reparticoes.find(r => 
                    r.status === 'ocupado' && r.paciente_id === paciente_id
                );
                
                const pacienteReservado = SistemaCore.dados.reparticoes.find(r => 
                    r.status === 'reservado' && r.reservado_para_paciente_id === paciente_id
                );
                
                if (pacienteInternado) {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === paciente_id);
                    Sistema.notificar(
                        `âš ï¸ PACIENTE INTERNADO!\n\n` +
                        `${paciente ? paciente.nome : 'Paciente'} estÃ¡ internado(a) em ${pacienteInternado.nome}!\n\n` +
                        `NÃ£o Ã© possÃ­vel agendar procedimentos para pacientes internados.\n\n` +
                        `Para realizar procedimentos:\n` +
                        `1. Acesse o ProntuÃ¡rio do paciente\n` +
                        `2. Registre o procedimento na internaÃ§Ã£o`,
                        'error'
                    );
                    return;
                }
                
                if (pacienteReservado) {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === paciente_id);
                    if (!confirm(
                        `âš ï¸ ATENÃ‡ÃƒO: LEITO RESERVADO\n\n` +
                        `${paciente ? paciente.nome : 'Paciente'} tem leito reservado em ${pacienteReservado.nome}!\n\n` +
                        `Data prevista: ${pacienteReservado.data_prevista_entrada ? new Date(pacienteReservado.data_prevista_entrada + 'T00:00:00').toLocaleDateString('pt-BR') : 'NÃ£o informada'}\n\n` +
                        `Deseja continuar com o agendamento mesmo assim?`
                    )) {
                        return;
                    }
                }
                
                // v8.0.12: VALIDAÃ‡ÃƒO EXTRA - Impedir agendamento em leitos
                if (reparticao_id) {
                    const reparticao = SistemaCore.dados.reparticoes.find(r => r.id === reparticao_id);
                    if (reparticao) {
                        const nome = (reparticao.nome || '').toLowerCase();
                        const ehLeito = nome.includes('leito') || nome.includes('berÃ§o');
                        
                        if (ehLeito) {
                            Sistema.notificar(
                                'ğŸš« ERRO: NÃ£o Ã© possÃ­vel agendar em leitos!\n\n' +
                                'Leitos sÃ£o para INTERNAÃ‡ÃƒO, nÃ£o para agendamentos.\n\n' +
                                'Para internar:\n' +
                                '1. VÃ¡ em: Estabelecimento â†’ Mapa das Unidades\n' +
                                '2. Clique em: ğŸ“… Reservar Leito\n' +
                                '3. Depois emita AIH no ProntuÃ¡rio',
                                'error'
                            );
                            return;
                        }
                    }
                }

                // VERIFICAR SOBREPOSIÃ‡ÃƒO DE HORÃRIOS
                // v10.55.2: CORREÃ‡ÃƒO - Usar tempo TOTAL (duraÃ§Ã£o + preparo) para calcular fim
                const horaInicio = hora;
                const horaFim = this.calcularHorarioFim(hora, duracao, tempo_preparo);
                
                const conflito = this.verificarSobreposicao(
                    profissional_id, 
                    reparticao_id, 
                    data, 
                    horaInicio, 
                    horaFim, 
                    editId ? parseInt(editId) : null
                );

                if (conflito) {
                    Sistema.notificar(
                        `âš ï¸ CONFLITO DE HORÃRIO!\n\n` +
                        `${conflito.tipo}: ${conflito.nome}\n` +
                        `HorÃ¡rio: ${conflito.hora}\n` +
                        `Paciente: ${conflito.paciente}\n\n` +
                        `Escolha outro horÃ¡rio ou profissional/sala.`,
                        'error'
                    );
                    return;
                }

                // v10.55.6: VALIDAÃ‡ÃƒO DE ESPECIALIDADE (com aviso, nÃ£o bloqueio)
                if (reparticao_id && profissional_id) {
                    const avisoEspecialidade = this.verificarEspecialidadeUnidade(profissional_id, reparticao_id);
                    if (avisoEspecialidade) {
                        if (!confirm(avisoEspecialidade)) {
                            return; // UsuÃ¡rio cancelou
                        }
                        // UsuÃ¡rio confirmou, continua o agendamento
                    }
                }

                if (editId) {
                    const agend = SistemaCore.dados.agendamentos.find(a => a.id === parseInt(editId));
                    if (agend) {
                        agend.paciente_id = paciente_id;
                        agend.profissional_id = profissional_id;
                        agend.reparticao_id = reparticao_id;
                        agend.data = data;
                        agend.hora = hora;
                        agend.duracao = duracao;
                        agend.tempo_preparo = tempo_preparo; // v9.0
                        agend.tipo = tipo;
                        agend.observacoes = observacoes;
                    }
                } else {
                    SistemaCore.dados.agendamentos.push({
                        id: SistemaCore.proximoId(SistemaCore.dados.agendamentos),
                        paciente_id,
                        profissional_id,
                        reparticao_id,
                        data,
                        hora,
                        duracao,
                        tempo_preparo, // v9.0
                        tipo,
                        observacoes,
                        status: 'agendado'
                    });
                }

                SistemaCore.salvar();
                this.fecharModal();
                Sistema.notificar('âœ… Agendamento salvo com sucesso!', 'success');
                Sistema.atualizarDashboard();
                
                // v10.86: Sincronizar todas as visualizaÃ§Ãµes
                SistemaCore.sincronizarVisualizacoes();
            },

            verificarSobreposicao(profissional_id, reparticao_id, data, horaInicio, horaFim, agendamentoEditandoId) {
                const agendamentos = SistemaCore.dados.agendamentos.filter(a => 
                    a.data === data && 
                    a.status !== 'cancelado' &&
                    a.id !== agendamentoEditandoId
                );

                for (const ag of agendamentos) {
                    // v10.55.2: CORREÃ‡ÃƒO - Calcular tempo_preparo do agendamento existente
                    const reparticao = SistemaCore.dados.reparticoes.find(r => r.id === ag.reparticao_id);
                    const tipoUnidade = reparticao ? reparticao.tipo_reparticao || 'consultorio' : 'consultorio';
                    const tempoPreparo = ag.tempo_preparo !== undefined 
                        ? ag.tempo_preparo 
                        : ((SistemaCore.dados.tempos_preparo && SistemaCore.dados.tempos_preparo[tipoUnidade]) || 10);
                    
                    // v10.55.2: CORREÃ‡ÃƒO - Usar tempo TOTAL (duraÃ§Ã£o + preparo)
                    const agHoraFim = this.calcularHorarioFim(ag.hora, ag.duracao || 30, tempoPreparo);
                    
                    // Verificar sobreposiÃ§Ã£o de horÃ¡rios
                    const sobrepoe = (horaInicio < agHoraFim && horaFim > ag.hora);
                    
                    if (sobrepoe) {
                        // v9.2: NOVO - Verifica se Ã© mesmo PACIENTE
                        // Buscar paciente_id do agendamento que estamos tentando criar
                        const novoPacienteId = parseInt(document.getElementById('agend-paciente').value);
                        if (ag.paciente_id === novoPacienteId) {
                            const paciente = SistemaCore.dados.pacientes.find(p => p.id === novoPacienteId);
                            const reparticaoConflito = SistemaCore.dados.reparticoes.find(r => r.id === ag.reparticao_id);
                            const profissionalConflito = SistemaCore.dados.profissionais.find(p => p.id === ag.profissional_id);
                            return {
                                tipo: 'ğŸš« PACIENTE JÃ TEM COMPROMISSO',
                                nome: paciente ? paciente.nome : 'Paciente',
                                hora: `${ag.hora} - ${agHoraFim}`,
                                paciente: `${ag.tipo || 'Agendamento'} com ${profissionalConflito ? profissionalConflito.nome : 'profissional'} em ${reparticaoConflito ? reparticaoConflito.nome : 'local nÃ£o informado'}`
                            };
                        }
                        
                        // Verifica se Ã© mesmo profissional
                        if (ag.profissional_id === profissional_id) {
                            const profissional = SistemaCore.dados.profissionais.find(p => p.id === profissional_id);
                            const paciente = SistemaCore.dados.pacientes.find(p => p.id === ag.paciente_id);
                            return {
                                tipo: 'Profissional jÃ¡ ocupado',
                                nome: profissional ? profissional.nome : 'Profissional',
                                hora: `${ag.hora} - ${agHoraFim}`,
                                paciente: paciente ? paciente.nome : 'Paciente'
                            };
                        }
                        
                        // Verifica se Ã© mesma repartiÃ§Ã£o/sala
                        if (reparticao_id && ag.reparticao_id === reparticao_id) {
                            const reparticao = SistemaCore.dados.reparticoes.find(r => r.id === reparticao_id);
                            const paciente = SistemaCore.dados.pacientes.find(p => p.id === ag.paciente_id);
                            return {
                                tipo: 'Sala jÃ¡ ocupada',
                                nome: reparticao ? reparticao.nome : 'Sala',
                                hora: `${ag.hora} - ${agHoraFim}`,
                                paciente: paciente ? paciente.nome : 'Paciente'
                            };
                        }
                    }
                }
                
                return null; // Sem conflito
            },

            // v10.55.6: Verificar compatibilidade de especialidade (aviso, nÃ£o bloqueio)
            verificarEspecialidadeUnidade(profissional_id, reparticao_id) {
                const profissional = SistemaCore.dados.profissionais.find(p => p.id === profissional_id);
                const unidade = SistemaCore.dados.reparticoes.find(r => r.id === reparticao_id);

                if (!profissional || !unidade) {
                    return null; // NÃ£o encontrou dados
                }

                // Se unidade aceita todas as especialidades, sem aviso
                if (unidade.aceita_todas_especialidades) {
                    return null;
                }

                // Se unidade nÃ£o tem especialidades configuradas, sem aviso
                if (!unidade.especialidades_permitidas || unidade.especialidades_permitidas.length === 0) {
                    return null;
                }

                // Pegar especialidades do profissional
                const especialidadesProf = profissional.especialidades || (profissional.especialidade ? [profissional.especialidade] : []);
                
                if (especialidadesProf.length === 0) {
                    return null; // Profissional sem especialidade cadastrada
                }

                // Verificar se alguma especialidade do profissional estÃ¡ na lista permitida
                const temCompatibilidade = especialidadesProf.some(esp => 
                    unidade.especialidades_permitidas.includes(esp)
                );

                if (!temCompatibilidade) {
                    // Montar mensagem de aviso
                    const especialidadesUnidade = unidade.especialidades_permitidas.join(', ');
                    const especialidadesProf = (profissional.especialidades || [profissional.especialidade]).filter(Boolean).join(', ');
                    
                    return `âš ï¸ ESPECIALIDADE DIFERENTE\n\n` +
                           `Esta sala estÃ¡ configurada para:\n` +
                           `ğŸ¥ ${especialidadesUnidade}\n\n` +
                           `VocÃª estÃ¡ agendando:\n` +
                           `ğŸ‘¨â€âš•ï¸ ${profissional.nome}\n` +
                           `ğŸ’¼ ${especialidadesProf}\n\n` +
                           `Deseja continuar mesmo assim?`;
                }

                return null; // CompatÃ­vel, sem aviso
            }
        };

        /* ============================================================
           [ATENDIMENTOS] MÃ³dulo Atendimentos
           ============================================================ */
        
        /* ============================================================
           [ATENDIMENTOS] MÃ³dulo de Atendimentos v10.10.0
           ============================================================ */
        
        const Atendimentos = {
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // v10.463: MÃ“DULO ATENDIMENTOS - REESCRITO DO ZERO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            // VariÃ¡veis de estado
            entradaAtual: null,
            pacienteSelecionadoRecepcao: null,
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // INICIALIZAÃ‡ÃƒO E NAVEGAÃ‡ÃƒO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            init() {
                console.log('[v10.463] Atendimentos.init()');
                this.verificarAgendamentosPassados();
                this.atualizarContadores();
                
                // v10.463: Listener para atualizar recepÃ§Ã£o quando paciente Ã© salvo
                window.addEventListener('pacienteSalvo', (e) => {
                    console.log('[v10.463] Evento pacienteSalvo recebido na RecepÃ§Ã£o:', e.detail);
                    
                    const pacienteId = e.detail.pacienteId;
                    const eraIncompleto = e.detail.eraIncompleto;
                    
                    // Se o paciente selecionado na recepÃ§Ã£o foi atualizado
                    if (this.pacienteSelecionadoRecepcao && this.pacienteSelecionadoRecepcao.id === pacienteId) {
                        console.log('[v10.463] Paciente selecionado na recepÃ§Ã£o foi atualizado');
                        
                        // Recarregar dados do paciente
                        const pacienteAtualizado = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                        if (pacienteAtualizado) {
                            this.pacienteSelecionadoRecepcao = pacienteAtualizado;
                            
                            // Se completou o cadastro, atualizar card
                            if (eraIncompleto && pacienteAtualizado.cadastro_completo === true) {
                                console.log('[v10.463] Cadastro completado! Atualizando card...');
                                this.selecionarPacienteRecepcao(pacienteId);
                                Sistema.notificar(`âœ… Cadastro de ${pacienteAtualizado.nome} completado!\nAgora pode registrar entrada.`, 'success');
                            }
                        }
                    }
                    
                    // v10.463: Atualizar TODAS as abas de atendimentos (Fila, Hoje, HistÃ³rico)
                    // porque o nome do paciente pode ter mudado
                    console.log('[v10.463] Atualizando abas de Atendimentos...');
                    
                    // Verificar qual aba estÃ¡ ativa e atualizar
                    // Usar Atendimentos explicitamente (this pode nÃ£o funcionar no callback)
                    const abaAtiva = document.querySelector('#tab-atendimentos .sub-tab-content.active');
                    console.log('[v10.463] Sub-aba ativa:', abaAtiva?.id);
                    
                    if (abaAtiva) {
                        const abaId = abaAtiva.id;
                        if (abaId === 'atend-novo') {
                            console.log('[v10.463] â†’ Atualizando Fila');
                            Atendimentos.listarFila();
                        } else if (abaId === 'atend-hoje') {
                            console.log('[v10.463] â†’ Atualizando Hoje');
                            Atendimentos.listarHoje();
                        } else if (abaId === 'atend-historico') {
                            console.log('[v10.463] â†’ Atualizando HistÃ³rico');
                            Atendimentos.listarHistoricoGeral();
                        } else if (abaId === 'atend-recepcao') {
                            console.log('[v10.463] â†’ Atualizando RecepÃ§Ã£o');
                            Atendimentos.initRecepcao();
                        }
                    } else {
                        console.log('[v10.463] Nenhuma sub-aba ativa encontrada');
                    }
                });
            },
            
            trocarAba(aba) {
                console.log('[v10.463] trocarAba:', aba);
                
                const container = document.getElementById('tab-atendimentos');
                if (!container) return;
                
                // Remover active de todos
                container.querySelectorAll('.sub-tab-btn').forEach(btn => btn.classList.remove('active'));
                container.querySelectorAll('.sub-tab-content').forEach(c => c.classList.remove('active'));
                
                // Ativar aba selecionada
                const btnMap = {
                    'recepcao': 0,
                    'triagem': 1,
                    'novo': 2,
                    'hoje': 3,
                    'historico': 4
                };
                
                const btns = container.querySelectorAll('.sub-tab-btn');
                const idx = btnMap[aba];
                if (btns[idx]) btns[idx].classList.add('active');
                
                const content = document.getElementById('atend-' + aba);
                if (content) content.classList.add('active');
                
                // AÃ§Ãµes especÃ­ficas por aba
                if (aba === 'recepcao') this.initRecepcao();
                if (aba === 'triagem') this.listarTriagem();
                if (aba === 'novo') this.listarFila();
                if (aba === 'hoje') this.listarHoje();
                if (aba === 'historico') this.listarHistoricoGeral();
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // AGENDAMENTOS PASSADOS - Marcar como nÃ£o compareceu
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            verificarAgendamentosPassados() {
                const hoje = new Date().toISOString().split('T')[0];
                let alteradosAg = 0;
                let entradasRemovidas = 0;
                
                // 1. Agendamentos passados â†’ nÃ£o_compareceu
                (SistemaCore.dados.agendamentos || []).forEach(ag => {
                    if (ag.data < hoje && ag.status === 'agendado') {
                        ag.status = 'nao_compareceu';
                        alteradosAg++;
                    }
                });
                
                // 2. Entradas de datas passadas com status "aguardando" â†’ remover ou marcar como nÃ£o compareceu
                if (SistemaCore.dados.entradas) {
                    const antes = SistemaCore.dados.entradas.length;
                    
                    SistemaCore.dados.entradas = SistemaCore.dados.entradas.filter(e => {
                        // Manter entradas de hoje ou futuras
                        if (e.data_entrada >= hoje) return true;
                        
                        // Manter entradas jÃ¡ atendidas (histÃ³rico)
                        if (e.status === 'atendido') return true;
                        
                        // Remover entradas passadas nÃ£o atendidas
                        return false;
                    });
                    
                    entradasRemovidas = antes - SistemaCore.dados.entradas.length;
                }
                
                if (alteradosAg > 0 || entradasRemovidas > 0) {
                    SistemaCore.salvar();
                    console.log(`[v10.463] Limpeza: ${alteradosAg} agendamentos â†’ nÃ£o_compareceu, ${entradasRemovidas} entradas antigas removidas`);
                }
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // RECEPÃ‡ÃƒO - Chegada de pacientes
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            initRecepcao() {
                // Preencher data/hora atuais
                const hoje = new Date();
                const dataEl = document.getElementById('rec-data-entrada');
                const horaEl = document.getElementById('rec-hora-entrada');
                
                if (dataEl) dataEl.value = hoje.toISOString().split('T')[0];
                if (horaEl) horaEl.value = hoje.toTimeString().slice(0, 5);
                
                // Limpar seleÃ§Ã£o anterior
                this.limparPacienteRecepcao();
                
                // v10.463: Mostrar dropdown automaticamente com agendados do dia
                this.mostrarDropdownInicial();
            },
            
            // v10.463: Mostrar dropdown inicial com agendados de hoje e recentes
            mostrarDropdownInicial() {
                console.log('[v10.463] mostrarDropdownInicial chamada');
                const dropdown = document.getElementById('rec-dropdown-pacientes');
                if (!dropdown) {
                    console.error('[v10.463] Dropdown nÃ£o encontrado!');
                    return;
                }
                const busca = document.getElementById('rec-busca-paciente')?.value.trim();
                
                // Se jÃ¡ tem texto digitado, deixar a busca normal funcionar
                if (busca && busca.length >= 2) return;
                
                const hoje = new Date().toISOString().split('T')[0];
                const agendamentos = SistemaCore.dados.agendamentos || [];
                const pacientes = SistemaCore.dados.pacientes || [];
                const entradas = SistemaCore.dados.entradas || [];
                
                // Pacientes com agendamento HOJE (que ainda nÃ£o chegaram)
                const agendadosHoje = agendamentos
                    .filter(a => a.data === hoje && a.status !== 'cancelado' && a.status !== 'realizado')
                    .filter(a => !entradas.some(e => e.agendamento_id === a.id)) // Excluir se jÃ¡ tem entrada
                    .map(a => {
                        const pac = pacientes.find(p => p.id === a.paciente_id);
                        return pac ? { ...pac, agendamento: a } : null;
                    })
                    .filter(Boolean)
                    .slice(0, 5);
                
                console.log('[v10.463] Agendados hoje:', agendadosHoje.length, 'Pacientes:', pacientes.length, 'Agendamentos:', agendamentos.length);
                
                // Ãšltimos pacientes cadastrados (recentes)
                const recentes = [...pacientes]
                    .sort((a, b) => (b.id || 0) - (a.id || 0))
                    .filter(p => !agendadosHoje.some(ag => ag.id === p.id))
                    .slice(0, 5);
                
                let html = '';
                
                // SeÃ§Ã£o: Agendados Hoje
                if (agendadosHoje.length > 0) {
                    html += `
                        <div style="padding: 8px 12px; background: #dbeafe; font-weight: 600; color: #1e40af; font-size: 12px;">
                            ğŸ“… AGENDADOS HOJE
                        </div>
                    `;
                    html += agendadosHoje.map(p => `
                        <div onclick="Atendimentos.selecionarPacienteRecepcao(${p.id})" 
                             style="padding: 12px; cursor: pointer; border-bottom: 1px solid #f3f4f6; background: #f0f9ff;"
                             onmouseover="this.style.background='#dbeafe'" onmouseout="this.style.background='#f0f9ff'">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600;">${p.nome}</div>
                                    <div style="font-size: 12px; color: #6b7280;">
                                        ${p.numero_prontuario || p.prontuario || 'Sem prontuÃ¡rio'} | ${p.cpf || 'Sem CPF'}
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 600; color: #2563eb;">${p.agendamento.hora}</div>
                                    <div style="font-size: 11px; color: #6b7280;">${p.agendamento.tipo || 'Consulta'}</div>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
                
                // SeÃ§Ã£o: Pacientes Recentes
                if (recentes.length > 0) {
                    html += `
                        <div style="padding: 8px 12px; background: #f3f4f6; font-weight: 600; color: #374151; font-size: 12px;">
                            ğŸ• RECENTES
                        </div>
                    `;
                    html += recentes.map(p => `
                        <div onclick="Atendimentos.selecionarPacienteRecepcao(${p.id})" 
                             style="padding: 12px; cursor: pointer; border-bottom: 1px solid #f3f4f6;"
                             onmouseover="this.style.background='#f9fafb'" onmouseout="this.style.background='white'">
                            <div style="font-weight: 600;">${p.nome}</div>
                            <div style="font-size: 12px; color: #6b7280;">
                                ${p.numero_prontuario || p.prontuario || 'Sem prontuÃ¡rio'} | ${p.cpf || 'Sem CPF'}
                            </div>
                        </div>
                    `).join('');
                }
                
                if (!html) {
                    html = '<div style="padding: 16px; color: #6b7280; text-align: center;">Nenhum paciente cadastrado</div>';
                }
                
                dropdown.innerHTML = html;
                dropdown.style.display = 'block';
            },
            
            buscarPacienteRecepcao() {
                const busca = document.getElementById('rec-busca-paciente')?.value.toLowerCase().trim();
                const dropdown = document.getElementById('rec-dropdown-pacientes');
                
                // Se campo vazio ou menos de 2 chars, mostrar dropdown inicial
                if (!busca || busca.length < 2) {
                    this.mostrarDropdownInicial();
                    return;
                }
                
                const pacientes = (SistemaCore.dados.pacientes || []).filter(p =>
                    p.nome?.toLowerCase().includes(busca) ||
                    (p.cpf || '').includes(busca) ||
                    (p.prontuario || '').toLowerCase().includes(busca) ||
                    (p.numero_prontuario || '').toLowerCase().includes(busca)
                ).slice(0, 10);
                
                if (pacientes.length === 0) {
                    dropdown.innerHTML = '<div style="padding: 12px; color: #6b7280;">Nenhum paciente encontrado</div>';
                    dropdown.style.display = 'block';
                    return;
                }
                
                dropdown.innerHTML = pacientes.map(p => `
                    <div onclick="Atendimentos.selecionarPacienteRecepcao(${p.id})" 
                         style="padding: 12px; cursor: pointer; border-bottom: 1px solid #f3f4f6;"
                         onmouseover="this.style.background='#f9fafb'" onmouseout="this.style.background='white'">
                        <div style="font-weight: 600;">${p.nome}</div>
                        <div style="font-size: 12px; color: #6b7280;">
                            ${p.numero_prontuario || p.prontuario || 'Sem prontuÃ¡rio'} | ${p.cpf || 'Sem CPF'}
                        </div>
                    </div>
                `).join('');
                
                dropdown.style.display = 'block';
            },
            
            selecionarPacienteRecepcao(pacienteId) {
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                if (!paciente) return;
                
                this.pacienteSelecionadoRecepcao = paciente;
                console.log('[v10.463] Paciente selecionado:', paciente.nome, 'ID:', pacienteId);
                
                // Esconder dropdown
                document.getElementById('rec-dropdown-pacientes').style.display = 'none';
                document.getElementById('rec-busca-paciente').value = '';
                
                // Determinar tipo de paciente
                const nomeUpper = (paciente.nome || '').toUpperCase();
                const ehNaoIdentificado = nomeUpper.includes('NÃƒO IDENTIFICADO') || nomeUpper.includes('NAO IDENTIFICADO');
                const ehCadastroIncompleto = paciente.cadastro_completo === false && !ehNaoIdentificado;
                
                // Mostrar card do paciente
                document.getElementById('rec-paciente-id').value = pacienteId;
                document.getElementById('rec-paciente-nome').textContent = paciente.nome;
                document.getElementById('rec-paciente-info').textContent = 
                    `ProntuÃ¡rio: ${paciente.numero_prontuario || paciente.prontuario || 'N/D'} | CPF: ${paciente.cpf || 'N/D'}`;
                document.getElementById('rec-paciente-selecionado').style.display = 'block';
                
                // Limpar avisos anteriores
                const container = document.getElementById('rec-paciente-selecionado');
                const avisoAntigo = container.querySelector('.aviso-recepcao');
                if (avisoAntigo) avisoAntigo.remove();
                
                // Resetar campos
                document.getElementById('rec-agendamento-detectado').style.display = 'none';
                document.getElementById('rec-sem-agendamento').style.display = 'none';
                document.getElementById('rec-campos-adicionais').style.display = 'none';
                document.getElementById('rec-botoes-entrada').style.display = 'none';
                document.getElementById('rec-tipo-entrada').value = '';
                
                // CASO 1: Cadastro incompleto (nÃ£o Ã© NÃ£o Identificado)
                if (ehCadastroIncompleto) {
                    const avisoHTML = `
                        <div class="aviso-recepcao" style="margin-top: 12px; padding: 16px; background: #fef3c7; border: 2px solid #f59e0b; border-radius: 8px;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                                <span style="font-size: 24px;">âš ï¸</span>
                                <strong style="color: #92400e; font-size: 16px;">Cadastro Incompleto</strong>
                            </div>
                            <p style="margin: 0 0 16px 0; color: #78350f; font-size: 14px;">
                                Este paciente nÃ£o tem cadastro completo. Escolha uma opÃ§Ã£o:
                            </p>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                <button class="btn" onclick="Pacientes.editar(${paciente.id})" 
                                    style="background: #f59e0b; color: white; padding: 12px 16px; font-size: 14px; font-weight: 600;">
                                    ğŸ“ Completar Cadastro
                                </button>
                                <button class="btn" onclick="Atendimentos.permitirAtendimentoIncompleto(${paciente.id})" 
                                    style="background: #dc2626; color: white; padding: 12px 16px; font-size: 14px; font-weight: 600;">
                                    ğŸš¨ Atender EmergÃªncia
                                </button>
                            </div>
                            <small style="display: block; margin-top: 12px; color: #92400e;">
                                âš ï¸ "Atender EmergÃªncia" irÃ¡ registrar entrada com triagem obrigatÃ³ria
                            </small>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', avisoHTML);
                    document.getElementById('rec-dados-entrada').style.display = 'none';
                    return;
                }
                
                // CASO 2: NÃ£o Identificado - forÃ§ar PA
                if (ehNaoIdentificado) {
                    const avisoHTML = `
                        <div class="aviso-recepcao" style="margin-top: 12px; padding: 12px; background: #fee2e2; border: 2px solid #dc2626; border-radius: 8px;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 20px;">ğŸš¨</span>
                                <strong style="color: #991b1b;">Paciente NÃ£o Identificado - Triagem ObrigatÃ³ria</strong>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', avisoHTML);
                    
                    // Mostrar formulÃ¡rio e forÃ§ar PA
                    document.getElementById('rec-dados-entrada').style.display = 'block';
                    document.getElementById('rec-sem-agendamento').style.display = 'block';
                    this.selecionarTipoEntrada('pronto_atendimento');
                    return;
                }
                
                // CASO 3: Paciente normal - verificar agendamento
                const hoje = new Date().toISOString().split('T')[0];
                const agendamentoHoje = (SistemaCore.dados.agendamentos || []).find(ag =>
                    ag.paciente_id === pacienteId && 
                    ag.data === hoje &&
                    (ag.status === 'agendado' || ag.status === 'confirmado')
                );
                
                document.getElementById('rec-dados-entrada').style.display = 'block';
                
                if (agendamentoHoje) {
                    // TEM AGENDAMENTO - mostrar card de confirmaÃ§Ã£o
                    const profissional = SistemaCore.dados.profissionais?.find(p => p.id === agendamentoHoje.profissional_id);
                    const reparticaoOriginal = agendamentoHoje.reparticao_id ? 
                        SistemaCore.dados.reparticoes?.find(r => r.id === agendamentoHoje.reparticao_id) : null;
                    
                    document.getElementById('rec-agendamento-id').value = agendamentoHoje.id;
                    document.getElementById('rec-agendamento-info').innerHTML = 
                        `â° ${agendamentoHoje.hora} - ${agendamentoHoje.tipo || 'Consulta'}`;
                    
                    // v10.463: Popular dropdown de profissionais
                    this.popularDropdownProfissionais(agendamentoHoje.profissional_id, profissional?.especialidade);
                    
                    // Mostrar profissional original
                    const profOriginalEl = document.getElementById('rec-profissional-original');
                    if (profOriginalEl) {
                        if (profissional) {
                            profOriginalEl.textContent = `Agendado com: ${profissional.nome}`;
                            profOriginalEl.style.color = '#6b7280';
                        } else {
                            profOriginalEl.textContent = 'âš ï¸ Nenhum profissional definido no agendamento';
                            profOriginalEl.style.color = '#dc2626';
                        }
                    }
                    
                    // v10.463: Popular dropdown de salas
                    this.popularDropdownSalas(agendamentoHoje.reparticao_id);
                    
                    // Mostrar sala original
                    const salaOriginalEl = document.getElementById('rec-sala-original');
                    if (salaOriginalEl) {
                        if (reparticaoOriginal) {
                            salaOriginalEl.textContent = `Sala agendada: ${reparticaoOriginal.nome}`;
                            salaOriginalEl.style.color = '#6b7280';
                        } else {
                            salaOriginalEl.textContent = 'âš ï¸ Nenhuma sala definida no agendamento';
                            salaOriginalEl.style.color = '#dc2626';
                        }
                    }
                    
                    document.getElementById('rec-agendamento-detectado').style.display = 'block';
                    document.getElementById('rec-sem-agendamento').style.display = 'none';
                } else {
                    // SEM AGENDAMENTO - mostrar opÃ§Ãµes
                    document.getElementById('rec-agendamento-detectado').style.display = 'none';
                    document.getElementById('rec-sem-agendamento').style.display = 'block';
                    
                    // Resetar seleÃ§Ã£o visual
                    document.getElementById('rec-opt-demanda').style.borderColor = '#e5e7eb';
                    document.getElementById('rec-opt-demanda').style.background = 'white';
                    document.getElementById('rec-opt-pa').style.borderColor = '#e5e7eb';
                    document.getElementById('rec-opt-pa').style.background = 'white';
                }
                
                // Preencher data/hora atual
                const agora = new Date();
                document.getElementById('rec-data-entrada').value = hoje;
                document.getElementById('rec-hora-entrada').value = agora.toTimeString().substring(0, 5);
            },
            
            // Permite atendimento de paciente com cadastro incompleto (emergÃªncia)
            permitirAtendimentoIncompleto(pacienteId) {
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                if (!paciente) return;
                
                // Remover aviso
                const aviso = document.querySelector('.aviso-recepcao');
                if (aviso) aviso.remove();
                
                // Mostrar aviso de emergÃªncia
                const container = document.getElementById('rec-paciente-selecionado');
                const avisoHTML = `
                    <div class="aviso-recepcao" style="margin-top: 12px; padding: 12px; background: #fee2e2; border: 2px solid #dc2626; border-radius: 8px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 20px;">ğŸš¨</span>
                            <strong style="color: #991b1b;">Atendimento de EmergÃªncia - Triagem ObrigatÃ³ria</strong>
                        </div>
                        <small style="display: block; margin-top: 8px; color: #7f1d1d;">
                            Complete o cadastro assim que possÃ­vel
                        </small>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', avisoHTML);
                
                // ForÃ§ar PA + Triagem
                document.getElementById('rec-tipo-entrada').value = 'pronto_atendimento';
                this.verificarTipoEntrada();
                
                // Mostrar formulÃ¡rio
                document.getElementById('rec-dados-entrada').style.display = 'block';
            },
            
            // v10.463: Selecionar tipo de entrada (Demanda EspontÃ¢nea ou PA)
            selecionarTipoEntrada(tipo) {
                console.log('[v10.463] Tipo de entrada selecionado:', tipo);
                
                document.getElementById('rec-tipo-entrada').value = tipo;
                
                // Resetar visual
                document.getElementById('rec-opt-demanda').style.borderColor = '#e5e7eb';
                document.getElementById('rec-opt-demanda').style.background = 'white';
                document.getElementById('rec-opt-pa').style.borderColor = '#e5e7eb';
                document.getElementById('rec-opt-pa').style.background = 'white';
                
                // Destacar selecionado
                if (tipo === 'demanda_espontanea') {
                    document.getElementById('rec-opt-demanda').style.borderColor = '#16a34a';
                    document.getElementById('rec-opt-demanda').style.background = '#f0fdf4';
                    document.getElementById('rec-aviso-triagem').style.display = 'none';
                } else if (tipo === 'pronto_atendimento') {
                    document.getElementById('rec-opt-pa').style.borderColor = '#dc2626';
                    document.getElementById('rec-opt-pa').style.background = '#fef2f2';
                    document.getElementById('rec-aviso-triagem').style.display = 'block';
                }
                
                // v10.463: Popular dropdowns de profissionais e salas
                this.popularDropdownProfissionaisEntrada();
                this.popularDropdownSalasEntrada();
                
                // Mostrar campos adicionais e botÃµes
                document.getElementById('rec-campos-adicionais').style.display = 'block';
                document.getElementById('rec-botoes-entrada').style.display = 'flex';
            },
            
            // v10.463: Popular dropdown de profissionais para entrada
            popularDropdownProfissionaisEntrada() {
                const select = document.getElementById('rec-profissional-entrada');
                if (!select) return;
                
                select.innerHTML = '<option value="">-- NÃ£o definido --</option>';
                
                const profissionais = (SistemaCore.dados.profissionais || [])
                    .filter(p => p.ativo !== false)
                    .sort((a, b) => (a.nome || '').localeCompare(b.nome || ''));
                
                profissionais.forEach(prof => {
                    const option = document.createElement('option');
                    option.value = prof.id;
                    const esp = prof.especialidade ? ` - ${prof.especialidade}` : '';
                    option.textContent = `${prof.nome}${esp}`;
                    select.appendChild(option);
                });
            },
            
            // v10.463: Popular dropdown de salas para entrada (demanda espontÃ¢nea)
            popularDropdownSalasEntrada() {
                const select = document.getElementById('rec-sala-entrada');
                if (!select) return;
                
                // Limpar e adicionar opÃ§Ã£o padrÃ£o
                select.innerHTML = '<option value="">-- NÃ£o definido --</option>';
                
                // v10.463: Buscar TODAS as repartiÃ§Ãµes que podem receber atendimento
                const reparticoes = SistemaCore.dados.reparticoes || [];
                const tiposAtendimento = [
                    'consultorio', 
                    'sala_atendimento', 
                    'sala_exame', 
                    'sala_procedimento', 
                    'ambulatorio', 
                    'emergencia',
                    'bloco_cirurgico',
                    'centro_cirurgico',
                    'sala_cirurgia',
                    'uti',
                    'internacao',
                    'leito'
                ];
                
                const salasDisponiveis = reparticoes.filter(r => 
                    tiposAtendimento.includes(r.tipo_reparticao) || 
                    r.permite_agendamento === true ||
                    r.permite_atendimento === true
                ).sort((a, b) => {
                    // Ordenar por tipo primeiro, depois por nome
                    const tipoA = r => tiposAtendimento.indexOf(a.tipo_reparticao);
                    const tipoB = r => tiposAtendimento.indexOf(b.tipo_reparticao);
                    return (a.nome || '').localeCompare(b.nome || '');
                });
                
                // Agrupar por tipo para melhor visualizaÃ§Ã£o
                let ultimoTipo = '';
                salasDisponiveis.forEach(sala => {
                    const option = document.createElement('option');
                    option.value = sala.id;
                    // Mostrar tipo se disponÃ­vel
                    const tipoLabel = this.getLabelTipoReparticao(sala.tipo_reparticao);
                    option.textContent = tipoLabel ? `${sala.nome} (${tipoLabel})` : sala.nome;
                    select.appendChild(option);
                });
            },
            
            // v10.463: Label amigÃ¡vel para tipo de repartiÃ§Ã£o
            getLabelTipoReparticao(tipo) {
                const labels = {
                    'consultorio': 'ConsultÃ³rio',
                    'sala_atendimento': 'Sala',
                    'sala_exame': 'Exame',
                    'sala_procedimento': 'Procedimento',
                    'ambulatorio': 'AmbulatÃ³rio',
                    'emergencia': 'EmergÃªncia',
                    'bloco_cirurgico': 'Bloco CirÃºrgico',
                    'centro_cirurgico': 'Centro CirÃºrgico',
                    'sala_cirurgia': 'Cirurgia',
                    'uti': 'UTI',
                    'internacao': 'InternaÃ§Ã£o',
                    'leito': 'Leito'
                };
                return labels[tipo] || '';
            },
            
            // v10.463: Popular dropdown de salas/repartiÃ§Ãµes
            popularDropdownSalas(salaAtualId) {
                const select = document.getElementById('rec-agendamento-sala');
                if (!select) return;
                
                // Limpar e adicionar opÃ§Ã£o padrÃ£o
                select.innerHTML = '<option value="">-- Manter do agendamento --</option>';
                
                // v10.463: Buscar TODAS as repartiÃ§Ãµes que podem receber atendimento
                const reparticoes = SistemaCore.dados.reparticoes || [];
                const tiposAtendimento = [
                    'consultorio', 
                    'sala_atendimento', 
                    'sala_exame', 
                    'sala_procedimento', 
                    'ambulatorio',
                    'emergencia',
                    'bloco_cirurgico',
                    'centro_cirurgico',
                    'sala_cirurgia',
                    'uti',
                    'internacao',
                    'leito'
                ];
                
                const salasDisponiveis = reparticoes.filter(r => 
                    tiposAtendimento.includes(r.tipo_reparticao) || 
                    r.permite_agendamento === true ||
                    r.permite_atendimento === true
                ).sort((a, b) => (a.nome || '').localeCompare(b.nome || ''));
                
                salasDisponiveis.forEach(sala => {
                    const option = document.createElement('option');
                    option.value = sala.id;
                    option.textContent = sala.nome;
                    if (sala.id === salaAtualId) {
                        option.selected = true;
                    }
                    select.appendChild(option);
                });
                
                // Se nÃ£o tem a sala original no dropdown, selecionar vazio
                if (salaAtualId && !salasDisponiveis.find(s => s.id === salaAtualId)) {
                    select.value = '';
                }
            },
            
            // v10.463: Popular dropdown de profissionais
            popularDropdownProfissionais(profissionalAtualId, especialidadePreferida) {
                const select = document.getElementById('rec-agendamento-profissional');
                if (!select) return;
                
                // Limpar e adicionar opÃ§Ã£o padrÃ£o
                select.innerHTML = '<option value="">-- Manter do agendamento --</option>';
                
                // Buscar profissionais ativos
                const profissionais = (SistemaCore.dados.profissionais || [])
                    .filter(p => p.ativo !== false)
                    .sort((a, b) => {
                        // Priorizar mesma especialidade
                        if (especialidadePreferida) {
                            const aMatch = a.especialidade === especialidadePreferida ? 0 : 1;
                            const bMatch = b.especialidade === especialidadePreferida ? 0 : 1;
                            if (aMatch !== bMatch) return aMatch - bMatch;
                        }
                        return (a.nome || '').localeCompare(b.nome || '');
                    });
                
                profissionais.forEach(prof => {
                    const option = document.createElement('option');
                    option.value = prof.id;
                    option.textContent = `${prof.nome}${prof.especialidade ? ' - ' + prof.especialidade : ''}`;
                    if (prof.id === profissionalAtualId) {
                        option.selected = true;
                    }
                    select.appendChild(option);
                });
            },
            
            // v10.463: Ignorar agendamento e mostrar opÃ§Ãµes de entrada
            ignorarAgendamento() {
                document.getElementById('rec-agendamento-detectado').style.display = 'none';
                document.getElementById('rec-sem-agendamento').style.display = 'block';
                
                // Resetar seleÃ§Ã£o
                document.getElementById('rec-opt-demanda').style.borderColor = '#e5e7eb';
                document.getElementById('rec-opt-demanda').style.background = 'white';
                document.getElementById('rec-opt-pa').style.borderColor = '#e5e7eb';
                document.getElementById('rec-opt-pa').style.background = 'white';
                document.getElementById('rec-campos-adicionais').style.display = 'none';
                document.getElementById('rec-botoes-entrada').style.display = 'none';
            },
            
            // v10.463: Confirmar chegada do agendamento (agora pega ID do hidden)
            confirmarChegadaAgendamento(agendamentoIdParam) {
                // Pegar ID do parÃ¢metro ou do campo hidden
                const agendamentoId = agendamentoIdParam || parseInt(document.getElementById('rec-agendamento-id')?.value);
                
                console.log('[v10.463] confirmarChegadaAgendamento - ID:', agendamentoId);
                
                const agendamento = SistemaCore.dados.agendamentos.find(a => a.id === agendamentoId);
                if (!agendamento) {
                    Sistema.notificar('âŒ Agendamento nÃ£o encontrado!', 'error');
                    return;
                }
                
                console.log('[v10.463] Agendamento encontrado:', agendamento);
                console.log('[v10.463] paciente_id do agendamento:', agendamento.paciente_id);
                
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === agendamento.paciente_id);
                console.log('[v10.463] Paciente encontrado:', paciente?.nome, 'ID:', paciente?.id);
                
                if (!paciente) {
                    Sistema.notificar('âŒ Paciente do agendamento nÃ£o encontrado!', 'error');
                    return;
                }
                
                // v10.463: Verificar se jÃ¡ existe entrada para este agendamento
                const entradaDoAgendamento = (SistemaCore.dados.entradas || []).find(e => 
                    e.agendamento_id === agendamentoId
                );
                
                if (entradaDoAgendamento) {
                    Sistema.notificar(`âš ï¸ Chegada jÃ¡ confirmada!\n${paciente.nome} jÃ¡ estÃ¡ na fila.`, 'warning');
                    return;
                }
                
                // v10.463: Verificar se paciente jÃ¡ tem entrada ativa hoje
                const hoje = new Date().toISOString().split('T')[0];
                const entradaAtiva = (SistemaCore.dados.entradas || []).find(e => 
                    e.paciente_id === agendamento.paciente_id && 
                    e.data_entrada === hoje &&
                    !['finalizado', 'cancelado'].includes(e.status)
                );
                
                if (entradaAtiva) {
                    Sistema.notificar(`âš ï¸ ${paciente.nome} jÃ¡ tem entrada ativa hoje!`, 'warning');
                    return;
                }
                
                // v10.463: Verificar se selecionou profissional diferente
                const profSelect = document.getElementById('rec-agendamento-profissional');
                const profSelectValue = profSelect?.value;
                const profSelecionadoId = profSelectValue && profSelectValue !== '' ? parseInt(profSelectValue) : null;
                
                // v10.463: Verificar se selecionou sala diferente
                const salaSelect = document.getElementById('rec-agendamento-sala');
                const salaSelectValue = salaSelect?.value;
                const salaSelecionadaId = salaSelectValue && salaSelectValue !== '' ? parseInt(salaSelectValue) : null;
                
                // Usar profissional selecionado OU o do agendamento (prioridade: dropdown > agendamento)
                const profissionalIdFinal = profSelecionadoId || agendamento.profissional_id || null;
                const profissional = profissionalIdFinal ?
                    SistemaCore.dados.profissionais?.find(p => p.id === profissionalIdFinal) : null;
                
                // Usar sala selecionada OU a do agendamento (prioridade: dropdown > agendamento)
                const reparticaoIdFinal = salaSelecionadaId || agendamento.reparticao_id || null;
                const reparticao = reparticaoIdFinal ? 
                    SistemaCore.dados.reparticoes?.find(r => r.id === reparticaoIdFinal) : null;
                
                console.log('[v10.463] Dados do agendamento:', {
                    profissional_id: agendamento.profissional_id,
                    reparticao_id: agendamento.reparticao_id
                });
                console.log('[v10.463] Selecionados:', {
                    profSelecionadoId,
                    salaSelecionadaId
                });
                console.log('[v10.463] Final:', {
                    profissionalIdFinal,
                    profissionalNome: profissional?.nome,
                    reparticaoIdFinal,
                    reparticaoNome: reparticao?.nome
                });
                
                // Criar entrada a partir do agendamento
                const entrada = this.criarEntrada({
                    paciente_id: agendamento.paciente_id,
                    agendamento_id: agendamentoId,
                    data: agendamento.data,
                    hora: agendamento.hora,
                    tipo: agendamento.tipo || 'Consulta',
                    tipo_entrada: 'agendado',
                    tipo_atendimento: agendamento.tipo || 'Consulta',
                    // v10.463: Vincular profissional e local (podem ser alterados na recepÃ§Ã£o)
                    profissional_id: profissionalIdFinal,
                    profissional_nome: profissional?.nome || null,
                    reparticao_id: reparticaoIdFinal,
                    local: reparticao?.nome || null,
                    origem: 'agendamento'
                });
                
                console.log('[v10.463] Entrada criada:', entrada);
                
                // Atualizar status do agendamento
                agendamento.status = 'confirmado';
                SistemaCore.salvar();
                
                // Mensagem com local se definido
                const localMsg = reparticao ? `\nğŸ“ ${reparticao.nome}` : '';
                Sistema.notificar(`âœ… Chegada confirmada!\n${paciente.nome}${localMsg}\nâ†’ Fila de Agendados`, 'success');
                this.limparPacienteRecepcao();
                this.trocarAba('novo');
                this.listarFila();
            },
            
            limparPacienteRecepcao() {
                this.pacienteSelecionadoRecepcao = null;
                document.getElementById('rec-busca-paciente').value = '';
                document.getElementById('rec-paciente-id').value = '';
                document.getElementById('rec-dropdown-pacientes').style.display = 'none';
                document.getElementById('rec-paciente-selecionado').style.display = 'none';
                document.getElementById('rec-dados-entrada').style.display = 'none';
                
                // v10.463: Resetar novos elementos
                const agendamentoDetectado = document.getElementById('rec-agendamento-detectado');
                if (agendamentoDetectado) agendamentoDetectado.style.display = 'none';
                
                const semAgendamento = document.getElementById('rec-sem-agendamento');
                if (semAgendamento) semAgendamento.style.display = 'none';
                
                const camposAdicionais = document.getElementById('rec-campos-adicionais');
                if (camposAdicionais) camposAdicionais.style.display = 'none';
                
                const botoesEntrada = document.getElementById('rec-botoes-entrada');
                if (botoesEntrada) botoesEntrada.style.display = 'none';
                
                // Limpar campos
                const tipoEntrada = document.getElementById('rec-tipo-entrada');
                if (tipoEntrada) tipoEntrada.value = '';
                
                const tipoAtend = document.getElementById('rec-tipo-atendimento');
                if (tipoAtend) tipoAtend.value = 'Consulta';
                
                // Limpar avisos
                const container = document.getElementById('rec-paciente-selecionado');
                if (container) {
                    const avisos = container.querySelectorAll('.aviso-recepcao, .aviso-agendamento');
                    avisos.forEach(a => a.remove());
                }
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // NOVO PACIENTE NA RECEPÃ‡ÃƒO - PrÃ©-cadastro + Atender
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            novoPacienteRecepcao() {
                // Marcar que veio da recepÃ§Ã£o
                window._retornarParaRecepcao = true;
                
                // Abrir cadastro COMPLETO (nÃ£o prÃ©-cadastro)
                if (typeof Pacientes !== 'undefined' && Pacientes.abrirModal) {
                    Pacientes.abrirModal();
                }
            },
            
            salvarEntradaNova() {
                const pacienteId = parseInt(document.getElementById('rec-paciente-id').value);
                if (!pacienteId) {
                    Sistema.notificar('âŒ Selecione um paciente!', 'error');
                    return;
                }
                
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                if (!paciente) {
                    Sistema.notificar('âŒ Paciente nÃ£o encontrado!', 'error');
                    return;
                }
                
                const data = document.getElementById('rec-data-entrada').value;
                const hora = document.getElementById('rec-hora-entrada').value;
                const tipoEntrada = document.getElementById('rec-tipo-entrada').value;
                const tipoAtendimento = document.getElementById('rec-tipo-atendimento').value || 'Consulta';
                
                // v10.463: Pegar profissional selecionado
                const profSelect = document.getElementById('rec-profissional-entrada');
                const profissionalId = profSelect?.value ? parseInt(profSelect.value) : null;
                const profissional = profissionalId ? SistemaCore.dados.profissionais?.find(p => p.id === profissionalId) : null;
                
                // v10.463: Pegar sala selecionada
                const salaSelect = document.getElementById('rec-sala-entrada');
                const salaId = salaSelect?.value ? parseInt(salaSelect.value) : null;
                const sala = salaId ? SistemaCore.dados.reparticoes?.find(r => r.id === salaId) : null;
                
                // v10.463: Validar tipo de entrada
                if (!tipoEntrada) {
                    Sistema.notificar('âŒ Selecione o tipo de entrada!', 'error');
                    return;
                }
                
                // v10.463: Verificar se Ã© "NÃ£o Identificado"
                const nomeUpper = (paciente.nome || '').toUpperCase();
                const ehNaoIdentificado = nomeUpper.includes('NÃƒO IDENTIFICADO') || nomeUpper.includes('NAO IDENTIFICADO');
                
                // "NÃ£o Identificado" SÃ“ pode como PA (com triagem)
                if (ehNaoIdentificado && tipoEntrada !== 'pronto_atendimento') {
                    Sistema.notificar('âŒ Paciente "NÃ£o Identificado" deve ser Pronto Atendimento!', 'error');
                    return;
                }
                
                // Cadastro incompleto (que NÃƒO Ã© "NÃ£o Identificado") - oferece completar
                if (paciente.cadastro_completo === false && !ehNaoIdentificado) {
                    if (confirm('âš ï¸ Cadastro incompleto!\n\nDeseja completar o cadastro agora?\n\nClique OK para completar ou Cancelar para continuar sem completar.')) {
                        if (typeof Pacientes !== 'undefined' && Pacientes.editar) {
                            Pacientes.editar(paciente.id);
                        }
                        return;
                    }
                }
                
                // v10.463: PA sempre precisa triagem
                const precisaTriagem = tipoEntrada === 'pronto_atendimento';
                
                // Verificar se jÃ¡ existe entrada ativa para este paciente hoje
                const hoje = new Date().toISOString().split('T')[0];
                const entradaExistente = (SistemaCore.dados.entradas || []).find(e => 
                    e.paciente_id === pacienteId && 
                    e.data_entrada === hoje &&
                    !['finalizado', 'cancelado'].includes(e.status)
                );
                
                if (entradaExistente) {
                    Sistema.notificar('âš ï¸ Paciente jÃ¡ tem entrada ativa hoje!', 'warning');
                    return;
                }
                
                this.criarEntrada({
                    paciente_id: pacienteId,
                    data: data || hoje,
                    hora: hora || new Date().toTimeString().substring(0, 5),
                    tipo_entrada: tipoEntrada,
                    tipo_atendimento: tipoAtendimento,
                    // v10.463: Incluir profissional e sala se selecionados
                    profissional_id: profissionalId,
                    profissional_nome: profissional?.nome || null,
                    reparticao_id: salaId,
                    local: sala?.nome || null,
                    precisa_triagem: precisaTriagem,
                    origem: 'recepcao'
                });
                
                const profMsg = profissional ? `\nğŸ‘¨â€âš•ï¸ ${profissional.nome}` : '';
                const localMsg = sala ? `\nğŸ“ ${sala.nome}` : '';
                const destino = precisaTriagem ? 'â†’ Aguardando triagem' : 'â†’ Fila de atendimento';
                Sistema.notificar(`âœ… Entrada registrada!\n${paciente.nome}${profMsg}${localMsg}\n${destino}`, 'success');
                this.limparPacienteRecepcao();
                
                // Atualizar listas
                this.listarTriagem();
                this.listarFila();
                
                // Ir para triagem ou fila
                if (precisaTriagem) {
                    this.trocarAba('triagem');
                } else {
                    this.trocarAba('novo');
                }
            },
            
            // v10.463: Verifica tipo de entrada e forÃ§a triagem para PA
            verificarTipoEntrada() {
                const tipoEntrada = document.getElementById('rec-tipo-entrada').value;
                const tipoSelect = document.getElementById('rec-tipo-atendimento');
                const hint = document.getElementById('rec-triagem-hint');
                
                if (tipoEntrada === 'pronto_atendimento') {
                    tipoSelect.value = 'com_triagem';
                    tipoSelect.disabled = true;
                    if (hint) hint.style.display = 'block';
                } else {
                    tipoSelect.disabled = false;
                    if (hint) hint.style.display = 'none';
                }
            },
            
            // v10.463: Criar paciente NÃ£o Identificado para emergÃªncia
            criarNaoIdentificado() {
                const agora = new Date();
                const timestamp = agora.toISOString().replace(/[-:T.]/g, '').slice(0, 14);
                
                const novoId = SistemaCore.dados.pacientes.length > 0 ?
                    Math.max(...SistemaCore.dados.pacientes.map(p => p.id || 0)) + 1 : 1;
                
                const paciente = {
                    id: novoId,
                    nome: `NÃƒO IDENTIFICADO - ${timestamp}`,
                    cpf: '',
                    data_nascimento: '',
                    sexo: '',
                    telefone: '',
                    email: '',
                    endereco: '',
                    numero_prontuario: `NI-${timestamp}`,
                    cadastro_completo: false,
                    criado_em: agora.toISOString(),
                    nao_identificado: true
                };
                
                SistemaCore.dados.pacientes.push(paciente);
                SistemaCore.salvar();
                
                // Selecionar automaticamente
                this.selecionarPacienteRecepcao(novoId);
                
                // ForÃ§ar tipo PA com triagem
                document.getElementById('rec-tipo-entrada').value = 'pronto_atendimento';
                this.verificarTipoEntrada();
                
                Sistema.notificar('âš ï¸ Paciente NÃ£o Identificado criado.\nPreencha os dados quando possÃ­vel.', 'warning');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // CRIAR ENTRADA - FunÃ§Ã£o central
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            criarEntrada(dados) {
                if (!SistemaCore.dados.entradas) SistemaCore.dados.entradas = [];
                
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === dados.paciente_id);
                
                const novoId = SistemaCore.dados.entradas.length > 0 ?
                    Math.max(...SistemaCore.dados.entradas.map(e => e.id || 0)) + 1 : 1;
                
                // v10.463: Gerar numero_registro automÃ¡tico
                const hoje = new Date();
                const ano = hoje.getFullYear();
                const mes = String(hoje.getMonth() + 1).padStart(2, '0');
                const dia = String(hoje.getDate()).padStart(2, '0');
                const sequencial = String(novoId).padStart(4, '0');
                const numeroRegistro = `${ano}${mes}${dia}-${sequencial}`;
                
                // v10.463: Determinar tipo_entrada corretamente
                let tipoEntrada = dados.tipo_entrada;
                if (!tipoEntrada) {
                    // Se tem agendamento_id, Ã© agendado; senÃ£o Ã© PA
                    tipoEntrada = dados.agendamento_id ? 'agendado' : 'pronto_atendimento';
                }
                
                const entrada = {
                    id: novoId,
                    numero_registro: numeroRegistro, // v10.463: NÃºmero do atendimento
                    paciente_id: dados.paciente_id,
                    // Guardar dados do paciente como CÃ“PIA (nÃ£o referÃªncia)
                    paciente_nome: paciente?.nome || 'N/D',
                    paciente_cpf: paciente?.cpf || '',
                    paciente_prontuario: paciente?.numero_prontuario || paciente?.prontuario || '',
                    agendamento_id: dados.agendamento_id || null,
                    data_entrada: dados.data || new Date().toISOString().split('T')[0],
                    hora_entrada: dados.hora || new Date().toTimeString().slice(0, 5),
                    tipo: dados.tipo || dados.tipo_atendimento || 'Consulta',
                    tipo_entrada: tipoEntrada,
                    tipo_atendimento: dados.tipo_atendimento || dados.tipo || 'Consulta',
                    // v10.463: Profissional e local (formato novo)
                    profissional_id: dados.profissional_id || null,
                    profissional_nome: dados.profissional_nome || null,
                    reparticao_id: dados.reparticao_id || null,
                    local: dados.local || null,
                    // Manter local_entrada para compatibilidade
                    local_entrada: dados.local || dados.local_entrada || 'recepcao',
                    precisa_triagem: dados.precisa_triagem || false,
                    origem: dados.origem || 'recepcao',
                    status: dados.precisa_triagem ? 'aguardando_triagem' : 'aguardando_atendimento',
                    criado_em: new Date().toISOString()
                };
                
                SistemaCore.dados.entradas.push(entrada);
                SistemaCore.salvar();
                
                console.log('[v10.463] Entrada criada:', entrada.id, entrada.paciente_nome, 'tipo_entrada:', entrada.tipo_entrada);
                return entrada;
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // ATENDER DA AGENDA - Atalho direto
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            atenderDaAgenda(agendamentoId) {
                console.log('[v10.463] atenderDaAgenda:', agendamentoId);
                
                const agendamento = (SistemaCore.dados.agendamentos || []).find(a => a.id === agendamentoId);
                if (!agendamento) {
                    Sistema.notificar('âŒ Agendamento nÃ£o encontrado!', 'error');
                    return;
                }
                
                // Verificar data do agendamento - BLOQUEAR se nÃ£o for hoje
                const hoje = new Date().toISOString().split('T')[0];
                const dataAgendamento = new Date(agendamento.data + 'T00:00:00').toLocaleDateString('pt-BR');
                
                if (agendamento.data < hoje) {
                    Sistema.notificar(`âŒ Agendamento do dia ${dataAgendamento} (passado). NÃ£o Ã© possÃ­vel atender.`, 'error');
                    return;
                }
                
                if (agendamento.data > hoje) {
                    Sistema.notificar(`âŒ Agendamento do dia ${dataAgendamento} (futuro). NÃ£o Ã© possÃ­vel atender.`, 'error');
                    return;
                }
                
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === agendamento.paciente_id);
                if (!paciente) {
                    Sistema.notificar('âŒ Paciente nÃ£o encontrado!', 'error');
                    return;
                }
                
                // VERIFICAR CADASTRO COMPLETO
                if (paciente.cadastro_completo === false) {
                    Sistema.notificar('âš ï¸ Cadastro incompleto! Complete o cadastro antes de atender.', 'warning');
                    
                    // Abrir modal de ediÃ§Ã£o do paciente
                    if (typeof Pacientes !== 'undefined' && Pacientes.editar) {
                        Pacientes.editar(paciente.id);
                    }
                    return;
                }
                
                // Verificar se jÃ¡ existe entrada para este agendamento
                let entrada = (SistemaCore.dados.entradas || []).find(e => e.agendamento_id === agendamentoId);
                
                if (!entrada) {
                    // v10.463: Buscar profissional e sala do agendamento
                    const profissional = agendamento.profissional_id ?
                        SistemaCore.dados.profissionais?.find(p => p.id === agendamento.profissional_id) : null;
                    const reparticao = agendamento.reparticao_id ?
                        SistemaCore.dados.reparticoes?.find(r => r.id === agendamento.reparticao_id) : null;
                    
                    // Criar entrada com todos os dados do agendamento
                    entrada = this.criarEntrada({
                        paciente_id: paciente.id,
                        agendamento_id: agendamentoId,
                        data: agendamento.data,
                        hora: agendamento.hora,
                        tipo: agendamento.tipo || 'Consulta',
                        tipo_entrada: 'agendado',
                        tipo_atendimento: agendamento.tipo || 'Consulta',
                        profissional_id: agendamento.profissional_id || null,
                        profissional_nome: profissional?.nome || null,
                        reparticao_id: agendamento.reparticao_id || null,
                        local: reparticao?.nome || null,
                        origem: 'agenda'
                    });
                }
                
                // Atualizar status
                entrada.status = 'aguardando_atendimento';
                agendamento.status = 'confirmado';
                SistemaCore.salvar();
                
                // Ir para aba de atendimentos
                Sistema.trocarTab('atendimentos');
                
                // v10.463: ABRIR ATENDIMENTO DIRETO (nÃ£o precisa clicar 2x)
                setTimeout(() => {
                    this.trocarAba('novo');
                    // Abrir atendimento automaticamente
                    this.abrirAtendimento(entrada.id);
                    Sistema.notificar(`âœ… Atendimento iniciado: ${paciente.nome}`, 'success');
                }, 150);
            },
            
            // Alias para compatibilidade
            atenderDoAgendamento(agendamentoId) {
                this.atenderDaAgenda(agendamentoId);
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // FILA DE ATENDIMENTO - Separado em Agendados e PA
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            listarFila() {
                const container = document.getElementById('fila-atendimento');
                if (!container) return;
                
                const agora = new Date();
                const hoje = agora.toISOString().split('T')[0];
                
                // FILTRO: Status aguardando_atendimento OU em_atendimento (mÃºltiplos atendimentos) e de hoje
                const fila = (SistemaCore.dados.entradas || []).filter(e => {
                    // v10.463: Incluir "em_atendimento" para permitir mÃºltiplos atendimentos
                    if (e.status !== 'aguardando_atendimento' && e.status !== 'em_atendimento') return false;
                    if (e.data_entrada === hoje) return true;
                    
                    // Criado nos Ãºltimos 30 minutos
                    if (e.criado_em) {
                        const criadoEm = new Date(e.criado_em);
                        const diffMin = (agora.getTime() - criadoEm.getTime()) / 60000;
                        if (diffMin <= 30) return true;
                    }
                    return false;
                });
                
                // v10.463: MIGRAÃ‡ÃƒO AUTOMÃTICA - Completar dados faltantes a partir do agendamento
                let precisaSalvar = false;
                fila.forEach(entrada => {
                    if (entrada.agendamento_id && (!entrada.profissional_id || !entrada.profissional_nome)) {
                        const agendamento = SistemaCore.dados.agendamentos?.find(a => a.id === entrada.agendamento_id);
                        if (agendamento) {
                            // Completar profissional
                            if (!entrada.profissional_id && agendamento.profissional_id) {
                                entrada.profissional_id = agendamento.profissional_id;
                                const prof = SistemaCore.dados.profissionais?.find(p => p.id === agendamento.profissional_id);
                                entrada.profissional_nome = prof?.nome || null;
                                precisaSalvar = true;
                                console.log('[v10.463] MigraÃ§Ã£o: profissional adicionado Ã  entrada', entrada.id);
                            }
                            // Completar local/repartiÃ§Ã£o (se nÃ£o tem local nem local_entrada)
                            if (!entrada.local && !entrada.local_entrada && agendamento.reparticao_id) {
                                entrada.reparticao_id = agendamento.reparticao_id;
                                const rep = SistemaCore.dados.reparticoes?.find(r => r.id === agendamento.reparticao_id);
                                entrada.local = rep?.nome || null;
                                precisaSalvar = true;
                                console.log('[v10.463] MigraÃ§Ã£o: local adicionado Ã  entrada', entrada.id);
                            }
                            // Migrar local_entrada para local (formato novo)
                            if (entrada.local_entrada && !entrada.local) {
                                entrada.local = entrada.local_entrada;
                                precisaSalvar = true;
                            }
                        }
                    }
                });
                if (precisaSalvar) {
                    SistemaCore.salvar();
                }
                
                console.log('[v10.463] Fila filtrada:', fila.length, 'entradas');
                
                if (fila.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #9ca3af;">
                            <div style="font-size: 48px; margin-bottom: 12px;">ğŸ“‹</div>
                            <p>Nenhum paciente aguardando</p>
                            <p style="font-size: 13px;">Use a <strong>RecepÃ§Ã£o</strong> ou <strong>Agenda</strong></p>
                        </div>
                    `;
                    return;
                }
                
                // SEPARAR: Agendados vs Demanda EspontÃ¢nea vs PA
                const agendados = fila.filter(e => e.tipo_entrada === 'agendado' || e.origem === 'agendamento' || e.agendamento_id);
                const demandaEspontanea = fila.filter(e => e.tipo_entrada === 'demanda_espontanea');
                const prontoAtendimento = fila.filter(e => e.tipo_entrada === 'pronto_atendimento');
                
                // Ordenar cada grupo por hora
                agendados.sort((a, b) => (a.hora_entrada || '').localeCompare(b.hora_entrada || ''));
                demandaEspontanea.sort((a, b) => (a.hora_entrada || '').localeCompare(b.hora_entrada || ''));
                prontoAtendimento.sort((a, b) => {
                    // PA: ordenar por classificaÃ§Ã£o Manchester se tiver, senÃ£o por hora
                    const prioridadeA = this.getPrioridadeManchester(a.classificacao_manchester);
                    const prioridadeB = this.getPrioridadeManchester(b.classificacao_manchester);
                    if (prioridadeA !== prioridadeB) return prioridadeA - prioridadeB;
                    return (a.hora_entrada || '').localeCompare(b.hora_entrada || '');
                });
                
                let html = '';
                
                // SEÃ‡ÃƒO: AGENDADOS
                if (agendados.length > 0) {
                    html += `
                        <div style="margin-bottom: 24px;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; padding: 10px 16px; background: #dbeafe; border-radius: 8px;">
                                <span style="font-size: 20px;">ğŸ“…</span>
                                <span style="font-weight: 600; color: #1e40af;">Agendados (${agendados.length})</span>
                            </div>
                            ${agendados.map(e => this.renderItemFila(e, 'agendado')).join('')}
                        </div>
                    `;
                }
                
                // SEÃ‡ÃƒO: DEMANDA ESPONTÃ‚NEA
                if (demandaEspontanea.length > 0) {
                    html += `
                        <div style="margin-bottom: 24px;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; padding: 10px 16px; background: #fef3c7; border-radius: 8px;">
                                <span style="font-size: 20px;">ğŸ¥</span>
                                <span style="font-weight: 600; color: #92400e;">Demanda EspontÃ¢nea (${demandaEspontanea.length})</span>
                            </div>
                            ${demandaEspontanea.map(e => this.renderItemFila(e, 'demanda')).join('')}
                        </div>
                    `;
                }
                
                // SEÃ‡ÃƒO: PRONTO ATENDIMENTO
                if (prontoAtendimento.length > 0) {
                    html += `
                        <div>
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; padding: 10px 16px; background: #fee2e2; border-radius: 8px;">
                                <span style="font-size: 20px;">ğŸš¨</span>
                                <span style="font-weight: 600; color: #991b1b;">Pronto Atendimento (${prontoAtendimento.length})</span>
                            </div>
                            ${prontoAtendimento.map(e => this.renderItemFila(e, 'pa')).join('')}
                        </div>
                    `;
                }
                
                container.innerHTML = html;
            },
            
            getPrioridadeManchester(classificacao) {
                const prioridades = { 'vermelho': 1, 'laranja': 2, 'amarelo': 3, 'verde': 4, 'azul': 5 };
                return prioridades[classificacao] || 99;
            },
            
            renderItemFila(e, tipo) {
                const dataFormatada = e.data_entrada ? 
                    new Date(e.data_entrada + 'T00:00:00').toLocaleDateString('pt-BR', {day: '2-digit', month: '2-digit'}) : 
                    'N/D';
                
                // v10.463: Contar atendimentos desta entrada
                const atendimentosEntrada = (SistemaCore.dados.atendimentos || []).filter(a => a.entrada_id === e.id);
                const qtdAtendimentos = atendimentosEntrada.length;
                
                // v10.463: Cores por tipo
                const cores = {
                    'agendado': { borda: '#3b82f6', fundo: '#f0f9ff' },
                    'demanda': { borda: '#f59e0b', fundo: '#fffbeb' },
                    'pa': { borda: '#dc2626', fundo: '#fef2f2' }
                };
                const corBorda = cores[tipo]?.borda || '#6b7280';
                const corFundo = cores[tipo]?.fundo || '#f9fafb';
                
                // Badge de classificaÃ§Ã£o Manchester para PA
                let badgeManchester = '';
                if (e.classificacao_manchester) {
                    const coresManchester = {
                        'vermelho': '#dc2626',
                        'laranja': '#ea580c',
                        'amarelo': '#ca8a04',
                        'verde': '#16a34a',
                        'azul': '#2563eb'
                    };
                    const cor = coresManchester[e.classificacao_manchester] || '#6b7280';
                    badgeManchester = `<span style="background: ${cor}; color: white; padding: 2px 8px; border-radius: 4px; font-size: 10px; margin-left: 8px;">${e.classificacao_manchester.toUpperCase()}</span>`;
                }
                
                // v10.463: Buscar dados originais do agendamento se existir
                let profOriginal = null;
                let salaOriginal = null;
                if (e.agendamento_id) {
                    const agendamento = SistemaCore.dados.agendamentos?.find(a => a.id === e.agendamento_id);
                    if (agendamento) {
                        // Profissional original
                        if (agendamento.profissional_id && agendamento.profissional_id !== e.profissional_id) {
                            const profOrig = SistemaCore.dados.profissionais?.find(p => p.id === agendamento.profissional_id);
                            profOriginal = profOrig?.nome || agendamento.profissional_nome;
                        }
                        // Sala original
                        if (agendamento.reparticao_id && agendamento.reparticao_id !== e.reparticao_id) {
                            const salaOrig = SistemaCore.dados.reparticoes?.find(r => r.id === agendamento.reparticao_id);
                            salaOriginal = salaOrig?.nome || agendamento.local;
                        }
                    }
                }
                
                // v10.463: Mostrar local e profissional (suporta formato antigo e novo)
                const localNome = e.local || e.local_entrada || null;
                let localInfo = localNome ? `ğŸ“ ${localNome}` : '<span style="color: #dc2626;">ğŸ“ Sem sala</span>';
                // Mostrar sala original se foi alterada
                if (salaOriginal && salaOriginal !== localNome) {
                    localInfo += ` <span style="color: #9ca3af; font-size: 10px;">(era: ${salaOriginal})</span>`;
                }
                
                let profInfo = e.profissional_nome ? `ğŸ‘¨â€âš•ï¸ ${e.profissional_nome}` : '<span style="color: #dc2626;">ğŸ‘¨â€âš•ï¸ Sem profissional</span>';
                // Mostrar profissional original se foi alterado
                if (profOriginal && profOriginal !== e.profissional_nome) {
                    profInfo += ` <span style="color: #9ca3af; font-size: 10px;">(era: ${profOriginal})</span>`;
                }
                
                const detalhes = e.tipo_atendimento || e.tipo || 'Consulta';
                
                return `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 14px 16px; background: ${corFundo}; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid ${corBorda};">
                        <div style="flex: 1;">
                            <div style="font-weight: 600; font-size: 15px;">
                                ${e.hora_entrada} - ${e.paciente_nome || e.paciente?.nome || 'N/D'}
                                ${badgeManchester}
                                ${qtdAtendimentos > 0 ? `<span style="background: #8b5cf6; color: white; padding: 2px 8px; border-radius: 4px; font-size: 10px; margin-left: 8px;" title="JÃ¡ tem ${qtdAtendimentos} atendimento(s) registrado(s)">ğŸ“‹ ${qtdAtendimentos}</span>` : ''}
                            </div>
                            <div style="font-size: 13px; color: #6b7280;">
                                ${detalhes}
                            </div>
                            <div style="font-size: 12px; color: #6b7280; margin-top: 4px; display: flex; flex-wrap: wrap; gap: 12px;">
                                <span>
                                    ${profInfo}
                                    <button onclick="Atendimentos.alterarProfissionalEntrada(${e.id})" 
                                        style="background: none; border: none; color: #3b82f6; cursor: pointer; font-size: 11px; padding: 2px 4px; text-decoration: underline;">
                                        alterar
                                    </button>
                                </span>
                                <span>
                                    ${localInfo}
                                    <button onclick="Atendimentos.alterarSalaEntrada(${e.id})" 
                                        style="background: none; border: none; color: #3b82f6; cursor: pointer; font-size: 11px; padding: 2px 4px; text-decoration: underline;">
                                        alterar
                                    </button>
                                </span>
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 6px; align-items: flex-end;">
                            <button class="btn btn-primary" onclick="Atendimentos.abrirAtendimento(${e.id})" style="white-space: nowrap;">
                                ğŸ©º ${qtdAtendimentos > 0 ? 'Novo Atendimento' : 'Atender'}
                            </button>
                            ${qtdAtendimentos > 0 ? `
                                <button onclick="Atendimentos.verHistoricoEntrada(${e.id})" 
                                    style="background: #8b5cf6; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                    ğŸ“‹ Ver ${qtdAtendimentos} anterior${qtdAtendimentos > 1 ? 'es' : ''}
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            },
            
            // v10.463: Alterar sala de uma entrada na fila
            alterarSalaEntrada(entradaId) {
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    Sistema.notificar('âŒ Entrada nÃ£o encontrada!', 'error');
                    return;
                }
                
                // v10.463: Buscar TODAS as repartiÃ§Ãµes que podem receber atendimento
                const reparticoes = SistemaCore.dados.reparticoes || [];
                const tiposAtendimento = [
                    'consultorio', 'sala_atendimento', 'sala_exame', 'sala_procedimento', 
                    'ambulatorio', 'emergencia', 'bloco_cirurgico', 'centro_cirurgico',
                    'sala_cirurgia', 'uti', 'internacao', 'leito'
                ];
                const salasDisponiveis = reparticoes.filter(r => 
                    tiposAtendimento.includes(r.tipo_reparticao) || 
                    r.permite_agendamento === true ||
                    r.permite_atendimento === true
                ).sort((a, b) => (a.nome || '').localeCompare(b.nome || ''));
                
                if (salasDisponiveis.length === 0) {
                    Sistema.notificar('âš ï¸ Nenhuma sala/local cadastrado no sistema!', 'warning');
                    return;
                }
                
                // Criar opÃ§Ãµes para o prompt com tipo
                const opcoes = salasDisponiveis.map((s, i) => {
                    const tipoLabel = this.getLabelTipoReparticao(s.tipo_reparticao);
                    return `${i + 1}. ${s.nome}${tipoLabel ? ' (' + tipoLabel + ')' : ''}`;
                }).join('\n');
                const salaAtual = entrada.local || entrada.local_entrada || 'Nenhuma';
                
                const escolha = prompt(
                    `ğŸ“ ALTERAR LOCAL\n\n` +
                    `Paciente: ${entrada.paciente_nome || 'N/D'}\n` +
                    `Local atual: ${salaAtual}\n\n` +
                    `Selecione o novo local (digite o nÃºmero):\n\n${opcoes}`
                );
                
                if (!escolha) return;
                
                const indice = parseInt(escolha) - 1;
                if (isNaN(indice) || indice < 0 || indice >= salasDisponiveis.length) {
                    Sistema.notificar('âŒ OpÃ§Ã£o invÃ¡lida!', 'error');
                    return;
                }
                
                const novaSala = salasDisponiveis[indice];
                entrada.reparticao_id = novaSala.id;
                entrada.local = novaSala.nome;
                SistemaCore.salvar();
                
                Sistema.notificar(`âœ… Local alterado!\n${entrada.paciente_nome}\nğŸ“ ${novaSala.nome}`, 'success');
                this.listarFila();
            },
            
            // v10.463: Alterar profissional de uma entrada na fila
            alterarProfissionalEntrada(entradaId) {
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    Sistema.notificar('âŒ Entrada nÃ£o encontrada!', 'error');
                    return;
                }
                
                // Buscar profissionais ativos
                const profissionais = (SistemaCore.dados.profissionais || [])
                    .filter(p => p.ativo !== false)
                    .sort((a, b) => (a.nome || '').localeCompare(b.nome || ''));
                
                if (profissionais.length === 0) {
                    Sistema.notificar('âš ï¸ Nenhum profissional cadastrado no sistema!', 'warning');
                    return;
                }
                
                // Criar opÃ§Ãµes para o prompt
                const opcoes = profissionais.map((p, i) => 
                    `${i + 1}. ${p.nome}${p.especialidade ? ' (' + p.especialidade + ')' : ''}`
                ).join('\n');
                const profAtual = entrada.profissional_nome || 'Nenhum';
                
                const escolha = prompt(
                    `ğŸ‘¨â€âš•ï¸ ALTERAR PROFISSIONAL\n\n` +
                    `Paciente: ${entrada.paciente_nome || 'N/D'}\n` +
                    `Profissional atual: ${profAtual}\n\n` +
                    `Selecione o novo profissional (digite o nÃºmero):\n\n${opcoes}`
                );
                
                if (!escolha) return;
                
                const indice = parseInt(escolha) - 1;
                if (isNaN(indice) || indice < 0 || indice >= profissionais.length) {
                    Sistema.notificar('âŒ OpÃ§Ã£o invÃ¡lida!', 'error');
                    return;
                }
                
                const novoProf = profissionais[indice];
                entrada.profissional_id = novoProf.id;
                entrada.profissional_nome = novoProf.nome;
                SistemaCore.salvar();
                
                Sistema.notificar(`âœ… Profissional alterado!\n${entrada.paciente_nome}\nğŸ‘¨â€âš•ï¸ ${novoProf.nome}`, 'success');
                this.listarFila();
            },
            
            // v10.463: Ver histÃ³rico de atendimentos de uma entrada
            verHistoricoEntrada(entradaId) {
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    Sistema.notificar('âŒ Entrada nÃ£o encontrada!', 'error');
                    return;
                }
                
                const atendimentos = (SistemaCore.dados.atendimentos || [])
                    .filter(a => a.entrada_id === entradaId)
                    .sort((a, b) => new Date(b.finalizado_em || b.data_atendimento) - new Date(a.finalizado_em || a.data_atendimento));
                
                if (atendimentos.length === 0) {
                    Sistema.notificar('â„¹ï¸ Nenhum atendimento registrado ainda.', 'info');
                    return;
                }
                
                // Criar modal com histÃ³rico
                let modal = document.getElementById('modal-historico-entrada');
                if (!modal) {
                    modal = document.createElement('div');
                    modal.id = 'modal-historico-entrada';
                    modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 10000;';
                    modal.onclick = (e) => { if (e.target === modal) modal.style.display = 'none'; };
                    document.body.appendChild(modal);
                }
                
                const nomePaciente = entrada.paciente_nome || entrada.paciente?.nome || 'N/D';
                
                modal.innerHTML = `
                    <div style="background: white; border-radius: 12px; width: 90%; max-width: 700px; max-height: 80vh; overflow: hidden; display: flex; flex-direction: column;">
                        <div style="padding: 20px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin: 0; font-size: 18px;">ğŸ“‹ HistÃ³rico de Atendimentos</h3>
                                <p style="margin: 4px 0 0; color: #6b7280; font-size: 14px;">${nomePaciente} - Entrada #${entradaId}</p>
                            </div>
                            <button onclick="document.getElementById('modal-historico-entrada').style.display='none'" 
                                style="background: none; border: none; font-size: 24px; cursor: pointer; color: #9ca3af;">Ã—</button>
                        </div>
                        <div style="padding: 20px; overflow-y: auto; flex: 1;">
                            ${atendimentos.map((a, i) => `
                                <div style="background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 12px; ${i === 0 ? 'border-left: 4px solid #22c55e;' : ''}">
                                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px;">
                                        <div>
                                            <span style="font-weight: 600; color: #111;">#${a.sequencia || (atendimentos.length - i)} - ${a.modelo_nome || 'Atendimento'}</span>
                                            ${i === 0 ? '<span style="background: #22c55e; color: white; padding: 2px 8px; border-radius: 4px; font-size: 10px; margin-left: 8px;">MAIS RECENTE</span>' : ''}
                                        </div>
                                        <span style="color: #6b7280; font-size: 12px;">
                                            ${a.data_atendimento ? new Date(a.data_atendimento + 'T00:00:00').toLocaleDateString('pt-BR') : ''} ${a.hora_atendimento || ''}
                                        </span>
                                    </div>
                                    <div style="font-size: 13px; color: #6b7280; display: flex; gap: 16px; flex-wrap: wrap;">
                                        <span>ğŸ‘¨â€âš•ï¸ ${a.profissional_nome || 'NÃ£o identificado'}</span>
                                        ${a.fotos?.length ? `<span>ğŸ“· ${a.fotos.length} foto(s)</span>` : ''}
                                    </div>
                                    <div style="margin-top: 12px;">
                                        <button onclick="Atendimentos.verAtendimentoCompleto(${a.id})" 
                                            style="background: #3b82f6; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 12px; cursor: pointer;">
                                            ğŸ‘ï¸ Ver Completo
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <div style="padding: 16px; border-top: 1px solid #e5e7eb; text-align: right;">
                            <button onclick="document.getElementById('modal-historico-entrada').style.display='none'" 
                                style="background: #6b7280; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">
                                Fechar
                            </button>
                        </div>
                    </div>
                `;
                
                modal.style.display = 'flex';
            },
            
            // v10.463: Ver atendimento completo
            verAtendimentoCompleto(atendimentoId) {
                const atendimento = (SistemaCore.dados.atendimentos || []).find(a => a.id === atendimentoId);
                if (!atendimento) {
                    Sistema.notificar('âŒ Atendimento nÃ£o encontrado!', 'error');
                    return;
                }
                
                // Criar modal
                let modal = document.getElementById('modal-ver-atendimento');
                if (!modal) {
                    modal = document.createElement('div');
                    modal.id = 'modal-ver-atendimento';
                    modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 10001;';
                    modal.onclick = (e) => { if (e.target === modal) modal.style.display = 'none'; };
                    document.body.appendChild(modal);
                }
                
                const dataFormatada = atendimento.data_atendimento ? 
                    new Date(atendimento.data_atendimento + 'T00:00:00').toLocaleDateString('pt-BR') : 'N/D';
                
                modal.innerHTML = `
                    <div style="background: white; border-radius: 12px; width: 90%; max-width: 900px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column;">
                        <div style="padding: 20px; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                            <div>
                                <h3 style="margin: 0; font-size: 18px;">ğŸ“‹ Atendimento #${atendimento.id}</h3>
                                <p style="margin: 4px 0 0; font-size: 14px; opacity: 0.9;">
                                    ${atendimento.paciente_nome || 'Paciente'} â€¢ ${dataFormatada} ${atendimento.hora_atendimento || ''}
                                </p>
                            </div>
                            <button onclick="document.getElementById('modal-ver-atendimento').style.display='none'" 
                                style="background: rgba(255,255,255,0.2); border: none; font-size: 20px; cursor: pointer; color: white; width: 36px; height: 36px; border-radius: 50%;">Ã—</button>
                        </div>
                        
                        <div style="padding: 20px; overflow-y: auto; flex: 1;">
                            <!-- Info -->
                            <div style="background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; font-size: 14px;">
                                    <div><strong>ğŸ‘¨â€âš•ï¸ Profissional:</strong> ${atendimento.profissional_nome || 'NÃ£o identificado'}</div>
                                    <div><strong>ğŸ“‹ Modelo:</strong> ${atendimento.modelo_nome || 'N/D'}</div>
                                    <div><strong>ğŸ”¢ SequÃªncia:</strong> ${atendimento.sequencia || 1}Âº atendimento</div>
                                    <div><strong>ğŸ“· Fotos:</strong> ${atendimento.fotos?.length || 0}</div>
                                </div>
                            </div>
                            
                            <!-- ConteÃºdo HTML do prontuÃ¡rio -->
                            <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; padding: 20px;">
                                ${atendimento.conteudo_html || '<p style="color: #9ca3af; text-align: center;">Sem conteÃºdo registrado</p>'}
                            </div>
                            
                            <!-- Fotos -->
                            ${atendimento.fotos?.length ? `
                                <div style="margin-top: 16px; background: #fefce8; border: 1px solid #fde047; border-radius: 8px; padding: 16px;">
                                    <h4 style="margin: 0 0 12px; font-size: 14px; color: #854d0e;">ğŸ“· Fotos do Atendimento</h4>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 8px;">
                                        ${atendimento.fotos.map(f => `
                                            <img src="${f.base64}" style="width: 100%; height: 80px; object-fit: cover; border-radius: 4px; cursor: pointer;" 
                                                onclick="window.open('${f.base64}', '_blank')">
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div style="padding: 16px; border-top: 1px solid #e5e7eb; display: flex; justify-content: flex-end; gap: 8px;">
                            <button onclick="document.getElementById('modal-ver-atendimento').style.display='none'" 
                                style="background: #6b7280; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">
                                Fechar
                            </button>
                        </div>
                    </div>
                `;
                
                modal.style.display = 'flex';
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // ABRIR ATENDIMENTO - FormulÃ¡rio
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            abrirAtendimento(entradaId) {
                console.log('[v10.463] abrirAtendimento chamado com ID:', entradaId);
                
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    Sistema.notificar('âŒ Entrada nÃ£o encontrada!', 'error');
                    console.error('[v10.463] Entrada nÃ£o encontrada:', entradaId);
                    return;
                }
                
                console.log('[v10.463] Entrada encontrada:', entrada);
                console.log('[v10.463] paciente_id da entrada:', entrada.paciente_id);
                
                // Buscar paciente pelo ID
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === entrada.paciente_id);
                
                if (!paciente) {
                    console.error('[v10.463] Paciente nÃ£o encontrado com ID:', entrada.paciente_id);
                    // Usar dados salvos na entrada como fallback
                    const nomePaciente = entrada.paciente_nome || entrada.paciente?.nome || 'N/D';
                    Sistema.notificar(`âš ï¸ Dados do paciente desatualizados: ${nomePaciente}`, 'warning');
                }
                
                console.log('[v10.463] Paciente encontrado:', paciente?.nome, 'ID:', paciente?.id);
                
                this.entradaAtual = entrada;
                
                // Atualizar status
                entrada.status = 'em_atendimento';
                SistemaCore.salvar();
                
                // Configurar Sandbox e Cabecalhos
                if (typeof Sandbox !== 'undefined') Sandbox.pacienteSelecionado = paciente;
                if (typeof Cabecalhos !== 'undefined') Cabecalhos.pacienteSelecionado = paciente;
                
                // Preencher formulÃ¡rio - usar dados do paciente OU dados salvos na entrada
                const nomePaciente = paciente?.nome || entrada.paciente_nome || 'N/D';
                document.getElementById('atend-entrada-id').value = entradaId;
                document.getElementById('form-atend-paciente-nome').textContent = nomePaciente;
                
                // Carregar modelos
                const select = document.getElementById('atend-modelo-prontuario-novo');
                select.innerHTML = '<option value="">-- Selecione um modelo --</option>';
                const modelos = SistemaCore.dados.modelos_atendimento || [];
                modelos.forEach(m => {
                    select.innerHTML += `<option value="${m.id}">ğŸ“‹ ${m.nome}</option>`;
                });
                
                // v10.463: AUTO-SELECIONAR MODELO
                // Se houver modelos, seleciona o primeiro automaticamente
                if (modelos.length > 0) {
                    const primeiroModelo = modelos[0];
                    select.value = primeiroModelo.id;
                    console.log('[v10.463] Auto-selecionando modelo:', primeiroModelo.nome);
                    
                    // Carregar os mÃ³dulos do modelo selecionado
                    this.carregarModulosProntuarioNovo(primeiroModelo.id);
                } else {
                    // Limpar mÃ³dulos se nÃ£o houver modelos
                    document.getElementById('atend-modulos-container-novo').style.display = 'none';
                    document.getElementById('atend-modulos-conteudo-novo').innerHTML = '';
                }
                
                // v10.463: NOVO ATENDIMENTO = FOTOS E ANEXOS VAZIOS
                // Cada atendimento tem seus prÃ³prios arquivos, nÃ£o herda de anteriores
                if (typeof ModuloFotos !== 'undefined') {
                    ModuloFotos.limpar();
                }
                if (typeof ModuloAnexos !== 'undefined') {
                    ModuloAnexos.limpar();
                }
                console.log('[v10.463] Fotos e anexos limpos para novo atendimento');
                
                // Mostrar formulÃ¡rio, esconder fila
                document.getElementById('form-atendimento').style.display = 'block';
                document.getElementById('fila-atendimento').style.display = 'none';
                
                console.log('[v10.463] Atendimento aberto para:', nomePaciente, '(Entrada ID:', entradaId, ')');
            },
            
            // Alias para compatibilidade
            iniciarAtendimento(entradaId) {
                this.abrirAtendimento(entradaId);
            },
            
            fecharFormAtendimento() {
                // Reverter status se nÃ£o finalizou
                if (this.entradaAtual && this.entradaAtual.status === 'em_atendimento') {
                    this.entradaAtual.status = 'aguardando_atendimento';
                    SistemaCore.salvar();
                }
                
                this.entradaAtual = null;
                
                document.getElementById('form-atendimento').style.display = 'none';
                document.getElementById('fila-atendimento').style.display = 'block';
                
                this.listarFila();
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // CARREGAR MODELO DE PRONTUÃRIO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            carregarModulosProntuarioNovo(modeloId) {
                console.log('[v10.463] carregarModulosProntuarioNovo:', modeloId);
                
                if (!modeloId) {
                    document.getElementById('atend-modulos-container-novo').style.display = 'none';
                    document.getElementById('atend-modulos-conteudo-novo').innerHTML = '';
                    return;
                }
                
                const modelo = (SistemaCore.dados.modelos_atendimento || []).find(m => m.id == modeloId);
                if (!modelo) {
                    console.error('[v10.463] Modelo nÃ£o encontrado:', modeloId);
                    return;
                }
                
                console.log('[v10.463] Carregando modelo:', modelo.nome);
                
                // Garantir que paciente estÃ¡ configurado no Sandbox
                if (this.entradaAtual && this.entradaAtual.paciente) {
                    Sandbox.pacienteSelecionado = this.entradaAtual.paciente;
                }
                
                // Container onde vai renderizar
                const container = document.getElementById('atend-modulos-conteudo-novo');
                let html = '';
                
                // 1. CABEÃ‡ALHO do modelo
                if (modelo.cabecalho_id) {
                    const layout = (SistemaCore.dados.cabecalhos_layouts || SistemaCore.dados.cabecalhos || [])
                        .find(l => l.id == modelo.cabecalho_id);
                    
                    if (layout && typeof Sandbox !== 'undefined' && Sandbox.renderizarCabecalhoLayout) {
                        html += `<div id="cabecalho-prontuario" style="margin-bottom: 20px;">${Sandbox.renderizarCabecalhoLayout(layout)}</div>`;
                        console.log('[v10.463] CabeÃ§alho renderizado');
                    }
                }
                
                // 2. MÃ“DULOS do modelo
                const modulosIds = modelo.modulos_prontuario || modelo.modulos || [];
                console.log('[v10.463] MÃ³dulos do modelo:', modulosIds);
                
                if (modulosIds.length > 0 && typeof window.TEMPLATES_MODULOS !== 'undefined') {
                    modulosIds.forEach(modId => {
                        const template = window.TEMPLATES_MODULOS[modId];
                        if (template) {
                            html += template;
                            console.log('[v10.463] MÃ³dulo renderizado:', modId);
                        } else {
                            // Fallback: textarea simples
                            html += `
                                <div class="form-group" style="margin-bottom: 16px;">
                                    <label style="font-weight: 600; display: block; margin-bottom: 8px;">${modId}</label>
                                    <textarea id="mod-${modId}" class="form-control" rows="4" 
                                        style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px;"></textarea>
                                </div>
                            `;
                            console.log('[v10.463] MÃ³dulo fallback:', modId);
                        }
                    });
                } else if (modulosIds.length > 0) {
                    // Fallback sem TEMPLATES_MODULOS
                    modulosIds.forEach(modId => {
                        html += `
                            <div class="form-group" style="margin-bottom: 16px;">
                                <label style="font-weight: 600; display: block; margin-bottom: 8px;">${modId}</label>
                                <textarea id="mod-${modId}" class="form-control" rows="4" 
                                    style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px;"></textarea>
                            </div>
                        `;
                    });
                } else {
                    html += `
                        <div style="padding: 40px; text-align: center; color: #6b7280; background: #f9fafb; border-radius: 8px;">
                            <p>Este modelo nÃ£o possui mÃ³dulos configurados.</p>
                            <p style="font-size: 13px;">Configure os mÃ³dulos em GestÃ£o â†’ Modelos de Atendimento</p>
                        </div>
                    `;
                }
                
                container.innerHTML = html;
                document.getElementById('atend-modulos-container-novo').style.display = 'block';
                
                console.log('[v10.463] Modelo carregado com sucesso');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // SALVAR/FINALIZAR ATENDIMENTO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            salvarAtendimento() {
                console.log('[v10.463] salvarAtendimento()');
                
                const entradaId = parseInt(document.getElementById('atend-entrada-id')?.value);
                const modeloId = document.getElementById('atend-modelo-prontuario-novo')?.value;
                
                if (!modeloId) {
                    Sistema.notificar('âŒ Selecione um modelo!', 'error');
                    return;
                }
                
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    Sistema.notificar('âŒ Entrada nÃ£o encontrada!', 'error');
                    return;
                }
                
                // v10.463: Buscar atendimentos anteriores desta entrada (para histÃ³rico)
                const atendimentosAnteriores = (SistemaCore.dados.atendimentos || []).filter(a => a.entrada_id === entradaId);
                if (atendimentosAnteriores.length > 0) {
                    console.log('[v10.463] Entrada jÃ¡ tem', atendimentosAnteriores.length, 'atendimento(s) anterior(es)');
                }
                
                // Mostrar loading
                Sistema.notificar('ğŸ’¾ Salvando atendimento...', 'info');
                
                // Pegar conteÃºdo dos mÃ³dulos
                const conteudoEl = document.getElementById('atend-modulos-conteudo-novo');
                const conteudoHTML = conteudoEl ? conteudoEl.innerHTML : '';
                
                // v10.463: Pegar profissional logado ou selecionado
                const profissionalLogado = SistemaCore.dados.profissional_logado || null;
                const profissionalId = profissionalLogado?.id || null;
                const profissionalNome = profissionalLogado?.nome || 'NÃ£o identificado';
                
                // Criar atendimento
                if (!SistemaCore.dados.atendimentos) SistemaCore.dados.atendimentos = [];
                
                const modelo = (SistemaCore.dados.modelos_atendimento || []).find(m => m.id == modeloId);
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === entrada.paciente_id);
                
                const atendimento = {
                    id: SistemaCore.dados.atendimentos.length > 0 ?
                        Math.max(...SistemaCore.dados.atendimentos.map(a => a.id || 0)) + 1 : 1,
                    entrada_id: entradaId,
                    paciente_id: entrada.paciente_id,
                    paciente_nome: paciente?.nome || entrada.paciente?.nome || 'N/D',
                    
                    // v10.463: Profissional que realizou o atendimento
                    profissional_id: profissionalId,
                    profissional_nome: profissionalNome,
                    
                    // v10.463: NÃºmero sequencial do atendimento nesta entrada
                    sequencia: atendimentosAnteriores.length + 1,
                    
                    agendamento_id: entrada.agendamento_id,
                    data_atendimento: new Date().toISOString().split('T')[0],
                    hora_atendimento: new Date().toTimeString().slice(0, 5),
                    modelo_id: parseInt(modeloId),
                    modelo_nome: modelo?.nome || 'N/D',
                    conteudo_html: conteudoHTML,
                    // v10.463: Salvar fotos do prontuÃ¡rio junto com o atendimento
                    fotos: typeof ModuloFotos !== 'undefined' ? ModuloFotos.obterFotos() : [],
                    // v10.463: Salvar anexos (PDF, DOC, etc)
                    anexos: typeof ModuloAnexos !== 'undefined' ? ModuloAnexos.obterAnexos() : [],
                    tipo: entrada.tipo || entrada.tipo_entrada,
                    status: 'finalizado',
                    finalizado_em: new Date().toISOString()
                };
                
                SistemaCore.dados.atendimentos.push(atendimento);
                
                // v10.463: Entrada continua "em_atendimento" atÃ© dar alta
                // NÃ£o muda para "atendido" - isso sÃ³ acontece na alta hospitalar
                entrada.status = 'em_atendimento';
                entrada.ultimo_atendimento_id = atendimento.id;
                entrada.total_atendimentos = atendimentosAnteriores.length + 1;
                
                // Atualizar agendamento se existir
                if (entrada.agendamento_id) {
                    const agendamento = (SistemaCore.dados.agendamentos || []).find(a => a.id === entrada.agendamento_id);
                    if (agendamento) {
                        agendamento.status = 'realizado';
                        console.log('[v10.463] Agendamento realizado:', agendamento.id);
                    }
                }
                
                SistemaCore.salvar();
                
                Sistema.notificar(`âœ… Atendimento finalizado!\n${paciente?.nome || 'Paciente'}\nID: ${atendimento.id}`, 'success');
                console.log('[v10.463] Atendimento salvo:', atendimento.id);
                
                this.entradaAtual = null;
                document.getElementById('form-atendimento').style.display = 'none';
                document.getElementById('fila-atendimento').style.display = 'block';
                
                this.listarFila();
                this.listarHoje();
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // TRIAGEM - Manchester Protocol
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            abrirTriagem(entradaId) {
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    Sistema.notificar('âŒ Entrada nÃ£o encontrada!', 'error');
                    return;
                }
                
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === entrada.paciente_id);
                
                // Criar modal de triagem
                let modal = document.getElementById('modal-triagem');
                if (!modal) {
                    modal = document.createElement('div');
                    modal.id = 'modal-triagem';
                    modal.className = 'modal';
                    document.body.appendChild(modal);
                }
                
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 600px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 2px solid #f59e0b;">
                            <h3 style="margin: 0; color: #d97706;">ğŸš¨ Triagem - Manchester Protocol</h3>
                            <button onclick="document.getElementById('modal-triagem').style.display='none'" style="background: none; border: none; font-size: 24px; cursor: pointer;">Ã—</button>
                        </div>
                        
                        <div style="background: #fef3c7; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                            <div style="font-weight: 600; font-size: 16px;">${paciente?.nome || 'N/D'}</div>
                            <div style="font-size: 13px; color: #92400e;">Chegou Ã s ${entrada.hora_entrada} | ${entrada.tipo_entrada || entrada.tipo || 'PA'}</div>
                        </div>
                        
                        <div class="form-group">
                            <label style="font-weight: 600;">Queixa Principal:</label>
                            <textarea id="triagem-queixa" rows="2" class="form-control" placeholder="Descreva a queixa principal..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label style="font-weight: 600;">ClassificaÃ§Ã£o de Risco:</label>
                            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-top: 8px;">
                                <button onclick="Atendimentos.selecionarClassificacao('vermelho')" id="triage-vermelho" class="btn" style="background: #dc2626; color: white; padding: 12px 8px; font-size: 11px;">
                                    ğŸ”´<br>EmergÃªncia<br><small>Imediato</small>
                                </button>
                                <button onclick="Atendimentos.selecionarClassificacao('laranja')" id="triage-laranja" class="btn" style="background: #ea580c; color: white; padding: 12px 8px; font-size: 11px;">
                                    ğŸŸ <br>Muito Urgente<br><small>10 min</small>
                                </button>
                                <button onclick="Atendimentos.selecionarClassificacao('amarelo')" id="triage-amarelo" class="btn" style="background: #ca8a04; color: white; padding: 12px 8px; font-size: 11px;">
                                    ğŸŸ¡<br>Urgente<br><small>60 min</small>
                                </button>
                                <button onclick="Atendimentos.selecionarClassificacao('verde')" id="triage-verde" class="btn" style="background: #16a34a; color: white; padding: 12px 8px; font-size: 11px;">
                                    ğŸŸ¢<br>Pouco Urgente<br><small>120 min</small>
                                </button>
                                <button onclick="Atendimentos.selecionarClassificacao('azul')" id="triage-azul" class="btn" style="background: #2563eb; color: white; padding: 12px 8px; font-size: 11px;">
                                    ğŸ”µ<br>NÃ£o Urgente<br><small>240 min</small>
                                </button>
                            </div>
                        </div>
                        
                        <input type="hidden" id="triagem-entrada-id" value="${entradaId}">
                        <input type="hidden" id="triagem-classificacao" value="">
                        
                        <div style="display: flex; gap: 12px; margin-top: 24px;">
                            <button onclick="document.getElementById('modal-triagem').style.display='none'" class="btn btn-secondary" style="flex: 1;">
                                Cancelar
                            </button>
                            <button onclick="Atendimentos.confirmarTriagem()" class="btn btn-warning" style="flex: 1;">
                                âœ… Confirmar Triagem
                            </button>
                        </div>
                    </div>
                `;
                
                modal.style.display = 'flex';
            },
            
            classificacaoSelecionada: null,
            
            selecionarClassificacao(cor) {
                this.classificacaoSelecionada = cor;
                document.getElementById('triagem-classificacao').value = cor;
                
                // Destacar botÃ£o selecionado
                ['vermelho', 'laranja', 'amarelo', 'verde', 'azul'].forEach(c => {
                    const btn = document.getElementById('triage-' + c);
                    if (btn) {
                        btn.style.opacity = c === cor ? '1' : '0.5';
                        btn.style.transform = c === cor ? 'scale(1.05)' : 'scale(1)';
                    }
                });
            },
            
            confirmarTriagem() {
                const entradaId = parseInt(document.getElementById('triagem-entrada-id').value);
                const classificacao = document.getElementById('triagem-classificacao').value;
                const queixa = document.getElementById('triagem-queixa').value;
                
                if (!classificacao) {
                    Sistema.notificar('âŒ Selecione uma classificaÃ§Ã£o de risco!', 'error');
                    return;
                }
                
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    Sistema.notificar('âŒ Entrada nÃ£o encontrada!', 'error');
                    return;
                }
                
                // Atualizar entrada com dados da triagem
                entrada.triagem = {
                    classificacao: classificacao,
                    queixa: queixa,
                    data_hora: new Date().toISOString()
                };
                entrada.status = 'aguardando_atendimento';
                entrada.classificacao_manchester = classificacao;
                
                SistemaCore.salvar();
                
                const cores = {
                    'vermelho': 'ğŸ”´ EmergÃªncia',
                    'laranja': 'ğŸŸ  Muito Urgente',
                    'amarelo': 'ğŸŸ¡ Urgente',
                    'verde': 'ğŸŸ¢ Pouco Urgente',
                    'azul': 'ğŸ”µ NÃ£o Urgente'
                };
                
                Sistema.notificar(`âœ… Triagem realizada!\n${entrada.paciente?.nome || 'Paciente'}\n${cores[classificacao]}`, 'success');
                
                // Fechar modal e atualizar listas
                document.getElementById('modal-triagem').style.display = 'none';
                this.listarTriagem();
                this.listarFila();
            },
            
            listarTriagem() {
                const container = document.getElementById('lista-triagem');
                if (!container) return;
                
                const aguardando = (SistemaCore.dados.entradas || []).filter(e => e.status === 'aguardando_triagem');
                
                if (aguardando.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #9ca3af; padding: 40px;">Nenhum paciente aguardando triagem</p>';
                    return;
                }
                
                container.innerHTML = aguardando.map(e => `
                    <div style="padding: 16px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600;">${e.paciente_nome || e.paciente?.nome || 'N/D'}</div>
                                <div style="font-size: 13px; color: #666;">Chegou Ã s ${e.hora_entrada} | ${e.tipo || 'N/D'}</div>
                            </div>
                            <button class="btn btn-warning" onclick="Atendimentos.abrirTriagem(${e.id})">
                                ğŸš¨ Triar
                            </button>
                        </div>
                    </div>
                `).join('');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // HOJE - Lista do dia
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            listarHoje() {
                const container = document.getElementById('lista-hoje');
                if (!container) return;
                
                const hoje = new Date().toISOString().split('T')[0];
                const filtroStatus = document.getElementById('filtro-hoje-status')?.value || '';
                
                // Entradas de hoje OU criadas hoje
                let entradas = (SistemaCore.dados.entradas || []).filter(e => {
                    return e.data_entrada === hoje || (e.criado_em && e.criado_em.startsWith(hoje));
                });
                
                if (filtroStatus) {
                    entradas = entradas.filter(e => e.status === filtroStatus);
                }
                
                // Ordenar por hora (mais recente primeiro)
                entradas.sort((a, b) => (b.hora_entrada || '').localeCompare(a.hora_entrada || ''));
                
                if (entradas.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #9ca3af;">
                            <p>Nenhum atendimento hoje</p>
                        </div>
                    `;
                    return;
                }
                
                const statusCores = {
                    'aguardando_triagem': '#f59e0b',
                    'aguardando_atendimento': '#3b82f6',
                    'em_atendimento': '#8b5cf6',
                    'atendido': '#10b981'
                };
                
                const statusLabels = {
                    'aguardando_triagem': 'ğŸš¨ Aguard. Triagem',
                    'aguardando_atendimento': 'â³ Aguardando',
                    'em_atendimento': 'ğŸ©º Em Atendimento',
                    'atendido': 'âœ… Atendido'
                };
                
                container.innerHTML = entradas.map(e => `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: white; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 8px; border-left: 4px solid ${statusCores[e.status] || '#6b7280'};">
                        <div>
                            <div style="font-weight: 600;">${e.hora_entrada} - ${e.paciente_nome || e.paciente?.nome || 'N/D'}</div>
                            <div style="font-size: 12px; color: #6b7280;">${e.tipo || 'N/D'} | ${e.origem || e.local_entrada || 'N/D'}</div>
                        </div>
                        <span style="background: ${statusCores[e.status] || '#6b7280'}; color: white; padding: 4px 10px; border-radius: 4px; font-size: 11px;">
                            ${statusLabels[e.status] || e.status}
                        </span>
                    </div>
                `).join('');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // HISTÃ“RICO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            buscarPacienteHistorico() {
                const busca = document.getElementById('hist-busca')?.value.toLowerCase().trim();
                const dropdown = document.getElementById('hist-dropdown');
                
                if (!busca || busca.length < 2) {
                    dropdown.style.display = 'none';
                    return;
                }
                
                const pacientes = (SistemaCore.dados.pacientes || []).filter(p =>
                    p.nome?.toLowerCase().includes(busca) ||
                    (p.cpf || '').includes(busca)
                ).slice(0, 8);
                
                if (pacientes.length === 0) {
                    dropdown.innerHTML = '<div style="padding: 12px; color: #6b7280;">Nenhum paciente encontrado</div>';
                    dropdown.style.display = 'block';
                    return;
                }
                
                dropdown.innerHTML = pacientes.map(p => `
                    <div onclick="Atendimentos.selecionarPacienteHistorico(${p.id})"
                         style="padding: 12px; cursor: pointer; border-bottom: 1px solid #f3f4f6;">
                        <div style="font-weight: 600;">${p.nome}</div>
                        <div style="font-size: 12px; color: #6b7280;">${p.cpf || 'Sem CPF'}</div>
                    </div>
                `).join('');
                
                dropdown.style.display = 'block';
            },
            
            selecionarPacienteHistorico(pacienteId) {
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                if (!paciente) return;
                
                document.getElementById('hist-dropdown').style.display = 'none';
                document.getElementById('hist-busca').value = paciente.nome;
                
                // Mostrar info do paciente
                const infoEl = document.getElementById('hist-paciente-info');
                if (infoEl) {
                    infoEl.style.display = 'block';
                    document.getElementById('hist-paciente-nome').textContent = paciente.nome;
                    document.getElementById('hist-paciente-dados').textContent =
                        `ProntuÃ¡rio: ${paciente.numero_prontuario || paciente.prontuario || 'N/D'} | CPF: ${paciente.cpf || 'N/D'}`;
                }
                
                this.carregarHistorico(pacienteId);
            },
            
            carregarHistorico(pacienteId) {
                const container = document.getElementById('hist-lista');
                if (!container) return;
                
                // Buscar atendimentos finalizados
                const atendimentos = (SistemaCore.dados.atendimentos || []).filter(a =>
                    a.paciente_id === pacienteId && a.status === 'finalizado'
                );
                
                // Ordenar por data (mais recente primeiro)
                atendimentos.sort((a, b) => (b.data_atendimento + b.hora_atendimento).localeCompare(a.data_atendimento + a.hora_atendimento));
                
                const totalEl = document.getElementById('hist-total-atendimentos');
                if (totalEl) totalEl.textContent = `${atendimentos.length} atendimento(s)`;
                
                if (atendimentos.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #9ca3af;">
                            <p>Nenhum atendimento registrado para este paciente</p>
                        </div>
                    `;
                    return;
                }
                
                this.renderizarHistoricoPaciente(container, atendimentos);
            },
            
            // Lista geral de histÃ³rico (todos os atendimentos)
            // v10.463: HISTÃ“RICO AGRUPADO POR PACIENTE (A-Z) COM DROPDOWN
            listarHistoricoGeral() {
                const container = document.getElementById('hist-lista');
                if (!container) return;
                
                // Limpar seleÃ§Ã£o de paciente
                const buscaEl = document.getElementById('hist-busca');
                if (buscaEl) buscaEl.value = '';
                
                const infoEl = document.getElementById('hist-paciente-info');
                if (infoEl) infoEl.style.display = 'none';
                
                // Buscar TODOS os atendimentos finalizados
                const atendimentos = (SistemaCore.dados.atendimentos || []).filter(a => a.status === 'finalizado');
                
                if (atendimentos.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 60px 20px; color: #9ca3af;">
                            <div style="font-size: 64px; margin-bottom: 16px;">ğŸ“‹</div>
                            <p style="font-size: 16px; margin: 0;">Nenhum atendimento finalizado ainda</p>
                            <p style="font-size: 14px; margin-top: 8px;">Os atendimentos finalizados aparecerÃ£o aqui</p>
                        </div>
                    `;
                    return;
                }
                
                // AGRUPAR POR PACIENTE
                const porPaciente = {};
                atendimentos.forEach(a => {
                    const pacId = a.paciente_id || 'desconhecido';
                    if (!porPaciente[pacId]) {
                        const paciente = SistemaCore.dados.pacientes?.find(p => p.id === pacId);
                        porPaciente[pacId] = {
                            paciente: paciente,
                            nome: paciente?.nome || 'Paciente Desconhecido',
                            atendimentos: []
                        };
                    }
                    porPaciente[pacId].atendimentos.push(a);
                });
                
                // Ordenar atendimentos de cada paciente (mais recente primeiro)
                Object.values(porPaciente).forEach(grupo => {
                    grupo.atendimentos.sort((a, b) => {
                        const dataA = (a.finalizado_em || a.data_atendimento || '');
                        const dataB = (b.finalizado_em || b.data_atendimento || '');
                        return dataB.localeCompare(dataA);
                    });
                });
                
                // Ordenar pacientes ALFABETICAMENTE
                const pacientesOrdenados = Object.values(porPaciente).sort((a, b) => 
                    a.nome.localeCompare(b.nome, 'pt-BR')
                );
                
                // Contadores
                const totalPacientes = pacientesOrdenados.length;
                const totalAtendimentos = atendimentos.length;
                
                // Renderizar cabeÃ§alho
                let html = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;">
                        <span style="font-weight: 600; color: #374151;">ğŸ‘¥ ${totalPacientes} Pacientes (A-Z)</span>
                        <span style="font-size: 13px; color: #6b7280;">ğŸ“‹ ${totalAtendimentos} atendimentos</span>
                    </div>
                `;
                
                // Renderizar cada paciente como dropdown
                pacientesOrdenados.forEach((grupo, idx) => {
                    const pac = grupo.paciente;
                    const qtdAtend = grupo.atendimentos.length;
                    const ultimoAtend = grupo.atendimentos[0];
                    const dataUltimo = ultimoAtend?.finalizado_em 
                        ? new Date(ultimoAtend.finalizado_em).toLocaleDateString('pt-BR')
                        : (ultimoAtend?.data_atendimento || 'N/D');
                    
                    // Contar fotos e anexos totais do paciente
                    const totalFotos = grupo.atendimentos.reduce((sum, a) => sum + (a.fotos?.length || 0), 0);
                    const totalAnexos = grupo.atendimentos.reduce((sum, a) => sum + (a.anexos?.length || 0), 0);
                    
                    html += `
                        <div style="background: white; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 8px; overflow: hidden;">
                            <!-- CABEÃ‡ALHO DO PACIENTE (clicÃ¡vel) -->
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 14px 16px; cursor: pointer; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;" 
                                 onclick="Atendimentos.togglePacienteHistorico('pac-hist-${idx}')">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span style="font-size: 24px;">ğŸ‘¤</span>
                                    <div>
                                        <div style="font-weight: 600; font-size: 15px;">${grupo.nome}</div>
                                        <div style="font-size: 12px; opacity: 0.9; margin-top: 2px;">
                                            ${qtdAtend} atendimento${qtdAtend > 1 ? 's' : ''} 
                                            ${totalFotos > 0 ? `â€¢ ğŸ“· ${totalFotos}` : ''}
                                            ${totalAnexos > 0 ? `â€¢ ğŸ“ ${totalAnexos}` : ''}
                                            â€¢ Ãšltimo: ${dataUltimo}
                                        </div>
                                    </div>
                                </div>
                                <span id="pac-arrow-${idx}" style="font-size: 18px; transition: transform 0.3s;">â–¼</span>
                            </div>
                            
                            <!-- LISTA DE ATENDIMENTOS (inicialmente fechada) -->
                            <div id="pac-hist-${idx}" style="display: none; background: #f8fafc;">
                                ${this.renderizarAtendimentosPaciente(grupo.atendimentos)}
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },
            
            // v10.463: Renderiza lista de atendimentos de um paciente
            renderizarAtendimentosPaciente(atendimentos) {
                return atendimentos.map((a, idx) => {
                    const data = a.finalizado_em 
                        ? new Date(a.finalizado_em).toLocaleDateString('pt-BR')
                        : (a.data_atendimento || 'N/D');
                    const hora = a.finalizado_em 
                        ? new Date(a.finalizado_em).toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'})
                        : (a.hora_atendimento || '--:--');
                    const profissional = SistemaCore.dados.profissionais?.find(p => p.id === a.profissional_id);
                    const profNome = a.profissional_nome || profissional?.nome || 'N/D';
                    const qtdFotos = a.fotos?.length || 0;
                    const qtdAnexos = a.anexos?.length || 0;
                    const seqNum = a.sequencia || (atendimentos.length - idx);
                    
                    return `
                        <div style="border-bottom: 1px solid #e5e7eb; ${idx === atendimentos.length - 1 ? 'border-bottom: none;' : ''}">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; cursor: pointer; transition: background 0.2s;"
                                 onmouseover="this.style.background='#eef2ff'" 
                                 onmouseout="this.style.background='transparent'"
                                 onclick="Atendimentos.toggleDocumentos(${a.id})">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <span style="background: ${idx === 0 ? '#10b981' : '#6b7280'}; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600;">
                                        #${seqNum}
                                    </span>
                                    <div>
                                        <div style="font-weight: 500; color: #1f2937; font-size: 14px;">
                                            ğŸ“… ${data} Ã s ${hora}
                                        </div>
                                        <div style="font-size: 12px; color: #6b7280; margin-top: 2px;">
                                            ğŸ‘¨â€âš•ï¸ ${profNome} â€¢ ${a.modelo_nome || 'ProntuÃ¡rio'}
                                            ${qtdFotos > 0 ? `<span style="color: #7c3aed;"> â€¢ ğŸ“· ${qtdFotos}</span>` : ''}
                                            ${qtdAnexos > 0 ? `<span style="color: #3b82f6;"> â€¢ ğŸ“ ${qtdAnexos}</span>` : ''}
                                        </div>
                                    </div>
                                </div>
                                <span id="hist-arrow-${a.id}" style="font-size: 14px; color: #9ca3af; transition: transform 0.2s;">â–¶</span>
                            </div>
                            <div id="hist-docs-${a.id}" style="display: none; padding: 16px; background: white; border-top: 1px solid #e5e7eb;">
                                <!-- Documentos serÃ£o carregados aqui -->
                            </div>
                        </div>
                    `;
                }).join('');
            },
            
            // v10.463: Toggle para expandir/recolher atendimentos de um paciente
            togglePacienteHistorico(containerId) {
                const container = document.getElementById(containerId);
                const idx = containerId.replace('pac-hist-', '');
                const arrow = document.getElementById(`pac-arrow-${idx}`);
                
                if (!container) return;
                
                if (container.style.display === 'none') {
                    container.style.display = 'block';
                    if (arrow) arrow.style.transform = 'rotate(180deg)';
                } else {
                    container.style.display = 'none';
                    if (arrow) arrow.style.transform = 'rotate(0deg)';
                }
            },
            
            // Toggle para mostrar/esconder documentos de um atendimento
            toggleDocumentos(atendimentoId) {
                const docsContainer = document.getElementById(`hist-docs-${atendimentoId}`);
                const arrow = document.getElementById(`hist-arrow-${atendimentoId}`);
                
                if (!docsContainer) return;
                
                if (docsContainer.style.display === 'none') {
                    // Carregar documentos
                    this.carregarDocumentosAtendimento(atendimentoId, docsContainer);
                    docsContainer.style.display = 'block';
                    if (arrow) arrow.style.transform = 'rotate(90deg)';
                } else {
                    docsContainer.style.display = 'none';
                    if (arrow) arrow.style.transform = 'rotate(0deg)';
                }
            },
            
            // Carrega os documentos de um atendimento especÃ­fico
            carregarDocumentosAtendimento(atendimentoId, container) {
                const atendimento = (SistemaCore.dados.atendimentos || []).find(a => a.id === atendimentoId);
                
                if (!atendimento) {
                    container.innerHTML = '<p style="color: #9ca3af;">Atendimento nÃ£o encontrado</p>';
                    return;
                }
                
                // Por enquanto, cada atendimento tem um documento principal (conteudo_html)
                // Futuramente pode ter mÃºltiplos documentos (evoluÃ§Ã£o, prescriÃ§Ã£o, atestado, etc.)
                
                let docs = [];
                
                // Documento principal do atendimento
                if (atendimento.conteudo_html) {
                    docs.push({
                        tipo: 'prontuario',
                        nome: atendimento.modelo_nome || 'ProntuÃ¡rio',
                        icone: 'ğŸ“„',
                        id: atendimento.id
                    });
                }
                
                // v10.463: Verificar se tem fotos
                const temFotos = atendimento.fotos && atendimento.fotos.length > 0;
                
                // v10.463: Verificar se tem anexos
                const temAnexos = atendimento.anexos && atendimento.anexos.length > 0;
                
                if (docs.length === 0 && !temFotos && !temAnexos) {
                    container.innerHTML = '<p style="color: #9ca3af; text-align: center;">Nenhum documento registrado</p>';
                    return;
                }
                
                // v10.463: Renderizar galeria de fotos se existir
                let fotosHtml = '';
                if (temFotos) {
                    fotosHtml = `
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb;">
                            <div style="font-weight: 600; color: #374151; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                                <span>ğŸ“·</span> Fotos do Atendimento (${atendimento.fotos.length})
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 12px;">
                                ${atendimento.fotos.map((foto, idx) => `
                                    <div style="position: relative; border: 1px solid #e5e7eb; border-radius: 8px; overflow: hidden; cursor: pointer;"
                                         onclick="Atendimentos.visualizarFotoHistorico(${atendimentoId}, ${idx})">
                                        <img src="${foto.base64}" style="width: 100%; height: 80px; object-fit: cover;">
                                        ${foto.editada ? '<span style="position: absolute; top: 4px; left: 4px; background: #3b82f6; color: white; padding: 2px 6px; border-radius: 4px; font-size: 9px;">âœï¸ Editada</span>' : ''}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
                
                // v10.463: Renderizar lista de anexos se existir
                let anexosHtml = '';
                if (temAnexos) {
                    const getIcone = (tipo) => {
                        const icones = {'pdf':'ğŸ“•','doc':'ğŸ“˜','docx':'ğŸ“˜','xls':'ğŸ“—','xlsx':'ğŸ“—','ppt':'ğŸ“™','pptx':'ğŸ“™','txt':'ğŸ“„','csv':'ğŸ“Š','zip':'ğŸ“¦','rar':'ğŸ“¦','default':'ğŸ“'};
                        return icones[tipo] || icones['default'];
                    };
                    const formatarTamanho = (bytes) => {
                        if (bytes < 1024) return bytes + ' B';
                        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
                        return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
                    };
                    anexosHtml = `
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #e5e7eb;">
                            <div style="font-weight: 600; color: #374151; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                                <span>ğŸ“</span> Anexos do Atendimento (${atendimento.anexos.length})
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                ${atendimento.anexos.map((anexo, idx) => `
                                    <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 6px;">
                                        <span style="font-size: 24px;">${getIcone(anexo.tipo)}</span>
                                        <div style="flex: 1; min-width: 0;">
                                            <div style="font-weight: 500; color: #1f2937; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${anexo.nome}</div>
                                            <div style="font-size: 11px; color: #6b7280;">${anexo.tipo?.toUpperCase() || 'ARQ'} â€¢ ${formatarTamanho(anexo.tamanho || 0)}</div>
                                        </div>
                                        <button onclick="Atendimentos.baixarAnexoHistorico(${atendimentoId}, ${idx})" 
                                                style="background: #10b981; color: white; border: none; padding: 6px 10px; border-radius: 4px; font-size: 11px; cursor: pointer;">
                                            â¬‡ï¸ Baixar
                                        </button>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
                
                container.innerHTML = `
                    <div style="display: flex; flex-wrap: wrap; gap: 12px;">
                        ${docs.map(doc => `
                            <button class="btn btn-secondary" onclick="Atendimentos.verDocumento(${doc.id})" 
                                    style="display: flex; align-items: center; gap: 8px; padding: 10px 16px;">
                                <span style="font-size: 18px;">${doc.icone}</span>
                                <span>${doc.nome}</span>
                            </button>
                        `).join('')}
                    </div>
                    ${fotosHtml}
                    ${anexosHtml}
                `;
            },
            
            // v10.463: Visualizar foto do histÃ³rico em modal fullscreen
            visualizarFotoHistorico(atendimentoId, fotoIdx) {
                const atendimento = (SistemaCore.dados.atendimentos || []).find(a => a.id === atendimentoId);
                if (!atendimento || !atendimento.fotos || !atendimento.fotos[fotoIdx]) return;
                
                const foto = atendimento.fotos[fotoIdx];
                
                const modal = document.createElement('div');
                modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.9); z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer;';
                modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
                
                modal.innerHTML = `
                    <img src="${foto.base64}" style="max-width: 90%; max-height: 85%; object-fit: contain; border-radius: 8px;">
                    <div style="margin-top: 16px; color: white; font-size: 13px;">
                        ${foto.editada ? 'âœï¸ Editada no Simulador' : 'ğŸ“· Foto Original'}
                        ${foto.nome ? ` â€¢ ${foto.nome}` : ''}
                    </div>
                    <button onclick="this.parentElement.remove()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); border: none; color: white; padding: 10px 16px; border-radius: 8px; cursor: pointer; font-size: 14px;">
                        âœ• Fechar
                    </button>
                `;
                
                document.body.appendChild(modal);
            },
            
            // v10.463: Baixar anexo do histÃ³rico
            baixarAnexoHistorico(atendimentoId, anexoIdx) {
                const atendimento = (SistemaCore.dados.atendimentos || []).find(a => a.id === atendimentoId);
                if (!atendimento || !atendimento.anexos || !atendimento.anexos[anexoIdx]) return;
                
                const anexo = atendimento.anexos[anexoIdx];
                
                const link = document.createElement('a');
                link.href = anexo.base64;
                link.download = anexo.nome;
                link.click();
                
                Sistema.notificar(`â¬‡ï¸ Baixando "${anexo.nome}"...`, 'info');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // VER PRONTUÃRIO - Abre histÃ³rico do paciente
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            verProntuario(pacienteId) {
                const paciente = SistemaCore.dados.pacientes.find(p => p.id === pacienteId);
                if (!paciente) {
                    Sistema.notificar('âŒ Paciente nÃ£o encontrado!', 'error');
                    return;
                }
                
                console.log('[v10.463] verProntuario:', paciente.nome);
                
                // Ir para aba Atendimentos â†’ HistÃ³rico
                Sistema.trocarTab('atendimentos');
                
                setTimeout(() => {
                    this.trocarAba('historico');
                    
                    setTimeout(() => {
                        // Selecionar paciente e carregar histÃ³rico
                        this.selecionarPacienteHistorico(pacienteId);
                    }, 100);
                }, 100);
            },
            
            verDocumento(atendimentoId) {
                const atendimento = (SistemaCore.dados.atendimentos || []).find(a => a.id === atendimentoId);
                if (!atendimento || !atendimento.conteudo_html) {
                    Sistema.notificar('âŒ Documento nÃ£o encontrado', 'error');
                    return;
                }
                
                // Criar modal para visualizar
                const modalHTML = `
                    <div id="modal-documento" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 9999; display: flex; align-items: center; justify-content: center;">
                        <div style="background: white; width: 90%; max-width: 900px; max-height: 90vh; border-radius: 12px; overflow: hidden; display: flex; flex-direction: column;">
                            <div style="padding: 16px; background: #f8fafc; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;">
                                <h3 style="margin: 0;">ğŸ“„ ${atendimento.modelo_nome || 'Documento'}</h3>
                                <button onclick="document.getElementById('modal-documento').remove()" style="background: none; border: none; font-size: 24px; cursor: pointer;">Ã—</button>
                            </div>
                            <div style="padding: 24px; overflow-y: auto; flex: 1;">
                                ${atendimento.conteudo_html}
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.insertAdjacentHTML('beforeend', modalHTML);
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // UTILITÃRIOS
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            atualizarContadores() {
                // Atualizar contadores no dashboard se existirem
            },
            
            limparAtendimentosFantasmas() {
                // Limpar entradas Ã³rfÃ£s
                if (!SistemaCore.dados.entradas) return 0;
                
                const antes = SistemaCore.dados.entradas.length;
                SistemaCore.dados.entradas = SistemaCore.dados.entradas.filter(e => {
                    if (!e.paciente_id) return false;
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === e.paciente_id);
                    return !!paciente;
                });
                
                const removidos = antes - SistemaCore.dados.entradas.length;
                if (removidos > 0) SistemaCore.salvar();
                
                return removidos;
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // DIAGNÃ“STICO E RESET
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            diagnosticar() {
                const entradas = SistemaCore.dados.entradas || [];
                const atendimentos = SistemaCore.dados.atendimentos || [];
                const agendamentos = SistemaCore.dados.agendamentos || [];
                
                // Contar duplicatas
                const entradasPorAgendamento = {};
                entradas.forEach(e => {
                    if (e.agendamento_id) {
                        entradasPorAgendamento[e.agendamento_id] = (entradasPorAgendamento[e.agendamento_id] || 0) + 1;
                    }
                });
                const duplicatas = Object.values(entradasPorAgendamento).filter(v => v > 1).length;
                
                const msg = `ğŸ“Š DIAGNÃ“STICO v10.463

ğŸ“‹ Entradas: ${entradas.length}
   - Aguardando triagem: ${entradas.filter(e => e.status === 'aguardando_triagem').length}
   - Aguardando atendimento: ${entradas.filter(e => e.status === 'aguardando_atendimento').length}
   - Em atendimento: ${entradas.filter(e => e.status === 'em_atendimento').length}
   - Atendidos: ${entradas.filter(e => e.status === 'atendido').length}
   
âš ï¸ Duplicatas (mesmo agendamento): ${duplicatas}

ğŸ“… Agendamentos: ${agendamentos.length}
   - Agendado: ${agendamentos.filter(a => a.status === 'agendado').length}
   - Confirmado: ${agendamentos.filter(a => a.status === 'confirmado').length}
   - Realizado: ${agendamentos.filter(a => a.status === 'realizado').length}
   - NÃ£o compareceu: ${agendamentos.filter(a => a.status === 'nao_compareceu').length}
   - Cancelado: ${agendamentos.filter(a => a.status === 'cancelado').length}

ğŸ©º Atendimentos finalizados: ${atendimentos.filter(a => a.status === 'finalizado').length}`;

                alert(msg);
                console.log(msg);
            },
            
            resetarTudo() {
                if (!confirm('âš ï¸ ATENÃ‡ÃƒO!\n\nIsso vai:\n- Limpar TODAS as entradas (fila)\n- Limpar TODOS os atendimentos\n- Resetar status dos agendamentos para "agendado"\n\nAgendamentos e pacientes serÃ£o mantidos.\n\nContinuar?')) {
                    return;
                }
                
                // Limpar entradas
                SistemaCore.dados.entradas = [];
                
                // Limpar atendimentos
                SistemaCore.dados.atendimentos = [];
                
                // Resetar status dos agendamentos (exceto cancelados)
                (SistemaCore.dados.agendamentos || []).forEach(ag => {
                    if (ag.status !== 'cancelado') {
                        ag.status = 'agendado';
                    }
                });
                
                SistemaCore.salvar();
                
                Sistema.notificar('âœ… Reset completo!', 'success');
                this.listarFila();
                this.listarHoje();
            },
            
            resetarSoEntradas() {
                if (!confirm('Limpar todas as entradas da fila?\n\nAgendamentos e atendimentos serÃ£o mantidos.')) {
                    return;
                }
                
                SistemaCore.dados.entradas = [];
                SistemaCore.salvar();
                
                Sistema.notificar('âœ… Entradas limpas!', 'success');
                this.listarFila();
                this.listarHoje();
            },
            
            removerDuplicatas() {
                const entradas = SistemaCore.dados.entradas || [];
                const vistos = new Set();
                const unicas = [];
                
                entradas.forEach(e => {
                    // Chave Ãºnica: agendamento_id ou paciente_id + data + hora
                    const chave = e.agendamento_id ? 
                        `ag-${e.agendamento_id}` : 
                        `pac-${e.paciente_id}-${e.data_entrada}-${e.hora_entrada}`;
                    
                    if (!vistos.has(chave)) {
                        vistos.add(chave);
                        unicas.push(e);
                    }
                });
                
                const removidas = entradas.length - unicas.length;
                SistemaCore.dados.entradas = unicas;
                SistemaCore.salvar();
                
                Sistema.notificar(`âœ… ${removidas} duplicata(s) removida(s)!`, 'success');
                this.listarFila();
                this.listarHoje();
                
                return removidas;
            }
        };

        /* ============================================================
           [PRONTUARIO] MÃ³dulo ProntuÃ¡rio EletrÃ´nico
           ============================================================ */
        
        const Prontuario = {
            agendamentoAtual: null,
            atendimentoAtual: null,
            modoVisualizacao: false,

            abrir(agendamentoId, visualizar = false) {
                this.modoVisualizacao = visualizar;
                const agend = SistemaCore.dados.agendamentos.find(a => a.id === agendamentoId);
                if (!agend) return;

                this.agendamentoAtual = agend;
                
                // Verificar se jÃ¡ existe atendimento para este agendamento
                this.atendimentoAtual = SistemaCore.dados.atendimentos.find(at => at.agendamento_id === agendamentoId);

                const paciente = SistemaCore.dados.pacientes.find(p => p.id === agend.paciente_id);
                if (!paciente) return;

                // Preencher cabeÃ§alho
                document.getElementById('prontuario-paciente-nome').textContent = paciente.nome;
                document.getElementById('prontuario-agendamento-id').value = agendamentoId;

                let infoHtml = '';
                if (paciente.nascimento) {
                    const idade = Pacientes.calcularIdade(paciente.nascimento);
                    infoHtml += `<div><strong>Idade:</strong> ${idade} anos</div>`;
                }
                if (paciente.cpf) {
                    infoHtml += `<div><strong>CPF:</strong> ${paciente.cpf}</div>`;
                }
                if (paciente.telefone) {
                    infoHtml += `<div><strong>Telefone:</strong> ${paciente.telefone}</div>`;
                }
                infoHtml += `<div><strong>Data:</strong> ${new Date(agend.data + 'T00:00:00').toLocaleDateString('pt-BR')} ${agend.hora}</div>`;
                
                document.getElementById('prontuario-paciente-info').innerHTML = infoHtml;

                // Se existe atendimento, carregar dados
                if (this.atendimentoAtual) {
                    this.carregarDados(this.atendimentoAtual);
                } else {
                    this.limparFormulario();
                }

                // Se estÃ¡ em modo visualizaÃ§Ã£o, desabilitar campos
                if (visualizar) {
                    document.querySelectorAll('#modalProntuario input, #modalProntuario textarea, #modalProntuario select').forEach(el => {
                        el.disabled = true;
                    });
                } else {
                    document.querySelectorAll('#modalProntuario input, #modalProntuario textarea, #modalProntuario select').forEach(el => {
                        el.disabled = false;
                    });
                }

                // Verificar se hÃ¡ campos de coleta configurados
                if (SistemaCore.dados.campos_coleta.length > 0) {
                    this.renderizarCamposColeta();
                }

                document.getElementById('modalProntuario').classList.add('active');
            },

            limparFormulario() {
                document.getElementById('pront-queixa').value = '';
                document.getElementById('pront-hda').value = '';
                document.getElementById('pront-hpp').value = '';
                document.getElementById('pront-medicacoes').value = '';
                document.getElementById('pront-alergias').value = '';
                document.getElementById('pront-pa').value = '';
                document.getElementById('pront-fc').value = '';
                document.getElementById('pront-temp').value = '';
                document.getElementById('pront-exame-geral').value = '';
                document.getElementById('pront-exame-especifico').value = '';
                document.getElementById('pront-diagnostico').value = '';
                document.getElementById('pront-conduta').value = '';
                document.getElementById('pront-prescricao').value = '';
                document.getElementById('pront-orientacoes').value = '';
            },

            carregarDados(atendimento) {
                document.getElementById('pront-queixa').value = atendimento.queixa || '';
                document.getElementById('pront-hda').value = atendimento.hda || '';
                document.getElementById('pront-hpp').value = atendimento.hpp || '';
                document.getElementById('pront-medicacoes').value = atendimento.medicacoes || '';
                document.getElementById('pront-alergias').value = atendimento.alergias || '';
                document.getElementById('pront-pa').value = atendimento.pa || '';
                document.getElementById('pront-fc').value = atendimento.fc || '';
                document.getElementById('pront-temp').value = atendimento.temp || '';
                document.getElementById('pront-exame-geral').value = atendimento.exame_geral || '';
                document.getElementById('pront-exame-especifico').value = atendimento.exame_especifico || '';
                document.getElementById('pront-diagnostico').value = atendimento.diagnostico || '';
                document.getElementById('pront-conduta').value = atendimento.conduta || '';
                document.getElementById('pront-prescricao').value = atendimento.prescricao || '';
                document.getElementById('pront-orientacoes').value = atendimento.orientacoes || '';

                // Carregar campos de coleta se existirem
                if (atendimento.campos_coleta) {
                    Object.keys(atendimento.campos_coleta).forEach(campoId => {
                        const elemento = document.getElementById(`pront-campo-${campoId}`);
                        if (elemento) {
                            elemento.value = atendimento.campos_coleta[campoId];
                        }
                    });
                }
            },

            renderizarCamposColeta() {
                const container = document.getElementById('prontuario-campos-coleta-container');
                const campos = SistemaCore.dados.campos_coleta;

                let html = '<div style="display: grid; gap: 12px;">';
                campos.forEach(campo => {
                    html += `<div class="form-group" style="margin-bottom: 0;">`;
                    html += `<label>${campo.nome}${campo.obrigatorio ? ' <span style="color: var(--danger);">*</span>' : ''}</label>`;
                    
                    switch (campo.tipo) {
                        case 'textarea':
                            html += `<textarea class="form-control" id="pront-campo-${campo.id}" ${campo.obrigatorio ? 'required' : ''}></textarea>`;
                            break;
                        case 'select':
                            html += `<select class="form-control" id="pront-campo-${campo.id}" ${campo.obrigatorio ? 'required' : ''}>`;
                            html += '<option value="">Selecione...</option>';
                            if (campo.opcoes) {
                                campo.opcoes.split(',').forEach(op => {
                                    html += `<option value="${op.trim()}">${op.trim()}</option>`;
                                });
                            }
                            html += '</select>';
                            break;
                        default:
                            const inputType = {
                                'numero': 'number',
                                'data': 'date',
                                'email': 'email',
                                'telefone': 'tel'
                            }[campo.tipo] || 'text';
                            html += `<input type="${inputType}" class="form-control" id="pront-campo-${campo.id}" ${campo.obrigatorio ? 'required' : ''}>`;
                    }
                    
                    html += '</div>';
                });
                html += '</div>';

                container.innerHTML = html;
                document.getElementById('prontuario-campos-coleta').style.display = 'block';
            },

            salvar() {
                if (this.modoVisualizacao) {
                    this.fecharModal();
                    return;
                }

                const agendamentoId = parseInt(document.getElementById('prontuario-agendamento-id').value) || null;

                // Coletar dados do prontuÃ¡rio
                const dados = {
                    agendamento_id: agendamentoId,
                    paciente_id: this.agendamentoAtual ? this.agendamentoAtual.paciente_id : (this.atendimentoAtual ? this.atendimentoAtual.paciente_id : null),
                    profissional_id: this.agendamentoAtual ? this.agendamentoAtual.profissional_id : (this.atendimentoAtual ? this.atendimentoAtual.profissional_id : null),
                    data_atendimento: new Date().toISOString(),
                    queixa: document.getElementById('pront-queixa').value,
                    hda: document.getElementById('pront-hda').value,
                    hpp: document.getElementById('pront-hpp').value,
                    medicacoes: document.getElementById('pront-medicacoes').value,
                    alergias: document.getElementById('pront-alergias').value,
                    pa: document.getElementById('pront-pa').value,
                    fc: document.getElementById('pront-fc').value,
                    temp: document.getElementById('pront-temp').value,
                    exame_geral: document.getElementById('pront-exame-geral').value,
                    exame_especifico: document.getElementById('pront-exame-especifico').value,
                    diagnostico: document.getElementById('pront-diagnostico').value,
                    conduta: document.getElementById('pront-conduta').value,
                    prescricao: document.getElementById('pront-prescricao').value,
                    orientacoes: document.getElementById('pront-orientacoes').value
                };

                // Coletar campos personalizados se existirem
                if (SistemaCore.dados.campos_coleta.length > 0) {
                    dados.campos_coleta = {};
                    SistemaCore.dados.campos_coleta.forEach(campo => {
                        const elemento = document.getElementById(`pront-campo-${campo.id}`);
                        if (elemento) {
                            dados.campos_coleta[campo.id] = elemento.value;
                        }
                    });
                }

                // Salvar ou atualizar atendimento
                if (this.atendimentoAtual) {
                    // Atualizar existente
                    Object.assign(this.atendimentoAtual, dados);
                } else {
                    // Criar novo
                    dados.id = SistemaCore.proximoId(SistemaCore.dados.atendimentos);
                    SistemaCore.dados.atendimentos.push(dados);
                }

                // Atualizar status do agendamento (se houver)
                if (this.agendamentoAtual) {
                    this.agendamentoAtual.status = 'realizado';
                }

                SistemaCore.salvar();
                this.fecharModal();
                Sistema.notificar('ProntuÃ¡rio salvo com sucesso!');
                // Atendimentos.listar(); // REMOVIDO v10.10.3: funÃ§Ã£o nÃ£o existe (usa sub-abas)
                Agenda.listar(); // v8.0.10: Atualizar lista lateral da agenda
                Calendario.renderizar(); // v8.0.10: Atualizar calendÃ¡rio quando marca como realizado
                Sistema.atualizarDashboard();
            },

            imprimir() {
                window.print();
            },

            // ABRIR DIRETO POR ATENDIMENTO
            abrirDireto(atendimentoId) {
                const atend = SistemaCore.dados.atendimentos.find(a => a.id === atendimentoId);
                if (!atend) {
                    alert('Atendimento nÃ£o encontrado!');
                    return;
                }
                
                const pac = SistemaCore.dados.pacientes.find(p => p.id === atend.paciente_id);
                if (!pac) {
                    alert('Paciente nÃ£o encontrado!');
                    return;
                }
                
                // Guardar referÃªncia ao atendimento
                this.atendimentoAtual = atend;
                this.agendamentoAtual = null; // NÃ£o Ã© via agendamento
                this.modoVisualizacao = false;
                
                // Preencher cabeÃ§alho com dados do paciente
                document.getElementById('prontuario-paciente-nome').textContent = pac.nome;
                document.getElementById('prontuario-agendamento-id').value = atend.agendamento_id || '';
                
                let infoHtml = '';
                if (pac.nascimento) {
                    const idade = Pacientes.calcularIdade(pac.nascimento);
                    infoHtml += `<div><strong>Idade:</strong> ${idade} anos</div>`;
                }
                if (pac.cpf) {
                    infoHtml += `<div><strong>CPF:</strong> ${pac.cpf}</div>`;
                }
                infoHtml += `<div><strong>Data:</strong> ${atend.data_entrada} ${atend.hora_entrada}</div>`;
                
                document.getElementById('prontuario-paciente-info').innerHTML = infoHtml;
                
                // Carregar dados se jÃ¡ existem (verificar se tem queixa ou qualquer outro campo preenchido)
                if (atend.queixa || atend.hda || atend.diagnostico) {
                    this.carregarDados(atend);
                } else {
                    this.limparFormulario();
                }
                
                // Habilitar campos (nÃ£o Ã© visualizaÃ§Ã£o)
                document.querySelectorAll('#modalProntuario input, #modalProntuario textarea, #modalProntuario select').forEach(el => {
                    el.disabled = false;
                });
                
                // Verificar se hÃ¡ campos de coleta configurados
                if (SistemaCore.dados.campos_coleta && SistemaCore.dados.campos_coleta.length > 0) {
                    this.renderizarCamposColeta();
                }
                
                // Abrir modal
                document.getElementById('modalProntuario').classList.add('active');
            },

            fecharModal() {
                document.getElementById('modalProntuario').classList.remove('active');
                this.agendamentoAtual = null;
                this.atendimentoAtual = null;
                this.modoVisualizacao = false;
            }
        };

        /* ============================================================
           [ATENDIMENTO TEMPLATE] Sistema de Atendimento com Templates Modulares
           v10.18.0 - Sistema completo de renderizaÃ§Ã£o dinÃ¢mica de mÃ³dulos
           ============================================================ */
        
        // ========== PASSO 1: POOLS DE DADOS ==========
        const POOLS_DADOS = {
            expectativas: [
                'Melhora do contorno corporal',
                'ReduÃ§Ã£o de flacidez',
                'Aumento de volume',
                'ReduÃ§Ã£o de volume',
                'HarmonizaÃ§Ã£o facial',
                'Rejuvenescimento',
                'Abdominoplastia',
                'Mamoplastia',
                'LipoaspiraÃ§Ã£o',
                'Rinoplastia',
                'Tratamento de cicatrizes',
                'CorreÃ§Ã£o de assimetrias'
            ],
            
            alergias: [
                'Penicilina',
                'Dipirona',
                'AINEs',
                'Sulfa',
                'LÃ¡tex'
            ],
            
            doencas: [
                'HipertensÃ£o Arterial SistÃªmica (HAS)',
                'Diabetes Mellitus tipo 1',
                'Diabetes Mellitus tipo 2',
                'Dislipidemia',
                'Hipercolesterolemia',
                'Hipertrigliceridemia',
                'Cardiopatia IsquÃªmica',
                'InsuficiÃªncia CardÃ­aca Congestiva (ICC)',
                'Arritmias CardÃ­acas',
                'FibrilaÃ§Ã£o Atrial',
                'Asma BrÃ´nquica',
                'DPOC (DoenÃ§a Pulmonar Obstrutiva CrÃ´nica)',
                'Bronquite CrÃ´nica',
                'Enfisema Pulmonar',
                'Obesidade',
                'Obesidade MÃ³rbida',
                'Hipotireoidismo',
                'Hipertireoidismo',
                'Tireoidite de Hashimoto',
                'DoenÃ§a Renal CrÃ´nica',
                'InsuficiÃªncia Renal',
                'Hepatopatia',
                'Cirrose HepÃ¡tica',
                'Esteatose HepÃ¡tica (FÃ­gado Gorduroso)',
                'Artrite Reumatoide',
                'Artrose',
                'Osteoporose',
                'LÃºpus Eritematoso SistÃªmico (LES)',
                'Fibromialgia',
                'DepressÃ£o',
                'Transtorno de Ansiedade Generalizada (TAG)',
                'Transtorno Bipolar',
                'Epilepsia',
                'DoenÃ§a de Parkinson',
                'DoenÃ§a de Alzheimer',
                'AVC PrÃ©vio (Acidente Vascular Cerebral)',
                'Trombose Venosa Profunda (TVP)',
                'Varizes',
                'InsuficiÃªncia Venosa CrÃ´nica',
                'Refluxo GastroesofÃ¡gico (DRGE)',
                'Ãšlcera PÃ©ptica',
                'DoenÃ§a de Crohn',
                'Retocolite Ulcerativa',
                'SÃ­ndrome do Intestino IrritÃ¡vel',
                'Glaucoma',
                'Catarata',
                'DegeneraÃ§Ã£o Macular',
                'Apneia do Sono',
                'Enxaqueca CrÃ´nica'
            ],
            
            cirurgias: [
                'Apendicectomia',
                'Colecistectomia',
                'Herniorrafia Inguinal',
                'Herniorrafia Umbilical',
                'Herniorrafia Incisional',
                'CesÃ¡rea',
                'Histerectomia',
                'Ooforectomia',
                'Mastectomia',
                'Prostatectomia',
                'Hemorroidectomia',
                'FÃ­stula Perianal',
                'Tireoidecomia',
                'Amigdalectomia',
                'Adenoidectomia',
                'Septoplastia',
                'Turbinectomia',
                'Safenectomia',
                'RevascularizaÃ§Ã£o do MiocÃ¡rdio',
                'Angioplastia',
                'Artroscopia de Joelho',
                'Meniscectomia',
                'Artroplastia de Quadril',
                'Artroplastia de Joelho',
                'FixaÃ§Ã£o de Fratura',
                'Colectomia',
                'Gastrectomia',
                'Esplenectomia',
                'Nefrectomia',
                'Litotripsia',
                'Catarata',
                'Vitrectomia',
                'Cesariana',
                'Curetagem Uterina'
            ],
            
            medicacoes: [
                'Losartana',
                'Enalapril',
                'Captopril',
                'Hidroclorotiazida',
                'Furosemida',
                'Espironolactona',
                'Atenolol',
                'Propranolol',
                'Metoprolol',
                'Carvedilol',
                'Anlodipino',
                'Nifedipino',
                'Sinvastatina',
                'Atorvastatina',
                'Rosuvastatina',
                'AAS (Ãcido AcetilsalicÃ­lico)',
                'Clopidogrel',
                'Varfarina',
                'Rivaroxabana',
                'Metformina',
                'Glibenclamida',
                'Insulina NPH',
                'Insulina Regular',
                'Insulina Glargina',
                'Levotiroxina',
                'Puran T4',
                'Omeprazol',
                'Pantoprazol',
                'Ranitidina',
                'Fluoxetina',
                'Sertralina',
                'Escitalopram',
                'Amitriptilina',
                'Clonazepam',
                'Alprazolam',
                'Diazepam',
                'Risperidona',
                'Quetiapina',
                'Haloperidol',
                'Carbamazepina',
                'Ãcido Valproico',
                'FenitoÃ­na',
                'Levodopa',
                'Biperideno',
                'Prednisona',
                'Dexametasona',
                'Azatioprina',
                'Metotrexato',
                'Alendronato',
                'Vitamina D',
                'CÃ¡lcio',
                'Sulfato Ferroso',
                'Ãcido FÃ³lico',
                'Complexo B',
                'Paracetamol',
                'Dipirona',
                'Ibuprofeno',
                'Diclofenaco',
                'Nimesulida',
                'Tramadol',
                'CodeÃ­na',
                'Morfina'
            ]
        };
        
        // FunÃ§Ã£o para inicializar pools do localStorage
        function inicializarPools() {
            console.log('ğŸ”§ Inicializando pools...');
            
            // Carregar de localStorage
            for (const key in POOLS_DADOS) {
                const poolSalvo = localStorage.getItem('pool' + key.charAt(0).toUpperCase() + key.slice(1));
                if (poolSalvo) {
                    try {
                        POOLS_DADOS[key] = JSON.parse(poolSalvo);
                        console.log('âœ… Pool', key, 'carregado:', POOLS_DADOS[key].length, 'itens');
                    } catch (e) {
                        console.error('âŒ Erro ao carregar pool', key, ':', e);
                    }
                }
            }
            
            // SINCRONIZAR BIDIRECIONAL com SistemaCore.dados.pools (SEM salvar)
            if (SistemaCore.dados.pools) {
                for (const key in POOLS_DADOS) {
                    if (SistemaCore.dados.pools[key] && SistemaCore.dados.pools[key].length > 0) {
                        // Mesclar: uniÃ£o dos dois arrays sem duplicatas
                        const merged = [...new Set([...POOLS_DADOS[key], ...SistemaCore.dados.pools[key]])];
                        POOLS_DADOS[key] = merged;
                        SistemaCore.dados.pools[key] = merged;
                        console.log('ğŸ”„ Pool', key, 'sincronizado (mesclado):', merged.length, 'itens');
                    }
                }
                // NÃƒO salvar aqui - deixar salvar apenas quando houver modificaÃ§Ã£o real
            }
        }
        
        // FunÃ§Ã£o para salvar pool
        function salvarPool(nomePool, dados) {
            const key = 'pool' + nomePool.charAt(0).toUpperCase() + nomePool.slice(1);
            localStorage.setItem(key, JSON.stringify(dados));
            console.log('ğŸ’¾ Pool', nomePool, 'salvo:', dados.length, 'itens');
            
            // SINCRONIZAR com SistemaCore.dados.pools
            if (!SistemaCore.dados.pools) {
                SistemaCore.dados.pools = {};
            }
            SistemaCore.dados.pools[nomePool] = dados;
            SistemaCore.salvar();
            console.log('ğŸ”„ Pool sincronizado com SistemaCore:', nomePool);
        }
        
        // POOLS serÃ£o inicializados DEPOIS do Sistema.init() carregar os dados
        // (chamada movida para dentro de Sistema.init)
        
        // ========== PASSO 2: REGISTRO DE MÃ“DULOS ==========
        const MODULOS_REGISTRADOS = {

            'historia-atual': {
                render(config) {
                    return `<div class="modulo-container" style="background: white; border: 1px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 15px 0; color: #333;">HistÃ³ria da DoenÃ§a Atual</h3>
                        <textarea id="${config.id}" placeholder="Detalhe a evoluÃ§Ã£o da queixa..." rows="5" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 13px; resize: vertical;"></textarea>
                    </div>`;
                },
                coletar(config) { return { valor: document.getElementById(config.id).value, timestamp: new Date().toISOString() }; },
                carregar(config, dados) { if (dados?.valor) document.getElementById(config.id).value = dados.valor; }
            },
            'conduta': {
                render(config) {
                    return `<div class="modulo-container" style="background: white; border: 1px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="margin: 0 0 15px 0; color: #333;">Conduta</h3>
                        <textarea id="${config.id}" placeholder="PrescriÃ§Ã£o, retorno, exames..." rows="4" style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 13px; resize: vertical;"></textarea>
                    </div>`;
                },
                coletar(config) { return { valor: document.getElementById(config.id).value, timestamp: new Date().toISOString() }; },
                carregar(config, dados) { if (dados?.valor) document.getElementById(config.id).value = dados.valor; }
            },
            'queixa': {
                render(config) {
                    console.log('ğŸ¨ Renderizando mÃ³dulo queixa:', config.id);
                    return `
                        <div class="modulo-container" style="background: white; border: 1px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="margin: 0 0 15px 0; color: #333; display: flex; align-items: center; gap: 10px;">
                                Queixa Principal
                            </h3>
                            <textarea 
                                id="${config.id}"
                                data-modulo="queixa"
                                placeholder="Ex: Dor abdominal hÃ¡ 2 dias, insatisfaÃ§Ã£o com aparÃªncia..."
                                rows="3"
                                style="width: 100%; padding: 12px; border: 1px solid #e0e0e0; border-radius: 8px; font-size: 13px; resize: vertical;"
                            ></textarea>
                        </div>
                    `;
                },
                
                coletar(config) {
                    const valor = document.getElementById(config.id).value;
                    console.log('ğŸ“Š Coletando queixa:', valor ? 'preenchido' : 'vazio');
                    return {
                        valor: valor,
                        timestamp: new Date().toISOString()
                    };
                },
                
                carregar(config, dados) {
                    if (dados && dados.valor) {
                        console.log('ğŸ“¥ Carregando queixa');
                        document.getElementById(config.id).value = dados.valor;
                    }
                }
            },
            
            'expectativas': {
                render(config) {
                    console.log('ğŸ¨ Renderizando expectativas:', config.id);
                    
                    // ID seguro (sem hÃ­fens) para nomes de funÃ§Ãµes JavaScript
                    const configIdSafe = config.id.replace(/-/g, '_');
                    
                    return `
                        <div class="modulo-container" style="background: white; border: 1px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="margin: 0 0 15px 0; color: #333;">Expectativas e Objetivos</h3>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e0e0e0;">
                                <!-- Tags selecionadas -->
                                <div id="tagsExpectativas_${config.id}" style="display: flex; flex-wrap: wrap; gap: 8px; min-height: 40px; margin-bottom: 12px; border: 1px dashed #ccc; padding: 10px;">
                                    <div style="color: #999; font-style: italic;">Nenhuma expectativa selecionada</div>
                                </div>
                                
                                <!-- Seletor -->
                                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                    <select id="selectExpectativa_${config.id}" style="flex: 1; padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                        <option value="">Selecione uma expectativa...</option>
                                    </select>
                                    <button onclick="window.expectativas_${configIdSafe}_adicionar()" style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                        â• Adicionar
                                    </button>
                                </div>
                                
                                <!-- Criar nova -->
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" id="novaExpectativa_${config.id}" placeholder="Ou digite uma nova..." style="flex: 1; padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;">
                                    <button onclick="window.expectativas_${configIdSafe}_criarNova()" style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                                        âœ¨ Criar Nova
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                },
                
                coletar(config) {
                    const configIdSafe = config.id.replace(/-/g, '_');
                    const dados = window['expectativas_' + configIdSafe + '_dados'] || [];
                    console.log('ğŸ“Š Coletando expectativas:', dados.length);
                    return {
                        expectativas: dados,
                        timestamp: new Date().toISOString()
                    };
                },
                
                carregar(config, dados) {
                    if (dados && dados.expectativas) {
                        console.log('ğŸ“¥ Carregando expectativas:', dados.expectativas.length);
                        const configIdSafe = config.id.replace(/-/g, '_');
                        window['expectativas_' + configIdSafe + '_dados'] = dados.expectativas;
                        // Renderizar depois que elementos existirem
                        setTimeout(() => {
                            if (window['expectativas_' + configIdSafe + '_renderizar']) {
                                window['expectativas_' + configIdSafe + '_renderizar']();
                            }
                        }, 100);
                    }
                }
            },
            
            'alergias': {
                render(config) {
                    console.log('ğŸ¨ Renderizando alergias:', config.id);
                    const configIdSafe = config.id.replace(/-/g, '_');
                    
                    return `
                        <div class="modulo-container" style="background: white; border: 1px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="margin: 0 0 15px 0; color: #333;">Alergias</h3>
                            
                            <div class="prontuario-form-grid" style="margin-bottom: 15px;">
                                <div class="prontuario-form-group">
                                    <label>Paciente possui alergias?</label>
                                    <select onchange="window.alergias_${configIdSafe}_toggle(this.value === 'sim')" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                        <option value="nao">NÃ£o</option>
                                        <option value="sim">Sim</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- BotÃ£o Adicionar (hidden por padrÃ£o) -->
                            <div id="btnAreaAlergias_${config.id}" style="display: none; margin-bottom: 15px;">
                                <button onclick="window.alergias_${configIdSafe}_adicionar()" style="padding: 10px 20px; background: #f44336; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; width: 100%;">
                                    Adicionar Alergia
                                </button>
                            </div>
                            
                            <div id="listaAlergias_${config.id}" style="display: block; width: 100%;"></div>
                        </div>
                    `;
                },
                
                coletar(config) {
                    const configIdSafe = config.id.replace(/-/g, '_');
                    const ids = window['alergias_' + configIdSafe + '_ids'] || [];
                    
                    // Pegar resposta do select
                    const select = document.querySelector(`#btnAreaAlergias_${config.id}`)?.parentElement?.querySelector('select');
                    const temAlergias = select?.value === 'sim' || false;
                    
                    const alergias = ids.map(id => {
                        const select = document.getElementById('selectAlergia_' + config.id + '_' + id);
                        const obs = document.getElementById('obsAlergia_' + config.id + '_' + id);
                        return {
                            id: id,
                            tipo: select?.value || "",
                            observacoes: obs?.value || ""
                        };
                    }).filter(a => a.tipo);
                    
                    console.log('ğŸ“Š Coletando alergias:', alergias.length, 'temAlergias:', temAlergias);
                    return {
                        temAlergias: temAlergias,
                        alergias: alergias,
                        timestamp: new Date().toISOString()
                    };
                },
                
                carregar(config, dados) {
                    if (dados) {
                        console.log('ğŸ“¥ Carregando alergias:', dados);
                        const configIdSafe = config.id.replace(/-/g, '_');
                        
                        setTimeout(() => {
                            // Restaurar radio sim/nÃ£o
                            if (dados.temAlergias !== undefined) {
                                const radioSim = document.querySelector(`input[name="temAlergias_${config.id}"][value="sim"]`);
                                const radioNao = document.querySelector(`input[name="temAlergias_${config.id}"][value="nao"]`);
                                
                                if (dados.temAlergias) {
                                    if (radioSim) radioSim.checked = true;
                                    window['alergias_' + configIdSafe + '_toggle'](true);
                                } else {
                                    if (radioNao) radioNao.checked = true;
                                    window['alergias_' + configIdSafe + '_toggle'](false);
                                }
                            }
                            
                            // Restaurar cards de alergias
                            if (dados.alergias && dados.alergias.length > 0) {
                                dados.alergias.forEach(alergia => {
                                    if (window['alergias_' + configIdSafe + '_adicionar']) {
                                        window['alergias_' + configIdSafe + '_adicionar']();
                                        const ids = window['alergias_' + configIdSafe + '_ids'] || [];
                                        const ultimoId = ids[ids.length - 1];
                                        const select = document.getElementById('selectAlergia_' + config.id + '_' + ultimoId);
                                        const obs = document.getElementById('obsAlergia_' + config.id + '_' + ultimoId);
                                        if (select) select.value = alergia.tipo;
                                        if (obs) obs.value = alergia.observacoes || "";
                                    }
                                });
                            }
                        }, 200);
                    }
                }
            },
            
            'doencas-previas': {
                render(config) {
                    console.log('ğŸ¨ Renderizando doenÃ§as:', config.id);
                    const configIdSafe = config.id.replace(/-/g, '_');
                    
                    return `
                        <div class="modulo-container" style="background: white; border: 1px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="margin: 0 0 15px 0; color: #333;">DoenÃ§as PrÃ©vias / Comorbidades</h3>
                            
                            <div class="prontuario-form-grid" style="margin-bottom: 15px;">
                                <div class="prontuario-form-group">
                                    <label>Paciente possui doenÃ§as prÃ©vias ou comorbidades?</label>
                                    <select onchange="window.doencas_${configIdSafe}_toggle(this.value === 'sim')" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                        <option value="nao">NÃ£o</option>
                                        <option value="sim">Sim</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- BotÃ£o Adicionar (hidden por padrÃ£o) -->
                            <div id="btnAreaDoencas_${config.id}" style="display: none; margin-bottom: 15px;">
                                <button onclick="window.doencas_${configIdSafe}_adicionar()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; width: 100%;">
                                    â• Adicionar DoenÃ§a
                                </button>
                            </div>
                            
                            <div id="listaDoencas_${config.id}" style="display: block; width: 100%;"></div>
                        </div>
                    `;
                },
                
                coletar(config) {
                    const configIdSafe = config.id.replace(/-/g, '_');
                    const ids = window['doencas_' + configIdSafe + '_ids'] || [];
                    
                    // Pegar resposta do select
                    const select = document.querySelector(`#btnAreaDoencas_${config.id}`)?.parentElement?.querySelector('select');
                    const temDoencas = select?.value === 'sim' || false;
                    
                    const doencas = ids.map(id => {
                        const select = document.getElementById('selectDoenca_' + config.id + '_' + id);
                        const obs = document.getElementById('obsDoenca_' + config.id + '_' + id);
                        return {
                            id: id,
                            tipo: select?.value || "",
                            observacoes: obs?.value || ""
                        };
                    }).filter(d => d.tipo);
                    
                    console.log('ğŸ“Š Coletando doenÃ§as:', doencas.length, 'temDoencas:', temDoencas);
                    return {
                        temDoencas: temDoencas,
                        doencas: doencas,
                        timestamp: new Date().toISOString()
                    };
                },
                
                carregar(config, dados) {
                    if (dados) {
                        console.log('ğŸ“¥ Carregando doenÃ§as:', dados);
                        const configIdSafe = config.id.replace(/-/g, '_');
                        
                        setTimeout(() => {
                            // Restaurar radio sim/nÃ£o
                            if (dados.temDoencas !== undefined) {
                                const radioSim = document.querySelector(`input[name="temDoencas_${config.id}"][value="sim"]`);
                                const radioNao = document.querySelector(`input[name="temDoencas_${config.id}"][value="nao"]`);
                                
                                if (dados.temDoencas) {
                                    if (radioSim) radioSim.checked = true;
                                    window['doencas_' + configIdSafe + '_toggle'](true);
                                } else {
                                    if (radioNao) radioNao.checked = true;
                                    window['doencas_' + configIdSafe + '_toggle'](false);
                                }
                            }
                            
                            // Restaurar cards de doenÃ§as
                            if (dados.doencas && dados.doencas.length > 0) {
                                dados.doencas.forEach(doenca => {
                                    if (window['doencas_' + configIdSafe + '_adicionar']) {
                                        window['doencas_' + configIdSafe + '_adicionar']();
                                        const ids = window['doencas_' + configIdSafe + '_ids'] || [];
                                        const ultimoId = ids[ids.length - 1];
                                        const select = document.getElementById('selectDoenca_' + config.id + '_' + ultimoId);
                                        const obs = document.getElementById('obsDoenca_' + config.id + '_' + ultimoId);
                                        if (select) select.value = doenca.tipo;
                                        if (obs) obs.value = doenca.observacoes || "";
                                    }
                                });
                            }
                        }, 200);
                    }
                }
            },
            
            'cirurgias-previas': {
                render(config) {
                    console.log('ğŸ¨ Renderizando cirurgias prÃ©vias:', config.id);
                    const configIdSafe = config.id.replace(/-/g, '_');
                    
                    return `
                        <div class="modulo-container" style="background: white; border: 1px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="margin: 0 0 15px 0; color: #333;">Cirurgias PrÃ©vias</h3>
                            
                            <div class="prontuario-form-grid" style="margin-bottom: 15px;">
                                <div class="prontuario-form-group">
                                    <label>Paciente jÃ¡ foi submetido a cirurgias?</label>
                                    <select onchange="window.cirurgias_${configIdSafe}_toggle(this.value === 'sim')" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                        <option value="nao">NÃ£o</option>
                                        <option value="sim">Sim</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- BotÃ£o Adicionar (hidden por padrÃ£o) -->
                            <div id="btnAreaCirurgias_${config.id}" style="display: none; margin-bottom: 15px;">
                                <button onclick="window.cirurgias_${configIdSafe}_adicionar()" style="padding: 10px 20px; background: #9c27b0; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; width: 100%;">
                                    Adicionar Cirurgia
                                </button>
                            </div>
                            
                            <div id="listaCirurgias_${config.id}" style="display: block; width: 100%;"></div>
                        </div>
                    `;
                },
                
                coletar(config) {
                    const configIdSafe = config.id.replace(/-/g, '_');
                    const ids = window['cirurgias_' + configIdSafe + '_ids'] || [];
                    
                    // Pegar resposta do select
                    const select = document.querySelector(`#btnAreaCirurgias_${config.id}`)?.parentElement?.querySelector('select');
                    const temCirurgias = select?.value === 'sim' || false;
                    
                    const cirurgias = ids.map(id => {
                        const select = document.getElementById('selectCirurgia_' + config.id + '_' + id);
                        const obs = document.getElementById('obsCirurgia_' + config.id + '_' + id);
                        return {
                            id: id,
                            tipo: select?.value || "",
                            observacoes: obs?.value || ""
                        };
                    }).filter(c => c.tipo);
                    
                    console.log('ğŸ“Š Coletando cirurgias:', cirurgias.length, 'temCirurgias:', temCirurgias);
                    return {
                        temCirurgias: temCirurgias,
                        cirurgias: cirurgias,
                        timestamp: new Date().toISOString()
                    };
                },
                
                carregar(config, dados) {
                    if (dados) {
                        console.log('ğŸ“¥ Carregando cirurgias:', dados);
                        const configIdSafe = config.id.replace(/-/g, '_');
                        
                        setTimeout(() => {
                            // Restaurar radio sim/nÃ£o
                            if (dados.temCirurgias !== undefined) {
                                const radioSim = document.querySelector(`input[name="temCirurgias_${config.id}"][value="sim"]`);
                                const radioNao = document.querySelector(`input[name="temCirurgias_${config.id}"][value="nao"]`);
                                
                                if (dados.temCirurgias) {
                                    if (radioSim) radioSim.checked = true;
                                    window['cirurgias_' + configIdSafe + '_toggle'](true);
                                } else {
                                    if (radioNao) radioNao.checked = true;
                                    window['cirurgias_' + configIdSafe + '_toggle'](false);
                                }
                            }
                            
                            // Restaurar cards de cirurgias
                            if (dados.cirurgias && dados.cirurgias.length > 0) {
                                dados.cirurgias.forEach(cirurgia => {
                                    if (window['cirurgias_' + configIdSafe + '_adicionar']) {
                                        window['cirurgias_' + configIdSafe + '_adicionar']();
                                        const ids = window['cirurgias_' + configIdSafe + '_ids'] || [];
                                        const ultimoId = ids[ids.length - 1];
                                        const select = document.getElementById('selectCirurgia_' + config.id + '_' + ultimoId);
                                        const obs = document.getElementById('obsCirurgia_' + config.id + '_' + ultimoId);
                                        if (select) select.value = cirurgia.tipo;
                                        if (obs) obs.value = cirurgia.observacoes || "";
                                    }
                                });
                            }
                        }, 200);
                    }
                }
            },
            
            'medicacoes-uso': {
                render(config) {
                    console.log('ğŸ¨ Renderizando medicaÃ§Ãµes de uso:', config.id);
                    const configIdSafe = config.id.replace(/-/g, '_');
                    
                    return `
                        <div class="modulo-container" style="background: white; border: 1px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                            <h3 style="margin: 0 0 15px 0; color: #333;">MedicaÃ§Ãµes em Uso</h3>
                            
                            <div class="prontuario-form-grid" style="margin-bottom: 15px;">
                                <div class="prontuario-form-group">
                                    <label>Paciente faz uso de medicaÃ§Ãµes contÃ­nuas?</label>
                                    <select onchange="window.medicacoes_${configIdSafe}_toggle(this.value === 'sim')" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                        <option value="nao">NÃ£o</option>
                                        <option value="sim">Sim</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- BotÃ£o Adicionar (hidden por padrÃ£o) -->
                            <div id="btnAreaMedicacoes_${config.id}" style="display: none; margin-bottom: 15px;">
                                <button onclick="window.medicacoes_${configIdSafe}_adicionar()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; width: 100%;">
                                    Adicionar MedicaÃ§Ã£o
                                </button>
                            </div>
                            
                            <div id="listaMedicacoes_${config.id}" style="display: block; width: 100%;"></div>
                        </div>
                    `;
                },
                
                coletar(config) {
                    const configIdSafe = config.id.replace(/-/g, '_');
                    const ids = window['medicacoes_' + configIdSafe + '_ids'] || [];
                    
                    // Pegar resposta do select
                    const select = document.querySelector(`#btnAreaMedicacoes_${config.id}`)?.parentElement?.querySelector('select');
                    const temMedicacoes = select?.value === 'sim' || false;
                    
                    const medicacoes = ids.map(id => {
                        const select = document.getElementById('selectMedicacao_' + config.id + '_' + id);
                        const obs = document.getElementById('obsMedicacao_' + config.id + '_' + id);
                        return {
                            id: id,
                            tipo: select?.value || "",
                            observacoes: obs?.value || ""
                        };
                    }).filter(m => m.tipo);
                    
                    console.log('ğŸ“Š Coletando medicaÃ§Ãµes:', medicacoes.length, 'temMedicacoes:', temMedicacoes);
                    return {
                        temMedicacoes: temMedicacoes,
                        medicacoes: medicacoes,
                        timestamp: new Date().toISOString()
                    };
                },
                
                carregar(config, dados) {
                    if (dados) {
                        console.log('ğŸ“¥ Carregando medicaÃ§Ãµes:', dados);
                        const configIdSafe = config.id.replace(/-/g, '_');
                        
                        setTimeout(() => {
                            // Restaurar radio sim/nÃ£o
                            if (dados.temMedicacoes !== undefined) {
                                const radioSim = document.querySelector(`input[name="temMedicacoes_${config.id}"][value="sim"]`);
                                const radioNao = document.querySelector(`input[name="temMedicacoes_${config.id}"][value="nao"]`);
                                
                                if (dados.temMedicacoes) {
                                    if (radioSim) radioSim.checked = true;
                                    window['medicacoes_' + configIdSafe + '_toggle'](true);
                                } else {
                                    if (radioNao) radioNao.checked = true;
                                    window['medicacoes_' + configIdSafe + '_toggle'](false);
                                }
                            }
                            
                            // Restaurar cards de medicaÃ§Ãµes
                            if (dados.medicacoes && dados.medicacoes.length > 0) {
                                dados.medicacoes.forEach(medicacao => {
                                    if (window['medicacoes_' + configIdSafe + '_adicionar']) {
                                        window['medicacoes_' + configIdSafe + '_adicionar']();
                                        const ids = window['medicacoes_' + configIdSafe + '_ids'] || [];
                                        const ultimoId = ids[ids.length - 1];
                                        const select = document.getElementById('selectMedicacao_' + config.id + '_' + ultimoId);
                                        const obs = document.getElementById('obsMedicacao_' + config.id + '_' + ultimoId);
                                        if (select) select.value = medicacao.tipo;
                                        if (obs) obs.value = medicacao.observacoes || "";
                                    }
                                });
                            }
                        }, 200);
                    }
                }
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // v10.446: FUNÃ‡Ã•ES DE LOGÃSTICA HOSPITALAR
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            // Buscar entrada ativa de um paciente (Ãºltima nÃ£o finalizada)
            buscarEntradaAtiva(pacienteId) {
                const entradas = SistemaCore.dados.entradas || [];
                return entradas.find(e => 
                    e.paciente_id === pacienteId && 
                    e.status !== 'finalizado'
                );
            },
            
            // Buscar todas as entradas de um paciente
            buscarEntradasPaciente(pacienteId) {
                const entradas = SistemaCore.dados.entradas || [];
                return entradas
                    .filter(e => e.paciente_id === pacienteId)
                    .sort((a, b) => new Date(b.data_cadastro) - new Date(a.data_cadastro));
            },
            
            // v10.446: Vincular internaÃ§Ã£o a uma entrada existente
            vincularInternacao(entradaId, dadosInternacao) {
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    console.error('âŒ Entrada nÃ£o encontrada:', entradaId);
                    return false;
                }
                
                // Atualizar dados de internaÃ§Ã£o na entrada
                entrada.internacao = {
                    leito_id: dadosInternacao.leito_id,
                    leito_nome: dadosInternacao.leito_nome,
                    setor: dadosInternacao.setor || '',
                    data_hora_entrada: dadosInternacao.data_hora || new Date().toISOString(),
                    data_hora_saida: null,
                    motivo: dadosInternacao.motivo || '',
                    medico_responsavel_id: dadosInternacao.medico_id,
                    medico_responsavel_nome: dadosInternacao.medico_nome || ''
                };
                
                entrada.status = 'internado';
                entrada.destino_atual = dadosInternacao.leito_nome;
                entrada.ultima_atualizacao = new Date().toISOString();
                
                SistemaCore.salvar();
                console.log('âœ… InternaÃ§Ã£o vinculada Ã  entrada:', entradaId);
                return true;
            },
            
            // v10.446: Registrar cirurgia em uma entrada
            registrarCirurgia(entradaId, dadosCirurgia) {
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    console.error('âŒ Entrada nÃ£o encontrada:', entradaId);
                    return false;
                }
                
                // Inicializar array se necessÃ¡rio
                if (!entrada.cirurgias) entrada.cirurgias = [];
                
                // Gerar ID da cirurgia
                const cirurgiaId = entrada.cirurgias.length > 0 
                    ? Math.max(...entrada.cirurgias.map(c => c.id)) + 1 
                    : 1;
                
                const cirurgia = {
                    id: cirurgiaId,
                    data_hora: dadosCirurgia.data_hora || new Date().toISOString(),
                    procedimento: dadosCirurgia.procedimento,
                    cirurgiao_id: dadosCirurgia.cirurgiao_id,
                    cirurgiao_nome: dadosCirurgia.cirurgiao_nome || '',
                    anestesista_id: dadosCirurgia.anestesista_id || null,
                    anestesista_nome: dadosCirurgia.anestesista_nome || '',
                    tipo: dadosCirurgia.tipo || 'eletiva',  // eletiva ou emergencia
                    sala: dadosCirurgia.sala || '',
                    duracao_minutos: dadosCirurgia.duracao_minutos || null,
                    intercorrencias: dadosCirurgia.intercorrencias || 'Sem intercorrÃªncias',
                    status: dadosCirurgia.status || 'realizada'
                };
                
                entrada.cirurgias.push(cirurgia);
                entrada.ultima_atualizacao = new Date().toISOString();
                
                // Atualizar status se estava em cirurgia
                if (entrada.status === 'em_cirurgia' && cirurgia.status === 'realizada') {
                    entrada.status = entrada.internacao ? 'internado' : 'aguardando_alta';
                }
                
                SistemaCore.salvar();
                console.log('âœ… Cirurgia registrada na entrada:', entradaId, cirurgia);
                return true;
            },
            
            // v10.446: Registrar alta do paciente
            registrarAlta(entradaId, dadosAlta) {
                const entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                if (!entrada) {
                    console.error('âŒ Entrada nÃ£o encontrada:', entradaId);
                    return false;
                }
                
                // Registrar dados da alta
                entrada.alta = {
                    data_hora: dadosAlta.data_hora || new Date().toISOString(),
                    medico_id: dadosAlta.medico_id,
                    medico_nome: dadosAlta.medico_nome || '',
                    tipo: dadosAlta.tipo || 'alta',  // alta, obito, transferencia, evasao
                    destino: dadosAlta.destino || 'domicilio',
                    sumario: dadosAlta.sumario || '',
                    cid_principal: dadosAlta.cid_principal || '',
                    cid_secundarios: dadosAlta.cid_secundarios || [],
                    prescricoes: dadosAlta.prescricoes || '',
                    orientacoes: dadosAlta.orientacoes || '',
                    retorno: dadosAlta.retorno || null,
                    atestado_dias: dadosAlta.atestado_dias || null
                };
                
                // Fechar internaÃ§Ã£o se existir
                if (entrada.internacao && !entrada.internacao.data_hora_saida) {
                    entrada.internacao.data_hora_saida = entrada.alta.data_hora;
                    
                    // Liberar leito
                    if (entrada.internacao.leito_id) {
                        const leito = SistemaCore.dados.reparticoes.find(r => r.id === entrada.internacao.leito_id);
                        if (leito && leito.status === 'ocupado' && leito.paciente_id === entrada.paciente_id) {
                            leito.status = 'livre';
                            leito.paciente_id = null;
                            leito.data_ocupacao = null;
                            leito.motivo_internacao = null;
                            leito.profissional_internacao_id = null;
                            console.log('âœ… Leito liberado:', leito.nome);
                        }
                    }
                }
                
                // Atualizar data/hora de saÃ­da
                entrada.data_hora_saida = entrada.alta.data_hora;
                entrada.status = 'finalizado';
                entrada.destino_atual = 'alta';
                entrada.ultima_atualizacao = new Date().toISOString();
                
                SistemaCore.salvar();
                
                Sistema.notificar(`âœ… Alta registrada! Entrada ${entrada.numero} finalizada`, 'success');
                console.log('âœ… Alta registrada na entrada:', entradaId);
                return true;
            },
            
            // v10.446: Obter resumo do histÃ³rico de entradas do paciente
            obterHistoricoEntradas(pacienteId) {
                const entradas = this.buscarEntradasPaciente(pacienteId);
                
                return {
                    total: entradas.length,
                    ultima: entradas[0] || null,
                    ativa: entradas.find(e => e.status !== 'finalizado'),
                    porTipo: {
                        consultas: entradas.filter(e => e.tipo === 'consulta').length,
                        emergencias: entradas.filter(e => e.tipo === 'emergencia' || e.tipo === 'urgencia').length,
                        internacoes: entradas.filter(e => e.internacao !== null).length,
                        cirurgias: entradas.reduce((total, e) => total + (e.cirurgias?.length || 0), 0)
                    },
                    entradas: entradas
                };
            },
            
            // v10.446: EstatÃ­sticas do dia (para dashboard)
            obterEstatisticasDia(data = null) {
                const dataFiltro = data || new Date().toISOString().split('T')[0];
                const entradas = SistemaCore.dados.entradas || [];
                const entradasDia = entradas.filter(e => e.data_entrada === dataFiltro);
                
                return {
                    data: dataFiltro,
                    total: entradasDia.length,
                    aguardando_triagem: entradasDia.filter(e => e.status === 'aguardando_triagem').length,
                    aguardando_atendimento: entradasDia.filter(e => e.status === 'aguardando_atendimento').length,
                    em_atendimento: entradasDia.filter(e => e.status === 'em_atendimento').length,
                    internados: entradasDia.filter(e => e.status === 'internado').length,
                    finalizados: entradasDia.filter(e => e.status === 'finalizado').length,
                    porTipo: {
                        consulta: entradasDia.filter(e => e.tipo === 'consulta').length,
                        retorno: entradasDia.filter(e => e.tipo === 'retorno').length,
                        emergencia: entradasDia.filter(e => e.tipo === 'emergencia' || e.tipo === 'urgencia').length,
                        exame: entradasDia.filter(e => e.tipo === 'exame').length,
                        procedimento: entradasDia.filter(e => e.tipo === 'procedimento').length,
                        cirurgia: entradasDia.filter(e => e.tipo === 'cirurgia_eletiva').length,
                        internacao: entradasDia.filter(e => e.tipo === 'internacao').length
                    },
                    triagem: {
                        vermelho: entradasDia.filter(e => e.triagem?.manchester?.prioridade === 'vermelho').length,
                        laranja: entradasDia.filter(e => e.triagem?.manchester?.prioridade === 'laranja').length,
                        amarelo: entradasDia.filter(e => e.triagem?.manchester?.prioridade === 'amarelo').length,
                        verde: entradasDia.filter(e => e.triagem?.manchester?.prioridade === 'verde').length,
                        azul: entradasDia.filter(e => e.triagem?.manchester?.prioridade === 'azul').length
                    }
                };
            }
        };
        

        /* ============================================================
           [PRONTUARIOS] MÃ³dulo de GestÃ£o e Consulta de ProntuÃ¡rios
           ============================================================ */
        
        const Prontuarios = {
            init() {
                this.popularFiltros();
                this.atualizarEstatisticas();
            },

            popularFiltros() {
                const selectProf = document.getElementById('filtro-profissional-prontuario');
                const profissionais = SistemaCore.dados.profissionais;
                
                let html = '<option value="">Todos</option>';
                profissionais.forEach(prof => {
                    html += `<option value="${prof.id}">${prof.nome}</option>`;
                });
                selectProf.innerHTML = html;
            },

            atualizarEstatisticas() {
                const atendimentos = SistemaCore.dados.atendimentos;
                const hoje = new Date();
                const inicioDia = new Date(hoje.getFullYear(), hoje.getMonth(), hoje.getDate());
                const inicioSemana = new Date(hoje);
                inicioSemana.setDate(hoje.getDate() - hoje.getDay());
                inicioSemana.setHours(0, 0, 0, 0);
                const inicioMes = new Date(hoje.getFullYear(), hoje.getMonth(), 1);

                // Total
                document.getElementById('stat-total-prontuarios').textContent = atendimentos.length;

                // Hoje
                const hoje_count = atendimentos.filter(a => {
                    const dataAtend = new Date(a.data_atendimento);
                    return dataAtend >= inicioDia;
                }).length;
                document.getElementById('stat-prontuarios-hoje').textContent = hoje_count;

                // Semana
                const semana_count = atendimentos.filter(a => {
                    const dataAtend = new Date(a.data_atendimento);
                    return dataAtend >= inicioSemana;
                }).length;
                document.getElementById('stat-prontuarios-semana').textContent = semana_count;

                // MÃªs
                const mes_count = atendimentos.filter(a => {
                    const dataAtend = new Date(a.data_atendimento);
                    return dataAtend >= inicioMes;
                }).length;
                document.getElementById('stat-prontuarios-mes').textContent = mes_count;
            },

            listar() {
                const container = document.getElementById('listaProntuarios');
                const busca = document.getElementById('filtro-busca-prontuario').value.toLowerCase();
                const filtroProfissional = parseInt(document.getElementById('filtro-profissional-prontuario').value);
                const dataInicial = document.getElementById('filtro-data-inicial-prontuario').value;
                const dataFinal = document.getElementById('filtro-data-final-prontuario').value;

                let atendimentos = SistemaCore.dados.atendimentos;
                const pacientes = SistemaCore.dados.pacientes;
                const profissionais = SistemaCore.dados.profissionais;
                const agendamentos = SistemaCore.dados.agendamentos;

                // Aplicar filtros
                atendimentos = atendimentos.filter(a => {
                    // Filtro de busca por nome do paciente
                    if (busca) {
                        const paciente = pacientes.find(p => p.id === a.paciente_id);
                        if (!paciente || !paciente.nome.toLowerCase().includes(busca)) {
                            return false;
                        }
                    }

                    // Filtro por profissional
                    if (filtroProfissional && a.profissional_id !== filtroProfissional) {
                        return false;
                    }

                    // Filtro por data
                    const dataAtendimento = new Date(a.data_atendimento).toISOString().split('T')[0];
                    if (dataInicial && dataAtendimento < dataInicial) {
                        return false;
                    }
                    if (dataFinal && dataAtendimento > dataFinal) {
                        return false;
                    }

                    return true;
                });

                // Ordenar por data (mais recentes primeiro)
                atendimentos = atendimentos.sort((a, b) => {
                    return new Date(b.data_atendimento) - new Date(a.data_atendimento);
                });

                if (atendimentos.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: var(--text-light);">
                            <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“</div>
                            <p style="font-size: 18px; margin-bottom: 8px;">Nenhum prontuÃ¡rio encontrado</p>
                            <p>Ajuste os filtros ou realize atendimentos para gerar prontuÃ¡rios</p>
                        </div>
                    `;
                    return;
                }

                let html = '';
                atendimentos.forEach(atend => {
                    const paciente = pacientes.find(p => p.id === atend.paciente_id);
                    const profissional = profissionais.find(p => p.id === atend.profissional_id);
                    const agendamento = agendamentos.find(ag => ag.id === atend.agendamento_id);
                    
                    const dataAtendimento = new Date(atend.data_atendimento);
                    const dataFormatada = dataAtendimento.toLocaleDateString('pt-BR');
                    const horaFormatada = dataAtendimento.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });

                    // Calcular idade
                    let idadePaciente = '';
                    if (paciente && paciente.nascimento) {
                        const idade = Pacientes.calcularIdade(paciente.nascimento);
                        idadePaciente = `<span class="idade-display">${idade} anos</span>`;
                    }

                    html += `
                        <div class="agendamento-item" style="border-left-color: #10b981;">
                            <div class="agendamento-info">
                                <strong>${paciente ? paciente.nome : 'Paciente nÃ£o encontrado'} ${idadePaciente}</strong>
                                <small>
                                    ${profissional ? `ğŸ‘¨â€âš•ï¸ ${profissional.nome}` : 'Profissional nÃ£o encontrado'}<br>
                                    ğŸ“… ${dataFormatada} Ã s ${horaFormatada}
                                    ${atend.diagnostico ? `<br>ğŸ¯ ${atend.diagnostico.substring(0, 50)}${atend.diagnostico.length > 50 ? '...' : ''}` : ''}
                                </small>
                                <div style="margin-top: 8px;">
                                    <span class="badge badge-success">ProntuÃ¡rio Completo</span>
                                </div>
                            </div>
                            <div class="agendamento-actions">
                                <button class="btn btn-info" onclick="Prontuarios.visualizar(${atend.agendamento_id})" title="Visualizar prontuÃ¡rio">
                                    ğŸ‘ï¸ Visualizar
                                </button>
                                <button class="btn btn-primary" onclick="Prontuarios.editar(${atend.agendamento_id})" title="Editar prontuÃ¡rio">
                                    âœï¸ Editar
                                </button>
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            },

            visualizar(agendamentoId) {
                Prontuario.abrir(agendamentoId, true);
            },

            editar(agendamentoId) {
                Prontuario.abrir(agendamentoId, false);
            }
        };

        /* ============================================================
           [HISTORICO] MÃ³dulo HistÃ³rico
           ============================================================ */
        
        const Historico = {
            init() {
                const select = document.getElementById('select-paciente-historico');
                select.innerHTML = '<option value="">Selecione um paciente...</option>';
                
                SistemaCore.dados.pacientes.forEach(pac => {
                    select.innerHTML += `<option value="${pac.id}">${pac.nome}</option>`;
                });
            },

            carregar() {
                const pacienteId = parseInt(document.getElementById('select-paciente-historico').value);
                if (!pacienteId) {
                    document.getElementById('historicoTimeline').innerHTML = '<p style="color: var(--text-light);">Selecione um paciente para ver o histÃ³rico.</p>';
                    return;
                }

                const atendimentos = SistemaCore.dados.atendimentos
                    .filter(at => at.paciente_id === pacienteId)
                    .sort((a, b) => new Date(b.data_atendimento) - new Date(a.data_atendimento));

                if (atendimentos.length === 0) {
                    document.getElementById('historicoTimeline').innerHTML = '<p style="color: var(--text-light);">Nenhum atendimento registrado para este paciente.</p>';
                    return;
                }

                let html = '<div class="timeline">';
                atendimentos.forEach(at => {
                    const data = new Date(at.data_atendimento);
                    const profissional = SistemaCore.dados.profissionais.find(p => p.id === at.profissional_id);
                    
                    html += `
                        <div class="timeline-item">
                            <div class="timeline-marker"></div>
                            <div class="timeline-content">
                                <div class="timeline-header">
                                    <strong>${data.toLocaleDateString('pt-BR')} ${data.toLocaleTimeString('pt-BR')}</strong>
                                    <span class="badge badge-success">Atendimento</span>
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <strong>Profissional:</strong> Dr(a). ${profissional ? profissional.nome : 'NÃ£o encontrado'}
                                </div>
                                ${at.queixa ? `<div><strong>Queixa:</strong> ${at.queixa}</div>` : ''}
                                ${at.diagnostico ? `<div><strong>DiagnÃ³stico:</strong> ${at.diagnostico}</div>` : ''}
                                ${at.conduta ? `<div style="margin-top: 8px;"><strong>Conduta:</strong> ${at.conduta}</div>` : ''}
                                <button class="btn btn-info" style="margin-top: 12px;" onclick="Historico.verDetalhes(${at.id})">
                                    ğŸ‘ï¸ Detalhes Completos
                                </button>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';

                document.getElementById('historicoTimeline').innerHTML = html;
            },

            verDetalhes(atendimentoId) {
                const atendimento = SistemaCore.dados.atendimentos.find(at => at.id === atendimentoId);
                if (!atendimento) return;

                Prontuario.abrir(atendimento.agendamento_id, true);
            }
        };

        /* ============================================================
           [COLETA DE DADOS] Sistema de Coleta de Dados
           ============================================================ */
        
        const ColetaDados = {
            renderizar() {
                this.listarCampos();
                this.renderizarFormulario();
                this.listarDados();
            },

            listarCampos() {
                const container = document.getElementById('listaCamposColeta');
                const campos = SistemaCore.dados.campos_coleta;

                if (campos.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light); font-size: 13px;">Nenhum campo configurado.</p>';
                    return;
                }

                let html = '';
                campos.forEach(campo => {
                    const tipoLabel = {
                        'texto': 'ğŸ“ Texto',
                        'numero': 'ğŸ”¢ NÃºmero',
                        'data': 'ğŸ“… Data',
                        'email': 'ğŸ“§ E-mail',
                        'telefone': 'ğŸ“ Telefone',
                        'cpf': 'ğŸ†” CPF',
                        'textarea': 'ğŸ“„ Texto Longo',
                        'select': 'ğŸ“‹ Lista'
                    }[campo.tipo] || 'ğŸ“';

                    html += `
                        <div class="campo-coleta">
                            <div>
                                <div class="campo-coleta-nome">${campo.nome}</div>
                                <span class="campo-coleta-tipo">${tipoLabel}</span>
                                ${campo.obrigatorio ? '<span class="badge badge-danger" style="margin-left: 4px; font-size: 10px;">ObrigatÃ³rio</span>' : ''}
                            </div>
                            <div style="display: flex; gap: 4px;">
                                <button class="btn btn-icon btn-primary" onclick="ColetaDados.editarCampo(${campo.id})">âœï¸</button>
                                <button class="btn btn-icon btn-danger" onclick="ColetaDados.excluirCampo(${campo.id})">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
            },

            renderizarFormulario() {
                const container = document.getElementById('formularioColeta');
                const campos = SistemaCore.dados.campos_coleta;

                if (campos.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light);">Configure os campos ao lado para comeÃ§ar a coletar dados.</p>';
                    document.getElementById('btnSalvarColeta').disabled = true;
                    return;
                }

                let html = '<div style="display: grid; gap: 12px;">';
                campos.forEach(campo => {
                    html += `<div class="form-group" style="margin-bottom: 0;">`;
                    html += `<label>${campo.nome}${campo.obrigatorio ? ' <span style="color: var(--danger);">*</span>' : ''}</label>`;
                    
                    switch (campo.tipo) {
                        case 'textarea':
                            html += `<textarea class="form-control" id="campo-data-${campo.id}" ${campo.obrigatorio ? 'required' : ''}></textarea>`;
                            break;
                        case 'select':
                            html += `<select class="form-control" id="campo-data-${campo.id}" ${campo.obrigatorio ? 'required' : ''}>`;
                            html += '<option value="">Selecione...</option>';
                            if (campo.opcoes) {
                                campo.opcoes.split(',').forEach(op => {
                                    html += `<option value="${op.trim()}">${op.trim()}</option>`;
                                });
                            }
                            html += '</select>';
                            break;
                        default:
                            const inputType = {
                                'numero': 'number',
                                'data': 'date',
                                'email': 'email',
                                'telefone': 'tel'
                            }[campo.tipo] || 'text';
                            html += `<input type="${inputType}" class="form-control" id="campo-data-${campo.id}" ${campo.obrigatorio ? 'required' : ''}>`;
                    }
                    
                    html += '</div>';
                });
                html += '</div>';

                container.innerHTML = html;
                document.getElementById('btnSalvarColeta').disabled = false;
            },

            salvarDados() {
                const campos = SistemaCore.dados.campos_coleta;
                const dados = {};
                let valido = true;

                campos.forEach(campo => {
                    const elemento = document.getElementById(`campo-data-${campo.id}`);
                    const valor = elemento.value.trim();

                    if (campo.obrigatorio && !valor) {
                        Sistema.notificar(`O campo "${campo.nome}" Ã© obrigatÃ³rio!`, 'error');
                        valido = false;
                        return;
                    }

                    dados[campo.nome] = valor;
                });

                if (!valido) return;

                SistemaCore.dados.dados_coletados.push({
                    id: SistemaCore.proximoId(SistemaCore.dados.dados_coletados),
                    data_coleta: new Date().toISOString(),
                    dados: dados
                });

                SistemaCore.salvar();
                
                // Limpar formulÃ¡rio
                campos.forEach(campo => {
                    document.getElementById(`campo-data-${campo.id}`).value = '';
                });

                this.listarDados();
                Sistema.notificar('Dados coletados com sucesso!');
                Sistema.atualizarDashboard();
            },

            listarDados() {
                const container = document.getElementById('listaDadosColetados');
                const dados = SistemaCore.dados.dados_coletados;

                if (dados.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light);">Nenhum dado coletado ainda.</p>';
                    return;
                }

                let html = '<table class="dados-coletados-table"><thead><tr>';
                
                html += '<th>#</th>';
                html += '<th>Data/Hora</th>';
                const campos = SistemaCore.dados.campos_coleta;
                campos.forEach(campo => {
                    html += `<th>${campo.nome}</th>`;
                });
                html += '<th>AÃ§Ãµes</th>';
                html += '</tr></thead><tbody>';

                dados.slice().reverse().forEach((item, index) => {
                    const dataColeta = new Date(item.data_coleta);
                    html += '<tr>';
                    html += `<td>${dados.length - index}</td>`;
                    html += `<td>${dataColeta.toLocaleString('pt-BR')}</td>`;
                    
                    campos.forEach(campo => {
                        html += `<td>${item.dados[campo.nome] || '-'}</td>`;
                    });
                    
                    html += `<td><button class="btn btn-icon btn-danger" onclick="ColetaDados.excluirDado(${item.id})">ğŸ—‘ï¸</button></td>`;
                    html += '</tr>';
                });

                html += '</tbody></table>';
                container.innerHTML = html;
            },

            abrirModalCampo(id = null) {
                document.getElementById('campo-tipo').addEventListener('change', function() {
                    const opcoesGroup = document.getElementById('campo-opcoes-group');
                    opcoesGroup.style.display = this.value === 'select' ? 'block' : 'none';
                });

                if (id) {
                    const campo = SistemaCore.dados.campos_coleta.find(c => c.id === id);
                    if (!campo) return;
                    document.getElementById('tituloModalCampoColeta').textContent = 'âœï¸ Editar Campo';
                    document.getElementById('edit-campo-id').value = campo.id;
                    document.getElementById('campo-nome').value = campo.nome;
                    document.getElementById('campo-tipo').value = campo.tipo;
                    document.getElementById('campo-opcoes').value = campo.opcoes || '';
                    document.getElementById('campo-obrigatorio').checked = campo.obrigatorio;
                    document.getElementById('campo-opcoes-group').style.display = campo.tipo === 'select' ? 'block' : 'none';
                } else {
                    document.getElementById('tituloModalCampoColeta').textContent = 'â• Novo Campo';
                    document.getElementById('edit-campo-id').value = '';
                    document.getElementById('campo-nome').value = '';
                    document.getElementById('campo-tipo').value = 'texto';
                    document.getElementById('campo-opcoes').value = '';
                    document.getElementById('campo-obrigatorio').checked = false;
                    document.getElementById('campo-opcoes-group').style.display = 'none';
                }

                document.getElementById('modalCampoColeta').classList.add('active');
            },

            fecharModalCampo() {
                document.getElementById('modalCampoColeta').classList.remove('active');
            },

            salvarCampo() {
                const nome = document.getElementById('campo-nome').value.trim();
                const tipo = document.getElementById('campo-tipo').value;
                const opcoes = document.getElementById('campo-opcoes').value.trim();
                const obrigatorio = document.getElementById('campo-obrigatorio').checked;
                const editId = document.getElementById('edit-campo-id').value;

                if (!nome) {
                    Sistema.notificar('Preencha o nome do campo!', 'error');
                    return;
                }

                if (tipo === 'select' && !opcoes) {
                    Sistema.notificar('Preencha as opÃ§Ãµes para o campo de lista!', 'error');
                    return;
                }

                if (editId) {
                    const campo = SistemaCore.dados.campos_coleta.find(c => c.id === parseInt(editId));
                    if (campo) {
                        campo.nome = nome;
                        campo.tipo = tipo;
                        campo.opcoes = opcoes;
                        campo.obrigatorio = obrigatorio;
                    }
                } else {
                    SistemaCore.dados.campos_coleta.push({
                        id: SistemaCore.proximoId(SistemaCore.dados.campos_coleta),
                        nome,
                        tipo,
                        opcoes,
                        obrigatorio
                    });
                }

                SistemaCore.salvar();
                this.renderizar();
                this.fecharModalCampo();
                Sistema.notificar('Campo salvo!');
            },

            editarCampo(id) {
                this.abrirModalCampo(id);
            },

            excluirCampo(id) {
                if (!confirm('Deseja excluir este campo? Os dados jÃ¡ coletados NÃƒO serÃ£o perdidos.')) return;
                SistemaCore.dados.campos_coleta = SistemaCore.dados.campos_coleta.filter(c => c.id !== id);
                SistemaCore.salvar();
                this.renderizar();
                Sistema.notificar('Campo excluÃ­do!');
            },

            excluirDado(id) {
                if (!confirm('Deseja excluir este registro?')) return;
                SistemaCore.dados.dados_coletados = SistemaCore.dados.dados_coletados.filter(d => d.id !== id);
                SistemaCore.salvar();
                this.listarDados();
                Sistema.notificar('Registro excluÃ­do!');
                Sistema.atualizarDashboard();
            },

            exportarCSV() {
                const dados = SistemaCore.dados.dados_coletados;
                if (dados.length === 0) {
                    Sistema.notificar('Nenhum dado para exportar!', 'error');
                    return;
                }

                const campos = SistemaCore.dados.campos_coleta;
                
                let csv = 'ID;Data/Hora;';
                csv += campos.map(c => c.nome).join(';') + '\n';

                dados.forEach(item => {
                    const dataColeta = new Date(item.data_coleta).toLocaleString('pt-BR');
                    csv += `${item.id};${dataColeta};`;
                    csv += campos.map(c => item.dados[c.nome] || '').join(';') + '\n';
                });

                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `dados_coletados_${new Date().toISOString().split('T')[0]}.csv`;
                a.click();

                Sistema.notificar('Dados exportados com sucesso!');
            }
        };

        /* ============================================================
           [CALENDARIO] MÃ³dulo CalendÃ¡rio Visual
           ============================================================ */
        
        const Calendario = {
            mesAtual: new Date().getMonth(),
            anoAtual: new Date().getFullYear(),
            tipoSelecionado: 'todos', // v8.0.16: Inicializar filtro
            diaSelecionado: new Date().toISOString().split('T')[0], // v10.5.4: Dia selecionado
            
            init() {
                // Inicializar array de agendamentos se nÃ£o existir
                if (!SistemaCore.dados.agendamentos) {
                    SistemaCore.dados.agendamentos = [];
                }
                
                // v10.99: ESCUTAR EVENTO de paciente salvo para atualizar calendÃ¡rio
                window.addEventListener('pacienteSalvo', (e) => {
                    console.log('âœ… [CALENDÃRIO] Evento pacienteSalvo recebido:', e.detail);
                    // Verificar se a Agenda estÃ¡ ativa
                    const agendaAtiva = document.getElementById('telaAgenda')?.classList.contains('active');
                    if (agendaAtiva) {
                        console.log('âœ… [CALENDÃRIO] Recarregando apÃ³s salvar paciente...');
                        setTimeout(() => this.renderizar(), 150);
                    }
                });
                
                // v10.106: ESCUTAR EVENTO de paciente salvo para atualizar MODAL DE AGENDAMENTO
                // v10.107: + ATUALIZAR LISTA DE AGENDAMENTOS (botÃ£o Completar Cadastro â†’ Atender)
                window.addEventListener('pacienteSalvo', (e) => {
                    console.log('âœ… [AGENDAMENTO] Evento pacienteSalvo recebido:', e.detail);
                    
                    // Verificar se a Agenda estÃ¡ ativa
                    const agendaAtiva = document.getElementById('telaAgenda')?.classList.contains('active');
                    
                    // v10.108: CORREÃ‡ÃƒO - ATUALIZAR AGENDA SEMPRE que cadastro incompleto Ã© completado
                    // (nÃ£o importa qual aba estÃ¡ ativa, para quando voltar jÃ¡ estar atualizado)
                    if (e.detail.eraIncompleto) {
                        console.log('âœ… [AGENDA] Cadastro completado, atualizando agenda...');
                        // Recarregar dados primeiro
                        SistemaCore.carregar();
                        // Atualizar a lista lateral
                        if (typeof Agenda !== 'undefined' && Agenda.listar) {
                            setTimeout(() => {
                                Agenda.listar();
                                console.log('âœ… [AGENDA] Lista atualizada - botÃ£o mudou para Atender!');
                            }, 100);
                        }
                        // Atualizar calendÃ¡rio tambÃ©m
                        if (typeof Calendario !== 'undefined' && Calendario.renderizar) {
                            setTimeout(() => Calendario.renderizar(), 150);
                        }
                        // Atualizar cards se estiver na visualizaÃ§Ã£o de cards
                        if (typeof Agenda !== 'undefined' && Agenda.renderizarCards) {
                            setTimeout(() => Agenda.renderizarCards(), 150);
                        }
                    }
                    
                    // Verificar se o modal de agendamento estÃ¡ aberto
                    const modalAberto = document.getElementById('modalAgendamento')?.classList.contains('active');
                    if (modalAberto) {
                        console.log('âœ… [MODAL AGENDAMENTO] Modal aberto, atualizando select de pacientes...');
                        
                        // Recarregar dados do localStorage
                        SistemaCore.carregar();
                        
                        // Salvar valor atualmente selecionado (se houver)
                        const selectPac = document.getElementById('agend-paciente');
                        const valorAtual = selectPac ? selectPac.value : '';
                        
                        // Reconstruir o select de pacientes
                        if (selectPac) {
                            selectPac.innerHTML = '<option value="">Selecione um paciente...</option>';
                            SistemaCore.dados.pacientes
                                .filter(pac => {
                                    // v10.463: Excluir "NÃ£o Identificado" da lista de agendamento
                                    const nome = (pac.nome || '').toUpperCase();
                                    return !nome.includes('NÃƒO IDENTIFICADO') && !nome.includes('NAO IDENTIFICADO');
                                })
                                .forEach(pac => {
                                    const cadastroIncompleto = pac.cadastro_completo === false;
                                    const indicador = cadastroIncompleto ? 'âš ï¸ ' : '';
                                    const telInfo = pac.telefone ? ` (Tel: ${pac.telefone})` : '';
                                    selectPac.innerHTML += `<option value="${pac.id}">${indicador}${pac.nome}${cadastroIncompleto ? telInfo : ''}</option>`;
                                });
                            
                            // Restaurar seleÃ§Ã£o anterior se ainda existir
                            if (valorAtual && document.querySelector(`#agend-paciente option[value="${valorAtual}"]`)) {
                                selectPac.value = valorAtual;
                            }
                            
                            console.log('âœ… [MODAL AGENDAMENTO] Select de pacientes atualizado!');
                            
                            // Se o paciente que foi salvo era o selecionado, mostrar notificaÃ§Ã£o
                            if (e.detail.eraIncompleto && valorAtual == e.detail.pacienteId) {
                                const paciente = SistemaCore.dados.pacientes.find(p => p.id === e.detail.pacienteId);
                                if (paciente) {
                                    Sistema.notificar(`âœ… Cadastro de ${paciente.nome} completado! Agora vocÃª pode agendar.`, 'success');
                                }
                            }
                        }
                    }
                });
                
                this.renderizar();
            },
            
            renderizar() {
                const container = document.getElementById('calendario-grid');
                if (!container) return;
                
                // v8.0.16: DEBUG - Mostrar filtro ativo
                console.log('ğŸ“… [CALENDÃRIO] Renderizando calendÃ¡rio...');
                console.log('ğŸ” [CALENDÃRIO] Filtro ativo:', this.tipoSelecionado);
                console.log('ğŸ“… [CALENDÃRIO] Total de agendamentos no sistema:', SistemaCore.dados.agendamentos?.length || 0);
                if (SistemaCore.dados.agendamentos && SistemaCore.dados.agendamentos.length > 0) {
                    console.log('ğŸ“… [CALENDÃRIO] Lista de agendamentos:', SistemaCore.dados.agendamentos);
                }
                
                const primeiroDia = new Date(this.anoAtual, this.mesAtual, 1);
                const ultimoDia = new Date(this.anoAtual, this.mesAtual + 1, 0);
                const diasMes = ultimoDia.getDate();
                const diaSemanaInicio = primeiroDia.getDay();
                
                // Atualizar tÃ­tulo
                const meses = ['Janeiro', 'Fevereiro', 'MarÃ§o', 'Abril', 'Maio', 'Junho', 
                               'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
                const titulo = document.getElementById('calendario-titulo');
                if (titulo) {
                    titulo.textContent = `${meses[this.mesAtual]} ${this.anoAtual}`;
                }
                
                let html = '';
                
                // Headers dos dias da semana
                const diasSemana = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'SÃ¡b'];
                diasSemana.forEach(dia => {
                    html += `<div class="calendario-dia-header">${dia}</div>`;
                });
                
                // Dias do mÃªs anterior (preenchimento)
                const diasMesAnterior = new Date(this.anoAtual, this.mesAtual, 0).getDate();
                for (let i = diaSemanaInicio - 1; i >= 0; i--) {
                    const dia = diasMesAnterior - i;
                    html += `<div class="calendario-dia outro-mes">
                        <div class="calendario-dia-numero">${dia}</div>
                    </div>`;
                }
                
                // Dias do mÃªs atual
                const hoje = new Date();
                
                // v10.115: Ler filtro de profissional ativo
                const filtroProfissionalAtivo = parseInt(document.getElementById('filtro-profissional-agenda')?.value) || 0;
                
                for (let dia = 1; dia <= diasMes; dia++) {
                    const dataCompleta = `${this.anoAtual}-${String(this.mesAtual + 1).padStart(2, '0')}-${String(dia).padStart(2, '0')}`;
                    const ehHoje = (dia === hoje.getDate() && this.mesAtual === hoje.getMonth() && this.anoAtual === hoje.getFullYear());
                    const ehSelecionado = (dataCompleta === this.diaSelecionado); // v10.5.4: Verificar se Ã© o dia selecionado
                    
                    // v8.0.15: SIMPLIFICAR - mostrar apenas indicadores coloridos
                    let eventos = this.getEventosDia(dataCompleta);
                    
                    // v10.115: Aplicar filtro de profissional se estiver ativo
                    if (filtroProfissionalAtivo) {
                        eventos = eventos.filter(ev => {
                            // SÃ³ filtrar agendamentos que tÃªm profissional_id
                            if (ev.tipo === 'agendamento' && ev.dados && ev.dados.profissional_id) {
                                return ev.dados.profissional_id === filtroProfissionalAtivo;
                            }
                            // Manter internaÃ§Ãµes, emergÃªncias, etc
                            return true;
                        });
                    }
                    
                    const contador = eventos.length;
                    
                    // Agrupar eventos por tipo para mostrar dots coloridos
                    const temConsulta = eventos.some(ev => ev.tipo_reparticao === 'consultorio');
                    const temProcedimento = eventos.some(ev => ev.tipo_reparticao === 'procedimento');
                    const temCirurgia = eventos.some(ev => ev.tipo_reparticao === 'bloco_cirurgico' || ev.tipo_reparticao === 'cirurgia');
                    const temInternacao = eventos.some(ev => ev.tipo_reparticao === 'internacao');
                    // v10.109: Incluir TODOS os subtipos de exames
                    const temExame = eventos.some(ev => 
                        ev.tipo_reparticao === 'exames' || 
                        ev.tipo_reparticao === 'exames_laboratorio' || 
                        ev.tipo_reparticao === 'exames_imagem'
                    );
                    const temEmergencia = eventos.some(ev => ev.tipo_reparticao === 'emergencia');
                    // v10.109: Incluir leitos reservados (reserva/matriciamento)
                    const temReserva = eventos.some(ev => ev.tipo === 'reservado');
                    
                    html += `<div class="calendario-dia ${ehHoje ? 'hoje' : ''} ${ehSelecionado ? 'selecionado' : ''}" onclick="Calendario.clicarDia('${dataCompleta}')">
                        <div class="calendario-dia-numero">${dia}</div>
                        ${contador > 0 ? `
                            <div style="display: flex; gap: 4px; justify-content: center; margin-top: 4px; flex-wrap: wrap;">
                                ${temConsulta ? '<div style="width: 8px; height: 8px; background: #3b82f6; border-radius: 50%;" title="Consultas"></div>' : ''}
                                ${temProcedimento ? '<div style="width: 8px; height: 8px; background: #10b981; border-radius: 50%;" title="Procedimentos"></div>' : ''}
                                ${temExame ? '<div style="width: 8px; height: 8px; background: #ec4899; border-radius: 50%;" title="Exames"></div>' : ''}
                                ${temCirurgia ? '<div style="width: 8px; height: 8px; background: #8b5cf6; border-radius: 50%;" title="Cirurgias"></div>' : ''}
                                ${temInternacao ? '<div style="width: 8px; height: 8px; background: #f59e0b; border-radius: 50%;" title="InternaÃ§Ãµes"></div>' : ''}
                                ${temReserva ? '<div style="width: 8px; height: 8px; background: #fbbf24; border-radius: 50%;" title="Leitos Reservados"></div>' : ''}
                                ${temEmergencia ? '<div style="width: 8px; height: 8px; background: #ef4444; border-radius: 50%;" title="EmergÃªncia"></div>' : ''}
                            </div>
                        ` : ''}
                    </div>`;
                }
                
                // Dias do prÃ³ximo mÃªs (preenchimento)
                const totalCelulas = 42;
                const celulasPreenchidas = diaSemanaInicio + diasMes;
                const diasProximoMes = totalCelulas - celulasPreenchidas;
                for (let dia = 1; dia <= diasProximoMes; dia++) {
                    html += `<div class="calendario-dia outro-mes">
                        <div class="calendario-dia-numero">${dia}</div>
                    </div>`;
                }
                
                container.innerHTML = html;
            },
            
            // v8.0.5: INTEGRAÃ‡ÃƒO AGENDA + MAPA - Busca TODOS os eventos de um dia
            // v8.0.9: Adiciona filtro por tipo de serviÃ§o
            getEventosDia(data) {
                let eventos = [];
                
                // 1ï¸âƒ£ AGENDAMENTOS (consultas, procedimentos, exames)
                const agendamentos = SistemaCore.dados.agendamentos || [];
                agendamentos.filter(ag => ag.data === data).forEach(ag => {
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === ag.paciente_id);
                    const reparticao = SistemaCore.dados.reparticoes.find(r => r.id === ag.reparticao_id);
                    
                    // v10.100: GARANTIR tipo correto - buscar do grupo pai se necessÃ¡rio
                    let tipoRep = 'consultorio';
                    if (reparticao) {
                        tipoRep = reparticao.tipo_reparticao;
                        
                        // Se nÃ£o tem tipo, buscar do grupo pai (SEMPRE, independente de eh_subreparticao)
                        if (!tipoRep) {
                            const grupoPai = SistemaCore.dados.reparticoes.find(g => 
                                g.subreparticoes_ids && g.subreparticoes_ids.includes(reparticao.id)
                            );
                            if (grupoPai && grupoPai.tipo_reparticao) {
                                tipoRep = grupoPai.tipo_reparticao;
                                console.log(`ğŸ” [CALENDÃRIO] ${reparticao.nome}: tipo buscado do pai "${grupoPai.nome}" â†’ ${tipoRep}`);
                            } else {
                                console.warn(`âš ï¸ [CALENDÃRIO] ${reparticao.nome}: SEM TIPO e sem grupo pai! Usando 'consultorio'`);
                            }
                        }
                    }
                    
                    // v10.98: Definir cor e Ã­cone baseado no tipo de repartiÃ§Ã£o
                    const corPorTipo = {
                        'consultorio': { cor: '#3b82f6', icone: 'ğŸ“…' },           // Azul
                        'procedimento': { cor: '#10b981', icone: 'ğŸ”§' },          // Verde
                        'bloco_cirurgico': { cor: '#8b5cf6', icone: 'âš•ï¸' },       // Roxo
                        'cirurgia': { cor: '#8b5cf6', icone: 'âš•ï¸' },              // Roxo
                        'internacao': { cor: '#f59e0b', icone: 'ğŸ›ï¸' },            // Laranja
                        'exames': { cor: '#ec4899', icone: 'ğŸ”¬' },                // Rosa
                        'exames_laboratorio': { cor: '#ec4899', icone: 'ğŸ”¬' },    // Rosa
                        'exames_imagem': { cor: '#ec4899', icone: 'ğŸ©»' },         // Rosa
                        'emergencia': { cor: '#ef4444', icone: 'ğŸ”´' }             // Vermelho
                    };
                    const tipoInfo = corPorTipo[tipoRep] || corPorTipo['consultorio'];
                    
                    eventos.push({
                        tipo: 'agendamento',
                        tipo_reparticao: tipoRep, // v8.0.9: Para filtro por tipo
                        cor: tipoInfo.cor,
                        icone: tipoInfo.icone,
                        hora: ag.hora,
                        paciente_nome: paciente ? paciente.nome.split(' ')[0] : 'Paciente',
                        local: reparticao ? reparticao.nome : 'Local',
                        dados: ag,
                        _debug_reparticao_nome: reparticao ? reparticao.nome : 'N/A',
                        _debug_tipo_usado: tipoRep,
                        _debug_cor_usada: tipoInfo.cor
                    });
                    
                    console.log(`ğŸ¨ [COR] ${reparticao?.nome || 'N/A'}: tipo="${tipoRep}" â†’ cor=${tipoInfo.cor}`);
                });
                
                // 2ï¸âƒ£ PACIENTES INTERNADOS (leitos ocupados)
                const reparticoes = SistemaCore.dados.reparticoes || [];
                reparticoes.forEach(rep => {
                    // Se Ã© leito ocupado com paciente
                    if (rep.status === 'ocupado' && rep.paciente_id && rep.data_ocupacao) {
                        const dataOcupacao = rep.data_ocupacao.split('T')[0]; // Pega sÃ³ a data (YYYY-MM-DD)
                        
                        // Se a data de ocupaÃ§Ã£o Ã© <= a data selecionada, o paciente estÃ¡ internado neste dia
                        if (dataOcupacao <= data) {
                            const paciente = SistemaCore.dados.pacientes.find(p => p.id === rep.paciente_id);
                            const tipoRep = rep.tipo_reparticao || 'internacao';
                            
                            let icone = 'ğŸ›ï¸';
                            let cor = '#8b5cf6'; // Roxo
                            let tipoLabel = 'InternaÃ§Ã£o';
                            
                            if (tipoRep === 'emergencia') {
                                icone = 'ğŸ”´';
                                cor = '#ef4444'; // Vermelho
                                tipoLabel = 'EmergÃªncia';
                            } else if (tipoRep === 'bloco_cirurgico' || tipoRep === 'cirurgia') {  // v8.0.17: Aceitar ambos
                                icone = 'âš•ï¸';
                                cor = '#10b981'; // Verde
                                tipoLabel = 'Cirurgia';
                            }
                            
                            eventos.push({
                                tipo: tipoLabel.toLowerCase(),
                                tipo_reparticao: tipoRep, // v8.0.9: Para filtro por tipo
                                cor: cor,
                                icone: icone,
                                hora: 'Todo dia',
                                paciente_nome: paciente ? paciente.nome.split(' ')[0] : 'Paciente',
                                local: rep.nome,
                                dados: rep
                            });
                        }
                    }
                    
                    // 3ï¸âƒ£ LEITOS RESERVADOS (matriciamento) - v10.67: CORRIGIDO
                    // Mostra na DATA PREVISTA DE ENTRADA, nÃ£o na data que foi criada a reserva
                    if (rep.status === 'reservado' && rep.data_prevista_entrada) {
                        if (rep.data_prevista_entrada === data) {
                            const paciente = SistemaCore.dados.pacientes.find(p => p.id === rep.reservado_para_paciente_id);
                            const tipoRep = rep.tipo_reparticao || 'internacao';
                            
                            eventos.push({
                                tipo: 'reservado',
                                tipo_reparticao: tipoRep, // v8.0.9: Para filtro por tipo
                                cor: '#f59e0b', // Amarelo/laranja
                                icone: 'ğŸŸ¡',
                                hora: 'Reservado',
                                paciente_nome: paciente ? paciente.nome.split(' ')[0] : 'Paciente',
                                local: rep.nome,
                                dados: rep
                            });
                        }
                    }
                });
                
                // v8.0.9: APLICAR FILTRO POR TIPO DE SERVIÃ‡O
                if (this.tipoSelecionado && this.tipoSelecionado !== 'todos') {
                    console.log(`ğŸ” [CALENDÃRIO] Filtrando eventos para ${data}`);
                    console.log(`ğŸ” [CALENDÃRIO] Tipo selecionado: ${this.tipoSelecionado}`);
                    console.log(`ğŸ“Š [CALENDÃRIO] Eventos ANTES do filtro (${eventos.length}):`, eventos.map(e => `${e.icone} ${e.paciente_nome} (tipo_rep: ${e.tipo_reparticao})`));
                    
                    // v10.114: Filtro de exames inclui laboratorio e imagem
                    const eventosFiltrados = eventos.filter(ev => {
                        if (this.tipoSelecionado === 'exames') {
                            // Aceita 'exames', 'exames_laboratorio' ou 'exames_imagem'
                            return ev.tipo_reparticao === 'exames' || 
                                   ev.tipo_reparticao === 'exames_laboratorio' || 
                                   ev.tipo_reparticao === 'exames_imagem';
                        }
                        return ev.tipo_reparticao === this.tipoSelecionado;
                    });
                    
                    console.log(`ğŸ“Š [CALENDÃRIO] Eventos DEPOIS do filtro (${eventosFiltrados.length}):`, eventosFiltrados.map(e => `${e.icone} ${e.paciente_nome}`));
                    eventos = eventosFiltrados;
                }
                
                // Ordenar por hora (agendamentos primeiro, depois demais)
                eventos.sort((a, b) => {
                    if (a.hora === 'Todo dia') return 1;
                    if (b.hora === 'Todo dia') return -1;
                    if (a.hora === 'Reservado') return 1;
                    if (b.hora === 'Reservado') return -1;
                    return a.hora.localeCompare(b.hora);
                });
                
                return eventos;
            },
            
            // Manter compatibilidade com cÃ³digo antigo
            getAgendamentosDia(data) {
                return this.getEventosDia(data).filter(e => e.tipo === 'agendamento');
            },
            
            clicarDia(data) {
                // v10.5.4: Salvar dia selecionado e re-renderizar
                this.diaSelecionado = data;
                this.renderizar();
                
                // Selecionar data na Agenda e mostrar agendamentos daquele dia
                if (typeof Agenda !== 'undefined' && Agenda.selecionarData) {
                    Agenda.selecionarData(data);
                }
            },
            
            mesAnterior() {
                this.mesAtual--;
                if (this.mesAtual < 0) {
                    this.mesAtual = 11;
                    this.anoAtual--;
                }
                this.renderizar();
            },
            
            proximoMes() {
                this.mesAtual++;
                if (this.mesAtual > 11) {
                    this.mesAtual = 0;
                    this.anoAtual++;
                }
                this.renderizar();
            },
            
            hoje() {
                this.mesAtual = new Date().getMonth();
                this.anoAtual = new Date().getFullYear();
                this.renderizar();
            }
        };

        
        /* ============================================================
           [PERMISSOES RESERVA] Sistema de Controle de Acesso para Reserva de Leitos
           ============================================================ */
        
        const PermissoesReserva = {
            // v8.0.6: Categorias autorizadas a reservar leitos (matriciamento)
            categoriasAutorizadas: [
                'assistente_social',  // Principal responsÃ¡vel pelo matriciamento
                'administrativo',     // GestÃ£o administrativa
                'coordenador',        // CoordenaÃ§Ã£o de serviÃ§os
                'gestor'              // Gestores da unidade
            ],
            
            // Categorias NÃƒO autorizadas (conflito de interesse / papel clÃ­nico)
            categoriasNaoAutorizadas: [
                'medico',            // Deve focar no atendimento clÃ­nico
                'enfermeiro',        // Deve focar na assistÃªncia
                'fisioterapeuta',    // AtuaÃ§Ã£o clÃ­nica
                'psicologo',         // AtuaÃ§Ã£o clÃ­nica
                'nutricionista',     // AtuaÃ§Ã£o clÃ­nica
                'farmaceutico',      // AtuaÃ§Ã£o tÃ©cnica
                'recepcionista'      // FunÃ§Ã£o administrativa limitada
            ],
            
            // Verificar se usuÃ¡rio logado pode reservar leitos
            usuarioPodeReservar() {
                if (!Auth.usuarioAtual) {
                    console.log('âŒ [PERMISSÃƒO RESERVA] Nenhum usuÃ¡rio logado');
                    return false;
                }
                
                // Admin sempre pode
                if (Auth.usuarioAtual.tipo === 'admin' || Auth.usuarioAtual.usuario === 'admin') {
                    console.log('âœ… [PERMISSÃƒO RESERVA] Admin pode reservar');
                    return true;
                }
                
                // Verificar se Ã© profissional
                if (Auth.usuarioAtual.tipo !== 'profissional') {
                    console.log('âŒ [PERMISSÃƒO RESERVA] UsuÃ¡rio nÃ£o Ã© profissional');
                    return false;
                }
                
                // Buscar dados do profissional
                const profissional = SistemaCore.dados.profissionais.find(
                    p => p.id === Auth.usuarioAtual.profissional_id
                );
                
                if (!profissional || !profissional.categoria_profissional) {
                    console.log('âŒ [PERMISSÃƒO RESERVA] Profissional nÃ£o encontrado ou sem categoria');
                    return false;
                }
                
                const categoria = profissional.categoria_profissional;
                const autorizado = this.categoriasAutorizadas.includes(categoria);
                
                if (autorizado) {
                    console.log(`âœ… [PERMISSÃƒO RESERVA] Categoria "${categoria}" autorizada a reservar`);
                } else {
                    console.log(`âŒ [PERMISSÃƒO RESERVA] Categoria "${categoria}" NÃƒO autorizada a reservar`);
                }
                
                return autorizado;
            },
            
            // Obter mensagem explicativa sobre permissÃµes
            getMensagemNegacao() {
                if (!Auth.usuarioAtual) {
                    return 'VocÃª precisa estar logado para reservar leitos.';
                }
                
                if (Auth.usuarioAtual.tipo !== 'profissional') {
                    return 'Apenas profissionais autorizados podem reservar leitos.';
                }
                
                const profissional = SistemaCore.dados.profissionais.find(
                    p => p.id === Auth.usuarioAtual.profissional_id
                );
                
                if (!profissional) {
                    return 'Profissional nÃ£o encontrado no sistema.';
                }
                
                const categoria = profissional.categoria_profissional || 'indefinida';
                
                return `Sua categoria profissional (${this.getNomeCategoria(categoria)}) nÃ£o tem permissÃ£o para reservar leitos. ` +
                       `O matriciamento deve ser realizado por: Assistente Social, Administrativo, Coordenador ou Gestor.`;
            },
            
            // Obter nome amigÃ¡vel da categoria
            getNomeCategoria(categoria) {
                const nomes = {
                    'medico': 'MÃ©dico',
                    'enfermeiro': 'Enfermeiro',
                    'assistente_social': 'Assistente Social',
                    'fisioterapeuta': 'Fisioterapeuta',
                    'psicologo': 'PsicÃ³logo',
                    'nutricionista': 'Nutricionista',
                    'farmaceutico': 'FarmacÃªutico',
                    'administrativo': 'Administrativo',
                    'recepcionista': 'Recepcionista',
                    'coordenador': 'Coordenador',
                    'gestor': 'Gestor'
                };
                return nomes[categoria] || categoria;
            }
        };

        /* ============================================================
           [PERMISSOES] Sistema de PermissÃµes ConfigurÃ¡vel
           ============================================================ */
        
        const Permissoes = {
            // Categorias padrÃ£o autorizadas
            categoriasDefault: [
                'medico',
                'enfermeiro',
                'assistente_social',
                'fisioterapeuta',
                'psicologo',
                'nutricionista',
                'farmaceutico'
            ],
            
            carregar() {
                // Carregar permissÃµes salvas ou usar padrÃ£o
                const permissoes = SistemaCore.dados.permissoes_prontuario || this.categoriasDefault;
                
                // Marcar checkboxes
                const todasCategorias = [
                    'medico', 'enfermeiro', 'assistente_social', 'fisioterapeuta',
                    'psicologo', 'nutricionista', 'farmaceutico', 'administrativo', 'recepcionista'
                ];
                
                todasCategorias.forEach(cat => {
                    const checkbox = document.getElementById('perm-' + cat);
                    if (checkbox) {
                        checkbox.checked = permissoes.includes(cat);
                    }
                });
            },
            
            salvar() {
                const permissoes = [];
                const todasCategorias = [
                    'medico', 'enfermeiro', 'assistente_social', 'fisioterapeuta',
                    'psicologo', 'nutricionista', 'farmaceutico', 'administrativo', 'recepcionista'
                ];
                
                todasCategorias.forEach(cat => {
                    const checkbox = document.getElementById('perm-' + cat);
                    if (checkbox && checkbox.checked) {
                        permissoes.push(cat);
                    }
                });
                
                SistemaCore.dados.permissoes_prontuario = permissoes;
                SistemaCore.salvar();
                Sistema.notificar('PermissÃµes atualizadas!', 'success');
            },
            
            obterPermissoes() {
                return SistemaCore.dados.permissoes_prontuario || this.categoriasDefault;
            }
        };

        /* ============================================================
           [CONTROLE ACESSO] Sistema de Controle de Acesso ao ProntuÃ¡rio
           ============================================================ */
        
        const ProntuarioAcesso = {
            verificarAcesso(profissionalId) {
                if (!profissionalId) return false;
                const prof = SistemaCore.dados.profissionais.find(p => p.id === profissionalId);
                if (!prof || !prof.categoria_profissional) return false;
                
                // Usar permissÃµes configurÃ¡veis
                const categoriasAutorizadas = Permissoes.obterPermissoes();
                return categoriasAutorizadas.includes(prof.categoria_profissional);
            },
            
            usuarioPodeAcessar() {
                if (!Auth.usuarioAtual) return false;
                // Admin sempre tem acesso
                if (Auth.usuarioAtual.tipo === 'admin' || Auth.usuarioAtual.usuario === 'admin') return true;
                if (Auth.usuarioAtual.tipo !== 'profissional') return false;
                return this.verificarAcesso(Auth.usuarioAtual.profissional_id);
            },
            
            bloquearAcesso() {
                Sistema.notificar(
                    'Acesso negado! Apenas profissionais autorizados podem acessar prontuÃ¡rios mÃ©dicos.',
                    'error'
                );
                return false;
            },
            
            getNomeCategoria(categoria) {
                const nomes = {
                    'medico': 'MÃ©dico(a)',
                    'enfermeiro': 'Enfermeiro(a)',
                    'assistente_social': 'Assistente Social',
                    'fisioterapeuta': 'Fisioterapeuta',
                    'psicologo': 'PsicÃ³logo(a)',
                    'nutricionista': 'Nutricionista',
                    'farmaceutico': 'FarmacÃªutico(a)',
                    'administrativo': 'Administrativo',
                    'recepcionista': 'Recepcionista'
                };
                return nomes[categoria] || categoria;
            }
        };

        /* ============================================================
           [SAME] ServiÃ§o de Arquivo MÃ©dico e EstatÃ­stica
           ============================================================ */
        
        const SAME = {
            listar() {
                const container = document.getElementById('listaSAME');
                let registros = SistemaCore.dados.same || [];

                // Filtros
                const dataInicio = document.getElementById('same-data-inicio').value;
                const dataFim = document.getElementById('same-data-fim').value;
                const tipoAlta = document.getElementById('same-tipo-alta').value;

                if (dataInicio) {
                    registros = registros.filter(r => r.data_alta >= dataInicio);
                }
                if (dataFim) {
                    registros = registros.filter(r => r.data_alta <= dataFim);
                }
                if (tipoAlta) {
                    registros = registros.filter(r => r.tipo_alta === tipoAlta);
                }

                // Atualizar estatÃ­sticas
                this.atualizarEstatisticas(registros);

                if (registros.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-light);">Nenhum registro de alta encontrado.</p>';
                    return;
                }

                // Ordenar por data de alta (mais recente primeiro)
                registros.sort((a, b) => new Date(b.data_alta) - new Date(a.data_alta));

                let html = '<div class="item-list">';
                registros.forEach(reg => {
                    const tipoAltaNome = {
                        'clinica': 'âœ… Alta ClÃ­nica',
                        'a_pedido': 'ğŸ“ A Pedido',
                        'transferencia': 'ğŸš‘ TransferÃªncia',
                        'evasao': 'ğŸšª EvasÃ£o',
                        'obito': 'ğŸ’” Ã“bito'
                    }[reg.tipo_alta] || reg.tipo_alta;

                    const tipoAltaClass = {
                        'clinica': 'badge-success',
                        'a_pedido': 'badge-info',
                        'transferencia': 'badge-warning',
                        'evasao': 'badge-danger',
                        'obito': 'badge-danger'
                    }[reg.tipo_alta] || 'badge-info';

                    html += `
                        <div class="item-card">
                            <div>
                                <strong>${reg.paciente_nome}</strong>
                                <span class="badge ${tipoAltaClass}" style="margin-left: 8px;">${tipoAltaNome}</span>
                                <br>
                                <small style="color: var(--text-light);">
                                    CPF: ${reg.paciente_cpf || 'NÃ£o informado'} | Leito: ${reg.reparticao_nome}<br>
                                    InternaÃ§Ã£o: ${this.formatarData(reg.data_internacao)} | Alta: ${this.formatarData(reg.data_alta)}<br>
                                    <strong>${reg.dias_internado} dias</strong> de internaÃ§Ã£o
                                </small>
                                ${reg.motivo_internacao ? `<br><small><strong>Motivo:</strong> ${reg.motivo_internacao}</small>` : ''}
                                ${reg.observacoes ? `<br><small><strong>Obs:</strong> ${reg.observacoes}</small>` : ''}
                            </div>
                            <div class="action-buttons">
                                <button class="btn btn-icon btn-primary" onclick="SAME.verDetalhes(${reg.id})" title="Ver detalhes">ğŸ‘ï¸</button>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;
            },

            atualizarEstatisticas(registros = null) {
                if (!registros) {
                    registros = SistemaCore.dados.same || [];
                }

                // Total de altas
                document.getElementById('same-total').textContent = registros.length;

                // Altas este mÃªs
                const hoje = new Date();
                const mesAtual = hoje.getMonth();
                const anoAtual = hoje.getFullYear();
                const altasMes = registros.filter(r => {
                    const dataAlta = new Date(r.data_alta);
                    return dataAlta.getMonth() === mesAtual && dataAlta.getFullYear() === anoAtual;
                }).length;
                document.getElementById('same-altas-mes').textContent = altasMes;

                // Tempo mÃ©dio de internaÃ§Ã£o
                if (registros.length > 0) {
                    const somaTemDias = registros.reduce((sum, r) => sum + (r.dias_internado || 0), 0);
                    const media = Math.round(somaTemDias / registros.length);
                    document.getElementById('same-tempo-medio').textContent = media;
                } else {
                    document.getElementById('same-tempo-medio').textContent = '0';
                }
            },

            formatarData(dataISO) {
                if (!dataISO) return 'NÃ£o informado';
                const data = new Date(dataISO);
                return data.toLocaleDateString('pt-BR');
            },

            verDetalhes(id) {
                const reg = (SistemaCore.dados.same || []).find(r => r.id === id);
                if (!reg) return;

                const tipoAltaNome = {
                    'clinica': 'Alta ClÃ­nica (Cura)',
                    'a_pedido': 'Alta a Pedido',
                    'transferencia': 'TransferÃªncia',
                    'evasao': 'EvasÃ£o',
                    'obito': 'Ã“bito'
                }[reg.tipo_alta] || reg.tipo_alta;

                alert(`ğŸ“‹ DETALHES DO REGISTRO SAME #${reg.id}

ğŸ‘¤ PACIENTE: ${reg.paciente_nome}
ğŸ“„ CPF: ${reg.paciente_cpf || 'NÃ£o informado'}

ğŸ›ï¸ INTERNAÃ‡ÃƒO:
â€¢ Leito: ${reg.reparticao_nome}
â€¢ Data entrada: ${this.formatarData(reg.data_internacao)}
â€¢ Motivo: ${reg.motivo_internacao || 'NÃ£o informado'}

ğŸšª ALTA:
â€¢ Data alta: ${this.formatarData(reg.data_alta)}
â€¢ Tipo: ${tipoAltaNome}
â€¢ Dias internado: ${reg.dias_internado}

ğŸ“ OBSERVAÃ‡Ã•ES:
${reg.observacoes || 'Nenhuma observaÃ§Ã£o registrada'}`);
            },

            exportarCSV() {
                const registros = SistemaCore.dados.same || [];
                if (registros.length === 0) {
                    Sistema.notificar('Nenhum registro para exportar!', 'error');
                    return;
                }

                // CabeÃ§alhos
                let csv = 'ID;Paciente;CPF;Leito;Data InternaÃ§Ã£o;Data Alta;Dias;Tipo Alta;Motivo;ObservaÃ§Ãµes\n';

                // Dados
                registros.forEach(reg => {
                    csv += `${reg.id};${reg.paciente_nome};${reg.paciente_cpf || ''};${reg.reparticao_nome};` +
                           `${this.formatarData(reg.data_internacao)};${this.formatarData(reg.data_alta)};` +
                           `${reg.dias_internado};${reg.tipo_alta};${reg.motivo_internacao || ''};${reg.observacoes || ''}\n`;
                });

                // Download
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `SAME_${new Date().toISOString().split('T')[0]}.csv`;
                a.click();
                Sistema.notificar('âœ… Arquivo CSV exportado!');
            }
        };

        /* ============================================================
           [POOLS] MÃ³dulo de GestÃ£o de Pools - v7.3
           ============================================================ */
        
        const Pools = {
            listar() {
                const container = document.getElementById('listaPools');
                const pools = SistemaCore.dados.pools;
                
                // v9.8.2: Auto-popular pool de especialidades de profissionais
                this.autoPopularEspecialidades();
                
                // v10: Inicializar pools com valores padrÃ£o
                this.inicializarCargos();
                this.inicializarCategorias();
                this.inicializarConvenios();
                this.inicializarRegionais();

                let html = `
                    <!-- v10.39: Pools Reorganizados por Categoria -->
                    
                    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                    <!-- ğŸ¥ POOLS DO ESTABELECIMENTO (Estruturais/Compartilhados) -->
                    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                    
                    <div style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; margin-bottom: 32px; color: white;">
                        <h2 style="font-size: 24px; margin: 0 0 12px 0; font-weight: 700;">
                            ğŸ¥ POOLS DO ESTABELECIMENTO
                        </h2>
                        <p style="font-size: 14px; margin: 0; opacity: 0.95; line-height: 1.6;">
                            Pools <strong>estruturais e compartilhados</strong> entre mÃºltiplas Ã¡reas do sistema. 
                            Gerenciados centralmente e usados em diversos cadastros.
                        </p>
                    </div>
                    
                    <!-- SEÃ‡ÃƒO: Infraestrutura FÃ­sica -->
                    <div style="margin-bottom: 32px;">
                        <h2 style="font-size: 20px; color: #9333ea; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 3px solid #a855f7;">
                            ğŸ—ï¸ Infraestrutura FÃ­sica
                        </h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 16px;">
                            ${this.renderPool('andares', 'ğŸ—ï¸ Andares/Pisos', SistemaCore.dados.estabelecimento.andares || [])}
                            ${this.renderPool('setores', 'ğŸ“ Enfermarias/Setores', SistemaCore.dados.estabelecimento.setores || [])}
                            ${this.renderPool('nomes_sugeridos', 'ğŸ“ Nome da RepartiÃ§Ã£o', pools.nomes_sugeridos || [])}
                            ${this.renderPool('pavilhoes', 'ğŸ›ï¸ PavilhÃµes/Blocos/Alas', SistemaCore.dados.estabelecimento.pavilhoes || [])}
                        </div>
                    </div>
                    
                    <!-- SEÃ‡ÃƒO: Especialidades (Compartilhado) -->
                    <div style="margin-bottom: 32px;">
                        <h2 style="font-size: 20px; color: #dc2626; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 3px solid #ef4444;">
                            ğŸ©º Especialidades MÃ©dicas
                        </h2>
                        <div style="padding: 16px; background: #f9fafb; border-radius: 8px; border: 2px solid #fbbf24; margin-bottom: 16px;">
                            <p style="font-size: 14px; color: #92400e; margin: 0 0 8px 0; line-height: 1.5;">
                                ğŸ’¡ <strong>Pool Compartilhado:</strong> Usado em <strong>Profissionais</strong> (especialidade do mÃ©dico) + <strong>RepartiÃ§Ãµes</strong> (especialidades permitidas)
                            </p>
                            <p style="font-size: 13px; color: #92400e; margin: 0; line-height: 1.5;">
                                ğŸ”„ <strong>Bidirecional:</strong> Adicionar aqui aparece nos cadastros. Adicionar nos cadastros aparece aqui.
                            </p>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 16px;">
                            ${this.renderPool('especialidades', 'ğŸ©º Especialidades', SistemaCore.dados.estabelecimento.especialidades || [])}
                        </div>
                    </div>
                    
                    <!-- SEÃ‡ÃƒO: Profissionais -->
                    <div style="margin-bottom: 32px;">
                        <h2 style="font-size: 20px; color: #1e40af; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 3px solid #3b82f6;">
                            ğŸ‘¨â€âš•ï¸ Profissionais
                        </h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 16px;">
                            ${this.renderPool('cargos', 'ğŸ’¼ Cargos/FunÃ§Ãµes', SistemaCore.dados.estabelecimento.cargos || [])}
                            ${this.renderPool('categorias_profissionais', 'ğŸ‘” Categorias Profissionais', SistemaCore.dados.estabelecimento.categoriasProfissionais || [])}
                        </div>
                    </div>
                    
                    <!-- SEÃ‡ÃƒO: Pacientes -->
                    <div style="margin-bottom: 32px;">
                        <h2 style="font-size: 20px; color: #16a34a; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 3px solid #22c55e;">
                            ğŸ‘¤ Pacientes
                        </h2>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 16px;">
                            ${this.renderPool('convenios', 'ğŸ¥ ConvÃªnios Atendidos', SistemaCore.dados.estabelecimento.convenios || [])}
                            ${this.renderPool('regionaisSaude', 'ğŸ“ Regionais de SaÃºde', SistemaCore.dados.estabelecimento.regionaisSaude || [])}
                        </div>
                    </div>
                    
                    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                    <!-- ğŸ“‹ ATENDIMENTO -->
                    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                    
                    <div style="padding: 20px; background: linear-gradient(135deg, #059669 0%, #047857 100%); border-radius: 12px; margin-bottom: 32px; color: white; margin-top: 48px;">
                        <h2 style="font-size: 24px; margin: 0 0 12px 0; font-weight: 700;">
                            ğŸ“‹ POOLS CLÃNICOS - ATENDIMENTO
                        </h2>
                        <p style="font-size: 14px; margin: 0; opacity: 0.95; line-height: 1.6;">
                            Pools de <strong>contexto de atendimento</strong> usados na <strong>Folha de Rosto</strong> e documentos iniciais.
                        </p>
                    </div>
                    
                    <!-- SEÃ‡ÃƒO: Atendimento -->
                    <div style="margin-bottom: 32px;">
                        <h2 style="font-size: 20px; color: #059669; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 3px solid #10b981;">
                            ğŸ“‹ Contexto do Atendimento
                        </h2>
                        <div style="padding: 16px; background: #f9fafb; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 16px;">
                            <p style="font-size: 14px; color: #166534; margin: 0 0 8px 0; line-height: 1.5;">
                                ğŸ“… <strong>Tipos de Atendimento:</strong> Usado no <strong>Agendamento</strong> para filtrar unidades disponÃ­veis
                            </p>
                            <p style="font-size: 13px; color: #166534; margin: 0; line-height: 1.5;">
                                ğŸ”„ <strong>Filtragem AutomÃ¡tica:</strong> Ao selecionar tipo, apenas unidades compatÃ­veis aparecem
                            </p>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 16px;">
                            ${this.renderPool('tiposAtendimento', 'ğŸ“… Tipos de Atendimento', SistemaCore.dados.estabelecimento.tiposAtendimento || [])}
                            ${this.renderPool('motivosAtendimento', 'ğŸ“‹ Motivos de Atendimento', SistemaCore.dados.pools.motivosAtendimento || [])}
                        </div>
                    </div>
                    
                    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                    <!-- ğŸ’Š POOLS CLÃNICOS - TRATAMENTOS -->
                    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                    
                    <div style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; margin-bottom: 32px; color: white; margin-top: 48px;">
                        <h2 style="font-size: 24px; margin: 0 0 12px 0; font-weight: 700;">
                            ğŸ’Š POOLS CLÃNICOS - TRATAMENTOS
                        </h2>
                        <p style="font-size: 14px; margin: 0; opacity: 0.95; line-height: 1.6;">
                            Pools de <strong>procedimentos e medicaÃ§Ãµes</strong> usados nos <strong>Eventos ClÃ­nicos</strong> do prontuÃ¡rio.
                        </p>
                    </div>
                    
                    <!-- SEÃ‡ÃƒO: Tratamentos -->
                    <div style="margin-bottom: 32px;">
                        <h2 style="font-size: 20px; color: #9333ea; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 3px solid #a855f7;">
                            ğŸ“Š Eventos ClÃ­nicos e TerapÃªutica
                        </h2>
                        <div style="padding: 16px; background: #e0e7ff; border-radius: 8px; border: 2px solid #667eea; margin-bottom: 16px;">
                            <p style="font-size: 14px; color: #312e81; margin: 0 0 8px 0; line-height: 1.5;">
                                ğŸ’Š <strong>Usado no ProntuÃ¡rio:</strong> Registro de internaÃ§Ã£o, cirurgias e antibiÃ³ticos
                            </p>
                            <p style="font-size: 13px; color: #312e81; margin: 0; line-height: 1.5;">
                                â±ï¸ <strong>CÃ¡lculo AutomÃ¡tico:</strong> Sistema calcula D0, D1, D2... automaticamente
                            </p>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 16px;">
                            ${this.renderPool('antibioticos', 'ğŸ’Š AntibiÃ³ticos', pools.antibioticos || [])}
                            ${this.renderPool('procedimentos', 'âš•ï¸ Cirurgias/Procedimentos', pools.procedimentos || [])}
                            ${this.renderPool('locaisInternacao', 'ğŸ›ï¸ Locais de InternaÃ§Ã£o', pools.locaisInternacao || [])}
                            ${this.renderPool('medicacoes', 'ğŸ’Š MedicaÃ§Ãµes de Uso ContÃ­nuo', pools.medicacoes || [])}
                        </div>
                    </div>
                    
                    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                    <!-- ğŸ“ POOLS CLÃNICOS - ANAMNESE -->
                    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                    
                    <div style="padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; margin-bottom: 32px; color: white; margin-top: 48px;">
                        <h2 style="font-size: 24px; margin: 0 0 12px 0; font-weight: 700;">
                            ğŸ“ POOLS CLÃNICOS - ANAMNESE
                        </h2>
                        <p style="font-size: 14px; margin: 0; opacity: 0.95; line-height: 1.6;">
                            Pools de <strong>histÃ³ria e dados do paciente</strong> usados nos <strong>Dados Estruturados</strong> do prontuÃ¡rio.
                        </p>
                    </div>
                    
                    <!-- SEÃ‡ÃƒO: Anamnese -->
                    <div style="margin-bottom: 32px;">
                        <h2 style="font-size: 20px; color: #dc2626; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 3px solid #ef4444;">
                            ğŸ“‹ HistÃ³ria e Dados do Paciente
                        </h2>
                        <div style="padding: 16px; background: #f9fafb; border-radius: 8px; border: 2px solid #fbbf24; margin-bottom: 16px;">
                            <p style="font-size: 14px; color: #92400e; margin: 0 0 8px 0; line-height: 1.5;">
                                ğŸ“Š <strong>Dados Estruturados:</strong> Coleta estatÃ­stica respeitando LGPD
                            </p>
                            <p style="font-size: 13px; color: #92400e; margin: 0; line-height: 1.5;">
                                âœ… <strong>ColetÃ¡vel:</strong> Dropdowns coletam dados. Texto livre NÃƒO coleta.
                            </p>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 16px;">
                            ${this.renderPool('alergias', 'Alergias Medicamentosas', pools.alergias || [])}
                            ${this.renderPool('atividadesFisicas', 'ğŸƒ Atividades FÃ­sicas', pools.atividadesFisicas || [])}
                            ${this.renderPool('cirurgiasPregressas', 'ğŸ©¹ Cirurgias Pregressas', pools.cirurgiasPregressas || [])}
                            ${this.renderPool('doencasCronicas', 'ğŸ¥ DoenÃ§as CrÃ´nicas/Comorbidades', pools.doencasCronicas || [])}
                            ${this.renderPool('doencasFamiliares', 'ğŸ§¬ DoenÃ§as HereditÃ¡rias', pools.doencasFamiliares || [])}
                            ${this.renderPool('drogas', 'ğŸ’Š Drogas/SubstÃ¢ncias IlÃ­citas', pools.drogas || [])}
                            ${this.renderPool('expectativas', 'ğŸ¯ Expectativas do Paciente', pools.expectativas || [])}
                            ${this.renderPool('parentescos', 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ RelaÃ§Ãµes Familiares', pools.parentescos || [])}
                        </div>
                    </div>
                `;

                container.innerHTML = html;
            },
            
            // v9.8.2: Auto-popular pool de especialidades
            autoPopularEspecialidades() {
                if (!SistemaCore.dados.estabelecimento.especialidades) {
                    SistemaCore.dados.estabelecimento.especialidades = [];
                }
                
                let adicionou = false;
                const especialidadesSet = new Set(SistemaCore.dados.estabelecimento.especialidades);
                
                // Coletar de profissionais
                SistemaCore.dados.profissionais.forEach(prof => {
                    if (prof.especialidade_principal && !especialidadesSet.has(prof.especialidade_principal)) {
                        especialidadesSet.add(prof.especialidade_principal);
                        adicionou = true;
                    }
                    if (prof.especialidade && !especialidadesSet.has(prof.especialidade)) {
                        especialidadesSet.add(prof.especialidade);
                        adicionou = true;
                    }
                    if (prof.especialidades && Array.isArray(prof.especialidades)) {
                        prof.especialidades.forEach(esp => {
                            if (esp && !especialidadesSet.has(esp)) {
                                especialidadesSet.add(esp);
                                adicionou = true;
                            }
                        });
                    }
                });
                
                if (adicionou) {
                    SistemaCore.dados.estabelecimento.especialidades = Array.from(especialidadesSet).sort();
                    SistemaCore.salvar();
                    console.log('âœ… Pool de especialidades auto-populado:', SistemaCore.dados.estabelecimento.especialidades);
                }
            },
            
            // v10: Inicializar pool de cargos com valores padrÃ£o
            inicializarCargos() {
                if (!SistemaCore.dados.estabelecimento.cargos) {
                    SistemaCore.dados.estabelecimento.cargos = [];
                }
                
                if (SistemaCore.dados.estabelecimento.cargos.length === 0) {
                    SistemaCore.dados.estabelecimento.cargos = [
                        'Diretor',
                        'Coordenador',
                        'Supervisor',
                        'Gerente',
                        'Chefe de Setor',
                        'Assistente',
                        'TÃ©cnico',
                        'Auxiliar'
                    ];
                    SistemaCore.salvar();
                    console.log('âœ… Pool de cargos inicializado com valores padrÃ£o');
                }
            },
            
            // v10: Inicializar pool de categorias profissionais com valores padrÃ£o
            inicializarCategorias() {
                if (!SistemaCore.dados.estabelecimento.categoriasProfissionais) {
                    SistemaCore.dados.estabelecimento.categoriasProfissionais = [];
                }
                
                if (SistemaCore.dados.estabelecimento.categoriasProfissionais.length === 0) {
                    // Formato: "valor|emoji"
                    SistemaCore.dados.estabelecimento.categoriasProfissionais = [
                        'medico|ğŸ‘¨â€âš•ï¸',
                        'enfermeiro|ğŸ©º',
                        'assistente_social|ğŸ¤',
                        'fisioterapeuta|ğŸƒ',
                        'psicologo|ğŸ§ ',
                        'nutricionista|ğŸ¥—',
                        'farmaceutico|ğŸ’Š',
                        'administrativo|ğŸ“‹',
                        'recepcionista|ğŸ“'
                    ];
                    SistemaCore.salvar();
                    console.log('âœ… Pool de categorias profissionais inicializado');
                }
            },
            
            // v10: Inicializar pool de convÃªnios com valores padrÃ£o
            inicializarConvenios() {
                if (!SistemaCore.dados.estabelecimento.convenios) {
                    SistemaCore.dados.estabelecimento.convenios = [];
                }
                
                if (SistemaCore.dados.estabelecimento.convenios.length === 0) {
                    SistemaCore.dados.estabelecimento.convenios = [
                        'Unimed',
                        'Amil',
                        'Bradesco SaÃºde',
                        'SulAmÃ©rica',
                        'NotreDame IntermÃ©dica',
                        'Hapvida',
                        'SUS',
                        'Outro'
                    ];
                    SistemaCore.salvar();
                    console.log('âœ… Pool de convÃªnios inicializado com valores padrÃ£o');
                }
            },
            
            // v10.39: Inicializar pool de regionais de saÃºde com valores padrÃ£o
            inicializarRegionais() {
                if (!SistemaCore.dados.estabelecimento.regionaisSaude) {
                    SistemaCore.dados.estabelecimento.regionaisSaude = [];
                }
                
                if (SistemaCore.dados.estabelecimento.regionaisSaude.length === 0) {
                    SistemaCore.dados.estabelecimento.regionaisSaude = [
                        'Regional Centro',
                        'Regional Norte',
                        'Regional Sul',
                        'Regional Leste',
                        'Regional Oeste',
                        'Regional Nordeste',
                        'Regional Noroeste',
                        'Regional Venda Nova',
                        'Regional Barreiro'
                    ];
                    SistemaCore.salvar();
                    console.log('âœ… Pool de regionais de saÃºde inicializado com valores padrÃ£o');
                }
            },

            renderPool(chave, titulo, itens) {
                // v10.82: DROPDOWN CLÃSSICO (em vez de badges)
                // v10.2: ORDENAÃ‡ÃƒO ALFABÃ‰TICA
                // Criar cÃ³pia ordenada dos itens (nÃ£o modifica original)
                const itensOrdenados = [...itens].sort((a, b) => {
                    // Para categorias, ordenar pelo nome formatado (apÃ³s o |)
                    if (chave === 'categorias_profissionais' && a.includes('|') && b.includes('|')) {
                        const nomeA = a.split('|')[0];
                        const nomeB = b.split('|')[0];
                        return nomeA.localeCompare(nomeB, 'pt-BR');
                    }
                    // Para outros pools, ordenaÃ§Ã£o alfabÃ©tica normal
                    return a.localeCompare(b, 'pt-BR');
                });
                
                // Criar mapa: item ordenado â†’ Ã­ndice original
                const indiceMap = new Map();
                itensOrdenados.forEach(itemOrdenado => {
                    const indiceOriginal = itens.indexOf(itemOrdenado);
                    indiceMap.set(itemOrdenado, indiceOriginal);
                });
                
                // v10: DescriÃ§Ãµes atualizadas
                const descricoes = {
                    'nomes_sugeridos': 'Usado em: Nomes das Unidades',
                    'especialidades': 'Usado em: Profissionais e Unidades (especialidades permitidas)',
                    'categorias_profissionais': 'Tipos de profissionais (aparece no select "Categoria Profissional")',
                    'cargos': 'Cargo/funÃ§Ã£o do profissional (ex: Diretor, Coordenador)',
                    'convenios': 'ConvÃªnios e planos de saÃºde dos pacientes',
                    'pavilhoes': 'Blocos/Alas da estrutura fÃ­sica',
                    'andares': 'Andares/Pisos da estrutura fÃ­sica',
                    'setores': 'Enfermarias/Setores de organizaÃ§Ã£o interna',
                    // v10.13.0: Eventos ClÃ­nicos e ProntuÃ¡rio Estruturado
                    'procedimentos': 'Procedimentos cirÃºrgicos e intervenÃ§Ãµes realizadas',
                    'antibioticos': 'AntibiÃ³ticos disponÃ­veis para prescriÃ§Ã£o',
                    'locaisInternacao': 'Locais onde pacientes podem ser internados',
                    'alergias': 'Alergias medicamentosas e de contato comuns',
                    'cirurgiasPregressas': 'Cirurgias anteriores do histÃ³rico do paciente',
                    'medicacoes': 'Medicamentos de uso contÃ­nuo',
                    'expectativas': 'Expectativas e objetivos do paciente com o tratamento',
                    'doencasCronicas': 'DoenÃ§as crÃ´nicas e comorbidades',
                    'drogas': 'Drogas e substÃ¢ncias ilÃ­citas',
                    'atividadesFisicas': 'Tipos de atividades fÃ­sicas praticadas'
                };
                
                // v10.82: DROPDOWN CLÃSSICO
                let html = `
                    <div class="card" style="margin-bottom: 0; height: 100%; display: flex; flex-direction: column;">
                        <div style="margin-bottom: 12px;">
                            <h3 style="margin: 0 0 4px 0; font-size: 16px;">${titulo}</h3>
                            <small style="color: #64748b; font-size: 11px; display: block;">
                                ${descricoes[chave] || ''} <span style="color: #10b981;">â€¢ Ordenado alfabeticamente</span>
                            </small>
                        </div>
                        
                        <!-- DROPDOWN PARA EDITAR/DELETAR -->
                        <div style="margin-bottom: 12px; flex: 1; display: flex; flex-direction: column; gap: 8px;">
                            <select class="form-control" id="pool-${chave}-select" 
                                    style="font-size: 13px; flex: 1; min-height: 120px;"
                                    size="8">
                                <option value="" disabled selected style="color: #94a3b8; font-style: italic;">
                                    ${itensOrdenados.length === 0 ? 'Nenhum item cadastrado' : 'Selecione um item para editar/deletar...'}
                                </option>
                `;

                if (itensOrdenados.length > 0) {
                    itensOrdenados.forEach((item) => {
                        const idx = indiceMap.get(item); // Pega Ã­ndice original
                        const uso = this.contarUso(chave, item);
                        const label = uso > 0 ? `${item} (usado em ${uso})` : item;
                        html += `
                                <option value="${idx}" title="${item}${uso > 0 ? ' - Usado em ' + uso + ' registro(s)' : ''}">
                                    ${label}
                                </option>
                        `;
                    });
                }

                html += `
                            </select>
                            
                            <!-- BOTÃ•ES EDITAR/DELETAR -->
                            <div style="display: flex; gap: 6px;">
                                <button class="btn btn-warning" 
                                        onclick="Pools.editarItemDropdown('${chave}')"
                                        style="padding: 6px 12px; font-size: 13px; white-space: nowrap; flex: 1;">
                                    âœï¸ Editar Selecionado
                                </button>
                                <button class="btn btn-danger" 
                                        onclick="Pools.removerItemDropdown('${chave}')"
                                        style="padding: 6px 12px; font-size: 13px; white-space: nowrap; flex: 1;">
                                    ğŸ—‘ï¸ Deletar Selecionado
                                </button>
                            </div>
                        </div>
                        
                        <!-- INPUT ADICIONAR -->
                        <div style="display: flex; gap: 6px; margin-top: auto; padding-top: 12px; border-top: 1px solid #e2e8f0;">
                            <input type="text" class="form-control" id="pool-${chave}-input" 
                                   placeholder="Novo item..." 
                                   onkeypress="if(event.key==='Enter') Pools.adicionarItem('${chave}')"
                                   style="font-size: 13px; padding: 6px 10px;">
                            <button class="btn btn-primary" onclick="Pools.adicionarItem('${chave}')"
                                    style="padding: 6px 12px; font-size: 13px; white-space: nowrap;">
                                â• Adicionar
                            </button>
                        </div>
                    </div>
                `;

                return html;
            },

            adicionarItem(chave) {
                const input = document.getElementById(`pool-${chave}-input`);
                const valor = input.value.trim();

                if (!valor) {
                    alert('âŒ Digite um valor!');
                    return;
                }

                // v10.53: Determinar onde salvar baseado na chave
                // motivosAtendimento removido - Ã© pool clÃ­nico, nÃ£o estrutural
                const poolsEstabelecimento = ['pavilhoes', 'andares', 'setores', 'especialidades', 'categorias_profissionais', 'cargos', 'convenios', 'regionaisSaude', 'tiposAtendimento'];
                const isPoolEstabelecimento = poolsEstabelecimento.includes(chave);
                
                // Mapear chave se necessÃ¡rio
                const chaveReal = chave === 'categorias_profissionais' ? 'categoriasProfissionais' : chave;
                
                // Obter array correto
                let arrayDestino;
                if (isPoolEstabelecimento) {
                    if (!SistemaCore.dados.estabelecimento[chaveReal]) {
                        SistemaCore.dados.estabelecimento[chaveReal] = [];
                    }
                    arrayDestino = SistemaCore.dados.estabelecimento[chaveReal];
                } else {
                    if (!SistemaCore.dados.pools[chave]) {
                        SistemaCore.dados.pools[chave] = [];
                    }
                    arrayDestino = SistemaCore.dados.pools[chave];
                }

                // v8.0.26: ComparaÃ§Ã£o case-insensitive para evitar duplicatas
                const valorLower = valor.toLowerCase();
                const jÃ¡Existe = arrayDestino.some(item => 
                    item.toLowerCase() === valorLower
                );

                if (jÃ¡Existe) {
                    alert('âš ï¸ Este item jÃ¡ existe!');
                    return;
                }

                arrayDestino.push(valor);
                SistemaCore.salvar();
                
                input.value = '';
                Sistema.notificar('âœ… Item adicionado com sucesso!');
                this.listar();
            },

            editarItem(chave, indice) {
                // v10.53: Determinar onde ler/salvar baseado na chave
                // motivosAtendimento removido - Ã© pool clÃ­nico, nÃ£o estrutural
                const poolsEstabelecimento = ['pavilhoes', 'andares', 'setores', 'especialidades', 'categorias_profissionais', 'cargos', 'convenios', 'regionaisSaude', 'tiposAtendimento'];
                const isPoolEstabelecimento = poolsEstabelecimento.includes(chave);
                const chaveReal = chave === 'categorias_profissionais' ? 'categoriasProfissionais' : chave;
                
                // Obter array correto
                const arrayDestino = isPoolEstabelecimento 
                    ? SistemaCore.dados.estabelecimento[chaveReal]
                    : SistemaCore.dados.pools[chave];
                
                const valorAtual = arrayDestino[indice];
                const novoValor = prompt(`âœï¸ Editar item:\n\nValor atual: ${valorAtual}\n\nDigite o novo valor:`, valorAtual);
                
                if (!novoValor || novoValor.trim() === '') {
                    return;
                }
                
                const novoValorTrim = novoValor.trim();
                
                if (novoValorTrim === valorAtual) {
                    return;
                }
                
                if (arrayDestino.includes(novoValorTrim)) {
                    alert('âŒ Este valor jÃ¡ existe no pool!');
                    return;
                }
                
                const uso = this.contarUso(chave, valorAtual);
                
                if (uso > 0) {
                    const confirmar = confirm(`âš ï¸ ATENÃ‡ÃƒO!\n\nEste item estÃ¡ sendo usado em ${uso} registro(s).\n\nDeseja atualizar todas as referÃªncias?\n\n"${valorAtual}" â†’ "${novoValorTrim}"\n\nâœ… OK = Atualizar tudo\nâŒ Cancelar = NÃ£o fazer nada`);
                    
                    if (!confirmar) {
                        return;
                    }
                    
                    this.atualizarReferencias(chave, valorAtual, novoValorTrim);
                }
                
                arrayDestino[indice] = novoValorTrim;
                SistemaCore.salvar();
                
                Sistema.notificar('âœ… Item atualizado com sucesso!');
                this.listar();
                
                // Atualizar listagens se necessÃ¡rio
                if (uso > 0 && typeof Reparticoes !== 'undefined' && Reparticoes.listar) {
                    Reparticoes.listar();
                }
            },

            removerItem(chave, indice) {
                // v10.53: Determinar onde ler/salvar baseado na chave
                // motivosAtendimento removido - Ã© pool clÃ­nico, nÃ£o estrutural
                const poolsEstabelecimento = ['pavilhoes', 'andares', 'setores', 'especialidades', 'categorias_profissionais', 'cargos', 'convenios', 'regionaisSaude', 'tiposAtendimento'];
                const isPoolEstabelecimento = poolsEstabelecimento.includes(chave);
                const chaveReal = chave === 'categorias_profissionais' ? 'categoriasProfissionais' : chave;
                
                // Obter array correto
                const arrayDestino = isPoolEstabelecimento 
                    ? SistemaCore.dados.estabelecimento[chaveReal]
                    : SistemaCore.dados.pools[chave];
                
                const item = arrayDestino[indice];
                const uso = this.contarUso(chave, item);
                
                if (uso > 0) {
                    alert(`âŒ IMPOSSÃVEL REMOVER!\n\nEste item estÃ¡ sendo usado em ${uso} registro(s).\n\nPara remover:\n1. Primeiro edite os registros que usam "${item}"\n2. Depois volte aqui para remover`);
                    return;
                }
                
                if (confirm(`âš ï¸ Tem certeza que deseja remover?\n\n"${item}"`)) {
                    arrayDestino.splice(indice, 1);
                    SistemaCore.salvar();
                    Sistema.notificar('âœ… Item removido com sucesso!');
                    this.listar();
                }
            },

            // v10.82: Novas funÃ§Ãµes para trabalhar com dropdown
            editarItemDropdown(chave) {
                const select = document.getElementById(`pool-${chave}-select`);
                const indice = parseInt(select.value);
                
                if (!select.value || isNaN(indice)) {
                    alert('âš ï¸ Selecione um item da lista primeiro!');
                    return;
                }
                
                // Chamar funÃ§Ã£o original com Ã­ndice
                this.editarItem(chave, indice);
                
                // Resetar select apÃ³s ediÃ§Ã£o
                setTimeout(() => {
                    select.selectedIndex = 0;
                }, 100);
            },

            removerItemDropdown(chave) {
                const select = document.getElementById(`pool-${chave}-select`);
                const indice = parseInt(select.value);
                
                if (!select.value || isNaN(indice)) {
                    alert('âš ï¸ Selecione um item da lista primeiro!');
                    return;
                }
                
                // Chamar funÃ§Ã£o original com Ã­ndice
                this.removerItem(chave, indice);
                
                // Resetar select apÃ³s remoÃ§Ã£o
                setTimeout(() => {
                    select.selectedIndex = 0;
                }, 100);
            },

            contarUso(chave, valor) {
                let contador = 0;
                
                // Verificar em repartiÃ§Ãµes (v6.8.2)
                if (SistemaCore.dados.reparticoes) {
                    SistemaCore.dados.reparticoes.forEach(r => {
                        if (chave === 'pavilhoes' && r.pavilhao === valor) contador++;
                        if (chave === 'andares' && r.andar === valor) contador++;
                        if (chave === 'setores' && r.setor === valor) contador++;
                        if (chave === 'nomes_sugeridos' && r.nome === valor) contador++;
                        
                        // v9.8.2: Contar especialidades em repartiÃ§Ãµes
                        if (chave === 'especialidades' && r.especialidades) {
                            const espList = typeof r.especialidades === 'string' 
                                ? r.especialidades.split('|') 
                                : r.especialidades;
                            if (espList.includes(valor)) contador++;
                        }
                    });
                }
                
                // Verificar em profissionais
                if (SistemaCore.dados.profissionais) {
                    if (chave === 'cargos') {
                        SistemaCore.dados.profissionais.forEach(p => {
                            if (p.cargo === valor) contador++;
                        });
                    }
                    // v9.8.2: Contar em todos os campos de especialidade
                    if (chave === 'especialidades') {
                        SistemaCore.dados.profissionais.forEach(p => {
                            if (p.especialidade === valor) contador++;
                            if (p.especialidade_principal === valor) contador++;
                            if (p.especialidades && Array.isArray(p.especialidades) && p.especialidades.includes(valor)) {
                                contador++;
                            }
                        });
                    }
                }
                
                // Verificar em pacientes
                if (SistemaCore.dados.pacientes && chave === 'convenios') {
                    SistemaCore.dados.pacientes.forEach(p => {
                        if (p.convenio === valor) contador++;
                    });
                }
                
                return contador;
            },

            atualizarReferencias(chave, valorAntigo, valorNovo) {
                // Atualizar repartiÃ§Ãµes
                if (SistemaCore.dados.reparticoes) {
                    SistemaCore.dados.reparticoes.forEach(r => {
                        if (chave === 'pavilhoes' && r.pavilhao === valorAntigo) r.pavilhao = valorNovo;
                        if (chave === 'andares' && r.andar === valorAntigo) r.andar = valorNovo;
                        if (chave === 'setores' && r.setor === valorAntigo) r.setor = valorNovo;
                        if (chave === 'nomes_sugeridos' && r.nome === valorAntigo) r.nome = valorNovo;
                        
                        // v9.8.2: Atualizar especialidades em repartiÃ§Ãµes
                        if (chave === 'especialidades' && r.especialidades) {
                            const espList = typeof r.especialidades === 'string' 
                                ? r.especialidades.split('|') 
                                : r.especialidades;
                            const novaLista = espList.map(e => e === valorAntigo ? valorNovo : e);
                            r.especialidades = novaLista.join('|');
                        }
                    });
                }
                
                // Atualizar profissionais
                if (SistemaCore.dados.profissionais) {
                    SistemaCore.dados.profissionais.forEach(p => {
                        if (chave === 'cargos' && p.cargo === valorAntigo) p.cargo = valorNovo;
                        
                        // v9.8.2: Atualizar em todos os campos de especialidade
                        if (chave === 'especialidades') {
                            if (p.especialidade === valorAntigo) p.especialidade = valorNovo;
                            if (p.especialidade_principal === valorAntigo) p.especialidade_principal = valorNovo;
                            if (p.especialidades && Array.isArray(p.especialidades)) {
                                p.especialidades = p.especialidades.map(e => e === valorAntigo ? valorNovo : e);
                            }
                        }
                    });
                }
                
                // Atualizar pacientes
                if (SistemaCore.dados.pacientes && chave === 'convenios') {
                    SistemaCore.dados.pacientes.forEach(p => {
                        if (p.convenio === valorAntigo) p.convenio = valorNovo;
                    });
                }
                
                SistemaCore.salvar();
                // SistemaCore.log removido - funÃ§Ã£o nÃ£o existe
            }
        };

        /* ============================================================
           [MASCARAS] Sistema de MÃ¡scaras para Campos
           ============================================================ */
        
        const Mascaras = {
            // Aplicar mÃ¡scara de CPF
            cpf(valor) {
                valor = valor.replace(/\D/g, '');
                valor = valor.substring(0, 11);
                valor = valor.replace(/(\d{3})(\d)/, '$1.$2');
                valor = valor.replace(/(\d{3})(\d)/, '$1.$2');
                valor = valor.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                return valor;
            },

            // Aplicar mÃ¡scara de CNPJ
            cnpj(valor) {
                valor = valor.replace(/\D/g, '');
                valor = valor.substring(0, 14);
                valor = valor.replace(/(\d{2})(\d)/, '$1.$2');
                valor = valor.replace(/(\d{3})(\d)/, '$1.$2');
                valor = valor.replace(/(\d{3})(\d)/, '$1/$2');
                valor = valor.replace(/(\d{4})(\d{1,2})$/, '$1-$2');
                return valor;
            },

            // Aplicar mÃ¡scara de telefone/celular
            telefone(valor) {
                valor = valor.replace(/\D/g, '');
                valor = valor.substring(0, 11);
                if (valor.length <= 10) {
                    valor = valor.replace(/(\d{2})(\d)/, '($1) $2');
                    valor = valor.replace(/(\d{4})(\d{1,4})$/, '$1-$2');
                } else {
                    valor = valor.replace(/(\d{2})(\d)/, '($1) $2');
                    valor = valor.replace(/(\d{5})(\d{1,4})$/, '$1-$2');
                }
                return valor;
            },

            // Aplicar mÃ¡scara de CEP
            cep(valor) {
                valor = valor.replace(/\D/g, '');
                valor = valor.substring(0, 8);
                valor = valor.replace(/(\d{5})(\d{1,3})$/, '$1-$2');
                return valor;
            },

            // Aplicar mÃ¡scara de data
            data(valor) {
                valor = valor.replace(/\D/g, '');
                valor = valor.substring(0, 8);
                valor = valor.replace(/(\d{2})(\d)/, '$1/$2');
                valor = valor.replace(/(\d{2})(\d)/, '$1/$2');
                return valor;
            },

            // Aplicar mÃ¡scara de hora
            hora(valor) {
                valor = valor.replace(/\D/g, '');
                valor = valor.substring(0, 4);
                valor = valor.replace(/(\d{2})(\d{1,2})$/, '$1:$2');
                return valor;
            },

            // Aplicar mÃ¡scara de CRM/registro profissional
            crm(valor) {
                valor = valor.replace(/\D/g, '');
                valor = valor.substring(0, 10);
                return valor;
            },

            // âœ… v10.8: Aplicar mÃ¡scara de CNS (CartÃ£o Nacional de SaÃºde)
            cns(valor) {
                valor = valor.replace(/\D/g, '');
                valor = valor.substring(0, 15);
                // Formato: 000 0000 0000 0000
                valor = valor.replace(/(\d{3})(\d)/, '$1 $2');
                valor = valor.replace(/(\d{3}) (\d{4})(\d)/, '$1 $2 $3');
                valor = valor.replace(/(\d{3}) (\d{4}) (\d{4})(\d)/, '$1 $2 $3 $4');
                return valor;
            },

            // Inicializar mÃ¡scaras em todos os campos
            init() {
                // CPF
                const cpfInputs = ['estab-cpf', 'pac-cpf', 'prof-cpf'];
                cpfInputs.forEach(id => {
                    const input = document.getElementById(id);
                    if (input) {
                        input.addEventListener('input', (e) => {
                            e.target.value = this.cpf(e.target.value);
                        });
                    }
                });

                // CNPJ
                const cnpjInput = document.getElementById('estab-cnpj');
                if (cnpjInput) {
                    cnpjInput.addEventListener('input', (e) => {
                        e.target.value = this.cnpj(e.target.value);
                    });
                }

                // Telefones
                const telInputs = ['estab-telefone', 'estab-celular', 'pac-telefone', 'pac-celular', 'pac-telefone-emergencia', 'prof-telefone', 'prof-celular'];
                telInputs.forEach(id => {
                    const input = document.getElementById(id);
                    if (input) {
                        input.addEventListener('input', (e) => {
                            e.target.value = this.telefone(e.target.value);
                        });
                    }
                });

                // CEP
                const cepInputs = ['estab-cep', 'pac-cep', 'prof-cep'];
                cepInputs.forEach(id => {
                    const input = document.getElementById(id);
                    if (input) {
                        input.addEventListener('input', (e) => {
                            e.target.value = this.cep(e.target.value);
                        });
                    }
                });

                // âœ… v10.8: CNS
                const cnsInput = document.getElementById('pac-cns');
                if (cnsInput) {
                    cnsInput.addEventListener('input', (e) => {
                        e.target.value = this.cns(e.target.value);
                    });
                }

                // Data de nascimento
                const dataInputs = ['pac-data-nascimento'];
                dataInputs.forEach(id => {
                    const input = document.getElementById(id);
                    if (input && input.type !== 'date') {
                        input.addEventListener('input', (e) => {
                            e.target.value = this.data(e.target.value);
                        });
                    }
                });

                // CRM/Registro Profissional
                const crmInputs = ['estab-crm-rt', 'prof-registro'];
                crmInputs.forEach(id => {
                    const input = document.getElementById(id);
                    if (input) {
                        input.addEventListener('input', (e) => {
                            e.target.value = this.crm(e.target.value);
                        });
                    }
                });

                console.log('âœ… MÃ¡scaras aplicadas em todos os campos');
            }
        };

        /* ============================================================
           [INICIALIZACAO] InicializaÃ§Ã£o do Sistema
           ============================================================ */
        
        // v10.33: UTILITÃRIO - Ordenar todos os dropdowns alfabeticamente
        const OrdenarDropdowns = {
            // Lista de IDs que NÃƒO devem ser ordenados (ordem importa)
            excecoes: [
                'agend-tipo', 'atend-tipo-entrada', 'atend-local-entrada',
                'filtro-categoria', 'filtro-tipo-uso', 'filtro-status-reparticao'
            ],
            
            ordenarTodos() {
                console.log('ğŸ“‹ Ordenando todos os dropdowns alfabeticamente...');
                let contador = 0;
                
                // Buscar todos os selects da pÃ¡gina
                document.querySelectorAll('select').forEach(select => {
                    // Pular se estiver na lista de exceÃ§Ãµes
                    if (this.excecoes.includes(select.id)) {
                        console.log(`â­ï¸ Pulando "${select.id}" (ordem fixa)`);
                        return;
                    }
                    
                    // Pular se nÃ£o tiver options
                    if (select.options.length <= 1) return;
                    
                    this.ordenarSelect(select);
                    contador++;
                });
                
                console.log(`âœ… ${contador} dropdowns ordenados alfabeticamente!`);
            },
            
            ordenarSelect(select) {
                // Salvar primeira opÃ§Ã£o (geralmente "Selecione...")
                const primeiraOpcao = select.options[0];
                const preservarPrimeira = primeiraOpcao && 
                    (primeiraOpcao.value === '' || 
                     primeiraOpcao.text.toLowerCase().includes('selecione') ||
                     primeiraOpcao.text.toLowerCase().includes('todos'));
                
                // Pegar todas as options (exceto a primeira se for placeholder)
                const opcoes = Array.from(select.options).slice(preservarPrimeira ? 1 : 0);
                
                // Ordenar alfabeticamente pelo texto
                opcoes.sort((a, b) => {
                    const textoA = a.text.trim().toLowerCase();
                    const textoB = b.text.trim().toLowerCase();
                    return textoA.localeCompare(textoB, 'pt-BR');
                });
                
                // Limpar select
                select.innerHTML = '';
                
                // Readicionar primeira opÃ§Ã£o se preservada
                if (preservarPrimeira) {
                    select.appendChild(primeiraOpcao);
                }
                
                // Adicionar opÃ§Ãµes ordenadas
                opcoes.forEach(opcao => select.appendChild(opcao));
            }
        };
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // PRONTUÃRIO MODULAR - SISTEMA DE POOLS E CARDS DINÃ‚MICOS - v10.354
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const ProntuarioModular = {
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // POOLS DE DADOS
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            poolAlergias: [
                'Penicilina', 'Dipirona', 'AINEs (Ibuprofeno, Diclofenaco)', 'Sulfa',
                'LÃ¡tex', 'Contraste iodado', 'AnestÃ©sicos locais', 'Paracetamol',
                'Adesivos/Esparadrapo', 'Poeira', 'Ãcaro', 'Frutos do mar'
            ],
            
            poolDoencas: [
                'HipertensÃ£o Arterial (HAS)', 'Diabetes Mellitus', 'Dislipidemia',
                'Cardiopatias', 'Pneumopatias', 'Asma', 'DPOC', 'Nefropatias',
                'Hepatopatias', 'DistÃºrbios de CoagulaÃ§Ã£o', 'Tireopatias',
                'Hipotireoidismo', 'Hipertireoidismo', 'Obesidade', 'Refluxo'
            ],
            
            poolCirurgias: [
                'Cesariana', 'Apendicectomia', 'Colecistectomia', 'Herniorrafia',
                'Histerectomia', 'Mastectomia', 'Abdominoplastia', 'Mamoplastia',
                'Rinoplastia', 'LipoaspiraÃ§Ã£o', 'Artroscopia', 'Amigdalectomia'
            ],
            
            poolMedicacoes: [
                'Losartana', 'Enalapril', 'Hidroclorotiazida', 'AAS', 'Metformina',
                'Insulina', 'Sinvastatina', 'Atorvastatina', 'Omeprazol',
                'Levotiroxina', 'Fluoxetina', 'Sertralina'
            ],
            
            poolParentescos: [
                'Pai', 'MÃ£e', 'IrmÃ£o(Ã£)', 'Meio-irmÃ£o(Ã£) paterno', 'Meio-irmÃ£o(Ã£) materno',
                'AvÃ´ paterno', 'AvÃ³ paterna', 'AvÃ´ materno', 'AvÃ³ materna',
                'Tio(a) paterno(a)', 'Tio(a) materno(a)', 'Primo(a)',
                'Filho(a)', 'Neto(a)', 'Sobrinho(a)'
            ],
            
            poolDoencasFamiliares: [
                'HipertensÃ£o Arterial (HAS)', 'Diabetes Mellitus', 'Dislipidemia',
                'Infarto Agudo do MiocÃ¡rdio (IAM)', 'AVC / AVE', 'Arritmias',
                'CÃ¢ncer de mama', 'CÃ¢ncer de prÃ³stata', 'CÃ¢ncer colorretal',
                'CÃ¢ncer de pulmÃ£o', 'Outros cÃ¢nceres', 'DoenÃ§as Autoimunes',
                'LÃºpus', 'Artrite Reumatoide', 'Trombofilia', 'Alzheimer',
                'Parkinson', 'Epilepsia', 'Asma', 'DPOC', 'Obesidade',
                'DoenÃ§as Tireoidianas', 'Transtornos PsiquiÃ¡tricos', 'DepressÃ£o'
            ],
            
            poolAntibioticos: [
                'Amoxicilina 500mg', 'Amoxicilina + Clavulanato 875mg', 'Azitromicina 500mg',
                'Cefalexina 500mg', 'Cefuroxima 500mg', 'Ceftriaxona 1g', 'Ciprofloxacino 500mg',
                'Clindamicina 300mg', 'Levofloxacino 500mg', 'Metronidazol 400mg',
                'Sulfametoxazol + Trimetoprima', 'Doxiciclina 100mg', 'Norfloxacino 400mg'
            ],
            
            // Pool de MÃ³dulos do Exame EspecÃ­fico
            poolModulosExame: [
                'Mapa AnatÃ´mico', 'AvaliaÃ§Ã£o de Queimaduras', 'AvaliaÃ§Ã£o de Feridas',
                'Cardiovascular', 'RespiratÃ³rio', 'Abdominal', 'NeurolÃ³gico',
                'OrtopÃ©dico', 'Vascular PerifÃ©rico', 'DermatolÃ³gico',
                'OftalmolÃ³gico', 'OtorrinolaringolÃ³gico', 'Bucomaxilofacial'
            ],
            
            // MÃ³dulos de exame ativos
            modulosExameAtivos: [],
            
            // Templates dos mÃ³dulos de exame especÃ­fico
            templatesModulosExame: {
                'mapa-anatomico': {
                    titulo: 'ğŸ—ºï¸ Exame por RegiÃµes',
                    cor: '#8b5cf6',
                    html: `
                        <div style="background: #f5f3ff; padding: 15px; border-radius: 8px; border-left: 4px solid #8b5cf6; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ—ºï¸ Exame por RegiÃµes</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div style="background: white; padding: 15px; border-radius: 6px; text-align: center;">
                                    <p style="font-size: 11px; color: #666; margin: 0 0 10px 0;">Vista Anterior</p>
                                    <div style="width: 150px; height: 200px; background: #f0f0f0; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #999;">[Silhueta Anterior]</div>
                                </div>
                                <div style="background: white; padding: 15px; border-radius: 6px; text-align: center;">
                                    <p style="font-size: 11px; color: #666; margin: 0 0 10px 0;">Vista Posterior</p>
                                    <div style="width: 150px; height: 200px; background: #f0f0f0; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #999;">[Silhueta Posterior]</div>
                                </div>
                            </div>
                            <div style="margin-top: 12px;">
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o das lesÃµes marcadas:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Descreva localizaÃ§Ã£o e caracterÃ­sticas das lesÃµes..."></textarea>
                            </div>
                        </div>
                    `
                },
                'queimaduras': {
                    titulo: 'ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras',
                    cor: '#ef4444',
                    html: `
                        <div style="background: #fef2f2; padding: 15px; border-radius: 8px; border-left: 4px solid #ef4444; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">MÃ©todo de CÃ¡lculo:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                        <option>Regra dos 9 (Wallace)</option>
                                        <option>Lund-Browder (pediÃ¡trico)</option>
                                        <option>Palma da mÃ£o (1%)</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">SCQ Total (%):</label>
                                    <input type="number" min="0" max="100" placeholder="%" style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px; font-size: 16px; font-weight: bold; text-align: center;">
                                </div>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                                <div style="background: white; padding: 10px; border-radius: 6px; text-align: center;">
                                    <div style="font-size: 11px; color: #666;">1Âº Grau</div>
                                    <input type="number" min="0" max="100" placeholder="%" style="width: 60px; padding: 6px; border: 1px solid #fca5a5; border-radius: 4px; text-align: center; margin-top: 4px;">
                                </div>
                                <div style="background: white; padding: 10px; border-radius: 6px; text-align: center;">
                                    <div style="font-size: 11px; color: #666;">2Âº Grau</div>
                                    <input type="number" min="0" max="100" placeholder="%" style="width: 60px; padding: 6px; border: 1px solid #fca5a5; border-radius: 4px; text-align: center; margin-top: 4px;">
                                </div>
                                <div style="background: white; padding: 10px; border-radius: 6px; text-align: center;">
                                    <div style="font-size: 11px; color: #666;">3Âº Grau</div>
                                    <input type="number" min="0" max="100" placeholder="%" style="width: 60px; padding: 6px; border: 1px solid #fca5a5; border-radius: 4px; text-align: center; margin-top: 4px;">
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">Agente causador e descriÃ§Ã£o:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Ex: Escaldadura por Ã¡gua quente, acometendo face anterior de tÃ³rax e MMSS..."></textarea>
                            </div>
                        </div>
                    `
                },
                'feridas': {
                    titulo: 'ğŸ©¹ AvaliaÃ§Ã£o de Feridas',
                    cor: '#f59e0b',
                    html: `
                        <div style="background: #fffbeb; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #d97706; font-size: 14px;">ğŸ©¹ AvaliaÃ§Ã£o de Feridas</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">Tipo:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px;">
                                        <option>Incisa</option>
                                        <option>Contusa</option>
                                        <option>Lacerada</option>
                                        <option>Perfurante</option>
                                        <option>AvulsÃ£o</option>
                                        <option>AbrasÃ£o</option>
                                        <option>Ãšlcera</option>
                                        <option>DeiscÃªncia</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">DimensÃµes (cm):</label>
                                    <input type="text" placeholder="Ex: 5x3x1" style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px;">
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Leito:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px;">
                                        <option>GranulaÃ§Ã£o</option>
                                        <option>EpitelizaÃ§Ã£o</option>
                                        <option>Necrose</option>
                                        <option>Esfacelo</option>
                                        <option>Misto</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o detalhada:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #fcd34d; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="LocalizaÃ§Ã£o, bordas, exsudato, sinais de infecÃ§Ã£o..."></textarea>
                            </div>
                        </div>
                    `
                },
                'cardiovascular': {
                    titulo: 'ğŸ«€ Exame Cardiovascular',
                    cor: '#dc2626',
                    html: `
                        <div style="background: #fef2f2; padding: 15px; border-radius: 8px; border-left: 4px solid #dc2626; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸ«€ Exame Cardiovascular</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">Ritmo:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                        <option>Regular, 2 tempos</option>
                                        <option>Regular, 3 tempos (B3)</option>
                                        <option>Regular, 3 tempos (B4)</option>
                                        <option>Irregular</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Bulhas:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                        <option>NormofonÃ©ticas</option>
                                        <option>HipofonÃ©ticas</option>
                                        <option>HiperfonÃ©ticas</option>
                                    </select>
                                </div>
                            </div>
                            <div style="margin-bottom: 12px;">
                                <label style="font-size: 11px; color: #666;">Sopros:</label>
                                <input type="text" placeholder="Descrever foco, intensidade, irradiaÃ§Ã£o..." style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Pulsos perifÃ©ricos, estase jugular, edema..."></textarea>
                            </div>
                        </div>
                    `
                },
                'respiratorio': {
                    titulo: 'ğŸ« Exame RespiratÃ³rio',
                    cor: '#0ea5e9',
                    html: `
                        <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border-left: 4px solid #0ea5e9; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #0284c7; font-size: 14px;">ğŸ« Exame RespiratÃ³rio</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">MurmÃºrio Vesicular:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px;">
                                        <option>Presente bilateral, simÃ©trico</option>
                                        <option>DiminuÃ­do Ã  direita</option>
                                        <option>DiminuÃ­do Ã  esquerda</option>
                                        <option>DiminuÃ­do bilateral</option>
                                        <option>Abolido Ã  direita</option>
                                        <option>Abolido Ã  esquerda</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">RuÃ­dos AdventÃ­cios:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px;">
                                        <option>Ausentes</option>
                                        <option>Estertores crepitantes</option>
                                        <option>Estertores bolhosos</option>
                                        <option>Sibilos</option>
                                        <option>Roncos</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Expansibilidade, percussÃ£o, tiragem, uso de musculatura acessÃ³ria..."></textarea>
                            </div>
                        </div>
                    `
                },
                'abdominal': {
                    titulo: 'ğŸ©º Exame Abdominal',
                    cor: '#22c55e',
                    html: `
                        <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; border-left: 4px solid #22c55e; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #16a34a; font-size: 14px;">ğŸ©º Exame Abdominal</h5>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">InspeÃ§Ã£o:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                        <option>Plano</option>
                                        <option>Globoso</option>
                                        <option>Escavado</option>
                                        <option>Distendido</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">RHA:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                        <option>Presentes</option>
                                        <option>Aumentados</option>
                                        <option>DiminuÃ­dos</option>
                                        <option>Ausentes</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">PalpaÃ§Ã£o:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                        <option>FlÃ¡cido, indolor</option>
                                        <option>Tenso</option>
                                        <option>Doloroso difuso</option>
                                        <option>Doloroso localizado</option>
                                        <option>Defesa</option>
                                        <option>DescompressÃ£o +</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Visceromegalias:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px;">
                                        <option>Ausentes</option>
                                        <option>Hepatomegalia</option>
                                        <option>Esplenomegalia</option>
                                        <option>Ambas</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Massas, hÃ©rnias, cicatrizes, sinais de irritaÃ§Ã£o peritoneal..."></textarea>
                            </div>
                        </div>
                    `
                },
                'neurologico': {
                    titulo: 'ğŸ§  Exame NeurolÃ³gico',
                    cor: '#a855f7',
                    html: `
                        <div style="background: #faf5ff; padding: 15px; border-radius: 8px; border-left: 4px solid #a855f7; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #9333ea; font-size: 14px;">ğŸ§  Exame NeurolÃ³gico</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">NÃ­vel de consciÃªncia:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                        <option>Alerta, orientado</option>
                                        <option>Sonolento</option>
                                        <option>Torporoso</option>
                                        <option>Comatoso</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Pupilas:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                        <option>IsocÃ³ricas, fotorreagentes</option>
                                        <option>AnisocÃ³ricas</option>
                                        <option>MidrÃ­ase bilateral</option>
                                        <option>Miose bilateral</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">ForÃ§a muscular:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                        <option>Preservada (grau V)</option>
                                        <option>DiminuÃ­da</option>
                                        <option>Hemiparesia D</option>
                                        <option>Hemiparesia E</option>
                                        <option>Paraparesia</option>
                                        <option>Tetraparesia</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Reflexos, sensibilidade, coordenaÃ§Ã£o, marcha, sinais menÃ­ngeos..."></textarea>
                            </div>
                        </div>
                    `
                },
                'ortopedico': {
                    titulo: 'ğŸ¦´ Exame OrtopÃ©dico',
                    cor: '#78716c',
                    html: `
                        <div style="background: #fafaf9; padding: 15px; border-radius: 8px; border-left: 4px solid #78716c; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #57534e; font-size: 14px;">ğŸ¦´ Exame OrtopÃ©dico</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">RegiÃ£o acometida:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px;">
                                        <option>Coluna cervical</option>
                                        <option>Coluna torÃ¡cica</option>
                                        <option>Coluna lombar</option>
                                        <option>Ombro</option>
                                        <option>Cotovelo</option>
                                        <option>Punho/MÃ£o</option>
                                        <option>Quadril</option>
                                        <option>Joelho</option>
                                        <option>Tornozelo/PÃ©</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Lateralidade:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px;">
                                        <option>Direito</option>
                                        <option>Esquerdo</option>
                                        <option>Bilateral</option>
                                        <option>Linha mÃ©dia</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o do exame:</label>
                                <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="InspeÃ§Ã£o (edema, deformidade, equimose), palpaÃ§Ã£o, amplitude de movimento, testes especiais, avaliaÃ§Ã£o neurovascular distal..."></textarea>
                            </div>
                        </div>
                    `
                },
                'vascular': {
                    titulo: 'ğŸ©¸ Exame Vascular PerifÃ©rico',
                    cor: '#be123c',
                    html: `
                        <div style="background: #fff1f2; padding: 15px; border-radius: 8px; border-left: 4px solid #be123c; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #be123c; font-size: 14px;">ğŸ©¸ Exame Vascular PerifÃ©rico</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">Pulsos perifÃ©ricos:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                        <option>Presentes e simÃ©tricos</option>
                                        <option>DiminuÃ­dos</option>
                                        <option>Ausentes Ã  direita</option>
                                        <option>Ausentes Ã  esquerda</option>
                                        <option>Ausentes bilateral</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">PerfusÃ£o:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                        <option>Adequada (TEC < 3s)</option>
                                        <option>Lentificada (TEC 3-5s)</option>
                                        <option>Muito lenta (TEC > 5s)</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Edema, varizes, Ãºlceras, alteraÃ§Ãµes de cor/temperatura, ITB..."></textarea>
                            </div>
                        </div>
                    `
                },
                'dermatologico': {
                    titulo: 'ğŸ”¬ Exame DermatolÃ³gico',
                    cor: '#ec4899',
                    html: `
                        <div style="background: #fdf2f8; padding: 15px; border-radius: 8px; border-left: 4px solid #ec4899; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #db2777; font-size: 14px;">ğŸ”¬ Exame DermatolÃ³gico</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">LesÃ£o elementar:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                        <option>MÃ¡cula</option>
                                        <option>PÃ¡pula</option>
                                        <option>Placa</option>
                                        <option>NÃ³dulo</option>
                                        <option>VesÃ­cula</option>
                                        <option>Bolha</option>
                                        <option>PÃºstula</option>
                                        <option>Ãšlcera</option>
                                        <option>ErosÃ£o</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">DistribuiÃ§Ã£o:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                        <option>Localizada</option>
                                        <option>Disseminada</option>
                                        <option>Generalizada</option>
                                        <option>Ãreas fotoexpostas</option>
                                        <option>Ãreas intertriginosas</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o detalhada:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Cor, tamanho, bordas, superfÃ­cie, anexos cutÃ¢neos..."></textarea>
                            </div>
                        </div>
                    `
                },
                'oftalmologico': {
                    titulo: 'ğŸ‘ï¸ Exame OftalmolÃ³gico',
                    cor: '#0891b2',
                    html: `
                        <div style="background: #ecfeff; padding: 15px; border-radius: 8px; border-left: 4px solid #0891b2; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #0e7490; font-size: 14px;">ğŸ‘ï¸ Exame OftalmolÃ³gico</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">AV OD:</label>
                                    <input type="text" placeholder="20/20" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">AV OE:</label>
                                    <input type="text" placeholder="20/20" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Reflexos pupilares:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                        <option>Preservados</option>
                                        <option>Alterados</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Biomicroscopia, fundoscopia, motilidade ocular extrÃ­nseca..."></textarea>
                            </div>
                        </div>
                    `
                },
                'otorrino': {
                    titulo: 'ğŸ‘‚ Exame OtorrinolaringolÃ³gico',
                    cor: '#7c3aed',
                    html: `
                        <div style="background: #f5f3ff; padding: 15px; border-radius: 8px; border-left: 4px solid #7c3aed; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ‘‚ Exame OtorrinolaringolÃ³gico</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">Otoscopia:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                        <option>Normal bilateral</option>
                                        <option>Hiperemia OD</option>
                                        <option>Hiperemia OE</option>
                                        <option>Cerume</option>
                                        <option>PerfuraÃ§Ã£o</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Rinoscopia:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                        <option>Normal</option>
                                        <option>Hiperemia</option>
                                        <option>Edema</option>
                                        <option>Desvio septal</option>
                                        <option>PÃ³lipos</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Orofaringe:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                        <option>Normal</option>
                                        <option>Hiperemia</option>
                                        <option>Hipertrofia amÃ­gdalas</option>
                                        <option>Exsudato</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Acumetria, palpaÃ§Ã£o cervical, laringoscopia..."></textarea>
                            </div>
                        </div>
                    `
                },
                'bucomaxilo': {
                    titulo: 'ğŸ¦· Exame Bucomaxilofacial',
                    cor: '#059669',
                    html: `
                        <div style="background: #ecfdf5; padding: 15px; border-radius: 8px; border-left: 4px solid #059669; margin-bottom: 15px;">
                            <h5 style="margin: 0 0 12px 0; color: #047857; font-size: 14px;">ğŸ¦· Exame Bucomaxilofacial</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">Abertura bucal:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px;">
                                        <option>Normal (> 40mm)</option>
                                        <option>Limitada (20-40mm)</option>
                                        <option>Muito limitada (< 20mm)</option>
                                        <option>Trismo</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">ATM:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px;">
                                        <option>Sem alteraÃ§Ãµes</option>
                                        <option>Estalido</option>
                                        <option>CrepitaÃ§Ã£o</option>
                                        <option>Dor Ã  palpaÃ§Ã£o</option>
                                        <option>LuxaÃ§Ã£o</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Face, oclusÃ£o dentÃ¡ria, mucosa oral, glÃ¢ndulas salivares, fraturas..."></textarea>
                            </div>
                        </div>
                    `
                }
            },
            
            // Contadores e Arrays
            alergias: [],
            contadorAlergias: 0,
            doencas: [],
            contadorDoencas: 0,
            cirurgias: [],
            contadorCirurgias: 0,
            medicacoes: [],
            contadorMedicacoes: 0,
            familiares: [],
            contadorFamiliares: 0,
            doencasPorFamiliar: {},
            atividades: [],
            contadorAtividades: 0,
            drogas: [],
            contadorDrogas: 0,
            tabacos: [],
            contadorTabacos: 0,
            bebidas: [],
            contadorBebidas: 0,
            
            // Controle Hospitalar - Arrays e Contadores
            listaDPO: [],
            contadorDPO: 0,
            listaATB: [],
            contadorATB: 0,
            listaATBSusp: [],
            contadorATBSusp: 0,
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // INICIALIZAÃ‡ÃƒO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            init: function() {
                // Carregar pools do localStorage se existirem
                const savedAlergias = localStorage.getItem('prontuario_poolAlergias');
                if (savedAlergias) this.poolAlergias = JSON.parse(savedAlergias);
                
                const savedDoencas = localStorage.getItem('prontuario_poolDoencas');
                if (savedDoencas) this.poolDoencas = JSON.parse(savedDoencas);
                
                const savedCirurgias = localStorage.getItem('prontuario_poolCirurgias');
                if (savedCirurgias) this.poolCirurgias = JSON.parse(savedCirurgias);
                
                const savedMedicacoes = localStorage.getItem('prontuario_poolMedicacoes');
                if (savedMedicacoes) this.poolMedicacoes = JSON.parse(savedMedicacoes);
                
                const savedParentescos = localStorage.getItem('prontuario_poolParentescos');
                if (savedParentescos) this.poolParentescos = JSON.parse(savedParentescos);
                
                const savedDoencasFam = localStorage.getItem('prontuario_poolDoencasFamiliares');
                if (savedDoencasFam) this.poolDoencasFamiliares = JSON.parse(savedDoencasFam);
                
                const savedAntibioticos = localStorage.getItem('prontuario_poolAntibioticos');
                if (savedAntibioticos) this.poolAntibioticos = JSON.parse(savedAntibioticos);
                
                // Observer para carregar Controle Hospitalar quando os containers existirem
                const self = this;
                const observer = new MutationObserver(function(mutations) {
                    if (document.getElementById('pront-listaDPO') || document.getElementById('pront-listaATB') || document.getElementById('pront-listaATBSusp')) {
                        setTimeout(() => self.carregarControleHospitalar(), 100);
                        observer.disconnect();
                    }
                });
                observer.observe(document.body, { childList: true, subtree: true });
                
                console.log('âœ… ProntuarioModular inicializado');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // TOGGLE CAMPOS CONDICIONAIS
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            toggleCampo: function(campoId, mostrar) {
                const campo = document.getElementById(campoId);
                if (campo) {
                    campo.style.display = mostrar ? 'block' : 'none';
                }
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // EXAME ESPECÃFICO - SISTEMA ESCALÃVEL v10.356
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            // Categorias de painel abertas
            categoriasAbertas: { mapeamento: false, sistemas: false, especialidades: false },
            
            // Toggle categoria (abre/fecha painel)
            toggleCategoriaExame: function(categoria) {
                const painel = document.getElementById('painel-cat-' + categoria);
                const btn = document.getElementById('btn-cat-' + categoria);
                if (!painel || !btn) return;
                
                const cores = {
                    mapeamento: '#8b5cf6',
                    sistemas: '#3b82f6',
                    especialidades: '#22c55e'
                };
                
                this.categoriasAbertas[categoria] = !this.categoriasAbertas[categoria];
                
                if (this.categoriasAbertas[categoria]) {
                    painel.style.display = 'block';
                    btn.style.background = cores[categoria];
                    btn.style.color = 'white';
                } else {
                    painel.style.display = 'none';
                    btn.style.background = 'white';
                    btn.style.color = cores[categoria];
                }
            },
            
            // Toggle mÃ³dulo de exame
            toggleModuloExame: function(moduloId, ativo) {
                const area = document.getElementById('pront-area-modulos-exame');
                if (!area) return;
                
                if (ativo) {
                    if (!this.modulosExameAtivos.includes(moduloId)) {
                        this.modulosExameAtivos.push(moduloId);
                    }
                } else {
                    this.modulosExameAtivos = this.modulosExameAtivos.filter(m => m !== moduloId);
                }
                
                this.renderizarModulosExame();
            },
            
            // Renderizar mÃ³dulos (ORDEM FIXA: map â†’ sis â†’ esp)
            renderizarModulosExame: function() {
                const area = document.getElementById('pront-area-modulos-exame');
                if (!area) return;
                
                area.innerHTML = '';
                
                if (this.modulosExameAtivos.length === 0) {
                    area.innerHTML = '<p style="color: #999; font-size: 13px; text-align: center; padding: 20px;">Selecione uma categoria acima para comeÃ§ar o exame especÃ­fico</p>';
                    return;
                }
                
                // Ordem fixa: Mapeamento â†’ Sistemas â†’ Especialidades
                const ordemFixa = [
                    // MAPEAMENTO
                    'map-lesoes', 'map-queimaduras',
                    // SISTEMAS (alfabÃ©tico)
                    'sis-cardiovascular', 'sis-digestorio', 'sis-endocrino', 'sis-geniturinario',
                    'sis-linfatico', 'sis-musculoesqueletico', 'sis-nervoso', 'sis-respiratorio',
                    'sis-tegumentar', 'sis-vascular',
                    // ESPECIALIDADES (alfabÃ©tico)
                    'esp-bucomaxilofacial', 'esp-cirurgia-mao', 'esp-cirurgia-plastica', 
                    'esp-cirurgia-vascular', 'esp-ginecologia', 'esp-obstetricia',
                    'esp-oftalmologia', 'esp-ortopedia', 'esp-otorrinolaringologia',
                    'esp-pediatria', 'esp-urologia'
                ];
                
                // Agrupar mÃ³dulos ativos por categoria
                const mapAtivos = this.modulosExameAtivos.filter(m => m.startsWith('map-'));
                const sisAtivos = this.modulosExameAtivos.filter(m => m.startsWith('sis-'));
                const espAtivos = this.modulosExameAtivos.filter(m => m.startsWith('esp-'));
                
                // Renderizar categoria MAPEAMENTO
                if (mapAtivos.length > 0) {
                    const secaoMap = this.criarSecaoCategoria('mapeamento', 'ğŸ“ MAPEAMENTO CORPORAL', '#8b5cf6', mapAtivos.length);
                    area.appendChild(secaoMap);
                    
                    mapAtivos.sort((a,b) => ordemFixa.indexOf(a) - ordemFixa.indexOf(b)).forEach(moduloId => {
                        secaoMap.querySelector('.secao-conteudo').appendChild(this.criarModulo(moduloId));
                    });
                }
                
                // Renderizar categoria SISTEMAS
                if (sisAtivos.length > 0) {
                    const secaoSis = this.criarSecaoCategoria('sistemas', 'ğŸ”„ SISTEMAS ORGÃ‚NICOS', '#3b82f6', sisAtivos.length);
                    area.appendChild(secaoSis);
                    
                    sisAtivos.sort((a,b) => ordemFixa.indexOf(a) - ordemFixa.indexOf(b)).forEach(moduloId => {
                        secaoSis.querySelector('.secao-conteudo').appendChild(this.criarModulo(moduloId));
                    });
                }
                
                // Renderizar categoria ESPECIALIDADES
                if (espAtivos.length > 0) {
                    const secaoEsp = this.criarSecaoCategoria('especialidades', 'ğŸ¥ AVALIAÃ‡ÃƒO ESPECIALIZADA', '#22c55e', espAtivos.length);
                    area.appendChild(secaoEsp);
                    
                    espAtivos.sort((a,b) => ordemFixa.indexOf(a) - ordemFixa.indexOf(b)).forEach(moduloId => {
                        secaoEsp.querySelector('.secao-conteudo').appendChild(this.criarModulo(moduloId));
                    });
                }
                
                // Renderizar mapas anatÃ´micos apÃ³s DOM pronto
                setTimeout(() => this.inicializarMapasAnatomicos(), 150);
            },
            
            // Criar seÃ§Ã£o de categoria colapsÃ¡vel
            criarSecaoCategoria: function(id, titulo, cor, qtd) {
                const secao = document.createElement('div');
                secao.className = 'secao-categoria-exame';
                secao.id = 'secao-' + id;
                secao.innerHTML = `
                    <div onclick="ProntuarioModular.toggleSecaoCategoria('${id}')" 
                         style="display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: ${cor}15; border-left: 4px solid ${cor}; border-radius: 6px 6px 0 0; cursor: pointer; margin-top: 12px;">
                        <span style="font-weight: 600; color: ${cor}; font-size: 13px;">${titulo}</span>
                        <span style="display: flex; align-items: center; gap: 8px;">
                            <span style="background: ${cor}; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px;">${qtd}</span>
                            <span id="seta-${id}" style="color: ${cor}; font-size: 14px;">â–¼</span>
                        </span>
                    </div>
                    <div class="secao-conteudo" id="conteudo-${id}" style="border: 1px solid ${cor}30; border-top: none; border-left: 4px solid ${cor}; border-radius: 0 0 6px 6px; padding: 12px; background: ${cor}08;"></div>
                `;
                return secao;
            },
            
            // Toggle seÃ§Ã£o categoria (colapsar/expandir)
            toggleSecaoCategoria: function(id) {
                const conteudo = document.getElementById('conteudo-' + id);
                const seta = document.getElementById('seta-' + id);
                if (!conteudo || !seta) return;
                
                if (conteudo.style.display === 'none') {
                    conteudo.style.display = 'block';
                    seta.textContent = 'â–¼';
                } else {
                    conteudo.style.display = 'none';
                    seta.textContent = 'â–¶';
                }
            },
            
            // Criar mÃ³dulo individual
            criarModulo: function(moduloId) {
                const div = document.createElement('div');
                div.id = 'pront-modulo-' + moduloId;
                div.className = 'modulo-exame-item';
                div.style.marginBottom = '12px';
                
                const config = this.configModulosExame[moduloId];
                if (!config) {
                    div.innerHTML = `<p style="color: #999; padding: 10px;">MÃ³dulo nÃ£o configurado: ${moduloId}</p>`;
                    return div;
                }
                
                div.innerHTML = config.html;
                return div;
            },
            
            // Inicializar mapas anatÃ´micos apÃ³s renderizaÃ§Ã£o
            inicializarMapasAnatomicos: function() {
                // Exame por RegiÃµes (antigo MarcaÃ§Ã£o de LesÃµes)
                if (this.modulosExameAtivos.includes('map-lesoes')) {
                    const container = document.getElementById('pront-container-map-lesoes');
                    if (container && typeof AnatomiaAtendimento !== 'undefined') {
                        AnatomiaAtendimento.renderizar('pront-container-map-lesoes', {
                            visualizacao: 'frente',
                            template: '',
                            permitirEdicao: true,
                            modoSimplificado: true,  // Sem tÃ­tulo/toggle (tÃ­tulo jÃ¡ estÃ¡ no container externo)
                            contextoInicial: 'anatomico'
                        });
                        // Trocar para contexto anatÃ´mico
                        setTimeout(() => {
                            AnatomiaAtendimento.trocarContexto('pront-container-map-lesoes', 'anatomico');
                        }, 200);
                        console.log('âœ… Exame por RegiÃµes renderizado');
                    }
                }
                
                // AvaliaÃ§Ã£o de Queimaduras
                if (this.modulosExameAtivos.includes('map-queimaduras')) {
                    const container = document.getElementById('pront-container-map-queimaduras');
                    if (container && typeof AnatomiaAtendimento !== 'undefined') {
                        AnatomiaAtendimento.renderizar('pront-container-map-queimaduras', {
                            visualizacao: 'queimados',
                            template: '',
                            permitirEdicao: true,
                            modoSimplificado: true,  // Sem tÃ­tulo/toggle (tÃ­tulo jÃ¡ estÃ¡ no container externo)
                            contextoInicial: 'queimados'
                        });
                        // Trocar para contexto queimados
                        setTimeout(() => {
                            AnatomiaAtendimento.trocarContexto('pront-container-map-queimaduras', 'queimados');
                        }, 200);
                        console.log('âœ… AvaliaÃ§Ã£o de Queimaduras renderizada');
                    }
                }
            },
            
            // Alternar mÃ©todo de cÃ¡lculo de queimaduras
            alterarMetodoQueimadura: function(metodo) {
                const container = document.getElementById('pront-container-map-queimaduras');
                if (!container || typeof AnatomiaAtendimento === 'undefined') return;
                
                container.innerHTML = '';
                
                setTimeout(() => {
                    const visualizacao = metodo === 'lundBrowder' ? 'lundBrowder' : 'queimados';
                    AnatomiaAtendimento.renderizar('pront-container-map-queimaduras', {
                        visualizacao: visualizacao,
                        template: '',
                        permitirEdicao: true,
                        modoSimplificado: true,
                        contextoInicial: 'queimados'
                    });
                    setTimeout(() => {
                        AnatomiaAtendimento.trocarContexto('pront-container-map-queimaduras', 'queimados');
                    }, 200);
                    console.log('âœ… MÃ©todo de queimadura alterado para:', metodo);
                }, 50);
            },
            
            // ConfiguraÃ§Ã£o dos mÃ³dulos de exame (templates HTML)
            configModulosExame: {
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // ğŸ“ MAPEAMENTO CORPORAL
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                'map-lesoes': {
                    titulo: 'ğŸ—ºï¸ Exame por RegiÃµes',
                    cor: '#8b5cf6',
                    html: `
                        <div style="background: #f5f3ff; padding: 15px; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                            <h5 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ—ºï¸ Exame por RegiÃµes</h5>
                            <div id="pront-container-map-lesoes" style="min-height: 300px;"></div>
                            <div style="margin-top: 12px;">
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o das lesÃµes:</label>
                                <textarea id="pront-map-lesoes-desc" rows="2" style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Descreva localizaÃ§Ã£o e caracterÃ­sticas..."></textarea>
                            </div>
                        </div>
                    `
                },
                'map-queimaduras': {
                    titulo: 'ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras',
                    cor: '#ef4444',
                    html: `
                        <div style="background: #fef2f2; padding: 15px; border-radius: 8px; border-left: 4px solid #ef4444;">
                            <h5 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras</h5>
                            <div id="pront-container-map-queimaduras" style="min-height: 300px;"></div>
                            <div style="margin-top: 12px;">
                                <label style="font-size: 11px; color: #666;">Agente causador e descriÃ§Ã£o:</label>
                                <textarea id="pront-map-queimaduras-desc" rows="2" style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Ex: Escaldadura por Ã¡gua quente..."></textarea>
                            </div>
                        </div>
                    `
                },
                // map-feridas DEPRECIADO v10.357 - Feridas registradas como achados no "Exame por RegiÃµes"
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // ğŸ”„ SISTEMAS ORGÃ‚NICOS
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                'sis-cardiovascular': {
                    titulo: 'ğŸ«€ Sistema Cardiovascular',
                    cor: '#dc2626',
                    html: `
                        <div style="background: #fef2f2; padding: 15px; border-radius: 8px; border-left: 4px solid #dc2626;">
                            <h5 style="margin: 0 0 12px 0; color: #dc2626; font-size: 14px;">ğŸ«€ Sistema Cardiovascular</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">Ritmo:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                        <option>Regular, 2 tempos</option><option>Regular, 3 tempos (B3)</option>
                                        <option>Regular, 3 tempos (B4)</option><option>Irregular</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Bulhas:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px;">
                                        <option>NormofonÃ©ticas</option><option>HipofonÃ©ticas</option><option>HiperfonÃ©ticas</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes (sopros, pulsos, edema):</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #fca5a5; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Sopros, estase jugular, edema MMII..."></textarea>
                            </div>
                        </div>
                    `
                },
                'sis-digestorio': {
                    titulo: 'ğŸ©º Sistema DigestÃ³rio',
                    cor: '#22c55e',
                    html: `
                        <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; border-left: 4px solid #22c55e;">
                            <h5 style="margin: 0 0 12px 0; color: #16a34a; font-size: 14px;">ğŸ©º Sistema DigestÃ³rio</h5>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 10px; color: #666;">InspeÃ§Ã£o:</label>
                                    <select style="width: 100%; padding: 6px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px; font-size: 12px;">
                                        <option>Plano</option><option>Globoso</option><option>Escavado</option><option>Distendido</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 10px; color: #666;">RHA:</label>
                                    <select style="width: 100%; padding: 6px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px; font-size: 12px;">
                                        <option>Presentes</option><option>Aumentados</option><option>DiminuÃ­dos</option><option>Ausentes</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 10px; color: #666;">PalpaÃ§Ã£o:</label>
                                    <select style="width: 100%; padding: 6px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px; font-size: 12px;">
                                        <option>FlÃ¡cido, indolor</option><option>Tenso</option><option>Doloroso difuso</option>
                                        <option>Doloroso localizado</option><option>Defesa</option><option>DescompressÃ£o +</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 10px; color: #666;">Visceromegalias:</label>
                                    <select style="width: 100%; padding: 6px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px; font-size: 12px;">
                                        <option>Ausentes</option><option>Hepatomegalia</option><option>Esplenomegalia</option><option>Ambas</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #86efac; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Massas, hÃ©rnias, cicatrizes..."></textarea>
                            </div>
                        </div>
                    `
                },
                'sis-nervoso': {
                    titulo: 'ğŸ§  Sistema Nervoso',
                    cor: '#a855f7',
                    html: `
                        <div style="background: #faf5ff; padding: 15px; border-radius: 8px; border-left: 4px solid #a855f7;">
                            <h5 style="margin: 0 0 12px 0; color: #9333ea; font-size: 14px;">ğŸ§  Sistema Nervoso</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">NÃ­vel de consciÃªncia:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                        <option>Alerta, orientado</option><option>Sonolento</option><option>Torporoso</option><option>Comatoso</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Pupilas:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                        <option>IsocÃ³ricas, fotorreagentes</option><option>AnisocÃ³ricas</option>
                                        <option>MidrÃ­ase bilateral</option><option>Miose bilateral</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">ForÃ§a muscular:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px;">
                                        <option>Preservada (grau V)</option><option>DiminuÃ­da</option><option>Hemiparesia D</option>
                                        <option>Hemiparesia E</option><option>Paraparesia</option><option>Tetraparesia</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #d8b4fe; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Reflexos, sensibilidade, coordenaÃ§Ã£o, marcha..."></textarea>
                            </div>
                        </div>
                    `
                },
                'sis-respiratorio': {
                    titulo: 'ğŸ« Sistema RespiratÃ³rio',
                    cor: '#0ea5e9',
                    html: `
                        <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border-left: 4px solid #0ea5e9;">
                            <h5 style="margin: 0 0 12px 0; color: #0284c7; font-size: 14px;">ğŸ« Sistema RespiratÃ³rio</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">MurmÃºrio Vesicular:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px;">
                                        <option>Presente bilateral</option><option>DiminuÃ­do Ã  D</option>
                                        <option>DiminuÃ­do Ã  E</option><option>DiminuÃ­do bilateral</option>
                                        <option>Abolido Ã  D</option><option>Abolido Ã  E</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">RuÃ­dos AdventÃ­cios:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px;">
                                        <option>Ausentes</option><option>Estertores crepitantes</option>
                                        <option>Estertores bolhosos</option><option>Sibilos</option><option>Roncos</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #7dd3fc; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Expansibilidade, percussÃ£o, tiragem..."></textarea>
                            </div>
                        </div>
                    `
                },
                'sis-tegumentar': {
                    titulo: 'ğŸ”¬ Sistema Tegumentar',
                    cor: '#ec4899',
                    html: `
                        <div style="background: #fdf2f8; padding: 15px; border-radius: 8px; border-left: 4px solid #ec4899;">
                            <h5 style="margin: 0 0 12px 0; color: #db2777; font-size: 14px;">ğŸ”¬ Sistema Tegumentar</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">LesÃ£o elementar:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                        <option value="">Selecione...</option>
                                        <option>MÃ¡cula</option><option>PÃ¡pula</option><option>Placa</option><option>NÃ³dulo</option>
                                        <option>VesÃ­cula</option><option>Bolha</option><option>PÃºstula</option>
                                        <option>Ãšlcera</option><option>ErosÃ£o</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">DistribuiÃ§Ã£o:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px;">
                                        <option>Localizada</option><option>Disseminada</option><option>Generalizada</option>
                                        <option>Ãreas fotoexpostas</option><option>Ãreas intertriginosas</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #f9a8d4; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Cor, tamanho, bordas, superfÃ­cie..."></textarea>
                            </div>
                        </div>
                    `
                },
                'sis-vascular': {
                    titulo: 'ğŸ©¸ Sistema Vascular PerifÃ©rico',
                    cor: '#be123c',
                    html: `
                        <div style="background: #fff1f2; padding: 15px; border-radius: 8px; border-left: 4px solid #be123c;">
                            <h5 style="margin: 0 0 12px 0; color: #be123c; font-size: 14px;">ğŸ©¸ Sistema Vascular PerifÃ©rico</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">Pulsos perifÃ©ricos:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                        <option>Presentes e simÃ©tricos</option><option>DiminuÃ­dos</option>
                                        <option>Ausentes Ã  D</option><option>Ausentes Ã  E</option><option>Ausentes bilateral</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">PerfusÃ£o:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                        <option>Adequada (TEC < 3s)</option><option>Lentificada (TEC 3-5s)</option><option>Muito lenta (TEC > 5s)</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Edema, varizes, Ãºlceras, ITB..."></textarea>
                            </div>
                        </div>
                    `
                },
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // ğŸ¥ AVALIAÃ‡ÃƒO ESPECIALIZADA
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                'esp-bucomaxilofacial': {
                    titulo: 'ğŸ¦· Esp. Bucomaxilofacial',
                    cor: '#059669',
                    html: `
                        <div style="background: #ecfdf5; padding: 15px; border-radius: 8px; border-left: 4px solid #059669;">
                            <h5 style="margin: 0 0 12px 0; color: #047857; font-size: 14px;">ğŸ¦· Especialidade Bucomaxilofacial</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">Abertura bucal:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px;">
                                        <option>Normal (> 40mm)</option><option>Limitada (20-40mm)</option>
                                        <option>Muito limitada (< 20mm)</option><option>Trismo</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">ATM:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px;">
                                        <option>Sem alteraÃ§Ãµes</option><option>Estalido</option>
                                        <option>CrepitaÃ§Ã£o</option><option>Dor Ã  palpaÃ§Ã£o</option><option>LuxaÃ§Ã£o</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #6ee7b7; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Face, oclusÃ£o, mucosa oral, fraturas..."></textarea>
                            </div>
                        </div>
                    `
                },
                'esp-cirurgia-vascular': {
                    titulo: 'ğŸ©¸ Esp. Cirurgia Vascular',
                    cor: '#be123c',
                    html: `
                        <div style="background: #fff1f2; padding: 15px; border-radius: 8px; border-left: 4px solid #be123c;">
                            <h5 style="margin: 0 0 12px 0; color: #be123c; font-size: 14px;">ğŸ©¸ Especialidade Cirurgia Vascular</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">ITB Direito:</label>
                                    <input type="text" placeholder="0.9-1.3" style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">ITB Esquerdo:</label>
                                    <input type="text" placeholder="0.9-1.3" style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">ClassificaÃ§Ã£o CEAP:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px;">
                                        <option>C0</option><option>C1</option><option>C2</option><option>C3</option>
                                        <option>C4a</option><option>C4b</option><option>C5</option><option>C6</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #fda4af; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Varizes, Ãºlceras venosas/arteriais, claudicaÃ§Ã£o..."></textarea>
                            </div>
                        </div>
                    `
                },
                'esp-oftalmologia': {
                    titulo: 'ğŸ‘ï¸ Esp. Oftalmologia',
                    cor: '#0891b2',
                    html: `
                        <div style="background: #ecfeff; padding: 15px; border-radius: 8px; border-left: 4px solid #0891b2;">
                            <h5 style="margin: 0 0 12px 0; color: #0e7490; font-size: 14px;">ğŸ‘ï¸ Especialidade Oftalmologia</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">AV OD:</label>
                                    <input type="text" placeholder="20/20" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">AV OE:</label>
                                    <input type="text" placeholder="20/20" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Reflexos pupilares:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px;">
                                        <option>Preservados</option><option>Alterados</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #67e8f9; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Biomicroscopia, fundoscopia, MOE..."></textarea>
                            </div>
                        </div>
                    `
                },
                'esp-ortopedia': {
                    titulo: 'ğŸ¦´ Esp. Ortopedia',
                    cor: '#78716c',
                    html: `
                        <div style="background: #fafaf9; padding: 15px; border-radius: 8px; border-left: 4px solid #78716c;">
                            <h5 style="margin: 0 0 12px 0; color: #57534e; font-size: 14px;">ğŸ¦´ Especialidade Ortopedia</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">RegiÃ£o acometida:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px;">
                                        <option>Coluna cervical</option><option>Coluna torÃ¡cica</option><option>Coluna lombar</option>
                                        <option>Ombro</option><option>Cotovelo</option><option>Punho/MÃ£o</option>
                                        <option>Quadril</option><option>Joelho</option><option>Tornozelo/PÃ©</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Lateralidade:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px;">
                                        <option>Direito</option><option>Esquerdo</option><option>Bilateral</option><option>Linha mÃ©dia</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">DescriÃ§Ã£o:</label>
                                <textarea rows="3" style="width: 100%; padding: 8px; border: 1px solid #d6d3d1; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="InspeÃ§Ã£o, palpaÃ§Ã£o, ADM, testes especiais, neurovascular distal..."></textarea>
                            </div>
                        </div>
                    `
                },
                'esp-otorrinolaringologia': {
                    titulo: 'ğŸ‘‚ Esp. Otorrinolaringologia',
                    cor: '#7c3aed',
                    html: `
                        <div style="background: #f5f3ff; padding: 15px; border-radius: 8px; border-left: 4px solid #7c3aed;">
                            <h5 style="margin: 0 0 12px 0; color: #6d28d9; font-size: 14px;">ğŸ‘‚ Especialidade Otorrinolaringologia</h5>
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 11px; color: #666;">Otoscopia:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                        <option>Normal bilateral</option><option>Hiperemia OD</option><option>Hiperemia OE</option>
                                        <option>Cerume</option><option>PerfuraÃ§Ã£o</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Rinoscopia:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                        <option>Normal</option><option>Hiperemia</option><option>Edema</option>
                                        <option>Desvio septal</option><option>PÃ³lipos</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="font-size: 11px; color: #666;">Orofaringe:</label>
                                    <select style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px;">
                                        <option>Normal</option><option>Hiperemia</option>
                                        <option>Hipertrofia amÃ­gdalas</option><option>Exsudato</option>
                                    </select>
                                </div>
                            </div>
                            <div>
                                <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes:</label>
                                <textarea rows="2" style="width: 100%; padding: 8px; border: 1px solid #c4b5fd; border-radius: 6px; margin-top: 4px; font-size: 13px;" placeholder="Acumetria, palpaÃ§Ã£o cervical..."></textarea>
                            </div>
                        </div>
                    `
                }
            },
            
            // Toggle especÃ­fico para GestaÃ§Ãµes (mostra/oculta G P A e texto nulÃ­para)
            toggleGestacao: function(valor) {
                const camposGPA = document.getElementById('pront-campos-gpa');
                const textoNulipara = document.getElementById('pront-texto-nulipara');
                
                if (valor === 'sim') {
                    if (camposGPA) camposGPA.style.display = 'block';
                    if (textoNulipara) textoNulipara.style.display = 'none';
                } else {
                    if (camposGPA) camposGPA.style.display = 'none';
                    if (textoNulipara) textoNulipara.style.display = 'block';
                }
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // CÃLCULOS AUTOMÃTICOS - DPO E ATB
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            // Calcular DPO baseado na data da cirurgia
            calcularDPO: function() {
                const inputData = document.getElementById('pront-dpo-data-cirurgia');
                const inputDPO = document.getElementById('pront-dpo-valor');
                
                if (!inputData || !inputDPO) return;
                
                const dataCirurgia = inputData.value;
                if (!dataCirurgia) {
                    inputDPO.value = '';
                    return;
                }
                
                const hoje = new Date();
                hoje.setHours(0, 0, 0, 0);
                
                const cirurgia = new Date(dataCirurgia + 'T00:00:00');
                
                // Calcular diferenÃ§a em dias
                const diffTime = hoje.getTime() - cirurgia.getTime();
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                
                // DPO comeÃ§a em 1 (dia da cirurgia = DPO 0 ou 1 dependendo da convenÃ§Ã£o)
                // Normalmente: dia da cirurgia = DPO 0, dia seguinte = DPO 1
                // Vou usar: dia da cirurgia = DPO 0, para DPO 1 tem que ser 1 dia depois
                inputDPO.value = diffDays >= 0 ? diffDays : '';
                
                console.log(`ğŸ“… DPO calculado: ${diffDays} dias`);
            },
            
            // Calcular IMC e ClassificaÃ§Ã£o automÃ¡tica
            calcularIMCAutomatic: function() {
                const pesoInput = document.getElementById('pront-peso');
                const alturaInput = document.getElementById('pront-altura');
                const imcInput = document.getElementById('pront-imc');
                const classInput = document.getElementById('pront-imc-class');
                
                if (!pesoInput || !alturaInput || !imcInput || !classInput) return;
                
                const peso = parseFloat(pesoInput.value.replace(',', '.'));
                const altura = parseFloat(alturaInput.value.replace(',', '.'));
                
                if (isNaN(peso) || isNaN(altura) || peso <= 0 || altura <= 0) {
                    imcInput.value = '';
                    classInput.value = '';
                    return;
                }
                
                // Converter altura de cm para metros
                const alturaMetros = altura / 100;
                const imc = peso / (alturaMetros * alturaMetros);
                
                // Mostrar IMC com 1 casa decimal
                imcInput.value = imc.toFixed(1);
                
                // ClassificaÃ§Ã£o automÃ¡tica
                let classificacao = '';
                if (imc < 18.5) classificacao = 'Baixo peso';
                else if (imc < 25) classificacao = 'Normal';
                else if (imc < 30) classificacao = 'Sobrepeso';
                else if (imc < 35) classificacao = 'Obesidade I';
                else if (imc < 40) classificacao = 'Obesidade II';
                else classificacao = 'Obesidade III';
                
                classInput.value = classificacao;
            },
            
            // Calcular Escala de Glasgow
            calcularGlasgow: function() {
                const ao = parseInt(document.getElementById('glasgow-ao')?.value) || 0;
                const rv = parseInt(document.getElementById('glasgow-rv')?.value) || 0;
                const rm = parseInt(document.getElementById('glasgow-rm')?.value) || 0;
                
                const total = ao + rv + rm;
                
                const totalEl = document.getElementById('glasgow-total');
                const classEl = document.getElementById('glasgow-classificacao');
                
                if (totalEl) totalEl.textContent = total;
                
                if (classEl) {
                    let classificacao = '';
                    let bgColor = '';
                    let textColor = '';
                    
                    if (total >= 13) {
                        classificacao = 'TCE Leve';
                        bgColor = '#dcfce7';
                        textColor = '#166534';
                    } else if (total >= 9) {
                        classificacao = 'TCE Moderado';
                        bgColor = '#fef3c7';
                        textColor = '#92400e';
                    } else {
                        classificacao = 'TCE Grave';
                        bgColor = '#fee2e2';
                        textColor = '#991b1b';
                    }
                    
                    classEl.textContent = classificacao;
                    classEl.style.background = bgColor;
                    classEl.style.color = textColor;
                }
            },
            
            // Calcular Escala de Braden
            calcularBraden: function() {
                const sensorial = parseInt(document.getElementById('braden-sensorial')?.value) || 0;
                const umidade = parseInt(document.getElementById('braden-umidade')?.value) || 0;
                const atividade = parseInt(document.getElementById('braden-atividade')?.value) || 0;
                const mobilidade = parseInt(document.getElementById('braden-mobilidade')?.value) || 0;
                const nutricao = parseInt(document.getElementById('braden-nutricao')?.value) || 0;
                const friccao = parseInt(document.getElementById('braden-friccao')?.value) || 0;
                
                const total = sensorial + umidade + atividade + mobilidade + nutricao + friccao;
                
                const totalEl = document.getElementById('braden-total');
                const riscoEl = document.getElementById('braden-risco');
                
                if (totalEl) totalEl.textContent = total;
                
                if (riscoEl) {
                    let risco = '';
                    let bgColor = '';
                    let textColor = '';
                    
                    if (total >= 19) {
                        risco = 'Sem Risco';
                        bgColor = '#dcfce7';
                        textColor = '#166534';
                    } else if (total >= 15) {
                        risco = 'Risco Baixo';
                        bgColor = '#dbeafe';
                        textColor = '#1e40af';
                    } else if (total >= 13) {
                        risco = 'Risco Moderado';
                        bgColor = '#fef3c7';
                        textColor = '#92400e';
                    } else if (total >= 10) {
                        risco = 'Risco Alto';
                        bgColor = '#fed7aa';
                        textColor = '#c2410c';
                    } else {
                        risco = 'Risco Muito Alto';
                        bgColor = '#fee2e2';
                        textColor = '#991b1b';
                    }
                    
                    riscoEl.textContent = risco;
                    riscoEl.style.background = bgColor;
                    riscoEl.style.color = textColor;
                }
            },
            
            // Calcular dia de uso do ATB
            calcularDiaATB: function() {
                const inputData = document.getElementById('pront-atb-inicio');
                const inputDia = document.getElementById('pront-atb-dia');
                
                if (!inputData || !inputDia) return;
                
                const dataInicio = inputData.value;
                if (!dataInicio) {
                    inputDia.value = '';
                    return;
                }
                
                const hoje = new Date();
                hoje.setHours(0, 0, 0, 0);
                
                const inicio = new Date(dataInicio + 'T00:00:00');
                
                // Calcular diferenÃ§a em dias
                const diffTime = hoje.getTime() - inicio.getTime();
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                
                // Dia de uso: dia do inÃ­cio = 1Â° dia
                inputDia.value = diffDays >= 0 ? (diffDays + 1) : '';
                
                console.log(`ğŸ’Š Dia de ATB calculado: ${diffDays + 1}Â° dia`);
            },
            
            // Calcular tempo total de uso do ATB suspenso
            calcularTempoATBSuspenso: function() {
                const inputInicio = document.getElementById('pront-atb-susp-inicio');
                const inputTermino = document.getElementById('pront-atb-susp-termino');
                const inputDias = document.getElementById('pront-atb-susp-dias');
                
                if (!inputInicio || !inputTermino || !inputDias) return;
                
                const dataInicio = inputInicio.value;
                const dataTermino = inputTermino.value;
                
                if (!dataInicio || !dataTermino) {
                    inputDias.value = '';
                    return;
                }
                
                const inicio = new Date(dataInicio + 'T00:00:00');
                const termino = new Date(dataTermino + 'T00:00:00');
                
                // Calcular diferenÃ§a em dias (04/11 a 05/11 = 1 dia)
                const diffTime = termino.getTime() - inicio.getTime();
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                
                inputDias.value = diffDays >= 0 ? diffDays : '';
                
                console.log(`â¹ï¸ Tempo de ATB suspenso: ${diffDays} dias`);
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // CONTROLE HOSPITALAR - PERSISTÃŠNCIA ENTRE EVOLUÃ‡Ã•ES
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            // Salvar dados do Controle Hospitalar para prÃ³xima evoluÃ§Ã£o
            salvarControleHospitalar: function() {
                // Coletar dados de mÃºltiplos DPOs
                const dpoList = [];
                this.listaDPO.forEach(id => {
                    const data = document.getElementById(`pront-dpo-data-${id}`)?.value || '';
                    const cirurgia = document.getElementById(`pront-dpo-cirurgia-${id}`)?.value || '';
                    const obs = document.getElementById(`pront-dpo-obs-${id}`)?.value || '';
                    if (data || cirurgia) {
                        dpoList.push({ id, data, cirurgia, obs });
                    }
                });
                
                // Coletar dados de mÃºltiplos ATBs
                const atbList = [];
                this.listaATB.forEach(id => {
                    const nome = document.getElementById(`pront-atb-nome-${id}`)?.value || '';
                    const posologia = document.getElementById(`pront-atb-posologia-${id}`)?.value || '';
                    const via = document.getElementById(`pront-atb-via-${id}`)?.value || '';
                    const inicio = document.getElementById(`pront-atb-inicio-${id}`)?.value || '';
                    const termino = document.getElementById(`pront-atb-termino-${id}`)?.value || '';
                    if (nome || inicio) {
                        atbList.push({ id, nome, posologia, via, inicio, termino });
                    }
                });
                
                // Coletar dados de mÃºltiplos ATBs Suspensos
                const atbSuspList = [];
                this.listaATBSusp.forEach(id => {
                    const nome = document.getElementById(`pront-atb-susp-nome-${id}`)?.value || '';
                    const inicio = document.getElementById(`pront-atb-susp-inicio-${id}`)?.value || '';
                    const termino = document.getElementById(`pront-atb-susp-termino-${id}`)?.value || '';
                    const motivo = document.getElementById(`pront-atb-susp-motivo-${id}`)?.value || '';
                    if (nome || inicio) {
                        atbSuspList.push({ id, nome, inicio, termino, motivo });
                    }
                });
                
                const dados = {
                    manterDPO: document.getElementById('pront-dpo-manter')?.checked || false,
                    manterATB: document.getElementById('pront-atb-manter')?.checked || false,
                    manterATBSusp: document.getElementById('pront-atb-susp-manter')?.checked || false,
                    dpoList,
                    atbList,
                    atbSuspList
                };
                
                localStorage.setItem('prontuario_controleHospitalar', JSON.stringify(dados));
                console.log('ğŸ’¾ Controle Hospitalar salvo para prÃ³xima evoluÃ§Ã£o');
            },
            
            // Carregar dados do Controle Hospitalar da evoluÃ§Ã£o anterior
            carregarControleHospitalar: function() {
                const dados = localStorage.getItem('prontuario_controleHospitalar');
                if (!dados) return;
                
                try {
                    const ctrl = JSON.parse(dados);
                    
                    // Carregar DPOs se marcado para manter
                    if (ctrl.manterDPO && ctrl.dpoList && ctrl.dpoList.length > 0) {
                        const checkManter = document.getElementById('pront-dpo-manter');
                        if (checkManter) checkManter.checked = true;
                        
                        ctrl.dpoList.forEach(dpo => {
                            this.adicionarDPO();
                            const id = this.contadorDPO;
                            
                            const inputData = document.getElementById(`pront-dpo-data-${id}`);
                            const inputCirurgia = document.getElementById(`pront-dpo-cirurgia-${id}`);
                            const inputObs = document.getElementById(`pront-dpo-obs-${id}`);
                            
                            if (inputData) inputData.value = dpo.data;
                            if (inputCirurgia) inputCirurgia.value = dpo.cirurgia;
                            if (inputObs) inputObs.value = dpo.obs;
                            
                            this.calcularDPOCard(id);
                        });
                        
                        console.log('ğŸ“… DPOs carregados da evoluÃ§Ã£o anterior');
                    }
                    
                    // Carregar ATBs se marcado para manter
                    if (ctrl.manterATB && ctrl.atbList && ctrl.atbList.length > 0) {
                        const checkManter = document.getElementById('pront-atb-manter');
                        if (checkManter) checkManter.checked = true;
                        
                        ctrl.atbList.forEach(atb => {
                            this.adicionarATB();
                            const id = this.contadorATB;
                            
                            const inputNome = document.getElementById(`pront-atb-nome-${id}`);
                            const inputPosologia = document.getElementById(`pront-atb-posologia-${id}`);
                            const inputVia = document.getElementById(`pront-atb-via-${id}`);
                            const inputInicio = document.getElementById(`pront-atb-inicio-${id}`);
                            const inputTermino = document.getElementById(`pront-atb-termino-${id}`);
                            
                            if (inputNome) inputNome.value = atb.nome;
                            if (inputPosologia) inputPosologia.value = atb.posologia;
                            if (inputVia) inputVia.value = atb.via;
                            if (inputInicio) inputInicio.value = atb.inicio;
                            if (inputTermino) inputTermino.value = atb.termino;
                            
                            this.calcularDiaATBCard(id);
                        });
                        
                        console.log('ğŸ’Š ATBs carregados da evoluÃ§Ã£o anterior');
                    }
                    
                    // Carregar ATBs Suspensos se marcado para manter
                    if (ctrl.manterATBSusp && ctrl.atbSuspList && ctrl.atbSuspList.length > 0) {
                        const checkManter = document.getElementById('pront-atb-susp-manter');
                        if (checkManter) checkManter.checked = true;
                        
                        ctrl.atbSuspList.forEach(atb => {
                            this.adicionarATBSuspenso();
                            const id = this.contadorATBSusp;
                            
                            const inputNome = document.getElementById(`pront-atb-susp-nome-${id}`);
                            const inputInicio = document.getElementById(`pront-atb-susp-inicio-${id}`);
                            const inputTermino = document.getElementById(`pront-atb-susp-termino-${id}`);
                            const inputMotivo = document.getElementById(`pront-atb-susp-motivo-${id}`);
                            
                            if (inputNome) inputNome.value = atb.nome;
                            if (inputInicio) inputInicio.value = atb.inicio;
                            if (inputTermino) inputTermino.value = atb.termino;
                            if (inputMotivo) inputMotivo.value = atb.motivo;
                            
                            this.calcularTempoATBSuspCard(id);
                        });
                        
                        console.log('ğŸ”¶ ATBs Suspensos carregados da evoluÃ§Ã£o anterior');
                    }
                    
                } catch(e) {
                    console.error('Erro ao carregar Controle Hospitalar:', e);
                }
            },
            
            // Limpar dados salvos do Controle Hospitalar
            limparControleHospitalar: function() {
                localStorage.removeItem('prontuario_controleHospitalar');
                console.log('ğŸ—‘ï¸ Dados de Controle Hospitalar limpos');
            },
            
            // Gerenciar Pool de AntibiÃ³ticos
            gerenciarAntibioticos: function() {
                this.abrirGerenciadorPool('AntibiÃ³ticos', 'poolAntibioticos', 'prontuario_poolAntibioticos', '#22c55e');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // DPO - DIA PÃ“S-OPERATÃ“RIO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarDPO: function() {
                // v10.438: Usar lista CORRETA (listaDPO, nÃ£o cirurgiasDPO!)
                const numero = this.listaDPO.length + 1;
                
                this.contadorDPO++;
                const id = this.contadorDPO;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-dpo-${id}`;
                card.style.cssText = 'background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; margin-bottom: 12px; border-left: 3px solid #0ea5e9;';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <strong style="color: #0ea5e9; font-size: 13px;">Cirurgia ${numero}</strong>
                        <button onclick="ProntuarioModular.removerDPO(${id})" style="padding: 4px 10px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">Data da Cirurgia</label>
                            <input type="date" id="pront-dpo-data-${id}" onchange="ProntuarioModular.calcularDPOCard(${id}); ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; width: 100%;">
                        </div>
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">DPO (calculado)</label>
                            <div style="display: flex; gap: 6px; align-items: center;">
                                <input type="number" id="pront-dpo-valor-${id}" readonly style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; font-weight: bold; text-align: center; background: #e0f2fe; color: #0369a1;">
                                <span style="font-size: 12px; color: #666; font-weight: 600;">Â° DPO</span>
                            </div>
                        </div>
                    </div>
                    <div class="prontuario-form-group" style="margin-bottom: 10px;">
                        <label style="font-size: 11px; color: #666;">Cirurgia Realizada</label>
                        <textarea id="pront-dpo-cirurgia-${id}" rows="2" onchange="ProntuarioModular.salvarControleHospitalar()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;" placeholder="Ex: Mamoplastia redutora bilateral..."></textarea>
                    </div>
                    <div class="prontuario-form-group">
                        <label style="font-size: 11px; color: #666;">ObservaÃ§Ãµes</label>
                        <textarea id="pront-dpo-obs-${id}" rows="1" onchange="ProntuarioModular.salvarControleHospitalar()" style="width: 100%; padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px;" placeholder="EvoluÃ§Ã£o, intercorrÃªncias..."></textarea>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaDPO');
                if (lista) lista.appendChild(card);
                this.listaDPO.push(id);
            },
            
            removerDPO: function(id) {
                const card = document.getElementById(`pront-dpo-${id}`);
                if (card) card.remove();
                this.listaDPO = this.listaDPO.filter(d => d !== id);
                this.salvarControleHospitalar();
            },
            
            calcularDPOCard: function(id) {
                const inputData = document.getElementById(`pront-dpo-data-${id}`);
                const inputDPO = document.getElementById(`pront-dpo-valor-${id}`);
                if (!inputData || !inputDPO || !inputData.value) return;
                
                const cirurgia = new Date(inputData.value + 'T00:00:00');
                const hoje = new Date();
                hoje.setHours(0, 0, 0, 0);
                
                const diffTime = hoje.getTime() - cirurgia.getTime();
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                
                inputDPO.value = diffDays >= 0 ? diffDays : '';
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // ATB - ANTIBIÃ“TICO EM USO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarATB: function() {
                // v10.438: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.listaATB.length + 1;
                
                this.contadorATB++;
                const id = this.contadorATB;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-atb-${id}`;
                card.style.cssText = 'background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; margin-bottom: 12px; border-left: 3px solid #22c55e;';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <strong style="color: #22c55e; font-size: 13px;">AntibiÃ³tico ${numero}</strong>
                        <button onclick="ProntuarioModular.removerATB(${id})" style="padding: 4px 10px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">AntibiÃ³tico</label>
                            <input type="text" id="pront-atb-nome-${id}" placeholder="Ex: Cefalexina 500mg" onchange="ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; width: 100%;">
                        </div>
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">Posologia</label>
                            <select id="pront-atb-posologia-${id}" onchange="ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px; width: 100%;">
                                <option value="">Selecione...</option>
                                <option value="6/6h">6/6h</option>
                                <option value="8/8h">8/8h</option>
                                <option value="12/12h">12/12h</option>
                                <option value="24/24h">24/24h</option>
                            </select>
                        </div>
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">Via</label>
                            <select id="pront-atb-via-${id}" onchange="ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 12px; width: 100%;">
                                <option value="">Selecione...</option>
                                <option value="vo">VO</option>
                                <option value="ev">EV</option>
                                <option value="im">IM</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">Data de InÃ­cio</label>
                            <input type="date" id="pront-atb-inicio-${id}" onchange="ProntuarioModular.calcularDiaATBCard(${id}); ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; width: 100%;">
                        </div>
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">PrevisÃ£o TÃ©rmino</label>
                            <input type="date" id="pront-atb-termino-${id}" onchange="ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; width: 100%;">
                        </div>
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">Dia de Uso</label>
                            <div style="display: flex; gap: 6px; align-items: center;">
                                <input type="number" id="pront-atb-dia-${id}" readonly style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; font-weight: bold; text-align: center; background: #dcfce7; color: #166534;">
                                <span style="font-size: 12px; color: #666;">Â° dia</span>
                            </div>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaATB');
                if (lista) lista.appendChild(card);
                this.listaATB.push(id);
            },
            
            removerATB: function(id) {
                const card = document.getElementById(`pront-atb-${id}`);
                if (card) card.remove();
                this.listaATB = this.listaATB.filter(a => a !== id);
                this.salvarControleHospitalar();
            },
            
            calcularDiaATBCard: function(id) {
                const inputInicio = document.getElementById(`pront-atb-inicio-${id}`);
                const inputDia = document.getElementById(`pront-atb-dia-${id}`);
                if (!inputInicio || !inputDia || !inputInicio.value) return;
                
                const inicio = new Date(inputInicio.value + 'T00:00:00');
                const hoje = new Date();
                hoje.setHours(0, 0, 0, 0);
                
                const diffTime = hoje.getTime() - inicio.getTime();
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24)) + 1;
                
                inputDia.value = diffDays >= 1 ? diffDays : 1;
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // ATB SUSPENSO - ANTIBIÃ“TICO SUSPENSO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarATBSuspenso: function() {
                // v10.438: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.listaATBSusp.length + 1;
                
                this.contadorATBSusp++;
                const id = this.contadorATBSusp;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-atb-susp-${id}`;
                card.style.cssText = 'background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; margin-bottom: 12px; border-left: 3px solid #f59e0b;';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <strong style="color: #f59e0b; font-size: 13px;">ATB Suspenso ${numero}</strong>
                        <button onclick="ProntuarioModular.removerATBSuspenso(${id})" style="padding: 4px 10px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">AntibiÃ³tico</label>
                            <input type="text" id="pront-atb-susp-nome-${id}" placeholder="Ex: Amoxicilina 500mg" onchange="ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; width: 100%;">
                        </div>
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">Data InÃ­cio</label>
                            <input type="date" id="pront-atb-susp-inicio-${id}" onchange="ProntuarioModular.calcularTempoATBSuspCard(${id}); ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; width: 100%;">
                        </div>
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">Data TÃ©rmino</label>
                            <input type="date" id="pront-atb-susp-termino-${id}" onchange="ProntuarioModular.calcularTempoATBSuspCard(${id}); ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; width: 100%;">
                        </div>
                        <div class="prontuario-form-group">
                            <label style="font-size: 11px; color: #666;">Total</label>
                            <div style="display: flex; gap: 6px; align-items: center;">
                                <input type="number" id="pront-atb-susp-dias-${id}" readonly style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; font-weight: bold; text-align: center; background: #fef3c7; color: #92400e;">
                                <span style="font-size: 11px; color: #666;">dias</span>
                            </div>
                        </div>
                    </div>
                    <div class="prontuario-form-group">
                        <label style="font-size: 11px; color: #666;">Motivo da SuspensÃ£o</label>
                        <input type="text" id="pront-atb-susp-motivo-${id}" placeholder="Ex: TÃ©rmino do tratamento, reaÃ§Ã£o adversa..." onchange="ProntuarioModular.salvarControleHospitalar()" style="padding: 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; width: 100%;">
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaATBSusp');
                if (lista) lista.appendChild(card);
                this.listaATBSusp.push(id);
            },
            
            removerATBSuspenso: function(id) {
                const card = document.getElementById(`pront-atb-susp-${id}`);
                if (card) card.remove();
                this.listaATBSusp = this.listaATBSusp.filter(a => a !== id);
                this.salvarControleHospitalar();
            },
            
            calcularTempoATBSuspCard: function(id) {
                const inputInicio = document.getElementById(`pront-atb-susp-inicio-${id}`);
                const inputTermino = document.getElementById(`pront-atb-susp-termino-${id}`);
                const inputDias = document.getElementById(`pront-atb-susp-dias-${id}`);
                if (!inputInicio || !inputTermino || !inputDias || !inputInicio.value || !inputTermino.value) return;
                
                const inicio = new Date(inputInicio.value + 'T00:00:00');
                const termino = new Date(inputTermino.value + 'T00:00:00');
                
                const diffTime = termino.getTime() - inicio.getTime();
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24)) + 1;
                
                inputDias.value = diffDays >= 1 ? diffDays : '';
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // ALERGIAS
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarAlergia: function() {
                // v10.437: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.alergias.length + 1;
                
                this.contadorAlergias++;
                const id = this.contadorAlergias;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-alergia-${id}`;
                card.style.borderLeftColor = '#f44336';
                card.innerHTML = `
                    <div class="prontuario-item-card-header">
                        <strong style="color: #f44336;">Alergia ${numero}</strong>
                        <button class="prontuario-btn-remover" onclick="ProntuarioModular.removerAlergia(${id})">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div class="prontuario-form-grid">
                        <div class="prontuario-form-group full">
                            <label>Tipo de Alergia</label>
                            <div style="display: flex; gap: 8px;">
                                <select id="pront-select-alergia-${id}" onchange="console.log('ğŸ”„ [v10.443] SELECT mudou! Valor:', this.value); setTimeout(() => window.atualizarTodosCabecalhos(), 100);" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                    <option value="">Selecione...</option>
                                    ${this.poolAlergias.sort().map(a => `<option value="${a}">${a}</option>`).join('')}
                                </select>
                                <button class="prontuario-btn-criar" onclick="ProntuarioModular.criarNovaAlergia(${id})">â• Criar Nova</button>
                            </div>
                        </div>
                        <div class="prontuario-form-group full">
                            <label>ObservaÃ§Ãµes</label>
                            <textarea style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 60px;" placeholder="Ex: Choque anafilÃ¡tico em 2010, evitar uso..."></textarea>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaAlergias');
                if (lista) {
                    lista.appendChild(card);
                    this.alergias.push(id);
                    
                    console.log('');
                    console.log('ğŸ†• [v10.443] Alergia ADICIONADA! ID:', id);
                    console.log('   Total alergias:', this.alergias.length);
                    console.log('   â†’ Chamando atualizarTodosCabecalhos()...');
                    
                    // v10.443: Usar funÃ§Ã£o global Ãºnica!
                    setTimeout(() => window.atualizarTodosCabecalhos(), 100);
                }
            },
            
            removerAlergia: function(id) {
                const card = document.getElementById(`pront-alergia-${id}`);
                if (card) card.remove();
                this.alergias = this.alergias.filter(a => a !== id);
                
                console.log('');
                console.log('ğŸ—‘ï¸ [v10.443] Alergia REMOVIDA! ID:', id);
                console.log('   Total alergias:', this.alergias.length);
                console.log('   â†’ Chamando atualizarTodosCabecalhos()...');
                
                // v10.443: Usar funÃ§Ã£o global Ãºnica!
                setTimeout(() => window.atualizarTodosCabecalhos(), 100);
            },
            
            criarNovaAlergia: function(cardId) {
                const nome = prompt('Digite o nome da nova alergia:');
                if (nome && nome.trim()) {
                    const nomeTrim = nome.trim();
                    if (!this.poolAlergias.includes(nomeTrim)) {
                        this.poolAlergias.push(nomeTrim);
                        this.poolAlergias.sort();
                        localStorage.setItem('prontuario_poolAlergias', JSON.stringify(this.poolAlergias));
                    }
                    const select = document.getElementById(`pront-select-alergia-${cardId}`);
                    if (select) {
                        select.innerHTML = `<option value="">Selecione...</option>${this.poolAlergias.map(a => `<option value="${a}" ${a===nomeTrim?'selected':''}>${a}</option>`).join('')}`;
                    }
                }
            },
            
            gerenciarAlergias: function() {
                this.abrirGerenciadorPool('Alergias', 'poolAlergias', 'prontuario_poolAlergias', '#ef4444');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // DOENÃ‡AS PRÃ‰VIAS
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarDoenca: function() {
                // v10.437: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.doencas.length + 1;
                
                this.contadorDoencas++;
                const id = this.contadorDoencas;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-doenca-${id}`;
                card.innerHTML = `
                    <div class="prontuario-item-card-header">
                        <strong>DoenÃ§a ${numero}</strong>
                        <button class="prontuario-btn-remover" onclick="ProntuarioModular.removerDoenca(${id})">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div class="prontuario-form-grid">
                        <div class="prontuario-form-group full">
                            <label>Tipo de DoenÃ§a</label>
                            <div style="display: flex; gap: 8px;">
                                <select id="pront-select-doenca-${id}" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                    <option value="">Selecione...</option>
                                    ${this.poolDoencas.sort().map(d => `<option value="${d}">${d}</option>`).join('')}
                                </select>
                                <button class="prontuario-btn-criar" onclick="ProntuarioModular.criarNovaDoenca(${id})">â• Criar Nova</button>
                            </div>
                        </div>
                        <div class="prontuario-form-group full">
                            <label>ObservaÃ§Ãµes</label>
                            <textarea style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 50px;" placeholder="Ex: Controlada com medicaÃ§Ã£o, Ãºltima crise em..."></textarea>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaDoencas');
                if (lista) lista.appendChild(card);
                this.doencas.push(id);
            },
            
            removerDoenca: function(id) {
                const card = document.getElementById(`pront-doenca-${id}`);
                if (card) card.remove();
                this.doencas = this.doencas.filter(d => d !== id);
            },
            
            criarNovaDoenca: function(cardId) {
                const nome = prompt('Digite o nome da nova doenÃ§a:');
                if (nome && nome.trim()) {
                    const nomeTrim = nome.trim();
                    if (!this.poolDoencas.includes(nomeTrim)) {
                        this.poolDoencas.push(nomeTrim);
                        this.poolDoencas.sort();
                        localStorage.setItem('prontuario_poolDoencas', JSON.stringify(this.poolDoencas));
                    }
                    const select = document.getElementById(`pront-select-doenca-${cardId}`);
                    if (select) {
                        select.innerHTML = `<option value="">Selecione...</option>${this.poolDoencas.map(d => `<option value="${d}" ${d===nomeTrim?'selected':''}>${d}</option>`).join('')}`;
                    }
                }
            },
            
            gerenciarDoencas: function() {
                this.abrirGerenciadorPool('DoenÃ§as', 'poolDoencas', 'prontuario_poolDoencas', '#3b82f6');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // CIRURGIAS PRÃ‰VIAS
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarCirurgia: function() {
                // v10.437: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.cirurgias.length + 1;
                
                this.contadorCirurgias++;
                const id = this.contadorCirurgias;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-cirurgia-${id}`;
                card.style.borderLeftColor = '#9c27b0';
                card.innerHTML = `
                    <div class="prontuario-item-card-header">
                        <strong style="color: #9c27b0;">Cirurgia ${numero}</strong>
                        <button class="prontuario-btn-remover" onclick="ProntuarioModular.removerCirurgia(${id})">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div class="prontuario-form-grid">
                        <div class="prontuario-form-group full">
                            <label>Tipo de Cirurgia</label>
                            <div style="display: flex; gap: 8px;">
                                <select id="pront-select-cirurgia-${id}" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                    <option value="">Selecione...</option>
                                    ${this.poolCirurgias.sort().map(c => `<option value="${c}">${c}</option>`).join('')}
                                </select>
                                <button class="prontuario-btn-criar" onclick="ProntuarioModular.criarNovaCirurgia(${id})">â• Criar Nova</button>
                            </div>
                        </div>
                        <div class="prontuario-form-group">
                            <label>Ano</label>
                            <input type="number" min="1900" max="2030" placeholder="Ex: 2015" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                        </div>
                        <div class="prontuario-form-group full">
                            <label>ObservaÃ§Ãµes (cicatrizaÃ§Ã£o, complicaÃ§Ãµes, etc)</label>
                            <textarea style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 50px;" placeholder="Ex: CicatrizaÃ§Ã£o normal, sem intercorrÃªncias..."></textarea>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaCirurgias');
                if (lista) lista.appendChild(card);
                this.cirurgias.push(id);
            },
            
            removerCirurgia: function(id) {
                const card = document.getElementById(`pront-cirurgia-${id}`);
                if (card) card.remove();
                this.cirurgias = this.cirurgias.filter(c => c !== id);
            },
            
            criarNovaCirurgia: function(cardId) {
                const nome = prompt('Digite o nome da nova cirurgia:');
                if (nome && nome.trim()) {
                    const nomeTrim = nome.trim();
                    if (!this.poolCirurgias.includes(nomeTrim)) {
                        this.poolCirurgias.push(nomeTrim);
                        this.poolCirurgias.sort();
                        localStorage.setItem('prontuario_poolCirurgias', JSON.stringify(this.poolCirurgias));
                    }
                    const select = document.getElementById(`pront-select-cirurgia-${cardId}`);
                    if (select) {
                        select.innerHTML = `<option value="">Selecione...</option>${this.poolCirurgias.map(c => `<option value="${c}" ${c===nomeTrim?'selected':''}>${c}</option>`).join('')}`;
                    }
                }
            },
            
            gerenciarCirurgias: function() {
                this.abrirGerenciadorPool('Cirurgias', 'poolCirurgias', 'prontuario_poolCirurgias', '#8b5cf6');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // MEDICAÃ‡Ã•ES EM USO
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarMedicacao: function() {
                // v10.437: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.medicacoes.length + 1;
                
                this.contadorMedicacoes++;
                const id = this.contadorMedicacoes;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-medicacao-${id}`;
                card.style.borderLeftColor = '#4caf50';
                card.innerHTML = `
                    <div class="prontuario-item-card-header">
                        <strong style="color: #4caf50;">MedicaÃ§Ã£o ${numero}</strong>
                        <button class="prontuario-btn-remover" onclick="ProntuarioModular.removerMedicacao(${id})">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div class="prontuario-form-grid">
                        <div class="prontuario-form-group full">
                            <label>Nome do Medicamento</label>
                            <div style="display: flex; gap: 8px;">
                                <select id="pront-select-medicacao-${id}" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                    <option value="">Selecione...</option>
                                    ${this.poolMedicacoes.sort().map(m => `<option value="${m}">${m}</option>`).join('')}
                                </select>
                                <button class="prontuario-btn-criar" onclick="ProntuarioModular.criarNovaMedicacao(${id})">â• Criar Nova</button>
                            </div>
                        </div>
                        <div class="prontuario-form-group">
                            <label>Dose</label>
                            <input type="text" placeholder="Ex: 50mg" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                        </div>
                        <div class="prontuario-form-group">
                            <label>FrequÃªncia</label>
                            <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                <option>1x/dia</option>
                                <option>2x/dia</option>
                                <option>3x/dia</option>
                                <option>4x/dia</option>
                                <option>12/12h</option>
                                <option>8/8h</option>
                                <option>6/6h</option>
                                <option>Se necessÃ¡rio</option>
                                <option>Outro</option>
                            </select>
                        </div>
                        <div class="prontuario-form-group">
                            <label>Motivo/IndicaÃ§Ã£o</label>
                            <input type="text" placeholder="Ex: HipertensÃ£o" style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                        </div>
                        <div class="prontuario-form-group full">
                            <label>ObservaÃ§Ãµes</label>
                            <textarea style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 50px;" placeholder="InformaÃ§Ãµes adicionais sobre a medicaÃ§Ã£o..."></textarea>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaMedicacoes');
                if (lista) lista.appendChild(card);
                this.medicacoes.push(id);
            },
            
            removerMedicacao: function(id) {
                const card = document.getElementById(`pront-medicacao-${id}`);
                if (card) card.remove();
                this.medicacoes = this.medicacoes.filter(m => m !== id);
            },
            
            criarNovaMedicacao: function(cardId) {
                const nome = prompt('Digite o nome da nova medicaÃ§Ã£o:');
                if (nome && nome.trim()) {
                    const nomeTrim = nome.trim();
                    if (!this.poolMedicacoes.includes(nomeTrim)) {
                        this.poolMedicacoes.push(nomeTrim);
                        this.poolMedicacoes.sort();
                        localStorage.setItem('prontuario_poolMedicacoes', JSON.stringify(this.poolMedicacoes));
                    }
                    const select = document.getElementById(`pront-select-medicacao-${cardId}`);
                    if (select) {
                        select.innerHTML = `<option value="">Selecione...</option>${this.poolMedicacoes.map(m => `<option value="${m}" ${m===nomeTrim?'selected':''}>${m}</option>`).join('')}`;
                    }
                }
            },
            
            gerenciarMedicacoes: function() {
                this.abrirGerenciadorPool('MedicaÃ§Ãµes', 'poolMedicacoes', 'prontuario_poolMedicacoes', '#10b981');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // GERENCIADOR DE POOL UNIFICADO - INTERFACE VISUAL
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            abrirGerenciadorPool: function(titulo, poolKey, storageKey, cor) {
                const self = this;
                const pool = (this[poolKey] || []).sort((a, b) => a.localeCompare(b, 'pt-BR'));
                this[poolKey] = pool; // Garantir ordem alfabÃ©tica
                
                // Remover modal existente se houver
                const existente = document.getElementById('modal-gerenciador-pool');
                if (existente) existente.remove();
                
                // VariÃ¡vel para armazenar o filtro atual
                window.poolFiltroAtual = '';
                
                // Criar modal
                const modal = document.createElement('div');
                modal.id = 'modal-gerenciador-pool';
                modal.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 10000;';
                
                const renderLista = (filtro = '') => {
                    const items = (self[poolKey] || []).sort((a, b) => a.localeCompare(b, 'pt-BR'));
                    const filtrados = filtro ? items.filter(item => item.toLowerCase().includes(filtro.toLowerCase())) : items;
                    
                    if (filtrados.length === 0) {
                        if (filtro) {
                            return '<p style="color: #666; text-align: center; padding: 20px;">Nenhum item encontrado para "' + filtro + '"</p>';
                        }
                        return '<p style="color: #666; text-align: center; padding: 20px;">Nenhum item cadastrado</p>';
                    }
                    return filtrados.map((item, i) => {
                        const indexOriginal = items.indexOf(item);
                        return `
                        <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 8px; border-left: 3px solid ${cor};">
                            <span style="flex: 1; font-size: 14px;">${item}</span>
                            <button onclick="ProntuarioModular.editarItemPool('${poolKey}', '${storageKey}', ${indexOriginal})" style="padding: 6px 12px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">âœï¸</button>
                            <button onclick="ProntuarioModular.deletarItemPool('${poolKey}', '${storageKey}', ${indexOriginal})" style="padding: 6px 12px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">ğŸ—‘ï¸</button>
                        </div>
                    `}).join('');
                };
                
                modal.innerHTML = `
                    <div style="background: white; border-radius: 12px; width: 500px; max-width: 90vw; max-height: 80vh; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        <div style="padding: 20px; background: ${cor}; color: white;">
                            <h3 style="margin: 0; font-size: 18px;">ğŸ“‹ Gerenciar Pool de ${titulo}</h3>
                            <p style="margin: 5px 0 0 0; font-size: 12px; opacity: 0.9;">Itens em ordem alfabÃ©tica â€¢ Total: ${pool.length}</p>
                        </div>
                        
                        <div style="padding: 20px;">
                            <!-- Campo de Busca -->
                            <div style="margin-bottom: 15px;">
                                <div style="position: relative;">
                                    <input type="text" id="input-busca-pool" placeholder="ğŸ” Buscar na lista..." style="width: 100%; padding: 12px 12px 12px 40px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px; box-sizing: border-box;">
                                    <span style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); font-size: 16px;">ğŸ”</span>
                                </div>
                            </div>
                            
                            <!-- Adicionar Novo -->
                            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                                <input type="text" id="input-novo-pool-item" placeholder="Digite para adicionar novo item..." style="flex: 1; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 14px;">
                                <button onclick="ProntuarioModular.adicionarItemPool('${poolKey}', '${storageKey}')" style="padding: 12px 20px; background: ${cor}; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px;">+ Adicionar</button>
                            </div>
                            
                            <!-- Lista de Items -->
                            <div id="lista-pool-items" style="max-height: 300px; overflow-y: auto;">
                                ${renderLista()}
                            </div>
                            
                            <p id="pool-contador" style="color: #666; font-size: 12px; margin-top: 15px; text-align: center;">
                                Mostrando ${pool.length} de ${pool.length} item(s)
                            </p>
                        </div>
                        
                        <div style="padding: 15px 20px; background: #f8f9fa; border-top: 1px solid #e0e0e0; display: flex; justify-content: flex-end;">
                            <button onclick="document.getElementById('modal-gerenciador-pool').remove()" style="padding: 10px 24px; background: #6b7280; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">Fechar</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // Configurar busca em tempo real
                const inputBusca = document.getElementById('input-busca-pool');
                inputBusca.addEventListener('input', (e) => {
                    const filtro = e.target.value.trim();
                    window.poolFiltroAtual = filtro;
                    const container = document.getElementById('lista-pool-items');
                    const contador = document.getElementById('pool-contador');
                    
                    const items = (self[poolKey] || []).sort((a, b) => a.localeCompare(b, 'pt-BR'));
                    const filtrados = filtro ? items.filter(item => item.toLowerCase().includes(filtro.toLowerCase())) : items;
                    
                    container.innerHTML = renderLista(filtro);
                    contador.textContent = `Mostrando ${filtrados.length} de ${items.length} item(s)`;
                });
                
                // Focar no campo de busca
                setTimeout(() => {
                    inputBusca.focus();
                }, 100);
                
                // Fechar ao clicar fora
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) modal.remove();
                });
                
                // Enter para adicionar
                document.getElementById('input-novo-pool-item').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        self.adicionarItemPool(poolKey, storageKey);
                    }
                });
            },
            
            adicionarItemPool: function(poolKey, storageKey) {
                const input = document.getElementById('input-novo-pool-item');
                const valor = input.value.trim();
                if (!valor) return;
                
                if (!this[poolKey].includes(valor)) {
                    this[poolKey].push(valor);
                    this[poolKey].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                    localStorage.setItem(storageKey, JSON.stringify(this[poolKey]));
                }
                
                input.value = '';
                this.atualizarListaPool(poolKey, storageKey);
                
                // Atualizar contador
                const contador = document.getElementById('pool-contador');
                if (contador) {
                    const total = this[poolKey].length;
                    contador.textContent = `Mostrando ${total} de ${total} item(s)`;
                }
                
                // Limpar busca para mostrar novo item
                const inputBusca = document.getElementById('input-busca-pool');
                if (inputBusca) {
                    inputBusca.value = '';
                    window.poolFiltroAtual = '';
                }
            },
            
            editarItemPool: function(poolKey, storageKey, index) {
                const valorAtual = this[poolKey][index];
                const novoValor = prompt('Editar item:', valorAtual);
                if (novoValor && novoValor.trim() && novoValor.trim() !== valorAtual) {
                    this[poolKey][index] = novoValor.trim();
                    this[poolKey].sort((a, b) => a.localeCompare(b, 'pt-BR'));
                    localStorage.setItem(storageKey, JSON.stringify(this[poolKey]));
                    this.atualizarListaPool(poolKey, storageKey);
                }
            },
            
            deletarItemPool: function(poolKey, storageKey, index) {
                const item = this[poolKey][index];
                if (confirm(`Deletar "${item}"?`)) {
                    this[poolKey].splice(index, 1);
                    localStorage.setItem(storageKey, JSON.stringify(this[poolKey]));
                    this.atualizarListaPool(poolKey, storageKey);
                    
                    // Atualizar contador
                    const contador = document.getElementById('pool-contador');
                    if (contador) {
                        const filtro = window.poolFiltroAtual || '';
                        const items = this[poolKey];
                        const filtrados = filtro ? items.filter(i => i.toLowerCase().includes(filtro.toLowerCase())) : items;
                        contador.textContent = `Mostrando ${filtrados.length} de ${items.length} item(s)`;
                    }
                }
            },
            
            atualizarListaPool: function(poolKey, storageKey) {
                const container = document.getElementById('lista-pool-items');
                if (!container) return;
                
                const filtro = window.poolFiltroAtual || '';
                const items = (this[poolKey] || []).sort((a, b) => a.localeCompare(b, 'pt-BR'));
                const filtrados = filtro ? items.filter(item => item.toLowerCase().includes(filtro.toLowerCase())) : items;
                
                const cor = poolKey === 'poolAlergias' ? '#ef4444' : 
                           poolKey === 'poolDoencas' ? '#3b82f6' :
                           poolKey === 'poolCirurgias' ? '#8b5cf6' :
                           poolKey === 'poolMedicacoes' ? '#10b981' :
                           poolKey === 'poolParentescos' ? '#a855f7' :
                           poolKey === 'poolDoencasFamiliares' ? '#f59e0b' :
                           poolKey === 'poolAntibioticos' ? '#22c55e' : '#6b7280';
                
                if (filtrados.length === 0) {
                    if (filtro) {
                        container.innerHTML = '<p style="color: #666; text-align: center; padding: 20px;">Nenhum item encontrado para "' + filtro + '"</p>';
                    } else {
                        container.innerHTML = '<p style="color: #666; text-align: center; padding: 20px;">Nenhum item cadastrado</p>';
                    }
                    return;
                }
                
                container.innerHTML = filtrados.map((item) => {
                    const indexOriginal = items.indexOf(item);
                    return `
                    <div style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 8px; border-left: 3px solid ${cor};">
                        <span style="flex: 1; font-size: 14px;">${item}</span>
                        <button onclick="ProntuarioModular.editarItemPool('${poolKey}', '${storageKey}', ${indexOriginal})" style="padding: 6px 12px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">âœï¸</button>
                        <button onclick="ProntuarioModular.deletarItemPool('${poolKey}', '${storageKey}', ${indexOriginal})" style="padding: 6px 12px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">ğŸ—‘ï¸</button>
                    </div>
                `}).join('');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // HISTÃ“RIA FAMILIAR
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarFamiliar: function() {
                // v10.437: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.familiares.length + 1;
                
                this.contadorFamiliares++;
                const id = this.contadorFamiliares;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-familiar-${id}`;
                card.style.borderLeftColor = '#a855f7';
                card.innerHTML = `
                    <div class="prontuario-item-card-header">
                        <strong style="color: #a855f7;">Familiar ${numero}</strong>
                        <button class="prontuario-btn-remover" onclick="ProntuarioModular.removerFamiliar(${id})">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div class="prontuario-form-grid">
                        <div class="prontuario-form-group">
                            <label>Grau de Parentesco</label>
                            <div style="display: flex; gap: 8px;">
                                <select id="pront-select-parentesco-${id}" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                    <option value="">Selecione...</option>
                                    ${this.poolParentescos.sort().map(p => `<option value="${p}">${p}</option>`).join('')}
                                </select>
                                <button class="prontuario-btn-criar" onclick="ProntuarioModular.criarNovoParentesco(${id})">â•</button>
                            </div>
                        </div>
                        <div class="prontuario-form-group full">
                            <label>DoenÃ§as</label>
                            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <div id="pront-tags-doencas-${id}" style="display: flex; flex-wrap: wrap; gap: 8px; min-height: 35px; margin-bottom: 12px;"></div>
                                <div style="display: flex; gap: 8px;">
                                    <select id="pront-select-doenca-familiar-${id}" style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                        <option value="">Selecione uma doenÃ§a...</option>
                                        ${this.poolDoencasFamiliares.sort().map(d => `<option value="${d}">${d}</option>`).join('')}
                                    </select>
                                    <button class="prontuario-btn-adicionar" style="padding: 10px 14px;" onclick="ProntuarioModular.adicionarDoencaFamiliar(${id})">â•</button>
                                    <button class="prontuario-btn-criar" onclick="ProntuarioModular.criarNovaDoencaFamiliar(${id})">âœ¨</button>
                                </div>
                            </div>
                        </div>
                        <div class="prontuario-form-group full">
                            <label>ObservaÃ§Ãµes</label>
                            <textarea style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 50px;" placeholder="Ex: Faleceu aos 60 anos, diagnÃ³stico aos 55..."></textarea>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaFamiliares');
                if (lista) lista.appendChild(card);
                this.familiares.push(id);
                this.doencasPorFamiliar[id] = [];
            },
            
            removerFamiliar: function(id) {
                const card = document.getElementById(`pront-familiar-${id}`);
                if (card) card.remove();
                this.familiares = this.familiares.filter(f => f !== id);
                delete this.doencasPorFamiliar[id];
            },
            
            adicionarDoencaFamiliar: function(familiarId) {
                const select = document.getElementById(`pront-select-doenca-familiar-${familiarId}`);
                const doenca = select ? select.value : null;
                if (!doenca) return;
                
                if (!this.doencasPorFamiliar[familiarId]) this.doencasPorFamiliar[familiarId] = [];
                if (!this.doencasPorFamiliar[familiarId].includes(doenca)) {
                    this.doencasPorFamiliar[familiarId].push(doenca);
                    this.renderizarDoencasFamiliar(familiarId);
                }
                select.value = '';
            },
            
            renderizarDoencasFamiliar: function(familiarId) {
                const container = document.getElementById(`pront-tags-doencas-${familiarId}`);
                if (!container) return;
                container.innerHTML = '';
                
                const doencas = this.doencasPorFamiliar[familiarId] || [];
                doencas.forEach((doenca, index) => {
                    const tag = document.createElement('div');
                    tag.className = 'prontuario-tag';
                    tag.innerHTML = `${doenca} <button onclick="ProntuarioModular.removerDoencaFamiliar(${familiarId}, ${index})">Ã—</button>`;
                    container.appendChild(tag);
                });
            },
            
            removerDoencaFamiliar: function(familiarId, index) {
                if (this.doencasPorFamiliar[familiarId]) {
                    this.doencasPorFamiliar[familiarId].splice(index, 1);
                    this.renderizarDoencasFamiliar(familiarId);
                }
            },
            
            criarNovoParentesco: function(cardId) {
                const nome = prompt('Digite o novo grau de parentesco:');
                if (nome && nome.trim()) {
                    const nomeTrim = nome.trim();
                    if (!this.poolParentescos.includes(nomeTrim)) {
                        this.poolParentescos.push(nomeTrim);
                        this.poolParentescos.sort();
                        localStorage.setItem('prontuario_poolParentescos', JSON.stringify(this.poolParentescos));
                    }
                    const select = document.getElementById(`pront-select-parentesco-${cardId}`);
                    if (select) {
                        select.innerHTML = `<option value="">Selecione...</option>${this.poolParentescos.map(p => `<option value="${p}" ${p===nomeTrim?'selected':''}>${p}</option>`).join('')}`;
                    }
                }
            },
            
            criarNovaDoencaFamiliar: function(cardId) {
                const nome = prompt('Digite a nova doenÃ§a familiar:');
                if (nome && nome.trim()) {
                    const nomeTrim = nome.trim();
                    if (!this.poolDoencasFamiliares.includes(nomeTrim)) {
                        this.poolDoencasFamiliares.push(nomeTrim);
                        this.poolDoencasFamiliares.sort();
                        localStorage.setItem('prontuario_poolDoencasFamiliares', JSON.stringify(this.poolDoencasFamiliares));
                    }
                    const select = document.getElementById(`pront-select-doenca-familiar-${cardId}`);
                    if (select) {
                        select.innerHTML = `<option value="">Selecione...</option>${this.poolDoencasFamiliares.map(d => `<option value="${d}" ${d===nomeTrim?'selected':''}>${d}</option>`).join('')}`;
                    }
                }
            },
            
            gerenciarParentescos: function() {
                this.abrirGerenciadorPool('Parentescos', 'poolParentescos', 'prontuario_poolParentescos', '#a855f7');
            },
            
            gerenciarDoencasFamiliares: function() {
                this.abrirGerenciadorPool('DoenÃ§as Familiares', 'poolDoencasFamiliares', 'prontuario_poolDoencasFamiliares', '#f59e0b');
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // HISTÃ“RIA SOCIAL - ATIVIDADES E DROGAS
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarAtividade: function() {
                // v10.437: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.atividades.length + 1;
                
                this.contadorAtividades++;
                const id = this.contadorAtividades;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-atividade-${id}`;
                card.style.borderLeftColor = '#4caf50';
                card.innerHTML = `
                    <div class="prontuario-item-card-header">
                        <strong style="color: #4caf50;">Atividade ${numero}</strong>
                        <button class="prontuario-btn-remover" onclick="ProntuarioModular.removerAtividade(${id})">ğŸ—‘ï¸</button>
                    </div>
                    <div class="prontuario-form-grid">
                        <div class="prontuario-form-group">
                            <label>Tipo de Atividade</label>
                            <input type="text" placeholder="Ex: Caminhada, MusculaÃ§Ã£o..." style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                        </div>
                        <div class="prontuario-form-group">
                            <label>FrequÃªncia</label>
                            <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                <option>1-2x/semana</option>
                                <option>3-4x/semana</option>
                                <option>5-6x/semana</option>
                                <option>Diariamente</option>
                            </select>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaAtividades');
                if (lista) lista.appendChild(card);
                this.atividades.push(id);
            },
            
            removerAtividade: function(id) {
                const card = document.getElementById(`pront-atividade-${id}`);
                if (card) card.remove();
                this.atividades = this.atividades.filter(a => a !== id);
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // TABAGISMO - MÃšLTIPLOS ITENS
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarTabaco: function() {
                // v10.438: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.tabacos.length + 1;
                
                this.contadorTabacos++;
                const id = this.contadorTabacos;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = 'pront-tabaco-' + id;
                card.style.borderLeftColor = '#795548';
                card.innerHTML = `
                    <div class="prontuario-item-card-header">
                        <strong style="color: #795548;">ğŸš¬ Tipo de Fumo ${numero}</strong>
                        <button class="prontuario-btn-remover" onclick="ProntuarioModular.removerTabaco(${id})">ğŸ—‘ï¸</button>
                    </div>
                    <div class="prontuario-form-grid">
                        <div class="prontuario-form-group">
                            <label>Tipo</label>
                            <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                <option>Cigarro industrial</option>
                                <option>Cigarro de palha</option>
                                <option>Charuto</option>
                                <option>Cachimbo</option>
                                <option>NarguilÃ©</option>
                                <option>Cigarro eletrÃ´nico/Vape</option>
                                <option>Outro</option>
                            </select>
                        </div>
                        <div class="prontuario-form-group">
                            <label>Quantidade</label>
                            <div style="display: flex; gap: 8px;">
                                <input type="number" placeholder="20" style="width: 80px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; text-align: center;">
                                <select style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                    <option>cigarros/dia</option>
                                    <option>maÃ§os/dia</option>
                                    <option>por semana</option>
                                </select>
                            </div>
                        </div>
                        <div class="prontuario-form-group">
                            <label>Tempo de uso</label>
                            <div style="display: flex; gap: 8px;">
                                <input type="number" placeholder="10" style="width: 80px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; text-align: center;">
                                <select style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                    <option>anos</option>
                                    <option>meses</option>
                                    <option>parou hÃ¡ (anos)</option>
                                    <option>parou hÃ¡ (meses)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaTabaco');
                if (lista) lista.appendChild(card);
                this.tabacos.push(id);
            },
            
            removerTabaco: function(id) {
                const card = document.getElementById('pront-tabaco-' + id);
                if (card) card.remove();
                this.tabacos = this.tabacos.filter(t => t !== id);
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // ETILISMO - MÃšLTIPLOS ITENS
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            adicionarAlcool: function() {
                // v10.437: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.bebidas.length + 1;
                
                this.contadorBebidas++;
                const id = this.contadorBebidas;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = 'pront-alcool-' + id;
                card.style.borderLeftColor = '#f59e0b';
                card.innerHTML = `
                    <div class="prontuario-item-card-header">
                        <strong style="color: #f59e0b;">ğŸº Bebida ${numero}</strong>
                        <button class="prontuario-btn-remover" onclick="ProntuarioModular.removerAlcool(${id})">ğŸ—‘ï¸</button>
                    </div>
                    <div class="prontuario-form-grid">
                        <div class="prontuario-form-group">
                            <label>Tipo de bebida</label>
                            <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                <option>Cerveja</option>
                                <option>Vinho</option>
                                <option>CachaÃ§a/Pinga</option>
                                <option>Whisky</option>
                                <option>Vodka</option>
                                <option>Destilados</option>
                                <option>Outro</option>
                            </select>
                        </div>
                        <div class="prontuario-form-group">
                            <label>Quantidade</label>
                            <div style="display: flex; gap: 8px;">
                                <input type="number" placeholder="2" style="width: 80px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; text-align: center;">
                                <select style="flex: 1; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                    <option>latas/dia</option>
                                    <option>taÃ§as/dia</option>
                                    <option>doses/dia</option>
                                    <option>garrafas/semana</option>
                                </select>
                            </div>
                        </div>
                        <div class="prontuario-form-group">
                            <label>FrequÃªncia</label>
                            <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                <option>DiÃ¡rio</option>
                                <option>Fins de semana</option>
                                <option>Ocasional</option>
                                <option>Parou hÃ¡...</option>
                            </select>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaAlcool');
                if (lista) lista.appendChild(card);
                this.bebidas.push(id);
            },
            
            removerAlcool: function(id) {
                const card = document.getElementById('pront-alcool-' + id);
                if (card) card.remove();
                this.bebidas = this.bebidas.filter(b => b !== id);
            },
            
            adicionarDroga: function() {
                // v10.438: Calcular nÃºmero visual baseado no tamanho da lista
                const numero = this.drogas.length + 1;
                
                this.contadorDrogas++;
                const id = this.contadorDrogas;
                
                const card = document.createElement('div');
                card.className = 'prontuario-item-card';
                card.id = `pront-droga-${id}`;
                card.style.borderLeftColor = '#ff5722';
                card.innerHTML = `
                    <div class="prontuario-item-card-header">
                        <strong style="color: #ff5722;">SubstÃ¢ncia ${numero}</strong>
                        <button class="prontuario-btn-remover" onclick="ProntuarioModular.removerDroga(${id})">ğŸ—‘ï¸</button>
                    </div>
                    <div class="prontuario-form-grid">
                        <div class="prontuario-form-group">
                            <label>Tipo</label>
                            <input type="text" placeholder="Ex: Maconha, CocaÃ­na..." style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                        </div>
                        <div class="prontuario-form-group">
                            <label>FrequÃªncia</label>
                            <select style="padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px;">
                                <option>EsporÃ¡dico</option>
                                <option>Social</option>
                                <option>Semanal</option>
                                <option>DiÃ¡rio</option>
                                <option>Ex-usuÃ¡rio</option>
                            </select>
                        </div>
                        <div class="prontuario-form-group full">
                            <label>ObservaÃ§Ãµes</label>
                            <textarea style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; min-height: 50px;" placeholder="Via de uso, hÃ¡ quanto tempo, tentativas de parar..."></textarea>
                        </div>
                    </div>
                `;
                
                const lista = document.getElementById('pront-listaDrogas');
                if (lista) lista.appendChild(card);
                this.drogas.push(id);
            },
            
            removerDroga: function(id) {
                const card = document.getElementById(`pront-droga-${id}`);
                if (card) card.remove();
                this.drogas = this.drogas.filter(d => d !== id);
            }
        };
        
        // Inicializar ProntuarioModular quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', () => {
            // v10.405: CRÃTICO! Definir window.TEMPLATES_MODULOS ANTES de tudo
            // Esta definiÃ§Ã£o estava dentro do Sandbox e sÃ³ era criada quando Sandbox era aberto
            // Agora Ã© criada na inicializaÃ§Ã£o para Atendimentos poder usar
            console.log('ğŸ“‹ [v10.405] Inicializando window.TEMPLATES_MODULOS...');
            
            if (typeof window.TEMPLATES_MODULOS === 'undefined') {
                // Carregar templates do Sandbox
                // IMPORTANTE: Sandbox.carregarTemplatesGlobais() deve definir window.TEMPLATES_MODULOS
                if (typeof Sandbox !== 'undefined' && typeof Sandbox.carregarTemplatesGlobais === 'function') {
                    Sandbox.carregarTemplatesGlobais();
                    console.log('âœ… [v10.405] window.TEMPLATES_MODULOS carregado via Sandbox');
                } else {
                    console.error('âŒ [v10.405] Sandbox.carregarTemplatesGlobais() nÃ£o encontrado!');
                }
            } else {
                console.log('âœ… [v10.405] window.TEMPLATES_MODULOS jÃ¡ existe');
            }
            
            ProntuarioModular.init();
        });
        
        window.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ Iniciando Sistema Hospitalar Integrado v10.167 - HIERARQUIAS ANATÃ”MICAS...');
            console.log('ğŸ†” ARQUIVO: SISTEMA_FINAL_v10_134.html');
            console.log('ğŸ“… Gerado: 15/11/2025 12:55');
            console.log('âœ… TODOS OS BUGS CORRIGIDOS:');
            console.log('   â€¢ EditorVisual null check');
            console.log('   â€¢ CÃ³digo quebrado Anatomia v10.133 removido');
            console.log('   â€¢ Syntax error linha 31422 corrigido');
            console.log('âœ… Estrutura de permissÃµes granulares carregada!');
            console.log('âœ… MÃ³dulo de equipes preparado!');
            console.log('ğŸ—ºï¸ Interface "GestÃ£o do Estabelecimento" e "Mapa das Unidades" ativadas!');
            console.log('ğŸ“… Status "Reservado" implementado com sucesso!');
            console.log('âœ… Estabelecimento agora mostra TODOS os agendamentos (nÃ£o apenas hoje)!');
            console.log('âœ… Agenda simplificada: apenas visualizaÃ§Ã£o, sem botÃµes de gerenciamento!');
            console.log('ğŸ¯ Dashboard inteligente com notificaÃ§Ãµes e estatÃ­sticas completas!');
            console.log('ğŸ”” Sistema de notificaÃ§Ãµes ativo!');
            console.log('ğŸ“† Datas compactas e visÃ­veis em todos os agendamentos!');
            console.log('âš¡ Limite de 5 agendamentos visÃ­veis com botÃ£o "Ver mais"!');
            console.log('ğŸ¨ Sistema de customizaÃ§Ã£o: Favoritos â­ + Esconder/Mostrar ğŸ‘ï¸ + Filtros!');
            console.log('ğŸ› BUGS CORRIGIDOS: Filtros, Pools, Scrollbars!');
            
            // Inicializar mÃ¡scaras PRIMEIRO
            Mascaras.init();
            
            // v10.33: Ordenar todos os dropdowns alfabeticamente
            OrdenarDropdowns.ordenarTodos();
            
            // Inicializar autenticaÃ§Ã£o primeiro
            Auth.init();
            
            // Inicializar sistema se estiver logado
            if (Auth.usuarioAtual) {
                Sistema.init();
                Estabelecimento.carregar();
                Reparticoes.listar();
                
                // v10.100: MIGRAÃ‡ÃƒO AUTOMÃTICA - Corrigir tipo_reparticao nas sub-repartiÃ§Ãµes
                (() => {
                    console.log('ğŸ”„ [MIGRAÃ‡ÃƒO v10.100] Verificando tipos de repartiÃ§Ã£o...');
                    let corrigidos = 0;
                    const grupos = SistemaCore.dados.reparticoes.filter(r => r.eh_grupo && r.subreparticoes_ids);
                    
                    grupos.forEach(grupo => {
                        const tipoGrupo = grupo.tipo_reparticao;
                        if (!tipoGrupo) return;
                        
                        grupo.subreparticoes_ids.forEach(subId => {
                            const sub = SistemaCore.dados.reparticoes.find(r => r.id === subId);
                            if (sub && !sub.tipo_reparticao) {
                                sub.tipo_reparticao = tipoGrupo;
                                corrigidos++;
                                console.log(`   âœ… ${sub.nome}: tipo_reparticao = "${tipoGrupo}"`);
                            }
                        });
                    });
                    
                    if (corrigidos > 0) {
                        SistemaCore.salvar();
                        console.log(`âœ… [MIGRAÃ‡ÃƒO] ${corrigidos} sub-repartiÃ§Ãµes corrigidas!`);
                        Sistema.notificar(`ğŸ”„ MigraÃ§Ã£o concluÃ­da: ${corrigidos} unidade(s) corrigida(s)`, 'success');
                        // Recarregar mapa para mostrar as correÃ§Ãµes
                        Reparticoes.listar();
                    } else {
                        console.log('âœ… [MIGRAÃ‡ÃƒO] Nenhuma correÃ§Ã£o necessÃ¡ria');
                    }
                })();
                
                Pools.listar(); // v7.3: Inicializar pools
                Profissionais.listar();
                Pacientes.listar();
                Pacientes.criarPacienteTeste(); // v10.41: Criar paciente teste para desenvolvimento
                
                // v10.43: Atualizar card do sandbox com dados do paciente teste
                const pacienteTeste = SistemaCore.dados.pacientes.find(p => p.cpf === '000.000.000-00');
                if (pacienteTeste && document.getElementById('sandbox-prontuario')) {
                    document.getElementById('sandbox-prontuario').textContent = pacienteTeste.prontuario || '-';
                }
                
                Prontuarios.init();
                FolhaRosto.init(); // v10.6: Inicializar Folha de Rosto
                Cabecalhos.init(); // v10.45: Inicializar Biblioteca de CabeÃ§alhos
                Elementos.init(); // v10.346: Inicializar Elementos do Atendimento
                DadosClinicos.init(); // v10.12.0: Inicializar Dados ClÃ­nicos (cadastro)
                Templates.init(); // v10.12.3: Inicializar Templates de prontuÃ¡rio
                
                // v10.15.0: Event listener para fechar modal ao clicar fora
                const modalTemplate = document.getElementById('modal-template');
                if (modalTemplate) {
                    modalTemplate.addEventListener('click', function(e) {
                        if (e.target === modalTemplate) {
                            Templates.fecharModal();
                        }
                    });
                }
                
                TiposDocumento.init(); // v10.12.0: Inicializar Tipos de Documento
                Manchester.init(); // v10.9: Inicializar Protocolo Manchester
                Gestao.carregarConfiguracoes(); // v10.9: Carregar configuraÃ§Ãµes do hospital
                Calendario.init();
                Permissoes.carregar();
                
                // v10.463: Inicializar recepÃ§Ã£o com dropdown de agendados
                if (typeof Atendimentos !== 'undefined') {
                    Atendimentos.initRecepcao();
                }
                
                // Definir data de hoje no filtro de atendimentos
                document.getElementById('filtro-data-atendimento').value = new Date().toISOString().split('T')[0];
            }
            
            // v10.60.4: Event listener removido pois prof-especialidade-input nÃ£o existe mais
            
            console.log('âœ… Sistema pronto com mÃ¡scaras aplicadas!');
        });
        
        // ============================================
        // FUNÃ‡Ã•ES GLOBAIS PARA MÃ“DULO EXPECTATIVAS
        // ============================================
        
        function inicializarModuloExpectativas(configId) {
            console.log('ğŸ”§ Inicializando expectativas:', configId);
            
            // Criar ID seguro (sem hÃ­fens) para nomes de funÃ§Ãµes
            const configIdSafe = configId.replace(/-/g, '_');
            
            // Criar array de dados se nÃ£o existir
            if (!window['expectativas_' + configIdSafe + '_dados']) {
                window['expectativas_' + configIdSafe + '_dados'] = [];
            }
            
            // Popular select
            const select = document.getElementById('selectExpectativa_' + configId);
            if (select) {
                select.innerHTML = '<option value="">Selecione uma expectativa...</option>';
                POOLS_DADOS.expectativas.sort().forEach(exp => {
                    select.innerHTML += `<option value="${exp}">${exp}</option>`;
                });
            }
            
            // FunÃ§Ã£o adicionar do select
            window['expectativas_' + configIdSafe + '_adicionar'] = function() {
                const select = document.getElementById('selectExpectativa_' + configId);
                const valor = select.value;
                console.log('âœ… Adicionar expectativa:', valor);
                
                if (valor) {
                    const dados = window['expectativas_' + configIdSafe + '_dados'];
                    if (!dados.includes(valor)) {
                        dados.push(valor);
                        window['expectativas_' + configIdSafe + '_renderizar']();
                    }
                }
                select.value = '';
            };
            
            // FunÃ§Ã£o criar nova
            window['expectativas_' + configIdSafe + '_criarNova'] = function() {
                const input = document.getElementById('novaExpectativa_' + configId);
                const valor = input.value.trim();
                console.log('âœ… Criar nova expectativa:', valor);
                
                if (valor) {
                    // Adicionar ao pool
                    if (!POOLS_DADOS.expectativas.includes(valor)) {
                        POOLS_DADOS.expectativas.push(valor);
                        salvarPool('expectativas', POOLS_DADOS.expectativas);
                        // Atualizar select
                        const select = document.getElementById('selectExpectativa_' + configId);
                        if (select) {
                            select.innerHTML = '<option value="">Selecione uma expectativa...</option>';
                            POOLS_DADOS.expectativas.sort().forEach(exp => {
                                select.innerHTML += `<option value="${exp}">${exp}</option>`;
                            });
                        }
                    }
                    // Adicionar aos dados
                    const dados = window['expectativas_' + configIdSafe + '_dados'];
                    if (!dados.includes(valor)) {
                        dados.push(valor);
                        window['expectativas_' + configIdSafe + '_renderizar']();
                    }
                }
                input.value = '';
            };
            
            // FunÃ§Ã£o remover
            window['expectativas_' + configIdSafe + '_remover'] = function(index) {
                console.log('âœ… Remover expectativa:', index);
                const dados = window['expectativas_' + configIdSafe + '_dados'];
                dados.splice(index, 1);
                window['expectativas_' + configIdSafe + '_renderizar']();
            };
            
            // FunÃ§Ã£o renderizar
            window['expectativas_' + configIdSafe + '_renderizar'] = function() {
                const container = document.getElementById('tagsExpectativas_' + configId);
                if (!container) return;
                
                const dados = window['expectativas_' + configIdSafe + '_dados'];
                container.innerHTML = '';
                
                if (dados.length === 0) {
                    container.innerHTML = '<div style="color: #999; font-style: italic;">Nenhuma expectativa selecionada</div>';
                    return;
                }
                
                dados.forEach((exp, index) => {
                    const tag = document.createElement('div');
                    tag.className = 'tag-expectativa';
                    tag.innerHTML = exp + ' <button onclick="window.expectativas_' + configIdSafe + '_remover(' + index + ')">Ã—</button>';
                    container.appendChild(tag);
                });
            };
            
            // Renderizar estado inicial
            window['expectativas_' + configIdSafe + '_renderizar']();
            
            console.log('âœ… Expectativas inicializado:', configId);
        }
        
        // ============================================
        // v10.439: FUNÃ‡ÃƒO GLOBAL - ATUALIZAR CABEÃ‡ALHO EM TEMPO REAL
        // ============================================
        
        window.atualizarCabecalhoAtendimento = function() {
            try {
                console.log('ğŸ”„ [v10.444] Atualizando cabeÃ§alho em tempo real...');
                
                // v10.444: IDs CORRETOS!
                const container = document.getElementById('atend-modulos-container-novo');
                const conteudo = document.getElementById('atend-modulos-conteudo-novo');
                
                if (!container || !conteudo || container.style.display === 'none') {
                    console.log('âš ï¸ [v10.444] ProntuÃ¡rio nÃ£o estÃ¡ aberto');
                    console.log('   container existe?', !!container);
                    console.log('   conteudo existe?', !!conteudo);
                    console.log('   container visÃ­vel?', container?.style.display !== 'none');
                    return;
                }
                
                console.log('âœ… [v10.445] ProntuÃ¡rio estÃ¡ aberto!');
                
                // v10.445: ID CORRETO do select de modelo!
                const modeloSelect = document.getElementById('atend-modelo-prontuario-novo');
                if (!modeloSelect || !modeloSelect.value) {
                    console.log('âš ï¸ [v10.445] Nenhum modelo selecionado');
                    console.log('   modeloSelect existe?', !!modeloSelect);
                    console.log('   modeloSelect.value:', modeloSelect?.value);
                    return;
                }
                
                console.log('âœ… [v10.445] Modelo select encontrado! Valor:', modeloSelect.value);
                
                const modeloId = parseInt(modeloSelect.value);
                const modelo = SistemaCore.dados.modelos_atendimento?.find(m => m.id === modeloId);
                
                if (!modelo || !modelo.cabecalho_id) {
                    console.log('âš ï¸ [v10.445] Modelo sem cabeÃ§alho');
                    console.log('   modelo encontrado?', !!modelo);
                    console.log('   modelo.cabecalho_id:', modelo?.cabecalho_id);
                    return;
                }
                
                console.log('âœ… [v10.445] Modelo encontrado:', modelo.nome);
                console.log('   cabecalho_id:', modelo.cabecalho_id);
                
                // Buscar layout do cabeÃ§alho
                const layout = SistemaCore.dados.cabecalhos?.find(l => l.id == modelo.cabecalho_id);
                if (!layout) {
                    console.log('âŒ [v10.445] Layout de cabeÃ§alho nÃ£o encontrado');
                    return;
                }
                
                console.log('âœ… [v10.445] Layout encontrado:', layout.nome);
                
                // Renderizar cabeÃ§alho NOVO (vai pegar alergias da tela!)
                console.log('ğŸ¨ [v10.445] Renderizando cabeÃ§alho...');
                const cabecalhoRendered = Sandbox.renderizarCabecalhoLayout(layout);
                const cabecalhoHTML = `
                    <div style="background: white; border: 2px solid #667eea; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
                        ${cabecalhoRendered}
                    </div>
                `;
                
                // v10.445: Substituir sÃ³ o cabeÃ§alho (primeira div)
                const divs = conteudo.children;
                if (divs.length > 0) {
                    console.log('ğŸ”„ [v10.445] Substituindo primeira div (cabeÃ§alho)...');
                    divs[0].outerHTML = cabecalhoHTML;
                    console.log('âœ… [v10.445] CabeÃ§alho atualizado com sucesso!');
                    console.log('');
                    console.log('ğŸ‰ğŸ‰ğŸ‰ CABEÃ‡ALHO DO ATENDIMENTO ATUALIZADO! ğŸ‰ğŸ‰ğŸ‰');
                    console.log('');
                } else {
                    console.warn('âš ï¸ [v10.445] Nenhuma div encontrada em conteudo!');
                }
            } catch (erro) {
                console.error('âŒ [v10.445] Erro ao atualizar cabeÃ§alho:', erro);
                console.error('Stack:', erro.stack);
            }
        };
        
        // ============================================
        // v10.443: FUNÃ‡ÃƒO GLOBAL UNIVERSAL - ATUALIZA AMBOS!
        // ============================================
        
        window.atualizarTodosCabecalhos = function() {
            console.log('');
            console.log('ğŸ”„ğŸ”„ğŸ”„ [v10.443] atualizarTodosCabecalhos() CHAMADO!');
            console.log('');
            
            // 1. Tentar atualizar cabeÃ§alho de Atendimento
            if (typeof window.atualizarCabecalhoAtendimento === 'function') {
                console.log('   â†’ Chamando window.atualizarCabecalhoAtendimento()...');
                try {
                    window.atualizarCabecalhoAtendimento();
                } catch (e) {
                    console.error('   âŒ Erro:', e);
                }
            } else {
                console.log('   âš ï¸ window.atualizarCabecalhoAtendimento nÃ£o existe');
            }
            
            // 2. Tentar atualizar cabeÃ§alho do Sandbox
            if (typeof Sandbox !== 'undefined' && typeof Sandbox.atualizarCabecalho === 'function') {
                console.log('   â†’ Chamando Sandbox.atualizarCabecalho()...');
                try {
                    Sandbox.atualizarCabecalho();
                } catch (e) {
                    console.error('   âŒ Erro:', e);
                }
            } else {
                console.log('   âš ï¸ Sandbox.atualizarCabecalho nÃ£o existe');
            }
            
            console.log('');
            console.log('âœ… atualizarTodosCabecalhos() FINALIZADO');
            console.log('');
        };
        
        // ============================================
        // FUNÃ‡Ã•ES GLOBAIS PARA MÃ“DULO ALERGIAS
        // ============================================
        
        function inicializarModuloAlergias(configId) {
            console.log('ğŸ”§ Inicializando alergias:', configId);
            const configIdSafe = configId.replace(/-/g, '_');
            
            // Inicializar arrays
            if (!window['alergias_' + configIdSafe + '_ids']) {
                window['alergias_' + configIdSafe + '_ids'] = [];
                window['alergias_' + configIdSafe + '_contador'] = 0;
            }
            
            // FunÃ§Ã£o toggle sim/nÃ£o
            window['alergias_' + configIdSafe + '_toggle'] = function(mostrar) {
                const btnArea = document.getElementById('btnAreaAlergias_' + configId);
                if (btnArea) {
                    btnArea.style.display = mostrar ? 'block' : 'none';
                }
            };
            
            // FunÃ§Ã£o adicionar card
            window['alergias_' + configIdSafe + '_adicionar'] = function() {
                const ids = window['alergias_' + configIdSafe + '_ids'];
                
                // v10.435: Usar TAMANHO da lista + 1 (nÃ£o contador global!)
                const numero = ids.length + 1;
                const contador = ++window['alergias_' + configIdSafe + '_contador'];
                
                ids.push(contador);
                
                const card = document.createElement('div');
                card.className = 'item-card';
                card.id = 'cardAlergia_' + configId + '_' + contador;
                card.style.borderLeftColor = '#f44336';
                card.innerHTML = `
                    <div class="item-card-header">
                        <strong style="color: #f44336;">Alergia ${numero}</strong>
                        <button class="btn-remover-item" onclick="window.alergias_${configIdSafe}_remover(${contador})">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 400px 1fr; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #555; font-size: 13px;">Tipo de Alergia</label>
                            <select id="selectAlergia_${configId}_${contador}" style="width: 400px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; margin-bottom: 8px; box-sizing: border-box;">
                                <option value="">Selecione...</option>
                                ${POOLS_DADOS.alergias.sort().map(a => `<option value="${a}">${a}</option>`).join('')}
                            </select>
                            <button onclick="window.alergias_${configIdSafe}_criarNova_${contador}()" style="width: 400px; padding: 10px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 13px; box-sizing: border-box;">
                                âœ¨ Criar Nova
                            </button>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #555; font-size: 13px;">ObservaÃ§Ãµes</label>
                            <textarea id="obsAlergia_${configId}_${contador}" placeholder="Ex: Choque anafilÃ¡tico em 2010..." rows="4" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; resize: vertical; font-size: 13px; box-sizing: border-box;"></textarea>
                        </div>
                    </div>
                `;
                
                document.getElementById('listaAlergias_' + configId).appendChild(card);
                
                // FunÃ§Ã£o criar nova para este card especÃ­fico
                window['alergias_' + configIdSafe + '_criarNova_' + contador] = function() {
                    const novaAlergia = prompt('Digite o nome da nova alergia:');
                    if (novaAlergia && novaAlergia.trim()) {
                        const valor = novaAlergia.trim();
                        if (!POOLS_DADOS.alergias.includes(valor)) {
                            POOLS_DADOS.alergias.push(valor);
                            salvarPool('alergias', POOLS_DADOS.alergias);
                        }
                        // Atualizar select deste card
                        const select = document.getElementById('selectAlergia_' + configId + '_' + contador);
                        if (select) {
                            select.innerHTML = '<option value="">Selecione...</option>';
                            POOLS_DADOS.alergias.sort().forEach(a => {
                                select.innerHTML += `<option value="${a}">${a}</option>`;
                            });
                            select.value = valor;
                        }
                    }
                };
            };
            
            // FunÃ§Ã£o remover card
            window['alergias_' + configIdSafe + '_remover'] = function(id) {
                document.getElementById('cardAlergia_' + configId + '_' + id)?.remove();
                const ids = window['alergias_' + configIdSafe + '_ids'];
                window['alergias_' + configIdSafe + '_ids'] = ids.filter(i => i !== id);
            };
            
            console.log('âœ… Alergias inicializado:', configId);
        }
        
        // ============================================
        // FUNÃ‡Ã•ES GLOBAIS PARA MÃ“DULO DOENÃ‡AS
        // ============================================
        
        function inicializarModuloDoencas(configId) {
            console.log('ğŸ”§ Inicializando doenÃ§as:', configId);
            const configIdSafe = configId.replace(/-/g, '_');
            
            // Inicializar arrays
            if (!window['doencas_' + configIdSafe + '_ids']) {
                window['doencas_' + configIdSafe + '_ids'] = [];
                window['doencas_' + configIdSafe + '_contador'] = 0;
            }
            
            // FunÃ§Ã£o toggle sim/nÃ£o
            window['doencas_' + configIdSafe + '_toggle'] = function(mostrar) {
                const btnArea = document.getElementById('btnAreaDoencas_' + configId);
                if (btnArea) {
                    btnArea.style.display = mostrar ? 'block' : 'none';
                }
            };
            
            // FunÃ§Ã£o adicionar card
            window['doencas_' + configIdSafe + '_adicionar'] = function() {
                const ids = window['doencas_' + configIdSafe + '_ids'];
                
                // v10.435: Usar TAMANHO da lista + 1
                const numero = ids.length + 1;
                const contador = ++window['doencas_' + configIdSafe + '_contador'];
                
                ids.push(contador);
                
                const card = document.createElement('div');
                card.className = 'item-card';
                card.id = 'cardDoenca_' + configId + '_' + contador;
                card.style.borderLeftColor = '#667eea';
                card.innerHTML = `
                    <div class="item-card-header">
                        <strong style="color: #667eea;">DoenÃ§a ${numero}</strong>
                        <button class="btn-remover-item" onclick="window.doencas_${configIdSafe}_remover(${contador})">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 400px 1fr; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #555; font-size: 13px;">Tipo de DoenÃ§a</label>
                            <select id="selectDoenca_${configId}_${contador}" style="width: 400px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; margin-bottom: 8px; box-sizing: border-box;">
                                <option value="">Selecione...</option>
                                ${POOLS_DADOS.doencas.sort().map(d => `<option value="${d}">${d}</option>`).join('')}
                            </select>
                            <button onclick="window.doencas_${configIdSafe}_criarNova_${contador}()" style="width: 400px; padding: 10px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 13px; box-sizing: border-box;">
                                âœ¨ Criar Nova
                            </button>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #555; font-size: 13px;">ObservaÃ§Ãµes</label>
                            <textarea id="obsDoenca_${configId}_${contador}" placeholder="Ex: Controlada com medicaÃ§Ã£o..." rows="4" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; resize: vertical; font-size: 13px; box-sizing: border-box;"></textarea>
                        </div>
                    </div>
                `;
                
                document.getElementById('listaDoencas_' + configId).appendChild(card);
                
                // FunÃ§Ã£o criar nova para este card especÃ­fico
                window['doencas_' + configIdSafe + '_criarNova_' + contador] = function() {
                    const novaDoenca = prompt('Digite o nome da nova doenÃ§a:');
                    if (novaDoenca && novaDoenca.trim()) {
                        const valor = novaDoenca.trim();
                        if (!POOLS_DADOS.doencas.includes(valor)) {
                            POOLS_DADOS.doencas.push(valor);
                            salvarPool('doencas', POOLS_DADOS.doencas);
                        }
                        // Atualizar select deste card
                        const select = document.getElementById('selectDoenca_' + configId + '_' + contador);
                        if (select) {
                            select.innerHTML = '<option value="">Selecione...</option>';
                            POOLS_DADOS.doencas.sort().forEach(d => {
                                select.innerHTML += `<option value="${d}">${d}</option>`;
                            });
                            select.value = valor;
                        }
                    }
                };
            };
            
            // FunÃ§Ã£o remover card
            window['doencas_' + configIdSafe + '_remover'] = function(id) {
                document.getElementById('cardDoenca_' + configId + '_' + id)?.remove();
                const ids = window['doencas_' + configIdSafe + '_ids'];
                window['doencas_' + configIdSafe + '_ids'] = ids.filter(i => i !== id);
            };
            
            console.log('âœ… DoenÃ§as inicializado:', configId);
        }
        
        // ============================================
        // FUNÃ‡Ã•ES GLOBAIS PARA MÃ“DULO CIRURGIAS
        // ============================================
        
        function inicializarModuloCirurgias(configId) {
            console.log('ğŸ”§ Inicializando cirurgias:', configId);
            const configIdSafe = configId.replace(/-/g, '_');
            
            // Inicializar arrays
            if (!window['cirurgias_' + configIdSafe + '_ids']) {
                window['cirurgias_' + configIdSafe + '_ids'] = [];
                window['cirurgias_' + configIdSafe + '_contador'] = 0;
            }
            
            // FunÃ§Ã£o toggle sim/nÃ£o
            window['cirurgias_' + configIdSafe + '_toggle'] = function(mostrar) {
                const btnArea = document.getElementById('btnAreaCirurgias_' + configId);
                if (btnArea) {
                    btnArea.style.display = mostrar ? 'block' : 'none';
                }
            };
            
            // FunÃ§Ã£o adicionar card
            window['cirurgias_' + configIdSafe + '_adicionar'] = function() {
                const ids = window['cirurgias_' + configIdSafe + '_ids'];
                
                // v10.435: Usar TAMANHO da lista + 1
                const numero = ids.length + 1;
                const contador = ++window['cirurgias_' + configIdSafe + '_contador'];
                
                ids.push(contador);
                
                const card = document.createElement('div');
                card.className = 'item-card';
                card.id = 'cardCirurgia_' + configId + '_' + contador;
                card.style.borderLeftColor = '#f97316';
                card.innerHTML = `
                    <div class="item-card-header">
                        <strong style="color: #f97316;">Cirurgia ${numero}</strong>
                        <button class="btn-remover-item" onclick="window.cirurgias_${configIdSafe}_remover(${contador})">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 400px 1fr; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #555; font-size: 13px;">Tipo de Cirurgia</label>
                            <select id="selectCirurgia_${configId}_${contador}" style="width: 400px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; margin-bottom: 8px; box-sizing: border-box;">
                                <option value="">Selecione...</option>
                                ${POOLS_DADOS.cirurgias.sort().map(c => `<option value="${c}">${c}</option>`).join('')}
                            </select>
                            <button onclick="window.cirurgias_${configIdSafe}_criarNova_${contador}()" style="width: 400px; padding: 10px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 13px; box-sizing: border-box;">
                                âœ¨ Criar Nova
                            </button>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #555; font-size: 13px;">ObservaÃ§Ãµes</label>
                            <textarea id="obsCirurgia_${configId}_${contador}" placeholder="Ex: Realizada em 2018, sem complicaÃ§Ãµes..." rows="4" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; resize: vertical; font-size: 13px; box-sizing: border-box;"></textarea>
                        </div>
                    </div>
                `;
                
                document.getElementById('listaCirurgias_' + configId).appendChild(card);
                
                // FunÃ§Ã£o criar nova para este card especÃ­fico
                window['cirurgias_' + configIdSafe + '_criarNova_' + contador] = function() {
                    const novaCirurgia = prompt('Digite o nome da nova cirurgia:');
                    if (novaCirurgia && novaCirurgia.trim()) {
                        const valor = novaCirurgia.trim();
                        if (!POOLS_DADOS.cirurgias.includes(valor)) {
                            POOLS_DADOS.cirurgias.push(valor);
                            salvarPool('cirurgias', POOLS_DADOS.cirurgias);
                        }
                        // Atualizar select deste card
                        const select = document.getElementById('selectCirurgia_' + configId + '_' + contador);
                        if (select) {
                            select.innerHTML = '<option value="">Selecione...</option>';
                            POOLS_DADOS.cirurgias.sort().forEach(c => {
                                select.innerHTML += `<option value="${c}">${c}</option>`;
                            });
                            select.value = valor;
                        }
                    }
                };
            };
            
            // FunÃ§Ã£o remover card
            window['cirurgias_' + configIdSafe + '_remover'] = function(id) {
                document.getElementById('cardCirurgia_' + configId + '_' + id)?.remove();
                const ids = window['cirurgias_' + configIdSafe + '_ids'];
                window['cirurgias_' + configIdSafe + '_ids'] = ids.filter(i => i !== id);
            };
            
            console.log('âœ… Cirurgias inicializado:', configId);
        }
        
        // ============================================
        // FUNÃ‡Ã•ES GLOBAIS PARA MÃ“DULO MEDICAÃ‡Ã•ES
        // ============================================
        
        function inicializarModuloMedicacoes(configId) {
            console.log('ğŸ”§ Inicializando medicaÃ§Ãµes:', configId);
            const configIdSafe = configId.replace(/-/g, '_');
            
            // Inicializar arrays
            if (!window['medicacoes_' + configIdSafe + '_ids']) {
                window['medicacoes_' + configIdSafe + '_ids'] = [];
                window['medicacoes_' + configIdSafe + '_contador'] = 0;
            }
            
            // FunÃ§Ã£o toggle sim/nÃ£o
            window['medicacoes_' + configIdSafe + '_toggle'] = function(mostrar) {
                const btnArea = document.getElementById('btnAreaMedicacoes_' + configId);
                if (btnArea) {
                    btnArea.style.display = mostrar ? 'block' : 'none';
                }
            };
            
            // FunÃ§Ã£o adicionar card
            window['medicacoes_' + configIdSafe + '_adicionar'] = function() {
                const ids = window['medicacoes_' + configIdSafe + '_ids'];
                
                // v10.435: Usar TAMANHO da lista + 1
                const numero = ids.length + 1;
                const contador = ++window['medicacoes_' + configIdSafe + '_contador'];
                
                ids.push(contador);
                
                const card = document.createElement('div');
                card.className = 'item-card';
                card.id = 'cardMedicacao_' + configId + '_' + contador;
                card.style.borderLeftColor = '#16a34a';
                card.innerHTML = `
                    <div class="item-card-header">
                        <strong style="color: #16a34a;">MedicaÃ§Ã£o ${numero}</strong>
                        <button class="btn-remover-item" onclick="window.medicacoes_${configIdSafe}_remover(${contador})">ğŸ—‘ï¸ Remover</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 400px 1fr; gap: 15px;">
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #555; font-size: 13px;">Nome da MedicaÃ§Ã£o</label>
                            <select id="selectMedicacao_${configId}_${contador}" style="width: 400px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 13px; margin-bottom: 8px; box-sizing: border-box;">
                                <option value="">Selecione...</option>
                                ${POOLS_DADOS.medicacoes.sort().map(m => `<option value="${m}">${m}</option>`).join('')}
                            </select>
                            <button onclick="window.medicacoes_${configIdSafe}_criarNova_${contador}()" style="width: 400px; padding: 10px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 13px; box-sizing: border-box;">
                                âœ¨ Criar Nova
                            </button>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 6px; font-weight: 600; color: #555; font-size: 13px;">Posologia / ObservaÃ§Ãµes</label>
                            <textarea id="obsMedicacao_${configId}_${contador}" placeholder="Ex: 25mg 1x/dia pela manhÃ£..." rows="4" style="width: 100%; padding: 10px; border: 1px solid #e0e0e0; border-radius: 6px; resize: vertical; font-size: 13px; box-sizing: border-box;"></textarea>
                        </div>
                    </div>
                `;
                
                document.getElementById('listaMedicacoes_' + configId).appendChild(card);
                
                // FunÃ§Ã£o criar nova para este card especÃ­fico
                window['medicacoes_' + configIdSafe + '_criarNova_' + contador] = function() {
                    const novaMedicacao = prompt('Digite o nome da nova medicaÃ§Ã£o:');
                    if (novaMedicacao && novaMedicacao.trim()) {
                        const valor = novaMedicacao.trim();
                        if (!POOLS_DADOS.medicacoes.includes(valor)) {
                            POOLS_DADOS.medicacoes.push(valor);
                            salvarPool('medicacoes', POOLS_DADOS.medicacoes);
                        }
                        // Atualizar select deste card
                        const select = document.getElementById('selectMedicacao_' + configId + '_' + contador);
                        if (select) {
                            select.innerHTML = '<option value="">Selecione...</option>';
                            POOLS_DADOS.medicacoes.sort().forEach(m => {
                                select.innerHTML += `<option value="${m}">${m}</option>`;
                            });
                            select.value = valor;
                        }
                    }
                };
            };
            
            // FunÃ§Ã£o remover card
            window['medicacoes_' + configIdSafe + '_remover'] = function(id) {
                document.getElementById('cardMedicacao_' + configId + '_' + id)?.remove();
                const ids = window['medicacoes_' + configIdSafe + '_ids'];
                window['medicacoes_' + configIdSafe + '_ids'] = ids.filter(i => i !== id);
            };
            
            console.log('âœ… MedicaÃ§Ãµes inicializado:', configId);
        }


        // v10.90: BUSCA GLOBAL COM DROPDOWN (Estilo Linx ClinicWeb)
        // v10.91: BUSCA GLOBAL SIMPLIFICADA E GARANTIDA
        // v10.92: BUSCA COM DROPDOWN NAS ABAS
        // Objeto para busca na aba Pacientes
        const BuscaPacientes = {
            normalizarTexto(texto) {
                if (!texto) return '';
                return texto.toLowerCase()
                    .normalize('NFD')
                    .replace(/[\u0300-\u036f]/g, '');
            },

            mostrar() {
                const dropdown = document.getElementById('dropdown-busca-pacientes');
                if (dropdown) {
                    dropdown.style.display = 'block';
                }
            },

            esconder() {
                const dropdown = document.getElementById('dropdown-busca-pacientes');
                if (dropdown) {
                    dropdown.style.display = 'none';
                }
            },

            buscar() {
                const input = document.getElementById('busca-pacientes');
                const dropdown = document.getElementById('dropdown-busca-pacientes');
                const container = document.getElementById('resultados-busca-pacientes');
                
                if (!input || !dropdown || !container) return;
                
                const termo = input.value.trim();
                
                // Mostrar dropdown
                dropdown.style.display = 'block';
                
                if (termo.length === 0) {
                    container.innerHTML = `
                        <div style="padding: 40px 20px; text-align: center; color: #9ca3af;">
                            <div style="font-size: 48px; opacity: 0.5;">ğŸ‘¥</div>
                            <div>Digite para buscar pacientes</div>
                        </div>
                    `;
                    return;
                }
                
                // BUSCA: COMEÃ‡AR COM (nÃ£o conter)
                const termoNorm = this.normalizarTexto(termo);
                const palavras = termoNorm.split(/\s+/).filter(p => p.length > 0);
                
                const pacientes = SistemaCore.dados.pacientes || [];
                const encontrados = pacientes.filter(pac => {
                    const nomeNorm = this.normalizarTexto(pac.nome || '');
                    
                    // IMPORTANTE: Verificar se alguma palavra do nome COMEÃ‡A com a busca
                    const palavrasNome = nomeNorm.split(/\s+/);
                    const nomeMatch = palavras.every(p => {
                        return palavrasNome.some(pn => pn.startsWith(p));
                    });
                    
                    // Busca por CPF
                    const cpf = (pac.cpf || '').replace(/\D/g, '');
                    const termoNum = termo.replace(/\D/g, '');
                    const cpfMatch = termoNum.length > 0 && cpf.startsWith(termoNum);
                    
                    // Busca por ProntuÃ¡rio
                    const pront = this.normalizarTexto(pac.prontuario || '');
                    const prontMatch = pront.startsWith(termoNorm);
                    
                    return nomeMatch || cpfMatch || prontMatch;
                });
                
                console.log(`ğŸ” Buscando "${termo}" - Encontrados: ${encontrados.length}`);
                
                if (encontrados.length === 0) {
                    container.innerHTML = `
                        <div style="padding: 40px 20px; text-align: center; color: #9ca3af;">
                            <div style="font-size: 48px; opacity: 0.5;">ğŸ”</div>
                            <div>Nenhum paciente encontrado</div>
                            <div style="font-size: 13px; margin-top: 8px;">
                                Nomes que comeÃ§am com "${termo}"
                            </div>
                        </div>
                    `;
                    return;
                }
                
                // Renderizar resultados (mÃ¡ximo 10)
                const top10 = encontrados.slice(0, 10);
                let html = '';
                
                top10.forEach(pac => {
                    const inicial = pac.nome ? pac.nome.charAt(0).toUpperCase() : '?';
                    const idade = pac.nascimento ? Pacientes.calcularIdadeDetalhada(pac.nascimento) : '';
                    const sexo = pac.sexo === 'M' ? 'â™‚ï¸' : pac.sexo === 'F' ? 'â™€ï¸' : '';
                    
                    html += `
                        <div class="busca-resultado-item" onclick="BuscaPacientes.selecionar(${pac.id})">
                            <div class="busca-resultado-avatar">${inicial}</div>
                            <div class="busca-resultado-info">
                                <div class="busca-resultado-nome">${pac.nome}</div>
                                <div class="busca-resultado-detalhes">
                                    ${sexo}
                                    ${idade ? `<span class="busca-resultado-badge badge-idade">${idade}</span>` : ''}
                                    <span>ğŸ“‹ ${pac.prontuario || 'S/N'}</span>
                                    ${pac.cpf ? `<span>${pac.cpf}</span>` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },

            selecionar(id) {
                this.esconder();
                document.getElementById('busca-pacientes').value = '';
                Pacientes.editar(id);
            }
        };

        // Objeto para busca na aba Profissionais
        const BuscaProfissionais = {
            normalizarTexto(texto) {
                if (!texto) return '';
                return texto.toLowerCase()
                    .normalize('NFD')
                    .replace(/[\u0300-\u036f]/g, '');
            },

            mostrar() {
                const dropdown = document.getElementById('dropdown-busca-profissionais');
                if (dropdown) {
                    dropdown.style.display = 'block';
                }
            },

            esconder() {
                const dropdown = document.getElementById('dropdown-busca-profissionais');
                if (dropdown) {
                    dropdown.style.display = 'none';
                }
            },

            buscar() {
                const input = document.getElementById('busca-profissionais');
                const dropdown = document.getElementById('dropdown-busca-profissionais');
                const container = document.getElementById('resultados-busca-profissionais');
                
                if (!input || !dropdown || !container) return;
                
                const termo = input.value.trim();
                
                // Mostrar dropdown
                dropdown.style.display = 'block';
                
                if (termo.length === 0) {
                    container.innerHTML = `
                        <div style="padding: 40px 20px; text-align: center; color: #9ca3af;">
                            <div style="font-size: 48px; opacity: 0.5;">ğŸ‘¨â€âš•ï¸</div>
                            <div>Digite para buscar profissionais</div>
                        </div>
                    `;
                    return;
                }
                
                // BUSCA: COMEÃ‡AR COM (nÃ£o conter)
                const termoNorm = this.normalizarTexto(termo);
                const palavras = termoNorm.split(/\s+/).filter(p => p.length > 0);
                
                const profissionais = SistemaCore.dados.profissionais || [];
                const encontrados = profissionais.filter(prof => {
                    const nomeNorm = this.normalizarTexto(prof.nome || '');
                    
                    // IMPORTANTE: Verificar se alguma palavra do nome COMEÃ‡A com a busca
                    const palavrasNome = nomeNorm.split(/\s+/);
                    const nomeMatch = palavras.every(p => {
                        return palavrasNome.some(pn => pn.startsWith(p));
                    });
                    
                    // Busca por CRM/COREN
                    const registro = this.normalizarTexto(prof.registro || '');
                    const registroMatch = registro.startsWith(termoNorm);
                    
                    // Busca por categoria
                    const categoria = this.normalizarTexto(prof.categoria_profissional || '');
                    const categoriaMatch = categoria.startsWith(termoNorm);
                    
                    // Busca por especialidade
                    const especialidade = this.normalizarTexto(prof.especialidade || '');
                    const especialidadeMatch = especialidade.startsWith(termoNorm);
                    
                    return nomeMatch || registroMatch || categoriaMatch || especialidadeMatch;
                });
                
                console.log(`ğŸ” Buscando "${termo}" - Encontrados: ${encontrados.length}`);
                
                if (encontrados.length === 0) {
                    container.innerHTML = `
                        <div style="padding: 40px 20px; text-align: center; color: #9ca3af;">
                            <div style="font-size: 48px; opacity: 0.5;">ğŸ”</div>
                            <div>Nenhum profissional encontrado</div>
                            <div style="font-size: 13px; margin-top: 8px;">
                                Nomes que comeÃ§am com "${termo}"
                            </div>
                        </div>
                    `;
                    return;
                }
                
                // Renderizar resultados (mÃ¡ximo 10)
                const top10 = encontrados.slice(0, 10);
                let html = '';
                
                top10.forEach(prof => {
                    const inicial = prof.nome ? prof.nome.charAt(0).toUpperCase() : '?';
                    const categoriaLabel = prof.categoria_profissional || 'Sem categoria';
                    const especialidadeLabel = prof.especialidade || '';
                    const registro = prof.registro || 'S/N';
                    
                    html += `
                        <div class="busca-resultado-item" onclick="BuscaProfissionais.selecionar(${prof.id})">
                            <div class="busca-resultado-avatar">${inicial}</div>
                            <div class="busca-resultado-info">
                                <div class="busca-resultado-nome">${prof.nome}</div>
                                <div class="busca-resultado-detalhes">
                                    <span class="busca-resultado-badge badge-idade">${categoriaLabel}</span>
                                    ${especialidadeLabel ? `<span>${especialidadeLabel}</span>` : ''}
                                    <span>ğŸ“‹ ${registro}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            },

            selecionar(id) {
                this.esconder();
                document.getElementById('busca-profissionais').value = '';
                Profissionais.editar(id);
            }
        };

        // Event listeners para fechar dropdowns
        document.addEventListener('click', (e) => {
            // Fechar dropdown de Pacientes
            const inputPacientes = document.getElementById('busca-pacientes');
            const dropdownPacientes = document.getElementById('dropdown-busca-pacientes');
            if (inputPacientes && dropdownPacientes && 
                !inputPacientes.contains(e.target) && 
                !dropdownPacientes.contains(e.target)) {
                BuscaPacientes.esconder();
            }
            
            // Fechar dropdown de Profissionais
            const inputProfissionais = document.getElementById('busca-profissionais');
            const dropdownProfissionais = document.getElementById('dropdown-busca-profissionais');
            if (inputProfissionais && dropdownProfissionais && 
                !inputProfissionais.contains(e.target) && 
                !dropdownProfissionais.contains(e.target)) {
                BuscaProfissionais.esconder();
            }
        });

        // Fechar dropdowns ao pressionar ESC
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                BuscaPacientes.esconder();
                BuscaProfissionais.esconder();
            }
        });
    </script>

        <style>
        #svg-anatomia .poligono-anatomia {
            cursor: pointer;
            transition: all 0.2s;
            fill-opacity: 0.3;
            stroke-width: 2;
        }
        #svg-anatomia .poligono-anatomia:hover {
            fill-opacity: 0.5;
        }
        #svg-anatomia .ponto-anatomia {
            cursor: pointer;
            transition: all 0.2s;
        }
        #svg-anatomia .ponto-anatomia:hover {
            r: 8;
        }
        #svg-anatomia .linha-preview {
            stroke-dasharray: 5,5;
            animation: dash-anatomia 0.5s linear infinite;
        }
        @keyframes dash-anatomia {
            to { stroke-dashoffset: -10; }
        }
        .regiao-anatomia-item {
            padding: 8px;
            margin-bottom: 6px;
            background: #f8f9fa;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .regiao-anatomia-item:hover {
            background: #e9ecef;
        }
        </style>

        <script>
        // ============================================================
        // ATLAS ANATÃ”MICO - Dados das 18 regiÃµes MACRO mapeadas
        // ============================================================
        
        // IMPORTANTE: ATLAS_ANATOMICO jÃ¡ foi carregado inline (linha ~7333)
        // com todos os dados e imagem. NÃƒO redeclarar!
        
        // ============================================================
        // SISTEMA DE TEMPLATES DISPONÃVEIS v10.157
        // ============================================================
        const TEMPLATES_DISPONIVEIS = {
            "avaliacao-mamaria-feminina": {
                id: "avaliacao-mamaria-feminina",
                nome: "ğŸ©º AvaliaÃ§Ã£o MamÃ¡ria - Feminino",
                descricao: "AvaliaÃ§Ã£o completa das mamas femininas",
                bilateral: true,
                campos: [
                    { id: "descricao-geral", tipo: "texto-livre", label: "DescriÃ§Ã£o", linhas: 3, bilateral: false },
                    { id: "codigo", tipo: "dropdown-bilateral", label: "ClassificaÃ§Ã£o", pool: "codigos-mama", bilateral: true },
                    { id: "volume", tipo: "numerico-bilateral", label: "Volume estimado", unidade: "mL", prefixo: "cerca de", bilateral: true },
                    { id: "simetria", tipo: "texto-livre", label: "Simetria (D Ã— E)", linhas: 2, bilateral: false },
                    { id: "cams", tipo: "texto-livre", label: "CAMs e mamilos", linhas: 2, bilateral: false },
                    { id: "flacidez", tipo: "radio-bilateral", label: "Flacidez", opcoes: ["ausente", "leve", "moderada", "grave"], bilateral: true },
                    { id: "ptose", tipo: "radio-bilateral", label: "Ptose", opcoes: ["ausente", "1", "2", "3", "pseudoptose"], bilateral: true },
                    { id: "dfe-cam", tipo: "numerico-bilateral", label: "DFE ao CAM", unidade: "cm", bilateral: true },
                    { id: "colo", tipo: "radio-bilateral", label: "Colo da mama", opcoes: ["curto", "normal", "longo"], bilateral: true },
                    { id: "outras", tipo: "texto-livre", label: "Outras alteraÃ§Ãµes", linhas: 5, bilateral: false }
                ],
                pools: {
                    "codigos-mama": ["PPPMGGG", "PPPMGGM", "PPPMGMP", "PPPMGPM", "PPPMGPP", "PPPMPGG", "PPPMPMG", "PPPMPMP", "PPPMPPM", "PPPMPPG", "PPPMPPP"]
                }
            },
            "avaliacao-mamaria-masculina": {
                id: "avaliacao-mamaria-masculina",
                nome: "ğŸ©º AvaliaÃ§Ã£o MamÃ¡ria - Masculino",
                descricao: "AvaliaÃ§Ã£o de ginecomastia",
                bilateral: true,
                campos: [
                    { id: "descricao", tipo: "texto-livre", label: "DescriÃ§Ã£o", linhas: 3, bilateral: false },
                    { id: "tipo", tipo: "radio-bilateral", label: "Tipo", opcoes: ["HipertrÃ³fica", "Normal", "HipertrÃ³fica", "Ginecomastia", "Pseudo-ginecomastia"], bilateral: true },
                    { id: "simon", tipo: "radio-bilateral", label: "ClassificaÃ§Ã£o de Simon", opcoes: ["I", "IIa", "IIb", "III"], bilateral: true },
                    { id: "outras", tipo: "texto-livre", label: "Outras alteraÃ§Ãµes", linhas: 3, bilateral: false }
                ],
                pools: {}
            },
            "avaliacao-facial": {
                id: "avaliacao-facial",
                nome: "ğŸ‘ï¸ AvaliaÃ§Ã£o Facial",
                descricao: "AvaliaÃ§Ã£o detalhada da face",
                bilateral: false,
                campos: [
                    { id: "achados", tipo: "texto-livre", label: "Achados", linhas: 5, bilateral: false }
                ],
                pools: {}
            },
            "avaliacao-palpebras": {
                id: "avaliacao-palpebras",
                nome: "ğŸ‘ï¸ AvaliaÃ§Ã£o Palpebral",
                descricao: "AvaliaÃ§Ã£o detalhada das pÃ¡lpebras",
                bilateral: false,
                campos: [
                    { 
                        id: "achados", 
                        tipo: "checkbox-grupo", 
                        label: "Achados ClÃ­nicos",
                        opcoes: [
                            "Bolsa palpebral", "Ptose", "Dermatocalasia",
                            "Blefarocalasia", "Xantelasma", "Blefarite", 
                            "ChalÃ¡zio", "HordÃ©olo", "Edema", "Hiperemia",
                            "LesÃµes cutÃ¢neas", "Cicatrizes", "Normal"
                        ]
                    }
                ],
                pools: {}
            },
            "avaliacao-nasal": {
                id: "avaliacao-nasal",
                nome: "ğŸ‘ƒ AvaliaÃ§Ã£o Nasal",
                descricao: "AvaliaÃ§Ã£o detalhada do nariz",
                bilateral: false,
                campos: [
                    { 
                        id: "achados", 
                        tipo: "checkbox-grupo", 
                        label: "Achados",
                        opcoes: [
                            "Desvio de septo", "Rinofima", "Telangiectasias",
                            "LesÃµes cutÃ¢neas", "Assimetrias", "Normal"
                        ]
                    }
                ],
                pools: {}
            },
            "avaliacao-labial": {
                id: "avaliacao-labial",
                nome: "ğŸ’‹ AvaliaÃ§Ã£o Labial",
                descricao: "AvaliaÃ§Ã£o detalhada dos lÃ¡bios",
                bilateral: false,
                campos: [
                    { 
                        id: "achados", 
                        tipo: "checkbox-grupo", 
                        label: "Achados",
                        opcoes: [
                            "Queilite", "Fissuras", "LesÃµes herpÃ©ticas",
                            "Ressecamento", "Assimetrias", "Normal"
                        ]
                    }
                ],
                pools: {}
            },
            "avaliacao-auricular": {
                id: "avaliacao-auricular",
                nome: "ğŸ‘‚ AvaliaÃ§Ã£o Auricular",
                descricao: "AvaliaÃ§Ã£o detalhada das orelhas",
                bilateral: false,
                campos: [
                    { 
                        id: "achados", 
                        tipo: "checkbox-grupo", 
                        label: "Achados",
                        opcoes: [
                            "Queloides", "Deformidades", "LesÃµes cutÃ¢neas",
                            "FÃ­stulas", "Normal"
                        ]
                    }
                ],
                pools: {}
            },
            "avaliacao-tricologica": {
                id: "avaliacao-tricologica",
                nome: "ğŸ’ˆ AvaliaÃ§Ã£o TricolÃ³gica",
                descricao: "AvaliaÃ§Ã£o TricolÃ³gica",
                bilateral: false,
                campos: [
                    { 
                        id: "sexo-paciente", 
                        tipo: "radio-simples", 
                        label: "Sexo do paciente:",
                        opcoes: ["Masculino", "Feminino"]
                    },
                    { 
                        id: "norwood-hamilton", 
                        tipo: "radio-condicional", 
                        label: "Escala de Norwood-Hamilton:",
                        condicao: { campo: "sexo-paciente", valor: "Masculino" },
                        opcoes: [
                            "I - Normal",
                            "II - RecessÃ£o frontotemporal leve",
                            "IIA - RecessÃ£o frontal anterior",
                            "III - Aprofundamento frontal",
                            "III VÃ©rtex - RarefaÃ§Ã£o no vÃ©rtex",
                            "IIIA - III + rarefaÃ§Ã£o anterior",
                            "IV - RecessÃ£o severa + vÃ©rtex",
                            "IVA - IV avanÃ§ado",
                            "V - Ponte estreita",
                            "VA - V avanÃ§ado",
                            "VI - Ponte desaparece",
                            "VII - Ferradura completa"
                        ]
                    },
                    { 
                        id: "ludwig", 
                        tipo: "radio-condicional", 
                        label: "Escala de Ludwig:",
                        condicao: { campo: "sexo-paciente", valor: "Feminino" },
                        opcoes: [
                            "I - RarefaÃ§Ã£o mÃ­nima na linha central",
                            "II - Alargamento da linha central",
                            "III - RarefaÃ§Ã£o difusa no topo"
                        ]
                    }
                ],
                pools: {}
            },
            "avaliacao-nasal-detalhada": {
                id: "avaliacao-nasal-detalhada",
                nome: "ğŸ‘ƒ AvaliaÃ§Ã£o Nasal Detalhada",
                descricao: "Exame detalhado por regiÃµes do nariz",
                bilateral: false,
                campos: [
                    { 
                        id: "raiz-nasal", 
                        tipo: "checkbox-grupo", 
                        label: "Raiz nasal:",
                        opcoes: ["Deprimida", "Normal", "Proeminente", "Assimetrias", "LesÃµes"]
                    },
                    { 
                        id: "raiz-nasal-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "dorso-nasal", 
                        tipo: "checkbox-grupo", 
                        label: "Dorso nasal:",
                        opcoes: ["Giba Ã³ssea", "Giba cartilaginosa", "Dorso largo", "Dorso estreito", "Desvio", "DepressÃ£o", "Normal"]
                    },
                    { 
                        id: "dorso-nasal-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "ponta-nasal", 
                        tipo: "checkbox-grupo", 
                        label: "Ponta nasal:",
                        opcoes: ["Bulbosa", "CaÃ­da", "Hipoprojetada", "Hiperprojetada", "BÃ­fida", "AssimÃ©trica", "Normal"]
                    },
                    { 
                        id: "ponta-nasal-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "columela", 
                        tipo: "checkbox-grupo", 
                        label: "Columela:",
                        opcoes: ["RetraÃ­da", "Pendente", "Desvio", "Cicatriz", "Normal"]
                    },
                    { 
                        id: "columela-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "asas-nasais", 
                        tipo: "checkbox-grupo", 
                        label: "Asas nasais:",
                        opcoes: ["Colapsada D", "Colapsada E", "Alargada D", "Alargada E", "AssimÃ©tricas", "LesÃ£o D", "LesÃ£o E", "Normal"]
                    },
                    { 
                        id: "asas-nasais-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "narinas", 
                        tipo: "checkbox-grupo", 
                        label: "Narinas:",
                        opcoes: ["AssimÃ©tricas", "Estenose D", "Estenose E", "Alargadas", "Normal"]
                    },
                    { 
                        id: "narinas-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "base-nasal", 
                        tipo: "checkbox-grupo", 
                        label: "Base nasal:",
                        opcoes: ["Larga", "Estreita", "AssimÃ©trica", "Normal"]
                    },
                    { 
                        id: "base-nasal-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    {
                        id: "angulo-nasolabial",
                        tipo: "radio-simples",
                        label: "Ã‚ngulo nasolabial:",
                        opcoes: ["Agudo (<90Â°)", "Normal (90-110Â°)", "Obtuso (>110Â°)"]
                    },
                    { 
                        id: "pele-nasal", 
                        tipo: "checkbox-grupo", 
                        label: "Pele nasal:",
                        opcoes: ["Rinofima", "Telangiectasias", "ComedÃµes", "RosÃ¡cea", "LesÃµes", "Normal"]
                    },
                    { 
                        id: "pele-nasal-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "septo", 
                        tipo: "checkbox-grupo", 
                        label: "Septo (avaliaÃ§Ã£o externa):",
                        opcoes: ["Desvio visÃ­vel Ã  direita", "Desvio visÃ­vel Ã  esquerda", "PerfuraÃ§Ã£o", "Normal"]
                    },
                    { 
                        id: "septo-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    }
                ],
                pools: {}
            },
            "avaliacao-auricular-detalhada": {
                id: "avaliacao-auricular-detalhada",
                nome: "ğŸ‘‚ AvaliaÃ§Ã£o Auricular Detalhada",
                descricao: "Exame detalhado por regiÃµes das orelhas",
                bilateral: false,
                campos: [
                    { 
                        id: "lateralidade-orelha", 
                        tipo: "radio-simples", 
                        label: "Lateralidade:",
                        opcoes: ["Bilateral", "Direita", "Esquerda"]
                    },
                    { 
                        id: "helice", 
                        tipo: "checkbox-grupo", 
                        label: "HÃ©lice:",
                        opcoes: ["Irregular", "Espessada", "Queloides", "LesÃ£o", "Deformidade", "Normal"]
                    },
                    { 
                        id: "helice-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "anti-helice", 
                        tipo: "checkbox-grupo", 
                        label: "Anti-hÃ©lice:",
                        opcoes: ["Proeminente", "HipoplÃ¡sica", "Irregular", "LesÃ£o", "Normal"]
                    },
                    { 
                        id: "anti-helice-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "lobulo", 
                        tipo: "checkbox-grupo", 
                        label: "LÃ³bulo:",
                        opcoes: ["Alongado", "Bi-partido", "Rasgado", "Queloides", "LesÃ£o", "Normal"]
                    },
                    { 
                        id: "lobulo-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "trago", 
                        tipo: "checkbox-grupo", 
                        label: "Trago:",
                        opcoes: ["HipoplÃ¡sico", "HipertrÃ³fico", "LesÃ£o", "Normal"]
                    },
                    { 
                        id: "trago-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "anti-trago", 
                        tipo: "checkbox-grupo", 
                        label: "Anti-trago:",
                        opcoes: ["HipoplÃ¡sico", "HipertrÃ³fico", "LesÃ£o", "Normal"]
                    },
                    { 
                        id: "anti-trago-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "concha", 
                        tipo: "checkbox-grupo", 
                        label: "Concha:",
                        opcoes: ["Profunda", "Rasa", "LesÃ£o", "InflamaÃ§Ã£o", "Normal"]
                    },
                    { 
                        id: "concha-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "fossa-triangular", 
                        tipo: "checkbox-grupo", 
                        label: "Fossa triangular:",
                        opcoes: ["Profunda", "Rasa", "LesÃ£o", "Normal"]
                    },
                    { 
                        id: "fossa-triangular-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "escafa", 
                        tipo: "checkbox-grupo", 
                        label: "Escafa (fossa escafoide):",
                        opcoes: ["Larga", "Estreita", "LesÃ£o", "Normal"]
                    },
                    { 
                        id: "escafa-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    {
                        id: "angulo-cefalico",
                        tipo: "radio-simples",
                        label: "Ã‚ngulo cefalooricular:",
                        opcoes: ["Normal (<30Â°)", "Aumentado (30-45Â°)", "Muito aumentado (>45Â°)"]
                    },
                    { 
                        id: "tamanho-geral", 
                        tipo: "checkbox-grupo", 
                        label: "Tamanho geral:",
                        opcoes: ["Microtia", "Macrotia", "Normal"]
                    },
                    { 
                        id: "tamanho-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "implantacao", 
                        tipo: "checkbox-grupo", 
                        label: "ImplantaÃ§Ã£o:",
                        opcoes: ["Baixa", "Alta", "Anterior", "Posterior", "Normal"]
                    },
                    { 
                        id: "implantacao-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    },
                    { 
                        id: "pele-auricular", 
                        tipo: "checkbox-grupo", 
                        label: "Pele:",
                        opcoes: ["Queloides", "FÃ­stulas", "Cistos", "LesÃµes", "Normal"]
                    },
                    { 
                        id: "pele-auricular-obs", 
                        tipo: "texto-livre", 
                        label: "Detalhes:",
                        linhas: 1
                    }
                ],
                pools: {}
            },
            "avaliacao-generica": {
                id: "avaliacao-generica",
                nome: "ğŸ“ AvaliaÃ§Ã£o GenÃ©rica",
                descricao: "AvaliaÃ§Ã£o bÃ¡sica para qualquer regiÃ£o",
                bilateral: false,
                campos: [
                    { id: "achados", tipo: "texto-livre", label: "Achados", linhas: 5, bilateral: false }
                ],
                pools: {}
            }
        };
        
        // ============================================================
        // HIERARQUIAS POR POLÃGONO v10.159
        // ============================================================
        
                const HIERARQUIAS_POLIGONOS = {
          "Abdome": {
                                        "poligono": "Abdome",
                                        "caminho": [
                                                  "Tronco",
                                                  "Abdome"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "abdome",
                                                            "nome": "Abdome",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "AntebraÃ§o anterior": {
                                        "poligono": "AntebraÃ§o anterior",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "AntebraÃ§o anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "antebra-o-anterior",
                                                            "nome": "AntebraÃ§o anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Axila": {
                                        "poligono": "Axila",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Axila"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "axila",
                                                            "nome": "Axila",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Bochecha": {
                                        "poligono": "Bochecha",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Bochecha"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "bochecha",
                                                            "nome": "Bochecha",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "BraÃ§o anterior": {
                                        "poligono": "BraÃ§o anterior",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "BraÃ§o anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "bra-o-anterior",
                                                            "nome": "BraÃ§o anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "CabeÃ§a e pescoÃ§o (frente)": {
                                        "poligono": "CabeÃ§a e pescoÃ§o (frente)",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "cabe-a-e-pesco-o-anterior",
                                                            "nome": "CabeÃ§a e PescoÃ§o",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o",
                                                            "nome": "â†‘ CabeÃ§a e PescoÃ§o",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  },
                                                  {
                                                            "id": "ir-filho-bochecha",
                                                            "nome": "â†“ Bochecha",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-couro-cabeludo-anterior",
                                                            "nome": "â†“ Couro cabeludo anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-fossa-canina",
                                                            "nome": "â†“ Fossa canina",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-glabela",
                                                            "nome": "â†“ Glabela",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-lateral-da-rbita",
                                                            "nome": "â†“ Lateral da Ã³rbita",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-lateral-nasal",
                                                            "nome": "â†“ Lateral nasal",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-l-bio-inferior",
                                                            "nome": "â†“ LÃ¡bio inferior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-l-bio-superior",
                                                            "nome": "â†“ LÃ¡bio superior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-orelha-vis-o-anterior",
                                                            "nome": "â†“ Orelha visÃ£o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-p-lpebra-inferior",
                                                            "nome": "â†“ PÃ¡lpebra inferior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-p-lpebra-superior",
                                                            "nome": "â†“ PÃ¡lpebra superior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-cervical-anterior",
                                                            "nome": "â†“ RegiÃ£o cervical anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-cervical-lateral-vis-o-anterior",
                                                            "nome": "â†“ RegiÃ£o cervical lateral visÃ£o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-frontal",
                                                            "nome": "â†“ RegiÃ£o frontal",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-malar-infraorbit-ria",
                                                            "nome": "â†“ RegiÃ£o malar / infraorbitÃ¡ria",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-mandibular-anterior",
                                                            "nome": "â†“ RegiÃ£o mandibular anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-mentoniana",
                                                            "nome": "â†“ RegiÃ£o mentoniana",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-nasal",
                                                            "nome": "â†“ RegiÃ£o nasal",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-nasociliar",
                                                            "nome": "â†“ RegiÃ£o nasociliar",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-oral",
                                                            "nome": "â†“ RegiÃ£o oral",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-peitoral",
                                                            "nome": "â†“ RegiÃ£o peitoral",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-peitoral-lateral",
                                                            "nome": "â†“ RegiÃ£o peitoral lateral",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-pr-auricular",
                                                            "nome": "â†“ RegiÃ£o prÃ©-auricular",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-submentoniana",
                                                            "nome": "â†“ RegiÃ£o submentoniana",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-temporal",
                                                            "nome": "â†“ RegiÃ£o temporal",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-zigom-tica",
                                                            "nome": "â†“ RegiÃ£o zigomÃ¡tica",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-sulco-labiomentoniano-e-pr-jowls-",
                                                            "nome": "â†“ Sulco labiomentoniano e \"prÃ©-jowls\"",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-sulco-nasojugal",
                                                            "nome": "â†“ Sulco nasojugal",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-sulco-nasolabial",
                                                            "nome": "â†“ Sulco nasolabial",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-superc-lio",
                                                            "nome": "â†“ SupercÃ­lio",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          },
          "Couro cabeludo anterior": {
                                        "poligono": "Couro cabeludo anterior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Couro cabeludo anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "couro-cabeludo-anterior",
                                                            "nome": "Couro cabeludo anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "CabeÃ§a": {
                                        "poligono": "CabeÃ§a",
                                        "caminho": [
                                                  "CabeÃ§a e pescoÃ§o (anterior)",
                                                  "CabeÃ§a"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "cabeca-anterior-completa",
                                                            "nome": "CabeÃ§a",
                                                            "template": "avaliacao-generica",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "couro-cabeludo-anterior-virtual",
                                                            "nome": "Couro cabeludo (anterior)",
                                                            "virtual": true,
                                                            "indentVisual": true,
                                                            "filhos": [
                                                                      {
                                                                                "id": "calvicie-completa",
                                                                                "nome": "AvaliaÃ§Ã£o TricolÃ³gica",
                                                                                "template": "avaliacao-tricologica",
                                                                                "filhos": []
                                                                      },
                                                                      {
                                                                                "id": "regiao-frontal-central",
                                                                                "nome": "RegiÃ£o frontal",
                                                                                "template": "avaliacao-generica",
                                                                                "filhos": []
                                                                      },
                                                                      {
                                                                                "id": "regiao-frontotemporal-bilateral",
                                                                                "nome": "RegiÃ£o frontotemporal (bilateral)",
                                                                                "virtual": true,
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "regiao-frontotemporal-d",
                                                                                                    "nome": "RegiÃ£o frontotemporal D",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "regiao-frontotemporal-e",
                                                                                                    "nome": "RegiÃ£o frontotemporal E",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          }
                                                                                ]
                                                                      },
                                                                      {
                                                                                "id": "vertex-coroa",
                                                                                "nome": "VÃ©rtex (coroa)",
                                                                                "template": "avaliacao-generica",
                                                                                "filhos": []
                                                                      },
                                                                      {
                                                                                "id": "regiao-parietal-bilateral",
                                                                                "nome": "RegiÃ£o parietal (bilateral)",
                                                                                "virtual": true,
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "regiao-parietal-d",
                                                                                                    "nome": "RegiÃ£o parietal D",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "regiao-parietal-e",
                                                                                                    "nome": "RegiÃ£o parietal E",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          }
                                                                                ]
                                                                      },
                                                                      {
                                                                                "id": "regiao-temporal-couro-bilateral",
                                                                                "nome": "RegiÃ£o temporal (bilateral)",
                                                                                "virtual": true,
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "regiao-temporal-couro-d",
                                                                                                    "nome": "RegiÃ£o temporal D",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "regiao-temporal-couro-e",
                                                                                                    "nome": "RegiÃ£o temporal E",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          }
                                                                                ]
                                                                      }
                                                            ]
                                                  },
                                                  {
                                                            "id": "face-virtual",
                                                            "nome": "Face",
                                                            "virtual": true,
                                                            "indentVisual": true,
                                                            "filhos": [
                                                                      {
                                                                                "id": "terco-superior",
                                                                                "nome": "TerÃ§o superior",
                                                                                "template": "avaliacao-generica",
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "regiao-frontal",
                                                                                                    "nome": "RegiÃ£o frontal",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "glabela",
                                                                                                    "nome": "Glabela",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                                  "id": "supercilios-bilateral",
                                                                                                                  "nome": "SupercÃ­lios (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "supercilio-d",
                                                                                                                                                "nome": "SupercÃ­lio direito",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "supercilio-e",
                                                                                                                                                "nome": "SupercÃ­lio esquerdo",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "regiao-temporal-bilateral",
                                                                                                                  "nome": "RegiÃ£o temporal (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "regiao-temporal-d",
                                                                                                                                                "nome": "RegiÃ£o temporal direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "regiao-temporal-e",
                                                                                                                                                "nome": "RegiÃ£o temporal esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          }
                                                                                ]
                                                                      },
                                                                      {
                                                                                "id": "terco-medio",
                                                                                "nome": "TerÃ§o mÃ©dio",
                                                                                "template": "avaliacao-generica",
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "palpebras-todas",
                                                                                                    "nome": "PÃ¡lpebras (todas - 4 pÃ¡lpebras)",
                                                                                                    "template": "avaliacao-palpebras",
                                                                                                    "filhos": [
                                                                                                                              {
                                                                                                                                                "id": "palpebras-superiores",
                                                                                                                                                "nome": "PÃ¡lpebras superiores (bilateral)",
                                                                                                                                                "template": "avaliacao-palpebras",
                                                                                                                                                "filhos": [
                                                                                                                                                                          {
                                                                                                                                                                                    "id": "palpebra-superior-d",
                                                                                                                                                                                    "nome": "PÃ¡lpebra superior direita",
                                                                                                                                                                                    "template": "avaliacao-palpebras",
                                                                                                                                                                                    "filhos": []
                                                                                                                                                                          },
                                                                                                                                                                          {
                                                                                                                                                                                    "id": "palpebra-superior-e",
                                                                                                                                                                                    "nome": "PÃ¡lpebra superior esquerda",
                                                                                                                                                                                    "template": "avaliacao-palpebras",
                                                                                                                                                                                    "filhos": []
                                                                                                                                                                          }
                                                                                                                                                ]
                                                                                                                              },
                                                                                                                              {
                                                                                                                                                "id": "palpebras-inferiores",
                                                                                                                                                "nome": "PÃ¡lpebras inferiores (bilateral)",
                                                                                                                                                "template": "avaliacao-palpebras",
                                                                                                                                                "filhos": [
                                                                                                                                                                          {
                                                                                                                                                                                    "id": "palpebra-inferior-d",
                                                                                                                                                                                    "nome": "PÃ¡lpebra inferior direita",
                                                                                                                                                                                    "template": "avaliacao-palpebras",
                                                                                                                                                                                    "filhos": []
                                                                                                                                                                          },
                                                                                                                                                                          {
                                                                                                                                                                                    "id": "palpebra-inferior-e",
                                                                                                                                                                                    "nome": "PÃ¡lpebra inferior esquerda",
                                                                                                                                                                                    "template": "avaliacao-palpebras",
                                                                                                                                                                                    "filhos": []
                                                                                                                                                                          }
                                                                                                                                                ]
                                                                                                                              }
                                                                                                    ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "regiao-periorbitaria-bilateral",
                                                                                                                  "nome": "RegiÃ£o periorbitÃ¡ria (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "regiao-periorbitaria-d",
                                                                                                                                                "nome": "RegiÃ£o periorbitÃ¡ria direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "regiao-periorbitaria-e",
                                                                                                                                                "nome": "RegiÃ£o periorbitÃ¡ria esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "canto-medial-bilateral",
                                                                                                                  "nome": "Canto medial (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "canto-medial-d",
                                                                                                                                                "nome": "Canto medial direito",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "canto-medial-e",
                                                                                                                                                "nome": "Canto medial esquerdo",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "canto-lateral-bilateral",
                                                                                                                  "nome": "Canto lateral (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "canto-lateral-d",
                                                                                                                                                "nome": "Canto lateral direito",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "canto-lateral-e",
                                                                                                                                                "nome": "Canto lateral esquerdo",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "sulco-nasojugal-bilateral",
                                                                                                                  "nome": "Sulco nasojugal (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "sulco-nasojugal-d",
                                                                                                                                                "nome": "Sulco nasojugal direito",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "sulco-nasojugal-e",
                                                                                                                                                "nome": "Sulco nasojugal esquerdo",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "regiao-malar-bilateral",
                                                                                                                  "nome": "RegiÃ£o malar (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "regiao-malar-d",
                                                                                                                                                "nome": "RegiÃ£o malar direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "regiao-malar-e",
                                                                                                                                                "nome": "RegiÃ£o malar esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "regiao-infraorbitaria-bilateral",
                                                                                                                  "nome": "RegiÃ£o infraorbitÃ¡ria (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "regiao-infraorbitaria-d",
                                                                                                                                                "nome": "RegiÃ£o infraorbitÃ¡ria direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "regiao-infraorbitaria-e",
                                                                                                                                                "nome": "RegiÃ£o infraorbitÃ¡ria esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "regiao-zigomatica-bilateral",
                                                                                                                  "nome": "RegiÃ£o zigomÃ¡tica (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "regiao-zigomatica-d",
                                                                                                                                                "nome": "RegiÃ£o zigomÃ¡tica direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "regiao-zigomatica-e",
                                                                                                                                                "nome": "RegiÃ£o zigomÃ¡tica esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                    "id": "nariz",
                                                                                                    "nome": "Nariz",
                                                                                                    "template": "avaliacao-nasal",
                                                                                                    "filhos": [
                                                                                                        {
                                                                                                            "id": "nariz-detalhado",
                                                                                                            "nome": "AvaliaÃ§Ã£o Nasal Detalhada",
                                                                                                            "template": "avaliacao-nasal-detalhada",
                                                                                                            "filhos": []
                                                                                                        }
                                                                                                    ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "sulco-nasolabial-bilateral",
                                                                                                                  "nome": "Sulco nasolabial (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "sulco-nasolabial-d",
                                                                                                                                                "nome": "Sulco nasolabial direito",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "sulco-nasolabial-e",
                                                                                                                                                "nome": "Sulco nasolabial esquerdo",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "fossa-canina-bilateral",
                                                                                                                  "nome": "Fossa canina (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "fossa-canina-d",
                                                                                                                                                "nome": "Fossa canina direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "fossa-canina-e",
                                                                                                                                                "nome": "Fossa canina esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                    "id": "orelhas-bilateral",
                                                                                                    "nome": "Orelhas (bilateral - visÃ£o anterior)",
                                                                                                    "template": "avaliacao-auricular",
                                                                                                    "filhos": [
                                                                                                        {
                                                                                                            "id": "orelhas-bilateral-detalhada",
                                                                                                            "nome": "AvaliaÃ§Ã£o Auricular Detalhada",
                                                                                                            "template": "avaliacao-auricular-detalhada",
                                                                                                            "filhos": []
                                                                                                        },
                                                                                                                              {
                                                                                                                                                "id": "orelha-d",
                                                                                                                                                "nome": "Orelha direita (visÃ£o anterior)",
                                                                                                                                                "template": "avaliacao-auricular",
                                                                                                                                                "filhos": []
                                                                                                                              },
                                                                                                                              {
                                                                                                                                                "id": "orelha-e",
                                                                                                                                                "nome": "Orelha esquerda (visÃ£o anterior)",
                                                                                                                                                "template": "avaliacao-auricular",
                                                                                                                                                "filhos": []
                                                                                                                              }
                                                                                                    ]
                                                                                          }
                                                                                ]
                                                                      },
                                                                      {
                                                                                "id": "terco-inferior",
                                                                                "nome": "TerÃ§o inferior",
                                                                                "template": "avaliacao-generica",
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "labios-ambos",
                                                                                                    "nome": "LÃ¡bios (ambos)",
                                                                                                    "template": "avaliacao-labial",
                                                                                                    "virtual": true,
                                                                                                    "filhos": [
                                                                                                              {
                                                                                                                        "id": "labio-superior",
                                                                                                                        "nome": "LÃ¡bio superior",
                                                                                                                        "template": "avaliacao-labial",
                                                                                                                        "filhos": []
                                                                                                              },
                                                                                                              {
                                                                                                                        "id": "labio-inferior",
                                                                                                                        "nome": "LÃ¡bio inferior",
                                                                                                                        "template": "avaliacao-labial",
                                                                                                                        "filhos": []
                                                                                                              }
                                                                                                    ]
                                                                                          },
                                                                                          {
                                                                                                    "id": "regiao-perioral",
                                                                                                    "nome": "RegiÃ£o perioral",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "virtual": true,
                                                                                                    "filhos": [
                                                                                                              {
                                                                                                                        "id": "regiao-perioral-superior",
                                                                                                                        "nome": "RegiÃ£o perioral superior",
                                                                                                                        "template": "avaliacao-generica",
                                                                                                                        "filhos": []
                                                                                                              },
                                                                                                              {
                                                                                                                        "id": "regiao-perioral-inferior",
                                                                                                                        "nome": "RegiÃ£o perioral inferior",
                                                                                                                        "template": "avaliacao-generica",
                                                                                                                        "filhos": []
                                                                                                              }
                                                                                                    ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "comissuras-labiais-bilateral",
                                                                                                                  "nome": "Comissuras labiais (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "virtual": true,
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "comissura-labial-d",
                                                                                                                                                "nome": "Comissura labial direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "comissura-labial-e",
                                                                                                                                                "nome": "Comissura labial esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "bochecha-bilateral",
                                                                                                                  "nome": "Bochecha (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "virtual": true,
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "bochecha-d",
                                                                                                                                                "nome": "Bochecha direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "bochecha-e",
                                                                                                                                                "nome": "Bochecha esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                    "id": "bigode-completo",
                                                                                                    "nome": "Bigode (completo)",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "virtual": true,
                                                                                                    "filhos": [
                                                                                                              {
                                                                                                                        "id": "bigode-d",
                                                                                                                        "nome": "Bigode direito",
                                                                                                                        "template": "avaliacao-generica",
                                                                                                                        "filhos": []
                                                                                                              },
                                                                                                              {
                                                                                                                        "id": "bigode-e",
                                                                                                                        "nome": "Bigode esquerdo",
                                                                                                                        "template": "avaliacao-generica",
                                                                                                                        "filhos": []
                                                                                                              }
                                                                                                    ]
                                                                                          },
                                                                                          {
                                                                                                    "id": "barba-completa",
                                                                                                    "nome": "Barba (completa)",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "virtual": true,
                                                                                                    "filhos": [
                                                                                                              {
                                                                                                                        "id": "barba-d",
                                                                                                                        "nome": "Barba direita",
                                                                                                                        "template": "avaliacao-generica",
                                                                                                                        "filhos": []
                                                                                                              },
                                                                                                              {
                                                                                                                        "id": "barba-e",
                                                                                                                        "nome": "Barba esquerda",
                                                                                                                        "template": "avaliacao-generica",
                                                                                                                        "filhos": []
                                                                                                              }
                                                                                                    ]
                                                                                          },
                                                                                          {
                                                                                                    "id": "mento",
                                                                                                    "nome": "Mento (queixo)",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "regiao-submentoniana",
                                                                                                    "nome": "RegiÃ£o submentoniana (papada)",
                                                                                                    "template": "avaliacao-generica",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                                  "id": "sulco-labiomentoniano-bilateral",
                                                                                                                  "nome": "Sulco labiomentoniano (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "virtual": true,
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "sulco-labiomentoniano-d",
                                                                                                                                                "nome": "Sulco labiomentoniano direito",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "sulco-labiomentoniano-e",
                                                                                                                                                "nome": "Sulco labiomentoniano esquerdo",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "pre-jowls-bilateral",
                                                                                                                  "nome": "PrÃ©-jowls (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "virtual": true,
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "pre-jowl-d",
                                                                                                                                                "nome": "PrÃ©-jowl direito",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "pre-jowl-e",
                                                                                                                                                "nome": "PrÃ©-jowl esquerdo",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "jowls-bilateral",
                                                                                                                  "nome": "Jowls (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "virtual": true,
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "jowl-d",
                                                                                                                                                "nome": "Jowl direito",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "jowl-e",
                                                                                                                                                "nome": "Jowl esquerdo",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "regiao-mandibular-anterior-bilateral",
                                                                                                                  "nome": "RegiÃ£o mandibular anterior (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "virtual": true,
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "regiao-mandibular-anterior-d",
                                                                                                                                                "nome": "RegiÃ£o mandibular anterior direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "regiao-mandibular-anterior-e",
                                                                                                                                                "nome": "RegiÃ£o mandibular anterior esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "linha-mandibular-bilateral",
                                                                                                                  "nome": "Linha mandibular (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "virtual": true,
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "linha-mandibular-d",
                                                                                                                                                "nome": "Linha mandibular direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "linha-mandibular-e",
                                                                                                                                                "nome": "Linha mandibular esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "angulo-mandibular-bilateral",
                                                                                                                  "nome": "Ã‚ngulo mandibular (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "virtual": true,
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "angulo-mandibular-d",
                                                                                                                                                "nome": "Ã‚ngulo mandibular direito",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "angulo-mandibular-e",
                                                                                                                                                "nome": "Ã‚ngulo mandibular esquerdo",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          },
                                                                                          {
                                                                                                                  "id": "regiao-pre-auricular-bilateral",
                                                                                                                  "nome": "RegiÃ£o prÃ©-auricular (bilateral)",
                                                                                                                  "template": "avaliacao-generica",
                                                                                                                  "virtual": true,
                                                                                                                  "filhos": [
                                                                                                                                          {
                                                                                                                                                "id": "regiao-pre-auricular-d",
                                                                                                                                                "nome": "RegiÃ£o prÃ©-auricular direita",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          },
                                                                                                                                          {
                                                                                                                                                "id": "regiao-pre-auricular-e",
                                                                                                                                                "nome": "RegiÃ£o prÃ©-auricular esquerda",
                                                                                                                                                "template": "avaliacao-generica",
                                                                                                                                                "filhos": []
                                                                                                                                          }
                                                                                                                  ]
                                                                                          }
                                                                                ]
                                                                      }
                                                            ]
                                                  },
                                                  {
                                                            "id": "ir-pai-cabeca-pescoco",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o",
                                                            "navegacao": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "CabeÃ§a e pescoÃ§o (frente)": {
                                        "poligono": "CabeÃ§a e PescoÃ§o",
                                        "caminho": [
                                                  "CabeÃ§a e pescoÃ§o (frente)"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "cabeca-pescoco-completo",
                                                            "nome": "CabeÃ§a e PescoÃ§o",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-filho-cabeca",
                                                            "nome": "â†“ CabeÃ§a",
                                                            "navegacao": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-filho-pescoco",
                                                            "nome": "â†“ PescoÃ§o",
                                                            "navegacao": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "CabeÃ§a e pescoÃ§o (costas)": {
                                        "poligono": "CabeÃ§a e pescoÃ§o (costas)",
                                        "caminho": [
                                                  "CabeÃ§a e pescoÃ§o"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "cabeca-pescoco-completo-post",
                                                            "nome": "CabeÃ§a e PescoÃ§o",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-filho-couro-cabeludo-post",
                                                            "nome": "â†“ Couro cabeludo",
                                                            "navegacao": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-filho-pescoco-post",
                                                            "nome": "â†“ PescoÃ§o",
                                                            "navegacao": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "CabeÃ§a (costas)": {
                                        "poligono": "CabeÃ§a posterior",
                                        "caminho": [
                                                  "CabeÃ§a e pescoÃ§o (costas)",
                                                  "CabeÃ§a (costas)"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "cabeca-completa-post",
                                                            "nome": "CabeÃ§a",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-filho-couro-cabeludo-post",
                                                            "nome": "â†“ Couro cabeludo",
                                                            "navegacao": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabeca-pescoco-post",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o",
                                                            "navegacao": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Couro cabeludo (costas)": {
                                        "poligono": "Couro cabeludo posterior",
                                        "caminho": [
                                                  "CabeÃ§a e pescoÃ§o (posterior)",
                                                  "CabeÃ§a (posterior)"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "couro-cabeludo-posterior-completo",
                                                            "nome": "Couro cabeludo",
                                                            "template": "avaliacao-couro-cabeludo",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "orelhas-bilateral-post",
                                                            "nome": "Orelhas (bilateral - visÃ£o posterior)",
                                                            "template": "",
                                                            "lateralidade": true,
                                                            "virtual": true,
                                                            "filhos": [
                                                                {
                                                                    "id": "orelhas-bilateral-post-detalhada",
                                                                    "nome": "AvaliaÃ§Ã£o Auricular Detalhada",
                                                                    "template": "avaliacao-auricular-detalhada",
                                                                    "filhos": []
                                                                },
                                                                      {
                                                                                "id": "orelha-d-post",
                                                                                "nome": "Orelha D (visÃ£o posterior)",
                                                                                "template": "",
                                                                                "lateralidade": false,
                                                                                "virtual": true,
                                                                                "filhos": []
                                                                      },
                                                                      {
                                                                                "id": "orelha-e-post",
                                                                                "nome": "Orelha E (visÃ£o posterior)",
                                                                                "template": "",
                                                                                "lateralidade": false,
                                                                                "virtual": true,
                                                                                "filhos": []
                                                                      }
                                                            ]
                                                  },
                                                  {
                                                            "id": "cabeca-posterior-completa",
                                                            "nome": "CabeÃ§a posterior",
                                                            "template": "",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabeca-pescoco-post",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o (posterior)",
                                                            "navegacao": true,
                                                            "poligonoAlvo": "CabeÃ§a e pescoÃ§o (costas)",
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  },
                                                  {
                                                            "id": "ir-pai-cabeca-post",
                                                            "nome": "â†‘ CabeÃ§a (posterior)",
                                                            "navegacao": true,
                                                            "poligonoAlvo": "CabeÃ§a (costas)",
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI intermediÃ¡rio"
                                                  }
                                        ]
          },
          "PescoÃ§o Posterior": {
                                        "poligono": "PescoÃ§o (costas)",
                                        "caminho": [
                                                  "CabeÃ§a e pescoÃ§o (costas)",
                                                  "PescoÃ§o"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "pescoco-completo-post",
                                                            "nome": "PescoÃ§o",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "nuca",
                                                            "nome": "Nuca (regiÃ£o nucal)",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "regiao-cervical-posterior-bilateral",
                                                            "nome": "RegiÃ£o cervical posterior (bilateral)",
                                                            "filhos": [
                                                                                          {
                                                                                                    "id": "regiao-cervical-posterior-d",
                                                                                                    "nome": "RegiÃ£o cervical posterior D",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "regiao-cervical-posterior-e",
                                                                                                    "nome": "RegiÃ£o cervical posterior E",
                                                                                                    "filhos": []
                                                                                          }
                                                            ]
                                                  },
                                                  {
                                                            "id": "linha-posterior-cabelo",
                                                            "nome": "Linha posterior do cabelo",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "trapezio-superior-bilateral",
                                                            "nome": "TrapÃ©zio superior (bilateral)",
                                                            "filhos": [
                                                                                          {
                                                                                                    "id": "trapezio-superior-d",
                                                                                                    "nome": "TrapÃ©zio superior D",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "trapezio-superior-e",
                                                                                                    "nome": "TrapÃ©zio superior E",
                                                                                                    "filhos": []
                                                                                          }
                                                            ]
                                                  },
                                                  {
                                                            "id": "ir-pai-cabeca-pescoco-post",
                                                            "nome": "â†‘ CabeÃ§a e PescoÃ§o",
                                                            "navegacao": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Coxa anterior": {
                                        "poligono": "Coxa anterior",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Membro inferior anterior",
                                                  "Coxa anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "coxa-anterior",
                                                            "nome": "Coxa anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "EpigÃ¡strio": {
                                        "poligono": "EpigÃ¡strio",
                                        "caminho": [
                                                  "Tronco",
                                                  "EpigÃ¡strio"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "epig-strio",
                                                            "nome": "EpigÃ¡strio",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Face anterior da coxa": {
                                        "poligono": "Face anterior da coxa",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Membro inferior anterior",
                                                  "Face anterior da coxa"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "face-anterior-da-coxa",
                                                            "nome": "Face anterior da coxa",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Face anterior do braÃ§o": {
                                        "poligono": "Face anterior do braÃ§o",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Face anterior do braÃ§o"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "face-anterior-do-bra-o",
                                                            "nome": "Face anterior do braÃ§o",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Face lateral da coxa": {
                                        "poligono": "Face lateral da coxa",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Membro inferior anterior",
                                                  "Face lateral da coxa"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "face-lateral-da-coxa",
                                                            "nome": "Face lateral da coxa",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Face medial da coxa": {
                                        "poligono": "Face medial da coxa",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Membro inferior anterior",
                                                  "Face medial da coxa"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "face-medial-da-coxa",
                                                            "nome": "Face medial da coxa",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Face medial do braÃ§o": {
                                        "poligono": "Face medial do braÃ§o",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Face medial do braÃ§o"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "face-medial-do-bra-o",
                                                            "nome": "Face medial do braÃ§o",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Flanco": {
                                        "poligono": "Flanco",
                                        "caminho": [
                                                  "Tronco",
                                                  "Flanco"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "flanco",
                                                            "nome": "Flanco",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Fossa canina": {
                                        "poligono": "Fossa canina",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Fossa canina"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "fossa-canina",
                                                            "nome": "Fossa canina",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Fossa ilÃ­aca": {
                                        "poligono": "Fossa ilÃ­aca",
                                        "caminho": [
                                                  "Tronco",
                                                  "Fossa ilÃ­aca"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "fossa-il-aca",
                                                            "nome": "Fossa ilÃ­aca",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Glabela": {
                                        "poligono": "Glabela",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Glabela"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "glabela",
                                                            "nome": "Glabela",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "HipocÃ´ndrio": {
                                        "poligono": "HipocÃ´ndrio",
                                        "caminho": [
                                                  "Tronco",
                                                  "HipocÃ´ndrio"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "hipoc-ndrio",
                                                            "nome": "HipocÃ´ndrio",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "HipogÃ¡strio": {
                                        "poligono": "HipogÃ¡strio",
                                        "caminho": [
                                                  "Tronco",
                                                  "HipogÃ¡strio"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "hipog-strio",
                                                            "nome": "HipogÃ¡strio",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Lateral da Ã³rbita": {
                                        "poligono": "Lateral da Ã³rbita",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Lateral da Ã³rbita"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "lateral-da-rbita",
                                                            "nome": "Lateral da Ã³rbita",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Lateral nasal": {
                                        "poligono": "Lateral nasal",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Lateral nasal"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "lateral-nasal",
                                                            "nome": "Lateral nasal",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "LÃ¡bio inferior": {
                                        "poligono": "LÃ¡bio inferior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "LÃ¡bio inferior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "l-bio-inferior",
                                                            "nome": "LÃ¡bio inferior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "LÃ¡bio superior": {
                                        "poligono": "LÃ¡bio superior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "LÃ¡bio superior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "l-bio-superior",
                                                            "nome": "LÃ¡bio superior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Membro inferior anterior": {
                                        "poligono": "Membro inferior anterior",
                                        "caminho": [
                                                  "Membros Inferiores",
                                                  "Membro inferior anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "membro-inferior-anterior",
                                                            "nome": "Membro inferior anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-membros-superiores",
                                                            "nome": "â†‘ Membros Superiores",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  },
                                                  {
                                                            "id": "ir-filho-coxa-anterior",
                                                            "nome": "â†“ Coxa anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-face-anterior-da-coxa",
                                                            "nome": "â†“ Face anterior da coxa",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-face-lateral-da-coxa",
                                                            "nome": "â†“ Face lateral da coxa",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-face-medial-da-coxa",
                                                            "nome": "â†“ Face medial da coxa",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-perna-anterior",
                                                            "nome": "â†“ Perna anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-p-anterior",
                                                            "nome": "â†“ PÃ© anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          },
          "Membro inferior posterior": {
                                        "poligono": "Membro inferior posterior",
                                        "caminho": [
                                                  "Membros Inferiores",
                                                  "Membro inferior posterior"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "membro-inferior-posterior",
                                                            "nome": "Membro inferior posterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-membros-inferiores",
                                                            "nome": "â†‘ Membros Inferiores",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Membro superior anterior": {
                                        "poligono": "Membro superior anterior",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Membro superior anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "membro-superior-anterior",
                                                            "nome": "Membro superior anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-membros-superiores",
                                                            "nome": "â†‘ Membros Superiores",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  },
                                                  {
                                                            "id": "ir-filho-antebra-o-anterior",
                                                            "nome": "â†“ AntebraÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-bra-o-anterior",
                                                            "nome": "â†“ BraÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-m-o-anterior",
                                                            "nome": "â†“ MÃ£o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-ombro-anterior",
                                                            "nome": "â†“ Ombro anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          },
          "Membro superior posterior": {
                                        "poligono": "Membro superior posterior",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Membro superior posterior"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "membro-superior-posterior",
                                                            "nome": "Membro superior posterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco",
                                                            "nome": "â†‘ Tronco",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  },
                                                  {
                                                            "id": "ir-filho-axila",
                                                            "nome": "â†“ Axila",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-face-medial-do-bra-o",
                                                            "nome": "â†“ Face medial do braÃ§o",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-pr-axilar",
                                                            "nome": "â†“ RegiÃ£o prÃ©-axilar",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          },
          "MesogÃ¡strio": {
                                        "poligono": "MesogÃ¡strio",
                                        "caminho": [
                                                  "Tronco",
                                                  "MesogÃ¡strio"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "mesog-strio",
                                                            "nome": "MesogÃ¡strio",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "MÃ£o anterior": {
                                        "poligono": "MÃ£o anterior",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "MÃ£o anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "m-o-anterior",
                                                            "nome": "MÃ£o anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Ombro anterior": {
                                        "poligono": "Ombro anterior",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Ombro anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "ombro-anterior",
                                                            "nome": "Ombro anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "Orelha visÃ£o anterior": {
                                        "poligono": "Orelha visÃ£o anterior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Orelha visÃ£o anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "orelha-vis-o-anterior",
                                                            "nome": "Orelha visÃ£o anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Orelha visÃ£o posterior": {
                                        "poligono": "Orelha visÃ£o posterior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (costas)",
                                                  "Orelha visÃ£o posterior"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "orelha-vis-o-posterior",
                                                            "nome": "Orelha visÃ£o posterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-posterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o posterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Pelve": {
                                        "poligono": "Pelve",
                                        "caminho": [
                                                  "Tronco",
                                                  "Pelve"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "pelve",
                                                            "nome": "Pelve",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Perna anterior": {
                                        "poligono": "Perna anterior",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Membro inferior anterior",
                                                  "Perna anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "perna-anterior",
                                                            "nome": "Perna anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "PÃ¡lpebra inferior": {
                                        "poligono": "PÃ¡lpebra inferior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "PÃ¡lpebra inferior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "p-lpebra-inferior",
                                                            "nome": "PÃ¡lpebra inferior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "PÃ¡lpebra superior": {
                                        "poligono": "PÃ¡lpebra superior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "PÃ¡lpebra superior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "p-lpebra-superior",
                                                            "nome": "PÃ¡lpebra superior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "PÃ© anterior": {
                                        "poligono": "PÃ© anterior",
                                        "caminho": [
                                                  "Membros Superiores",
                                                  "Membro inferior anterior",
                                                  "PÃ© anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "p-anterior",
                                                            "nome": "PÃ© anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "PescoÃ§o (anterior)": {
                                        "poligono": "PescoÃ§o",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "PescoÃ§o"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "pescoco-completo",
                                                            "nome": "PescoÃ§o",
                                                            "template": "avaliacao-generica",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "pescoco-anterior-virtual",
                                                            "nome": "RegiÃ£o cervical anterior",
                                                            "virtual": true,
                                                            "indentVisual": true,
                                                            "filhos": [
                                                                      {
                                                                                "id": "linha-media-cervical",
                                                                                "nome": "Linha mÃ©dia cervical",
                                                                                "template": "avaliacao-cervical",
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "regiao-suprahioidea",
                                                                                                    "nome": "RegiÃ£o supra-hiÃ³idea",
                                                                                                    "template": "avaliacao-cervical",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "regiao-infrahioidea",
                                                                                                    "nome": "RegiÃ£o infra-hiÃ³idea",
                                                                                                    "template": "avaliacao-cervical",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "fossa-supraesternal",
                                                                                                    "nome": "Fossa supraesternal",
                                                                                                    "template": "avaliacao-cervical",
                                                                                                    "filhos": []
                                                                                          }
                                                                                ]
                                                                      },
                                                                      {
                                                                                "id": "triangulo-anterior-bilateral",
                                                                                "nome": "TriÃ¢ngulo anterior (bilateral)",
                                                                                "virtual": true,
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "triangulo-anterior-d",
                                                                                                    "nome": "TriÃ¢ngulo anterior D",
                                                                                                    "template": "avaliacao-cervical",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "triangulo-anterior-e",
                                                                                                    "nome": "TriÃ¢ngulo anterior E",
                                                                                                    "template": "avaliacao-cervical",
                                                                                                    "filhos": []
                                                                                          }
                                                                                ]
                                                                      },
                                                                      {
                                                                                "id": "regiao-esternocleidomastoidea-bilateral",
                                                                                "nome": "RegiÃ£o esternocleidomastÃ³idea (bilateral)",
                                                                                "virtual": true,
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "regiao-esternocleidomastoidea-d",
                                                                                                    "nome": "RegiÃ£o esternocleidomastÃ³idea D",
                                                                                                    "template": "avaliacao-cervical",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "regiao-esternocleidomastoidea-e",
                                                                                                    "nome": "RegiÃ£o esternocleidomastÃ³idea E",
                                                                                                    "template": "avaliacao-cervical",
                                                                                                    "filhos": []
                                                                                          }
                                                                                ]
                                                                      },
                                                                      {
                                                                                "id": "fossa-supraclavicular-bilateral",
                                                                                "nome": "Fossa supraclavicular (bilateral)",
                                                                                "virtual": true,
                                                                                "filhos": [
                                                                                          {
                                                                                                    "id": "fossa-supraclavicular-d",
                                                                                                    "nome": "Fossa supraclavicular D",
                                                                                                    "template": "avaliacao-cervical",
                                                                                                    "filhos": []
                                                                                          },
                                                                                          {
                                                                                                    "id": "fossa-supraclavicular-e",
                                                                                                    "nome": "Fossa supraclavicular E",
                                                                                                    "template": "avaliacao-cervical",
                                                                                                    "filhos": []
                                                                                          }
                                                                                ]
                                                                      }
                                                            ]
                                                  },
                                                  {
                                                            "id": "ir-pai-cabeca-pescoco",
                                                            "nome": "â†‘ CabeÃ§a e PescoÃ§o",
                                                            "navegacao": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "PÃºbis": {
                                        "poligono": "PÃºbis",
                                        "caminho": [
                                                  "Tronco",
                                                  "PÃºbis"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "p-bis",
                                                            "nome": "PÃºbis",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o central do abdome": {
                                        "poligono": "RegiÃ£o central do abdome",
                                        "caminho": [
                                                  "Tronco",
                                                  "RegiÃ£o central do abdome"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-central-do-abdome",
                                                            "nome": "RegiÃ£o central do abdome",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o cervical anterior": {
                                        "poligono": "RegiÃ£o cervical anterior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o cervical anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-cervical-anterior",
                                                            "nome": "RegiÃ£o cervical anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o cervical lateral visÃ£o anterior": {
                                        "poligono": "RegiÃ£o cervical lateral visÃ£o anterior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o cervical lateral visÃ£o anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-cervical-lateral-vis-o-anterior",
                                                            "nome": "RegiÃ£o cervical lateral visÃ£o anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o cervical lateral visÃ£o posterior": {
                                        "poligono": "RegiÃ£o cervical lateral visÃ£o posterior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (costas)",
                                                  "RegiÃ£o cervical lateral visÃ£o posterior"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-cervical-lateral-vis-o-posterior",
                                                            "nome": "RegiÃ£o cervical lateral visÃ£o posterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-posterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o posterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o cervical posterior": {
                                        "poligono": "RegiÃ£o cervical posterior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (costas)",
                                                  "RegiÃ£o cervical posterior"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-cervical-posterior",
                                                            "nome": "RegiÃ£o cervical posterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-posterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o posterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o clavicular": {
                                        "poligono": "RegiÃ£o clavicular",
                                        "caminho": [
                                                  "Tronco",
                                                  "TÃ³rax anterior",
                                                  "RegiÃ£o clavicular"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-clavicular",
                                                            "nome": "RegiÃ£o clavicular",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-t-rax-anterior",
                                                            "nome": "â†‘ TÃ³rax anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o esternal": {
                                        "poligono": "RegiÃ£o esternal",
                                        "caminho": [
                                                  "Tronco",
                                                  "TÃ³rax anterior",
                                                  "RegiÃ£o esternal"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-esternal",
                                                            "nome": "RegiÃ£o esternal",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-t-rax-anterior",
                                                            "nome": "â†‘ TÃ³rax anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o frontal": {
                                        "poligono": "RegiÃ£o frontal",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o frontal"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-frontal",
                                                            "nome": "RegiÃ£o frontal",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o genital": {
                                        "poligono": "RegiÃ£o genital",
                                        "caminho": [
                                                  "Tronco",
                                                  "RegiÃ£o genital"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-genital",
                                                            "nome": "RegiÃ£o genital",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o infra-mamÃ¡ria": {
                                        "poligono": "RegiÃ£o infra-mamÃ¡ria",
                                        "caminho": [
                                                  "Tronco",
                                                  "TÃ³rax anterior",
                                                  "RegiÃ£o infra-mamÃ¡ria"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-infra-mam-ria",
                                                            "nome": "RegiÃ£o infra-mamÃ¡ria",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-t-rax-anterior",
                                                            "nome": "â†‘ TÃ³rax anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o infraclavicular": {
                                        "poligono": "RegiÃ£o infraclavicular",
                                        "caminho": [
                                                  "Tronco",
                                                  "TÃ³rax anterior",
                                                  "RegiÃ£o infraclavicular"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-infraclavicular",
                                                            "nome": "RegiÃ£o infraclavicular",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-t-rax-anterior",
                                                            "nome": "â†‘ TÃ³rax anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o inguinal": {
                                        "poligono": "RegiÃ£o inguinal",
                                        "caminho": [
                                                  "Tronco",
                                                  "RegiÃ£o inguinal"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-inguinal",
                                                            "nome": "RegiÃ£o inguinal",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco-posterior",
                                                            "nome": "â†‘ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o malar / infraorbitÃ¡ria": {
                                        "poligono": "RegiÃ£o malar / infraorbitÃ¡ria",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o malar / infraorbitÃ¡ria"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-malar-infraorbit-ria",
                                                            "nome": "RegiÃ£o malar / infraorbitÃ¡ria",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o mamÃ¡ria": {
                                        "poligono": "RegiÃ£o mamÃ¡ria",
                                        "caminho": [
                                                  "Tronco",
                                                  "TÃ³rax anterior",
                                                  "RegiÃ£o mamÃ¡ria"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-mam-ria",
                                                            "nome": "RegiÃ£o mamÃ¡ria",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-t-rax-anterior",
                                                            "nome": "â†‘ TÃ³rax anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o mandibular anterior": {
                                        "poligono": "RegiÃ£o mandibular anterior",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o mandibular anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-mandibular-anterior",
                                                            "nome": "RegiÃ£o mandibular anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o mandibular posterior (c/ Ã¢ngulo mandibular D)": {
                                        "poligono": "RegiÃ£o mandibular posterior (c/ Ã¢ngulo mandibular D)",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o mandibular posterior (c/ Ã¢ngulo mandibular D)"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-mandibular-posterior-c-ngulo-mandibular-d-",
                                                            "nome": "RegiÃ£o mandibular posterior (c/ Ã¢ngulo mandibular D)",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o mandibular posterior (c/ Ã¢ngulo mandibular E)": {
                                        "poligono": "RegiÃ£o mandibular posterior (c/ Ã¢ngulo mandibular E)",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o mandibular posterior (c/ Ã¢ngulo mandibular E)"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-mandibular-posterior-c-ngulo-mandibular-e-",
                                                            "nome": "RegiÃ£o mandibular posterior (c/ Ã¢ngulo mandibular E)",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o mentoniana": {
                                        "poligono": "RegiÃ£o mentoniana",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o mentoniana"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-mentoniana",
                                                            "nome": "RegiÃ£o mentoniana",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o nasal": {
                                        "poligono": "RegiÃ£o nasal",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o nasal"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-nasal",
                                                            "nome": "RegiÃ£o nasal",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o nasociliar": {
                                        "poligono": "RegiÃ£o nasociliar",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o nasociliar"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-nasociliar",
                                                            "nome": "RegiÃ£o nasociliar",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o oral": {
                                        "poligono": "RegiÃ£o oral",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o oral"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-oral",
                                                            "nome": "RegiÃ£o oral",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o peitoral": {
                                        "poligono": "RegiÃ£o peitoral",
                                        "caminho": [
                                                  "Tronco",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o peitoral"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-peitoral",
                                                            "nome": "RegiÃ£o peitoral",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o peitoral lateral": {
                                        "poligono": "RegiÃ£o peitoral lateral",
                                        "caminho": [
                                                  "Tronco",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o peitoral lateral"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-peitoral-lateral",
                                                            "nome": "RegiÃ£o peitoral lateral",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o prÃ©-auricular": {
                                        "poligono": "RegiÃ£o prÃ©-auricular",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o prÃ©-auricular"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-pr-auricular",
                                                            "nome": "RegiÃ£o prÃ©-auricular",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o prÃ©-axilar": {
                                        "poligono": "RegiÃ£o prÃ©-axilar",
                                        "caminho": [
                                                  "Tronco",
                                                  "Membro superior anterior",
                                                  "RegiÃ£o prÃ©-axilar"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-pr-axilar",
                                                            "nome": "RegiÃ£o prÃ©-axilar",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  }
                                        ]
          },
          "RegiÃ£o submentoniana": {
                                        "poligono": "RegiÃ£o submentoniana",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o submentoniana"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-submentoniana",
                                                            "nome": "RegiÃ£o submentoniana",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o temporal": {
                                        "poligono": "RegiÃ£o temporal",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o temporal"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-temporal",
                                                            "nome": "RegiÃ£o temporal",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "RegiÃ£o zigomÃ¡tica": {
                                        "poligono": "RegiÃ£o zigomÃ¡tica",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "RegiÃ£o zigomÃ¡tica"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "regi-o-zigom-tica",
                                                            "nome": "RegiÃ£o zigomÃ¡tica",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Sulco labiomentoniano e \"prÃ©-jowls\"": {
                                        "poligono": "Sulco labiomentoniano e \"prÃ©-jowls\"",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Sulco labiomentoniano e \"prÃ©-jowls\""
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "sulco-labiomentoniano-e-pr-jowls-",
                                                            "nome": "Sulco labiomentoniano e \"prÃ©-jowls\"",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Sulco nasojugal": {
                                        "poligono": "Sulco nasojugal",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Sulco nasojugal"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "sulco-nasojugal",
                                                            "nome": "Sulco nasojugal",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Sulco nasolabial": {
                                        "poligono": "Sulco nasolabial",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "Sulco nasolabial"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "sulco-nasolabial",
                                                            "nome": "Sulco nasolabial",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "SupercÃ­lio": {
                                        "poligono": "SupercÃ­lio",
                                        "caminho": [
                                                  "CabeÃ§a e PescoÃ§o",
                                                  "CabeÃ§a e pescoÃ§o (frente)",
                                                  "SupercÃ­lio"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "bilateral-opcao",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "superc-lio",
                                                            "nome": "SupercÃ­lio",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": true,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†‘ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  }
                                        ]
          },
          "Tronco anterior": {
                                        "poligono": "Tronco anterior",
                                        "caminho": [
                                                  "Tronco",
                                                  "Tronco anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "tronco-anterior",
                                                            "nome": "Tronco anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco",
                                                            "nome": "â†‘ Tronco",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  },
                                                  {
                                                            "id": "ir-filho-t-rax-anterior",
                                                            "nome": "â†“ TÃ³rax anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          },
          "Tronco posterior": {
                                        "poligono": "Tronco posterior",
                                        "caminho": [
                                                  "Tronco",
                                                  "Tronco posterior"
                                        ],
                                        "vista": "Posterior",
                                        "lado": "",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "tronco-posterior",
                                                            "nome": "Tronco posterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-pai-tronco",
                                                            "nome": "â†‘ Tronco",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono PAI (regiÃ£o maior)"
                                                  },
                                                  {
                                                            "id": "ir-filho-abdome",
                                                            "nome": "â†“ Abdome",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-epig-strio",
                                                            "nome": "â†“ EpigÃ¡strio",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-flanco",
                                                            "nome": "â†“ Flanco",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-fossa-il-aca",
                                                            "nome": "â†“ Fossa ilÃ­aca",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-hipoc-ndrio",
                                                            "nome": "â†“ HipocÃ´ndrio",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-hipog-strio",
                                                            "nome": "â†“ HipogÃ¡strio",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-mesog-strio",
                                                            "nome": "â†“ MesogÃ¡strio",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-pelve",
                                                            "nome": "â†“ Pelve",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-p-bis",
                                                            "nome": "â†“ PÃºbis",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-central-do-abdome",
                                                            "nome": "â†“ RegiÃ£o central do abdome",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-genital",
                                                            "nome": "â†“ RegiÃ£o genital",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-inguinal",
                                                            "nome": "â†“ RegiÃ£o inguinal",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          },
          "TÃ³rax anterior": {
                                        "poligono": "TÃ³rax anterior",
                                        "caminho": [
                                                  "Tronco",
                                                  "TÃ³rax anterior"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": false,
                                        "opcoes": [
                                                  {
                                                            "id": "t-rax-anterior",
                                                            "nome": "TÃ³rax anterior",
                                                            "template": "avaliacao-generica",
                                                            "lateralidade": false,
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-clavicular",
                                                            "nome": "â†“ RegiÃ£o clavicular",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-esternal",
                                                            "nome": "â†“ RegiÃ£o esternal",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-infra-mam-ria",
                                                            "nome": "â†“ RegiÃ£o infra-mamÃ¡ria",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-infraclavicular",
                                                            "nome": "â†“ RegiÃ£o infraclavicular",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-regi-o-mam-ria",
                                                            "nome": "â†“ RegiÃ£o mamÃ¡ria",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          },



          "Tronco": {
                                        "poligono": "Tronco",
                                        "caminho": [
                                                  "Tronco"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "tronco",
                                                            "nome": "Tronco",
                                                            "template": "avaliacao-generica",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-filho-t-rax-anterior",
                                                            "nome": "â†“ TÃ³rax anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-cabe-a-e-pesco-o-anterior",
                                                            "nome": "â†“ CabeÃ§a e pescoÃ§o anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  },
                                                  {
                                                            "id": "ir-filho-tronco-anterior",
                                                            "nome": "â†“ Tronco anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          },
          "Membros Superiores": {
                                        "poligono": "Membros Superiores",
                                        "caminho": [
                                                  "Membros Superiores"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "membros-superiores",
                                                            "nome": "Membros Superiores",
                                                            "template": "avaliacao-generica",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-filho-membro-superior-anterior",
                                                            "nome": "â†“ Membro superior anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          },

          "Membros Inferiores": {
                                        "poligono": "Membros Inferiores",
                                        "caminho": [
                                                  "Membros Inferiores"
                                        ],
                                        "vista": "Anterior",
                                        "lado": "",
                                        "virtual": true,
                                        "opcoes": [
                                                  {
                                                            "id": "membros-inferiores",
                                                            "nome": "Membros Inferiores",
                                                            "template": "avaliacao-generica",
                                                            "filhos": []
                                                  },
                                                  {
                                                            "id": "ir-filho-membro-inferior-anterior",
                                                            "nome": "â†“ Membro inferior anterior",
                                                            "navegacao": true,
                                                            "filhos": [],
                                                            "info": "PolÃ­gono FILHO (sub-regiÃ£o)"
                                                  }
                                        ]
          }
};

        
        // ============================================================
        // INICIALIZAÃ‡ÃƒO DE HIERARQUIA - Adiciona campos novos
        // ============================================================
        function inicializarHierarquiaAtlas() {
            if (!ATLAS_ANATOMICO || !ATLAS_ANATOMICO.regioes) return;
            
            ATLAS_ANATOMICO.regioes.forEach((regiao, index) => {
                // Adicionar ID Ãºnico se nÃ£o tiver
                if (!regiao.id) {
                    regiao.id = `regiao-${index}-${regiao.nome.toLowerCase().replace(/\s+/g, '-')}`;
                }
                
                // Adicionar campos de hierarquia se nÃ£o tiver
                if (regiao.pai === undefined) regiao.pai = null;
                if (regiao.nivel === undefined) regiao.nivel = 0;
                if (regiao.template === undefined) regiao.template = null;
                if (regiao.filhos === undefined) regiao.filhos = [];
            });
            
            console.log('âœ… Hierarquia inicializada:', ATLAS_ANATOMICO.regioes.length, 'regiÃµes');
        }
        
        // Executar inicializaÃ§Ã£o ao carregar
        if (typeof ATLAS_ANATOMICO !== 'undefined') {
            setTimeout(() => inicializarHierarquiaAtlas(), 100);
        }
        
        // Adicionar mÃ©todos utilitÃ¡rios ao objeto existente
        if (typeof ATLAS_ANATOMICO !== 'undefined') {
            // Obter regiÃµes por vista
            ATLAS_ANATOMICO.obterRegioesPorVista = function(vista) {
                return (this.regioes || []).filter(r => r.vista === vista);
            };
            
            // Obter regiÃµes por grupo
            ATLAS_ANATOMICO.obterRegioesPorGrupo = function(grupo) {
                return (this.regioes || []).filter(r => r.grupo === grupo);
            };
            
            // Mapear propriedade 'imagem' para 'imagemBase64' (compatibilidade bidirecional)
            if (ATLAS_ANATOMICO.imagem && !ATLAS_ANATOMICO.imagemBase64) {
                ATLAS_ANATOMICO.imagemBase64 = ATLAS_ANATOMICO.imagem;
            } else if (ATLAS_ANATOMICO.imagemBase64 && !ATLAS_ANATOMICO.imagem) {
                ATLAS_ANATOMICO.imagem = ATLAS_ANATOMICO.imagemBase64;
            }
            
            console.log('âœ… Atlas anatÃ´mico jÃ¡ integrado inline:', (ATLAS_ANATOMICO.regioes || []).length, 'regiÃµes');
            console.log('ğŸ–¼ï¸  Imagem de fundo:', ATLAS_ANATOMICO.imagemBase64 ? 'SIM (' + Math.round(ATLAS_ANATOMICO.imagemBase64.length/1024) + 'KB)' : 'NÃƒO');
        } else {
            console.error('âŒ ATLAS_ANATOMICO nÃ£o foi carregado!');
        }
        
        // ============================================================
        // ANATOMIA ATENDIMENTO - MÃ³dulo integrado ao exame fÃ­sico
        // ============================================================
        const AnatomiaAtendimento = {
            
            // FunÃ§Ã£o para limpar nomes de exibiÃ§Ã£o (remove sufixos desnecessÃ¡rios)
            limparNomeExibicao(nome) {
                return nome
                    .replace(/\s*\(anterior\)/gi, '')
                    .replace(/\s*\(posterior\)/gi, '')
                    .replace(/\s*\(avaliaÃ§Ã£o tricolÃ³gica completa\)/gi, '')
                    .replace(/\s*\(frente\)/gi, '')
                    .replace(/\s*\(costas\)/gi, '')
                    .trim();
            },
            
            // Renderizar mÃ³dulo dentro do atendimento
            renderizar(containerId, config = {}) {
                const container = document.getElementById(containerId);
                if (!container) {
                    console.error('Container nÃ£o encontrado:', containerId);
                    return;
                }
                
                const visualizacao = config.visualizacao || 'frente';
                const template = config.template || '';
                const permitirEdicao = config.permitirEdicao !== false;
                const obrigatorio = config.obrigatorio || false;
                const modo = config.modo || 'livre'; // 'livre' ou 'atlas'
                const modoSimplificado = config.modoSimplificado || false; // true = sem tÃ­tulo/toggle (usado no Exame EspecÃ­fico)
                const contextoInicial = config.contextoInicial || 'anatomico'; // 'anatomico' ou 'queimados'
                
                // HTML do mÃ³dulo - modo simplificado nÃ£o mostra tÃ­tulo nem toggle
                const headerHTML = modoSimplificado ? '' : `
                        <h4 style="margin: 0 0 16px 0; color: var(--primary); display: flex; align-items: center; gap: 8px;">
                            <span>ğŸ—ºï¸</span>
                            <span>Atlas AnatÃ´mico - Dupla Vista</span>
                            ${obrigatorio ? '<span style="color: var(--danger); font-size: 12px; margin-left: 8px;">(OBRIGATÃ“RIO)</span>' : ''}
                        </h4>
                        
                        <!-- TOGGLE DE CONTEXTO -->
                        <div style="display: flex; gap: 12px; margin-bottom: 16px; background: #f8f9fa; padding: 12px; border-radius: 8px;">
                            <button id="btn-contexto-anatomico-${containerId}" 
                                    onclick="AnatomiaAtendimento.trocarContexto('${containerId}', 'anatomico')"
                                    style="flex: 1; padding: 10px; border: 2px solid #667eea; background: #667eea; color: white; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 13px; transition: all 0.3s;">
                                ğŸ“‹ Exame por RegiÃµes
                            </button>
                            <button id="btn-contexto-queimados-${containerId}"
                                    onclick="AnatomiaAtendimento.trocarContexto('${containerId}', 'queimados')"
                                    style="flex: 1; padding: 10px; border: 2px solid #ff6b6b; background: white; color: #ff6b6b; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 13px; transition: all 0.3s;">
                                ğŸ”¥ AvaliaÃ§Ã£o de Queimaduras
                            </button>
                        </div>
                `;
                
                container.innerHTML = `
                    <div style="background: #f8f9fa; padding: 16px; border-radius: 8px; border: 1px solid #e0e0e0;">
                        ${headerHTML}
                        
                        <!-- PAINEL DE QUEIMADOS (oculto por padrÃ£o) -->
                        <div id="painel-queimados-${containerId}" style="display: none; background: #fff3e0; padding: 16px; border-radius: 8px; border: 2px solid #ff9800; margin-bottom: 16px;">
                            <h5 style="margin: 0 0 12px 0; color: #e65100; font-weight: 600; font-size: 14px;">
                                ğŸ”¥ Ferramentas de AvaliaÃ§Ã£o
                            </h5>
                            
                            <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
                            <!-- SELETOR DE MÃ‰TODO (REGRA 9 vs LUND-BROWDER) -->
                            <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
                            <div style="margin-bottom: 16px; background: white; padding: 12px; border-radius: 6px; border: 2px solid #667eea;">
                                <label style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 8px; color: #667eea;">
                                    ğŸ“Š MÃ©todo de CÃ¡lculo:
                                </label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                    <label style="display: flex; align-items: center; padding: 8px; border: 2px solid #667eea; background: #667eea; color: white; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                        <input type="radio" name="metodo-queimadura-${containerId}" value="regra9" 
                                               checked
                                               onchange="AnatomiaAtendimento.alternarMetodoQueimaduras('${containerId}', 'regra9')"
                                               style="margin-right: 6px;">
                                        Regra dos 9
                                    </label>
                                    <label style="display: flex; align-items: center; padding: 8px; border: 2px solid #667eea; background: white; color: #667eea; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: 600;">
                                        <input type="radio" name="metodo-queimadura-${containerId}" value="lundBrowder"
                                               onchange="AnatomiaAtendimento.alternarMetodoQueimaduras('${containerId}', 'lundBrowder')"
                                               style="margin-right: 6px;">
                                        Lund-Browder
                                    </label>
                                </div>
                            </div>
                            
                            <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
                            <!-- SELETOR DE FAIXA ETÃRIA (sÃ³ aparece com Lund-Browder) -->
                            <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
                            
                            <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
                            <!-- DADOS OBRIGATÃ“RIOS (SÃ“ QUEIMADOS) - OCULTO POR PADRÃƒO          -->
                            <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
                            <div id="painel-dados-obrigatorios-${containerId}" style="display: none; background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%); border: 2px solid #ff9800; border-radius: 8px; padding: 12px; margin-bottom: 12px;">
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                                    <div style="font-size: 13px; font-weight: 700; color: #e65100;">
                                        ğŸ“‹ Dados ObrigatÃ³rios do Paciente
                                    </div>
                                    <button onclick="AnatomiaAtendimento.importarDadosPaciente('${containerId}')"
                                            style="background: #ff9800; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 11px; font-weight: 600; cursor: pointer;"
                                            title="Importar peso de Antropometria e idade de Dados do Paciente">
                                        ğŸ“¥ Importar do Atendimento
                                    </button>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                    <!-- Peso do Paciente -->
                                    <div>
                                        <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px; color: #e65100;">
                                            âš–ï¸ Peso (kg): <span id="peso-fonte-${containerId}" style="font-size: 9px; color: #059669; font-weight: 700;"></span>
                                        </label>
                                        <input type="number" id="peso-paciente-${containerId}" 
                                               placeholder="Ex: 70" min="1" max="300" step="0.5"
                                               oninput="AnatomiaAtendimento.validarDadosObrigatorios('${containerId}')"
                                               style="width: 100%; padding: 8px; border: 2px solid #ff9800; border-radius: 4px; font-size: 13px; background: white;">
                                    </div>
                                    
                                    <!-- Idade do Paciente -->
                                    <div>
                                        <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px; color: #e65100;">
                                            ğŸ‚ Idade (anos): <span id="idade-fonte-${containerId}" style="font-size: 9px; color: #059669; font-weight: 700;"></span>
                                        </label>
                                        <input type="number" id="idade-paciente-${containerId}" 
                                               placeholder="Ex: 35" min="0" max="120" step="1"
                                               oninput="AnatomiaAtendimento.validarDadosObrigatorios('${containerId}')"
                                               style="width: 100%; padding: 8px; border: 2px solid #ff9800; border-radius: 4px; font-size: 13px; background: white;">
                                    </div>
                                </div>
                                
                                <!-- Status de validaÃ§Ã£o -->
                                <div id="status-dados-${containerId}" style="margin-top: 8px; padding: 6px 10px; border-radius: 4px; font-size: 11px; text-align: center; background: #ffccbc; color: #bf360c;">
                                    âš ï¸ Preencha peso e idade para liberar a silhueta
                                </div>
                            </div>
                            
                            <!-- BLOQUEIO DA SILHUETA (SÃ“ QUEIMADOS) - OCULTO POR PADRÃƒO -->
                            <div id="bloqueio-silhueta-${containerId}" style="display: none; background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%); border: 2px dashed #9e9e9e; border-radius: 8px; padding: 40px 20px; text-align: center; margin-bottom: 12px;">
                                <div style="font-size: 48px; margin-bottom: 12px; opacity: 0.5;">ğŸ”’</div>
                                <div style="font-size: 14px; font-weight: 600; color: #616161; margin-bottom: 8px;">
                                    Silhueta Bloqueada
                                </div>
                                <div style="font-size: 12px; color: #9e9e9e;">
                                    Informe <strong>peso</strong> e <strong>idade</strong> acima para iniciar a avaliaÃ§Ã£o de queimaduras
                                </div>
                            </div>
                            
                            <!-- CONTAINER LIBERADO (VISÃVEL POR PADRÃƒO - ANATÃ”MICO) -->
                            <div id="container-silhueta-liberada-${containerId}" style="display: block;">
                            
                            <!-- FAIXA ETÃRIA (LUND-BROWDER) -->
                            <div id="painel-faixa-etaria-${containerId}" style="display: none; margin-bottom: 12px; background: #e8f5e9; padding: 12px; border-radius: 6px; border: 2px solid #4caf50;">
                                <label style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 8px; color: #2e7d32;">
                                    ğŸ‘¶ Faixa EtÃ¡ria (Lund-Browder):
                                </label>
                                <select id="faixa-etaria-${containerId}" 
                                        onchange="AnatomiaAtendimento.alterarFaixaEtaria('${containerId}')"
                                        style="width: 100%; padding: 8px; border: 2px solid #4caf50; border-radius: 4px; font-size: 12px; font-weight: 600; background: white; color: #2e7d32; cursor: pointer;">
                                    <option value="0-1">0-1 ano (bebÃª) - CabeÃ§a 19%</option>
                                    <option value="1-4">1-4 anos (prÃ©-escolar) - CabeÃ§a 17%</option>
                                    <option value="5-9" selected>5-9 anos (escolar) - CabeÃ§a 13%</option>
                                    <option value="10-14">10-14 anos (adolescente) - CabeÃ§a 11%</option>
                                    <option value="15+">15+ anos (adulto) - CabeÃ§a 7%</option>
                                </select>
                                <div style="margin-top: 8px; font-size: 10px; color: #558b2f; background: white; padding: 6px; border-radius: 3px;">
                                    â„¹ï¸ Percentuais ajustados por idade. CabeÃ§a diminui e pernas aumentam com crescimento.
                                </div>
                            </div>
                            
                            </div><!-- FIM container-silhueta-liberada -->
                            
                        </div>
                        
                        <!-- ATLAS COM DUPLA VISTA -->
                        <div id="modo-atlas-${containerId}">
                            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 16px;">
                                <!-- Atlas AnatÃ´mico - SVG Ãšnico -->
                                <div style="background: white; padding: 16px; border-radius: 8px;">
                                    <h5 style="text-align: center; margin: 0 0 12px 0; font-size: 14px; font-weight: 600; color: var(--primary);">
                                        ğŸ—ºï¸ Atlas AnatÃ´mico Completo
                                    </h5>
                                    <div style="position: relative;">
                                        <svg id="svg-atlas-completo-${containerId}" viewBox="0 290 700 620" 
                                             style="width: 100%; height: auto; border: 1px solid #e0e0e0; border-radius: 8px; cursor: pointer;">
                                            <!-- Imagem de fundo -->
                                            <g id="imagem-base-${containerId}"></g>
                                            <!-- Linha divisÃ³ria central -->
                                            <line x1="350" y1="290" x2="350" y2="910" stroke="#ccc" stroke-width="1" stroke-dasharray="5,5" opacity="0.3"/>
                                            <!-- TÃ­tulos -->
                                            <text x="175" y="895" text-anchor="middle" font-size="16" font-weight="bold" fill="#1976d2">ğŸ‘¤ Frente</text>
                                            <text x="525" y="895" text-anchor="middle" font-size="16" font-weight="bold" fill="#1976d2">ğŸ”™ Costas</text>
                                            <!-- Todos os polÃ­gonos aqui -->
                                            <g id="regioes-anterior-anatomico-${containerId}"></g>
                                            <g id="regioes-anterior-queimaduras-${containerId}" style="display: none;"></g>
                                            <g id="regioes-posterior-anatomico-${containerId}"></g>
                                            <g id="regioes-posterior-queimaduras-${containerId}" style="display: none;"></g>
                                        </svg>
                                        <canvas id="canvas-queimados-${containerId}" 
                                                width="700" height="620"
                                                style="position: absolute; top: 0; left: 0; pointer-events: none; cursor: crosshair; display: none;">
                                        </canvas>
                                    </div>
                                </div>
                                
                                <!-- Lista de RegiÃµes ANATÃ”MICAS -->
                                <div id="painel-lista-anatomico-${containerId}" style="background: white; padding: 16px; border-radius: 8px;">
                                    <h5 style="margin: 0 0 12px 0; font-size: 14px; font-weight: 600;">
                                        ğŸ“ RegiÃµes Marcadas (<span id="total-regioes-${containerId}">0</span>)
                                    </h5>
                                    <div id="lista-regioes-${containerId}" style="max-height: 600px; overflow-y: auto;">
                                        <p style="text-align: center; color: #999; font-size: 13px; padding: 20px 0;">
                                            Clique nas regiÃµes para marcar
                                        </p>
                                    </div>
                                </div>
                                
                                <!-- Lista de RegiÃµes QUEIMADURAS -->
                                <div id="painel-lista-queimaduras-${containerId}" style="background: white; padding: 16px; border-radius: 8px; display: none;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                        <h5 style="margin: 0; font-size: 14px; font-weight: 600;">
                                            ğŸ”¥ RegiÃµes Queimaduras
                                        </h5>
                                        <button onclick="AnatomiaAtendimento.atualizarListaQueimaduras('${containerId}')" 
                                                onmouseover="this.style.background='#f0f0f0'; this.style.transform='rotate(180deg)'" 
                                                onmouseout="this.style.background='none'; this.style.transform='rotate(0deg)'"
                                                title="Atualizar lista"
                                                style="background: none; border: none; cursor: pointer; font-size: 16px; padding: 6px 8px; color: #666; transition: all 0.3s; border-radius: 4px;">
                                            ğŸ”„
                                        </button>
                                    </div>
                                    <div id="lista-queimaduras-${containerId}" style="max-height: 600px; overflow-y: auto;"></div>
                                </div>

                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <!-- FERRAMENTAS DE EDIÃ‡ÃƒO (ABAIXO DA SILHUETA) - SÃ“ EM QUEIMADOS   -->
                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <div id="ferramentas-queimados-${containerId}" style="display: none; margin-top: 16px; background: white; padding: 16px; border-radius: 8px; border: 2px solid #667eea;">
                                <h5 style="margin: 0 0 12px 0; color: #667eea; font-weight: 600; font-size: 13px;">
                                    ğŸ–Œï¸ Ferramentas de Pintura
                                </h5>
                                
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 12px;">
                                    <!-- Ferramenta -->
                                    <button id="btn-pincel-${containerId}" 
                                            onclick="AnatomiaAtendimento.selecionarFerramenta('${containerId}', 'pincel')"
                                            style="padding: 10px; border: 2px solid #667eea; background: #667eea; color: white; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;">
                                        ğŸ–Œï¸ Pincel
                                    </button>
                                    <button id="btn-borracha-${containerId}" 
                                            onclick="AnatomiaAtendimento.selecionarFerramenta('${containerId}', 'borracha')"
                                            style="padding: 10px; border: 2px solid #666; background: white; color: #666; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;">
                                        ğŸ—‘ï¸ Borracha
                                    </button>
                                    
                                    <!-- Grau -->
                                    <button id="btn-grau2-${containerId}" 
                                            onclick="AnatomiaAtendimento.selecionarGrau('${containerId}', 2)"
                                            style="padding: 10px; border: 2px solid #ff9800; background: #ff9800; color: white; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600; transition: all 0.2s;">
                                        ğŸ”¥ 2Âº Grau
                                    </button>
                                    <button id="btn-grau3-${containerId}" 
                                            onclick="AnatomiaAtendimento.selecionarGrau('${containerId}', 3)"
                                            style="padding: 10px; border: 2px solid #c62828; background: white; color: #c62828; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: 600; transition: all 0.2s;">
                                        ğŸ”¥ 3Âº Grau
                                    </button>
                                </div>
                                
                                <!-- Tamanho do Pincel -->
                                <div style="margin-bottom: 12px;">
                                    <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 6px; color: #666;">
                                        ğŸ“ Tamanho do Pincel:
                                    </label>
                                    <div style="display: flex; gap: 8px; align-items: center;">
                                        <input type="range" id="brush-size-${containerId}" 
                                               min="5" max="30" value="15" step="1"
                                               oninput="AnatomiaAtendimento.setBrushSize('${containerId}', this.value)"
                                               style="flex: 1;">
                                        <span id="brush-display-${containerId}" style="min-width: 45px; font-size: 12px; font-weight: 700; color: #667eea; background: #f0f4ff; padding: 4px 8px; border-radius: 4px;">15px</span>
                                    </div>
                                </div>
                                
                                <!-- BotÃµes de AÃ§Ã£o RÃ¡pida -->
                                <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                    <button onclick="AnatomiaAtendimento.pintarTudo100Grau2('${containerId}')"
                                            style="flex: 1; padding: 10px; border: 2px solid #ff9800; background: #ff9800; color: white; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;"
                                            onmouseover="this.style.background='#f57c00'; this.style.borderColor='#f57c00';"
                                            onmouseout="this.style.background='#ff9800'; this.style.borderColor='#ff9800';">
                                        ğŸ”¥ Pintar 100%<br><span style="font-size: 10px;">(2Âº Grau)</span>
                                    </button>
                                </div>
                                
                                <!-- BotÃ£o Limpar -->
                                <button onclick="AnatomiaAtendimento.limparPintura('${containerId}')"
                                        style="width: 100%; padding: 10px; border: 2px solid #dc2626; background: white; color: #dc2626; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;">
                                    ğŸ—‘ï¸ Limpar Toda Pintura
                                </button>
                            </div>

                            <!-- Resultados (SÃ“ EM QUEIMADOS) -->
                            <div id="resultados-queimados-${containerId}" style="display: none; background: white; padding: 12px; border-radius: 4px; border: 1px solid #e0e0e0; margin-bottom: 12px;">
                                <div style="font-size: 12px; color: #666; margin-bottom: 8px;">
                                    <strong>% SCQ Total:</strong> <span id="scq-total-${containerId}" style="color: #e65100; font-weight: 600;">0%</span>
                                </div>
                                <div style="font-size: 11px; color: #999; margin-bottom: 4px;">
                                    â€¢ 2Âº grau: <span id="scq-grau2-${containerId}">0%</span>
                                </div>
                                <div style="font-size: 11px; color: #999; margin-bottom: 8px;">
                                    â€¢ 3Âº grau: <span id="scq-grau3-${containerId}">0%</span>
                                </div>
                                
                                <!-- ğŸ”„ CORREÃ‡ÃƒO #3: Toggle de Protocolo Parkland -->
                                <div style="border-top: 1px solid #e0e0e0; padding-top: 8px; margin-top: 8px; margin-bottom: 8px;">
                                    <div style="font-size: 11px; font-weight: 600; color: #666; margin-bottom: 6px;">
                                        âš™ï¸ Protocolo de HidrataÃ§Ã£o:
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
                                        <label style="display: flex; align-items: center; padding: 6px; border: 2px solid #0288d1; background: #0288d1; color: white; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: 600; text-align: center; justify-content: center;">
                                            <input type="radio" name="protocolo-parkland-${containerId}" value="classico" 
                                                   checked
                                                   onchange="AnatomiaAtendimento.alternarProtocoloParkland('${containerId}', 'classico')"
                                                   style="margin-right: 4px;">
                                            Parkland ClÃ¡ssico
                                        </label>
                                        <label style="display: flex; align-items: center; padding: 6px; border: 2px solid #0288d1; background: white; color: #0288d1; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: 600; text-align: center; justify-content: center;">
                                            <input type="radio" name="protocolo-parkland-${containerId}" value="novo"
                                                   onchange="AnatomiaAtendimento.alternarProtocoloParkland('${containerId}', 'novo')"
                                                   style="margin-right: 4px;">
                                            Novo ATLS
                                        </label>
                                    </div>
                                    <div style="font-size: 9px; color: #999; margin-top: 4px; font-style: italic;">
                                        ClÃ¡ssico: 4 mL Ã— kg Ã— SCQ | Novo: 2-3-4 mL (idade/tipo)
                                    </div>
                                    
                                    <!-- ğŸ“‹ ExplicaÃ§Ã£o detalhada do protocolo -->
                                    <div id="explicacao-protocolo-${containerId}" style="display: none; margin-top: 8px; padding: 8px; background: #e3f2fd; border-left: 3px solid #0288d1; border-radius: 4px;">
                                        <div style="font-size: 10px; font-weight: 600; color: #0277bd; margin-bottom: 4px;">
                                            ğŸ“Š Novo ATLS - Faixas por Idade e Tipo:
                                        </div>
                                        <div style="font-size: 9px; color: #01579b; line-height: 1.5;">
                                            â€¢ <strong>2 mL/kg/%SCQ:</strong> Idosos â‰¥65 anos<br>
                                            â€¢ <strong>3 mL/kg/%SCQ:</strong> CrianÃ§as <13 anos<br>
                                            â€¢ <strong>4 mL/kg/%SCQ:</strong> Adultos 13-64a e Queimaduras elÃ©tricas
                                        </div>
                                        <div style="font-size: 8px; color: #666; margin-top: 4px; font-style: italic;">
                                            ğŸ’¡ NOVO ATLS: Volume total Ã· 16h (taxa constante)
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="border-top: 1px solid #e0e0e0; padding-top: 8px; margin-top: 8px;">
                                    <div style="font-size: 11px; font-weight: 600; color: #666; margin-bottom: 4px;">
                                        ğŸ’§ <span id="titulo-parkland-${containerId}">FÃ³rmula de Parkland:</span>
                                    </div>
                                    <div style="font-size: 11px; color: #999;">
                                        <span id="label-volume-${containerId}">Volume 24h</span>: <span id="parkland-total-${containerId}" style="font-weight: 600;">--</span>
                                    </div>
                                    
                                    <!-- CLÃSSICO: 8h/16h separados -->
                                    <div id="parkland-classico-div-${containerId}" style="margin-top: 4px;">
                                        <div style="font-size: 10px; color: #999;">
                                            â€¢ Primeiras 8h: <span id="parkland-8h-${containerId}">--</span>
                                        </div>
                                        <div style="font-size: 10px; color: #999;">
                                            â€¢ 16h seguintes: <span id="parkland-16h-${containerId}">--</span>
                                        </div>
                                    </div>
                                    
                                    <!-- NOVO ATLS: Taxa constante -->
                                    <div id="parkland-novo-div-${containerId}" style="display: none; margin-top: 4px;">
                                        <div style="font-size: 10px; color: #999;">
                                            â€¢ Taxa: <span id="parkland-taxa-${containerId}">--</span> ml/h
                                        </div>
                                        <div style="font-size: 10px; color: #999;">
                                            â€¢ (infundir em 16h total)
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            </div>

                            
                            
                            <!-- CONTAINER DE PROTOCOLOS (SÃ“ EM QUEIMADOS) -->
                            <div id="protocolos-queimados-${containerId}" style="display: none;">
                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <!-- LINHA 1: APH | INTRA-HOSPITALAR | METAS (3 COLUNAS)           -->
                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 12px;">
                            <!-- PROTOCOLO PRÃ‰-HOSPITALAR -->
                            <div style="background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); padding: 12px; border-radius: 4px; border: 2px solid #2196f3; margin-bottom: 12px;">
                                <div style="font-size: 12px; font-weight: 600; color: #0d47a1; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                                    ğŸš‘ Protocolo PrÃ©-Hospitalar (APH)
                                </div>
                                <div style="font-size: 11px; color: #1565c0; line-height: 1.5; background: white; padding: 8px; border-radius: 4px;">
                                    <div style="font-weight: 600; margin-bottom: 4px;">Taxa de InfusÃ£o Recomendada:</div>
                                    <div id="protocolo-aph-${containerId}" style="font-size: 13px; font-weight: 700; color: #1976d2;">
                                        --
                                    </div>
                                    <div style="font-size: 10px; color: #666; margin-top: 6px; border-top: 1px solid #e0e0e0; padding-top: 6px;">
                                        <strong>ReferÃªncia:</strong><br>
                                        â€¢ AtÃ© 5 anos: 125 ml/h<br>
                                        â€¢ 6 a 12 anos: 250 ml/h<br>
                                        â€¢ Acima de 13 anos: 500 ml/h
                                    </div>
                                </div>
                            </div>
                            
                            <!-- HIDRATAÃ‡ÃƒO INTRA-HOSPITALAR -->
                            <div style="background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%); padding: 12px; border-radius: 4px; border: 2px solid #9c27b0; margin-bottom: 12px;">
                                <div style="font-size: 12px; font-weight: 600; color: #4a148c; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                                    ğŸ’‰ HidrataÃ§Ã£o Intra-Hospitalar
                                </div>
                                
                                <!-- Tipo de Queimadura -->
                                <div style="margin-bottom: 8px;">
                                    <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px; color: #6a1b9a;">
                                        Tipo de Queimadura:
                                    </label>
                                    <select id="tipo-queimadura-${containerId}" 
                                            onchange="AnatomiaAtendimento.atualizarProtocolos('${containerId}')"
                                            style="width: 100%; padding: 6px; border: 1px solid #9c27b0; border-radius: 4px; font-size: 12px;">
                                        <option value="termica">TÃ©rmica / QuÃ­mica</option>
                                        <option value="eletrica">ElÃ©trica</option>
                                    </select>
                                </div>
                                
                                <!-- Resultados (SÃ“ EM QUEIMADOS) -->
                                <div style="background: white; padding: 8px; border-radius: 4px;">
                                    <div style="font-size: 11px; color: #6a1b9a; margin-bottom: 4px;">
                                        <strong>FÃ³rmula:</strong> <span id="formula-hidratacao-${containerId}">--</span>
                                    </div>
                                    
                                    <!-- RESULTADO PARKLAND CLÃSSICO -->
                                    <div id="resultado-classico-${containerId}" style="margin-bottom: 6px;">
                                        <div style="font-size: 12px; font-weight: 700; color: #7b1fa2; margin-bottom: 4px;">
                                            Volume 24h: <span id="volume-24h-${containerId}">--</span>
                                        </div>
                                        <div style="font-size: 10px; color: #666;">
                                            â€¢ Primeiras 8h: <span id="taxa-classico-8h-${containerId}">--</span>
                                        </div>
                                        <div style="font-size: 10px; color: #666;">
                                            â€¢ 16h seguintes: <span id="taxa-classico-16h-${containerId}">--</span>
                                        </div>
                                    </div>
                                    
                                    <!-- RESULTADO NOVO ATLS -->
                                    <div id="resultado-novo-atls-${containerId}" style="display: none; margin-bottom: 6px;">
                                        <div style="font-size: 12px; font-weight: 700; color: #7b1fa2; margin-bottom: 4px;">
                                            Volume Total: <span id="volume-novo-atls-${containerId}">--</span>
                                        </div>
                                        <div style="font-size: 10px; color: #666;">
                                            â€¢ Taxa constante: <span id="taxa-novo-atls-${containerId}">--</span> ml/h
                                        </div>
                                        <div style="font-size: 10px; color: #666;">
                                            â€¢ (infundir em 16h total)
                                        </div>
                                    </div>
                                    
                                    <div id="solucao-adicional-${containerId}" style="font-size: 10px; color: #e65100; margin-top: 6px; padding: 6px; background: #fff3e0; border-radius: 3px; display: none;">
                                        <strong>âš ï¸ Adicional:</strong> <span id="texto-solucao-${containerId}"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- METAS DE DIURESE -->
                            <div style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 12px; border-radius: 4px; border: 2px solid #4caf50; margin-bottom: 12px;">
                                <div style="font-size: 12px; font-weight: 600; color: #1b5e20; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                                    ğŸ¯ Metas de Diurese
                                </div>
                                <div style="background: white; padding: 8px; border-radius: 4px;">
                                    <div style="font-size: 13px; font-weight: 700; color: #2e7d32; margin-bottom: 4px;">
                                        Meta: <span id="meta-diurese-${containerId}">--</span>
                                    </div>
                                    <div style="font-size: 10px; color: #666; margin-top: 6px; border-top: 1px solid #e0e0e0; padding-top: 6px;">
                                        <strong>Para peso de <span id="peso-display-${containerId}">70</span> kg:</strong><br>
                                        <span id="meta-diurese-ml-${containerId}">--</span>
                                    </div>
                                    <div id="meta-especial-eletrica-${containerId}" style="font-size: 10px; color: #e65100; margin-top: 6px; padding: 6px; background: #fff3e0; border-radius: 3px; display: none;">
                                        <strong>âš ï¸ Queimadura elÃ©trica:</strong> Manter diurese 1-1.5 ml/kg/h atÃ© urina livre de pigmentos (sem mioglobina)
                                    </div>
                                </div>
                            </div>
                            
                            </div>

                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <!-- LINHA 2: ÃREAS NOBRES | SITUAÃ‡Ã•ES ESPECIAIS (2 COLUNAS)       -->
                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 12px;">
                            <!-- ÃREAS NOBRES (CritÃ©rios de InternaÃ§Ã£o) -->
                            <div style="background: #f9fafb; padding: 12px; border-radius: 4px; border: 2px solid #ffc107; margin-bottom: 12px;">
                                <div style="font-size: 13px; font-weight: 600; color: #856404; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                                    âš ï¸ Ãreas Nobres Queimadas
                                </div>
                                <div style="font-size: 10px; color: #856404; margin-bottom: 8px; line-height: 1.4;">
                                    Marque se alguma destas Ã¡reas foi queimada (critÃ©rio para internaÃ§Ã£o):
                                </div>
                                <div style="display: grid; gap: 6px;">
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="area-nobre-face-${containerId}" 
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ‘¤ Face (risco de via aÃ©rea)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="area-nobre-maos-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ–ï¸ MÃ£os (funÃ§Ã£o motora)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="area-nobre-pes-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ¦¶ PÃ©s (deambulaÃ§Ã£o)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="area-nobre-genitalia-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ”’ GenitÃ¡lia/PerÃ­neo</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="area-nobre-pescoco-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ‘” PescoÃ§o (via aÃ©rea)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="area-nobre-olhos-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ‘ï¸ RegiÃ£o periocular</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="area-nobre-articulacoes-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ¦´ Grandes articulaÃ§Ãµes</span>
                                    </label>
                                </div>
                            </div>
                            
                            <!-- SITUAÃ‡Ã•ES ESPECIAIS -->
                            <div style="background: #f9fafb; padding: 12px; border-radius: 4px; border: 2px solid #ffc107; margin-bottom: 12px;">
                                <div style="font-size: 13px; font-weight: 600; color: #856404; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                                    âš ï¸ SituaÃ§Ãµes Especiais
                                </div>
                                <div style="display: grid; gap: 6px;">
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="situacao-lesao-inalatoria-${containerId}" 
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ« LesÃ£o inalatÃ³ria / Via aÃ©rea comprometida</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="situacao-trauma-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸš‘ Trauma associado (politrauma)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="situacao-comorbidades-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>âš•ï¸ Comorbidades significativas (diabetes, cardiopatia, etc)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="situacao-circular-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ”„ Queimadura circular (risco de sÃ­ndrome compartimental)</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="situacao-abuso-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ‘ï¸ Suspeita de abuso/negligÃªncia</span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 6px; font-size: 11px; color: #333; cursor: pointer;">
                                        <input type="checkbox" id="situacao-social-${containerId}"
                                               onchange="AnatomiaAtendimento.atualizarCriteriosInternacao('${containerId}')"
                                               style="cursor: pointer;">
                                        <span>ğŸ  CondiÃ§Ãµes sociais inadequadas para tratamento ambulatorial</span>
                                    </label>
                                </div>
                            </div>
                            
                            </div>

                            <!-- INDICAÃ‡ÃƒO DE INTERNAÃ‡ÃƒO -->
                            <div id="criterios-internacao-${containerId}" style="display: none; background: #f8d7da; padding: 12px; border-radius: 4px; border: 2px solid #dc3545; margin-bottom: 12px;">
                                <div style="font-size: 13px; font-weight: 700; color: #721c24; margin-bottom: 8px; text-align: center;">
                                    ğŸ¥ INDICA INTERNAÃ‡ÃƒO
                                </div>
                                <div id="criterios-lista-${containerId}" style="font-size: 11px; color: #721c24; line-height: 1.7;">
                                </div>
                                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #dc3545;">
                                    <div style="font-size: 10px; font-weight: 600; color: #721c24; margin-bottom: 6px;">
                                        ğŸ“‹ Protocolo SUS FÃ¡cil - Checklist:
                                    </div>
                                    <div style="font-size: 10px; color: #721c24; line-height: 1.6;">
                                        â˜ COVID-19 negativo (teste recente)<br>
                                        â˜ Imagens/fotos enviadas para grupo<br>
                                        â˜ Vaga reservada em centro especializado<br>
                                        â˜ FamÃ­lia orientada sobre transporte
                                    </div>
                                </div>
                            </div>
                            
                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <!-- BOX DE CLASSIFICAÃ‡ÃƒO FINAL DO QUEIMADO                         -->
                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <div id="classificacao-final-${containerId}" style="margin-top: 16px; margin-bottom: 16px; background: white; padding: 16px; border-radius: 8px; border: 3px solid #ddd; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                <!-- CabeÃ§alho -->
                                <div style="text-align: center; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 2px solid #e0e0e0;">
                                    <div style="font-size: 14px; font-weight: 700; color: #333; margin-bottom: 4px;">
                                        ğŸ“Š CLASSIFICAÃ‡ÃƒO DO QUEIMADO
                                    </div>
                                    <div style="font-size: 10px; color: #666;">
                                        (Baseada em % SCQ, Ã¡reas nobres e situaÃ§Ãµes especiais)
                                    </div>
                                </div>
                                
                                <!-- Box da ClassificaÃ§Ã£o (cor dinÃ¢mica) -->
                                <div id="classificacao-box-${containerId}" style="padding: 16px; border-radius: 6px; margin-bottom: 12px; text-align: center; background: #f5f5f5; border: 2px solid #ddd;">
                                    <div id="classificacao-titulo-${containerId}" style="font-size: 20px; font-weight: 700; margin-bottom: 8px;">
                                        âšª Calculando...
                                    </div>
                                    <div id="classificacao-descricao-${containerId}" style="font-size: 11px; color: #666;">
                                        Preencha os dados para ver a classificaÃ§Ã£o
                                    </div>
                                </div>
                                
                                <!-- CritÃ©rios Identificados -->
                                <div style="background: #f9fafb; padding: 12px; border-radius: 6px; margin-bottom: 12px;">
                                    <div style="font-size: 12px; font-weight: 600; color: #374151; margin-bottom: 8px;">
                                        ğŸ“‹ CritÃ©rios identificados:
                                    </div>
                                    <div id="classificacao-criterios-${containerId}" style="font-size: 11px; color: #6b7280; line-height: 1.7;">
                                        â€¢ Aguardando avaliaÃ§Ã£o...
                                    </div>
                                </div>
                                
                                <!-- Conduta -->
                                <div id="classificacao-conduta-${containerId}" style="padding: 12px; border-radius: 6px; background: #f9fafb; border: 2px solid #3b82f6;">
                                    <div style="font-size: 12px; font-weight: 600; color: #1e40af; margin-bottom: 4px;">
                                        ğŸ¥ Conduta:
                                    </div>
                                    <div id="classificacao-conduta-texto-${containerId}" style="font-size: 11px; color: #1e40af;">
                                        Aguardando classificaÃ§Ã£o...
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 12px; padding: 8px; background: rgba(255,152,0,0.1); border-radius: 4px; font-size: 10px; color: #e65100;">
                                <strong>ğŸ’¡ InstruÃ§Ã£o:</strong> Clique nas Ã¡reas da silhueta para marcar como queimadas. O percentual serÃ¡ calculado automaticamente.
                            </div>
                            
                            </div>
                            <!-- FIM CONTAINER PROTOCOLOS -->
                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <div id="editor-customizado-${containerId}" style="display: none; margin-top: 16px; background: #fff3e0; padding: 16px; border-radius: 8px; border: 2px solid #ff9800;">
                                <h5 style="margin: 0 0 12px 0; color: #e65100; font-size: 14px; font-weight: 600;">
                                    âœï¸ Editor de Ãrea Customizada
                                </h5>
                                
                                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 16px;">
                                    <!-- Canvas para desenhar -->
                                    <div>
                                        <p style="font-size: 12px; color: #e65100; margin-bottom: 8px;">
                                            ğŸ‘† Clique na vista desejada para marcar pontos
                                        </p>
                                        <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                                            <button onclick="AnatomiaAtendimento.selecionarVistaCustomizada('${containerId}', 'Anterior')" 
                                                    id="btn-custom-anterior-${containerId}"
                                                    class="btn btn-primary" style="flex: 1; font-size: 12px;">
                                                ğŸ‘¤ Desenhar na Frente
                                            </button>
                                            <button onclick="AnatomiaAtendimento.selecionarVistaCustomizada('${containerId}', 'Posterior')" 
                                                    id="btn-custom-posterior-${containerId}"
                                                    class="btn btn-secondary" style="flex: 1; font-size: 12px;">
                                                ğŸ”™ Desenhar nas Costas
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Controles -->
                                    <div>
                                        <label style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 4px;">Nome da Ãrea:</label>
                                        <input type="text" id="custom-nome-${containerId}" placeholder="Ex: Cicatriz braÃ§o" 
                                               style="width: 100%; padding: 6px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 8px; font-size: 12px;">
                                        
                                        <label style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 4px;">Grupo:</label>
                                        <input type="text" id="custom-grupo-${containerId}" placeholder="Ex: Ãreas Customizadas" 
                                               style="width: 100%; padding: 6px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 8px; font-size: 12px;">
                                        
                                        <label style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 4px;">Cor:</label>
                                        <input type="color" id="custom-cor-${containerId}" value="#ff9800" 
                                               style="width: 100%; height: 36px; padding: 2px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 8px; cursor: pointer;">
                                        
                                        <div style="margin: 12px 0; padding: 8px; background: #f0f8ff; border-left: 3px solid var(--primary); border-radius: 4px;">
                                            <div style="font-size: 11px; font-weight: 700; color: var(--primary); margin-bottom: 6px;">ğŸŒ³ HIERARQUIA</div>
                                            
                                            <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px;">RegiÃ£o Pai:</label>
                                            <select id="custom-pai-${containerId}" 
                                                    style="width: 100%; padding: 6px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 6px; font-size: 11px;">
                                                <option value="">Nenhum (raiz)</option>
                                            </select>
                                            
                                            <label style="display: block; font-size: 11px; font-weight: 600; margin-bottom: 4px;">AvaliaÃ§Ã£o Especial:</label>
                                            <select id="custom-template-${containerId}" 
                                                    style="width: 100%; padding: 6px; border: 1px solid #ccc; border-radius: 4px; font-size: 11px;">
                                                <option value="">Nenhuma (sÃ³ marcar)</option>
                                            </select>
                                        </div>
                                        
                                        <label style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 4px;">Pontos marcados: <span id="custom-total-pontos-${containerId}">0</span></label>
                                        
                                        <div style="display: grid; gap: 4px; margin-top: 12px;">
                                            <button onclick="AnatomiaAtendimento.desfazerUltimoPonto('${containerId}')" 
                                                    class="btn btn-secondary" style="width: 100%; font-size: 11px;">
                                                â†¶ Desfazer Ãšltimo Ponto
                                            </button>
                                            <button onclick="AnatomiaAtendimento.finalizarAreaCustomizada('${containerId}')" 
                                                    class="btn btn-success" style="width: 100%; font-size: 11px;">
                                                âœ“ Finalizar e Adicionar
                                            </button>
                                            <button onclick="AnatomiaAtendimento.cancelarEditorCustomizado('${containerId}')" 
                                                    class="btn btn-danger" style="width: 100%; font-size: 11px;">
                                                âœ• Cancelar Tudo
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Inicializar dados
                if (!this.instancias) this.instancias = {};
                this.instancias[containerId] = {
                    modo: modo,
                    vistaAtual: 'Anterior',
                    regioesMarcadas: [],
                    regioes: [],
                    desenhando: false,
                    pontosTemp: [],
                    corAtual: '#ef4444',
                    config: config,
                    contexto: 'anatomico', // 'anatomico' ou 'queimados'
                    atlasAtual: deepCopyAtlas(ATLAS_ANATOMICO), // Atlas sendo usado (CÃ“PIA PROFUNDA!)
                    grauSelecionado: 2, // Para modo queimados
                    areasQueimadas: {} // { areaId: { grau2: %, grau3: % } }
                };
                
                // Renderizar atlas automaticamente
                if (ATLAS_ANATOMICO.regioes.length > 0) {
                    this.renderizarAtlas(containerId);
                }
                
                // Carregar template se houver
                if (template) {
                    this.carregarTemplate(containerId, template);
                }
                
                // âœ… CARREGAR PESO E IDADE AUTOMATICAMENTE
                setTimeout(() => {
                    this.carregarDadosPaciente(containerId);
                }, 100);
                
                // âœ… APLICAR CONTEXTO INICIAL (anatomico ou queimados)
                if (contextoInicial && contextoInicial !== 'anatomico') {
                    setTimeout(() => {
                        this.trocarContexto(containerId, contextoInicial);
                    }, 150);
                } else {
                    // âœ… VALIDAR DADOS OBRIGATÃ“RIOS (libera silhueta se contexto anatÃ´mico)
                    setTimeout(() => {
                        this.validarDadosObrigatorios(containerId);
                    }, 50);
                }
                
                console.log('âœ… AnatomiaAtendimento renderizado:', containerId);
            },
            
            // ============================================================
            // CARREGAR DADOS DO PACIENTE AUTOMATICAMENTE
            // ============================================================
            
            carregarDadosPaciente(containerId) {
                try {
                    // Buscar dados do paciente no localStorage
                    const atendimentos = JSON.parse(localStorage.getItem('atendimentos') || '[]');
                    
                    // Tentar encontrar o atendimento ativo
                    // O containerId geralmente contÃ©m info do atendimento
                    let atendimentoAtivo = atendimentos.find(a => a.id && containerId.includes(a.id));
                    
                    // Se nÃ£o encontrar, pegar o Ãºltimo atendimento criado
                    if (!atendimentoAtivo && atendimentos.length > 0) {
                        atendimentoAtivo = atendimentos[atendimentos.length - 1];
                    }
                    
                    if (atendimentoAtivo) {
                        const pesoInput = document.getElementById(`peso-paciente-${containerId}`);
                        const idadeInput = document.getElementById(`idade-paciente-${containerId}`);
                        const pesoFonte = document.getElementById(`peso-fonte-${containerId}`);
                        const idadeFonte = document.getElementById(`idade-fonte-${containerId}`);
                        
                        // âœ… CARREGAR PESO (de antropometria ou dados gerais)
                        const peso = atendimentoAtivo.peso || atendimentoAtivo.antropometria?.peso || null;
                        if (peso && pesoInput) {
                            pesoInput.value = peso;
                            pesoInput.style.borderColor = '#10b981';
                            pesoInput.style.background = '#f0fdf4';
                            if (pesoFonte) pesoFonte.textContent = 'âœ“ auto';
                            console.log(`âœ… Peso carregado automaticamente: ${peso}kg`);
                        }
                        
                        // âœ… CARREGAR IDADE (calcular da data de nascimento)
                        const dataNasc = atendimentoAtivo.paciente?.data_nascimento || 
                                       atendimentoAtivo.data_nascimento ||
                                       null;
                        
                        if (dataNasc && idadeInput) {
                            const hoje = new Date();
                            const nascimento = new Date(dataNasc + 'T00:00:00');
                            let idade = hoje.getFullYear() - nascimento.getFullYear();
                            const mes = hoje.getMonth() - nascimento.getMonth();
                            
                            if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
                                idade--;
                            }
                            
                            idadeInput.value = idade;
                            idadeInput.style.borderColor = '#10b981';
                            idadeInput.style.background = '#f0fdf4';
                            if (idadeFonte) idadeFonte.textContent = 'âœ“ auto';
                            console.log(`âœ… Idade calculada automaticamente: ${idade} anos (DN: ${dataNasc})`);
                        }
                        
                        // âœ… ATUALIZAR PROTOCOLOS COM OS DADOS CARREGADOS
                        if (peso || dataNasc) {
                            this.atualizarProtocolos(containerId);
                        }
                    } else {
                        console.log('â„¹ï¸ Nenhum atendimento ativo encontrado - preencha peso e idade manualmente');
                    }
                    
                } catch (error) {
                    console.warn('âš ï¸ Erro ao carregar dados do paciente:', error);
                }
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // VALIDAÃ‡ÃƒO DE DADOS OBRIGATÃ“RIOS - Libera/bloqueia silhueta conforme contexto
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            validarDadosObrigatorios(containerId) {
                const inst = this.instancias[containerId];
                if (!inst) return;
                
                const bloqueioDiv = document.getElementById(`bloqueio-silhueta-${containerId}`);
                const containerLiberado = document.getElementById(`container-silhueta-liberada-${containerId}`);
                const painelDados = document.getElementById(`painel-dados-obrigatorios-${containerId}`);
                const statusDiv = document.getElementById(`status-dados-${containerId}`);
                const modoAtlas = document.getElementById(`modo-atlas-${containerId}`);
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // CONTEXTO ANATÃ”MICO: Sempre liberado, sem bloqueio
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                if (inst.contexto !== 'queimados') {
                    if (painelDados) painelDados.style.display = 'none';
                    if (bloqueioDiv) bloqueioDiv.style.display = 'none';
                    if (containerLiberado) containerLiberado.style.display = 'block';
                    if (modoAtlas) modoAtlas.style.display = 'block';
                    return;
                }
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // CONTEXTO QUEIMADOS: Precisa peso e idade
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                if (painelDados) painelDados.style.display = 'block';
                
                const pesoInput = document.getElementById(`peso-paciente-${containerId}`);
                const idadeInput = document.getElementById(`idade-paciente-${containerId}`);
                
                const peso = parseFloat(pesoInput?.value) || 0;
                const idade = parseInt(idadeInput?.value);
                const idadeValida = !isNaN(idade) && idade >= 0;
                
                const pesoOk = peso > 0;
                const idadeOk = idadeValida;
                
                // Atualizar estilo dos inputs
                if (pesoInput) {
                    pesoInput.style.borderColor = pesoOk ? '#10b981' : '#ff9800';
                    pesoInput.style.background = pesoOk ? '#f0fdf4' : 'white';
                }
                if (idadeInput) {
                    idadeInput.style.borderColor = idadeOk ? '#10b981' : '#ff9800';
                    idadeInput.style.background = idadeOk ? '#f0fdf4' : 'white';
                }
                
                if (pesoOk && idadeOk) {
                    // âœ… LIBERAR SILHUETA
                    if (bloqueioDiv) bloqueioDiv.style.display = 'none';
                    if (containerLiberado) containerLiberado.style.display = 'block';
                    if (modoAtlas) modoAtlas.style.display = 'block';
                    if (statusDiv) {
                        statusDiv.style.background = '#d4edda';
                        statusDiv.style.color = '#155724';
                        statusDiv.innerHTML = `âœ… Dados validados: ${peso}kg, ${idade} anos - Silhueta liberada`;
                    }
                    if (painelDados) {
                        painelDados.style.background = 'linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%)';
                        painelDados.style.borderColor = '#4caf50';
                    }
                    
                    // Atualizar faixa Lund-Browder e protocolos
                    this.atualizarFaixaPorIdade(containerId, idade);
                    this.atualizarProtocolos(containerId);
                    
                    // âœ… GARANTIR QUE O CANVAS ESTÃ CONFIGURADO E O PINCEL ATIVO
                    setTimeout(() => {
                        const canvas = document.getElementById(`canvas-queimados-${containerId}`);
                        if (canvas) {
                            canvas.style.display = 'block';
                            canvas.style.pointerEvents = 'auto';
                        }
                        this.configurarCanvas(containerId);
                        this.selecionarFerramenta(containerId, 'pincel');
                        this.selecionarGrau(containerId, 2);
                    }, 100);
                    
                    console.log(`âœ… Dados obrigatÃ³rios validados: peso=${peso}kg, idade=${idade}anos - Pincel ativado`);
                    
                } else {
                    // âŒ BLOQUEAR SILHUETA
                    if (bloqueioDiv) bloqueioDiv.style.display = 'block';
                    if (containerLiberado) containerLiberado.style.display = 'none';
                    if (modoAtlas) modoAtlas.style.display = 'none';
                    
                    let msgFaltando = [];
                    if (!pesoOk) msgFaltando.push('peso');
                    if (!idadeOk) msgFaltando.push('idade');
                    
                    if (statusDiv) {
                        statusDiv.style.background = '#ffccbc';
                        statusDiv.style.color = '#bf360c';
                        statusDiv.innerHTML = `âš ï¸ Preencha ${msgFaltando.join(' e ')} para liberar a silhueta`;
                    }
                    if (painelDados) {
                        painelDados.style.background = 'linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%)';
                        painelDados.style.borderColor = '#ff9800';
                    }
                }
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // IMPORTAR DADOS DO ATENDIMENTO (BotÃ£o "Importar do Atendimento")
            // v10.448: Corrigido para buscar do SistemaCore.dados e paciente atual
            // v10.448b: Busca primeiro da TELA (DOM) como alergias!
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            importarDadosPaciente(containerId) {
                console.log('ğŸ“¥ [v10.448b] Iniciando importaÃ§Ã£o de dados para:', containerId);
                
                try {
                    const pesoInput = document.getElementById(`peso-paciente-${containerId}`);
                    const idadeInput = document.getElementById(`idade-paciente-${containerId}`);
                    const pesoFonte = document.getElementById(`peso-fonte-${containerId}`);
                    const idadeFonte = document.getElementById(`idade-fonte-${containerId}`);
                    
                    let importados = [];
                    let naoEncontrados = [];
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // BUSCAR PESO - PRIORIDADE: TELA > ENTRADA > PACIENTE
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    let peso = this.lerPesoDaTela();
                    let pesoOrigem = 'tela atual';
                    
                    // Se nÃ£o achou na tela, buscar da entrada/paciente
                    if (!peso) {
                        const dadosPaciente = this.buscarDadosPacienteAtual();
                        peso = dadosPaciente.peso;
                        pesoOrigem = dadosPaciente.pesoOrigem;
                    }
                    
                    console.log('âš–ï¸ Peso encontrado:', peso, '| Origem:', pesoOrigem);
                    
                    if (peso && pesoInput) {
                        pesoInput.value = peso;
                        pesoInput.style.borderColor = '#10b981';
                        pesoInput.style.background = '#f0fdf4';
                        if (pesoFonte) pesoFonte.textContent = `âœ“ ${pesoOrigem}`;
                        importados.push(`Peso: ${peso}kg (${pesoOrigem})`);
                    } else {
                        naoEncontrados.push('Peso');
                    }
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // BUSCAR IDADE - Direto do cadastro (data de nascimento)
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    const dadosPaciente = this.buscarDadosPacienteAtual();
                    let idade = dadosPaciente.idade;
                    let idadeOrigem = dadosPaciente.idadeOrigem;
                    
                    console.log('ğŸ‚ Idade encontrada:', idade, '| Origem:', idadeOrigem);
                    
                    // v10.463: CORREÃ‡ÃƒO - idade 0 (bebÃªs) era tratada como falsy!
                    // if (0 && idadeInput) retornava false
                    if (idade !== null && idade !== undefined && idadeInput) {
                        idadeInput.value = idade;
                        idadeInput.style.borderColor = '#10b981';
                        idadeInput.style.background = '#f0fdf4';
                        if (idadeFonte) idadeFonte.textContent = `âœ“ ${idadeOrigem}`;
                        importados.push(`Idade: ${idade} anos (${idadeOrigem})`);
                        
                        // Atualizar faixa etÃ¡ria automaticamente
                        this.atualizarFaixaPorIdade(containerId, idade);
                    } else {
                        naoEncontrados.push('Idade');
                    }
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // FEEDBACK PARA O USUÃRIO
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    if (importados.length > 0) {
                        Sistema.notificar(`âœ… Importado: ${importados.join(', ')}`, 'success');
                        this.validarDadosObrigatorios(containerId);
                    } else {
                        alert(`âš ï¸ Nenhum dado encontrado.\n\nVerifique se:\nâ€¢ O peso foi preenchido em "Dados AntropomÃ©tricos"\nâ€¢ O paciente tem data de nascimento cadastrada`);
                    }
                    
                } catch (error) {
                    console.error('âŒ Erro ao importar dados:', error);
                    alert('Erro ao importar dados: ' + error.message);
                }
            },
            
            // v10.448b: Ler peso de campos na tela atual (tempo real!)
            lerPesoDaTela() {
                try {
                    // Procurar campos de peso no prontuÃ¡rio/mÃ³dulos
                    const seletores = [
                        'input[id*="peso"]',
                        'input[name*="peso"]',
                        'input[placeholder*="Peso"]',
                        '#antropometria-peso',
                        '#dados-peso',
                        '#campo-peso',
                        '[data-campo="peso"] input'
                    ];
                    
                    for (const seletor of seletores) {
                        const inputs = document.querySelectorAll(seletor);
                        for (const input of inputs) {
                            // Ignorar o prÃ³prio campo de destino
                            if (input.id && input.id.includes('peso-paciente-')) continue;
                            
                            const valor = parseFloat(input.value);
                            if (valor > 0 && valor < 500) { // Peso vÃ¡lido entre 0 e 500kg
                                console.log('âœ… [v10.448b] Peso lido da TELA:', valor, '| Campo:', input.id || input.name);
                                return valor;
                            }
                        }
                    }
                    
                    // Tentar no container de mÃ³dulos do prontuÃ¡rio
                    const containerModulos = document.getElementById('atend-modulos-conteudo-novo');
                    if (containerModulos) {
                        const inputs = containerModulos.querySelectorAll('input[type="number"], input[type="text"]');
                        for (const input of inputs) {
                            const label = input.previousElementSibling?.textContent?.toLowerCase() || '';
                            const placeholder = (input.placeholder || '').toLowerCase();
                            
                            if (label.includes('peso') || placeholder.includes('peso')) {
                                const valor = parseFloat(input.value);
                                if (valor > 0 && valor < 500) {
                                    console.log('âœ… [v10.448b] Peso lido do MÃ“DULO:', valor);
                                    return valor;
                                }
                            }
                        }
                    }
                    
                    return null;
                } catch (e) {
                    console.warn('[v10.448b] Erro ao ler peso da tela:', e);
                    return null;
                }
            },
            
            // v10.448b: Ler idade de campos na tela atual
            lerIdadeDaTela() {
                try {
                    const seletores = [
                        'input[id*="idade"]',
                        'input[name*="idade"]',
                        '#antropometria-idade',
                        '#dados-idade',
                        '#campo-idade',
                        '[data-campo="idade"] input'
                    ];
                    
                    for (const seletor of seletores) {
                        const inputs = document.querySelectorAll(seletor);
                        for (const input of inputs) {
                            // Ignorar o prÃ³prio campo de destino
                            if (input.id && input.id.includes('idade-paciente-')) continue;
                            
                            const valor = parseInt(input.value);
                            if (valor >= 0 && valor < 150) { // Idade vÃ¡lida
                                console.log('âœ… [v10.448b] Idade lida da TELA:', valor, '| Campo:', input.id || input.name);
                                return valor;
                            }
                        }
                    }
                    
                    return null;
                } catch (e) {
                    console.warn('[v10.448b] Erro ao ler idade da tela:', e);
                    return null;
                }
            },
            
            // v10.448b: Buscar dados do paciente atual (Cabecalhos > entrada > cadastro)
            buscarDadosPacienteAtual() {
                let peso = null, idade = null;
                let pesoOrigem = '', idadeOrigem = '';
                
                try {
                    let paciente = null;
                    let entrada = null;
                    
                    // PRIORIDADE 1: Cabecalhos.pacienteSelecionado (dados jÃ¡ prontos!)
                    if (typeof Cabecalhos !== 'undefined' && Cabecalhos.pacienteSelecionado) {
                        paciente = Cabecalhos.pacienteSelecionado;
                        console.log('âœ… [v10.448b] Paciente do Cabecalhos.pacienteSelecionado:', paciente.nome);
                    }
                    
                    // PRIORIDADE 2: Buscar entrada atual
                    if (!paciente) {
                        const entradaIdEl = document.getElementById('atend-entrada-id');
                        const entradaId = entradaIdEl ? parseInt(entradaIdEl.value) : null;
                        
                        if (entradaId) {
                            entrada = (SistemaCore.dados.entradas || []).find(e => e.id === entradaId);
                            if (entrada && entrada.paciente_id) {
                                paciente = SistemaCore.dados.pacientes.find(p => p.id === entrada.paciente_id);
                            }
                        }
                    }
                    
                    // PRIORIDADE 3: Atendimento em andamento
                    if (!paciente && typeof Atendimentos !== 'undefined' && Atendimentos.atendimentoAtualId) {
                        const atendimento = (SistemaCore.dados.atendimentos || []).find(a => a.id === Atendimentos.atendimentoAtualId);
                        if (atendimento) {
                            entrada = (SistemaCore.dados.entradas || []).find(e => e.id === atendimento.entrada_id);
                            if (atendimento.paciente_id) {
                                paciente = SistemaCore.dados.pacientes.find(p => p.id === atendimento.paciente_id);
                            }
                        }
                    }
                    
                    if (!paciente) {
                        console.warn('[v10.448b] Nenhum paciente encontrado');
                        return { peso, idade, pesoOrigem, idadeOrigem };
                    }
                    
                    // Buscar peso: tela > triagem > cadastro
                    const pesoTela = this.lerPesoDaTela();
                    if (pesoTela) {
                        peso = pesoTela;
                        pesoOrigem = 'tela';
                    } else if (entrada?.triagem?.peso) {
                        peso = entrada.triagem.peso;
                        pesoOrigem = 'triagem';
                    } else if (paciente?.peso) {
                        peso = paciente.peso;
                        pesoOrigem = 'cadastro';
                    }
                    
                    // Buscar idade: calcular da data de nascimento
                    // Campo pode ser 'nascimento' ou 'data_nascimento'
                    const dataNasc = paciente?.nascimento || paciente?.data_nascimento;
                    if (dataNasc) {
                        const hoje = new Date();
                        const nascimento = new Date(dataNasc + 'T00:00:00');
                        idade = hoje.getFullYear() - nascimento.getFullYear();
                        const mes = hoje.getMonth() - nascimento.getMonth();
                        if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
                            idade--;
                        }
                        idadeOrigem = 'cadastro';
                        console.log('ğŸ‚ [v10.448b] Idade calculada:', idade, 'anos | Data nasc:', dataNasc);
                    } else {
                        console.warn('âš ï¸ [v10.448b] Paciente sem data de nascimento:', paciente?.nome, '| Campos:', Object.keys(paciente || {}));
                    }
                    
                } catch (e) {
                    console.warn('[v10.448b] Erro ao buscar dados do paciente:', e);
                }
                
                return { peso, idade, pesoOrigem, idadeOrigem };
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // ATUALIZAR FAIXA ETÃRIA (LUND-BROWDER) BASEADA NA IDADE
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            atualizarFaixaPorIdade(containerId, idade) {
                const select = document.getElementById(`faixa-etaria-${containerId}`);
                if (!select) return;
                
                let faixa = '15+';
                if (idade <= 1) faixa = '0-1';
                else if (idade <= 4) faixa = '1-4';
                else if (idade <= 9) faixa = '5-9';
                else if (idade <= 14) faixa = '10-14';
                
                select.value = faixa;
                console.log(`ğŸ‘¶ Faixa etÃ¡ria ajustada para: ${faixa} (idade: ${idade})`);
            },
            
            // ============================================================
            // FUNÃ‡Ã•ES DO MODO ATLAS
            // ============================================================
            
            
            renderizarAtlas(containerId) {
                const inst = this.instancias[containerId];
                
                // Renderizar AMBAS as vistas
                this.renderizarVista(containerId, 'Anterior');
                this.renderizarVista(containerId, 'Posterior');
                
                this.atualizarListaAtlas(containerId);
            },
            
            renderizarVista(containerId, vista) {
                const inst = this.instancias[containerId];
                const sufixo = vista.toLowerCase();
                
                // âœ… USAR GRUPO CORRETO BASEADO NO CONTEXTO
                const contextoSufixo = inst.contexto === 'queimados' ? 'queimaduras' : 'anatomico';
                const gRegioes = document.getElementById(`regioes-${sufixo}-${contextoSufixo}-${containerId}`);
                const gImagem = document.getElementById(`imagem-base-${containerId}`);
                
                if (!gRegioes) {
                    console.warn(`Grupo de regiÃµes nÃ£o encontrado: regioes-${sufixo}-${contextoSufixo}-${containerId}`);
                    return;
                }
                
                gRegioes.innerHTML = '';
                
                // âœ… ADICIONAR IMAGEM APENAS UMA VEZ (quando renderizar vista Anterior)
                if (vista === 'Anterior' && gImagem) {
                    gImagem.innerHTML = '';
                    
                    // Usar atlas conforme contexto
                    const atlas = inst.atlasAtual || ATLAS_ANATOMICO;
                    
                    // Garantir imagem base (fallback para ATLAS_ANATOMICO)
                    const imagemBase = atlas.imagemBase64 || ATLAS_ANATOMICO.imagemBase64;
                    
                    if (imagemBase) {
                        const img = document.createElementNS('http://www.w3.org/2000/svg', 'image');
                        img.setAttribute('href', imagemBase);
                        img.setAttribute('x', '0');
                        img.setAttribute('y', '0');
                        img.setAttribute('width', '700');
                        img.setAttribute('height', '1200');
                        img.setAttribute('preserveAspectRatio', 'xMidYMid meet');
                        gImagem.appendChild(img);
                    }
                }
                
                // Usar atlas conforme contexto
                const atlas = inst.atlasAtual || ATLAS_ANATOMICO;
                
                // Pegar regiÃµes desta vista
                const regioes = atlas.obterRegioesPorVista ? atlas.obterRegioesPorVista(vista) : 
                                (atlas.regioes || []).filter(r => r.vista === vista);
                
                regioes.forEach((regiao, idx) => {
                    let elemento;
                    
                    // SUPORTE A PATH E POINTS
                    if (regiao.path) {
                        // Usar elemento PATH (para ATLAS_QUEIMADOS)
                        elemento = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                        elemento.setAttribute('d', regiao.path);
                    } else if (regiao.points) {
                        // Usar elemento POLYGON (para ATLAS_ANATOMICO)
                        elemento = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                        elemento.setAttribute('points', regiao.points);
                    } else {
                        console.warn('RegiÃ£o sem path ou points:', regiao.nome);
                        return;
                    }
                    elemento.setAttribute('data-regiao-nome', regiao.nome);
                    elemento.setAttribute('data-regiao-id', regiao.id || regiao.nome);
                    elemento.setAttribute('data-vista', vista);
                    
                    // Verificar se estÃ¡ marcada (modo anatÃ´mico) ou queimada (modo queimados)
                    let estaMarcada = false;
                    let opacidade = 0.1;
                    let cor = regiao.cor || '#999';
                    
                    if (inst.contexto === 'queimados') {
                        // Modo queimados: verificar se tem queimadura
                        const areaQueimada = inst.areasQueimadas[regiao.id || regiao.nome];
                        if (areaQueimada && (areaQueimada.grau2 > 0 || areaQueimada.grau3 > 0)) {
                            estaMarcada = true;
                            // Cor baseada no grau predominante
                            if (areaQueimada.grau3 > areaQueimada.grau2) {
                                cor = '#c62828'; // 3Âº grau - vermelho
                                opacidade = 0.15;
                            } else {
                                cor = '#ff9800'; // 2Âº grau - laranja
                                opacidade = 0.12;
                            }
                        }
                    } else {
                        // Modo anatÃ´mico: verificar se estÃ¡ marcada
                        estaMarcada = inst.regioesMarcadas.some(r => 
                            r.nome === regiao.nome && r.vista === vista
                        );
                        if (estaMarcada) {
                            opacidade = 0.6;
                            cor = regiao.cor || '#ef4444';
                        }
                    }
                    
                    // âœ… VISUAL DIFERENTE POR CONTEXTO
                    if (inst.contexto === 'queimados') {
                        // MODO QUEIMADURAS: Sempre transparente (sÃ³ contorno)
                        elemento.setAttribute('fill', 'none');
                        
                        if (estaMarcada) {
                            // Ãrea queimada: SEM contorno (transparente)
                            elemento.setAttribute('stroke', cor);
                            elemento.setAttribute('stroke-width', '0');
                            elemento.setAttribute('stroke-opacity', '0');
                        } else {
                            // Ãrea nÃ£o queimada: stroke fino e semi-transparente (para guiar pintura)
                            elemento.setAttribute('stroke', regiao.cor || '#999');
                            elemento.setAttribute('stroke-width', '1');
                            elemento.setAttribute('stroke-opacity', '0.4');
                        }
                    } else {
                        // MODO ANATÃ”MICO: PolÃ­gonos com preenchimento colorido
                        elemento.setAttribute('fill', cor);
                        elemento.setAttribute('fill-opacity', opacidade.toString());
                        elemento.setAttribute('stroke', regiao.cor || '#666');
                        elemento.setAttribute('stroke-width', '2');
                        elemento.setAttribute('stroke-opacity', estaMarcada ? '0.8' : '0');
                    }
                    
                    elemento.setAttribute('cursor', 'pointer');
                    
                    // âœ… HOVER DIFERENTE POR CONTEXTO
                    if (inst.contexto === 'queimados') {
                        // Modo queimaduras: aumentar opacidade do stroke
                        elemento.addEventListener('mouseenter', () => {
                            if (!estaMarcada) elemento.setAttribute('stroke-opacity', '0.8');
                        });
                        
                        elemento.addEventListener('mouseleave', () => {
                            if (!estaMarcada) elemento.setAttribute('stroke-opacity', '0.4');
                        });
                    } else {
                        // Modo anatÃ´mico: aumentar opacidade do fill
                        elemento.addEventListener('mouseenter', () => {
                            if (!estaMarcada) elemento.setAttribute('fill-opacity', '0.5');
                        });
                        
                        elemento.addEventListener('mouseleave', () => {
                            if (!estaMarcada) elemento.setAttribute('fill-opacity', opacidade.toString());
                        });
                    }
                    
                    elemento.addEventListener('click', (e) => {
                        e.stopPropagation();
                        if (inst.contexto === 'queimados') {
                            this.abrirDialogoQueimadura(containerId, regiao, e);
                        } else {
                            this.abrirPopupCascata(containerId, regiao, e);
                        }
                    });
                    
                    gRegioes.appendChild(elemento);
                });
            },
            
            abrirPopupCascata(containerId, regiao, evento) {
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                console.log('ğŸ–±ï¸ Clique em regiÃ£o:', regiao.nome);
                
                // MAPEAMENTO: PolÃ­gonos com nomes diferentes das hierarquias
                const MAPA_POLIGONOS = {
                    "BraÃ§o D": "Face anterior do braÃ§o",
                    "BraÃ§o E": "Face anterior do braÃ§o",
                    "AntebraÃ§o D": "AntebraÃ§o anterior",
                    "AntebraÃ§o E": "AntebraÃ§o anterior",
                    "MÃ£o D": "MÃ£o anterior",
                    "MÃ£o E": "MÃ£o anterior",
                    "Coxa D": "Coxa anterior",
                    "Coxa E": "Coxa anterior",
                    "Perna D": "Perna anterior",
                    "Perna E": "Perna anterior",
                    "PÃ© D": "PÃ© anterior",
                    "PÃ© E": "PÃ© anterior"
                };
                
                // â­ MAPEAMENTO BASEADO EM VISTA (v10.184 - nomenclatura intuitiva)
                // Alguns polÃ­gonos tÃªm o MESMO NOME em vistas diferentes
                // mas hierarquias com NOMES DIFERENTES
                const MAPA_POR_VISTA = {
                    "Posterior": {
                        "Couro cabeludo": "Couro cabeludo (costas)",  // EspecÃ­fico para couro cabeludo
                        "Face": "Face posterior",
                        "PescoÃ§o": "PescoÃ§o (costas)",
                        "CabeÃ§a e pescoÃ§o": "CabeÃ§a e pescoÃ§o (costas)",
                        "CabeÃ§a": "CabeÃ§a (costas)",
                        "TÃ³rax": "TÃ³rax posterior",
                        "Dorso": "Dorso",
                        "Membros superiores": "Membro superior posterior",
                        "Membros inferiores": "Membro inferior posterior"
                    },
                    "Anterior": {
                        "CabeÃ§a e pescoÃ§o": "CabeÃ§a e pescoÃ§o (frente)",
                        "CabeÃ§a": "CabeÃ§a",
                        "PescoÃ§o": "PescoÃ§o (anterior)",
                        "TÃ³rax": "TÃ³rax anterior"
                    }
                };
                
                // Traduzir nome do polÃ­gono se necessÃ¡rio
                let nomeHierarquia = MAPA_POLIGONOS[regiao.nome] || regiao.nome;
                
                // Aplicar mapeamento por vista (PRIORIDADE)
                if (MAPA_POR_VISTA[regiao.vista] && MAPA_POR_VISTA[regiao.vista][regiao.nome]) {
                    nomeHierarquia = MAPA_POR_VISTA[regiao.vista][regiao.nome];
                    console.log(`ğŸ¯ MAPEAMENTO POR VISTA: ${regiao.nome} (${regiao.vista}) â†’ ${nomeHierarquia}`);
                }
                
                console.log('ğŸ”„ Nome final mapeado:', regiao.nome, 'â†’', nomeHierarquia, '| Vista:', regiao.vista);
                
                // âš ï¸ VERIFICAÃ‡ÃƒO CRÃTICA: HIERARQUIAS_POLIGONOS estÃ¡ acessÃ­vel?
                console.log('ğŸ” typeof HIERARQUIAS_POLIGONOS:', typeof HIERARQUIAS_POLIGONOS);
                console.log('ğŸ” typeof window.HIERARQUIAS_POLIGONOS:', typeof window.HIERARQUIAS_POLIGONOS);
                
                if (typeof HIERARQUIAS_POLIGONOS === 'undefined') {
                    console.error('âŒâŒâŒ HIERARQUIAS_POLIGONOS NÃƒO ESTÃ ACESSÃVEL! âŒâŒâŒ');
                    console.error('PROBLEMA IDENTIFICADO: Objeto nÃ£o estÃ¡ no escopo!');
                    return;
                } else {
                    console.log('âœ… HIERARQUIAS_POLIGONOS acessÃ­vel');
                    const totalHierarquias = Object.keys(HIERARQUIAS_POLIGONOS).length;
                    console.log(`âœ… Total de hierarquias definidas: ${totalHierarquias}`);
                }
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                
                // ğŸ› DEBUG: Listar todas as chaves que comeÃ§am com "CabeÃ§a"
                console.log('ğŸ› DEBUG: Listando chaves que contÃªm "CabeÃ§a" ou "cabeÃ§a":');
                const chavesRelevantes = Object.keys(HIERARQUIAS_POLIGONOS).filter(k => 
                    k.toLowerCase().includes('cabeÃ§a') || k.toLowerCase().includes('cabeca')
                );
                chavesRelevantes.forEach((k, i) => {
                    console.log(`   ${i + 1}. "${k}"`);
                });
                console.log(`ğŸ› Total de chaves relacionadas: ${chavesRelevantes.length}`);
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                
                // â­ BUSCA INTELIGENTE: Nome + Vista (correÃ§Ã£o v10.184)
                // ANTES: Buscava apenas por nome, pegava sempre a primeira (geralmente anterior)
                // AGORA: Busca por nome E vista, respeitando a anatomia correta
                const vistaAtual = regiao.vista || 'Anterior';
                console.log('ğŸ” Buscando hierarquia para:', {
                    nomePoligono: nomeHierarquia,
                    vista: vistaAtual
                });
                
                let hierarquia = null;
                
                // Primeira tentativa: busca exata por chave (nome completo com vista)
                // Ex: "Couro cabeludo Posterior", "CabeÃ§a e pescoÃ§o (frente)"
                const chavesExatas = [
                    nomeHierarquia, // Nome exato
                    `${nomeHierarquia} ${vistaAtual}`, // Nome + Vista
                    `${nomeHierarquia} ${vistaAtual.toLowerCase()}`, // Nome + vista minÃºscula
                ];
                
                console.log('ğŸ” DEBUG: Testando chaves exatas...');
                console.log('   Nome apÃ³s mapeamento:', nomeHierarquia);
                console.log('   Vista atual:', vistaAtual);
                console.log('   Chaves que serÃ£o testadas:', chavesExatas);
                console.log('   ğŸ”‘ Chaves disponÃ­veis em HIERARQUIAS_POLIGONOS:');
                Object.keys(HIERARQUIAS_POLIGONOS).slice(0, 20).forEach(k => console.log(`      - "${k}"`));
                
                for (const chave of chavesExatas) {
                    console.log(`   Testando chave: "${chave}"`);
                    console.log(`   HIERARQUIAS_POLIGONOS["${chave}"] existe?`, HIERARQUIAS_POLIGONOS[chave] ? 'SIM âœ…' : 'NÃƒO âŒ');
                    if (HIERARQUIAS_POLIGONOS[chave]) {
                        hierarquia = HIERARQUIAS_POLIGONOS[chave];
                        console.log(`âœ…âœ…âœ… Hierarquia ENCONTRADA por chave exata: "${chave}"`);
                        break;
                    }
                }
                
                // Segunda tentativa: buscar iterando e comparando polÃ­gono + vista
                if (!hierarquia) {
                    console.log('ğŸ”„ Busca por chave falhou, iterando sobre hierarquias...');
                    for (const [chave, h] of Object.entries(HIERARQUIAS_POLIGONOS)) {
                        // Comparar: mesmo polÃ­gono E mesma vista
                        const mesmoPoligono = h.poligono === nomeHierarquia;
                        const mesmaVista = h.vista === vistaAtual || h.vista === 'Ambas' || !h.vista;
                        
                        if (mesmoPoligono && mesmaVista) {
                            hierarquia = h;
                            console.log(`âœ… Hierarquia encontrada por iteraÃ§Ã£o: "${chave}"`, {
                                poligono: h.poligono,
                                vista: h.vista
                            });
                            break;
                        }
                    }
                }
                
                // Terceira tentativa: se ainda nÃ£o encontrou E a vista Ã© Posterior, buscar versÃ£o anterior com nome ligeiramente diferente
                if (!hierarquia && vistaAtual === 'Posterior') {
                    console.log('ğŸ”„ Tentando variaÃ§Ãµes para vista posterior...');
                    const nomeAnterior = nomeHierarquia.replace(/posterior/i, 'anterior').replace(/Posterior/i, 'Anterior');
                    
                    for (const [chave, h] of Object.entries(HIERARQUIAS_POLIGONOS)) {
                        if (h.poligono.toLowerCase().includes(nomeHierarquia.toLowerCase()) && h.vista === vistaAtual) {
                            hierarquia = h;
                            console.log(`âœ… Hierarquia encontrada por aproximaÃ§Ã£o: "${chave}"`);
                            break;
                        }
                    }
                }
                
                console.log('ğŸ” HIERARQUIA ENCONTRADA:', hierarquia ? 'SIM âœ…' : 'NÃƒO âŒ', '| Nome:', nomeHierarquia, '| Vista:', vistaAtual);
                
                if (hierarquia) {
                    console.log('ğŸ“Š Caminho:', hierarquia.caminho);
                    console.log('ğŸ“Š Total de opÃ§Ãµes:', hierarquia.opcoes ? hierarquia.opcoes.length : 0);
                    const opcoesNavegacao = hierarquia.opcoes ? hierarquia.opcoes.filter(o => o.navegacao === true || (o.nome && (o.nome.includes('â†‘') || o.nome.includes('â†“')))) : [];
                    console.log('ğŸ¯ OpÃ§Ãµes de NAVEGAÃ‡ÃƒO encontradas:', opcoesNavegacao.length);
                    opcoesNavegacao.forEach((opt, idx) => {
                        console.log(`  ${idx + 1}. ${opt.nome} (navegacao: ${opt.navegacao})`);
                    });
                } else {
                    console.log('âš ï¸ Hierarquia NÃƒO encontrada - serÃ¡ criada genericamente');
                }
                
                // Se nÃ£o houver hierarquia, criar uma genÃ©rica automaticamente
                if (!hierarquia) {
                    console.log('âš™ï¸ Criando hierarquia genÃ©rica para:', regiao.nome);
                    
                    // Detectar se regiÃ£o Ã© bilateral (membros, flancos, axilas, etc)
                    const nomeNormalizado = regiao.nome.toLowerCase();
                    const grupoNormalizado = (regiao.grupo || '').toLowerCase();
                    const palavrasBilaterais = [
                        'membro', 'braÃ§o', 'braco', 'perna', 'coxa', 'pÃ©', 'pe', 'mÃ£o', 'mao',
                        'ombro', 'cotovelo', 'punho', 'joelho', 'tornozelo', 'quadril',
                        'flanco', 'axila', 'axilar', 'mama', 'mamÃ¡ria', 'mamaria',
                        'clavÃ­cula', 'clavicula', 'escapula', 'escÃ¡pula',
                        'orelha', 'olho', 'pÃ¡lpebra', 'palpebra', 'bochecha', 'maxilar',
                        'superior', 'inferior', 'lateral'
                    ];
                    
                    const ehBilateral = palavrasBilaterais.some(palavra => 
                        nomeNormalizado.includes(palavra) || grupoNormalizado.includes(palavra)
                    );
                    
                    hierarquia = {
                        poligono: regiao.nome,
                        caminho: [regiao.grupo || "Corpo", regiao.nome],
                        vista: regiao.vista || "Ambas",
                        lado: null,
                        opcoes: [
                            { 
                                id: regiao.nome.toLowerCase().replace(/\s+/g, '-').normalize('NFD').replace(/[\u0300-\u036f]/g, ''),
                                nome: regiao.nome, 
                                vista: regiao.vista || "Ambas", 
                                template: "avaliacao-generica",
                                lateralidade: ehBilateral, // NOVO: detectar automaticamente
                                filhos: [] 
                            }
                        ]
                    };
                }
                
                // â­ SALVAR VISTA na instÃ¢ncia (correÃ§Ã£o v10.184)
                // Isso permite que a navegaÃ§Ã£o hierÃ¡rquica respeite a vista atual
                const inst = this.instancias[containerId];
                inst.vistaAtual = vistaAtual;
                console.log('ğŸ’¾ Vista salva na instÃ¢ncia:', inst.vistaAtual);
                
                // â­â­â­ NOVO v10.193: FILTRAR NAVEGAÃ‡ÃƒO POR GRUPO E VISTA
                // Limitar navegaÃ§Ã£o para nÃ£o sair do grupo nem da vista
                console.log('ğŸ”’ Aplicando filtros de navegaÃ§Ã£o...');
                console.log('   â€¢ Grupo atual:', regiao.grupo);
                console.log('   â€¢ Vista atual:', vistaAtual);
                
                if (hierarquia && hierarquia.opcoes) {
                    const totalAntes = hierarquia.opcoes.length;
                    
                    hierarquia.opcoes = hierarquia.opcoes.filter(opcao => {
                        // Se for navegaÃ§Ã£o (botÃ£o â†‘ ou â†“), aplicar filtros
                        const ehNavegacao = opcao.navegacao === true || 
                                          (opcao.nome && (opcao.nome.includes('â†‘') || opcao.nome.includes('â†“')));
                        
                        if (ehNavegacao) {
                            // Extrair nome do polÃ­gono alvo
                            const nomeAlvo = opcao.poligonoAlvo || opcao.nome.replace(/^[â†‘â†“]\s*/, '').trim();
                            
                            // Buscar regiÃ£o alvo no ATLAS_ANATOMICO
                            const regiaoAlvo = ATLAS_ANATOMICO.regioes ? 
                                ATLAS_ANATOMICO.regioes.find(r => r.nome === nomeAlvo) : null;
                            
                            if (regiaoAlvo) {
                                // Verificar GRUPO e VISTA
                                const mesmoGrupo = regiaoAlvo.grupo === regiao.grupo;
                                const mesmaVista = regiaoAlvo.vista === vistaAtual;
                                
                                console.log(`   ğŸ“ ${nomeAlvo}:`, {
                                    grupo: regiaoAlvo.grupo,
                                    vista: regiaoAlvo.vista,
                                    mesmoGrupo,
                                    mesmaVista,
                                    PERMITIDO: mesmoGrupo && mesmaVista
                                });
                                
                                return mesmoGrupo && mesmaVista;
                            }
                            
                            // Se nÃ£o encontrou no atlas, remover por seguranÃ§a
                            console.log(`   âš ï¸ ${nomeAlvo}: NÃƒO encontrado no atlas (removido)`);
                            return false;
                        }
                        
                        // OpÃ§Ãµes nÃ£o-navegaÃ§Ã£o (checkboxes normais) sempre permitidas
                        return true;
                    });
                    
                    const totalDepois = hierarquia.opcoes.length;
                    console.log(`âœ… Filtro aplicado: ${totalAntes} opÃ§Ãµes â†’ ${totalDepois} opÃ§Ãµes (${totalAntes - totalDepois} removidas)`);
                }
                
                // Remover popup anterior
                const popupAntigo = document.getElementById('popup-hierarquia-anatomia');
                if (popupAntigo) popupAntigo.remove();
                
                // Criar popup expansÃ­vel
                const popup = document.createElement('div');
                popup.id = 'popup-hierarquia-anatomia';
                popup.style.cssText = `
                    position: fixed;
                    background: white;
                    border: 1px solid #e0e0e0;
                    border-radius: 8px;
                    padding: 16px;
                    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
                    z-index: 10000;
                    min-width: 350px;
                    max-width: 450px;
                    max-height: 70vh;
                    overflow-y: auto;
                `;
                
                // Posicionar prÃ³ximo ao clique (ou centralizado se vier da navegaÃ§Ã£o)
                const ehNavegacao = evento.clientX === window.innerWidth/2 && evento.clientY === window.innerHeight/2;
                
                if (ehNavegacao) {
                    // Centralizar na tela
                    popup.style.left = '50%';
                    popup.style.top = '50%';
                    popup.style.transform = 'translate(-50%, -50%)';
                } else {
                    // Calcular posiÃ§Ã£o garantindo que caiba na tela
                    const maxHeight = Math.floor(window.innerHeight * 0.7); // 70vh em pixels
                    const margem = 20; // Margem de seguranÃ§a
                    
                    let posX = evento.clientX + 10;
                    let posY = evento.clientY + 10;
                    
                    // Ajustar X (horizontal)
                    if (posX + 470 > window.innerWidth) {
                        posX = window.innerWidth - 470 - margem;
                    }
                    
                    // Ajustar Y (vertical) - garantir que nÃ£o ultrapasse
                    if (posY + maxHeight > window.innerHeight) {
                        posY = window.innerHeight - maxHeight - margem;
                    }
                    
                    // Garantir posiÃ§Ã£o mÃ­nima
                    posX = Math.max(margem, posX);
                    posY = Math.max(margem, posY);
                    
                    popup.style.left = posX + 'px';
                    popup.style.top = posY + 'px';
                }
                
                // Construir caminho hierÃ¡rquico
                const caminho = hierarquia.caminho || [regiao.nome];
                const caminhoTexto = caminho.map(n => this.limparNomeExibicao(n)).join(' > ');
                
                // Determinar tÃ­tulo: usar penÃºltimo item do caminho (regiÃ£o pai) se existir, senÃ£o usar nome direto
                const tituloPopup = caminho.length >= 2 ? this.limparNomeExibicao(caminho[caminho.length - 2]) : this.limparNomeExibicao(regiao.nome);
                
                // Header
                popup.innerHTML = `
                    <div style="margin-bottom: 12px; padding-bottom: 10px; border-bottom: 2px solid var(--primary);">
                        <div style="font-size: 10px; color: #666; margin-bottom: 4px;">
                            ğŸ“ ${caminhoTexto}
                        </div>
                        <strong style="font-size: 15px; color: var(--primary);">${tituloPopup.toUpperCase()}</strong>
                        <div style="font-size: 11px; color: #666; margin-top: 4px;">Escolha o nÃ­vel de detalhe:</div>
                    </div>
                    
                    <div id="arvore-hierarquia-container" style="margin-bottom: 12px; max-height: 50vh; overflow-y: auto;">
                        <!-- Ãrvore serÃ¡ renderizada aqui -->
                    </div>
                    
                    <div style="display: flex; gap: 8px; padding-top: 12px; border-top: 1px solid #e0e0e0;">
                        <button id="btn-confirmar-hierarquia" class="btn btn-success" style="flex: 1; font-size: 12px;" disabled
                                onclick="AnatomiaAtendimento.confirmarSelecoesMultiplas('${containerId}')">
                            âœ“ Confirmar
                        </button>
                        <button onclick="document.getElementById('popup-hierarquia-anatomia').remove()" 
                                class="btn btn-secondary" style="font-size: 12px;">
                            âœ• Cancelar
                        </button>
                    </div>
                `;
                
                document.body.appendChild(popup);
                
                // Renderizar Ã¡rvore hierÃ¡rquica
                console.log('ğŸ” DEBUG - Hierarquia recebida:', JSON.stringify(hierarquia, null, 2));
                console.log('ğŸ” DEBUG - Total de opÃ§Ãµes:', hierarquia.opcoes.length);
                hierarquia.opcoes.forEach((opt, idx) => {
                    console.log(`  ${idx + 1}. ${opt.nome} - Filhos: ${opt.filhos ? opt.filhos.length : 0}`);
                });
                this.renderizarArvoreHierarquia(containerId, hierarquia, 'arvore-hierarquia-container');
                
                // Fechar ao clicar fora
                setTimeout(() => {
                    document.addEventListener('click', function fecharPopup(e) {
                        if (!popup.contains(e.target)) {
                            popup.remove();
                            document.removeEventListener('click', fecharPopup);
                        }
                    });
                }, 100);
            },
            
            renderizarArvoreHierarquia(containerId, hierarquia, elementId) {
                console.log('ğŸŒ³ renderizarArvoreHierarquia INICIADO');
                console.log('   Container ID:', containerId);
                console.log('   Element ID:', elementId);
                console.log('   Hierarquia:', hierarquia ? 'PRESENTE' : 'AUSENTE');
                
                const container = document.getElementById(elementId);
                console.log('   Container DOM:', container ? 'ENCONTRADO âœ…' : 'NÃƒO ENCONTRADO âŒ');
                
                if (!container) {
                    console.error('âŒ Container nÃ£o encontrado:', elementId);
                    return;
                }
                
                const inst = this.instancias[containerId];
                console.log('   InstÃ¢ncia:', inst ? 'ENCONTRADA âœ…' : 'NÃƒO ENCONTRADA âŒ');
                
                // Criar HTML da Ã¡rvore - passar caminho inicial vazio
                console.log('ğŸ”„ Iniciando forEach - Total opÃ§Ãµes:', hierarquia.opcoes.length);
                let html = '';
                hierarquia.opcoes.forEach((opcao, index) => {
                    console.log(`   Processando opÃ§Ã£o ${index + 1}/${hierarquia.opcoes.length}: ${opcao.nome}`);
                    // âœ… PASSAR CAMINHO INICIAL (caminho da hierarquia ou vazio)
                    const caminhoInicial = hierarquia.caminho || [];
                    html += this.renderizarOpcaoHierarquia(opcao, 0, `opt-${index}`, containerId, inst, caminhoInicial);
                });
                
                console.log('âœ… forEach CONCLUÃDO - HTML gerado:', html.length, 'caracteres');
                
                container.innerHTML = html;
                
                // âš ï¸ VERIFICAÃ‡ÃƒO CRÃTICA: BotÃµes foram criados no DOM?
                setTimeout(() => {
                    const botoesNavegacao = container.querySelectorAll('button[onclick*="navegarParaPoligono"]');
                    console.log('ğŸ” BotÃµes de navegaÃ§Ã£o no DOM:', botoesNavegacao.length);
                    if (botoesNavegacao.length > 0) {
                        console.log('âœ… BotÃµes ENCONTRADOS no DOM!');
                        botoesNavegacao.forEach((btn, idx) => {
                            console.log(`  ${idx + 1}. ${btn.textContent.substring(0, 50)}`);
                        });
                    } else {
                        console.error('âŒ Nenhum botÃ£o de navegaÃ§Ã£o encontrado no DOM!');
                        console.error('HTML renderizado:', html.substring(0, 500));
                    }
                }, 100);
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
            },
            
            renderizarOpcaoHierarquia(opcao, nivel, path, containerId, inst, caminhoAncestral = []) {
                const temFilhos = opcao.filhos && opcao.filhos.length > 0;
                
                // âœ… CONSTRUIR CAMINHO COMPLETO: ancestrais + nome atual
                const caminhoCompleto = [...caminhoAncestral, opcao.nome];
                const caminhoString = caminhoCompleto.join(' â€º ');
                
                // Marcador para templates especiais (exames detalhados)
                const templatesEspeciais = ['avaliacao-tricologica', 'avaliacao-nasal-detalhada', 'avaliacao-auricular-detalhada'];
                const temTemplateEspecial = templatesEspeciais.includes(opcao.template);
                const marcadorEspecial = temTemplateEspecial ? ' <span style="color: #6366f1; font-size: 10px; margin-left: 4px;" title="Exame detalhado disponÃ­vel">ğŸ”¬</span>' : '';
                
                // Aplicar indentaÃ§Ã£o extra se marcado com indentVisual
                const nivelReal = opcao.indentVisual ? nivel + 1 : nivel;
                const indentacao = nivelReal * 24;
                
                // Verificar se jÃ¡ foi selecionada (evitar duplicatas)
                const jaFoiSelecionada = inst.regioesMarcadas && 
                    inst.regioesMarcadas.some(r => r.opcaoId === opcao.id);
                
                let html = `
                    <div style="margin-left: ${indentacao}px; margin-bottom: 4px;">
                        <div style="display: flex; align-items: center; padding: 4px; border-radius: 4px; hover:background: #f5f5f5;">
                `;
                
                // Renderizar checkbox - âœ… ADICIONANDO data-caminho
                html += `
                    <input type="checkbox" 
                           name="opcao-hierarquia-${containerId}[]" 
                           id="check-${path}" 
                           value="${opcao.id}"
                           data-nome="${opcao.nome}"
                           data-caminho="${caminhoString}"
                           data-template="${opcao.template || ''}"
                           data-lateralidade="${opcao.lateralidade || false}"
                           class="opcao-hierarquia-checkbox"
                           ${jaFoiSelecionada ? 'disabled title="JÃ¡ selecionado"' : ''}
                           onchange="AnatomiaAtendimento.atualizarContagemSelecoes('${containerId}')"
                           style="margin-right: 6px; cursor: ${jaFoiSelecionada ? 'not-allowed' : 'pointer'};">
                `;
                    
                // BotÃ£o de expandir/colapsar (se tiver filhos)
                if (temFilhos) {
                    html += `
                        <span onclick="AnatomiaAtendimento.toggleOpcaoHierarquia('${path}')" 
                              style="cursor: pointer; margin-right: 6px; user-select: none; font-size: 14px;"
                              id="toggle-${path}">
                            â–¶
                        </span>
                    `;
                } else {
                    html += `<span style="width: 20px; display: inline-block;"></span>`;
                }
                
                // Label
                html += `
                    <label for="check-${path}" 
                           style="cursor: ${jaFoiSelecionada ? 'not-allowed' : 'pointer'}; font-size: 12px; color: ${jaFoiSelecionada ? '#999' : '#333'}; flex: 1;">
                        ${this.limparNomeExibicao(opcao.nome)}${marcadorEspecial}
                        ${jaFoiSelecionada ? ' <span style="color: #999; font-size: 10px;">(jÃ¡ selecionado)</span>' : ''}
                    </label>
                `;
                
                html += `
                        </div>
                `;
                
                // Filhos (inicialmente colapsados) - âœ… PASSAR CAMINHO COMPLETO
                if (temFilhos) {
                    html += `
                        <div id="filhos-${path}" style="display: none;">
                    `;
                    
                    opcao.filhos.forEach((filho, idx) => {
                        html += this.renderizarOpcaoHierarquia(filho, nivel + 1, `${path}-${idx}`, containerId, inst, caminhoCompleto);
                    });
                    
                    html += `
                        </div>
                    `;
                }
                
                html += `
                    </div>
                `;
                
                return html;
            },
            
            toggleOpcaoHierarquia(path) {
                const toggleIcon = document.getElementById(`toggle-${path}`);
                const filhosContainer = document.getElementById(`filhos-${path}`);
                
                if (!filhosContainer) return;
                
                if (filhosContainer.style.display === 'none') {
                    filhosContainer.style.display = 'block';
                    toggleIcon.textContent = 'â–¼';
                } else {
                    filhosContainer.style.display = 'none';
                    toggleIcon.textContent = 'â–¶';
                }
            },
            
            
            selecionarOpcaoHierarquia(containerId, opcaoId, opcaoNome, templateId) {
                console.log('âœ“ Selecionada:', opcaoNome, 'Template:', templateId);
                
                // Habilitar botÃ£o confirmar
                const btnConfirmar = document.getElementById('btn-confirmar-hierarquia');
                if (btnConfirmar) {
                    btnConfirmar.disabled = false;
                    btnConfirmar.onclick = () => {
                        this.confirmarSelecaoHierarquia(containerId, opcaoId, opcaoNome, templateId);
                    };
                }
            },
            
            confirmarSelecaoHierarquia(containerId, opcaoId, opcaoNome, templateId) {
                console.log('âœ… Confirmando seleÃ§Ã£o:', opcaoNome);
                
                const inst = this.instancias[containerId];
                
                // âœ… CAPTURAR CAMINHO DO CHECKBOX
                const checkbox = document.querySelector(`input.opcao-hierarquia-checkbox[value="${opcaoId}"]`);
                const caminho = checkbox?.dataset?.caminho || opcaoNome;
                
                // Capturar lateralidade (se houver)
                let lateralidade = null;
                const radioLateralidade = document.querySelector(`input[name="lat-${opcaoId}"]:checked`);
                if (radioLateralidade) {
                    lateralidade = radioLateralidade.value;
                    console.log('ğŸ”„ Lateralidade selecionada:', lateralidade);
                }
                
                // Fechar popup
                const popup = document.getElementById('popup-hierarquia-anatomia');
                if (popup) popup.remove();
                
                // Salvar na lista de regiÃµes marcadas com dadosExame vazio
                const novaRegiao = {
                    opcaoId: opcaoId,
                    nome: opcaoNome,
                    caminho: caminho, // âœ… SALVAR CAMINHO
                    lateralidade: lateralidade,
                    templateId: templateId || null,
                    timestamp: new Date().toISOString(),
                    dadosExame: {
                        descricao: '',
                        achados: ''
                    }
                };
                
                if (!inst.regioesMarcadas) inst.regioesMarcadas = [];
                inst.regioesMarcadas.push(novaRegiao);
                
                console.log('ğŸ’¾ RegiÃ£o adicionada:', novaRegiao);
                
                // Atualizar visualizaÃ§Ã£o
                this.renderizarAtlas(containerId);
            },
            
            // â­ NOVA FUNÃ‡ÃƒO v10.184: Atualizar contagem de seleÃ§Ãµes
            atualizarContagemSelecoes(containerId) {
                const checkboxes = document.querySelectorAll(`.opcao-hierarquia-checkbox:checked`);
                const total = checkboxes.length;
                
                const btnConfirmar = document.getElementById('btn-confirmar-hierarquia');
                
                if (btnConfirmar) {
                    btnConfirmar.disabled = total === 0;
                    
                    // Atualizar texto do botÃ£o usando textContent (sem HTML)
                    if (total === 0) {
                        btnConfirmar.textContent = `âœ“ Confirmar (0)`;
                    } else if (total === 1) {
                        btnConfirmar.textContent = `âœ“ Confirmar (1 regiÃ£o)`;
                    } else {
                        btnConfirmar.textContent = `âœ“ Confirmar (${total} regiÃµes)`;
                    }
                }
                
                console.log(`ğŸ“Š ${total} regiÃ£o(Ãµes) selecionada(s)`);
            },
            
            // â­ NOVA FUNÃ‡ÃƒO v10.184: Confirmar mÃºltiplas seleÃ§Ãµes de uma vez
            confirmarSelecoesMultiplas(containerId) {
                const checkboxes = document.querySelectorAll(`.opcao-hierarquia-checkbox:checked`);
                
                if (checkboxes.length === 0) {
                    console.log('âš ï¸ Nenhuma seleÃ§Ã£o para confirmar');
                    return;
                }
                
                const inst = this.instancias[containerId];
                let totalAdicionadas = 0;
                
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                console.log(`ğŸš€ Processando ${checkboxes.length} seleÃ§Ã£o(Ãµes) em lote...`);
                
                checkboxes.forEach((checkbox, index) => {
                    const opcaoId = checkbox.value;
                    const opcaoNome = checkbox.dataset.nome;
                    const opcaoCaminho = checkbox.dataset.caminho || opcaoNome; // âœ… CAPTURAR CAMINHO
                    const templateId = checkbox.dataset.template || null;
                    const temLateralidade = checkbox.dataset.lateralidade === 'true';
                    
                    // Capturar lateralidade (se aplicÃ¡vel)
                    let lateralidade = null;
                    if (temLateralidade) {
                        const radioLateralidade = document.querySelector(`input[name="lat-${opcaoId}"]:checked`);
                        if (radioLateralidade) {
                            lateralidade = radioLateralidade.value;
                        }
                    }
                    
                    // VERIFICAR SE JÃ EXISTE (evitar duplicatas)
                    const jaExiste = inst.regioesMarcadas.some(r => 
                        r.nome === opcaoNome && 
                        (r.lateralidade || null) === (lateralidade || null)
                    );
                    
                    if (jaExiste) {
                        console.log(`  ${index + 1}. âš ï¸ ${opcaoNome} - JÃ SELECIONADA (pulando)`);
                        return; // Pula esta regiÃ£o
                    }
                    
                    // Criar objeto regiÃ£o - âœ… INCLUINDO CAMINHO
                    const novaRegiao = {
                        opcaoId: opcaoId,
                        nome: opcaoNome,
                        caminho: opcaoCaminho, // âœ… SALVAR CAMINHO COMPLETO
                        lateralidade: lateralidade,
                        templateId: templateId,
                        timestamp: new Date().toISOString(),
                        dadosExame: {
                            descricao: '',
                            achados: ''
                        }
                    };
                    
                    // Adicionar Ã  lista
                    if (!inst.regioesMarcadas) inst.regioesMarcadas = [];
                    inst.regioesMarcadas.push(novaRegiao);
                    
                    totalAdicionadas++;
                    
                    console.log(`  ${index + 1}. âœ… ${opcaoCaminho}`, {
                        template: templateId || 'genÃ©rico',
                        lateralidade: lateralidade || 'nÃ£o aplicÃ¡vel'
                    });
                });
                
                console.log(`âœ… ${totalAdicionadas} regiÃ£o(Ãµes) adicionada(s) com sucesso!`);
                console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
                
                // Fechar popup
                const popup = document.getElementById('popup-hierarquia-anatomia');
                if (popup) popup.remove();
                
                // Atualizar visualizaÃ§Ã£o
                this.renderizarAtlas(containerId);
                
                // Feedback visual
                const msg = totalAdicionadas === 1 ? '1 regiÃ£o adicionada' : `${totalAdicionadas} regiÃµes adicionadas`;
                console.log(`ğŸ‰ ${msg} ao atlas anatÃ´mico!`);
            },
            
            abrirCampoTextoLivre(containerId, nomeRegiao) {
                // Criar modal para texto livre
                const modal = document.createElement('div');
                modal.id = 'modal-texto-livre';
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.5);
                    z-index: 9999;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                `;
                
                const conteudo = document.createElement('div');
                conteudo.style.cssText = `
                    background: white;
                    border-radius: 8px;
                    padding: 24px;
                    max-width: 600px;
                    width: 90%;
                    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
                `;
                
                conteudo.innerHTML = `
                    <div style="margin-bottom: 16px; padding-bottom: 12px; border-bottom: 2px solid var(--primary);">
                        <h3 style="margin: 0; color: var(--primary); font-size: 16px;">
                            ğŸ“ ${nomeRegiao}
                        </h3>
                    </div>
                    
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-weight: 600; margin-bottom: 8px; font-size: 13px;">
                            DescriÃ§Ã£o:
                        </label>
                        <textarea id="textarea-regiao-livre" 
                                  style="width: 100%; min-height: 150px; padding: 12px; border: 1px solid #ccc; border-radius: 4px; font-family: inherit; font-size: 13px; resize: vertical;"
                                  placeholder="Descreva as caracterÃ­sticas observadas nesta regiÃ£o..."></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 12px;">
                        <button onclick="AnatomiaAtendimento.salvarTextoLivre('${containerId}', '${nomeRegiao}')" 
                                class="btn btn-success" style="flex: 1;">
                            ğŸ’¾ Salvar
                        </button>
                        <button onclick="document.getElementById('modal-texto-livre').remove()" 
                                class="btn btn-secondary">
                            âœ• Cancelar
                        </button>
                    </div>
                `;
                
                modal.appendChild(conteudo);
                document.body.appendChild(modal);
                
                // Focar no textarea
                setTimeout(() => {
                    document.getElementById('textarea-regiao-livre').focus();
                }, 100);
            },
            
            salvarTextoLivre(containerId, nomeRegiao) {
                const textarea = document.getElementById('textarea-regiao-livre');
                const texto = textarea.value.trim();
                
                if (!texto) {
                    alert('Por favor, preencha a descriÃ§Ã£o da regiÃ£o.');
                    return;
                }
                
                console.log(`ğŸ’¾ Salvando texto livre para ${nomeRegiao}:`, texto);
                
                // TODO: Salvar no banco de dados / localStorage
                
                alert(`âœ… DescriÃ§Ã£o salva!\n\nRegiÃ£o: ${nomeRegiao}\n\n${texto.substring(0, 100)}${texto.length > 100 ? '...' : ''}`);
                
                // Fechar modal
                const modal = document.getElementById('modal-texto-livre');
                if (modal) modal.remove();
            },
            
            abrirPopupCascataSimples(containerId, regiao, evento) {
                // Comportamento antigo para polÃ­gonos sem hierarquia definida
                // Remover popup anterior se existir
                const popupAntigo = document.getElementById('popup-cascata-anatomia');
                if (popupAntigo) popupAntigo.remove();
                
                // Criar popup
                const popup = document.createElement('div');
                popup.id = 'popup-cascata-anatomia';
                popup.style.cssText = `
                    position: fixed;
                    background: white;
                    border: 1px solid #e0e0e0;
                    border-radius: 8px;
                    padding: 12px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                    z-index: 10000;
                    min-width: 200px;
                    max-height: 90vh;
                    overflow-y: auto;
                `;
                
                // Posicionamento inteligente
                let left = evento.clientX + 10;
                let top = evento.clientY + 10;
                
                // Ajustar horizontalmente se ultrapassar tela
                if (left + 220 > window.innerWidth) {
                    left = evento.clientX - 210;
                }
                
                popup.style.left = left + 'px';
                popup.style.top = top + 'px';
                
                // ConteÃºdo: hierarquia
                popup.innerHTML = `
                    <div style="margin-bottom: 8px; padding-bottom: 8px; border-bottom: 2px solid #e0e0e0;">
                        <strong style="font-size: 13px; color: var(--primary);">Selecione a abrangÃªncia:</strong>
                    </div>
                    
                    <!-- Seletor de cor -->
                    <div style="margin-bottom: 8px;">
                        <label style="font-size: 11px; color: #666; display: block; margin-bottom: 4px;">Cor da regiÃ£o:</label>
                        <input type="color" id="popup-cor-regiao" value="${regiao.cor}" 
                               style="width: 100%; height: 32px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer;">
                    </div>
                    
                    <!-- OpÃ§Ã£o: Grupo inteiro -->
                    <button onclick="AnatomiaAtendimento.marcarGrupoInteiro('${containerId}', '${regiao.grupo}', document.getElementById('popup-cor-regiao').value)" 
                            style="width: 100%; text-align: left; padding: 8px; margin-bottom: 4px; background: #e3f2fd; border: 1px solid #2196f3; border-radius: 4px; cursor: pointer; font-size: 12px;">
                        ğŸ“¦ <strong>${regiao.grupo}</strong> (todo o grupo)
                    </button>
                    
                    <!-- OpÃ§Ã£o: RegiÃ£o atual -->
                    <button onclick="AnatomiaAtendimento.marcarRegiaoCascata('${containerId}', '${regiao.nome}', '${regiao.grupo}', document.getElementById('popup-cor-regiao').value); document.getElementById('popup-cascata-anatomia').remove();" 
                            style="width: 100%; text-align: left; padding: 8px; margin-bottom: 4px; background: #fff3e0; border: 1px solid #ff9800; border-radius: 4px; cursor: pointer; font-size: 12px;">
                        ğŸ¯ <strong>${regiao.nome}</strong> (especÃ­fico)
                    </button>
                    
                    <button onclick="document.getElementById('popup-cascata-anatomia').remove()" 
                            style="width: 100%; padding: 6px; background: #f5f5f5; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; font-size: 11px; margin-top: 8px;">
                        âœ• Cancelar
                    </button>
                `;
                
                document.body.appendChild(popup);
                
                // Ajustar verticalmente se ultrapassar barra inferior
                const popupRect = popup.getBoundingClientRect();
                if (popupRect.bottom > window.innerHeight) {
                    const novoTop = evento.clientY - popupRect.height - 10;
                    popup.style.top = Math.max(10, novoTop) + 'px';
                }
                
                // Fechar ao clicar fora
                setTimeout(() => {
                    document.addEventListener('click', function fecharPopup(e) {
                        if (!popup.contains(e.target)) {
                            popup.remove();
                            document.removeEventListener('click', fecharPopup);
                        }
                    });
                }, 100);
            },
            
            abrirPopupHierarquico(containerId, regiao, evento) {
                // Remover popup anterior
                const popupAntigo = document.getElementById('popup-cascata-anatomia');
                if (popupAntigo) popupAntigo.remove();
                
                const popup = document.createElement('div');
                popup.id = 'popup-cascata-anatomia';
                popup.style.cssText = `
                    position: fixed;
                    background: white;
                    border: 1px solid #e0e0e0;
                    border-radius: 8px;
                    padding: 16px;
                    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
                    z-index: 10000;
                    min-width: 250px;
                    max-height: 90vh;
                    overflow-y: auto;
                `;
                
                // Posicionamento inteligente
                let left = evento.clientX + 10;
                let top = evento.clientY + 10;
                
                // Ajustar horizontalmente se ultrapassar tela
                if (left + 270 > window.innerWidth) {
                    left = evento.clientX - 260; // Abrir Ã  esquerda do cursor
                }
                
                popup.style.left = left + 'px';
                popup.style.top = top + 'px';
                
                // Buscar nomes dos filhos
                const nomesFilhos = regiao.filhos.map(filhoId => {
                    const filho = ATLAS_ANATOMICO.regioes.find(r => r.id === filhoId);
                    return filho ? filho.nome : filhoId;
                }).join(', ');
                
                popup.innerHTML = `
                    <div style="margin-bottom: 12px; padding-bottom: 10px; border-bottom: 2px solid #e0e0e0;">
                        <strong style="font-size: 14px; color: var(--primary);">${regiao.nome}</strong>
                        <div style="font-size: 11px; color: #666; margin-top: 4px;">Selecione o que marcar:</div>
                    </div>
                    
                    <button onclick="AnatomiaAtendimento.marcarRegiaoCascata('${containerId}', '${regiao.nome}', '${regiao.grupo}', '${regiao.cor}'); document.getElementById('popup-cascata-anatomia').remove();" 
                            style="width: 100%; text-align: left; padding: 10px; margin-bottom: 6px; 
                                   background: #fff3e0; border: 1px solid #ff9800; border-radius: 4px; 
                                   cursor: pointer; font-size: 12px;">
                        ğŸ¯ SÃ³ <strong>${regiao.nome}</strong>
                    </button>
                    
                    <button onclick="AnatomiaAtendimento.marcarSoFilhosRegiao('${containerId}', '${regiao.id}'); document.getElementById('popup-cascata-anatomia').remove();" 
                            style="width: 100%; text-align: left; padding: 10px; margin-bottom: 6px; 
                                   background: #e3f2fd; border: 1px solid #2196f3; border-radius: 4px; 
                                   cursor: pointer; font-size: 12px;">
                        ğŸ“¦ Apenas as ${regiao.filhos.length} subÃ¡reas
                        <div style="font-size: 10px; color: #666; margin-top: 4px;">
                            ${nomesFilhos}
                        </div>
                    </button>
                    
                    <button onclick="AnatomiaAtendimento.marcarRegiaoEFilhos('${containerId}', '${regiao.id}'); document.getElementById('popup-cascata-anatomia').remove();" 
                            style="width: 100%; text-align: left; padding: 10px; margin-bottom: 6px; 
                                   background: #e8f5e9; border: 1px solid #4caf50; border-radius: 4px; 
                                   cursor: pointer; font-size: 12px;">
                        ğŸ”² <strong>${regiao.nome}</strong> completo (tudo)
                    </button>
                    
                    <button onclick="document.getElementById('popup-cascata-anatomia').remove()" 
                            style="width: 100%; padding: 8px; background: #f5f5f5; border: 1px solid #ccc; 
                                   border-radius: 4px; cursor: pointer; font-size: 11px; margin-top: 8px;">
                        âœ• Cancelar
                    </button>
                `;
                
                document.body.appendChild(popup);
                
                // Ajustar verticalmente se ultrapassar barra inferior
                const popupRect = popup.getBoundingClientRect();
                if (popupRect.bottom > window.innerHeight) {
                    // Reposicionar acima do cursor
                    const novoTop = evento.clientY - popupRect.height - 10;
                    popup.style.top = Math.max(10, novoTop) + 'px';
                }
                
                // Fechar ao clicar fora
                setTimeout(() => {
                    document.addEventListener('click', function fecharPopup(e) {
                        if (!popup.contains(e.target)) {
                            popup.remove();
                            document.removeEventListener('click', fecharPopup);
                        }
                    });
                }, 100);
            },
            
            marcarSoFilhosRegiao(containerId, regiaoId) {
                console.log('ğŸ“¦ Marcar sÃ³ filhos de:', regiaoId);
                const regiao = ATLAS_ANATOMICO.regioes.find(r => r.id === regiaoId);
                if (!regiao || !regiao.filhos) return;
                
                regiao.filhos.forEach(filhoId => {
                    const filho = ATLAS_ANATOMICO.regioes.find(r => r.id === filhoId);
                    if (filho) {
                        this.marcarRegiaoCascata(containerId, filho.nome, filho.grupo, filho.cor);
                    }
                });
                
                this.renderizarAtlas(containerId);
            },
            
            marcarRegiaoEFilhos(containerId, regiaoId) {
                console.log('ğŸ”² Marcar regiÃ£o + filhos:', regiaoId);
                const regiao = ATLAS_ANATOMICO.regioes.find(r => r.id === regiaoId);
                if (!regiao) return;
                
                // Marcar a prÃ³pria regiÃ£o
                this.marcarRegiaoCascata(containerId, regiao.nome, regiao.grupo, regiao.cor);
                
                // Marcar filhos recursivamente
                this.marcarFilhosRecursivo(containerId, regiao);
                
                this.renderizarAtlas(containerId);
            },
            
            marcarFilhosRecursivo(containerId, regiao) {
                if (!regiao.filhos || regiao.filhos.length === 0) return;
                
                regiao.filhos.forEach(filhoId => {
                    const filho = ATLAS_ANATOMICO.regioes.find(r => r.id === filhoId);
                    if (filho) {
                        this.marcarRegiaoCascata(containerId, filho.nome, filho.grupo, filho.cor);
                        this.marcarFilhosRecursivo(containerId, filho); // RecursÃ£o
                    }
                });
            },
            
            abrirFormularioTemplate(containerId, regiao) {
                console.log('ğŸ“‹ Abrir formulÃ¡rio para:', regiao.nome, 'template:', regiao.template);
                
                const template = TEMPLATES_DISPONIVEIS[regiao.template];
                if (!template) {
                    alert('âŒ Template nÃ£o encontrado: ' + regiao.template);
                    return;
                }
                
                // Criar modal (mesmo cÃ³digo do protÃ³tipo v10.156)
                const modal = document.createElement('div');
                modal.id = 'modal-formulario-template';
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.5);
                    z-index: 9999;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                `;
                
                const conteudo = document.createElement('div');
                conteudo.style.cssText = `
                    background: white;
                    border-radius: 8px;
                    padding: 24px;
                    max-width: 800px;
                    max-height: 90vh;
                    overflow-y: auto;
                    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
                `;
                
                conteudo.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 12px; border-bottom: 2px solid var(--primary);">
                        <h3 style="margin: 0; color: var(--primary);">
                            ${template.nome}
                        </h3>
                        <button onclick="document.getElementById('modal-formulario-template').remove()" 
                                style="background: none; border: none; font-size: 24px; color: #999; cursor: pointer;">
                            âœ•
                        </button>
                    </div>
                    
                    <div style="font-size: 13px; color: #666; margin-bottom: 16px;">
                        <strong>RegiÃ£o:</strong> ${regiao.nome}
                    </div>
                    
                    <div id="campos-formulario-template">
                        <p style="text-align: center; color: #999;">Carregando campos...</p>
                    </div>
                    
                    <div style="display: flex; gap: 12px; margin-top: 24px; padding-top: 16px; border-top: 1px solid #e0e0e0;">
                        <button onclick="alert('ğŸ’¾ Salvamento serÃ¡ implementado na prÃ³xima versÃ£o!')" 
                                class="btn btn-success" style="flex: 1;">
                            ğŸ’¾ Salvar AvaliaÃ§Ã£o
                        </button>
                        <button onclick="document.getElementById('modal-formulario-template').remove()" 
                                class="btn btn-secondary">
                            âœ• Cancelar
                        </button>
                    </div>
                `;
                
                modal.appendChild(conteudo);
                document.body.appendChild(modal);
                
                // Renderizar campos do template
                setTimeout(() => {
                    const container = document.getElementById('campos-formulario-template');
                    if (container) {
                        container.innerHTML = `<p style="color: var(--primary); text-align: center;">
                            âœ… Template: ${template.nome}<br>
                            <small>Renderizador de formulÃ¡rios serÃ¡ implementado na prÃ³xima versÃ£o</small>
                        </p>`;
                    }
                }, 100);
            },
            
            
            marcarGrupoInteiro(containerId, grupo, cor) {
                const inst = this.instancias[containerId];
                
                // Pegar todas as regiÃµes deste grupo
                const regioesDoGrupo = ATLAS_ANATOMICO.regioes.filter(r => r.grupo === grupo);
                
                // Verificar se todas jÃ¡ estÃ£o marcadas
                const todasMarcadas = regioesDoGrupo.every(r => 
                    inst.regioesMarcadas.some(m => m.nome === r.nome && m.vista === r.vista)
                );
                
                if (todasMarcadas) {
                    // Desmarcar todas
                    regioesDoGrupo.forEach(r => {
                        inst.regioesMarcadas = inst.regioesMarcadas.filter(m => 
                            !(m.nome === r.nome && m.vista === r.vista)
                        );
                    });
                } else {
                    // Marcar todas
                    regioesDoGrupo.forEach(r => {
                        const jaExiste = inst.regioesMarcadas.some(m => 
                            m.nome === r.nome && m.vista === r.vista
                        );
                        
                        if (!jaExiste) {
                            inst.regioesMarcadas.push({
                                nome: r.nome,
                                grupo: r.grupo,
                                vista: r.vista,
                                cor: r.cor,
                                timestamp: new Date().toISOString()
                            });
                        }
                    });
                }
                
                this.renderizarAtlas(containerId);
                
                // Fechar popup
                const popup = document.getElementById('popup-cascata-anatomia');
                if (popup) popup.remove();
            },
            
            marcarRegiaoCascata(containerId, nome, grupo, cor) {
                const inst = this.instancias[containerId];
                
                // Verificar se JÃ existe a regiÃ£o Anterior marcada
                const idxAnterior = inst.regioesMarcadas.findIndex(r => 
                    r.nome === nome && r.vista === 'Anterior'
                );
                
                // Verificar se JÃ existe a regiÃ£o Posterior marcada
                const idxPosterior = inst.regioesMarcadas.findIndex(r => 
                    r.nome === nome && r.vista === 'Posterior'
                );
                
                if (idxAnterior >= 0 && idxPosterior >= 0) {
                    // AMBAS marcadas â†’ Desmarcar AMBAS (CASCATA)
                    inst.regioesMarcadas.splice(idxPosterior, 1); // Remove posterior primeiro (Ã­ndice maior)
                    inst.regioesMarcadas.splice(idxAnterior, 1);  // Remove anterior
                } else {
                    // NÃƒO marcadas â†’ Marcar AMBAS (CASCATA)
                    
                    // Marcar Anterior (se nÃ£o estiver marcada)
                    if (idxAnterior < 0) {
                        inst.regioesMarcadas.push({
                            nome: nome,
                            grupo: grupo,
                            vista: 'Anterior',
                            cor: cor,
                            timestamp: new Date().toISOString()
                        });
                    }
                    
                    // Marcar Posterior (se nÃ£o estiver marcada)
                    if (idxPosterior < 0) {
                        inst.regioesMarcadas.push({
                            nome: nome,
                            grupo: grupo,
                            vista: 'Posterior',
                            cor: cor,
                            timestamp: new Date().toISOString()
                        });
                    }
                }
                
                // Redesenhar AMBAS as vistas
                this.renderizarAtlas(containerId);
            },
            
            marcarRegiao(containerId, regiao) {
                const inst = this.instancias[containerId];
                
                // Verificar se jÃ¡ estÃ¡ marcada
                const idx = inst.regioesMarcadas.findIndex(r => 
                    r.nome === regiao.nome && r.vista === inst.vistaAtual
                );
                
                if (idx >= 0) {
                    // Desmarcar
                    inst.regioesMarcadas.splice(idx, 1);
                } else {
                    // Marcar
                    inst.regioesMarcadas.push({
                        nome: regiao.nome,
                        grupo: regiao.grupo,
                        vista: inst.vistaAtual,
                        cor: regiao.cor,
                        timestamp: new Date().toISOString()
                    });
                }
                
                // Redesenhar
                this.renderizarAtlas(containerId);
            },
            
            atualizarListaAtlas(containerId) {
                console.log(`ğŸ”„ [atualizarListaAtlas] Iniciando para ${containerId}`);
                
                const inst = this.instancias[containerId];
                
                if (!inst) {
                    console.warn(`âš ï¸ [atualizarListaAtlas] InstÃ¢ncia nÃ£o encontrada: ${containerId}`);
                    return;
                }
                
                // Se estiver no modo queimados, usar funÃ§Ã£o especÃ­fica
                if (inst && inst.contexto === 'queimados') {
                    this.atualizarListaQueimados(containerId);
                    return;
                }
                
                // âœ… USAR IDs CORRETOS DO MODO ANATÃ”MICO
                const lista = document.getElementById(`lista-regioes-${containerId}`);
                const total = document.getElementById(`total-regioes-${containerId}`);
                
                console.log(`ğŸ“‹ [atualizarListaAtlas] lista-regioes-${containerId}:`, lista ? 'ENCONTRADO' : 'NÃƒO ENCONTRADO');
                console.log(`ğŸ“‹ [atualizarListaAtlas] total-regioes-${containerId}:`, total ? 'ENCONTRADO' : 'NÃƒO ENCONTRADO');
                
                if (!lista || !total) {
                    console.warn(`âš ï¸ [atualizarListaAtlas] Container de lista nÃ£o encontrado`);
                    return;
                }
                
                const totalRegioes = (inst.regioesMarcadas || []).length;
                total.textContent = totalRegioes;
                
                console.log(`ğŸ“Š [atualizarListaAtlas] Total de regiÃµes marcadas: ${totalRegioes}`);
                
                if (totalRegioes === 0) {
                    lista.innerHTML = '<p style="text-align: center; color: #999; font-size: 13px; padding: 20px 0;">Clique nas regiÃµes para selecionar</p>';
                    return;
                }
                
                // Log detalhado de cada regiÃ£o
                inst.regioesMarcadas.forEach((r, i) => {
                    console.log(`   ğŸ“ [${i}] ${r.nome} - achados: "${r.dadosExame?.achados || '(vazio)'}"`);
                });
                
                if (totalRegioes === 0) {
                    lista.innerHTML = '<p style="text-align: center; color: #999; font-size: 13px; padding: 20px 0;">Clique nas regiÃµes para selecionar</p>';
                    return;
                }
                
                // Renderizar cada regiÃ£o como card com campos
                let html = '';
                inst.regioesMarcadas.forEach((regiao, index) => {
                    // Garantir dadosExame
                    if (!regiao.dadosExame) {
                        regiao.dadosExame = { descricao: '', achados: '' };
                    }
                    
                    const id = `regiao-${containerId}-${index}`;
                    
                    // Definir Ã­cone e texto da lateralidade
                    let lateralidadeInfo = '';
                    if (regiao.lateralidade) {
                        const icones = {
                            'bilateral': 'â†”ï¸',
                            'direito': 'â¡ï¸',
                            'esquerdo': 'â¬…ï¸'
                        };
                        const textos = {
                            'bilateral': 'Bilateral',
                            'direito': 'Direito',
                            'esquerdo': 'Esquerdo'
                        };
                        lateralidadeInfo = ` <span style="font-size: 11px; color: #666; font-weight: normal;">${icones[regiao.lateralidade]} ${textos[regiao.lateralidade]}</span>`;
                    }
                    
                    // âœ… v10.394: LÃ“GICA DE HIERARQUIA:
                    // - Se raiz Ã© "CabeÃ§a e PescoÃ§o" â†’ usar PAI DIRETO (exceto se nome Ã© CabeÃ§a ou PescoÃ§o)
                    // - Tronco/Membros â†’ pai = raiz
                    let caminhoExibir = regiao.nome;
                    if (regiao.caminho && regiao.caminho.includes(' â€º ')) {
                        const partes = regiao.caminho.split(' â€º ');
                        let raiz = partes[0];
                        let nome = partes[partes.length - 1];
                        const paiDireto = partes.length >= 2 ? partes[partes.length - 2] : null;
                        
                        // Remover (anterior)/(posterior)/(regiÃ£o completa)
                        const limpar = (txt) => txt.replace(/\s*\((anterior|posterior|regiÃ£o completa)\)/gi, '').trim();
                        raiz = limpar(raiz);
                        nome = limpar(nome);
                        const paiLimpo = paiDireto ? limpar(paiDireto) : null;
                        
                        // Se nome ficou "regiÃ£o completa", usar o pai como nome
                        if (nome.toLowerCase() === 'regiÃ£o completa' && paiLimpo) {
                            nome = paiLimpo;
                        }
                        
                        // Verificar se raiz Ã© "CabeÃ§a e PescoÃ§o"
                        const raizEhCabecaPescoco = raiz.toLowerCase().includes('cabeÃ§a') && raiz.toLowerCase().includes('pescoÃ§o');
                        
                        // Verificar se nome Ã© CabeÃ§a ou PescoÃ§o (seleÃ§Ã£o direta)
                        const nomeEhCabeca = nome.toLowerCase() === 'cabeÃ§a';
                        const nomeEhPescoco = nome.toLowerCase() === 'pescoÃ§o';
                        
                        let paiExibir;
                        if (raizEhCabecaPescoco && (nomeEhCabeca || nomeEhPescoco)) {
                            // SeleÃ§Ã£o direta de CabeÃ§a ou PescoÃ§o â†’ pai = "CabeÃ§a e PescoÃ§o"
                            paiExibir = 'CabeÃ§a e PescoÃ§o';
                        } else if (raizEhCabecaPescoco) {
                            // Sub-regiÃ£o de CabeÃ§a e PescoÃ§o â†’ PAI DIRETO
                            paiExibir = paiLimpo;
                        } else {
                            // Tronco, Membros â†’ raiz
                            paiExibir = raiz;
                        }
                        
                        console.log(`ğŸ” [Hierarquia] caminho: "${regiao.caminho}" â†’ raiz: "${raiz}", nome: "${nome}", paiLimpo: "${paiLimpo}", paiExibir: "${paiExibir}"`);
                        
                        if (paiExibir && paiExibir !== nome) {
                            caminhoExibir = `<span style="color: #6b7280; font-weight: normal;">${paiExibir} â€º</span> ${nome}`;
                        }
                    }
                    
                    html += `
                        <div style="margin-bottom: 16px; padding: 12px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3b82f6;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <strong style="font-size: 13px; color: var(--primary);">ğŸ“ ${caminhoExibir}${lateralidadeInfo}</strong>
                                <button onclick="AnatomiaAtendimento.removerRegiao('${containerId}', ${index})" 
                                        style="background: none; border: none; color: var(--danger); cursor: pointer; font-size: 16px; padding: 0 4px;" title="Remover">
                                    ğŸ—‘ï¸
                                </button>
                            </div>
                            
                            <!-- CAMPO ACHADOS (primeiro, com pool) -->
                            <div style="margin-bottom: 8px;">
                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 3px; font-weight: 600;">
                                    Achados: <span style="color: #e74c3c;">*</span>
                                </label>
                                
                                <!-- Input com Busca de Achados -->
                                <div style="display: flex; gap: 6px; margin-bottom: 6px; align-items: center;">
                                    <div style="flex: 1; position: relative;">
                                        <input type="text" 
                                               id="pool-achados-${id}" 
                                               list="datalist-achados-${id}"
                                               placeholder="ğŸ” Digite para buscar achado comum..."
                                               autocomplete="off"
                                               onkeypress="if(event.key === 'Enter') { event.preventDefault(); AnatomiaAtendimento.inserirAchadoDoPool('${containerId}', ${index}); }"
                                               style="width: 100%; padding: 6px; font-size: 11px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                                        <datalist id="datalist-achados-${id}"></datalist>
                                    </div>
                                    <button onclick="AnatomiaAtendimento.inserirAchadoDoPool('${containerId}', ${index})"
                                            style="padding: 6px 12px; background: var(--primary); color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;"
                                            title="Inserir achado digitado ou selecionado (ou pressione Enter)">
                                        + Inserir
                                    </button>
                                    <button onclick="AnatomiaAtendimento.gerenciarPoolAchados()"
                                            style="padding: 6px 10px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;"
                                            title="Gerenciar pool de achados">
                                        âš™ï¸
                                    </button>
                                </div>
                                
                                <textarea id="achados-${id}" 
                                          style="width: 100%; min-height: 60px; padding: 6px; font-size: 12px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;"
                                          oninput="AnatomiaAtendimento.salvarCampo('${containerId}', ${index}, 'achados', this.value)"
                                          placeholder="Achados clÃ­nicos...">${regiao.dadosExame.achados || ''}</textarea>
                            </div>
                            
                            <!-- CAMPO OBSERVAÃ‡Ã•ES (livre, sem pool) -->
                            <div>
                                <label style="font-size: 11px; color: #666; display: block; margin-bottom: 3px;">ObservaÃ§Ãµes:</label>
                                <textarea id="desc-${id}" 
                                          style="width: 100%; min-height: 50px; padding: 6px; font-size: 12px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;"
                                          oninput="AnatomiaAtendimento.salvarCampo('${containerId}', ${index}, 'descricao', this.value)"
                                          placeholder="ObservaÃ§Ãµes adicionais...">${regiao.dadosExame.descricao || ''}</textarea>
                            </div>
                            
                            <!-- CAMPOS DO TEMPLATE (se houver) -->
                            <div id="campos-template-${id}"></div>
                        </div>
                    `;
                });
                
                lista.innerHTML = html;
                
                // Popular dropdowns de achados com itens do pool
                this.popularDropdownsAchados(containerId);
                
                // Renderizar campos dos templates
                this.renderizarCamposTemplates(containerId);
            },
            
            renderizarCamposTemplates(containerId) {
                const inst = this.instancias[containerId];
                
                inst.regioesMarcadas.forEach((regiao, index) => {
                    const id = `regiao-${containerId}-${index}`;
                    const container = document.getElementById(`campos-template-${id}`);
                    if (!container) return;
                    
                    // Buscar template da regiÃ£o (usa o templateId salvo ou 'avaliacao-generica' como padrÃ£o)
                    const templateId = regiao.templateId || 'avaliacao-generica';
                    const template = TEMPLATES_DISPONIVEIS[templateId];
                    
                    console.log(`ğŸ¨ Renderizando template "${templateId}" para "${regiao.nome}"`);
                    
                    if (!template || !template.campos) {
                        console.log(`âš ï¸ Template "${templateId}" nÃ£o encontrado ou sem campos`);
                        return;
                    }
                    
                    let html = '';
                    
                    // Renderizar cada campo do template
                    template.campos.forEach(campo => {
                        console.log(`  ğŸ”¹ Processando campo: ${campo.id}, tipo: ${campo.tipo}`);
                        
                        // Pular apenas campos que jÃ¡ existem como fixos
                        if (['achados', 'descricao'].includes(campo.id)) {
                            console.log(`    â­ï¸ Pulando campo fixo: ${campo.id}`);
                            return;
                        }
                        
                        html += this.renderizarCampoTemplate(campo, id, containerId, index, regiao);
                        console.log(`    âœ… Campo ${campo.id} renderizado`);
                    });
                    
                    if (html) {
                        container.innerHTML = html;
                        console.log(`âœ… Campos do template "${templateId}" renderizados`);
                        
                        // Ativar comportamento condicional
                        console.log('ğŸ¬ Chamando ativarCamposCondicionais para:', id, templateId);
                        this.ativarCamposCondicionais(id, templateId);
                        
                        // Garantir que execute tambÃ©m apÃ³s DOM estar pronto
                        setTimeout(() => {
                            console.log('ğŸ¬ [Timeout] Chamando ativarCamposCondicionais novamente');
                            this.ativarCamposCondicionais(id, templateId);
                        }, 100);
                    } else {
                        console.log(`â„¹ï¸ Nenhum campo adicional para renderizar`);
                    }
                });
            },
            
            renderizarCampoTemplate(campo, id, containerId, index, regiao) {
                const valorSalvo = regiao.dadosExame?.[campo.id] || '';
                
                // Para campos condicionais, verificar se devem iniciar escondidos
                let displayInicial = '';
                if (campo.tipo === 'radio-condicional' && campo.condicao) {
                    const valorCondicao = regiao.dadosExame?.[campo.condicao.campo] || '';
                    displayInicial = valorCondicao === campo.condicao.valor ? '' : 'display: none;';
                }
                
                let html = `<div style="margin-top: 12px; text-align: left; ${displayInicial}" id="campo-${id}-${campo.id}">`;
                
                // Label (com botÃ£o âš™ï¸ para escalas de calvÃ­cie)
                const isEscalaCalvicie = campo.id === 'norwood-hamilton' || campo.id === 'ludwig';
                html += `<label style="font-size: 11px; color: #666; display: flex; align-items: center; gap: 6px; margin-bottom: 3px; font-weight: 600;">
                    <span>${campo.label}</span>
                    ${isEscalaCalvicie ? `
                        <button onclick="AnatomiaAtendimento.abrirModalEscalas()" 
                                type="button"
                                style="background: var(--primary); color: white; border: none; border-radius: 4px; padding: 2px 8px; font-size: 10px; cursor: pointer; display: flex; align-items: center; gap: 3px;"
                                title="Ver escalas">
                            âš™ï¸ Ver escalas
                        </button>
                    ` : ''}
                </label>`;
                
                // Renderizar por tipo
                if (campo.tipo === 'texto-livre') {
                    html += `<textarea 
                        id="input-${id}-${campo.id}"
                        style="width: 100%; min-height: ${(campo.linhas || 3) * 20}px; padding: 6px; font-size: 12px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;"
                        onchange="AnatomiaAtendimento.salvarCampo('${containerId}', ${index}, '${campo.id}', this.value)"
                        placeholder="${campo.label}">${valorSalvo}</textarea>`;
                        
                } else if (campo.tipo === 'radio-simples' || campo.tipo === 'radio-condicional') {
                    html += `<div style="display: flex; flex-direction: column; gap: 4px; align-items: flex-start; text-align: left; width: 100%;">`;
                    campo.opcoes.forEach((opcao, idx) => {
                        const radioId = `radio-${id}-${campo.id}-${idx}`;
                        const checked = valorSalvo === opcao ? 'checked' : '';
                        html += `
                            <label style="font-size: 11px; cursor: pointer; padding: 4px 0; display: flex; align-items: center; text-align: left; width: 100%;">
                                <input type="radio" 
                                       id="${radioId}"
                                       name="radio-${id}-${campo.id}" 
                                       value="${opcao}"
                                       ${checked}
                                       onchange="
                                           AnatomiaAtendimento.salvarCampo('${containerId}', ${index}, '${campo.id}', this.value);
                                           setTimeout(() => AnatomiaAtendimento.atualizarCamposCondicionais('${id}', '${campo.id}', this.value), 50);
                                       "
                                       style="margin-right: 8px; flex-shrink: 0;">
                                <span style="text-align: left;">${opcao}</span>
                            </label>`;
                    });
                    html += `</div>`;
                }
                
                html += `</div>`;
                return html;
            },
            
            ativarCamposCondicionais(id, templateId) {
                // Percorrer todos os campos com tipo "radio-condicional" e esconder/mostrar baseado na condiÃ§Ã£o
                const template = TEMPLATES_DISPONIVEIS[templateId];
                if (!template || !template.campos) return;
                
                console.log('ğŸ”„ ativarCamposCondicionais:', id, templateId);
                
                template.campos.forEach(campo => {
                    if (campo.tipo === 'radio-condicional' && campo.condicao) {
                        // Primeiro tenta pegar o radio checked
                        let campoCondicao = document.querySelector(`input[name="radio-${id}-${campo.condicao.campo}"]:checked`);
                        let valorAtual = campoCondicao?.value;
                        
                        // Se nÃ£o houver nenhum checked, verificar se existe algum radio deste grupo (para debug)
                        if (!campoCondicao) {
                            const todosRadios = document.querySelectorAll(`input[name="radio-${id}-${campo.condicao.campo}"]`);
                            console.log(`  ğŸ” Radios encontrados no grupo "${campo.condicao.campo}":`, todosRadios.length);
                            valorAtual = null; // Nenhum selecionado
                        }
                        
                        const campoAlvo = document.getElementById(`campo-${id}-${campo.id}`);
                        
                        console.log(`  Campo: ${campo.id}, CondiÃ§Ã£o: ${campo.condicao.campo}=${campo.condicao.valor}`);
                        console.log(`  Valor atual:`, valorAtual);
                        console.log(`  Elemento alvo:`, campoAlvo);
                        
                        if (campoAlvo) {
                            if (valorAtual === campo.condicao.valor) {
                                console.log(`  âœ… Mostrando ${campo.id}`);
                                campoAlvo.style.display = 'block';
                            } else {
                                console.log(`  âŒ Escondendo ${campo.id} (valor atual: ${valorAtual}, esperado: ${campo.condicao.valor})`);
                                campoAlvo.style.display = 'none';
                            }
                        } else {
                            console.log(`  âš ï¸ Elemento campo-${id}-${campo.id} nÃ£o encontrado`);
                        }
                    }
                });
            },
            
            atualizarCamposCondicionais(id, campoMudado, novoValor) {
                console.log('ğŸ”„ atualizarCamposCondicionais chamado:', { id, campoMudado, novoValor });
                
                // Encontrar o templateId desta regiÃ£o
                // O id tem formato: regiao-{containerId}-{index}
                const partes = id.split('-');
                const containerId = partes.slice(1, -1).join('-'); // Tudo entre 'regiao-' e o Ãºltimo nÃºmero
                const index = parseInt(partes[partes.length - 1]);
                
                console.log('  Parsed:', { containerId, index });
                
                const inst = this.instancias[containerId];
                if (!inst || !inst.regioesMarcadas[index]) {
                    console.log('  âš ï¸ InstÃ¢ncia ou regiÃ£o nÃ£o encontrada');
                    return;
                }
                
                const templateId = inst.regioesMarcadas[index].templateId || 'avaliacao-generica';
                console.log('  Template ID:', templateId);
                
                // Quando um campo muda, atualizar visibilidade dos campos condicionais
                this.ativarCamposCondicionais(id, templateId);
            },
            
            abrirModalEscalas() {
                // Remover modal anterior se existir
                const modalAntigo = document.getElementById('modal-escalas-calvicie');
                if (modalAntigo) modalAntigo.remove();
                
                // Criar modal
                const modal = document.createElement('div');
                modal.id = 'modal-escalas-calvicie';
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.5);
                    z-index: 10001;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 20px;
                `;
                
                const conteudo = document.createElement('div');
                conteudo.style.cssText = `
                    background: white;
                    border-radius: 12px;
                    padding: 24px;
                    max-width: 900px;
                    width: 100%;
                    max-height: 90vh;
                    overflow-y: auto;
                    box-shadow: 0 10px 40px rgba(0,0,0,0.3);
                `;
                
                conteudo.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 2px solid var(--primary);">
                        <h3 style="margin: 0; color: var(--primary); font-size: 18px;">
                            ğŸ“Š Escalas de CalvÃ­cie
                        </h3>
                        <button onclick="document.getElementById('modal-escalas-calvicie').remove()" 
                                style="background: none; border: none; font-size: 24px; color: #666; cursor: pointer; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 4px;"
                                onmouseover="this.style.background='#f0f0f0'"
                                onmouseout="this.style.background='none'"
                                title="Fechar">
                            Ã—
                        </button>
                    </div>
                    
                    <!-- ESCALA NORWOOD-HAMILTON (Masculino) -->
                    <div style="margin-bottom: 32px;">
                        <h4 style="color: #2563eb; margin: 0 0 12px 0; font-size: 16px; display: flex; align-items: center; gap: 8px;">
                            ğŸ§” Escala de Norwood-Hamilton (Masculino)
                        </h4>
                        <div style="background: #f8f9fa; padding: 16px; border-radius: 8px; border: 1px solid #e5e7eb;">
                            <!-- Imagem da Escala Norwood-Hamilton -->
                            <div style="text-align: center; background: white; border-radius: 4px; margin-bottom: 12px; padding: 8px;">
                                <img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAkACQAAD/4QCeRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAACQAAAAAQAAAJAAAAABAAOShgAHAAAAEgAAAISgAgAEAAAAAQAAAu6gAwAEAAAAAQAAAlQAAAAAQVNDSUkAAABTY3JlZW5zaG90/+EJIWh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD94cGFja2V0IGVuZD0idyI/PgD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/+IQCElDQ19QUk9GSUxFAAEBAAAP+GFwcGwCEAAAbW50clJHQiBYWVogB+UAAgAJABYAJAA4YWNzcEFQUEwAAAAAQVBQTAAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1hcHBsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASZGVzYwAAAVwAAABiZHNjbQAAAcAAAAScY3BydAAABlwAAAAjd3RwdAAABoAAAAAUclhZWgAABpQAAAAUZ1hZWgAABqgAAAAUYlhZWgAABrwAAAAUclRSQwAABtAAAAgMYWFyZwAADtwAAAAgdmNndAAADvwAAAAwbmRpbgAADywAAAA+Y2hhZAAAD2wAAAAsbW1vZAAAD5gAAAAodmNncAAAD8AAAAA4YlRSQwAABtAAAAgMZ1RSQwAABtAAAAgMYWFiZwAADtwAAAAgYWFnZwAADtwAAAAgZGVzYwAAAAAAAAAIRGlzcGxheQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG1sdWMAAAAAAAAAJgAAAAxockhSAAAAFAAAAdhrb0tSAAAADAAAAexuYk5PAAAAEgAAAfhpZAAAAAAAEgAAAgpodUhVAAAAFAAAAhxjc0NaAAAAFgAAAjBkYURLAAAAHAAAAkZubE5MAAAAFgAAAmJmaUZJAAAAEAAAAnhpdElUAAAAGAAAAohlc0VTAAAAFgAAAqByb1JPAAAAEgAAArZmckNBAAAAFgAAAshhcgAAAAAAFAAAAt51a1VBAAAAHAAAAvJoZUlMAAAAFgAAAw56aFRXAAAACgAAAyR2aVZOAAAADgAAAy5za1NLAAAAFgAAAzx6aENOAAAACgAAAyRydVJVAAAAJAAAA1JlbkdCAAAAFAAAA3ZmckZSAAAAFgAAA4ptcwAAAAAAEgAAA6BoaUlOAAAAEgAAA7J0aFRIAAAADAAAA8RjYUVTAAAAGAAAA9BlbkFVAAAAFAAAA3Zlc1hMAAAAEgAAArZkZURFAAAAEAAAA+hlblVTAAAAEgAAA/hwdEJSAAAAGAAABApwbFBMAAAAEgAABCJlbEdSAAAAIgAABDRzdlNFAAAAEAAABFZ0clRSAAAAFAAABGZwdFBUAAAAFgAABHpqYUpQAAAADAAABJAATABDAEQAIAB1ACAAYgBvAGoAac7st+wAIABMAEMARABGAGEAcgBnAGUALQBMAEMARABMAEMARAAgAFcAYQByAG4AYQBTAHoA7QBuAGUAcwAgAEwAQwBEAEIAYQByAGUAdgBuAP0AIABMAEMARABMAEMARAAtAGYAYQByAHYAZQBzAGsA5gByAG0ASwBsAGUAdQByAGUAbgAtAEwAQwBEAFYA5AByAGkALQBMAEMARABMAEMARAAgAGEAIABjAG8AbABvAHIAaQBMAEMARAAgAGEAIABjAG8AbABvAHIATABDAEQAIABjAG8AbABvAHIAQQBDAEwAIABjAG8AdQBsAGUAdQByIA8ATABDAEQAIAZFBkQGSAZGBikEGgQ+BDsETAQ+BEAEPgQyBDgEOQAgAEwAQwBEIA8ATABDAEQAIAXmBdEF4gXVBeAF2V9pgnIATABDAEQATABDAEQAIABNAOAAdQBGAGEAcgBlAGIAbgD9ACAATABDAEQEJgQyBDUEQgQ9BD4EOQAgBBYEGgAtBDQEOARBBD8EOwQ1BDkAQwBvAGwAbwB1AHIAIABMAEMARABMAEMARAAgAGMAbwB1AGwAZQB1AHIAVwBhAHIAbgBhACAATABDAEQJMAkCCRcJQAkoACAATABDAEQATABDAEQAIA4qDjUATABDAEQAIABlAG4AIABjAG8AbABvAHIARgBhAHIAYgAtAEwAQwBEAEMAbwBsAG8AcgAgAEwAQwBEAEwAQwBEACAAQwBvAGwAbwByAGkAZABvAEsAbwBsAG8AcgAgAEwAQwBEA4gDswPHA8EDyQO8A7cAIAO/A7gDzAO9A7cAIABMAEMARABGAOQAcgBnAC0ATABDAEQAUgBlAG4AawBsAGkAIABMAEMARABMAEMARAAgAGEAIABDAG8AcgBlAHMwqzDpMPwATABDAER0ZXh0AAAAAENvcHlyaWdodCBBcHBsZSBJbmMuLCAyMDIxAABYWVogAAAAAAAA8xYAAQAAAAEWylhZWiAAAAAAAABxwAAAOYoAAAFnWFlaIAAAAAAAAGEjAAC55gAAE/ZYWVogAAAAAAAAI/IAAAyQAAC90GN1cnYAAAAAAAAEAAAAAAUACgAPABQAGQAeACMAKAAtADIANgA7AEAARQBKAE8AVABZAF4AYwBoAG0AcgB3AHwAgQCGAIsAkACVAJoAnwCjAKgArQCyALcAvADBAMYAywDQANUA2wDgAOUA6wDwAPYA+wEBAQcBDQETARkBHwElASsBMgE4AT4BRQFMAVIBWQFgAWcBbgF1AXwBgwGLAZIB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" 
                                     alt="Escala de Norwood-Hamilton" 
                                     style="max-width: 100%; height: auto; border-radius: 4px;">
                            </div>
                            
                            <!-- DescriÃ§Ã£o dos graus -->
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px; font-size: 11px;">
                                <div><strong>I:</strong> Normal</div>
                                <div><strong>II:</strong> RecessÃ£o frontotemporal leve</div>
                                <div><strong>IIA:</strong> RecessÃ£o frontal anterior</div>
                                <div><strong>III:</strong> Aprofundamento frontal</div>
                                <div><strong>III VÃ©rtex:</strong> RarefaÃ§Ã£o no vÃ©rtex</div>
                                <div><strong>IIIA:</strong> III + rarefaÃ§Ã£o anterior</div>
                                <div><strong>IV:</strong> RecessÃ£o severa + vÃ©rtex</div>
                                <div><strong>IVA:</strong> IV avanÃ§ado</div>
                                <div><strong>V:</strong> Ponte estreita</div>
                                <div><strong>VA:</strong> V avanÃ§ado</div>
                                <div><strong>VI:</strong> Ponte desaparece</div>
                                <div><strong>VII:</strong> Ferradura completa</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ESCALA LUDWIG (Feminino) -->
                    <div style="margin-bottom: 16px;">
                        <h4 style="color: #ec4899; margin: 0 0 12px 0; font-size: 16px; display: flex; align-items: center; gap: 8px;">
                            ğŸ‘© Escala de Ludwig (Feminino)
                        </h4>
                        <div style="background: #fef2f2; padding: 16px; border-radius: 8px; border: 1px solid #fecaca;">
                            <!-- Imagem da Escala Ludwig -->
                            <div style="text-align: center; background: white; border-radius: 4px; margin-bottom: 12px; padding: 8px;">
                                <img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAkACQAAD/4QCeRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAACQAAAAAQAAAJAAAAABAAOShgAHAAAAEgAAAISgAgAEAAAAAQAAAkygAwAEAAAAAQAAAUgAAAAAQVNDSUkAAABTY3JlZW5zaG90/+EJIWh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPD94cGFja2V0IGVuZD0idyI/PgD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/+IQCElDQ19QUk9GSUxFAAEBAAAP+GFwcGwCEAAAbW50clJHQiBYWVogB+UAAgAJABYAJAA4YWNzcEFQUEwAAAAAQVBQTAAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1hcHBsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASZGVzYwAAAVwAAABiZHNjbQAAAcAAAAScY3BydAAABlwAAAAjd3RwdAAABoAAAAAUclhZWgAABpQAAAAUZ1hZWgAABqgAAAAUYlhZWgAABrwAAAAUclRSQwAABtAAAAgMYWFyZwAADtwAAAAgdmNndAAADvwAAAAwbmRpbgAADywAAAA+Y2hhZAAAD2wAAAAsbW1vZAAAD5gAAAAodmNncAAAD8AAAAA4YlRSQwAABtAAAAgMZ1RSQwAABtAAAAgMYWFiZwAADtwAAAAgYWFnZwAADtwAAAAgZGVzYwAAAAAAAAAIRGlzcGxheQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG1sdWMAAAAAAAAAJgAAAAxockhSAAAAFAAAAdhrb0tSAAAADAAAAexuYk5PAAAAEgAAAfhpZAAAAAAAEgAAAgpodUhVAAAAFAAAAhxjc0NaAAAAFgAAAjBkYURLAAAAHAAAAkZubE5MAAAAFgAAAmJmaUZJAAAAEAAAAnhpdElUAAAAGAAAAohlc0VTAAAAFgAAAqByb1JPAAAAEgAAArZmckNBAAAAFgAAAshhcgAAAAAAFAAAAt51a1VBAAAAHAAAAvJoZUlMAAAAFgAAAw56aFRXAAAACgAAAyR2aVZOAAAADgAAAy5za1NLAAAAFgAAAzx6aENOAAAACgAAAyRydVJVAAAAJAAAA1JlbkdCAAAAFAAAA3ZmckZSAAAAFgAAA4ptcwAAAAAAEgAAA6BoaUlOAAAAEgAAA7J0aFRIAAAADAAAA8RjYUVTAAAAGAAAA9BlbkFVAAAAFAAAA3Zlc1hMAAAAEgAAArZkZURFAAAAEAAAA+hlblVTAAAAEgAAA/hwdEJSAAAAGAAABApwbFBMAAAAEgAABCJlbEdSAAAAIgAABDRzdlNFAAAAEAAABFZ0clRSAAAAFAAABGZwdFBUAAAAFgAABHpqYUpQAAAADAAABJAATABDAEQAIAB1ACAAYgBvAGoAac7st+wAIABMAEMARABGAGEAcgBnAGUALQBMAEMARABMAEMARAAgAFcAYQByAG4AYQBTAHoA7QBuAGUAcwAgAEwAQwBEAEIAYQByAGUAdgBuAP0AIABMAEMARABMAEMARAAtAGYAYQByAHYAZQBzAGsA5gByAG0ASwBsAGUAdQByAGUAbgAtAEwAQwBEAFYA5AByAGkALQBMAEMARABMAEMARAAgAGEAIABjAG8AbABvAHIAaQBMAEMARAAgAGEAIABjAG8AbABvAHIATABDAEQAIABjAG8AbABvAHIAQQBDAEwAIABjAG8AdQBsAGUAdQByIA8ATABDAEQAIAZFBkQGSAZGBikEGgQ+BDsETAQ+BEAEPgQyBDgEOQAgAEwAQwBEIA8ATABDAEQAIAXmBdEF4gXVBeAF2V9pgnIATABDAEQATABDAEQAIABNAOAAdQBGAGEAcgBlAGIAbgD9ACAATABDAEQEJgQyBDUEQgQ9BD4EOQAgBBYEGgAtBDQEOARBBD8EOwQ1BDkAQwBvAGwAbwB1AHIAIABMAEMARABMAEMARAAgAGMAbwB1AGwAZQB1AHIAVwBhAHIAbgBhACAATABDAEQJMAkCCRcJQAkoACAATABDAEQATABDAEQAIA4qDjUATABDAEQAIABlAG4AIABjAG8AbABvAHIARgBhAHIAYgAtAEwAQwBEAEMAbwBsAG8AcgAgAEwAQwBEAEwAQwBEACAAQwBvAGwAbwByAGkAZABvAEsAbwBsAG8AcgAgAEwAQwBEA4gDswPHA8EDyQO8A7cAIAO/A7gDzAO9A7cAIABMAEMARABGAOQAcgBnAC0ATABDAEQAUgBlAG4AawBsAGkAIABMAEMARABMAEMARAAgAGEAIABDAG8AcgBlAHMwqzDpMPwATABDAER0ZXh0AAAAAENvcHlyaWdodCBBcHBsZSBJbmMuLCAyMDIxAABYWVogAAAAAAAA8xYAAQAAAAEWylhZWiAAAAAAAABxwAAAOYoAAAFnWFlaIAAAAAAAAGEjAAC55gAAE/ZYWVogAAAAAAAAI/IAAAyQAAC90GN1cnYAAAAAAAAEAAAAAAUACgAPABQAGQAeACMAKAAtADIANgA7AEAARQBKAE8AVABZAF4AYwBoAG0AcgB3AHwAgQCGAIsAkACVAJoAnwCjAKgArQCyALcAvADBAMYAywDQANUA2wDgAOUA6wDwAPYA+wEBAQcBDQETARkBHwElASsBMgE4AT4BRQFMAVIBWQFgAWcBbgF1AXwBgwGLAZIB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" 
                                     alt="Escala de Ludwig" 
                                     style="max-width: 100%; height: auto; border-radius: 4px;">
                            </div>
                            
                            <!-- DescriÃ§Ã£o dos graus -->
                            <div style="display: grid; grid-template-columns: 1fr; gap: 8px; font-size: 11px;">
                                <div><strong>Grau I:</strong> RarefaÃ§Ã£o mÃ­nima na linha central (raia alargada)</div>
                                <div><strong>Grau II:</strong> Alargamento pronunciado da linha central</div>
                                <div><strong>Grau III:</strong> RarefaÃ§Ã£o difusa no topo com preservaÃ§Ã£o da linha frontal</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- RodapÃ© com informaÃ§Ãµes -->
                    <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid #e5e7eb; font-size: 10px; color: #666; text-align: center;">
                        <p style="margin: 0;">
                            ğŸ’¡ <strong>Dica:</strong> Selecione o sexo do paciente nos campos acima para registrar a classificaÃ§Ã£o correta.
                        </p>
                    </div>
                `;
                
                modal.appendChild(conteudo);
                document.body.appendChild(modal);
                
                // Fechar ao clicar fora
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.remove();
                    }
                });
                
                console.log('ğŸ“Š Modal de escalas aberto');
            },
            
            salvarCampo(containerId, index, campo, valor) {
                const inst = this.instancias[containerId];
                if (!inst) {
                    console.warn(`âš ï¸ InstÃ¢ncia nÃ£o encontrada: ${containerId}`);
                    return;
                }
                if (!inst.regioesMarcadas[index]) {
                    console.warn(`âš ï¸ RegiÃ£o nÃ£o encontrada: index ${index}`);
                    return;
                }
                if (!inst.regioesMarcadas[index].dadosExame) {
                    inst.regioesMarcadas[index].dadosExame = {};
                }
                inst.regioesMarcadas[index].dadosExame[campo] = valor;
                console.log(`ğŸ’¾ [${containerId}] Campo "${campo}" salvo para regiÃ£o ${index}:`, valor.substring(0, 50) + (valor.length > 50 ? '...' : ''));
            },
            
            // ============================================================
            // POOL DE ACHADOS
            // ============================================================
            
            obterPoolAchados() {
                const poolJson = localStorage.getItem('pool_achados_anatomia');
                
                if (!poolJson) {
                    // Primeira vez - criar pool com achados padrÃ£o
                    const achadosPadrao = [
                        'Sem alteraÃ§Ãµes significativas',
                        'Eritema leve',
                        'Eritema moderado',
                        'Edema discreto',
                        'Edema moderado',
                        'Cicatriz pÃ³s-operatÃ³ria',
                        'Cicatriz hipertrÃ³fica',
                        'Assimetria facial',
                        'Ptose palpebral',
                        'Rugas dinÃ¢micas',
                        'Rugas estÃ¡ticas',
                        'Manchas hipercrÃ´micas',
                        'Manchas hipocrÃ´micas',
                        'Flacidez cutÃ¢nea leve',
                        'Flacidez cutÃ¢nea moderada',
                        'Discromia',
                        'Hematoma residual',
                        'Equimose',
                        'Bolsas palpebrais',
                        'Sulcos profundos',
                        'Perda de definiÃ§Ã£o mandibular'
                    ];
                    
                    this.salvarPoolAchados(achadosPadrao);
                    return achadosPadrao;
                }
                
                return JSON.parse(poolJson);
            },
            
            salvarPoolAchados(pool) {
                localStorage.setItem('pool_achados_anatomia', JSON.stringify(pool));
            },
            
            adicionarAoPoolAchados(achado) {
                const pool = this.obterPoolAchados();
                if (!pool.includes(achado)) {
                    pool.push(achado);
                    this.salvarPoolAchados(pool);
                    console.log('âœ… Achado adicionado ao pool:', achado);
                    
                    // Atualizar todos os dropdowns abertos
                    Object.keys(this.instancias).forEach(containerId => {
                        this.popularDropdownsAchados(containerId);
                    });
                }
            },
            
            popularDropdownsAchados(containerId) {
                const pool = this.obterPoolAchados();
                const inst = this.instancias[containerId];
                
                // Popular cada datalist de cada regiÃ£o
                inst.regioesMarcadas.forEach((regiao, index) => {
                    const id = `regiao-${containerId}-${index}`;
                    const input = document.getElementById(`pool-achados-${id}`);
                    const datalist = document.getElementById(`datalist-achados-${id}`);
                    
                    if (input && datalist) {
                        // Salvar valor digitado
                        const valorAtual = input.value;
                        
                        // Limpar e recriar options no datalist
                        datalist.innerHTML = '';
                        
                        pool.forEach(achado => {
                            const option = document.createElement('option');
                            option.value = achado;
                            datalist.appendChild(option);
                        });
                        
                        // Restaurar valor se ainda existe no pool
                        if (valorAtual && pool.includes(valorAtual)) {
                            input.value = valorAtual;
                        }
                    }
                });
            },
            
            inserirAchadoDoPool(containerId, index) {
                const id = `regiao-${containerId}-${index}`;
                const input = document.getElementById(`pool-achados-${id}`);
                const textarea = document.getElementById(`achados-${id}`);
                
                if (!input || !textarea) return;
                
                const achadoDigitado = input.value.trim();
                if (!achadoDigitado) {
                    alert('Digite ou selecione um achado primeiro');
                    return;
                }
                
                // Adicionar ao textarea (nova linha se jÃ¡ tem conteÃºdo)
                const textoAtual = textarea.value.trim();
                if (textoAtual) {
                    textarea.value = textoAtual + '\n' + achadoDigitado;
                } else {
                    textarea.value = achadoDigitado;
                }
                
                // Disparar evento change para salvar
                textarea.dispatchEvent(new Event('change'));
                
                // Limpar input
                input.value = '';
                
                console.log('âœ“ Achado inserido:', achadoDigitado);
            },
            
            gerenciarPoolAchados() {
                // Remover modal anterior se existir
                const modalExistente = document.getElementById('modal-gerenciar-pool-achados');
                if (modalExistente) modalExistente.remove();
                
                const pool = this.obterPoolAchados();
                
                // Criar modal
                const modal = document.createElement('div');
                modal.id = 'modal-gerenciar-pool-achados';
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.5);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10001;
                `;
                
                modal.innerHTML = `
                    <div style="background: white; border-radius: 12px; width: 600px; max-width: 90%; max-height: 80vh; display: flex; flex-direction: column; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                        <!-- HEADER -->
                        <div style="padding: 20px; border-bottom: 2px solid var(--primary); display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="margin: 0; color: var(--primary); font-size: 18px;">
                                ğŸ“‹ Gerenciar Pool de Achados
                            </h3>
                            <button onclick="document.getElementById('modal-gerenciar-pool-achados').remove()" 
                                    style="background: none; border: none; font-size: 24px; cursor: pointer; color: #999; line-height: 1;">
                                âœ•
                            </button>
                        </div>
                        
                        <!-- ADICIONAR NOVO -->
                        <div style="padding: 16px; background: #f8f9fa; border-bottom: 1px solid #e0e0e0;">
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <input type="text" 
                                       id="input-novo-achado-pool" 
                                       placeholder="âœš Digite novo achado..."
                                       style="flex: 1; padding: 10px 14px; border: 2px solid #ddd; border-radius: 6px; font-size: 13px;"
                                       onkeypress="if(event.key==='Enter') AnatomiaAtendimento.adicionarAchadoPoolModal()">
                                <button onclick="AnatomiaAtendimento.adicionarAchadoPoolModal()"
                                        style="padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 13px;">
                                    â• Adicionar
                                </button>
                            </div>
                        </div>
                        
                        <!-- LISTA DE ACHADOS -->
                        <div style="flex: 1; overflow-y: auto; padding: 16px;">
                            <div style="margin-bottom: 8px; color: #666; font-size: 12px; font-weight: 600;">
                                ğŸ“Š ${pool.length} ACHADO${pool.length !== 1 ? 'S' : ''} NO POOL:
                            </div>
                            <div id="lista-pool-achados-modal">
                                <!-- SerÃ¡ preenchido pelo JavaScript -->
                            </div>
                        </div>
                        
                        <!-- FOOTER -->
                        <div style="padding: 16px; border-top: 1px solid #e0e0e0; display: flex; gap: 8px; justify-content: space-between;">
                            <button onclick="AnatomiaAtendimento.limparTodoPoolModal()"
                                    style="padding: 10px 16px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 13px;">
                                ğŸ—‘ï¸ Limpar Tudo
                            </button>
                            <button onclick="document.getElementById('modal-gerenciar-pool-achados').remove()"
                                    style="padding: 10px 24px; background: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 13px;">
                                Fechar
                            </button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                // Renderizar lista
                this.renderizarListaPoolModal();
                
                // Focar no input
                setTimeout(() => {
                    document.getElementById('input-novo-achado-pool')?.focus();
                }, 100);
            },
            
            renderizarListaPoolModal() {
                const pool = this.obterPoolAchados();
                const lista = document.getElementById('lista-pool-achados-modal');
                
                if (!lista) return;
                
                if (pool.length === 0) {
                    lista.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #999;">
                            <div style="font-size: 48px; margin-bottom: 12px;">ğŸ“‹</div>
                            <div style="font-size: 14px;">Pool vazio</div>
                            <div style="font-size: 12px; margin-top: 4px;">Adicione achados acima</div>
                        </div>
                    `;
                    return;
                }
                
                lista.innerHTML = pool.map((achado, index) => `
                    <div style="display: flex; align-items: center; gap: 8px; padding: 10px; background: white; border: 1px solid #e0e0e0; border-radius: 6px; margin-bottom: 6px;">
                        <div style="flex: 1; font-size: 13px; color: #333;">${achado}</div>
                        <button onclick="AnatomiaAtendimento.editarAchadoPoolModal(${index})"
                                style="padding: 6px 10px; background: #ffc107; color: #333; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;"
                                title="Editar">
                            âœï¸
                        </button>
                        <button onclick="AnatomiaAtendimento.deletarAchadoPoolModal(${index})"
                                style="padding: 6px 10px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px;"
                                title="Deletar">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                `).join('');
            },
            
            adicionarAchadoPoolModal() {
                const input = document.getElementById('input-novo-achado-pool');
                const novoAchado = input.value.trim();
                
                if (!novoAchado) {
                    alert('Digite um achado antes de adicionar');
                    input.focus();
                    return;
                }
                
                const pool = this.obterPoolAchados();
                
                // Verificar duplicata
                if (pool.includes(novoAchado)) {
                    alert('âš ï¸ Este achado jÃ¡ existe no pool!');
                    input.value = '';
                    input.focus();
                    return;
                }
                
                // Adicionar ao pool
                pool.push(novoAchado);
                pool.sort(); // Ordenar alfabeticamente
                this.salvarPoolAchados(pool);
                
                // Limpar input
                input.value = '';
                input.focus();
                
                // Atualizar interface
                this.renderizarListaPoolModal();
                this.atualizarContadorModal();
                
                // Atualizar dropdowns em todas as instÃ¢ncias
                Object.keys(this.instancias).forEach(containerId => {
                    this.popularDropdownsAchados(containerId);
                });
                
                console.log('âœ… Achado adicionado ao pool:', novoAchado);
            },
            
            editarAchadoPoolModal(index) {
                const pool = this.obterPoolAchados();
                const achadoAtual = pool[index];
                
                const novoTexto = prompt('Editar achado:', achadoAtual);
                
                if (novoTexto === null) return; // Cancelou
                
                const novoTextoTrimmed = novoTexto.trim();
                
                if (!novoTextoTrimmed) {
                    alert('Achado nÃ£o pode ser vazio');
                    return;
                }
                
                // Verificar se novo texto jÃ¡ existe (e nÃ£o Ã© o mesmo)
                if (novoTextoTrimmed !== achadoAtual && pool.includes(novoTextoTrimmed)) {
                    alert('âš ï¸ Este achado jÃ¡ existe no pool!');
                    return;
                }
                
                // Atualizar
                pool[index] = novoTextoTrimmed;
                pool.sort(); // Reordenar
                this.salvarPoolAchados(pool);
                
                // Atualizar interface
                this.renderizarListaPoolModal();
                
                // Atualizar dropdowns
                Object.keys(this.instancias).forEach(containerId => {
                    this.popularDropdownsAchados(containerId);
                });
                
                console.log('âœ… Achado editado:', achadoAtual, 'â†’', novoTextoTrimmed);
            },
            
            deletarAchadoPoolModal(index) {
                const pool = this.obterPoolAchados();
                const achado = pool[index];
                
                // Deletar sem confirmaÃ§Ã£o (interface jÃ¡ Ã© visual)
                pool.splice(index, 1);
                this.salvarPoolAchados(pool);
                
                // Atualizar interface
                this.renderizarListaPoolModal();
                this.atualizarContadorModal();
                
                // Atualizar dropdowns
                Object.keys(this.instancias).forEach(containerId => {
                    this.popularDropdownsAchados(containerId);
                });
                
                console.log('ğŸ—‘ï¸ Achado removido do pool:', achado);
            },
            
            limparTodoPoolModal() {
                if (!confirm('âš ï¸ Tem certeza que deseja LIMPAR TODO o pool de achados?\n\nIsso nÃ£o pode ser desfeito!')) {
                    return;
                }
                
                localStorage.removeItem('pool_achados_anatomia');
                
                // Atualizar interface
                this.renderizarListaPoolModal();
                this.atualizarContadorModal();
                
                // Atualizar dropdowns
                Object.keys(this.instancias).forEach(containerId => {
                    this.popularDropdownsAchados(containerId);
                });
                
                console.log('ğŸ—‘ï¸ Pool limpo completamente');
            },
            
            atualizarContadorModal() {
                const pool = this.obterPoolAchados();
                const modalHeader = document.querySelector('#modal-gerenciar-pool-achados h3');
                const contador = document.querySelector('#lista-pool-achados-modal').previousElementSibling;
                
                if (modalHeader) {
                    modalHeader.innerHTML = `ğŸ“‹ Gerenciar Pool de Achados (${pool.length})`;
                }
                
                if (contador) {
                    contador.textContent = `ğŸ“Š ${pool.length} ACHADO${pool.length !== 1 ? 'S' : ''} NO POOL:`;
                }
            },
            
            removerRegiao(containerId, index) {
                const inst = this.instancias[containerId];
                const regiaoRemovida = inst.regioesMarcadas[index];
                
                if (confirm(`Remover "${regiaoRemovida.nome}"?`)) {
                    console.log(`ğŸ—‘ï¸ Removendo regiÃ£o: ${regiaoRemovida.nome}`);
                    
                    // Remover do array
                    inst.regioesMarcadas.splice(index, 1);
                    
                    // RegiÃ£o automaticamente volta ao pool (pode ser reselecionada)
                    console.log(`âœ… RegiÃ£o devolvida ao pool e pode ser selecionada novamente`);
                    
                    // Redesenhar interface
                    this.renderizarAtlas(containerId);
                }
            },
            
            desmarcarRegiao(containerId, nome) {
                const inst = this.instancias[containerId];
                inst.regioesMarcadas = inst.regioesMarcadas.filter(r => r.nome !== nome);
                this.renderizarAtlas(containerId);
            },
            
            // ============================================================
            // EDITOR DE ÃREAS CUSTOMIZADAS
            // ============================================================
            
            abrirEditorCustomizado(containerId) {
                const inst = this.instancias[containerId];
                const editor = document.getElementById(`editor-customizado-${containerId}`);
                
                editor.style.display = 'block';
                
                // Inicializar estado do editor
                inst.editorCustomizado = {
                    ativo: true,
                    vista: 'Anterior',
                    pontosTemp: [],
                    cor: '#ff9800'
                };
                
                // Popular dropdown de regiÃ£o pai
                this.popularDropdownPai(containerId);
                
                // Popular dropdown de templates
                this.popularDropdownTemplate(containerId);
                
                // Destacar botÃ£o da vista anterior
                this.selecionarVistaCustomizada(containerId, 'Anterior');
                
                // Adicionar eventos de clique nos SVGs
                this.bindEventosCustomizados(containerId);
            },
            
            popularDropdownPai(containerId) {
                const select = document.getElementById(`custom-pai-${containerId}`);
                if (!select) return;
                
                // Limpar opÃ§Ãµes exceto a primeira
                select.innerHTML = '<option value="">Nenhum (raiz)</option>';
                
                // Adicionar todas as regiÃµes existentes
                if (ATLAS_ANATOMICO && ATLAS_ANATOMICO.regioes) {
                    const regioesUnicas = {};
                    ATLAS_ANATOMICO.regioes.forEach(r => {
                        if (!regioesUnicas[r.nome]) {
                            regioesUnicas[r.nome] = r;
                        }
                    });
                    
                    Object.values(regioesUnicas).forEach(regiao => {
                        const option = document.createElement('option');
                        option.value = regiao.id;
                        option.textContent = `${regiao.nome} (${regiao.grupo})`;
                        select.appendChild(option);
                    });
                }
            },
            
            popularDropdownTemplate(containerId) {
                const select = document.getElementById(`custom-template-${containerId}`);
                if (!select) return;
                
                // Limpar opÃ§Ãµes exceto a primeira
                select.innerHTML = '<option value="">Nenhuma (sÃ³ marcar)</option>';
                
                // Adicionar templates disponÃ­veis
                if (typeof TEMPLATES_DISPONIVEIS !== 'undefined') {
                    Object.values(TEMPLATES_DISPONIVEIS).forEach(template => {
                        const option = document.createElement('option');
                        option.value = template.id;
                        option.textContent = template.nome;
                        select.appendChild(option);
                    });
                }
            },
            
            selecionarVistaCustomizada(containerId, vista) {
                const inst = this.instancias[containerId];
                if (!inst.editorCustomizado) return;
                
                inst.editorCustomizado.vista = vista;
                
                // Atualizar botÃµes
                const btnAnt = document.getElementById(`btn-custom-anterior-${containerId}`);
                const btnPost = document.getElementById(`btn-custom-posterior-${containerId}`);
                
                if (vista === 'Anterior') {
                    btnAnt.classList.remove('btn-secondary');
                    btnAnt.classList.add('btn-primary');
                    btnPost.classList.remove('btn-primary');
                    btnPost.classList.add('btn-secondary');
                } else {
                    btnPost.classList.remove('btn-secondary');
                    btnPost.classList.add('btn-primary');
                    btnAnt.classList.remove('btn-primary');
                    btnAnt.classList.add('btn-secondary');
                }
            },
            
            bindEventosCustomizados(containerId) {
                const inst = this.instancias[containerId];
                const svgCompleto = document.getElementById(`svg-atlas-completo-${containerId}`);
                
                if (!svgCompleto) return;
                
                const handlerClick = (e) => {
                    if (!inst.editorCustomizado || !inst.editorCustomizado.ativo) return;
                    
                    const rect = svgCompleto.getBoundingClientRect();
                    
                    // Calcular coordenadas relativas ao viewBox
                    const viewBox = svgCompleto.viewBox.baseVal;
                    const x = viewBox.x + ((e.clientX - rect.left) / rect.width) * viewBox.width;
                    const y = viewBox.y + ((e.clientY - rect.top) / rect.height) * viewBox.height;
                    
                    // Determinar vista baseado na posiÃ§Ã£o X (metade = 350)
                    const vista = x < 350 ? 'Anterior' : 'Posterior';
                    
                    if (inst.editorCustomizado.vista === vista) {
                        this.adicionarPontoCustomizado(containerId, x, y, vista);
                    }
                };
                
                svgCompleto.addEventListener('click', handlerClick);
            },
            
            adicionarPontoCustomizado(containerId, x, y, vista) {
                const inst = this.instancias[containerId];
                if (!inst.editorCustomizado) return;
                
                inst.editorCustomizado.pontosTemp.push({x, y, vista});
                
                // Atualizar contador
                document.getElementById(`custom-total-pontos-${containerId}`).textContent = 
                    inst.editorCustomizado.pontosTemp.length;
                
                // Renderizar pontos temporÃ¡rios
                this.renderizarPontosTemporarios(containerId);
            },
            
            renderizarPontosTemporarios(containerId) {
                const inst = this.instancias[containerId];
                if (!inst.editorCustomizado) return;
                
                const vista = inst.editorCustomizado.vista;
                const sufixo = vista.toLowerCase();
                const svg = document.getElementById(`svg-atlas-${sufixo}-${containerId}`);
                
                // Remover desenho anterior
                let gTemp = svg.querySelector('#temp-drawing');
                if (gTemp) gTemp.remove();
                
                gTemp = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                gTemp.setAttribute('id', 'temp-drawing');
                
                const pontosDaVista = inst.editorCustomizado.pontosTemp.filter(p => p.vista === vista);
                
                if (pontosDaVista.length > 0) {
                    // Desenhar pontos
                    pontosDaVista.forEach(p => {
                        const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        circle.setAttribute('cx', p.x);
                        circle.setAttribute('cy', p.y);
                        circle.setAttribute('r', '3');
                        circle.setAttribute('fill', '#ff9800');
                        circle.setAttribute('stroke', '#e65100');
                        circle.setAttribute('stroke-width', '1');
                        gTemp.appendChild(circle);
                    });
                    
                    // Desenhar linhas conectando
                    if (pontosDaVista.length > 1) {
                        const pointsStr = pontosDaVista.map(p => `${p.x},${p.y}`).join(' ');
                        const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
                        polyline.setAttribute('points', pointsStr);
                        polyline.setAttribute('fill', 'none');
                        polyline.setAttribute('stroke', '#ff9800');
                        polyline.setAttribute('stroke-width', '2');
                        gTemp.appendChild(polyline);
                    }
                }
                
                svg.appendChild(gTemp);
            },
            
            desfazerUltimoPonto(containerId) {
                const inst = this.instancias[containerId];
                if (!inst.editorCustomizado || inst.editorCustomizado.pontosTemp.length === 0) return;
                
                inst.editorCustomizado.pontosTemp.pop();
                
                // Atualizar contador
                document.getElementById(`custom-total-pontos-${containerId}`).textContent = 
                    inst.editorCustomizado.pontosTemp.length;
                
                this.renderizarPontosTemporarios(containerId);
            },
            
            finalizarAreaCustomizada(containerId) {
                const inst = this.instancias[containerId];
                if (!inst.editorCustomizado) return;
                
                const nome = document.getElementById(`custom-nome-${containerId}`).value.trim();
                const grupo = document.getElementById(`custom-grupo-${containerId}`).value.trim() || 'Ãreas Customizadas';
                const cor = document.getElementById(`custom-cor-${containerId}`).value;
                const paiId = document.getElementById(`custom-pai-${containerId}`).value;
                const templateId = document.getElementById(`custom-template-${containerId}`).value;
                
                if (!nome) {
                    alert('Por favor, dÃª um nome para a Ã¡rea customizada.');
                    return;
                }
                
                if (inst.editorCustomizado.pontosTemp.length < 3) {
                    alert('Ã‰ necessÃ¡rio marcar pelo menos 3 pontos.');
                    return;
                }
                
                // Calcular nÃ­vel baseado no pai
                let nivel = 0;
                if (paiId && ATLAS_ANATOMICO && ATLAS_ANATOMICO.regioes) {
                    const regiaoPai = ATLAS_ANATOMICO.regioes.find(r => r.id === paiId);
                    if (regiaoPai) {
                        nivel = (regiaoPai.nivel || 0) + 1;
                    }
                }
                
                // Criar regiÃ£o customizada para cada vista que tenha pontos
                ['Anterior', 'Posterior'].forEach(vista => {
                    const pontosDaVista = inst.editorCustomizado.pontosTemp.filter(p => p.vista === vista);
                    
                    if (pontosDaVista.length >= 3) {
                        const pointsStr = pontosDaVista.map(p => `${p.x},${p.y}`).join(' ');
                        const novaRegiaoId = `custom-${Date.now()}-${vista.toLowerCase()}`;
                        
                        const novaRegiao = {
                            id: novaRegiaoId,
                            nome: nome,
                            grupo: grupo,
                            vista: vista,
                            cor: cor,
                            points: pointsStr,
                            customizada: true,
                            pai: paiId || null,
                            nivel: nivel,
                            template: templateId || null,
                            filhos: []
                        };
                        
                        // Adicionar Ã  lista de regiÃµes marcadas
                        inst.regioesMarcadas.push({
                            id: novaRegiaoId,
                            nome: nome,
                            grupo: grupo,
                            vista: vista,
                            cor: cor,
                            customizada: true,
                            points: pointsStr,
                            timestamp: new Date().toISOString()
                        });
                        
                        // Adicionar ao ATLAS_ANATOMICO para renderizar
                        ATLAS_ANATOMICO.regioes.push(novaRegiao);
                        
                        // Atualizar filhos do pai
                        if (paiId) {
                            const regiaoPai = ATLAS_ANATOMICO.regioes.find(r => r.id === paiId);
                            if (regiaoPai && !regiaoPai.filhos.includes(novaRegiaoId)) {
                                regiaoPai.filhos.push(novaRegiaoId);
                            }
                        }
                    }
                });
                
                console.log('âœ… RegiÃ£o criada com hierarquia:', { nome, pai: paiId, nivel, template: templateId });
                
                // Fechar editor
                this.cancelarEditorCustomizado(containerId);
                
                // Renderizar
                this.renderizarAtlas(containerId);
            },
            
            cancelarEditorCustomizado(containerId) {
                const inst = this.instancias[containerId];
                const editor = document.getElementById(`editor-customizado-${containerId}`);
                
                editor.style.display = 'none';
                
                // Limpar estado
                inst.editorCustomizado = null;
                
                // Limpar campos
                document.getElementById(`custom-nome-${containerId}`).value = '';
                document.getElementById(`custom-grupo-${containerId}`).value = '';
                document.getElementById(`custom-cor-${containerId}`).value = '#ff9800';
                document.getElementById(`custom-total-pontos-${containerId}`).textContent = '0';
                
                // Limpar dropdowns de hierarquia
                const selectPai = document.getElementById(`custom-pai-${containerId}`);
                const selectTemplate = document.getElementById(`custom-template-${containerId}`);
                if (selectPai) selectPai.selectedIndex = 0;
                if (selectTemplate) selectTemplate.selectedIndex = 0;
                
                // Limpar desenhos temporÃ¡rios
                ['anterior', 'posterior'].forEach(sufixo => {
                    const svg = document.getElementById(`svg-atlas-${sufixo}-${containerId}`);
                    const gTemp = svg.querySelector('#temp-drawing');
                    if (gTemp) gTemp.remove();
                });
            },
            
            // ============================================================
            // EXPORTAR/IMPORTAR DADOS DO ATLAS
            // ============================================================
            
            exportarAtlasJSON(containerId) {
                const inst = this.instancias[containerId];
                
                // Preparar dados para exportaÃ§Ã£o
                const dadosExportacao = {
                    versao: '10.155',
                    dataExportacao: new Date().toISOString(),
                    paciente: {
                        nome: inst.dadosPaciente?.nome || 'NÃ£o informado',
                        prontuario: inst.dadosPaciente?.prontuario || 'NÃ£o informado'
                    },
                    regioesMarcadas: inst.regioesMarcadas,
                    totalRegioes: inst.regioesMarcadas.length,
                    // Separar por categoria
                    categorias: this.categorizarRegioes(inst.regioesMarcadas)
                };
                
                // Converter para JSON formatado
                const jsonString = JSON.stringify(dadosExportacao, null, 2);
                
                // Criar blob e fazer download
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                
                // Nome do arquivo com data/hora
                const dataHora = new Date().toISOString().replace(/[:.]/g, '-').substring(0, 19);
                a.download = `atlas-anatomico-${dataHora}.json`;
                
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert(`âœ… JSON exportado com sucesso!\n\nğŸ“Š Total de regiÃµes: ${dadosExportacao.totalRegioes}`);
            },
            
            importarAtlasJSON(containerId, inputElement) {
                const file = inputElement.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const dados = JSON.parse(e.target.result);
                        
                        // Validar estrutura do JSON
                        if (!dados.regioesMarcadas || !Array.isArray(dados.regioesMarcadas)) {
                            throw new Error('Estrutura de JSON invÃ¡lida');
                        }
                        
                        const inst = this.instancias[containerId];
                        
                        // Perguntar se quer substituir ou adicionar
                        const substituir = confirm(
                            `ğŸ“¥ Importar dados do atlas?\n\n` +
                            `Arquivo: ${file.name}\n` +
                            `VersÃ£o: ${dados.versao || 'desconhecida'}\n` +
                            `Data: ${dados.dataExportacao ? new Date(dados.dataExportacao).toLocaleString('pt-BR') : 'desconhecida'}\n` +
                            `RegiÃµes: ${dados.totalRegioes || dados.regioesMarcadas.length}\n\n` +
                            `âš ï¸ Clique OK para SUBSTITUIR as marcaÃ§Ãµes atuais\n` +
                            `Clique CANCELAR para ADICIONAR Ã s marcaÃ§Ãµes existentes`
                        );
                        
                        if (substituir) {
                            // Substituir completamente
                            inst.regioesMarcadas = dados.regioesMarcadas;
                        } else {
                            // Adicionar sem duplicar
                            dados.regioesMarcadas.forEach(regiao => {
                                const jaExiste = inst.regioesMarcadas.some(r => 
                                    r.nome === regiao.nome && r.vista === regiao.vista
                                );
                                if (!jaExiste) {
                                    inst.regioesMarcadas.push(regiao);
                                }
                            });
                        }
                        
                        // Adicionar regiÃµes customizadas ao ATLAS_ANATOMICO
                        const customizadas = dados.regioesMarcadas.filter(r => r.customizada);
                        customizadas.forEach(regiao => {
                            const jaExisteNoAtlas = ATLAS_ANATOMICO.regioes.some(r => 
                                r.nome === regiao.nome && r.vista === regiao.vista
                            );
                            if (!jaExisteNoAtlas) {
                                ATLAS_ANATOMICO.regioes.push(regiao);
                            }
                        });
                        
                        // Renderizar
                        this.renderizarAtlas(containerId);
                        
                        alert(`âœ… Dados importados com sucesso!\n\nğŸ“Š Total de regiÃµes marcadas: ${inst.regioesMarcadas.length}`);
                        
                    } catch (error) {
                        alert(`âŒ Erro ao importar JSON:\n\n${error.message}\n\nVerifique se o arquivo estÃ¡ correto.`);
                    }
                };
                
                reader.readAsText(file);
                
                // Limpar input para permitir reimportaÃ§Ã£o do mesmo arquivo
                inputElement.value = '';
            },
            
            categorizarRegioes(regioesMarcadas) {
                const regioesPorNome = {};
                regioesMarcadas.forEach(r => {
                    if (!regioesPorNome[r.nome]) {
                        regioesPorNome[r.nome] = {
                            nome: r.nome,
                            grupo: r.grupo,
                            cor: r.cor,
                            vistas: []
                        };
                    }
                    regioesPorNome[r.nome].vistas.push(r.vista);
                });
                
                const ambasVistas = [];
                const soFrente = [];
                const soCostas = [];
                
                Object.values(regioesPorNome).forEach(r => {
                    const temAnterior = r.vistas.includes('Anterior');
                    const temPosterior = r.vistas.includes('Posterior');
                    
                    if (temAnterior && temPosterior) {
                        ambasVistas.push(r.nome);
                    } else if (temAnterior) {
                        soFrente.push(r.nome);
                    } else if (temPosterior) {
                        soCostas.push(r.nome);
                    }
                });
                
                return {
                    ambasVistas,
                    soFrente,
                    soCostas
                };
            },
            
            // ============================================================
            // FUNÃ‡Ã•ES DO MODO DESENHO LIVRE (original)
            // ============================================================
            
            bindEventos(id) {
                const svg = document.getElementById(`svg-anatomia-${id}`);
                if (!svg) return;
                
                svg.addEventListener('click', (e) => {
                    if (!this.instancias[id].desenhando) return;
                    
                    const rect = svg.getBoundingClientRect();
                    const x = ((e.clientX - rect.left) / rect.width) * 700;
                    const y = ((e.clientY - rect.top) / rect.height) * 1200;
                    
                    this.adicionarPonto(id, x, y);
                });
            },
            
            selecionarCor(id, cor) {
                this.instancias[id].corAtual = cor;
                
                // Atualizar visual
                document.querySelectorAll(`.cor-opcao-${id}`).forEach(el => {
                    el.style.border = '2px solid transparent';
                });
                event.target.style.border = '2px solid #000';
            },
            
            iniciarDesenho(id) {
                const nome = document.getElementById(`anatomia-nome-${id}`).value.trim();
                if (!nome) {
                    alert('Digite um nome para a regiÃ£o!');
                    return;
                }
                
                this.instancias[id].desenhando = true;
                this.instancias[id].pontosTemp = [];
                this.instancias[id].nomeTemp = nome;
                
                document.getElementById(`btn-iniciar-${id}`).style.display = 'none';
                document.getElementById(`controles-desenho-${id}`).style.display = 'block';
            },
            
            adicionarPonto(id, x, y) {
                const inst = this.instancias[id];
                inst.pontosTemp.push([x, y]);
                
                // Desenhar pontinho
                const g = document.getElementById(`desenho-temp-${id}`);
                const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                circle.setAttribute('cx', x);
                circle.setAttribute('cy', y);
                circle.setAttribute('r', '4');
                circle.setAttribute('fill', inst.corAtual);
                circle.setAttribute('stroke', '#000');
                circle.setAttribute('stroke-width', '1');
                g.appendChild(circle);
                
                // Desenhar linha se tiver mais de 1 ponto
                if (inst.pontosTemp.length > 1) {
                    const [x1, y1] = inst.pontosTemp[inst.pontosTemp.length - 2];
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', x1);
                    line.setAttribute('y1', y1);
                    line.setAttribute('x2', x);
                    line.setAttribute('y2', y);
                    line.setAttribute('stroke', inst.corAtual);
                    line.setAttribute('stroke-width', '2');
                    g.appendChild(line);
                }
            },
            
            finalizarDesenho(id) {
                const inst = this.instancias[id];
                
                if (inst.pontosTemp.length < 3) {
                    alert('Marque pelo menos 3 pontos!');
                    return;
                }
                
                // Criar regiÃ£o
                const regiao = {
                    id: Date.now(),
                    nome: inst.nomeTemp,
                    cor: inst.corAtual,
                    pontos: [...inst.pontosTemp]
                };
                
                inst.regioes.push(regiao);
                
                // Limpar desenho temporÃ¡rio
                document.getElementById(`desenho-temp-${id}`).innerHTML = '';
                
                // Redesenhar tudo
                this.redesenhar(id);
                this.atualizarLista(id);
                
                // Resetar estado
                inst.desenhando = false;
                inst.pontosTemp = [];
                document.getElementById(`anatomia-nome-${id}`).value = '';
                document.getElementById(`btn-iniciar-${id}`).style.display = 'block';
                document.getElementById(`controles-desenho-${id}`).style.display = 'none';
            },
            
            cancelarDesenho(id) {
                const inst = this.instancias[id];
                
                // Limpar desenho temporÃ¡rio
                document.getElementById(`desenho-temp-${id}`).innerHTML = '';
                
                // Resetar estado
                inst.desenhando = false;
                inst.pontosTemp = [];
                document.getElementById(`btn-iniciar-${id}`).style.display = 'block';
                document.getElementById(`controles-desenho-${id}`).style.display = 'none';
            },
            
            redesenhar(id) {
                const g = document.getElementById(`regioes-${id}`);
                if (!g) return;
                
                g.innerHTML = '';
                
                this.instancias[id].regioes.forEach(regiao => {
                    // Criar polÃ­gono
                    const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                    const pontos = regiao.pontos.map(p => p.join(',')).join(' ');
                    polygon.setAttribute('points', pontos);
                    polygon.setAttribute('fill', regiao.cor);
                    polygon.setAttribute('fill-opacity', '0.3');
                    polygon.setAttribute('stroke', regiao.cor);
                    polygon.setAttribute('stroke-width', '2');
                    g.appendChild(polygon);
                });
            },
            
            atualizarLista(id) {
                const lista = document.getElementById(`lista-regioes-${id}`);
                const total = document.getElementById(`total-regioes-${id}`);
                const regioes = this.instancias[id].regioes;
                
                total.textContent = regioes.length;
                
                if (regioes.length === 0) {
                    lista.innerHTML = '<p style="text-align: center; color: #999; font-size: 13px; padding: 20px 0;">Nenhuma regiÃ£o marcada</p>';
                    return;
                }
                
                lista.innerHTML = regioes.map((r, idx) => `
                    <div style="padding: 8px; margin-bottom: 4px; background: white; border-radius: 4px; border-left: 4px solid ${r.cor}; display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-size: 13px; font-weight: 600;">${r.nome}</span>
                        <button onclick="AnatomiaAtendimento.removerRegiaoAtlas('${id}', ${idx})" 
                                style="background: none; border: none; color: var(--danger); cursor: pointer; padding: 4px 8px;">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                `).join('');
            },
            
            removerRegiaoAtlas(id, idx) {
                if (confirm('Remover esta regiÃ£o?')) {
                    this.instancias[id].regioes.splice(idx, 1);
                    this.redesenhar(id);
                    this.atualizarLista(id);
                }
            },
            
            carregarTemplate(id, template) {
                const templates = {
                    
                    // TEMPLATE: QUEIMADURAS - REGRA DOS 9
                    // TEMPLATE: CIRURGIA PLÃSTICA - REGIÃ•ES FACIAIS
                    // TEMPLATE: DERMATOLOGIA - REGIÃ•ES CUTÃ‚NEAS
                    // TEMPLATE: TRAUMATOLOGIA - SISTEMA MÃšSCULO-ESQUELÃ‰TICO
                    // TEMPLATE: ATLAS ANATÃ”MICO MACRO - 18 RegiÃµes Base
                    'atlas_completo': (function() {
                        // Converter polÃ­gonos do ATLAS_ANATOMICO para formato de template
                        const regioes = [];
                        let idCounter = Date.now();
                        
                        if (ATLAS_ANATOMICO && ATLAS_ANATOMICO.regioes) {
                            ATLAS_ANATOMICO.regioes.forEach(regiao => {
                                // Converter string "x1,y1 x2,y2 x3,y3" para array [[x1,y1], [x2,y2], [x3,y3]]
                                const pontosString = regiao.points || '';
                                const coordenadas = pontosString.trim().split(/\s+/);
                                const pontos = coordenadas.map(coord => {
                                    const [x, y] = coord.split(',').map(Number);
                                    return [x, y];
                                });
                                
                                if (pontos.length >= 3) {
                                    regioes.push({
                                        id: idCounter++,
                                        nome: regiao.nome,
                                        cor: regiao.cor || '#3b82f6',
                                        pontos: pontos
                                    });
                                }
                            });
                        }
                        
                        console.log(`ğŸ¯ Atlas Completo: ${regioes.length} regiÃµes convertidas`);
                        return regioes;
                    })()
                };
                
                // Carregar regiÃµes do template selecionado
                const regioesTemplate = templates[template];
                if (regioesTemplate) {
                    this.instancias[id].regioes = JSON.parse(JSON.stringify(regioesTemplate));
                    this.redesenhar(id);
                    this.atualizarLista(id);
                    console.log(`âœ… Template "${template}" carregado com ${regioesTemplate.length} regiÃµes`);
                }
                // Se template nÃ£o encontrado, simplesmente ignorar (usuÃ¡rio pode nÃ£o ter configurado)
            },
            
            obterDados(id) {
                const inst = this.instancias[id];
                if (!inst) {
                    console.warn(`âš ï¸ [obterDados] InstÃ¢ncia nÃ£o encontrada: ${id}`);
                    return { modo: 'atlas', regioesMarcadas: [] };
                }
                
                console.log(`ğŸ“¤ [obterDados] Coletando dados de ${id}, modo: ${inst.modo}`);
                
                if (inst.modo === 'atlas') {
                    const dados = {
                        modo: 'atlas',
                        regioesMarcadas: JSON.parse(JSON.stringify(inst.regioesMarcadas || []))
                    };
                    console.log(`ğŸ“¤ [obterDados] ${dados.regioesMarcadas.length} regiÃµes encontradas`);
                    dados.regioesMarcadas.forEach((r, i) => {
                        console.log(`   ${i}: ${r.nome} - achados: "${r.dadosExame?.achados || '(vazio)'}"`);
                    });
                    return dados;
                } else {
                    return {
                        modo: 'livre',
                        regioes: JSON.parse(JSON.stringify(inst.regioes || []))
                    };
                }
            },
            
            validar(id) {
                const inst = this.instancias[id];
                const config = inst?.config || {};
                
                if (!inst) {
                    return { valido: false, mensagem: 'MÃ³dulo nÃ£o inicializado!' };
                }
                
                if (inst.modo === 'atlas') {
                    const marcadas = inst.regioesMarcadas || [];
                    if (config.obrigatorio && marcadas.length === 0) {
                        return { valido: false, mensagem: 'Marque pelo menos uma regiÃ£o anatÃ´mica!' };
                    }
                } else {
                    const regioes = inst.regioes || [];
                    if (config.obrigatorio && regioes.length === 0) {
                        return { valido: false, mensagem: 'Marque pelo menos uma regiÃ£o anatÃ´mica!' };
                    }
                }
                
                return { valido: true };
            },
            
            // ============================================================
            // [QUEIMADOS] FUNÃ‡Ã•ES DE AVALIAÃ‡ÃƒO DE QUEIMADOS
            // ============================================================
            
            // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            // CARREGAR DADOS DO PACIENTE AUTOMATICAMENTE
            // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            
            carregarDadosPaciente(containerId) {
                try {
                    // Buscar atendimento atual
                    const atendimentoId = ExameFisico.atendimentoAtualId;
                    if (!atendimentoId) {
                        console.log('âš ï¸ Nenhum atendimento em andamento');
                        return;
                    }
                    
                    const atendimento = SistemaCore.dados.atendimentos.find(a => a.id === atendimentoId);
                    if (!atendimento) {
                        console.log('âš ï¸ Atendimento nÃ£o encontrado');
                        return;
                    }
                    
                    // Buscar paciente
                    const paciente = SistemaCore.dados.pacientes.find(p => p.id === atendimento.paciente_id);
                    if (!paciente) {
                        console.log('âš ï¸ Paciente nÃ£o encontrado');
                        return;
                    }
                    
                    // 1ï¸âƒ£ CARREGAR PESO DE ANTROPOMETRIA â†’ Peso (kg)
                    // Caminho: atendimento.exame_fisico.antropometria.peso
                    const pesoInput = document.getElementById(`peso-paciente-${containerId}`);
                    if (pesoInput) {
                        const peso = atendimento.exame_fisico?.antropometria?.peso;
                        if (peso && peso.trim() !== '') {
                            pesoInput.value = parseFloat(peso) || 70;
                            console.log(`âœ… Peso carregado de Antropometria: ${peso} kg`);
                        } else {
                            console.log('â„¹ï¸ Peso nÃ£o encontrado em Antropometria, mantendo padrÃ£o: 70 kg');
                        }
                    }
                    
                    // 2ï¸âƒ£ CARREGAR IDADE CALCULADA DA DATA DE NASCIMENTO (DN)
                    // Caminho: paciente.nascimento â†’ calcularIdade()
                    const idadeInput = document.getElementById(`idade-paciente-${containerId}`);
                    if (idadeInput && paciente.nascimento) {
                        const idade = Pacientes.calcularIdade(paciente.nascimento);
                        idadeInput.value = idade;
                        console.log(`âœ… Idade calculada da DN (${paciente.nascimento}): ${idade} anos`);
                        
                        // 3ï¸âƒ£ ATUALIZAR PROTOCOLOS COM A IDADE CARREGADA
                        this.atualizarProtocolos(containerId);
                    } else {
                        console.log('â„¹ï¸ Data de nascimento nÃ£o encontrada, mantendo idade padrÃ£o: 30 anos');
                    }
                    
                } catch (error) {
                    console.error('âŒ Erro ao carregar dados do paciente:', error);
                }
            },
            
            trocarContexto(containerId, contexto) {
                const inst = this.instancias[containerId];
                if (!inst) return;
                
                inst.contexto = contexto;
                
                // Atualizar visual dos botÃµes (sÃ³ se existirem - modo simplificado nÃ£o tem)
                const btnAnatomico = document.getElementById(`btn-contexto-anatomico-${containerId}`);
                const btnQueimados = document.getElementById(`btn-contexto-queimados-${containerId}`);
                const painelQueimados = document.getElementById(`painel-queimados-${containerId}`);
                
                if (contexto === 'anatomico') {
                    // BotÃµes sÃ³ existem se nÃ£o for modo simplificado
                    if (btnAnatomico) {
                        btnAnatomico.style.background = '#667eea';
                        btnAnatomico.style.color = 'white';
                    }
                    if (btnQueimados) {
                        btnQueimados.style.background = 'white';
                        btnQueimados.style.color = '#ff6b6b';
                    }
                    if (painelQueimados) painelQueimados.style.display = 'none';
                    
                    // âœ… MOSTRAR GRUPOS ANATÃ”MICOS, ESCONDER QUEIMADURAS
                    ['anterior', 'posterior'].forEach(vista => {
                        const gAna = document.getElementById(`regioes-${vista}-anatomico-${containerId}`);
                        const gQue = document.getElementById(`regioes-${vista}-queimaduras-${containerId}`);
                        if (gAna) gAna.style.display = '';
                        if (gQue) gQue.style.display = 'none';
                    });
                    
                    // âœ… MOSTRAR LISTA ANATÃ”MICA, ESCONDER LISTA QUEIMADURAS
                    const painelListaAna = document.getElementById(`painel-lista-anatomico-${containerId}`);
                    const painelListaQue = document.getElementById(`painel-lista-queimaduras-${containerId}`);
                    if (painelListaAna) painelListaAna.style.display = 'block';
                    if (painelListaQue) painelListaQue.style.display = 'none';
                    
                    // Esconder canvas
                    const canvas = document.getElementById(`canvas-queimados-${containerId}`);
                    if (canvas) {
                        canvas.style.display = 'none';
                        canvas.style.pointerEvents = 'none';
                    }
                    
                    // âœ… ESCONDER FERRAMENTAS DE QUEIMADOS
                    const ferramentasQueimados = document.getElementById(`ferramentas-queimados-${containerId}`);
                    if (ferramentasQueimados) ferramentasQueimados.style.display = 'none';
                    
                    // âœ… ESCONDER RESULTADOS (% SCQ + PARKLAND)
                    const resultadosQueimados = document.getElementById(`resultados-queimados-${containerId}`);
                    if (resultadosQueimados) resultadosQueimados.style.display = 'none';
                    
                    // âœ… ESCONDER PROTOCOLOS COMPLETOS
                    const protocolosQueimados = document.getElementById(`protocolos-queimados-${containerId}`);
                    if (protocolosQueimados) protocolosQueimados.style.display = 'none';
                    
                    // Carregar atlas anatÃ´mico (CÃ“PIA PROFUNDA para evitar referÃªncias compartilhadas!)
                    inst.atlasAtual = deepCopyAtlas(ATLAS_ANATOMICO);
                } else {
                    // BotÃµes sÃ³ existem se nÃ£o for modo simplificado
                    if (btnAnatomico) {
                        btnAnatomico.style.background = 'white';
                        btnAnatomico.style.color = '#667eea';
                    }
                    if (btnQueimados) {
                        btnQueimados.style.background = '#ff6b6b';
                        btnQueimados.style.color = 'white';
                    }
                    if (painelQueimados) painelQueimados.style.display = 'block';
                    
                    // âœ… CARREGAR PESO E IDADE AUTOMATICAMENTE DAS ANOTAÃ‡Ã•ES
                    this.carregarDadosPaciente(containerId);
                    
                    // âœ… ESCONDER GRUPOS ANATÃ”MICOS, MOSTRAR QUEIMADURAS
                    ['anterior', 'posterior'].forEach(vista => {
                        const gAna = document.getElementById(`regioes-${vista}-anatomico-${containerId}`);
                        const gQue = document.getElementById(`regioes-${vista}-queimaduras-${containerId}`);
                        if (gAna) gAna.style.display = 'none';
                        if (gQue) gQue.style.display = '';
                    });
                    
                    // âœ… ESCONDER LISTA ANATÃ”MICA, MOSTRAR LISTA QUEIMADURAS
                    const painelListaAna = document.getElementById(`painel-lista-anatomico-${containerId}`);
                    const painelListaQue = document.getElementById(`painel-lista-queimaduras-${containerId}`);
                    if (painelListaAna) painelListaAna.style.display = 'none';
                    if (painelListaQue) painelListaQue.style.display = 'block';
                    
                    // Carregar atlas de queimados (padrÃ£o Regra dos 9) - CÃ“PIA PROFUNDA!
                    inst.atlasAtual = deepCopyAtlas(ATLAS_QUEIMADOS);
                    inst.metodoQueimaduras = inst.metodoQueimaduras || 'regra9';
                    inst.faixaEtariaAtual = inst.faixaEtariaAtual || '5-9';
                    inst.grauSelecionado = 2; // PadrÃ£o 2Âº grau
                    inst.areasQueimadas = inst.areasQueimadas || {};
                    
                    // ğŸ¨ INICIALIZAR SISTEMA DE PINTURA
                    if (!inst.paintData) {
                        inst.paintData = {}; // { regiao_id: { grau2: [pixels], grau3: [pixels] } }
                        inst.isPainting = false;
                        inst.brushSize = 15;
                        inst.polygonAreas = {}; // Cache de Ã¡reas calculadas
                        inst.ferramentaAtual = 'pincel'; // 'pincel' ou 'borracha'
                        
                        console.log('ğŸ¨ Inicializando sistema de pintura e calculando Ã¡reas...');
                        
                        let totalRegioesProcessadas = 0;
                        let totalPixelsNoAtlas = 0;
                        
                        // Inicializar paintData e prÃ©-calcular Ã¡reas dos polÃ­gonos
                        inst.atlasAtual.regioes.forEach(regiao => {
                            inst.paintData[regiao.id] = { grau2: [], grau3: [] };
                            
                            // PrÃ©-calcular Ã¡rea do polÃ­gono (otimizaÃ§Ã£o de performance)
                            const polygon = this.pathToPolygon(regiao.path);
                            const bounds = this.getPolygonBounds(polygon);
                            let totalPixels = 0;
                            
                            for (let x = Math.floor(bounds.minX); x <= Math.ceil(bounds.maxX); x += 1) {
                                for (let y = Math.floor(bounds.minY); y <= Math.ceil(bounds.maxY); y += 1) {
                                    if (this.isPointInPolygon({ x, y }, polygon)) {
                                        totalPixels++;
                                    }
                                }
                            }
                            
                            inst.polygonAreas[regiao.id] = totalPixels;
                            totalRegioesProcessadas++;
                            totalPixelsNoAtlas += totalPixels;
                            
                            if (totalPixels === 0) {
                                console.warn(`   âš ï¸ ${regiao.nome}: 0 pixels (possÃ­vel erro no polÃ­gono!)`);
                            }
                        });
                        
                        console.log(`âœ… Ãreas calculadas: ${totalRegioesProcessadas} regiÃµes, ${totalPixelsNoAtlas} pixels totais`);
                        
                        // âœ… ATUALIZAR LISTA APÃ“S CALCULAR ÃREAS (primeira vez)
                        setTimeout(() => {
                            this.atualizarListaQueimaduras(containerId);
                        }, 50);
                        
                        // Configurar canvas apÃ³s um pequeno delay (para garantir que o DOM estÃ¡ pronto)
                        setTimeout(() => {
                            console.log('ğŸ”§ Chamando configurarCanvas para containerId:', containerId);
                            this.configurarCanvas(containerId);
                        }, 100);
                    }
                    
                    // Mostrar canvas
                    const canvas = document.getElementById(`canvas-queimados-${containerId}`);
                    if (canvas) {
                        canvas.style.display = 'block';
                        canvas.style.pointerEvents = 'auto';
                        console.log('ğŸ‘ï¸ Canvas mostrado e pointer-events ativado:', canvas.id);
                        console.log('   Display:', canvas.style.display);
                        console.log('   Pointer-events:', canvas.style.pointerEvents);
                    } else {
                        console.error('âŒ Canvas nÃ£o encontrado:', `canvas-queimados-${containerId}`);
                    }
                    
                    // âœ… MOSTRAR FERRAMENTAS DE QUEIMADOS
                    const ferramentasQueimados = document.getElementById(`ferramentas-queimados-${containerId}`);
                    if (ferramentasQueimados) ferramentasQueimados.style.display = 'block';
                    
                    // âœ… MOSTRAR RESULTADOS (% SCQ + PARKLAND)
                    const resultadosQueimados = document.getElementById(`resultados-queimados-${containerId}`);
                    if (resultadosQueimados) resultadosQueimados.style.display = 'block';
                    
                    // âœ… MOSTRAR PROTOCOLOS COMPLETOS
                    const protocolosQueimados = document.getElementById(`protocolos-queimados-${containerId}`);
                    if (protocolosQueimados) protocolosQueimados.style.display = 'block';
                    
                    // Selecionar 2Âº grau por padrÃ£o
                    this.selecionarGrau(containerId, 2);
                    
                    // Redesenhar canvas com pinturas existentes
                    setTimeout(() => {
                        this.redrawCanvas(containerId);
                    }, 200);
                }
                
                // IMPORTANTE: Redesenhar AMBAS as vistas com novo atlas
                this.renderizarVista(containerId, 'Anterior');
                this.renderizarVista(containerId, 'Posterior');
                
                // âœ… Atualizar lista conforme contexto (com pequeno delay para garantir renderizaÃ§Ã£o)
                setTimeout(() => {
                    if (contexto === 'queimados') {
                        this.atualizarListaQueimaduras(containerId);
                        // Inicializar protocolos de hidrataÃ§Ã£o
                        this.atualizarProtocolos(containerId);
                    } else {
                        this.atualizarListaAtlas(containerId);
                    }
                }, 100);
                
                console.log('ğŸ“Š Atlas trocado:', inst.atlasAtual.versao || 'sem versÃ£o');
                console.log('ğŸ“ RegiÃµes disponÃ­veis:', inst.atlasAtual.regioes?.length || 0);
                
                // âœ… VALIDAR DADOS OBRIGATÃ“RIOS (libera/bloqueia silhueta conforme contexto)
                this.validarDadosObrigatorios(containerId);
                
                console.log('ğŸ”„ Contexto trocado para:', contexto);
            },
            
            // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            // SISTEMA LUND-BROWDER
            // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            
            alternarMetodoQueimaduras(containerId, metodo) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                // âœ… PERGUNTAR ANTES DE FAZER QUALQUER MUDANÃ‡A
                const metodoAnterior = inst.metodoQueimaduras || 'regra9';
                if (metodoAnterior === metodo) return; // Mesmo mÃ©todo, nada a fazer
                
                const confirmar = confirm('âš ï¸ Trocar de mÃ©todo vai limpar a pintura atual. Continuar?');
                if (!confirmar) {
                    // Reverter seleÃ§Ã£o do radio (sem mudar nada)
                    const radios = document.querySelectorAll(`input[name="metodo-queimadura-${containerId}"]`);
                    radios.forEach(r => {
                        r.checked = r.value === metodoAnterior;
                    });
                    return;
                }
                
                console.log(`ğŸ”„ Alternando para mÃ©todo: ${metodo}`);
                
                // Salvar mÃ©todo atual
                inst.metodoQueimaduras = metodo;
                
                // Atualizar estilo dos botÃµes
                const radios = document.querySelectorAll(`input[name="metodo-queimadura-${containerId}"]`);
                radios.forEach(radio => {
                    const label = radio.closest('label');
                    if (radio.checked) {
                        label.style.background = '#667eea';
                        label.style.color = 'white';
                    } else {
                        label.style.background = 'white';
                        label.style.color = '#667eea';
                    }
                });
                
                // Mostrar/esconder painel de faixa etÃ¡ria
                const painelFaixaEtaria = document.getElementById(`painel-faixa-etaria-${containerId}`);
                if (painelFaixaEtaria) {
                    painelFaixaEtaria.style.display = metodo === 'lundBrowder' ? 'block' : 'none';
                }
                
                // Trocar atlas (CÃ“PIA PROFUNDA!)
                if (metodo === 'lundBrowder') {
                    inst.atlasAtual = deepCopyAtlas(ATLAS_LUND_BROWDER);
                    inst.faixaEtariaAtual = inst.faixaEtariaAtual || '5-9';
                    
                    // âœ… ATUALIZAR FAIXA ETÃRIA AUTOMATICAMENTE BASEADA NA IDADE DO PACIENTE
                    const idadeInput = document.getElementById(`idade-paciente-${containerId}`);
                    if (idadeInput) {
                        const idade = parseInt(idadeInput.value || 30);
                        let faixaAutomatica = '15+';
                        
                        if (idade <= 1) {
                            faixaAutomatica = '0-1';
                        } else if (idade <= 4) {
                            faixaAutomatica = '1-4';
                        } else if (idade <= 9) {
                            faixaAutomatica = '5-9';
                        } else if (idade <= 14) {
                            faixaAutomatica = '10-14';
                        }
                        
                        inst.faixaEtariaAtual = faixaAutomatica;
                        const faixaSelect = document.getElementById(`faixa-etaria-${containerId}`);
                        if (faixaSelect) {
                            faixaSelect.value = faixaAutomatica;
                        }
                        console.log(`âœ… Faixa Lund-Browder definida automaticamente: ${faixaAutomatica} (idade: ${idade} anos)`);
                    }
                } else {
                    inst.atlasAtual = deepCopyAtlas(ATLAS_QUEIMADOS);
                }
                
                // Resetar dados de pintura
                inst.paintData = {};
                inst.areasQueimadas = {};
                inst.polygonAreas = {};
                
                // Re-inicializar Ã¡reas
                inst.atlasAtual.regioes.forEach(regiao => {
                    inst.paintData[regiao.id] = { grau2: [], grau3: [] };
                    
                    const polygon = this.pathToPolygon(regiao.path);
                    const bounds = this.getPolygonBounds(polygon);
                    let totalPixels = 0;
                    
                    for (let x = Math.floor(bounds.minX); x <= Math.ceil(bounds.maxX); x += 1) {
                        for (let y = Math.floor(bounds.minY); y <= Math.ceil(bounds.maxY); y += 1) {
                            if (this.isPointInPolygon({ x, y }, polygon)) {
                                totalPixels++;
                            }
                        }
                    }
                    
                    inst.polygonAreas[regiao.id] = totalPixels;
                });
                
                // Redesenhar vistas
                this.renderizarVista(containerId, 'Anterior');
                this.renderizarVista(containerId, 'Posterior');
                
                // âœ… RECONFIGURAR CANVAS E GARANTIR QUE O PINCEL FUNCIONA
                setTimeout(() => {
                    this.configurarCanvas(containerId);
                    
                    // âœ… GARANTIR QUE O CANVAS ESTÃ VISÃVEL E ATIVO
                    const canvas = document.getElementById(`canvas-queimados-${containerId}`);
                    if (canvas) {
                        canvas.style.display = 'block';
                        canvas.style.pointerEvents = 'auto';
                    }
                    
                    // âœ… ATIVAR PINCEL AUTOMATICAMENTE
                    this.selecionarFerramenta(containerId, 'pincel');
                    this.selecionarGrau(containerId, 2);
                    
                    console.log('âœ… Canvas reconfigurado e pincel ativado');
                }, 100);
                
                // Redesenhar canvas limpo
                setTimeout(() => {
                    this.redrawCanvas(containerId);
                }, 200);
                
                // Atualizar lista e protocolos
                setTimeout(() => {
                    this.atualizarListaQueimaduras(containerId);
                    this.atualizarProtocolos(containerId);
                }, 300);
            },

            // ğŸ”„ CORREÃ‡ÃƒO #3: FunÃ§Ã£o para alternar protocolo Parkland
            alternarProtocoloParkland(containerId, protocolo) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                console.log(`ğŸ”„ Alternando protocolo Parkland: ${protocolo}`);
                
                // Salvar protocolo escolhido
                inst.protocoloParkland = protocolo;
                
                // Atualizar estilo dos botÃµes
                const radios = document.querySelectorAll(`input[name="protocolo-parkland-${containerId}"]`);
                radios.forEach(radio => {
                    const label = radio.closest('label');
                    if (radio.checked) {
                        label.style.background = '#0288d1';
                        label.style.color = 'white';
                    } else {
                        label.style.background = 'white';
                        label.style.color = '#0288d1';
                    }
                });
                
                // ğŸ“‹ Mostrar/esconder explicaÃ§Ã£o detalhada (sÃ³ no Novo ATLS)
                const explicacaoDiv = document.getElementById(`explicacao-protocolo-${containerId}`);
                if (explicacaoDiv) {
                    explicacaoDiv.style.display = protocolo === 'novo' ? 'block' : 'none';
                }
                
                // ğŸ”„ Alternar painÃ©is de resultado - PAINEL ESQUERDO (resumo)
                const tituloEl = document.getElementById(`titulo-parkland-${containerId}`);
                const labelVolumeEl = document.getElementById(`label-volume-${containerId}`);
                const classicoDiv = document.getElementById(`parkland-classico-div-${containerId}`);
                const novoDiv = document.getElementById(`parkland-novo-div-${containerId}`);
                
                if (protocolo === 'classico') {
                    if (tituloEl) tituloEl.textContent = 'FÃ³rmula de Parkland:';
                    if (labelVolumeEl) labelVolumeEl.textContent = 'Volume 24h';
                    if (classicoDiv) classicoDiv.style.display = 'block';
                    if (novoDiv) novoDiv.style.display = 'none';
                } else {
                    if (tituloEl) tituloEl.textContent = 'Novo ATLS (2-3-4):';
                    if (labelVolumeEl) labelVolumeEl.textContent = 'Volume Total';
                    if (classicoDiv) classicoDiv.style.display = 'none';
                    if (novoDiv) novoDiv.style.display = 'block';
                }
                
                // ğŸ”„ Alternar painÃ©is de resultado - PAINEL INTRA-HOSPITALAR
                const resultadoClassico = document.getElementById(`resultado-classico-${containerId}`);
                const resultadoNovoAtls = document.getElementById(`resultado-novo-atls-${containerId}`);
                
                if (protocolo === 'classico') {
                    if (resultadoClassico) resultadoClassico.style.display = 'block';
                    if (resultadoNovoAtls) resultadoNovoAtls.style.display = 'none';
                } else {
                    if (resultadoClassico) resultadoClassico.style.display = 'none';
                    if (resultadoNovoAtls) resultadoNovoAtls.style.display = 'block';
                }
                
                // Recalcular com protocolo correto
                this.atualizarProtocolos(containerId);
            },
            
            // ğŸ”„ CORREÃ‡ÃƒO #3: FunÃ§Ã£o helper para recalcular com protocolo atual
            recalcularParklandAtual(containerId) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                // Verificar qual protocolo estÃ¡ ativo (padrÃ£o: clÃ¡ssico)
                const protocolo = inst.protocoloParkland || 'classico';
                
                if (protocolo === 'classico') {
                    this.atualizarParkland(containerId);
                } else {
                    this.atualizarProtocolos(containerId);
                }
            },

            alterarFaixaEtaria(containerId) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados' || inst.metodoQueimaduras !== 'lundBrowder') return;
                
                const select = document.getElementById(`faixa-etaria-${containerId}`);
                inst.faixaEtariaAtual = select.value;
                
                console.log(`ğŸ‘¶ Faixa etÃ¡ria: ${inst.faixaEtariaAtual}`);
                
                this.calcularSCQ(containerId);
                this.atualizarListaQueimaduras(containerId);
                this.atualizarProtocolos(containerId);
            },
            
            selecionarGrau(containerId, grau) {
                const inst = this.instancias[containerId];
                if (!inst) return;
                
                inst.grauSelecionado = grau;
                
                // Atualizar visual dos botÃµes
                const btn2 = document.getElementById(`btn-grau2-${containerId}`);
                const btn3 = document.getElementById(`btn-grau3-${containerId}`);
                
                if (grau === 2) {
                    btn2.style.background = '#ff9800';
                    btn2.style.color = 'white';
                    btn3.style.background = 'white';
                    btn3.style.color = '#c62828';
                } else {
                    btn2.style.background = 'white';
                    btn2.style.color = '#ff9800';
                    btn3.style.background = '#c62828';
                    btn3.style.color = 'white';
                }
                
                console.log('ğŸ”¥ Grau selecionado:', grau);
            },
            
            selecionarFerramenta(containerId, ferramenta) {
                const inst = this.instancias[containerId];
                if (!inst) return;
                
                inst.ferramentaAtual = ferramenta;
                
                // Atualizar visual dos botÃµes
                const btnPincel = document.getElementById(`btn-pincel-${containerId}`);
                const btnBorracha = document.getElementById(`btn-borracha-${containerId}`);
                
                if (ferramenta === 'pincel') {
                    btnPincel.style.background = '#667eea';
                    btnPincel.style.color = 'white';
                    btnBorracha.style.background = 'white';
                    btnBorracha.style.color = '#666';
                } else {
                    btnPincel.style.background = 'white';
                    btnPincel.style.color = '#667eea';
                    btnBorracha.style.background = '#666';
                    btnBorracha.style.color = 'white';
                }
                
                console.log('ğŸ”§ Ferramenta selecionada:', ferramenta);
            },
            
            atualizarCriteriosInternacao(containerId) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                const criteriosDiv = document.getElementById(`criterios-internacao-${containerId}`);
                const criteriosLista = document.getElementById(`criterios-lista-${containerId}`);
                if (!criteriosDiv || !criteriosLista) return;
                
                const criterios = [];
                
                // Obter idade do paciente
                const idadeInput = document.getElementById(`idade-paciente-${containerId}`);
                const idade = parseInt(idadeInput?.value || 30);
                const isIdoso = idade >= 60;
                const isCrianca = idade < 13; // âœ… CORRIGIDO: CrianÃ§a < 13 anos (padrÃ£o queimados)
                
                // Verificar SCQ
                const scqElement = document.getElementById(`scq-total-${containerId}`);
                const grau2Element = document.getElementById(`scq-grau2-${containerId}`);
                const grau3Element = document.getElementById(`scq-grau3-${containerId}`);
                
                const scqTotal = parseFloat(scqElement?.textContent || '0');
                const grau2 = parseFloat(grau2Element?.textContent || '0');
                const grau3 = parseFloat(grau3Element?.textContent || '0');
                
                // CritÃ©rios por SCQ total (ajustados por idade)
                if ((isCrianca || isIdoso) && scqTotal >= 5) { // âœ… >= 5% (mais seguro)
                    criterios.push(`âœ“ SCQ â‰¥ 5% em ${isCrianca ? 'crianÃ§a' : 'idoso'} (${scqTotal.toFixed(1)}%)`);
                } else if (scqTotal >= 10) { // âœ… >= 10% para adulto
                    criterios.push(`âœ“ SCQ â‰¥ 10% em adulto (${scqTotal.toFixed(1)}%)`);
                }
                
                // ğŸ”¥ CORREÃ‡ÃƒO #4: CritÃ©rios adicionais de SCQ
                if (scqTotal > 10 && scqTotal <= 20) {
                    criterios.push(`âš ï¸ SCQ > 10% - Risco moderado (${scqTotal.toFixed(1)}%)`);
                }
                if (scqTotal > 20) {
                    criterios.push(`ğŸš¨ SCQ > 20% - GRAVE (${scqTotal.toFixed(1)}%)`);
                }
                
                // CritÃ©rio de 2Âº grau >20%
                if (grau2 > 20) {
                    criterios.push(`âœ“ Queimadura de 2Âº grau > 20% (${grau2.toFixed(1)}%)`);
                }
                
                // CritÃ©rio de 3Âº grau >5%
                if (grau3 > 5) {
                    criterios.push(`âœ“ Queimadura de 3Âº grau > 5% (${grau3.toFixed(1)}%)`);
                } else if (grau3 > 0) {
                    criterios.push(`âœ“ Queimadura de 3Âº grau presente (${grau3.toFixed(1)}%)`);
                }
                
                // Verificar tipo de queimadura
                const tipoQueimaduraSelect = document.getElementById(`tipo-queimadura-${containerId}`);
                const tipoQueimadura = tipoQueimaduraSelect?.value || 'termica';
                
                if (tipoQueimadura === 'eletrica') {
                    criterios.push('âœ“ Queimadura elÃ©trica (indicaÃ§Ã£o absoluta)');
                }
                
                // Verificar Ã¡reas nobres
                const areasNobres = [];
                if (document.getElementById(`area-nobre-face-${containerId}`)?.checked) {
                    areasNobres.push('Face');
                }
                if (document.getElementById(`area-nobre-maos-${containerId}`)?.checked) {
                    areasNobres.push('MÃ£os');
                }
                if (document.getElementById(`area-nobre-pes-${containerId}`)?.checked) {
                    areasNobres.push('PÃ©s');
                }
                if (document.getElementById(`area-nobre-genitalia-${containerId}`)?.checked) {
                    areasNobres.push('GenitÃ¡lia/PerÃ­neo');
                }
                if (document.getElementById(`area-nobre-pescoco-${containerId}`)?.checked) {
                    areasNobres.push('PescoÃ§o');
                }
                if (document.getElementById(`area-nobre-olhos-${containerId}`)?.checked) {
                    areasNobres.push('RegiÃ£o periocular');
                }
                if (document.getElementById(`area-nobre-articulacoes-${containerId}`)?.checked) {
                    areasNobres.push('Grandes articulaÃ§Ãµes');
                }
                
                if (areasNobres.length > 0) {
                    criterios.push(`âœ“ Ãreas nobres acometidas: ${areasNobres.join(', ')}`);
                }
                
                // Verificar situaÃ§Ãµes especiais
                const situacoesEspeciais = [];
                
                if (document.getElementById(`situacao-lesao-inalatoria-${containerId}`)?.checked) {
                    situacoesEspeciais.push('LesÃ£o inalatÃ³ria/via aÃ©rea');
                }
                if (document.getElementById(`situacao-trauma-${containerId}`)?.checked) {
                    situacoesEspeciais.push('Trauma associado');
                }
                if (document.getElementById(`situacao-comorbidades-${containerId}`)?.checked) {
                    situacoesEspeciais.push('Comorbidades significativas');
                }
                if (document.getElementById(`situacao-circular-${containerId}`)?.checked) {
                    situacoesEspeciais.push('Queimadura circular');
                }
                if (document.getElementById(`situacao-abuso-${containerId}`)?.checked) {
                    situacoesEspeciais.push('Suspeita de abuso/negligÃªncia');
                }
                if (document.getElementById(`situacao-social-${containerId}`)?.checked) {
                    situacoesEspeciais.push('CondiÃ§Ãµes sociais inadequadas');
                }
                
                if (situacoesEspeciais.length > 0) {
                    criterios.push(`âœ“ SituaÃ§Ãµes especiais: ${situacoesEspeciais.join('; ')}`);
                }
                
                // Mostrar/esconder div de critÃ©rios
                if (criterios.length > 0) {
                    criteriosDiv.style.display = 'block';
                    criteriosLista.innerHTML = criterios.map(c => `<div style="margin-bottom: 5px;">â€¢ ${c}</div>`).join('');
                } else {
                    criteriosDiv.style.display = 'none';
                }
                
                // âœ… ATUALIZAR CLASSIFICAÃ‡ÃƒO FINAL
                this.atualizarClassificacaoFinal(containerId, {
                    scqTotal, grau2, grau3, idade,
                    areasNobres, situacoesEspeciais, tipoQueimadura
                });
            },
            
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            // CLASSIFICAÃ‡ÃƒO FINAL DO QUEIMADO (Pequeno/MÃ©dio/Grande)
            // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            
            atualizarClassificacaoFinal(containerId, dados) {
                const { scqTotal, grau2, grau3, idade, areasNobres, situacoesEspeciais, tipoQueimadura } = dados;
                
                const box = document.getElementById(`classificacao-box-${containerId}`);
                const titulo = document.getElementById(`classificacao-titulo-${containerId}`);
                const descricao = document.getElementById(`classificacao-descricao-${containerId}`);
                const criteriosDiv = document.getElementById(`classificacao-criterios-${containerId}`);
                const condutaDiv = document.getElementById(`classificacao-conduta-${containerId}`);
                const condutaTexto = document.getElementById(`classificacao-conduta-texto-${containerId}`);
                
                if (!box || !titulo || !descricao || !criteriosDiv || !condutaDiv || !condutaTexto) return;
                
                // Determinar se Ã© crianÃ§a ou adulto
                const isCrianca = idade < 13;
                const isAdulto = idade >= 13;
                
                let classificacao = '';
                let cor = '';
                let bordaCor = '';
                let emoji = '';
                let descricaoTexto = '';
                const criteriosIdentificados = [];
                let indicaInternacao = false;
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // LÃ“GICA DE CLASSIFICAÃ‡ÃƒO
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                
                // ğŸ”´ GRANDE QUEIMADO (prioridade mÃ¡xima)
                if (
                    (isAdulto && grau2 > 20) ||
                    (isCrianca && grau2 > 10) ||
                    grau3 > 10 ||
                    tipoQueimadura === 'eletrica' ||
                    situacoesEspeciais.includes('LesÃ£o inalatÃ³ria/via aÃ©rea') ||
                    situacoesEspeciais.includes('Trauma associado')
                ) {
                    classificacao = 'GRANDE QUEIMADO';
                    cor = '#dc2626'; // vermelho
                    bordaCor = '#991b1b';
                    emoji = 'ğŸ”´';
                    descricaoTexto = 'Queimadura grave com critÃ©rios de alta complexidade';
                    indicaInternacao = true;
                    
                    // Listar critÃ©rios
                    if (isAdulto && grau2 > 20) {
                        criteriosIdentificados.push(`â€¢ SCQ 2Âº grau > 20% em adulto: ${grau2.toFixed(1)}%`);
                    }
                    if (isCrianca && grau2 > 10) {
                        criteriosIdentificados.push(`â€¢ SCQ 2Âº grau > 10% em crianÃ§a: ${grau2.toFixed(1)}%`);
                    }
                    if (grau3 > 10) {
                        criteriosIdentificados.push(`â€¢ SCQ 3Âº grau > 10%: ${grau3.toFixed(1)}%`);
                    }
                    if (tipoQueimadura === 'eletrica') {
                        criteriosIdentificados.push(`â€¢ Queimadura elÃ©trica (indicaÃ§Ã£o absoluta)`);
                    }
                    if (situacoesEspeciais.includes('LesÃ£o inalatÃ³ria/via aÃ©rea')) {
                        criteriosIdentificados.push(`â€¢ LesÃ£o inalatÃ³ria / via aÃ©rea comprometida`);
                    }
                    if (situacoesEspeciais.includes('Trauma associado')) {
                        criteriosIdentificados.push(`â€¢ Trauma associado (politrauma)`);
                    }
                }
                
                // ğŸŸ¡ MÃ‰DIO QUEIMADO
                else if (
                    (isAdulto && grau2 >= 10 && grau2 <= 20) ||
                    (isCrianca && grau2 >= 5 && grau2 <= 10) ||
                    (grau3 >= 2 && grau3 <= 10) || // âœ… 3Âº grau >= 2% (nÃ£o < 2%)
                    (grau3 > 0 && grau3 < 2 && areasNobres.length > 0) || // âœ… 3Âº grau < 2% MAS com Ã¡rea nobre
                    areasNobres.length > 0 ||
                    situacoesEspeciais.length > 0
                ) {
                    classificacao = 'MÃ‰DIO QUEIMADO';
                    cor = '#f59e0b'; // amarelo/laranja
                    bordaCor = '#d97706';
                    emoji = 'ğŸŸ¡';
                    descricaoTexto = 'Queimadura moderada que requer avaliaÃ§Ã£o especializada';
                    indicaInternacao = true;
                    
                    // Listar critÃ©rios
                    if (isAdulto && grau2 >= 10 && grau2 <= 20) {
                        criteriosIdentificados.push(`â€¢ SCQ 2Âº grau entre 10-20% em adulto: ${grau2.toFixed(1)}%`);
                    }
                    if (isCrianca && grau2 >= 5 && grau2 <= 10) {
                        criteriosIdentificados.push(`â€¢ SCQ 2Âº grau entre 5-10% em crianÃ§a: ${grau2.toFixed(1)}%`);
                    }
                    if (grau3 >= 2 && grau3 <= 10) {
                        criteriosIdentificados.push(`â€¢ SCQ 3Âº grau 2-10%: ${grau3.toFixed(1)}%`);
                    }
                    if (grau3 > 0 && grau3 < 2 && areasNobres.length > 0) {
                        criteriosIdentificados.push(`â€¢ SCQ 3Âº grau < 2% (${grau3.toFixed(1)}%) EM Ã¡rea nobre`);
                    }
                    if (areasNobres.length > 0) {
                        criteriosIdentificados.push(`â€¢ Ãreas nobres acometidas: ${areasNobres.join(', ')}`);
                    }
                    if (situacoesEspeciais.length > 0) {
                        criteriosIdentificados.push(`â€¢ SituaÃ§Ãµes especiais: ${situacoesEspeciais.join(', ')}`);
                    }
                }
                
                // ğŸŸ¢ PEQUENO QUEIMADO
                else if (scqTotal > 0) {
                    classificacao = 'PEQUENO QUEIMADO';
                    cor = '#16a34a'; // verde
                    bordaCor = '#15803d';
                    emoji = 'ğŸŸ¢';
                    descricaoTexto = 'Queimadura de menor complexidade';
                    indicaInternacao = false;
                    
                    // Listar critÃ©rios
                    if (isAdulto) {
                        criteriosIdentificados.push(`â€¢ SCQ 2Âº grau < 10% em adulto: ${grau2.toFixed(1)}%`);
                    } else {
                        criteriosIdentificados.push(`â€¢ SCQ 2Âº grau < 5% em crianÃ§a: ${grau2.toFixed(1)}%`);
                    }
                    if (grau3 === 0) {
                        criteriosIdentificados.push(`â€¢ Sem queimadura de 3Âº grau`);
                    } else if (grau3 > 0 && grau3 < 2) {
                        criteriosIdentificados.push(`â€¢ SCQ 3Âº grau < 2%: ${grau3.toFixed(1)}% (aceitÃ¡vel)`);
                    }
                    if (areasNobres.length === 0) {
                        criteriosIdentificados.push(`â€¢ Sem acometimento de Ã¡reas nobres`);
                    }
                }
                
                // âšª SEM DADOS
                else {
                    classificacao = 'Aguardando avaliaÃ§Ã£o';
                    cor = '#9ca3af'; // cinza
                    bordaCor = '#6b7280';
                    emoji = 'âšª';
                    descricaoTexto = 'Preencha os dados para ver a classificaÃ§Ã£o';
                    criteriosIdentificados.push('â€¢ Marque Ã¡reas queimadas na silhueta');
                    criteriosIdentificados.push('â€¢ Selecione Ã¡reas nobres se aplicÃ¡vel');
                    criteriosIdentificados.push('â€¢ Marque situaÃ§Ãµes especiais se houver');
                }
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // ATUALIZAR INTERFACE
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                
                // Box principal
                box.style.background = `linear-gradient(135deg, ${cor}15 0%, ${cor}25 100%)`;
                box.style.borderColor = bordaCor;
                
                // TÃ­tulo
                titulo.textContent = `${emoji} ${classificacao}`;
                titulo.style.color = cor;
                
                // DescriÃ§Ã£o
                descricao.textContent = descricaoTexto;
                descricao.style.color = bordaCor;
                
                // CritÃ©rios
                if (criteriosIdentificados.length > 0) {
                    criteriosDiv.innerHTML = criteriosIdentificados.join('<br>');
                } else {
                    criteriosDiv.innerHTML = 'â€¢ Nenhum critÃ©rio especÃ­fico identificado';
                }
                
                // Conduta
                if (indicaInternacao) {
                    condutaDiv.style.background = '#fee2e2';
                    condutaDiv.style.borderColor = '#dc2626';
                    condutaTexto.style.color = '#991b1b';
                    condutaTexto.innerHTML = `
                        <strong>âš ï¸ INDICAÃ‡ÃƒO DE INTERNAÃ‡ÃƒO</strong><br>
                        <span style="font-size: 10px; margin-top: 4px; display: block;">
                        Encaminhar para centro especializado em queimados
                        </span>
                    `;
                } else {
                    condutaDiv.style.background = '#f0fdf4';
                    condutaDiv.style.borderColor = '#16a34a';
                    condutaTexto.style.color = '#15803d';
                    condutaTexto.innerHTML = `
                        <strong>âœ… Tratamento ambulatorial possÃ­vel</strong><br>
                        <span style="font-size: 10px; margin-top: 4px; display: block;">
                        Avaliar condiÃ§Ãµes sociais e capacidade de cuidado domiciliar
                        </span>
                    `;
                }
                
                console.log(`ğŸ“Š ClassificaÃ§Ã£o atualizada: ${classificacao}`);
            },
            
            marcarAreaQueimada(containerId, areaId, percentual) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                const grau = inst.grauSelecionado;
                
                // Inicializar Ã¡rea se nÃ£o existir
                if (!inst.areasQueimadas[areaId]) {
                    inst.areasQueimadas[areaId] = { grau2: 0, grau3: 0 };
                }
                
                // Atualizar percentual do grau selecionado
                if (grau === 2) {
                    inst.areasQueimadas[areaId].grau2 = percentual;
                } else if (grau === 3) {
                    inst.areasQueimadas[areaId].grau3 = percentual;
                }
                
                // Recalcular SCQ
                this.calcularSCQ(containerId);
            },
            
            calcularSCQ(containerId) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                let totalGrau2 = 0;
                let totalGrau3 = 0;
                
                // Somar todas as Ã¡reas
                for (const areaId in inst.areasQueimadas) {
                    const area = inst.areasQueimadas[areaId];
                    
                    // Encontrar percentual da regiÃ£o no atlas
                    const regiaoAtlas = inst.atlasAtual.regioes.find(r => r.id === areaId);
                    if (!regiaoAtlas) continue;
                    
                    // Obter percentual correto (Lund-Browder usa percentual por idade)
                    let percentualCorpo;
                    if (inst.metodoQueimaduras === 'lundBrowder' && typeof ATLAS_LUND_BROWDER !== 'undefined') {
                        percentualCorpo = ATLAS_LUND_BROWDER.obterPercentual(areaId, inst.faixaEtariaAtual || '5-9');
                    } else {
                        percentualCorpo = regiaoAtlas.percentual;
                    }
                    
                    // Calcular contribuiÃ§Ã£o para SCQ
                    totalGrau2 += (area.grau2 / 100) * percentualCorpo;
                    totalGrau3 += (area.grau3 / 100) * percentualCorpo;
                }
                
                const scqTotal = totalGrau2 + totalGrau3;
                
                // Atualizar interface
                document.getElementById(`scq-total-${containerId}`).textContent = scqTotal.toFixed(1) + '%';
                document.getElementById(`scq-grau2-${containerId}`).textContent = totalGrau2.toFixed(1) + '%';
                document.getElementById(`scq-grau3-${containerId}`).textContent = totalGrau3.toFixed(1) + '%';
                
                // Atualizar Parkland (passando SCQ calculado para evitar loop infinito)
                this.atualizarParkland(containerId, { total: scqTotal, grau2: totalGrau2, grau3: totalGrau3 });
                
                // Atualizar protocolos de hidrataÃ§Ã£o
                this.atualizarProtocolos(containerId);
                
                // âœ… ATUALIZAR CLASSIFICAÃ‡ÃƒO ao mudar SCQ
                this.atualizarCriteriosInternacao(containerId);
                
                return { total: scqTotal, grau2: totalGrau2, grau3: totalGrau3 };
            },
            
            atualizarParkland(containerId, scq = null) {
                // âœ… CORREÃ‡ÃƒO: Usar protocolo inteligente ao invÃ©s de sempre 4ml
                // Agora chama atualizarProtocolos que ajusta baseado em idade/peso/tipo
                console.log('ğŸ”„ atualizarParkland â†’ chamando atualizarProtocolos');
                this.atualizarProtocolos(containerId);
            },
            
            // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            // PROTOCOLOS DE HIDRATAÃ‡ÃƒO
            // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            
            atualizarProtocolos(containerId) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                const pesoInput = document.getElementById(`peso-paciente-${containerId}`);
                const idadeInput = document.getElementById(`idade-paciente-${containerId}`);
                const tipoQueimaduraSelect = document.getElementById(`tipo-queimadura-${containerId}`);
                const alertaDiv = document.getElementById(`alerta-dados-paciente-${containerId}`);
                
                // Obter valores (sem fallback automÃ¡tico)
                const pesoValor = pesoInput?.value?.trim();
                const idadeValor = idadeInput?.value?.trim();
                const peso = parseFloat(pesoValor) || 0;
                // v10.463: CORREÃ‡ÃƒO - idade 0 (bebÃªs) era tratada como falsy!
                // parseInt("0") || -1 retornava -1 porque 0 Ã© falsy
                const idadeParseada = parseInt(idadeValor);
                const idade = (idadeValor !== '' && !isNaN(idadeParseada)) ? idadeParseada : -1;
                const tipoQueimadura = tipoQueimaduraSelect?.value || 'termica';
                
                // Verificar qual protocolo estÃ¡ ativo (padrÃ£o: clÃ¡ssico)
                const protocolo = inst.protocoloParkland || 'classico';
                
                // âœ… VALIDAÃ‡ÃƒO: Para Novo ATLS, peso e idade sÃ£o OBRIGATÃ“RIOS
                const pesoVazio = !pesoValor || peso <= 0;
                const idadeVazia = !idadeValor || idade < 0;
                
                if (protocolo === 'novo' && (pesoVazio || idadeVazia)) {
                    // Mostrar alerta
                    if (alertaDiv) {
                        alertaDiv.style.display = 'block';
                        alertaDiv.innerHTML = `âš ï¸ <strong>Preencha peso${pesoVazio ? '' : ' âœ“'} e idade${idadeVazia ? '' : ' âœ“'}</strong> para calcular Novo ATLS (regra 2-3-4).`;
                    }
                    
                    // Limpar resultados
                    this.limparResultadosHidratacao(containerId);
                    return;
                }
                
                // Se clÃ¡ssico com peso vazio, usar fallback mas avisar
                if (protocolo === 'classico' && pesoVazio) {
                    if (alertaDiv) {
                        alertaDiv.style.display = 'block';
                        alertaDiv.innerHTML = `âš ï¸ <strong>Informe o peso</strong> para cÃ¡lculo preciso. Usando estimativa padrÃ£o.`;
                    }
                }
                
                // Peso para cÃ¡lculo (fallback sÃ³ para clÃ¡ssico)
                const pesoCalculo = peso > 0 ? peso : (protocolo === 'classico' ? 70 : 0);
                const idadeCalculo = idade >= 0 ? idade : 30;
                
                // Esconder alerta se tudo OK
                if (alertaDiv && pesoCalculo > 0 && (protocolo === 'classico' || !idadeVazia)) {
                    alertaDiv.style.display = 'none';
                }
                
                // âœ… ATUALIZAR FAIXA ETÃRIA LUND-BROWDER BASEADA NA IDADE
                const faixaEtariaSelect = document.getElementById(`faixa-etaria-${containerId}`);
                if (faixaEtariaSelect && inst.metodoQueimaduras === 'lundbrowder' && idadeCalculo >= 0) {
                    let faixaAutomatica = '15+';
                    if (idadeCalculo <= 1) faixaAutomatica = '0-1';
                    else if (idadeCalculo <= 4) faixaAutomatica = '1-4';
                    else if (idadeCalculo <= 9) faixaAutomatica = '5-9';
                    else if (idadeCalculo <= 14) faixaAutomatica = '10-14';
                    
                    if (faixaEtariaSelect.value !== faixaAutomatica) {
                        faixaEtariaSelect.value = faixaAutomatica;
                        inst.faixaEtariaAtual = faixaAutomatica;
                        if (inst.metodoQueimaduras === 'lundbrowder') {
                            inst.atlasAtual = deepCopyAtlas(ATLAS_LUND_BROWDER);
                            this.redesenhar(containerId);
                        }
                    }
                }
                
                // âœ… BUSCAR SCQ DO DOM
                const scqElement = document.getElementById(`scq-total-${containerId}`);
                const scqText = scqElement?.textContent || '0%';
                const scqTotal = parseFloat(scqText.replace('%', '')) || 0;
                
                if (scqTotal === 0) return;
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // 1. PROTOCOLO PRÃ‰-HOSPITALAR (sempre igual)
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                let taxaAPH = '';
                if (idadeCalculo <= 5) {
                    taxaAPH = '125 ml/h (Lactente/PrÃ©-escolar)';
                } else if (idadeCalculo <= 12) {
                    taxaAPH = '250 ml/h (Escolar)';
                } else {
                    taxaAPH = '500 ml/h (Adolescente/Adulto)';
                }
                const aphEl = document.getElementById(`protocolo-aph-${containerId}`);
                if (aphEl) aphEl.textContent = taxaAPH;
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // 2. HIDRATAÃ‡ÃƒO INTRA-HOSPITALAR
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                let multiplicador, formula, solucaoAdicional = '';
                let volume, taxa8h, taxa16h, taxaConstante;
                
                if (protocolo === 'classico') {
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // PARKLAND CLÃSSICO: 4ml fixo, 50% em 8h + 50% em 16h
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    multiplicador = 4;
                    formula = '4 ml LR Ã— kg Ã— %SCQ (Parkland ClÃ¡ssico)';
                    volume = multiplicador * pesoCalculo * scqTotal;
                    
                    const volume8h = Math.round(volume / 2);
                    const volume16h = Math.round(volume / 2);
                    taxa8h = Math.round(volume8h / 8);
                    taxa16h = Math.round(volume16h / 16);
                    
                    // Atualizar interface CLÃSSICO
                    const formulaEl = document.getElementById(`formula-hidratacao-${containerId}`);
                    if (formulaEl) formulaEl.textContent = formula;
                    
                    const volume24hEl = document.getElementById(`volume-24h-${containerId}`);
                    if (volume24hEl) volume24hEl.textContent = Math.round(volume) + ' mL';
                    
                    const taxaClassico8hEl = document.getElementById(`taxa-classico-8h-${containerId}`);
                    const taxaClassico16hEl = document.getElementById(`taxa-classico-16h-${containerId}`);
                    if (taxaClassico8hEl) taxaClassico8hEl.textContent = `${taxa8h} ml/h (${volume8h} mL)`;
                    if (taxaClassico16hEl) taxaClassico16hEl.textContent = `${taxa16h} ml/h (${volume16h} mL)`;
                    
                    // Atualizar painel esquerdo (resumo)
                    const parklandTotal = document.getElementById(`parkland-total-${containerId}`);
                    const parkland8h = document.getElementById(`parkland-8h-${containerId}`);
                    const parkland16h = document.getElementById(`parkland-16h-${containerId}`);
                    if (parklandTotal) parklandTotal.textContent = Math.round(volume) + ' mL';
                    if (parkland8h) parkland8h.textContent = `${taxa8h} ml/h (${volume8h} mL)`;
                    if (parkland16h) parkland16h.textContent = `${taxa16h} ml/h (${volume16h} mL)`;
                    
                    console.log(`ğŸ’§ PARKLAND CLÃSSICO:`, {
                        formula,
                        peso: pesoCalculo,
                        scqTotal,
                        volumeTotal: Math.round(volume),
                        '8h': `${taxa8h} ml/h`,
                        '16h': `${taxa16h} ml/h`
                    });
                    
                } else {
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // NOVO ATLS: Regra 2-3-4, taxa constante por 16h
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    if (tipoQueimadura === 'eletrica') {
                        multiplicador = 4;
                        formula = '4 ml LR Ã— kg Ã— %SCQ (elÃ©trica)';
                        if (idadeCalculo < 13) solucaoAdicional = 'D5LR na taxa de manutenÃ§Ã£o';
                        const metaEl = document.getElementById(`meta-especial-eletrica-${containerId}`);
                        if (metaEl) metaEl.style.display = 'block';
                    } else {
                        const metaEl = document.getElementById(`meta-especial-eletrica-${containerId}`);
                        if (metaEl) metaEl.style.display = 'none';
                        
                        if (idadeCalculo >= 65) {
                            multiplicador = 2;
                            formula = '2 ml LR Ã— kg Ã— %SCQ (idoso â‰¥65a)';
                        } else if (idadeCalculo < 13) {
                            multiplicador = 3;
                            formula = '3 ml LR Ã— kg Ã— %SCQ (crianÃ§a <13a)';
                            if (pesoCalculo < 30) solucaoAdicional = 'D5LR com taxa de manutenÃ§Ã£o';
                        } else {
                            multiplicador = 4;
                            formula = '4 ml LR Ã— kg Ã— %SCQ (adulto 13-64a)';
                        }
                    }
                    
                    volume = multiplicador * pesoCalculo * scqTotal;
                    taxaConstante = Math.round(volume / 16);
                    
                    // Atualizar interface NOVO ATLS
                    const formulaEl = document.getElementById(`formula-hidratacao-${containerId}`);
                    if (formulaEl) formulaEl.textContent = formula;
                    
                    const volumeNovoAtlsEl = document.getElementById(`volume-novo-atls-${containerId}`);
                    if (volumeNovoAtlsEl) volumeNovoAtlsEl.textContent = Math.round(volume) + ' mL';
                    
                    const taxaNovoAtlsEl = document.getElementById(`taxa-novo-atls-${containerId}`);
                    if (taxaNovoAtlsEl) taxaNovoAtlsEl.textContent = taxaConstante;
                    
                    // Atualizar painel esquerdo (resumo)
                    const parklandTotal = document.getElementById(`parkland-total-${containerId}`);
                    const parklandTaxa = document.getElementById(`parkland-taxa-${containerId}`);
                    if (parklandTotal) parklandTotal.textContent = Math.round(volume) + ' mL';
                    if (parklandTaxa) parklandTaxa.textContent = taxaConstante;
                    
                    console.log(`ğŸ’§ NOVO ATLS:`, {
                        regra: `${multiplicador} ml/kg/%SCQ`,
                        peso: pesoCalculo,
                        idade: idadeCalculo,
                        scqTotal,
                        volumeTotal: Math.round(volume),
                        taxaConstante: `${taxaConstante} ml/h por 16h`
                    });
                }
                
                // SoluÃ§Ã£o adicional
                const solucaoDiv = document.getElementById(`solucao-adicional-${containerId}`);
                const textoSolucao = document.getElementById(`texto-solucao-${containerId}`);
                if (solucaoAdicional && solucaoDiv && textoSolucao) {
                    solucaoDiv.style.display = 'block';
                    textoSolucao.textContent = solucaoAdicional;
                } else if (solucaoDiv) {
                    solucaoDiv.style.display = 'none';
                }
                
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                // 3. METAS DE DIURESE
                // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                let metaDiurese = '';
                let metaDiureseMl = '';
                
                const pesoDisplayEl = document.getElementById(`peso-display-${containerId}`);
                if (pesoDisplayEl) pesoDisplayEl.textContent = pesoCalculo;
                
                if (tipoQueimadura === 'eletrica') {
                    metaDiurese = '1-1.5 ml/kg/h';
                    metaDiureseMl = Math.round(pesoCalculo * 1) + ' - ' + Math.round(pesoCalculo * 1.5) + ' ml/h';
                } else {
                    if (idadeCalculo < 13 || pesoCalculo < 30) {
                        metaDiurese = '1 ml/kg/h';
                        metaDiureseMl = Math.round(pesoCalculo * 1) + ' ml/h';
                    } else {
                        metaDiurese = '0.5 ml/kg/h';
                        metaDiureseMl = Math.round(pesoCalculo * 0.5) + ' ml/h (aprox. 30-50 ml/h)';
                    }
                }
                
                const metaDiureseEl = document.getElementById(`meta-diurese-${containerId}`);
                const metaDiureseMlEl = document.getElementById(`meta-diurese-ml-${containerId}`);
                if (metaDiureseEl) metaDiureseEl.textContent = metaDiurese;
                if (metaDiureseMlEl) metaDiureseMlEl.textContent = metaDiureseMl;
                
                // Atualizar critÃ©rios de internaÃ§Ã£o
                this.atualizarCriteriosInternacao(containerId);
            },
            
            // âœ… Helper: Limpar resultados quando dados faltando
            limparResultadosHidratacao(containerId) {
                const campos = [
                    `volume-24h-${containerId}`,
                    `volume-novo-atls-${containerId}`,
                    `taxa-classico-8h-${containerId}`,
                    `taxa-classico-16h-${containerId}`,
                    `taxa-novo-atls-${containerId}`,
                    `parkland-total-${containerId}`,
                    `parkland-8h-${containerId}`,
                    `parkland-16h-${containerId}`,
                    `parkland-taxa-${containerId}`,
                    `formula-hidratacao-${containerId}`
                ];
                
                campos.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.textContent = '--';
                });
            },
            
            // ğŸ¨ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            // SISTEMA DE PINTURA DE QUEIMADURAS
            // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            
            configurarCanvas(containerId) {
                const inst = this.instancias[containerId];
                if (!inst) {
                    console.error('âŒ configurarCanvas: instÃ¢ncia nÃ£o encontrada para', containerId);
                    return;
                }
                
                const canvas = document.getElementById(`canvas-queimados-${containerId}`);
                if (!canvas) {
                    console.error('âŒ configurarCanvas: canvas nÃ£o encontrado:', `canvas-queimados-${containerId}`);
                    return;
                }
                
                console.log('âœ… configurarCanvas: canvas encontrado:', canvas);
                console.log('   Pointer events ANTES:', canvas.style.pointerEvents);
                
                // âœ… LIMPAR EVENT LISTENERS ANTIGOS (clonando o canvas)
                const newCanvas = canvas.cloneNode(true);
                canvas.parentNode.replaceChild(newCanvas, canvas);
                
                // âœ… SINCRONIZAR TAMANHO DO CANVAS COM O SVG (evita vazamento)
                const svg = document.getElementById(`svg-atlas-completo-${containerId}`);
                if (svg) {
                    const svgRect = svg.getBoundingClientRect();
                    newCanvas.style.width = svgRect.width + 'px';
                    newCanvas.style.height = svgRect.height + 'px';
                    console.log('   Canvas sincronizado com SVG:', svgRect.width, 'x', svgRect.height);
                }
                
                // âœ… GARANTIR que o novo canvas tenha pointer-events ativo
                newCanvas.style.pointerEvents = 'auto';
                newCanvas.style.display = 'block';
                console.log('   Pointer events DEPOIS:', newCanvas.style.pointerEvents);
                
                // Usar o novo canvas
                const ctx = newCanvas.getContext('2d');
                let isPainting = false;
                
                const paint = (e) => {
                    console.log('ğŸ¨ paint() chamado! Tipo:', e.type, 'isPainting:', isPainting);
                    
                    if (!isPainting && e.type !== 'mousedown' && e.type !== 'touchstart') return;
                    e.preventDefault();
                    
                    const rect = newCanvas.getBoundingClientRect();
                    const scaleX = newCanvas.width / rect.width;
                    const scaleY = newCanvas.height / rect.height;
                    
                    let clientX, clientY;
                    if (e.touches) {
                        clientX = e.touches[0].clientX;
                        clientY = e.touches[0].clientY;
                    } else {
                        clientX = e.clientX;
                        clientY = e.clientY;
                    }
                    
                    const x = (clientX - rect.left) * scaleX;
                    const y = (clientY - rect.top) * scaleY;
                    
                    console.log('   PosiÃ§Ã£o canvas:', x, y);
                    
                    // âœ… AJUSTAR COORDENADAS PARA O VIEWBOX
                    // ViewBox Ãºnico: "0 290 700 620"
                    // Detectar vista baseado na posiÃ§Ã£o X
                    const adjustedY = y + 290;  // Compensar offset Y do viewBox
                    
                    // Determinar vista pela posiÃ§Ã£o X do clique
                    const vistaClicada = x < 350 ? 'Anterior' : 'Posterior';
                    
                    console.log('   Vista clicada:', vistaClicada);
                    console.log('   Coordenadas ajustadas:', x, adjustedY);
                    
                    // adjustedX Ã© o x direto (canvas jÃ¡ estÃ¡ mapeado 1:1 com viewBox)
                    const adjustedX = x;
                    
                    // Encontrar regiÃ£o clicada
                    const inst = this.instancias[containerId];
                    const regioes = inst.atlasAtual.regioes.filter(r => 
                        r.vista === vistaClicada
                    );
                    
                    let regionFound = null;
                    for (const regiao of regioes) {
                        const polygon = this.pathToPolygon(regiao.path);
                        if (this.isPointInPolygon({ x: adjustedX, y: adjustedY }, polygon)) {
                            regionFound = regiao;
                            break;
                        }
                    }
                    
                    if (!regionFound) {
                        console.log('   âš ï¸ Nenhuma regiÃ£o encontrada neste ponto');
                        return;
                    }
                    
                    console.log('   âœ… RegiÃ£o encontrada:', regionFound.nome);
                    
                    const regionId = regionFound.id;
                    const grau = inst.grauSelecionado;
                    const grauKey = grau === 2 ? 'grau2' : 'grau3';
                    const polygon = this.pathToPolygon(regionFound.path);
                    
                    // ğŸ¨ PINTURA CIRCULAR (como o original)
                    const brushRadius = inst.brushSize / 2;
                    
                    if (inst.ferramentaAtual === 'borracha') {
                        // ğŸ—‘ï¸ MODO BORRACHA
                        for (let dx = -brushRadius; dx < brushRadius; dx++) {
                            for (let dy = -brushRadius; dy < brushRadius; dy++) {
                                // Verificar se estÃ¡ dentro do cÃ­rculo do pincel
                                if (dx * dx + dy * dy <= brushRadius * brushRadius) {
                                    const px = Math.round(adjustedX + dx);
                                    const py = Math.round(adjustedY + dy);
                                    
                                    // Remover de todos os graus
                                    ['grau2', 'grau3'].forEach(key => {
                                        inst.paintData[regionId][key] = inst.paintData[regionId][key].filter(
                                            p => !(p.x === px && p.y === py)
                                        );
                                    });
                                }
                            }
                        }
                    } else {
                        // ğŸ–Œï¸ MODO PINTURA
                        for (let dx = -brushRadius; dx < brushRadius; dx++) {
                            for (let dy = -brushRadius; dy < brushRadius; dy++) {
                                // Verificar se estÃ¡ dentro do cÃ­rculo do pincel
                                if (dx * dx + dy * dy <= brushRadius * brushRadius) {
                                    const px = Math.round(adjustedX + dx);
                                    const py = Math.round(adjustedY + dy);
                                    
                                    // âœ… VERIFICAR SE ESTÃ DENTRO DO POLÃGONO
                                    if (this.isPointInPolygon({ x: px, y: py }, polygon)) {
                                        // Remover de outros graus
                                        const outroGrauKey = grau === 2 ? 'grau3' : 'grau2';
                                        inst.paintData[regionId][outroGrauKey] = 
                                            inst.paintData[regionId][outroGrauKey].filter(
                                                p => !(p.x === px && p.y === py)
                                            );
                                        
                                        // Adicionar ao grau atual se nÃ£o existir
                                        if (!inst.paintData[regionId][grauKey].find(p => p.x === px && p.y === py)) {
                                            inst.paintData[regionId][grauKey].push({ x: px, y: py });
                                        }
                                    }
                                }
                            }
                        }
                    }
                    
                    // Log para debug
                    const totalGrau2 = inst.paintData[regionId].grau2.length;
                    const totalGrau3 = inst.paintData[regionId].grau3.length;
                    console.log(`   ğŸ’¾ Pixels na regiÃ£o ${regionFound.nome}: Grau2=${totalGrau2}, Grau3=${totalGrau3}`);
                    
                    // âœ… REDESENHAR canvas apÃ³s pintar/apagar
                    this.redrawCanvas(containerId);
                    console.log('ğŸ¨ Canvas redesenhado!');
                };
                
                console.log('ğŸ¯ Adicionando event listeners ao canvas...');
                
                newCanvas.addEventListener('mousedown', (e) => {
                    console.log('ğŸ–±ï¸ MOUSEDOWN detectado no canvas!');
                    isPainting = true;
                    paint(e);
                });
                
                newCanvas.addEventListener('mousemove', (e) => {
                    if (isPainting) paint(e);
                });
                
                newCanvas.addEventListener('mouseup', () => {
                    if (isPainting) {
                        console.log('ğŸ–±ï¸ MOUSEUP - finalizando pintura');
                        isPainting = false;
                        this.calculateSCQFromPixels(containerId);
                    }
                });
                
                newCanvas.addEventListener('mouseleave', () => {
                    if (isPainting) {
                        console.log('ğŸ–±ï¸ MOUSELEAVE - finalizando pintura');
                        isPainting = false;
                        this.calculateSCQFromPixels(containerId);
                    }
                });
                
                // Touch events
                newCanvas.addEventListener('touchstart', (e) => {
                    console.log('ğŸ‘† TOUCHSTART detectado no canvas!');
                    isPainting = true;
                    paint(e);
                });
                
                newCanvas.addEventListener('touchmove', (e) => {
                    if (isPainting) paint(e);
                });
                
                newCanvas.addEventListener('touchend', () => {
                    if (isPainting) {
                        console.log('ğŸ‘† TOUCHEND - finalizando pintura');
                        isPainting = false;
                        this.calculateSCQFromPixels(containerId);
                    }
                });
                
                console.log(`âœ… Canvas configurado com sucesso! ID: canvas-queimados-${containerId}`);
            },
            
            setBrushSize(containerId, size) {
                const inst = this.instancias[containerId];
                if (!inst) return;
                
                inst.brushSize = parseInt(size);
                document.getElementById(`brush-display-${containerId}`).textContent = size + 'px';
            },
            
            limparPintura(containerId) {
                const inst = this.instancias[containerId];
                if (!inst) return;
                
                if (!confirm('Tem certeza que deseja limpar toda a pintura?')) return;
                
                // Limpar todos os pixels
                inst.atlasAtual.regioes.forEach(regiao => {
                    inst.paintData[regiao.id] = { grau2: [], grau3: [] };
                });
                
                // Redesenhar canvas
                this.redrawCanvas(containerId);
                
                // Recalcular
                this.calculateSCQFromPixels(containerId);
                
                console.log('ğŸ—‘ï¸ Pintura limpa');
            },
            
            pintarTudo100Grau2(containerId) {
                const inst = this.instancias[containerId];
                if (!inst) return;
                
                if (!confirm('ğŸ”¥ Deseja pintar TODAS as regiÃµes como 2Âº Grau (100%)?\n\nVocÃª poderÃ¡ remover Ã¡reas nÃ£o afetadas depois usando a borracha.')) return;
                
                console.log('ğŸ”¥ Iniciando pintura 100% (2Âº grau)...');
                
                // Iterar por todas as regiÃµes do atlas atual
                inst.atlasAtual.regioes.forEach(regiao => {
                    console.log(`   ğŸ“ Pintando regiÃ£o: ${regiao.nome}`);
                    
                    // Converter path para polÃ­gono
                    const polygon = this.pathToPolygon(regiao.path);
                    if (!polygon || polygon.length === 0) {
                        console.warn(`   âš ï¸ RegiÃ£o ${regiao.nome} nÃ£o tem polÃ­gono vÃ¡lido`);
                        return;
                    }
                    
                    // Obter bounds do polÃ­gono
                    const xs = polygon.map(p => p.x);
                    const ys = polygon.map(p => p.y);
                    const minX = Math.floor(Math.min(...xs));
                    const maxX = Math.ceil(Math.max(...xs));
                    const minY = Math.floor(Math.min(...ys));
                    const maxY = Math.ceil(Math.max(...ys));
                    
                    // Limpar pinturas existentes nesta regiÃ£o
                    inst.paintData[regiao.id] = { grau2: [], grau3: [] };
                    
                    // âœ… PREENCHER 100% - step=1 para cobertura total
                    const step = 1;
                    for (let x = minX; x <= maxX; x += step) {
                        for (let y = minY; y <= maxY; y += step) {
                            // Verificar se o ponto estÃ¡ dentro do polÃ­gono
                            if (this.isPointInPolygon({ x, y }, polygon)) {
                                inst.paintData[regiao.id].grau2.push({ x, y });
                            }
                        }
                    }
                    
                    const totalPixels = inst.paintData[regiao.id].grau2.length;
                    console.log(`   âœ… ${totalPixels} pixels pintados em ${regiao.nome}`);
                });
                
                // Redesenhar canvas
                this.redrawCanvas(containerId);
                
                // Recalcular percentuais
                this.calculateSCQFromPixels(containerId);
                
                console.log('ğŸ”¥âœ… Pintura 100% concluÃ­da!');
                alert('âœ… Todas as regiÃµes foram pintadas como 2Âº Grau!\n\nUse a borracha para remover Ã¡reas nÃ£o afetadas.');
            },
            
            pathToPolygon(pathString) {
                // Converter PATH SVG para array de pontos
                const commands = pathString.match(/[ML][\d\s.,]+/g) || [];
                const points = [];
                
                commands.forEach(cmd => {
                    const coords = cmd.slice(1).trim().split(/[\s,]+/);
                    for (let i = 0; i < coords.length; i += 2) {
                        const x = parseFloat(coords[i]);
                        const y = parseFloat(coords[i + 1]);
                        if (!isNaN(x) && !isNaN(y)) {
                            points.push({ x, y });
                        }
                    }
                });
                
                return points;
            },
            
            isPointInPolygon(point, polygon) {
                // Ray casting algorithm
                let inside = false;
                for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {
                    const xi = polygon[i].x, yi = polygon[i].y;
                    const xj = polygon[j].x, yj = polygon[j].y;
                    
                    const intersect = ((yi > point.y) !== (yj > point.y))
                        && (point.x < (xj - xi) * (point.y - yi) / (yj - yi) + xi);
                    if (intersect) inside = !inside;
                }
                return inside;
            },
            
            redrawCanvas(containerId) {
                const inst = this.instancias[containerId];
                if (!inst) return;
                
                const canvas = document.getElementById(`canvas-queimados-${containerId}`);
                if (!canvas) {
                    console.error('âŒ redrawCanvas: canvas nÃ£o encontrado');
                    return;
                }
                
                const ctx = canvas.getContext('2d');
                
                // Limpar canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                console.log('ğŸ–Œï¸ Redesenhando canvas...');
                
                // ConfiguraÃ§Ã£o de desenho
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';
                
                // âœ… OFFSET DO VIEWBOX: viewBox="0 290 700 620"
                const offsetY = 290;
                
                // Desenhar pixels de TODAS as regiÃµes
                const regioes = inst.atlasAtual.regioes;
                
                let totalPixelsDesenhados = 0;
                
                regioes.forEach(regiao => {
                    const paintData = inst.paintData[regiao.id];
                    if (!paintData) return;
                    
                    const polygon = this.pathToPolygon(regiao.path);
                    
                    // Desenhar 3Âº grau (vermelho)
                    if (paintData.grau3.length > 0) {
                        ctx.fillStyle = 'rgba(198, 40, 40, 0.7)';
                        paintData.grau3.forEach(p => {
                            if (this.isPointInPolygon(p, polygon)) {
                                ctx.fillRect(p.x, p.y - offsetY, 1, 1);
                                totalPixelsDesenhados++;
                            }
                        });
                    }
                    
                    // Desenhar 2Âº grau (laranja)
                    if (paintData.grau2.length > 0) {
                        ctx.fillStyle = 'rgba(255, 152, 0, 0.6)';
                        paintData.grau2.forEach(p => {
                            if (this.isPointInPolygon(p, polygon)) {
                                ctx.fillRect(p.x, p.y - offsetY, 1, 1);
                                totalPixelsDesenhados++;
                            }
                        });
                    }
                });
                
                console.log('   Total de pixels desenhados:', totalPixelsDesenhados);
            },
            
            calculateSCQFromPixels(containerId) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                console.log('ğŸ“Š Calculando SCQ a partir dos pixels...');
                
                let totalGrau2 = 0;
                let totalGrau3 = 0;
                let regioesComQueimadura = 0;
                
                // Calcular para cada regiÃ£o
                inst.atlasAtual.regioes.forEach(regiao => {
                    const paintData = inst.paintData[regiao.id];
                    if (!paintData) return;
                    
                    const polygon = this.pathToPolygon(regiao.path);
                    
                    // Contar apenas pixels que estÃ£o DENTRO do polÃ­gono
                    const pixelsGrau2 = paintData.grau2.filter(p => 
                        this.isPointInPolygon(p, polygon)
                    ).length;
                    
                    const pixelsGrau3 = paintData.grau3.filter(p => 
                        this.isPointInPolygon(p, polygon)
                    ).length;
                    
                    if (pixelsGrau2 > 0 || pixelsGrau3 > 0) {
                        regioesComQueimadura++;
                        console.log(`   RegiÃ£o: ${regiao.nome} - Grau2: ${pixelsGrau2} pixels, Grau3: ${pixelsGrau3} pixels`);
                    }
                    
                    // Usar Ã¡rea prÃ©-calculada do cache
                    const totalPixels = inst.polygonAreas[regiao.id] || 0;
                    
                    if (totalPixels === 0) return;
                    
                    // Percentual pintado desta regiÃ£o (0-100)
                    const percentualGrau2 = (pixelsGrau2 / totalPixels) * 100;
                    const percentualGrau3 = (pixelsGrau3 / totalPixels) * 100;
                    
                    // âœ… OBTER PERCENTUAL CORRETO DO CORPO (respeita faixa etÃ¡ria no Lund-Browder)
                    const percentualRegiaoCorpo = inst.atlasAtual.obterPercentual 
                        ? inst.atlasAtual.obterPercentual(regiao.id, inst.faixaEtariaAtual || '5-9')
                        : (regiao.percentual || 0);
                    
                    // ContribuiÃ§Ã£o para SCQ total do corpo
                    // Ex: Se 50% do tronco (18% do corpo) estÃ¡ queimado = 0.5 * 18 = 9% SCQ
                    totalGrau2 += (percentualGrau2 / 100) * percentualRegiaoCorpo;
                    totalGrau3 += (percentualGrau3 / 100) * percentualRegiaoCorpo;
                    
                    // Atualizar areasQueimadas para compatibilidade com lista
                    if (!inst.areasQueimadas[regiao.id]) {
                        inst.areasQueimadas[regiao.id] = { grau2: 0, grau3: 0 };
                    }
                    inst.areasQueimadas[regiao.id].grau2 = percentualGrau2;
                    inst.areasQueimadas[regiao.id].grau3 = percentualGrau3;
                });
                
                const scqTotal = totalGrau2 + totalGrau3;
                
                console.log(`   âœ… SCQ Total: ${scqTotal.toFixed(1)}% (Grau2: ${totalGrau2.toFixed(1)}%, Grau3: ${totalGrau3.toFixed(1)}%)`);
                console.log(`   âœ… RegiÃµes com queimadura: ${regioesComQueimadura}`);
                
                // Atualizar interface
                document.getElementById(`scq-total-${containerId}`).textContent = scqTotal.toFixed(1) + '%';
                document.getElementById(`scq-grau2-${containerId}`).textContent = totalGrau2.toFixed(1) + '%';
                document.getElementById(`scq-grau3-${containerId}`).textContent = totalGrau3.toFixed(1) + '%';
                
                // Atualizar Parkland
                this.atualizarParkland(containerId);
                
                // Atualizar lista lateral
                this.atualizarListaQueimaduras(containerId);
                
                // Atualizar critÃ©rios de internaÃ§Ã£o
                this.atualizarCriteriosInternacao(containerId);
                
                // Redesenhar SVG para destacar Ã¡reas queimadas
                this.renderizarVista(containerId, 'Anterior');
                this.renderizarVista(containerId, 'Posterior');
                
                return { total: scqTotal, grau2: totalGrau2, grau3: totalGrau3 };
            },
            
            getPolygonBounds(polygon) {
                let minX = Infinity, minY = Infinity;
                let maxX = -Infinity, maxY = -Infinity;
                
                polygon.forEach(p => {
                    if (p.x < minX) minX = p.x;
                    if (p.y < minY) minY = p.y;
                    if (p.x > maxX) maxX = p.x;
                    if (p.y > maxY) maxY = p.y;
                });
                
                return { minX, minY, maxX, maxY };
            },
            
            atualizarListaQueimaduras(containerId) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                console.log('ğŸ“‹ Atualizando lista de queimaduras...');
                
                // âœ… USAR ID CORRETO DA LISTA DE QUEIMADURAS
                const listaDiv = document.getElementById(`lista-queimaduras-${containerId}`);
                if (!listaDiv) {
                    console.error('âŒ Lista de queimaduras nÃ£o encontrada:', `lista-queimaduras-${containerId}`);
                    return;
                }
                
                console.log('   âœ… Elemento da lista encontrado');
                
                let html = '';
                let regioesNaLista = 0;
                
                // âœ… SEMPRE MOSTRAR TODAS AS REGIÃ•ES DO ATLAS ATUAL
                inst.atlasAtual.regioes.forEach(regiao => {
                    const paintData = inst.paintData[regiao.id];
                    
                    let pixelsGrau2 = 0;
                    let pixelsGrau3 = 0;
                    
                    if (paintData) {
                        const polygon = this.pathToPolygon(regiao.path);
                        
                        // Contar pixels vÃ¡lidos
                        pixelsGrau2 = paintData.grau2.filter(p => 
                            this.isPointInPolygon(p, polygon)
                        ).length;
                        
                        pixelsGrau3 = paintData.grau3.filter(p => 
                            this.isPointInPolygon(p, polygon)
                        ).length;
                    }
                    
                    const totalPintado = pixelsGrau2 + pixelsGrau3;
                    
                    if (totalPintado > 0) {
                        regioesNaLista++;
                    }
                    
                    // Usar Ã¡rea do cache
                    const totalPixelsRegiao = inst.polygonAreas[regiao.id] || 0;
                    
                    // Percentual da REGIÃƒO que estÃ¡ pintada
                    const percentualRegiaoPintada = totalPixelsRegiao > 0 ? 
                        (totalPintado / totalPixelsRegiao) * 100 : 0;
                    
                    // âœ… OBTER PERCENTUAL CORRETO (respeita faixa etÃ¡ria se for Lund-Browder)
                    const percentualRegiaoCorpo = inst.atlasAtual.obterPercentual 
                        ? inst.atlasAtual.obterPercentual(regiao.id, inst.faixaEtariaAtual || '5-9')
                        : (regiao.percentual || 0);
                    
                    // Percentual do CORPO (SCQ)
                    const percentualGrau2Corpo = totalPixelsRegiao > 0 ? 
                        (pixelsGrau2 / totalPixelsRegiao) * percentualRegiaoCorpo : 0;
                    
                    const percentualGrau3Corpo = totalPixelsRegiao > 0 ? 
                        (pixelsGrau3 / totalPixelsRegiao) * percentualRegiaoCorpo : 0;
                    
                    const totalSCQ = percentualGrau2Corpo + percentualGrau3Corpo;
                    
                    // Cor da borda (cinza se nÃ£o pintado)
                    let corBorda = '#e0e0e0';
                    if (totalPintado > 0) {
                        corBorda = pixelsGrau3 > pixelsGrau2 ? '#c62828' : '#ff9800';
                    }
                    
                    // Background diferente se pintado
                    const bgColor = totalPintado > 0 ? '#f9f9f9' : '#fafafa';
                    
                    html += `
                        <div style="padding: 10px; margin-bottom: 6px; background: ${bgColor}; border-radius: 6px; border-left: 4px solid ${corBorda}; box-shadow: 0 1px 2px rgba(0,0,0,0.05);">
                            <div style="font-size: 12px; font-weight: ${totalPintado > 0 ? '700' : '600'}; color: ${totalPintado > 0 ? '#333' : '#999'}; margin-bottom: ${totalPintado > 0 ? '6px' : '0'};">
                                ${regiao.nome}
                            </div>
                            ${totalPintado > 0 ? `
                                <div style="font-size: 10px; color: #666; margin-bottom: 4px;">
                                    <strong>Ãrea pintada:</strong> ${percentualRegiaoPintada.toFixed(1)}% da regiÃ£o
                                </div>
                                <div style="font-size: 10px; color: #666; margin-bottom: 4px;">
                                    <strong>% do corpo total:</strong> ${totalSCQ.toFixed(2)}%
                                </div>
                                ${pixelsGrau2 > 0 ? `
                                    <div style="font-size: 10px; color: #ff9800; margin-bottom: 2px;">
                                        ğŸ”¥ğŸ”¥ 2Âº grau: ${percentualGrau2Corpo.toFixed(2)}%
                                    </div>
                                ` : ''}
                                ${pixelsGrau3 > 0 ? `
                                    <div style="font-size: 10px; color: #c62828;">
                                        ğŸ”¥ğŸ”¥ğŸ”¥ 3Âº grau: ${percentualGrau3Corpo.toFixed(2)}%
                                    </div>
                                ` : ''}
                            ` : ''}
                        </div>
                    `;
                });
                
                listaDiv.innerHTML = html;
                console.log(`   âœ… Lista atualizada com ${regioesNaLista} regiÃµes pintadas`);
            },
            
            // â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            
            abrirDialogoQueimadura(containerId, regiao, event) {
                // ğŸ¨ NO MODO DE PINTURA, NÃƒO ABRIR DIALOG - DEIXAR O CANVAS CAPTURAR OS EVENTOS
                // O sistema de pintura agora captura os cliques diretamente no canvas
                return;
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                const areaId = regiao.id || regiao.nome;
                const areaAtual = inst.areasQueimadas[areaId] || { grau2: 0, grau3: 0 };
                
                const percentualAtual = inst.grauSelecionado === 2 ? areaAtual.grau2 : areaAtual.grau3;
                
                const novoPercentual = prompt(
                    `ğŸ”¥ ${regiao.nome} (${regiao.percentual}% do corpo)\n\n` +
                    `Grau selecionado: ${inst.grauSelecionado}Âº\n` +
                    `Percentual atual: ${percentualAtual}%\n\n` +
                    `Digite o percentual queimado desta Ã¡rea (0-100):`,
                    percentualAtual
                );
                
                if (novoPercentual === null) return; // Cancelou
                
                const percentual = parseFloat(novoPercentual);
                if (isNaN(percentual) || percentual < 0 || percentual > 100) {
                    alert('Valor invÃ¡lido! Digite um nÃºmero entre 0 e 100.');
                    return;
                }
                
                // Atualizar Ã¡rea
                if (!inst.areasQueimadas[areaId]) {
                    inst.areasQueimadas[areaId] = { grau2: 0, grau3: 0 };
                }
                
                if (inst.grauSelecionado === 2) {
                    inst.areasQueimadas[areaId].grau2 = percentual;
                } else {
                    inst.areasQueimadas[areaId].grau3 = percentual;
                }
                
                // Redesenhar e recalcular
                this.redesenhar(containerId);
                this.calcularSCQ(containerId);
                this.atualizarListaQueimados(containerId);
            },
            
            atualizarListaQueimados(containerId) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                // âœ… USAR ID CORRETO DA LISTA DE QUEIMADURAS
                const lista = document.getElementById(`lista-queimaduras-${containerId}`);
                if (!lista) {
                    console.warn('Lista de queimaduras nÃ£o encontrada');
                    return;
                }
                
                lista.innerHTML = '';
                
                let totalAreas = 0;
                for (const areaId in inst.areasQueimadas) {
                    const area = inst.areasQueimadas[areaId];
                    if (area.grau2 === 0 && area.grau3 === 0) continue;
                    
                    totalAreas++;
                    
                    const regiaoAtlas = ATLAS_QUEIMADOS.regioes.find(r => r.id === areaId);
                    if (!regiaoAtlas) continue;
                    
                    const item = document.createElement('div');
                    item.style.cssText = 'background: #fff; padding: 10px; border-radius: 6px; margin-bottom: 8px; border-left: 4px solid #ff6b6b; font-size: 12px;';
                    
                    const scq2 = (area.grau2 / 100) * regiaoAtlas.percentual;
                    const scq3 = (area.grau3 / 100) * regiaoAtlas.percentual;
                    
                    item.innerHTML = `
                        <div style="font-weight: 600; color: #333; margin-bottom: 6px;">${regiaoAtlas.nome}</div>
                        ${area.grau2 > 0 ? `<div style="color: #ff9800;">ğŸ”¥ğŸ”¥ 2Âº: ${area.grau2}% â†’ ${scq2.toFixed(2)}% SCQ</div>` : ''}
                        ${area.grau3 > 0 ? `<div style="color: #c62828;">ğŸ”¥ğŸ”¥ğŸ”¥ 3Âº: ${area.grau3}% â†’ ${scq3.toFixed(2)}% SCQ</div>` : ''}
                        <button onclick="AnatomiaAtendimento.removerQueimadura('${containerId}', '${areaId}')" 
                                style="margin-top: 6px; padding: 4px 8px; background: #f44336; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 10px;">
                            ğŸ—‘ï¸ Remover
                        </button>
                    `;
                    
                    lista.appendChild(item);
                }
                
                document.getElementById(`total-atlas-${containerId}`).textContent = totalAreas;
                
                if (totalAreas === 0) {
                    lista.innerHTML = '<div style="text-align: center; color: #999; padding: 20px; font-size: 12px;">Nenhuma Ã¡rea queimada marcada</div>';
                }
            },
            
            removerQueimadura(containerId, areaId) {
                const inst = this.instancias[containerId];
                if (!inst || inst.contexto !== 'queimados') return;
                
                if (confirm('Remover marcaÃ§Ã£o desta Ã¡rea?')) {
                    delete inst.areasQueimadas[areaId];
                    this.redesenhar(containerId);
                    this.calcularSCQ(containerId);
                    this.atualizarListaQueimados(containerId);
                }
            }
        };
        
        // ============================================================
        // UTILITÃRIO: Carregar dados do Atlas AnatÃ´mico
        // ============================================================
        function carregarAtlasDoJSON(jsonData) {
            try {
                const dados = typeof jsonData === 'string' ? JSON.parse(jsonData) : jsonData;
                
                // Armazenar no localStorage
                localStorage.setItem('atlas_anatomico_regioes', JSON.stringify(dados));
                
                // Carregar no objeto global
                ATLAS_ANATOMICO.regioes = dados.regioes || [];
                ATLAS_ANATOMICO.imagemBase64 = dados.imagem || null;
                
                console.log('âœ… Atlas anatÃ´mico carregado:', ATLAS_ANATOMICO.regioes.length, 'regiÃµes');
                alert(`Atlas carregado com sucesso!\n${ATLAS_ANATOMICO.regioes.length} regiÃµes disponÃ­veis.`);
                
                return true;
            } catch (e) {
                console.error('âŒ Erro ao carregar atlas:', e);
                alert('Erro ao carregar atlas: ' + e.message);
                return false;
            }
        }
        
        // Tentar carregar automaticamente se existir
        if (ATLAS_ANATOMICO.regioes.length === 0) {
            console.log('â„¹ï¸ Atlas nÃ£o carregado. Use carregarAtlasDoJSON() para carregar os dados.');
        }
        
        // ConfirmaÃ§Ã£o de carregamento
        console.log('âœ… AnatomiaAtendimento carregado com sucesso!');
        console.log('ğŸ“Š MÃ©todos disponÃ­veis:', Object.keys(AnatomiaAtendimento));

        </script>

        <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
        <!-- MODAL DO EDITOR DE ATLAS EMBUTIDO -->
        <!-- â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” -->
</html>
